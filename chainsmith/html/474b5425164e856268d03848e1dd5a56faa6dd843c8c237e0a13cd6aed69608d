<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: VB2019 paper: APT cases exploiting vulnerabilities in region‑specific software</title>
<meta name="description" content="Some APT attacks are carried out by exploiting vulnerabilities in region-specific software. Government agencies frequently use such localized software, and this tends to be the target of attackers. In Japan, there have been many cases where attacks have been carried out by exploiting vulnerabilities in software that is only used in Japan, using malware that is unique to Japan. This paper will describe the TTPs of attack groups in recent years as well as the APT groups exploiting vulnerabilities in local software. This paper will provide insights into intelligence analysis and APT handling by looking at the attack characteristics (shellcode, malware, etc.) of different campaigns." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 6664;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/blocks/expand_collapse_toc/templates/vbexpand/view.css" />
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/jquery.color.js"></script>
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<h1><a class="chapter" name="h1-vb2019-paper-apt-cases-exploiting-vulnerabilities-regionspecific-software"></a>VB2019 paper: APT cases exploiting vulnerabilities in region‑specific software</h1>
<h3><a class="chapter" name="h3-shusei-tomonaga-tomoaki-tani-hiroshi-soeda-amp-wataru-takahashi"></a>Shusei Tomonaga, Tomoaki Tani, Hiroshi Soeda &amp; Wataru Takahashi</h3>
<p><em>JPCERT/CC, Japan</em></p>
<hr />
<div class="ccm-expand-collapse-toc">
<div id="ccm-expand-collapse-toc-title-15043" class="ccm-expand-collapse-toc-title ccm-expand-collapse-toc-closed" data-expander-speed="500">Table of contents</div><div id="ccm-expand-collapse-toc-content-15043" class="ccm-expand-collapse-toc-content"><p><a class="toc-level2" href="#h2-abstract">Abstract</a><br /> <a class="toc-level2" href="#h2-1-introduction">1. Introduction</a><br /> <a class="toc-level2" href="#h2-2-attack-exploiting-sanshiros-vulnerability">2. Attack exploiting Sanshiro’s vulnerability</a><br /> <a class="toc-level3" href="#h3-21-summary-vulnerability">2.1 Summary of the vulnerability</a><br /> <a class="toc-level3" href="#h3-22-delivery-zero-day-exploit">2.2 Delivery of the zero-day exploit</a><br /> <a class="toc-level4" href="#h4-detail-cve-2014-0810-jvndb-2014-000011">Detail of CVE-2014-0810 (JVNDB-2014-000011)</a><br /> <a class="toc-level3" href="#h3-23-bundled-malware-exploit">2.3 The bundled malware with the exploit</a><br /> <a class="toc-level3" href="#h3-24-attack-timeline">2.4 Attack timeline</a><br /> <a class="toc-level2" href="#h2-3-attack-exploiting-ichitaros-vulnerability">3. Attack exploiting Ichitaro’s vulnerability</a><br /> <a class="toc-level3" href="#h3-31-summary-ichitaro">3.1 Summary of Ichitaro</a><br /> <a class="toc-level3" href="#h3-32-cve-2014-7247">3.2 CVE-2014-7247</a><br /> <a class="toc-level4" href="#h4-summary-vulnerability">Summary of the vulnerability</a><br /> <a class="toc-level4" href="#h4-detail-shellcode">Detail of the shellcode</a><br /> <a class="toc-level4" href="#h4-details-malware">Details of the malware</a><br /> <a class="toc-level5" href="#h5-emdivi">Emdivi</a><br /> <a class="toc-level5" href="#h5-agtid">Agtid</a><br /> <a class="toc-level3" href="#h3-33-threat-actor">3.3 Threat actor</a><br /> <a class="toc-level4" href="#h4-campc-server">C&amp;C server</a><br /> <a class="toc-level2" href="#h2-4-attack-exploiting-skysea-client-views-vulnerability">4. Attack exploiting SKYSEA Client View’s vulnerability</a><br /> <a class="toc-level3" href="#h3-41-summary-vulnerability">4.1 Summary of the vulnerability</a><br /> <a class="toc-level3" href="#h3-42-attack-timeline">4.2 Attack timeline</a><br /> <a class="toc-level3" href="#h3-43-malware-infections-exploiting-vulnerability">4.3 Malware infections exploiting this vulnerability</a><br /> <a class="toc-level4" href="#h4-wali">Wali</a><br /> <a class="toc-level4" href="#h4-small-downloader">Small downloader</a><br /> <a class="toc-level4" href="#h4-noderat">NodeRAT</a><br /> <a class="toc-level3" href="#h3-44-attack-infrastructure">4.4 Attack infrastructure</a><br /> <a class="toc-level4" href="#h4-attacking-ip-address">Attacking IP address</a><br /> <a class="toc-level4" href="#h4-campc-server">C&amp;C server</a><br /> <a class="toc-level2" href="#h2-5-discussion-apt-campaigns-targeting-japan">5. Discussion of APT campaigns targeting Japan</a><br /> <a class="toc-level3" href="#h3-51-apt17">5.1 APT17</a><br /> <a class="toc-level4" href="#h4-attack-timeline">Attack timeline</a><br /> <a class="toc-level4" href="#h4-initial-access">Initial access</a><br /> <a class="toc-level4" href="#h4-watering-hole-attack">Watering hole attack</a><br /> <a class="toc-level4" href="#h4-supply-chain-attack">Supply chain attack</a><br /> <a class="toc-level4" href="#h4-lateral-movement">Lateral movement</a><br /> <a class="toc-level3" href="#h3-52-cloudy-omega-blue-termite">5.2 Cloudy Omega / Blue Termite</a><br /> <a class="toc-level4" href="#h4-attack-timeline">Attack timeline</a><br /> <a class="toc-level4" href="#h4-initial-access">Initial access</a><br /> <a class="toc-level4" href="#h4-lateral-movement">Lateral movement</a><br /> <a class="toc-level3" href="#h3-53-bronze-butler-tick">5.3 BRONZE BUTLER / Tick</a><br /> <a class="toc-level4" href="#h4-attack-timeline">Attack timeline</a><br /> <a class="toc-level4" href="#h4-initial-access">Initial access</a><br /> <a class="toc-level4" href="#h4-lateral-movement">Lateral movement</a><br /> <a class="toc-level2" href="#h2-conclusion">Conclusion</a><br /> <a class="toc-level2" href="#h2-references">References</a><br /> <a class="toc-level2" href="#h2-appendix-iocs">Appendix: IoCs</a><br /> <a class="toc-level3" href="#h3-sha-256">SHA 256</a><br /> <a class="toc-level3" href="#h3-campc-servers">C&amp;C servers</a><br /> <a class="toc-level3" href="#h3-attacking-ip-addresses">Attacking IP addresses</a><br /> <a class="toc-level3" href="#h3-backdoor-access-ip-addresses">Backdoor access IP addresses</a><br /> <a class="toc-level2" href="#h2-footnotes">Footnotes</a></p><p>&nbsp;</p></div></div>
<h2><a class="chapter" name="h2-abstract"></a>Abstract</h2>
<p>APT attacks often leverage software vulnerabilities to infect victims with malware. Commonly targeted software includes<em> Microsoft Office</em>, <em>IE</em> and <em>Adobe</em> <em>Flash Player</em>, all of which are in widespread use all over the world. On the other hand, some APT attacks are carried out by exploiting vulnerabilities in region-specific software. Government agencies frequently use such localized software, and this tends to be the target of attackers. Such attacks are rarely discussed at international conferences as, by their nature, they relate exclusively to a particular country. In Japan, there have been many cases where attacks have been carried out by exploiting vulnerabilities in software that is only used in Japan, using malware that is unique to Japan. In this paper, we will describe the TTPs of attack groups in recent years. We will also describe the APT groups exploiting vulnerabilities in local software. This paper will provide insights into intelligence analysis and APT handling by looking at the attack characteristics (shellcode, malware, etc.) of different campaigns.</p>
<p> </p>
<h2><a class="chapter" name="h2-1-introduction"></a>1. Introduction</h2>
<p>Various tactics, techniques and procedures (TTPs) are used by different attackers in order to trick victims into becoming infected with malware. Particularly in APT attacks, highly sophisticated methods such as supply chain attacks, zero-day attacks, etc. are observed. Software that is in widespread use (e.g. <em>Microsoft Office</em>, <em>IE</em>, <em>Adobe Flash Player</em>) is often targeted in zero-day attacks. These types of software are installed on many hosts, making them ideal entry points for malware.</p>
<p>On the other hand, there are other types of software that are only used in specific countries. <em>Hangul Word Processor</em> (<em>HWP</em>) in South Korea and <em>Ichitaro</em> in Japan are examples. Such software is often targeted and leveraged in attacks against a specific country. There are reported cases in which <em>HWP</em> has been leveraged for APT attacks [<a href="#ref1">1</a>]. It is important to understand such attack cases in order to determine appropriate countermeasures. This research is intended to document and share examples of attacks in which region-specific software is leveraged.</p>
<p>In Japan, there are many cases where attacks have been carried out by exploiting vulnerabilities in software that is only used within the country. JPCERT/CC has been involved in the incident handling and investigation of many of the cases. In this paper, we will describe the details of these attacks by APT groups in recent years. In particular, attacks involving three types of software will be discussed:</p>
<ul>
<li><em>Sanshiro</em></li>
<li><em>Ichitaro</em></li>
<li><em>SKYSEA Client View</em></li>
</ul>
<p><em>Sanshiro</em> is a spreadsheet program used in Japan, similar to <em>Excel</em>. Attackers leveraged a vulnerability in this program to attach a malicious file to an email, which infected the user with the PlugX malware. <em>Ichitaro</em> is a <em>Word</em>-like application used in Japan. APT groups leveraged a vulnerability in this program to attach a malicious document file to an email, which infected the user with PlugX. We have confirmed that this vulnerability was leveraged in multiple APT campaigns. This zero-day attack is a peculiar case in which two different APT groups conducted attacks at the same time. SKYSEA is a popular asset management (SAM) solution in Japan. An attack group known as ‘Tick’ infects clients with multi‑platform malware by leveraging a vulnerability in the software remotely. This attack has been observed as of 2019, and the attack pattern continues to change. We will also summarize other TTPs deployed by these APT groups.</p>
<p> </p>
<h2><a class="chapter" name="h2-2-attack-exploiting-sanshiros-vulnerability"></a>2. Attack exploiting Sanshiro’s vulnerability</h2>
<h3><a class="chapter" name="h3-21-summary-vulnerability"></a>2.1 Summary of the vulnerability</h3>
<p><em>Sanshiro</em> is a spreadsheet program which is widely distributed in Japan. The file extension of <em>Sanshiro</em> is ‘jsd’. The latest major version of the program was released in 2010, and it ceased to be sold in 2014. It was mainly used in the Japanese government and education sector. The <em>Sanshiro</em> series contains a vulnerability that allows arbitrary code execution (CVE-2014-0810 [<a href="#ref2">2</a>]), which was leveraged as a zero-day exploit [<a href="#ref3">3</a>] by APT actors against Japanese government agencies.</p>
<p> </p>
<h3><a class="chapter" name="h3-22-delivery-zero-day-exploit"></a>2.2 Delivery of the zero-day exploit</h3>
<p>The APT group delivered the zero-day exploit code via a spear-phishing email sent to Japanese government agencies (Figures 1 and 2). The email contained a new year greeting and a decoy document with the zero-day exploit attached.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/977c8f2798e46f0d422a65510a09b74a_f4074.png" alt="2.1.png" width="600" height="330" /><span class="centered-caption">Figure 1: The spear-phishing email.</span></p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/5415/7346/4815/2.2.png" alt="2.2.png" width="307" height="453" /><span class="centered-caption">Figure 2: The decoy image.</span></p>
<p> </p>
<h4><a class="chapter" name="h4-detail-cve-2014-0810-jvndb-2014-000011"></a>Detail of CVE-2014-0810 (JVNDB-2014-000011)</h4>
<p>The <em>Sanshiro</em> software contains a component file which has a copy processing error. The vulnerability originates in its lack of data size validation and allows overwriting of the return address of the stack frame. As a result, arbitrary code can be executed on the stack frame. This vulnerability was leveraged to embed shellcode in the <em>Sanshiro</em> document. In the case of the APT attack, the shellcode was then executed through the exploit.</p>
<p>The following software is affected by CVE-2014-0810:</p>
<ul>
<li><em>Sanshiro 2007</em> before update 3</li>
<li><em>Sanshiro 2008</em> before update 5</li>
<li><em>Sanshiro 2009</em> before update 6</li>
<li><em>Sanshiro 2010</em> before update 6</li>
<li><em>Sanshiro Viewer</em> before 2.0.2.0</li>
</ul>
<p>The shellcode searches for the encrypted binary embedded in the <em>Sanshiro</em> document. It then decodes the binary with a single-byte XOR routine, writes a PE binary to the file system, and executes it. The bundled PE file was PlugX [<a href="#ref4">4</a>].</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/7515/7346/4884/2.3.png" alt="2.3.png" width="570" height="512" /><span class="centered-caption">Figure 3: Single-byte XOR decode routine.</span></p>
<p> </p>
<h3><a class="chapter" name="h3-23-bundled-malware-exploit"></a>2.3 The bundled malware with the exploit</h3>
<p>In actual attack cases, a malicious <em>Sanshiro</em> document which delivers PlugX was attached to a spear-phishing email. PlugX is a remote access tool (RAT), and infected devices were communicating with a certain C&amp;C server. Further analysis revealed that PlugX had also been used in some past attacks in combination with other vulnerability exploits such as <em>Adobe Flash</em>, <em>Microsoft Word</em> and <em>Ichitaro</em>. As shown in Figure 4, each PlugX sample was communicating with a C&amp;C server with a different domain name. However, it turned out that the domain names all resolved to the same IP address. From the characteristics, it seems as if the series of attacks using PlugX had been conducted by the same actor.</p>
<p><a class="zoom-img" title="Figure 4: PlugX samples connect to 103.246.112.123." href="/files/6815/7346/4953/2.4.png"><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/10603b05c97f9d06c2a27b6dbe0fd150_f4077.png" alt="2.4.png" width="843" height="636" /></a></p>
<p class="centered-caption">Figure 4: PlugX samples connect to 103.246.112.123.</p>
<p> </p>
<h3><a class="chapter" name="h3-24-attack-timeline"></a>2.4 Attack timeline</h3>
<p>The actor had developed the <em>Sanshiro</em> exploit and used it before the vulnerability was disclosed in January 2014. JPCERT/CC has observed several spear-phishing emails from the same actor since at least 2013. They used various exploits such as <em>Adobe Flash</em> (CVE-2011-2462 [<a href="#ref5">5</a>]), <em>Microsoft Office Word</em> (CVE-2012-0158 [<a href="#ref6">6</a>]) and <em>Ichitaro</em> (CVE-2013-5990 [<a href="#ref7">7</a>]). In the case of <em>Ichitaro</em>, the actor leveraged the vulnerability as a zero-day exploit. In January 2014, the developer of <em>Sanshiro</em> released a patch [<a href="#ref8">8</a>] and disclosed the vulnerability. Considering the facts, the actor is believed to be highly skilled in developing the exploit and researching the vulnerability of local Japanese software such as <em>Sanshiro</em> and <em>Ichitaro</em>.</p>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td><strong>Date</strong></td>
<td><strong>Note</strong></td>
</tr>
<tr>
<td>April 2013</td>
<td>Spear-phishing mail with MS Office exploit (CVE-2012-0158)</td>
</tr>
<tr>
<td>May 2013</td>
<td>Spear-phishing mail with Adobe pdf exploit (CVE-2011-2462)</td>
</tr>
<tr>
<td>September 2013</td>
<td>Spear-phishing mail with Ichitaro zero-day exploit (CVE-2013-5990)</td>
</tr>
<tr>
<td>November 2013</td>
<td>Disclose CVE-2013-5990 and, release the update patches of Ichitaro series</td>
</tr>
<tr>
<td>November 2013</td>
<td>Spear-phishing mail with Ichitaro exploit (CVE-2013-5990)</td>
</tr>
<tr>
<td>December 2013</td>
<td>Spear-phishing mail with Sanshiro zero-day exploit (CVE-2014-0810)</td>
</tr>
<tr>
<td>January 2014</td>
<td>Disclose CVE-2014-0810 and, release the update patches of Sanshiro series</td>
</tr>
</tbody>
</table>
<p class="centered-caption">Table 1: Exploits used by the actor.</p>
<p> </p>
<h2><a class="chapter" name="h2-3-attack-exploiting-ichitaros-vulnerability"></a>3. Attack exploiting Ichitaro’s vulnerability</h2>
<h3><a class="chapter" name="h3-31-summary-ichitaro"></a>3.1 Summary of Ichitaro</h3>
<p><em>Ichitaro</em> is a popular Japanese word-processing program, first released in 1983. It has been widely used in government agencies as well by the general consumer market. In spite of its popularity, however, a number of vulnerabilities have been found in this product, some of which have been leveraged in targeted attacks. Table 2 shows the vulnerabilities that have been leveraged in targeted attacks. The next section will describe CVE-2014-7247, which has been exploited in many attack cases.</p>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td><strong>Published</strong></td>
<td><strong>CVE</strong></td>
<td><strong>Overview</strong></td>
<td><strong>CVSSv2</strong></td>
</tr>
<tr>
<td>2014/11/13</td>
<td>CVE-2014-7247</td>
<td>Arbitrary Code Execution (ACE)</td>
<td>9.3</td>
</tr>
<tr>
<td>2013/11/12</td>
<td>CVE-2013-5990</td>
<td>Arbitrary Code Execution (ACE)</td>
<td>9.3</td>
</tr>
<tr>
<td>2013/06/18</td>
<td>CVE-2013-3644</td>
<td>Arbitrary Code Execution (ACE)</td>
<td>9.3</td>
</tr>
<tr>
<td>2013/02/26</td>
<td>CVE-2013-0707</td>
<td>Arbitrary Code Execution (ACE)</td>
<td>6.8</td>
</tr>
<tr>
<td>2011/06/16</td>
<td>CVE-2011-1331</td>
<td>Arbitrary Code Execution (ACE)</td>
<td>9.3</td>
</tr>
<tr>
<td>2010/11/04</td>
<td>CVE-2010-3916</td>
<td>Arbitrary Code Execution (ACE)</td>
<td>9.3</td>
</tr>
<tr>
<td>2010/11/04</td>
<td>CVE-2010-3915</td>
<td>Arbitrary Code Execution (ACE)</td>
<td>9.3</td>
</tr>
<tr>
<td>2010/06/01</td>
<td>CVE-2010-2152</td>
<td>Arbitrary Code Execution (ACE)</td>
<td>9.3</td>
</tr>
<tr>
<td>2010/04/12</td>
<td>CVE-2010-1424</td>
<td>Arbitrary Code Execution (ACE)</td>
<td>9.3</td>
</tr>
</tbody>
</table>
<p class="centered-caption">Table 2: Ichitaro vulnerabilities used in targeted attacks.</p>
<p> </p>
<h3><a class="chapter" name="h3-32-cve-2014-7247"></a>3.2 CVE-2014-7247</h3>
<p>CVE-2014-7247 was exploited as a zero-day vulnerability. The attack was carried out through targeted emails which were distributed to government agencies and enterprises in Japan. The emails were crafted to convince recipients to open the attachment, which contained an <em>Ichitaro</em> document leveraging the CVE-2014-7247 vulnerability. Figures 5 and 6 show the email contents and the decoy document.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/f329657cae10f502e7d4dc28b6d850a6_f4078.png" alt="3.1.png" width="600" height="459" /><span class="centered-caption">Figure 5: The spear-phishing email.</span></p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/b12fdb0eff08810ed691526cae3e0668_f4079.png" alt="3.2.png" width="680" height="629" /><span class="centered-caption">Figure 6: Decoy document to be displayed.</span></p>
<p class="centered-caption"> </p>
<h4><a class="chapter" name="h4-summary-vulnerability"></a>Summary of the vulnerability</h4>
<p>CVE-2014-7247 is a vulnerability that causes a stack overflow due to a failure in copy processing called from JCXCALC.DLL, one of the component files in <em>Ichitaro</em>, that allows writing of an excessive amount of data in the local static array. As a result, the return address on the stack can be altered to an arbitrary value. By leveraging this vulnerability, attackers can execute shellcode on the stack.</p>
<p> </p>
<h4><a class="chapter" name="h4-detail-shellcode"></a>Detail of the shellcode</h4>
<p>The shellcode consists of two sets of code. The first set of code searches for the second set embedded in the <em>Ichitaro</em> file loaded in the memory. The second code decodes the shellcode with XOR (Figure 7). The decoded shellcode extracts and executes the malicious program embedded in the <em>Ichitaro</em> file (PE image). The following types of malware are executed, as confirmed by JPCERT/CC.</p>
<ul>
<li>Emdivi</li>
<li>PlugX</li>
<li>Agtid</li>
</ul>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/eb24b9449044ceff67865b20379c6410_f4080.png" alt="3.3.png" width="830" height="411" /><span class="centered-caption">Figure 7: XOR decode processing.</span></p>
<p> </p>
<h4><a class="chapter" name="h4-details-malware"></a>Details of the malware</h4>
<h5><a class="chapter" name="h5-emdivi"></a>Emdivi</h5>
<p>Emdivi is a bot that communicates via HTTP protocol. The malware versions are managed systematically by the developer, and there are occasional functional updates. Among these, versions t17, t19 and t20 have outstanding characteristics. These versions seem to be used in different phases of the attack: t17 for initial intrusion, and t19 and t20 during the incubation period. t17 contains about 10 commands, which perform file download/upload and event log deletion. t20 is a more advanced HTTP bot and contains up to 40 commands. It has self-camouflage functions such as hard-coding IP addresses of victims’ proxy servers and running on certain devices only [<a href="#ref9">9</a>].</p>
<p> </p>
<h5><a class="chapter" name="h5-agtid"></a>Agtid</h5>
<p>Agtid is a bot that communicates via HTTP protocol. It performs basic functions such as file operations and downloading/executing files. One of its features is that its communication contains the string ‘Agtid’ in the HTTP request header. It also contains the string ‘DGGYDSYRL’, as described by <em>FireEye</em> [<a href="#ref10">10</a>].</p>
<p>The following is an example of the communication that Agtid performs:</p>
<pre>POST /info.asp HTTP/1.1<br />Content-Type: application/x-www-form-urlencoded<br />Agtid: [16 bytes of hex]08x<br />User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Win32)<br />Host: 180.150.228.102:443<br />Content-Length: [data size]<br />Cache-Control: no-cache<br />[16 bytes of hex]08x&amp;[Encrypted string]</pre>
<p> </p>
<h3><a class="chapter" name="h3-33-threat-actor"></a>3.3 Threat actor</h3>
<p>In this section we will examine the actors who conducted attacks leveraging CVE-2014-7247 based on the malware compile time and file property information. The compile time of the malware used by the attackers is shown in Figure 8. It shows that PlugX was created between 2014/11/3 and 2014/11/6. Emdivi was also created between the same dates. It is clear that the two types of malware were created during the same time period. For Agtid, the compile time was set to 1970/1/1 (Unix time number 0), and the attack using the malware was observed on 2014/11/7. Two weeks after the attack was confirmed, the vendor released a patch for <em>Ichitaro</em>.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/0ff201e346528768fc7f699f345f109d_f4081.png" alt="3.4.png" width="843" height="334" /> <span class="centered-caption">Figure 8: Timeline.</span></p>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td><strong>Ichitaro document</strong></td>
<td> </td>
<td><strong>Windows binary</strong></td>
<td> </td>
<td> </td>
</tr>
<tr>
<td><strong>Filename</strong></td>
<td><strong>Author</strong></td>
<td><strong>Filename</strong></td>
<td><strong>Family</strong></td>
<td><strong>Compile time</strong></td>
</tr>
<tr>
<td>概要と評価.jtd</td>
<td>gfz-l</td>
<td>windump.exe</td>
<td>Emdivi</td>
<td>2014/11/03 2:32</td>
</tr>
<tr>
<td>日米外安全保障政策20141106(未定稿).jtd</td>
<td>Windows ユーザー</td>
<td>windump.exe</td>
<td>PlugX</td>
<td>2014/11/03 3:01</td>
</tr>
<tr>
<td>沖縄振興特別措置法のあらまし.jtd</td>
<td>gfz-l</td>
<td>windump.exe</td>
<td>PlugX</td>
<td>2014/11/04 9:19</td>
</tr>
<tr>
<td>石油技術開発 調査事業成果報告書.jtd</td>
<td>gfz-l</td>
<td>windump.exe</td>
<td>PlugX</td>
<td>2014/11/04 10:15</td>
</tr>
<tr>
<td>★合体版.jtd</td>
<td>gfz-l</td>
<td>windump.exe</td>
<td>Emdivi</td>
<td>2014/11/05 12:15</td>
</tr>
<tr>
<td>悪質な資格講座の電話勧誘に御注意！！.jtd</td>
<td>gfz-l</td>
<td>windump.exe</td>
<td>Emdivi</td>
<td>2014/11/06 4:20</td>
</tr>
<tr>
<td>健康保険のお知らせ.jtd</td>
<td>gfz-l</td>
<td>windump.exe</td>
<td>Emdivi</td>
<td>2014/11/06 4:55</td>
</tr>
<tr>
<td>有識者懇談会報告書.jtd</td>
<td>gfz-l</td>
<td>windump.exe</td>
<td>PlugX</td>
<td>2014/11/06 11:20</td>
</tr>
</tbody>
</table>
<p class="centered-caption">Table 3: Detailed timeline.</p>
<p>The file properties of the malware are listed in Table 3. We can see similarities in the file properties. One is that the author of the <em>Ichitaro</em> document file (Figure 9) is the same. Also, the file name of the malware itself is identical. Based on the similarity between the files and the timeline of the zero-day exploit, it is assumed that the attackers who used Emdivi and PlugX are the same. They are referred to as ‘Blue Termite’ by <em>Kaspersky</em> [<a href="#ref11">11</a>] and others. In addition, attack activities using Agtid (referred to as ‘APT17’ by <em>FireEye</em> [<a href="#ref12">12</a>] and others) were observed soon after the Blue Termite campaign. In this way, it is suggested that CVE-2014-7247 had been leveraged as a zero-day by these two actors.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/1615/7346/6312/3.5.png" alt="3.5.png" width="426" height="474" /><span class="centered-caption">Figure 9: Ichitaro document - author.</span></p>
<p> </p>
<h4><a class="chapter" name="h4-campc-server"></a>C&amp;C server</h4>
<p>A backdoor was installed in the C&amp;C servers used in Blue Termite. It was created based on ASP and PHP. The following backdoor has been confirmed:</p>
<ul>
<li>DST Asp站長檢測Tools (Figure 10)</li>
<li>Anti-shell (Figure 11)</li>
<li>Spider PHP shell</li>
<li>X14ob-Sh3ll</li>
</ul>
<p>The backdoor’s functions include file upload, download and execution.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/40dc9bfc9df095b41d2e8003cbe2e0f8_f4083.png" alt="3.6.png" width="600" height="330" /><span class="centered-caption"> Figure 10:DST Asp站長檢測Tools (ASP).</span></p>
<p> <a class="zoom-img" title="Figure 11: Anti-shell (PHP)." href="/files/7615/7346/6361/3.7.png"><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/82e6b60c2f2158e309ad0c6e34b21ce7_f4084.png" alt="3.7.png" width="800" height="437" /></a></p>
<p class="centered-caption">Figure 11: Anti-shell (PHP).</p>
<p> </p>
<h2><a class="chapter" name="h2-4-attack-exploiting-skysea-client-views-vulnerability"></a>4. Attack exploiting SKYSEA Client View’s vulnerability</h2>
<h3><a class="chapter" name="h3-41-summary-vulnerability"></a>4.1 Summary of the vulnerability</h3>
<p><em>SKYSEA Client View</em> is a popular piece of asset management (SAM) software in Japan. The software had a vulnerability (CVE-2016-7836 [<a href="#ref13">13</a>]) that allowed remote code execution due to a flaw in processing authentication on the TCP connection with the management console program. This vulnerability was zero-day-exploited by the APT group BRONZE BUTLER [<a href="#ref14">14</a>] (also known as ‘Tick’).</p>
<p>This software is only used in networks that are protected by a firewall and is not subject to remote exploit attacks. However, if it is installed on a laptop PC, it may run on a global IP address via a mobile hotspot. In such cases, it will be exposed to the risks of remote exploit attack.</p>
<p>When the remote exploit attack is successful, the following file is created and executed on the PC:</p>
<pre>C:\Program Files\Sky Product\SKYSEA Client View\tmp\00000001.BIN</pre>
<p>The attacker can infiltrate the network through the infected PC and spread the infection to other hosts on the network.</p>
<p> </p>
<h3><a class="chapter" name="h3-42-attack-timeline"></a>4.2 Attack timeline</h3>
<p>BRONZE BUTLER used watering hole attacks (e.g. <em>Adobe Flash Player</em> zero-day exploit) as its main attack method until 2016, however, since late 2016 it has shifted to attacks that leverage the above vulnerability. The attack started in June 2016 and continued until February 2019. Figure 12 shows the behaviour related to this attack activity based on observations in the traffic monitoring system operated by JPCERT/CC.</p>
<p>The activity went quiet temporarily in October 2017, but resumed on 15 March 2018. The same vulnerability is being leveraged for the entire period. The scan activity is only observed on the sensors placed in Japan, indicating that the attacker is targeting IP addresses allocated to Japan.</p>
<p><a class="zoom-img" title="Figure 12: Scan count attempting to leverage a vulnerability in SKYSEA Client View (Observation using TSUBAME)." href="/files/2115/7346/6461/4.1.png"><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/2115/7346/6461/4.1.png" alt="4.1.png" width="1235" height="730" /></a></p>
<p class="centered-caption">Figure 12: Scan count attempting to leverage a vulnerability in SKYSEA Client View (Observation using TSUBAME<a href="#footnote1"><sup>1</sup></a>).</p>
<p> </p>
<h3><a class="chapter" name="h3-43-malware-infections-exploiting-vulnerability"></a>4.3 Malware infections exploiting this vulnerability</h3>
<p>The following three types of malware are used in this attack:</p>
<ul>
<li>Wali</li>
<li>Small downloader</li>
<li>NodeRAT</li>
</ul>
<p>Wali [<a href="#ref15">15</a>] was used from 2016 to May 2017, and another small downloader was used from around July 2017. Before March 2018, the attackers used to leverage Wali and the small downloader in order to spread xxmm [<a href="#ref16">16</a>] and Datper [<a href="#ref17">17</a>], however, the distributed malware changed to another kind after that.</p>
<p> </p>
<h4><a class="chapter" name="h4-wali"></a>Wali</h4>
<p>Wali is a downloader similar to xxmm. Like xxmm, this malware uses Reflective DLL Injection based on Stephen Fewer’s <em>GitHub</em> code [<a href="#ref18">18</a>]. The pattern of configuration data is also the same (see Figure 13). This malware also has the ability to execute PowerShell commands. When a host is infected by Wali, the attacker sends an encoded PowerShell command to collect information about the host. Figure 14 is an example of a decoded PowerShell command. This command results in the host name, OS version, IP address, username etc. being sent to a C&amp;C server.</p>
<p>After executing the PowerShell commands, the attacker downloads xxmm, etc.</p>
<p><a class="zoom-img" title="Figure 13: Wali (left) and xxmm (right) configuration data patterns." href="/files/5415/7346/6678/4.2.png"><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/d5d6831f7b96e221c591f5bf6ded5f14_f4086.png" alt="4.2.png" width="800" height="255" /></a><span class="centered-caption">Figure 13: Wali (left) and xxmm (right) configuration data patterns.</span></p>
<p><a class="zoom-img" title="Figure 14: Received PowerShell commands." href="/files/8815/7346/8670/4.3.png"><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/dece9e2d92802294ad888a2671f8d51b_f4087.png" alt="4.3.png" width="800" height="402" /></a><span class="centered-caption">Figure 14: Received PowerShell commands.</span></p>
<p> </p>
<h4><a class="chapter" name="h4-small-downloader"></a>Small downloader</h4>
<p>Due to the fact that Wali’s behaviour has been analysed and its details published in many reports by security vendors, BRONZE BUTLER stopped using it and changed to another downloader. This downloader only has the function to download and execute PE files. When the malware is executed, it downloads Base64-encoded xxmm. This Base64-encoded data deletes the MZ signature, and six bytes of data, ‘TVqQAA’ (MZ signature in Base64), are added before decoding. Figure 15 shows the code used to decode the Base64 data.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/4715/7346/8762/4.4.png" alt="4.4.png" width="682" height="224" /><span class="centered-caption">Figure 15: Received Base64-encoded xxmm.</span></p>
<p> </p>
<h4><a class="chapter" name="h4-noderat"></a>NodeRAT</h4>
<p>NodeRAT is written in JavaScript and runs on Node.js. NodeRAT is a multi-platform malware which operates in any environment as long as Node.js is installed. This implies that the adversary targets <em>macOS</em> and others as well as <em>Windows</em>. Figure 16 is an example of source code that changes the command to execute depending on the environment. This malware operates according to the JSON configuration information as shown in Figure 17. Table 4 is the list of files that are created when a victim is infected with the malware. If a remote exploit attack succeeds, node.exe will be installed because Node.js is not on <em>Windows</em> OS.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/3baae0038ec64a6e26ca7f25e2c9d663_f4089.png" alt="4.5.png" width="680" height="657" /><span class="centered-caption"> Figure 16: app.js source code.</span></p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/fbb246aa3811116573e723d1d2954bc2_f4090.png" alt="4.6.png" width="480" height="435" /><span class="centered-caption">Figure 17: NodeRAT configuration file.</span></p>
<p> </p>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td><strong>File/folder name</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr>
<td>app.js</td>
<td>Malware itself</td>
</tr>
<tr>
<td>node.exe</td>
<td>Node.js</td>
</tr>
<tr>
<td>flash.vbs</td>
<td>Script to execute app.js</td>
</tr>
<tr>
<td>config.regeditKey.rc</td>
<td>Registry entry information</td>
</tr>
<tr>
<td>config\auto.json</td>
<td>File to temporarily save configuration</td>
</tr>
<tr>
<td>config\app.json</td>
<td>Communication destination</td>
</tr>
<tr>
<td>tools\getProxy.exe</td>
<td>Tool to obtain proxy information</td>
</tr>
<tr>
<td>tools\uninstaller.exe</td>
<td>Tool to uninstall malware</td>
</tr>
</tbody>
</table>
<p class="centered-caption">Table 4: Files created when infected<a href="#footnote2"><sup>2</sup></a>.</p>
<p> </p>
<h3><a class="chapter" name="h3-44-attack-infrastructure"></a>4.4 Attack infrastructure</h3>
<p>The remote attack had several attributes corresponding with the attacker’s infrastructure. The attributes will be illustrated below.</p>
<p> </p>
<h4><a class="chapter" name="h4-attacking-ip-address"></a>Attacking IP address</h4>
<p>Although the remote exploit attack lasted a long time, only the three IP addresses listed below were used. In particular, 180.150.227.72 was used in many cases:</p>
<ul>
<li>107.189.139.237</li>
<li>180.150.227.72</li>
<li>27.255.84.171</li>
</ul>
<p> </p>
<h4><a class="chapter" name="h4-campc-server"></a>C&amp;C server</h4>
<p>Compromised websites were used as C&amp;C servers in this attack, with ChinaChopper [<a href="#ref19">19</a>] installed as a backdoor. This C&amp;C panel, to which malware is connected, is created in PHP. The data sent from the malware is stored on the server, but the C&amp;C panel does not decrypt the data because there is no decryption key. The attackers also connect to the C&amp;C panel in order to download data. Figure 18 shows the source code for the xxmm and Datper PHP panels – there are similarities in the features. The victim IP addresses connected to the C&amp;C panel are from Korea, USA and Japan.</p>
<p><a class="zoom-img" title="Figure 18: xxmm C&amp;C panel source code (left: xxmm, right: Datper)." href="/files/6115/7346/9344/4.7.png"><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/882dd64cb8110e7cdbf0575de5558687_f4091.png" alt="4.7.png" width="800" height="692" /></a></p>
<p class="centered-caption">Figure 18: xxmm C&amp;C panel source code (left: xxmm, right: Datper).</p>
<p>The file ‘index_old.php’ was embedded by the attackers in many of the C&amp;C servers. This PHP file is loaded on an infected website (Figure 19) and records the IP address and User-Agent of the users accessing the site in ‘htaccess.log’ (Figure 20). It is likely that BRONZE BUTLER selects an attack target based on these access logs. We observed many cases in which ‘index_old.php’ was embedded on Japanese websites.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/6065b8bd09f569078ae28552ff506564_f4092.png" alt="4.8.png" width="800" height="381" /> <span class="centered-caption">Figure 19: Infected website loading index_old.php.</span></p>
<p class="centered-caption"><a class="zoom-img" title="Figure 20: Access log recorded in htaccess.log." href="/files/9715/7346/9443/4.9.png"><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/90134c7db6119f35500d363effc2ae48_f4093.png" alt="4.9.png" width="840" height="436" /></a>Figure 20: Access log recorded in htaccess.log.</p>
<p> </p>
<h2><a class="chapter" name="h2-5-discussion-apt-campaigns-targeting-japan"></a>5. Discussion of APT campaigns targeting Japan</h2>
<p>The chart shown in Figure 21 describes the timeline of APT campaigns that targeted Japanese organizations.</p>
<p>As for the campaign conducted by APT10, spear-phishing emails were distributed to Japanese organizations in October 2016. The campaign is referred to as ‘Operation Cloud Hopper’ by PwC [<a href="#ref20">20</a>]. Different types of malware, such as ChChes [<a href="#ref21">21</a>] and RedLeaves [<a href="#ref22">22</a>], were used in the campaign. The spear-phishing emails impersonated a specific individual and were sent with a malware-embedded decoy document regarding international politics. Most of the emails were sent from free webmail services.</p>
<p>BlackTech is an APT group that is associated with malware such as TSCookie [<a href="#ref23">23</a>] (also referred to as ‘PLEAD’ by <em>Trend Micro</em> [<a href="#ref24">24</a>]). As an example, emails that impersonated the Ministry of Education, Culture, Sports, Science and Technology of Japan and that led to TSCookie infection were distributed in January 2018.</p>
<p>In the Winnti group’s attack campaign, code-signing certificates were stolen, which were used illegitimately to authenticate malware and attack tools. The Winnti malware [<a href="#ref25">25</a>] used in the campaign has three file components: an installer, a loader (to load the malware), and the malware itself. From 2015 to 2016, a particular sector was targeted by this campaign, which resulted in code‑signing certificates being stolen and Winnti malware infection in victim organizations.</p>
<p>This section describes the attack campaigns observed in Japan, which were conducted by the following APT groups by leveraging the vulnerabilities described in Chapters 2 to 4.</p>
<ul>
<li>APT17</li>
<li>Cloudy Omega / Blue Termite</li>
<li>BRONZE BUTLER</li>
</ul>
<p><a class="zoom-img" title="Figure 21: APT campaign timelines." href="/files/1515/7346/9545/5.1.png"><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/72432a74fd8e51fb9393c70dd3f988e1_f4094.png" alt="5.1.png" width="840" height="375" /></a></p>
<p class="centered-caption">Figure 21: APT campaign timelines.</p>
<p> </p>
<h3><a class="chapter" name="h3-51-apt17"></a>5.1 APT17</h3>
<h4><a class="chapter" name="h4-attack-timeline"></a>Attack timeline</h4>
<p>From August to September 2013, watering hole attacks leveraging a zero-day vulnerability in <em>Internet Explorer</em> were observed. The August campaign is referred to as ‘Operation DeputyDog’ [<a href="#ref26">26</a>] and the September campaign as ‘Operation Ephemeral Hydra’ [<a href="#ref27">27</a>] (both by <em>FireEye</em>), and the series of attacks are considered to be related.</p>
<p>In 2014 through to 2015, malware that had been used in Operation DeputyDog was distributed by compromising software updating systems (a so-called ‘supply chain attack’). IP addresses that were used in the supply chain attack in 2015 were also referred to in the IoCs associated with APT17 in a <em>FireEye</em> report [<a href="#ref28">28</a>].</p>
<p> </p>
<h4><a class="chapter" name="h4-initial-access"></a>Initial access</h4>
<p>APT17 actors used watering hole attacks and supply chain attacks as a means to gain initial access to victim networks.</p>
<p> </p>
<h4><a class="chapter" name="h4-watering-hole-attack"></a>Watering hole attack</h4>
<p>The watering hole attacks observed in August 2013 leveraged a zero-day vulnerability in<em> Internet Explorer</em> (CVE-2013-3893) [<a href="#ref29">29</a>] and eventually infected victims with Agtid (see section 3). The attacks observed in September 2013 leveraged another zero-day vulnerability in <em>Internet Explorer</em> (CVE-2013-3918) [<a href="#ref30">30</a>]. In these cases, the PlugX malware, a plug-in-based bot known as McRAT and a tunnelling tool, Htran [<a href="#ref31">31</a>], were later found in the victim’s environment.</p>
<p>In the watering hole attack observed in 2014, the domain registration information of a legitimate website had been altered so that the name resolution was performed on a DNS server that the attacker had configured. The server processed DNS queries only for certain subdomains according to the iptable’s rules, and other DNS queries were transferred to a legitimate DNS server (Figure 22).</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/81cae209c3b2cf7123fdf51efb97f665_f4095.png" alt="5.2.png" width="600" height="385" /> <span class="centered-caption">Figure 22: Domain name hijacking.</span></p>
<p> </p>
<h4><a class="chapter" name="h4-supply-chain-attack"></a>Supply chain attack</h4>
<p>In the supply chain attack, altered files on legitimate update servers or DNAT configuration changes in iptables resulted in software update requests being redirected to an illegitimate server (Figure 23). If the software update downloaded from the malicious server was executed, the device was then infected with a downloader, and a bot program was installed. Analysis of an affected device revealed that it was also infected with several types of malware such as Agtid, Derusbi [<a href="#ref32">32</a>] and BLACKCOFFEE [<a href="#ref33">33</a>].</p>
<p>The compromised update server was found embedded with the backdoor program ‘mod_rootme’ [<a href="#ref34">34</a>], which operates as an apache module. Mod_rootme can send HTTP requests with specific strings included so that the remote attacker can access the backdoor with root privileges. In addition, the ‘pam_unix.so’ module on the server was also compromised, allowing any user to log in with a specific password and harvest credentials of legitimate users who had logged into the service. .htaccess and iptables in the server used as an infrastructure were configured to accept access from the IP address range that belongs to the target organizations.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/5bc80f09602eb276599a7b5125c9eea2_f4096.png" alt="5.3.png" width="600" height="316" /> <span class="centered-caption">Figure 23: Update hijacking.</span></p>
<p> </p>
<h4><a class="chapter" name="h4-lateral-movement"></a>Lateral movement</h4>
<p>Devices that were infected with the bot program in the initial access phase were then remotely controlled by the attacker via commands provided from a C&amp;C server, and reconnaissance activities were conducted. In addition to the standard <em>Windows</em> commands and Active Directory tools (e.g. dsget [<a href="#ref35">35</a>] and dsquery [<a href="#ref36">36</a>]) used to steal network and Active Directory information, other tools for network scans, SQL server investigation and password hash dumps were also used. After harvesting the domain admin’s credentials, remote attackers gained access to the domain controller using the pass-the-hash technique.</p>
<p> </p>
<h3><a class="chapter" name="h3-52-cloudy-omega-blue-termite"></a>5.2 Cloudy Omega / Blue Termite</h3>
<h4><a class="chapter" name="h4-attack-timeline"></a>Attack timeline</h4>
<p>According to <em>Symantec</em>, the Emdivi malware, which is related to the APT campaigns referred to as ‘Cloudy Omega’ by <em>Symantec</em> and as ‘Blue Termite’ by <em>Kaspersky</em>, has been seen since 2011 [<a href="#ref37">37</a>].</p>
<p>In 2013, a compromised website was found embedded with a Java Applet which leverages a Java vulnerability (CVE-2011-3544) [<a href="#ref38">38</a>], resulting in Emdivi being downloaded to visitors’ devices (a drive-by download attack). From May 2014 to September 2015, spear-phishing emails leading to Emdivi infection were distributed to a number of organizations in Japan.</p>
<p> </p>
<h4><a class="chapter" name="h4-initial-access"></a>Initial access</h4>
<p>Spear-phishing emails and a watering hole attack were the main attack vectors for initial access. In 2014 and 2015, numerous spear-phishing emails impersonating a health insurance society were observed (Figure 24). Most of the emails had the Emdivi executable file attached, with a fake icon. Emails observed in November 2014 had a document attachment leveraging an <em>Ichitaro</em> vulnerability (CVE-2014-7247) (see section 3).</p>
<p>In July 2015, drive-by download attacks leading to Emdivi infection were confirmed. Attackers leveraged a zero-day vulnerability in<em> Adobe Flash Player</em> (which was disclosed by <em>Hacking Team</em> [<a href="#ref39">39</a>]) to spread malware.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/8915/7346/9798/5.4.png" alt="5.4.png" width="569" height="205" /> <span class="centered-caption">Figure 24: A spear-phishing email impersonating a health insurance society.</span></p>
<p> </p>
<h4><a class="chapter" name="h4-lateral-movement"></a>Lateral movement</h4>
<p>After successfully intruding into the target’s network through Emdivi-infected devices, attackers investigated the network drive using standard <em>Windows</em> commands such as ‘net’ and ‘wmic’. When they found a file they wanted, they compressed it with <em>WinRAR</em> and send it to a C&amp;C server using the Emdivi download command. The compressed file was then deleted so that there would be no evidence.</p>
<p>In addition, attackers used Active Directory tools such as csvde [<a href="#ref40">40</a>] and dsquery to dump or search for credentials. Vulnerabilities in the kernel-mode driver (CVE-2014-4113) [<a href="#ref41">41</a>] and Kerberos KDC (CVE-2014-6324) [<a href="#ref42">42</a>] were leveraged for privilege escalation, and tools such as Quarks PwDump [<a href="#ref43">43</a>], Mimikatz [<a href="#ref44">44</a>] and Windows Credential Editor [<a href="#ref45">45</a>] were used for credential harvesting.</p>
<p>Once the attackers had obtained domain admin credentials, they copied malware to other devices and registered the task to execute it taking advantage of the privilege. Devices that were affected by the secondary infection had a downloader installed, which was configured to communicate only on certain days of the week. Even if the first affected device was repaired or replaced, attackers were still able to distribute Emdivi to other infected devices through the downloader and were able to maintain a continuous presence on the victim’s network.</p>
<p> </p>
<h3><a class="chapter" name="h3-53-bronze-butler-tick"></a>5.3 BRONZE BUTLER / Tick</h3>
<h4><a class="chapter" name="h4-attack-timeline"></a>Attack timeline</h4>
<p><em>Symantec</em> reports that the attack campaign by BRONZE BUTLER (referred to as ‘Tick’ by <em>Symantec</em>) started around 2006 [<a href="#ref46">46</a>]. In 2015, watering hole attacks leveraging a zero-day vulnerability in <em>Adobe Flash Player</em> (disclosed by <em>Hacking Team</em>) were observed. Since 2016, scans targeting a vulnerability in asset management software have been observed, which was still ongoing in 2018 (see section 4).</p>
<p> </p>
<h4><a class="chapter" name="h4-initial-access"></a>Initial access</h4>
<p>While a watering hole attack was the major attack vector during 2014 and 2015, since 2016 the attack has begun with scans targeting a vulnerability in asset management software. According to some public reports, spear-phishing emails were also used prior to 2014. The attackers attempt to infect victims with a downloader, such as Wali, by leveraging a vulnerability so that an HTTP bot is downloaded from a C&amp;C server to the victim’s environment. Until early 2016 the HTTP bot used in the attack was Daserf; from mid-2015 to mid-2016 the Delphi version of Daserf was used, and after that it shifted to xxmm and Datper.</p>
<p> </p>
<h4><a class="chapter" name="h4-lateral-movement"></a>Lateral movement</h4>
<p>Once the attackers had entered a victim’s network through a bot-infected device, they created batch files to collect network environment information using standard <em>Windows</em> commands (e.g. dir, net, tasklist, ipconfig). Using the Domain Admin’s privilege, they executed the ‘net use’ command to connect to remote devices and send files with ‘copy’ and ‘move’ commands. Other commands used were ‘at’ and ‘schtacks’ to register tasks, and ‘Psexec’ in <em>Windows Sysinternals</em> [<a href="#ref47">47</a>] to execute files.</p>
<p>Collected information was compressed to a certain size using <em>WinRAR</em> and divided into pieces. After having been sent to an external server, it was deleted. The compressed file, including the header, was encrypted by <em>WinRAR</em>. Even if the file is recovered, the compressed contents cannot be retrieved unless the password is available. In some cases, the attackers sent files to an external server using free file upload services.</p>
<p>During the lateral movement phase, Mimikatz and Windows Credential Editor were used to harvest credentials and create golden/silver tickets. While a vulnerability in the SMBv1 protocol (MS17-010) [<a href="#ref48">48</a>] was addressed and a patch was released in March 2017, a tool which exploits this vulnerability, known as ‘Double Pulsar’, was used for lateral movement in April 2017.</p>
<p>Attackers set up a VBScript-based downloader in a victim’s device to perform communication with a C&amp;C server only once upon the user’s login. This way, the attackers were able to maintain access to the network for a while.</p>
<p> </p>
<h2><a class="chapter" name="h2-conclusion"></a>Conclusion</h2>
<p>In this paper, we described targeted attacks against Japanese organizations exploiting three different zero-day vulnerabilities. The software in these cases is used only in Japan and is not distributed outside of the country. Nevertheless, the APT groups investigated these software vulnerabilities and leveraged them for attacks. Unlike more popular software, it is often the case that countermeasures against vulnerabilities in such region-specific software are not well prepared. Attackers understand and aim at such weak points. In preparation for future APT cases, security countermeasures for local software also need to be considered. As well as supply chain attacks, the targeting of local software vulnerabilities continues to be a problem. Details of attacks that target local software vulnerabilities are not usually available outside of the country in question, but ideally such information should also be published in the future. Such information will help analysts to better understand the threat landscape in different regions and could be useful in considering countermeasures against similar attacks in their own regions.</p>
<p> </p>
<h2><a class="chapter" name="h2-references"></a>References</h2>
<p><a class=" anchor" name="ref1"></a>[1] Cha, M (J). VB2018 paper: Since the hacking of Sony Pictures. <a href="https://www.virusbulletin.com/virusbulletin/2018/11/vb2018-paper-hacking-sony-pictures/" target="_blank">https://www.virusbulletin.com/virusbulletin/2018/11/vb2018-paper-hacking-sony-pictures/</a>.</p>
<p><a class=" anchor" name="ref2"></a>[2] Japan Vulnerablility Note: JVNDB-2014-000011 Sanshiro Series vulnerable to arbitrary code execution. <a href="https://jvndb.jvn.jp/en/contents/2014/JVNDB-2014-000011.html" target="_blank">https://jvndb.jvn.jp/en/contents/2014/JVNDB-2014-000011.html</a>.</p>
<p><a class=" anchor" name="ref3"></a>[3] Trend Micro security blog: Confirmed zero-day attack leveraging Japanese spreadsheet software “Sanshiro” (Japanese). <a href="https://blog.trendmicro.co.jp/archives/8529" target="_blank">https://blog.trendmicro.co.jp/archives/8529</a>.</p>
<p><a class=" anchor" name="ref4"></a>[4] Haruyama, T.; Suzuki, H. I Know You Want Me – Unplugging PlugX. Black Hat Asia 2014. <a href="https://www.blackhat.com/docs/asia-14/materials/Haruyama/Asia-14-Haruyama-I-Know-You-Want-Me-Unplugging-PlugX.pdf" target="_blank">https://www.blackhat.com/docs/asia-14/materials/Haruyama/Asia-14-Haruyama-I-Know-You-Want-Me-Unplugging-PlugX.pdf</a>.</p>
<p><a class=" anchor" name="ref5"></a>[5] Microsoft Security Bulletin: MS12-027 – Critical. <a href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2012/ms12-027" target="_blank">https://docs.microsoft.com/en-us/security-updates/securitybulletins/2012/ms12-027</a>.</p>
<p><a class=" anchor" name="ref6"></a>[6] Adobe Security Advisories: APSA11-04 – Security Advisory for Adobe Reader and Acrobat. <a href="https://www.adobe.com/support/security/advisories/apsa11-04.html" target="_blank">https://www.adobe.com/support/security/advisories/apsa11-04.html</a>.</p>
<p><a class=" anchor" name="ref7"></a>[7] Japan Vulnerablility Note: JVNDB-2013-000103 Ichitaro series vulnerable to arbitrary code execution. <a href="https://jvndb.jvn.jp/en/contents/2013/JVNDB-2013-000103.html" target="_blank">https://jvndb.jvn.jp/en/contents/2013/JVNDB-2013-000103.html</a>.</p>
<p><a class=" anchor" name="ref8"></a>[8] JustSystems Corporation: Possible execution of malicious program leveraging Sanshiro vulnerability (Japanese). <a href="https://www.justsystems.com/jp/info/js14001.html" target="_blank">https://www.justsystems.com/jp/info/js14001.html</a>.</p>
<p><a class=" anchor" name="ref9"></a>[9] Attackers Target Organizations in Japan; Transform Local Sites into C&amp;C Servers for EMDIVI Backdoor. TrendLabs Security Intelligence Blog. <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/attackers-target-organizations-in-japan-transform-local-sites-into-cc-servers-for-emdivi-backdoor/" target="_blank">https://blog.trendmicro.com/trendlabs-security-intelligence/attackers-target-organizations-in-japan-transform-local-sites-into-cc-servers-for-emdivi-backdoor/</a>.</p>
<p><a class=" anchor" name="ref10"></a>[10] Moran, N.; Villeneuve, N. Operation DeputyDog: Zero-Day (CVE-2013-3893) Attack Against Japanese Targets. FireEye. <a href="https://www.fireeye.com/blog/threat-research/2013/09/operation-deputydog-zero-day-cve-2013-3893-attack-against-japanese-targets.html" target="_blank">https://www.fireeye.com/blog/threat-research/2013/09/operation-deputydog-zero-day-cve-2013-3893-attack-against-japanese-targets.html</a>.</p>
<p><a class=" anchor" name="ref11"></a>[11] Ishimaru, S. New activity of The Blue Termite APT. Securelist. <a href="https://securelist.com/new-activity-of-the-blue-termite-apt/71876/" target="_blank">https://securelist.com/new-activity-of-the-blue-termite-apt/71876/</a>.</p>
<p><a class=" anchor" name="ref12"></a>[12] Hiding in Plain Sight: FireEye and Microsoft Expose Chinese APT Group’s Obfuscation Tactic. FireEye. <a href="https://www.fireeye.com/blog/threat-research/2015/05/hiding_in_plain_sigh.html" target="_blank">https://www.fireeye.com/blog/threat-research/2015/05/hiding_in_plain_sigh.html</a>.</p>
<p><a class=" anchor" name="ref13"></a>[13] JVNDB-2016-000249: SKYSEA Client View vulnerable to arbitrary code execution. <a href="https://jvndb.jvn.jp/en/contents/2016/JVNDB-2016-000249.html" target="_blank">https://jvndb.jvn.jp/en/contents/2016/JVNDB-2016-000249.html</a>.</p>
<p><a class=" anchor" name="ref14"></a>[14] Secureworks: BRONZE BUTLER Targets Japanese Enterprises. <a href="https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses" target="_blank">https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses</a>.</p>
<p><a class=" anchor" name="ref15"></a>[15] Dahan, A. Cybereason: ShadowWali: New variant of the xxmm family of backdoors. <a href="https://www.cybereason.com/labs-blog/labs-shadowwali-new-variant-of-the-xxmm-family-of-backdoors" target="_blank">https://www.cybereason.com/labs-blog/labs-shadowwali-new-variant-of-the-xxmm-family-of-backdoors</a>.</p>
<p><a class=" anchor" name="ref16"></a>[16] Ishimaru, S. Securelist: Old Malware Tricks To Bypass Detection in the Age of Big Data. <a href="https://securelist.com/blog/research/78010/old-malware-tricks-to-bypass-detection-in-the-age-of-big-data/" target="_blank">https://securelist.com/blog/research/78010/old-malware-tricks-to-bypass-detection-in-the-age-of-big-data/</a>.</p>
<p><a class=" anchor" name="ref17"></a>[17] Detecting Datper Malware from Proxy Logs. JPCERT/CC. <a href="https://blogs.jpcert.or.jp/en/2017/08/detecting-datper-malware-from-proxy-logs.html" target="_blank">https://blogs.jpcert.or.jp/en/2017/08/detecting-datper-malware-from-proxy-logs.html</a>.</p>
<p><a class=" anchor" name="ref18"></a>[18] ReflectiveDLLInjection. GitHub. <a href="https://github.com/stephenfewer/ReflectiveDLLInjection" target="_blank">https://github.com/stephenfewer/ReflectiveDLLInjection</a>.</p>
<p><a class=" anchor" name="ref19"></a>[19] China Chopper. MITRE ATT&amp;CK. <a href="https://attack.mitre.org/software/S0020/" target="_blank">https://attack.mitre.org/software/S0020/</a>.</p>
<p><a class=" anchor" name="ref20"></a>[20] Operation Cloud Hopper. PwC UK. <a href="https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html" target="_blank">https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html</a>.</p>
<p><a class=" anchor" name="ref21"></a>[21] ChChes – Malware that Communicates with C&amp;C Servers Using Cookie Headers. JPCERT/CC. <a href="https://blogs.jpcert.or.jp/en/2017/02/chches-malware--93d6.html" target="_blank">https://blogs.jpcert.or.jp/en/2017/02/chches-malware--93d6.html</a>.</p>
<p><a class=" anchor" name="ref22"></a>[22] RedLeaves – Malware Based on Open Source RAT. JPCERT/CC. <a href="https://blogs.jpcert.or.jp/en/2017/04/redleaves---malware-based-on-open-source-rat.html" target="_blank">https://blogs.jpcert.or.jp/en/2017/04/redleaves---malware-based-on-open-source-rat.html</a>.</p>
<p><a class=" anchor" name="ref23"></a>[23] Malware “TSCookie”. JPCERT/CC. <a href="https://blogs.jpcert.or.jp/en/2018/03/malware-tscooki-7aa0.html" target="_blank">https://blogs.jpcert.or.jp/en/2018/03/malware-tscooki-7aa0.html</a>.</p>
<p><a class=" anchor" name="ref24"></a>[24] Bermejo, L.; Huang, R.; Lei, CH. Following the Trail of BlackTech’s Cyber Espionage Campaigns. Trend Micro blog. <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/following-trail-blacktech-cyber-espionage-campaigns/" target="_blank">https://blog.trendmicro.com/trendlabs-security-intelligence/following-trail-blacktech-cyber-espionage-campaigns/</a>.</p>
<p><a class=" anchor" name="ref25"></a>[25] Winnti Analysis. Novetta. <a href="https://www.novetta.com/wp-content/uploads/2015/04/novetta_winntianalysis.pdf" target="_blank">https://www.novetta.com/wp-content/uploads/2015/04/novetta_winntianalysis.pdf</a>.</p>
<p><a class=" anchor" name="ref26"></a>[26] Caselden, D.; Chen, X. Operation DeputyDog Part 2: Zero-Day Exploit Analysis (CVE‑2013-3893). FireEye. https://www.fireeye.com/blog/threat-research/2013/09/operation-deputydog-part-2-zero-day-exploit-analysis-cve-2013-3893.html.</p>
<p><a class=" anchor" name="ref27"></a>[27] Moran, N.; Omkar Vashisht, S.; Scott, M. Thoufique Haq Operation Ephemeral Hydra: IE Zero-Day Linked to DeputyDog Uses Diskless Method. FireEye. <a href="https://www.fireeye.com/blog/technical/cyber-exploits/2013/11/operation-ephemeral-hydra-ie-zero-day-linked-to-deputydog-uses-diskless-method.html" target="_blank">http://www.fireeye.com/blog/technical/cyber-exploits/2013/11/operation-ephemeral-hydra-ie-zero-day-linked-to-deputydog-uses-diskless-method.html</a>.</p>
<p><a class=" anchor" name="ref28"></a>[28] fireeye/iocs/APT17/7b9e87c5-b619-4a13-b862-0145614d359a.ioc. GitHub. <a href="https://github.com/fireeye/iocs/blob/master/APT17/7b9e87c5-b619-4a13-b862-0145614d359a.ioc" target="_blank">https://github.com/fireeye/iocs/blob/master/APT17/7b9e87c5-b619-4a13-b862-0145614d359a.ioc</a>.</p>
<p><a class=" anchor" name="ref29"></a>[29] Microsoft Security Advisory 2887505. <a href="https://docs.microsoft.com/en-us/security-updates/securityadvisories/2013/2887505" target="_blank">https://docs.microsoft.com/en-us/security-updates/securityadvisories/2013/2887505</a>.</p>
<p><a class=" anchor" name="ref30"></a>[30] Microsoft Security Bulletin MS13-090 – Critical. <a href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2013/ms13-090" target="_blank">https://docs.microsoft.com/en-us/security-updates/securitybulletins/2013/ms13-090</a>.</p>
<p><a class=" anchor" name="ref31"></a>[31] HTRAN. MITRE ATT&amp;CK. <a href="https://attack.mitre.org/software/S0040/" target="_blank">https://attack.mitre.org/software/S0040/</a>.</p>
<p><a class=" anchor" name="ref32"></a>[32] Derusbi. Novetta. <a href="https://www.novetta.com/wp-content/uploads/2014/11/Derusbi.pdf" target="_blank">https://www.novetta.com/wp-content/uploads/2014/11/Derusbi.pdf</a>.</p>
<p><a class=" anchor" name="ref33"></a>[33] BLACKCOFFEE. MITRE ATT&amp;CK. <a href="https://attack.mitre.org/software/S0069/" target="_blank">https://attack.mitre.org/software/S0069/</a>.</p>
<p><a class=" anchor" name="ref34"></a>[34] mod_rootme. GitHub. <a href="https://github.com/jingchunzhang/backdoor_rootkit/tree/master/mod_rootme-0.4" target="_blank">https://github.com/jingchunzhang/backdoor_rootkit/tree/master/mod_rootme-0.4</a>.</p>
<p><a class=" anchor" name="ref35"></a>[35] Microsoft docs: Dsget. <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc755162(v%3dws.11)" target="_blank">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc755162(v%3dws.11)</a>.</p>
<p><a class=" anchor" name="ref36"></a>[36] Microsoft docs: Dsquery. <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc732952(v%3Dws.11)" target="_blank">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc732952(v%3Dws.11)</a>.</p>
<p><a class=" anchor" name="ref37"></a>[37] Operation CloudyOmega: Ichitaro zero-day and ongoing cyberespionage campaign targeting Japan. Symantec. <a href="https://www.symantec.com/connect/blogs/operation-cloudyomega-ichitaro-zero-day-and-ongoing-cyberespionage-campaign-targeting-japan" target="_blank">https://www.symantec.com/connect/blogs/operation-cloudyomega-ichitaro-zero-day-and-ongoing-cyberespionage-campaign-targeting-japan</a>.</p>
<p><a class=" anchor" name="ref38"></a>[38] Oracle: Oracle Java SE Critical Patch Update Advisory – October 2011. <a href="https://www.oracle.com/technetwork/topics/security/javacpuoct2011-443431.html" target="_blank">https://www.oracle.com/technetwork/topics/security/javacpuoct2011-443431.html</a>.</p>
<p><a class=" anchor" name="ref39"></a>[39] Adobe Help Center: APSB15-16. <a href="https://helpx.adobe.com/security/products/flash-player/apsb15-16.html" target="_blank">https://helpx.adobe.com/security/products/flash-player/apsb15-16.html</a>.</p>
<p><a class=" anchor" name="ref40"></a>[40] Microsoft docs: Csvde. <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc732101(v%3Dws.11)" target="_blank">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc732101(v%3Dws.11)</a>.</p>
<p><a class=" anchor" name="ref41"></a>[41] Microsoft Security Bulletin MS14-058 – Critical. <a href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2014/ms14-058" target="_blank">https://docs.microsoft.com/en-us/security-updates/securitybulletins/2014/ms14-058</a>.</p>
<p><a class=" anchor" name="ref42"></a>[42] Microsoft Security Bulletin MS14-068 – Critical. <a href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2014/ms14-068" target="_blank">https://docs.microsoft.com/en-us/security-updates/securitybulletins/2014/ms14-068</a>.</p>
<p><a class=" anchor" name="ref43"></a>[43] Quarks PwDump. Quarkslab. <a href="https://blog.quarkslab.com/quarks-pwdump.html" target="_blank">https://blog.quarkslab.com/quarks-pwdump.html</a>.</p>
<p><a class=" anchor" name="ref44"></a>[44] Mimikatz. GitHub. <a href="https://github.com/gentilkiwi/mimikatz" target="_blank">https://github.com/gentilkiwi/mimikatz</a>.</p>
<p><a class=" anchor" name="ref45"></a>[45] Amplia Security: Research. <a href="http://www.ampliasecurity.com/research.html" target="_blank">http://www.ampliasecurity.com/research.html</a>.</p>
<p><a class=" anchor" name="ref46"></a>[46] ick cyberespionage group zeros in on Japan. Symantec. <a href="https://www.symantec.com/connect/blogs/operation-cloudyomega-ichitaro-zero-day-https://www.symantec.com/connect/blogs/tick-cyberespionage-group-zeros-japan" target="_blank">https://www.symantec.com/connect/blogs/operation-cloudyomega-ichitaro-zero-day-https://www.symantec.com/connect/blogs/tick-cyberespionage-group-zeros-japan</a>.</p>
<p><a class=" anchor" name="ref47"></a>[47] Microsoft Docs: PsExec – Windows Sysinternals. <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psexec" target="_blank">https://docs.microsoft.com/en-us/sysinternals/downloads/psexec</a>.</p>
<p><a class=" anchor" name="ref48"></a>[48] Microsoft Security Bulletin MS17-010 – Critical. <a href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010" target="_blank">https://docs.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010</a>.</p>
<p> </p>
<h2><a class="chapter" name="h2-appendix-iocs"></a>Appendix: IoCs</h2>
<h3><a class="chapter" name="h3-sha-256"></a>SHA 256</h3>
<p><strong>Section 2</strong></p>
<ul>
<li>d35238d8847e757c09551fce51572a388d82ece7aadcb7d65284ae84bd2f22a8</li>
<li>74b7b7eb372d1b345199f107ee8cc5476dfe4cacc9163c326b37155ccf97e9e9</li>
<li>8e82b3531a9a6abfeb115dcbf952ac3d0cd8e7c6f39b6108f8be2e621f9f73fe</li>
<li>b0ddac69576dfc1ebd02e195b29b19812547758043c13acd4ffa408f954bc7e2</li>
</ul>
<p><strong>Section 3</strong></p>
<p>CVE-2014-7247 (<em>Ichitaro</em> document)</p>
<ul>
<li>920300763729a300863c5de1b3850f2ceac2c7688011d8423f80d3989dbd8a1f</li>
<li>c4a6588e642dcc7d66c71c179417dc14a784600c709c69a8946158ce2daf1fae</li>
<li>1eac1ee41016f4b515874f66a5c03b35fc07ad35073b58583861f0d08cd887dd</li>
<li>04283696b53c5d37f9b960172ec57f214b3291f48315d1116bc8d1707c789111</li>
<li>32dad1b131ecfa3e4efb8f9069fae46247bf0a4550163cad172cc9bb688c4fb0</li>
<li>dd06173751257c9a8f24babbc1179e433f1bae5c2b841763b95c1c6890e5b983</li>
<li>4b4584f2d7f1bedd225538ecf4086a06eb600c62cc5f6b0226e9c571cd1d2cc5</li>
</ul>
<p>Emdivi</p>
<ul>
<li>a79cfba79489d45a928ef3794d361898a2da4e1af4b33786d1e0d2759f4924c3</li>
<li>b19a233b07a1342f867aef1b3fb3e473b875bd788832bb9422cacb5df1bda04e</li>
</ul>
<p>PlugX</p>
<ul>
<li>da9090105d40c48b007526ad262de695f67ab7b18e4fe6274d55877821353366</li>
<li>e7a60eec1f66ac089f13f9478dcf06b922bfe4b4f3a4fbbbf054e3202e58519a</li>
</ul>
<p><strong>Section 4</strong></p>
<p>00000001.BIN</p>
<ul>
<li>3955d0340ff6e625821de294acef4bdc0cc7b49606a984517cd985d0aac130a3</li>
<li>a52c3792d8cef6019ce67203220dc191e207c6ddbdfa51ac385d9493ffe2a83a</li>
<li>54f61561a7c5eed7a5eacf298c74ee761b2b398f1db333318140ef2cb672b740</li>
<li>a3145107e2d9b4899263b34e37786719f865efb54d97b6cac65ef1a2e3924838</li>
<li>5c2599fdba24fef1a867552eed0f681ebfb07b47468fdf2a54a85b94fcd0d6f0</li>
</ul>
<p>app.js</p>
<ul>
<li>f36db81d384e3c821b496c8faf35a61446635f38a57d04bde0b3dfd19b674587</li>
<li>f71a3a772f4316ab3c940f94aab3d52eabe7ee9da311b112a12eacfcadddb85e</li>
</ul>
<p>getProxy.exe</p>
<ul>
<li>c6cf0ad6d1e687b185407ee450a5b8e9a8ab60461f5c051251badb245df6245f</li>
</ul>
<p>uninstaller.exe</p>
<ul>
<li>d1617e7ec278484920c05476eabf783d399d6c03e8d8ab69e2f1fcb6a76417b4</li>
</ul>
<h3><a class="chapter" name="h3-campc-servers"></a>C&amp;C servers</h3>
<p><strong>Section 2</strong></p>
<ul>
<li>ngm.dnsdynamic.com</li>
<li>mysql.b0ne.com</li>
<li>service.chatnook.com</li>
<li>inter.so-webmail.com</li>
<li>103.246.112.123</li>
</ul>
<p><strong>Section 3</strong></p>
<p>Emdivi</p>
<ul>
<li>www.dolf.org.hk</li>
</ul>
<p>PlugX</p>
<ul>
<li>sstday.Jkub.com</li>
<li>whellbuy.wschandler.com</li>
</ul>
<p><strong>Section 4</strong></p>
<ul>
<li>www.rakutenline.com</li>
<li>menu.rakutenline.com</li>
<li>www.sa-guard.com</li>
<li>menu.sa-guard.com</li>
<li>www.han-game.com</li>
<li>menu.han-game.com</li>
<li>daydreamsig.com</li>
<li>rsbuae.com</li>
</ul>
<h3><a class="chapter" name="h3-attacking-ip-addresses"></a>Attacking IP addresses</h3>
<p><strong>Section 4</strong></p>
<ul>
<li>107.189.139.237</li>
<li>180.150.227.72</li>
<li>27.255.84.171</li>
</ul>
<h3><a class="chapter" name="h3-backdoor-access-ip-addresses"></a>Backdoor access IP addresses</h3>
<p><strong>Section 4</strong></p>
<ul>
<li>116.193.152.47</li>
<li>1.226.83.34</li>
<li>115.68.52.11</li>
</ul>
<p> </p>
<h2><a class="chapter" name="h2-footnotes"></a>Footnotes</h2>
<p><sup><a class=" anchor" name="footnote1"></a>1 </sup>TSUBAME is a packet traffic monitoring system used to observe suspicious scanning activities.</p>
<p><sup><a class=" anchor" name="footnote2"></a>2 </sup>All files and folders are created under %APPDATA%\Adobe\flash\[random 4-digit alphanumeric string]\bin.</p>
<p> </p> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<p><a href="/uploads/pdf/magazine/2019/VB2019-Tomonaga-etal.pdf" target="_blank"><img src="/uploads/images/buttons/pdf-download-button.jpg" alt="Download PDF" width="262" height="45" /></a></p>
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=VB2019 paper: APT cases exploiting vulnerabilities in region‑specific software&url=https://www.virusbulletin.com/virusbulletin/2020/05/vb2019-paper-apt-cases-exploiting-vulnerabilities-regionspecific-software"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2020/05/vb2019-paper-apt-cases-exploiting-vulnerabilities-regionspecific-software'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2020/05/vb2019-paper-apt-cases-exploiting-vulnerabilities-regionspecific-software&title=VB2019 paper: APT cases exploiting vulnerabilities in region‑specific software"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2020/05/vb2019-paper-apt-cases-exploiting-vulnerabilities-regionspecific-software&t=VB2019 paper: APT cases exploiting vulnerabilities in region‑specific software"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2020/05/vb2019-paper-apt-cases-exploiting-vulnerabilities-regionspecific-software"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p> </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">©1989-2022 Virus Bulletin.        <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>        <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>        <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>