<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: The problem of backscatter â€“ part 2</title>
<meta name="description" content="In the previous part of this series, Terry Zink introduced the problem of backscatter spam, describing what it is and why it is such a problem. He also looked at why it is so difficult to stop. Fortunately, the situation is not hopeless and this month he looks at some of the methods at our disposal to help combat this irritating type of spam." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 2489;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/remo_expand/blocks/remo_expand/templates/vbexpand/view.css" />
<script type="text/javascript" src="/packages/remo_expand/js/jquery.color.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/remo.expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<div class="titlepage" xmlns=""><div><div><h1 class="title" xmlns="http://www.w3.org/1999/xhtml"><a id="sb200810-backscatter-2"></a>The problem of backscatter &ndash; part 2</h1></div><div><p class="pubdate" xmlns="http://www.w3.org/1999/xhtml">2008-09-01</p></div><div><div class="authorgroup" xmlns="http://www.w3.org/1999/xhtml"><div class="author titlepage"><h3 class="author"><span class="firstname">Terry</span> <span class="surname">Zink</span></h3><span class="orgname">Microsoft</span>, <span class="orgdiv">USA</span></div><b class="editedby">Editor: </b><span class="editor"><span class="firstname">Helen</span> <span class="surname">Martin</span></span></div></div><div><div class="abstract" xmlns="http://www.w3.org/1999/xhtml"><p class="title"><b>Abstract</b></p><p>In the previous part of this series, Terry Zink introduced the problem of backscatter spam, describing what it is and why it is such a problem. He also looked at why it is so difficult to stop. Fortunately, the situation is not hopeless and this month he looks at some of the methods at our disposal to help combat this irritating type of spam.</p></div></div><div><p class="copyright" xmlns="http://www.w3.org/1999/xhtml"><i>Copyright &copy; 2008 Virus Bulletin</i></p></div></div><hr /></div>
<div class="ccm-remo-expand">
<div id="ccm-remo-expand-title-4527" class="ccm-remo-expand-title ccm-remo-expand-closed" data-expander-speed="200">Table of contents</div><div id="ccm-remo-expand-content-4527" class="ccm-remo-expand-content"><div class="toc"><dl><dt><span class="sect1"><a href="#id4770726"></a></span></dt><dt><span class="sect1"><a href="#id2309928">Special content filtering</a></span></dt><dt><span class="sect1"><a href="#id4857899">Use SPF</a></span></dt><dt><span class="sect1"><a href="#id4320105">Check to see if you sent the message in the first place</a></span></dt><dt><span class="sect1"><a href="#id4125020">Don&#39;t make the problem worse</a></span></dt><dt><span class="sect1"><a href="#id2253119">An Idiosyncrasy</a></span></dt><dt><span class="sect1"><a href="#id3229757">Summary</a></span></dt></dl></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4770726"></a></h2></div></div></div><p>Last month, we introduced the problem of backscatter spam, describing what it is and why it is such a problem. We also looked at why it is so difficult to stop. Fortunately, the situation is not hopeless and this month we will look at some of the methods we have at our disposal to help combat this irritating type of spam.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id2309928"></a>Special content filtering</h2></div></div></div><p>One technique we can use to help combat backscatter is to block all NDR messages, or at least tag the phrases and characteristics that commonly occur in NDR backscatter as inputs to a spam filter decision. The <span class="emphasis"><em>Spamnation</em></span> website [<span class="citation"><a href="#citation.1">1</a></span>] recommends some fields to examine, in order of usefulness:</p><div class="table"><a class="chapter" id="id2880159"></a><table border="1" summary=""><colgroup><col align="center" /><col /><col /></colgroup><tbody><tr><td align="center"><span class="bold"><strong>Field</strong></span></td><td align="left"><span class="bold"><strong>Test</strong></span></td><td align="left"><span class="bold"><strong>String</strong></span></td></tr><tr><td align="center">From</td><td>contains</td><td>Mailer-Daemon</td></tr><tr><td align="center">From</td><td>contains</td><td><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a6d6c9d5d2cbc7d5d2c3d4e6">[email&#160;protected]</a></td></tr><tr><td align="center">From</td><td>contains</td><td>Mail Administrator</td></tr><tr><td align="center">Subject</td><td>contains</td><td>Returned mail</td></tr><tr><td align="center">Subject</td><td>contains</td><td>Failure notice</td></tr><tr><td align="center">Subject</td><td>contains</td><td>Blocked by our bulk email filter</td></tr><tr><td align="center">Subject</td><td>starts with</td><td>Delivery Status Notification</td></tr><tr><td align="center">Subject</td><td>starts with</td><td>Undelivered Mail Returned to Sender</td></tr><tr><td align="center">Subject</td><td>starts with</td><td>Undeliverable</td></tr><tr><td align="center">Subject</td><td>starts with</td><td>Delivery Notification</td></tr><tr><td align="center">Body</td><td>contains</td><td>Status: 5.1.1</td></tr><tr><td align="center">Body</td><td>contains</td><td>Status: 5.7.1</td></tr></tbody></table><p class="title"><b>Table&nbsp;1.&nbsp;</b></p></div><p>If a spam filter were to look for the above characteristics and block mail based on them, there&rsquo;s a good chance that it would block a very healthy portion of NDR backscatter. The problem is that it would also block a lot of legitimate NDR mail.</p><p>Another, riskier, blocking strategy would be to block all mail with a null sender, &lt;&gt;, in the SMTP MAIL FROM field. As many MTAs will send bounces with null senders (so as not to receive a bounce back if the NDR cannot be delivered), blocking all mail with a null sender will succeed in blocking the bulk of NDRs. However, there are some drawbacks to this:</p><div class="orderedlist"><ol type="1"><li><p>Like the first strategy, blocking on null senders means you will block some legitimate NDRs.</p></li><li><p>Not all null sender messages are NDRs. Some other messages, such as automated reports, use them as well. Other types of quickly written processes, or processes that generate email alerts also use null senders, simply for convenience. Out of office (OOF) notifications also have null senders. Thus, if you block on null senders, you are likely to incur substantial collateral damage.</p></li><li><p>This method is not guaranteed to catch all NDR backscatter. Some MTAs will bounce messages with something like <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="8ae8e5ffe4e9eff9caeff2ebe7fae6efa4e5f8ed">[email&#160;protected]</a>, <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="bdcdd2cec9d0dccec9d8cffdd8c5dcd0cdd1d893ded2d0">[email&#160;protected]</a>, or similar.</p></li></ol></div><p>There are some mail delivery systems that already refuse to route mail with an empty sender due to the excessive abuse of backscatter. These systems are prone to the false positive problems described above. You can get around this by setting inbound &lsquo;allow&rsquo; policy rules for other characteristics, for example, you could have &lsquo;allow&rsquo; rules for certain IPs and &lsquo;reject&rsquo; rules for null MAIL FROMs. The inbound &lsquo;allow&rsquo; rule could supersede the &lsquo;reject&rsquo; rule. The drawback of this strategy is that it creates large numbers of &lsquo;allow&rsquo; rules that become impossible to manage because of all the exceptions to the rule.</p><p>So, content filtering based upon From/Subject/Body examination is one way to fight backscatter, albeit with false positive problems. If you have a handle on who you want to accept mail from (no pun intended) then you can create exceptions. But remember, managing exceptions can become a real pain after a while.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4857899"></a>Use SPF</h2></div></div></div><p>Another trick for combating backscatter is to use SPF records. SPF records are designed to help combat backscatter on the theory that the recipient mail server will be able to figure out that your server didn&rsquo;t send it. Here&rsquo;s how it works:</p><div class="itemizedlist"><ul type="disc"><li><p>Bob has his own mail server and creates an SPF record for the domain bobsdomain.com:</p><p>v=spf1 ip4:256.18.19.0/24 -all</p><p>Properly interpreted, this means that any message that comes &lsquo;from&rsquo; bobsdomain.com must originate from the IP range 256.18.19.0 &ndash; 256.18.19.255.</p></li><li><p>Notorious spammer I.M. Obnoxious sends a message to my email address at my domain <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f387899a9d98cacab3968b929e839f96dd909c9e">[email&#160;protected]</a> and says it is from my other domain, <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="44303e2d2a2f7d7d04213c25293428216a2b3623">[email&#160;protected]</a>; he spoofs the sender. But <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="65111f0c0b0e5c5c25001d04081509004b060a08">[email&#160;protected]</a> doesn&rsquo;t exist. My mail server can&rsquo;t do the recipient lookup in real time so it has to &#39;250&#39; accept the body contents of the message.</p></li><li><p>Upon trying to deliver the message, my mail server figures out that <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ec9896858287d5d5ac89948d819c8089c28f8381">[email&#160;protected]</a> doesn&rsquo;t exist. In a normal world, my mail server would send a message back to <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3f4b4556515406067f5a475e524f535a11504d58">[email&#160;protected]</a> (with null sender &lt;&gt; in the MAIL FROM field) with a &#39;55x&#39; level error indicating that the message could not be delivered.</p></li></ul></div><p>However, my mail server is smarter than that. When it accepts the message, it does some spam filtering. It sees that the sending IP for the message is 288.41.18.19. It then looks up the SPF record for example.com and sees it is 256.18.19.0/24. It determines that the sending IP is not in the SPF range for the domain in the MAIL FROM. My mail server sees that any mail coming from example.org that fails the SPF check has a hard fail, &#39;-all&#39;. It assumes that the message is spoofed/forged and decides not to send an NDR back to <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b9cdc3d0d7d28080f9dcc1d8d4c9d5dc97d6cbde">[email&#160;protected]</a>, the purported sender. Instead, it simply drops the message. No backscatter is sent back to me.</p><p>The use of SPF records is a way to avoid contributing to the backscatter problem, but this technique is entirely dependent upon the recipient MTA. The recipient MTA must perform an SPF check on the message and then decide not to take its normal course of action on non-deliverable mail. Thus, logic must be built into the MTA to perform custom actions depending on the authentication results.</p><p>Not every MTA will do this. SPF checks require DNS queries which are somewhat computationally expensive. It is quicker and easier simply to check to see if the message can be delivered and then take action, rather than check, verify, and then take action. Still, using an SPF record with &lsquo;-all&rsquo; in it means that you have given receiving MTAs the help they need in order to determine whether you actually sent the message. Whether or not they use this information is up to them.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4320105"></a>Check to see if you sent the message in the first place</h2></div></div></div><p>There is another way to combat backscatter &ndash; check to see if you sent the message in the first place. We have already seen that NDR messages and backscatter contain a notice from the bouncing email server as well as all, or part, of the original message. We can use this bounce message to figure out whether or not you sent the message in the first place.</p><p>Suppose that my email address is , and my mail server is mail.example.com. My mail server always sends mail like this:</p><pre class="programlisting">HELO: mail.example.com
MAIL FROM: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d5a1afbcbbbe95b0adb4b8a5b9b0fbb6bab8">[email&#160;protected]</a>
RCPT TO: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0774686a6260727e47627f666a776b6229687560">[email&#160;protected]</a>
DATA
&lt;etc&gt;
.
QUIT</pre><p>If <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ed9e8280888a9894ad88958c809d8188c3829f8a">[email&#160;protected]</a> were to see this message in his inbox and look at the message headers, he would see a line something like the following:</p><pre class="programlisting">Received: from mail.example.com (mail.example.com [188.24.229.80])</pre><p>Properly interpreted, the part in parentheses says that this SMTP transaction came from 188.24.229.80 and the mail server HELO&rsquo;ed as mail.example.com. The recipient mail server did a reverse DNS lookup of 188.24.229.80 and it said mail.example.com. Thus, mail coming from me has Forward-Confirmed Reverse DNS set up.</p><p>Suppose the message headers said the following:</p><pre class="programlisting">Received: from host.example.com (unknown [188.24.229.80] helo=example.com)
...</pre><p>My mail servers don&rsquo;t do it that way. They don&rsquo;t HELO with nothing (that&rsquo;s what unknown means).</p><pre class="programlisting">Received: from [188.24.229.80] (port=12345 helo=example.com)...</pre><p>My mail servers don&rsquo;t HELO with example.com or with a port in the HELO. My reverse DNS is not the IP that I sent it from. Suppose it said the following in the bounced body content Received headers:</p><pre class="programlisting">Received: from mail.example.com (HELO mail.example.com)
[123.123.122.101]...</pre><p>This one comes close, but notice that the IP it came from is not one of my IPs. I can see that the IP should have failed an SPF check (and the recipient mail server should have detected this and not bounced it... tsk, tsk). What if the body contents had said this:</p><pre class="programlisting">Received: from host.example.com (EHLO example.com) ...</pre><p>I also don&rsquo;t HELO with an EHLO. These are all examples of anomalies in the way that my mail servers send mail. You could spot similar abnormalities in the Message-ID tag. If it doesn&rsquo;t conform to the way I generate them, then I know that I didn&rsquo;t send it and that the bounce message did not originate from me.</p><p>This method of fighting backscatter is to do it when it hits your inbound server and handle it in a different way from the regular inbound filtering. Verify first that it is a bounce message, for example by looking for the Content-Type: multipart/report; report-type=delivery-status; header.</p><p>Next, look for some tell-tale characteristics that say the message came from you. What do the Received headers look like? The HELO line is usually pretty distinctive, and so is the Message-ID. Do you sometimes insert a special X-Header into your outbound messages?</p><p>If the message is a bounce message and lacks some of these distinctive features, you can be fairly certain that the message is backscatter (i.e. bounce-back spam that did not originate from you). The advantage of this feature is that you don&rsquo;t have to rely on someone else to do the spam filtering as in the SPF model. Messages that are uniquely yours are difficult to spoof and it is unlikely (though possible) that a spammer would spoof something unique to you in order to spam you. Of course, you wouldn&rsquo;t actually accept a message simply because it looks like it comes from you, you would only not reject it. You would need a stronger method of authentication.</p><p>The downside is that you have to insert special distinctive features into your outbound mailer that you can recognize, and you need to have special handling for NDRs that implement custom logic that you wouldn&rsquo;t normally perform on inbound messages. Rejecting mail in this way again imports additional risk because some MTAs will bounce messages back to you and won&rsquo;t conform to the Pirates&rsquo; Code (see part 1 of this article, <a href="/virusbulletin/2008/09/problem-backscatter-part-1
" target="_top">VB September 2008, p.S2</a>) of sending DSNs; they may not send back all of the headers or they may modify some of them. In this case you could end up rejecting messages that legitimately came from you, when the recipient MTA just did a lousy job of letting you know.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4125020"></a>Don&#39;t make the problem worse</h2></div></div></div><p>It would be remiss of me not to include a section on how mail administrators can make sure they do not contribute further to the problem of backscatter [<span class="citation"><a href="#citation.3">3</a></span>].</p><div class="orderedlist"><ol type="1"><li><p><span class="bold"><strong>Don&#39;t accept mail, and then bounce</strong></span>. The primary problem of general backscatter is when email servers accept a message, discover they can&rsquo;t deliver it and then send a bounce notification back to the person who &lsquo;sent&rsquo; the message without verifying that they really sent the message. Remember that if a recipient mail server cannot deliver the mail and figures this out during the SMTP conversation, it rejects delivery and the sending mail server has to generate the bounce. After the recipient mail server has accepted it, it&rsquo;s too late. Make sure you configure your mail server to not do this.</p></li><li><p><span class="bold"><strong>Don&#39;t use Challenge/Response (or allow your users to)</strong></span>. While Challenge/Response spam filters fix your spam problem, they irritate and annoy everyone else. They offload the spam filtering onto the sender (I send you a message and you expect me to filter it? Hey, filter your <span class="emphasis"><em>own</em></span> mail!). But even worse, if a spammer spoofs an email address and you send a challenge back to the sender in the MAIL FROM, you are sending piles of challenge notifications to people who never sent mail. In other words, <span class="emphasis"><em>you</em></span> become a source of backscatter.</p></li><li><p><span class="bold"><strong>Configure your virus scanner to silently strip or discard malware instead of sending a notification back to the sender</strong></span>. Viruses and worms that send via email do not have valid sender addresses, they are spoofed. If your mail filter catches the malware and sends a notification back to the sender, it goes to the wrong person, an innocent third party. This is backscatter. This is the same as the Challenge/Response problem.</p></li><li><p><span class="bold"><strong>Be careful regarding autoresponders, out-of-office notifications, etc</strong></span>. The issue with autoresponders is the same as the above: a spammer sends a mail to your autoresponder which bounces a message back to the &lsquo;sender&rsquo; (who thinks &lsquo;Who is this guy? I don&rsquo;t care if he is out-of-office!&rsquo;).</p><p>(I have mixed feelings on this one. While on the one hand I can see the point of those who are against the use of autoresponders, on the other hand I find OOF notifications very useful. When I send an email to someone at my company and I get an OOF notification, I am glad to know that their response will be delayed. Similarly, when I go on vacation and people send me mail, it is useful to let them know that my response will be delayed. So, in the business world I believe that there is a place for the autoresponse/OOF notification. Maybe you should only send auto-responses to senders who pass a DKIM or SPF check.)</p></li></ol></div><p>Even if we all can&rsquo;t stop backscatter, let&rsquo;s not make it worse by contributing to it. Don&rsquo;t send mail automatically if you can&rsquo;t deliver it or without verifying that whoever sent the message actually sent it.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id2253119"></a>An Idiosyncrasy</h2></div></div></div><p>There are a number of competing mail transfer agents out there, including <em class="productname">Microsoft Exchange</em>, <em class="productname">Postfix</em>, <em class="productname">Sendmail</em>, <em class="productname">qmail</em>, <em class="productname">Exim</em>, and so forth. I am not an expert on MTAs but I know a few things about them.</p><p><em class="productname">Qmail</em> is a mail transfer agent that runs on Unix. It was written by Daniel J. Bernstein [<span class="citation"><a href="#citation.4">4</a></span>] as a more secure replacement for the popular <em class="productname">Sendmail</em> program. When first published, qmail was the first mail transport agent that was written with security in mind. Other MTAs with security concerns addressed have been written since then.</p><p><em class="productname">Qmail</em> is designed to accept mail for all of its domains and not perform any recipient validation. If the recipient doesn&rsquo;t exist, it generates an NDR. In other words, it accepts, then bounces. This, of course, can generate backscatter.</p><p>Another thing about some older versions of <em class="productname">qmail</em> is that it doesn&rsquo;t put in the following header in a bounce:</p><pre class="programlisting">Content-Type: multipart/report; report-type=delivery-status;</pre><p>I know this because recently I had to investigate a customer complaint. They claimed that because the bounce message did not have that header (which is required by the Pirates&rsquo; Code), the message was not backscatter; rather, it was a spammer <span class="emphasis"><em>spoofing</em></span> backscatter and getting through the filters. While it&rsquo;s certainly possible that a spammer would do this, it turned out to be a qmail-generated bounce message that did not include the header.</p><p><em class="productname">Qmail</em> does put this in the bounce message, however:</p><pre class="programlisting">Hi. This is the qmail-send program at mail.someorganization.com.

I&rsquo;m afraid I wasn&rsquo;t able to deliver your message to the following
addresses.

This is a permanent error; I&rsquo;ve given up. Sorry it didn&rsquo;t work out.</pre><p>It also inserts the following header:</p><pre class="programlisting">Received: (qmail 9999 invoked for bounce);</pre><p>So, it is quite interesting that some qmail implementations do not include the Content-Type header but do include the above bounce message. It does not quite comply with the RFC (or Pirates&rsquo; Code), but it&rsquo;s part way there.</p><p>The moral of the story is: if you are running qmail, don&rsquo;t just use the default implementation. There are some patches out there [<span class="citation"><a href="#citation.5">5</a></span>] that will fix the accept-then-bounce behaviour.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3229757"></a>Summary</h2></div></div></div><p>In this article we have seen some techniques for minimizing the backscatter issue. In the next article, we will examine a technique that has a much greater success rate at blocking backscatter &ndash; Bounce Address Tag Validation.</p><div class="bibliography"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id2977624"></a>Bibliography</h3></div></div></div><div class="bibliomixed"><a id="citation.1"></a><p class="bibliomixed">[1] <span class="bibliosource"><a href="http://www.spamnation.info/notes/guides/BackscatterFAQ.html" target="_blank">http://www.spamnation.info/notes/guides/BackscatterFAQ.html</a></span>.</p></div><div class="bibliomixed"><a id="citation.2"></a><p class="bibliomixed">[2] <span class="bibliosource"><a href="http://www.postfix.org/BACKSCATTER_README.html" target="_blank">http://www.postfix.org/BACKSCATTER_README.html</a></span>.</p></div><div class="bibliomixed"><a id="citation.3"></a><p class="bibliomixed">[3] I have borrowed and paraphrased these suggestions from: <span class="bibliosource"><a href="http://www.spamresource.com/2007/02/backscatter-what-is-it-how-do-i-stop-it.html" target="_blank">http://www.spamresource.com/2007/02/backscatter-what-is-it-how-do-i-stop-it.html</a></span>.</p></div><div class="bibliomixed"><a id="citation.4"></a><p class="bibliomixed">[4] <span class="bibliosource"><a href="https://cr.yp.to/qmail.html" target="_blank">http://cr.yp.to/qmail.html</a></span>.</p></div><div class="bibliomixed"><a id="citation.5"></a><p class="bibliomixed">[5] See <span class="bibliosource"><a href="http://marc.theaimsgroup.com/?l=qmail&amp;m=108605073822238&amp;w=2" target="_blank">http://marc.theaimsgroup.com/?l=qmail&amp;m=108605073822238&amp;w=2</a></span> or <span class="bibliosource"><a href="https://qmail.jms1.net/patches/validrcptto.cdb.shtml" target="_blank">http://qmail.jms1.net/patches/validrcptto.cdb.shtml</a></span>.</p></div></div></div> </div>
 <div class="col-md-3 col-sm-3 col-lg-3">
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=The problem of backscatter â€“ part 2&url=https://www.virusbulletin.com/virusbulletin/2008/10/problem-backscatter-part-2"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2008/10/problem-backscatter-part-2'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2008/10/problem-backscatter-part-2&title=The problem of backscatter â€“ part 2"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2008/10/problem-backscatter-part-2&t=The problem of backscatter â€“ part 2"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2008/10/problem-backscatter-part-2"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p>Â </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td>Â </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td>Â </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td>Â </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td>Â </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">Â©1989-2022 Virus Bulletin.Â Â Â Â Â Â Â Â <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>Â Â Â Â Â Â Â Â <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>Â Â Â Â Â Â Â Â <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>