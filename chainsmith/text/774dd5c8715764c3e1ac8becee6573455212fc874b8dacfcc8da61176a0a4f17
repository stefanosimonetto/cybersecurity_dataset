Sucuri Sit-Down Episode 3: Phishing Attacks with Luke Leal

Phishing attacks are one of the most popular methods for bad actors to gain access to a website environment. On this month’s podcast, analyst Luke Leal is with us to talk about these attacks. Topics covered include the motivation bad actors have for these attacks, who is a likely target, and preventative measures.
Plus, host Justin Channell breaks down more website security news from July – including new backdoors, a malicious WordPress plugin, and malware hiding in images and GitHub repositories.
For further reading about any topics discussed, check out these blogs we reference in the episode:

Pirated WordPress Plugins Bundled with Backdoors
Spox Phishing Kit Harvests Chase Bank Credentials
Fake WordPress Plugin SiteSpeed Serves Malicious Ads & Backdoors
Malicious Magento User Creator
Skimmers in Images & GitHub Repos

Podcast Transcript
Justin Channell:
Hello and welcome to the Sucuri Sit-Down. I’m your host Justin Channell and this is a monthly podcast about website security, where we get in-depth with the malware removal experts here at Sucuri. Now later in the show, I’ll have our analyst Luke Leal on the mic to talk about phishing attacks. But first, we’re going to take a look at some of the updates that our research team have published on the Sucuri blog this month.
First up, is actually a blog that Luke wrote about backdoors that were found in pirated WordPress plugins and themes earlier this month. It’s a relatively common practice for this to happen. In fact, last October, when we were at WordCamp US, we asked WordPress users their top security tips and avoiding pirated software came up quite often. However, what Luke highlighted in his post is that some of the sites that host these nulled or pirated plugins make it clear that you’re installing a backdoor. He had an example from a site that had a clause right in the terms of service that their software would allow for backdoor access. But what they don’t tell you is that even deleting those plugins doesn’t take away that backdoor.
To get a more technical look at how all this works check out Luke’s blog in the show notes. And for Magento users, you’ll want to check out the notes for a blog from last month’s guest, Krasimir Konov. He covered a malicious script named Inchoo, which allows a new admin user to be created in a Magento site. And much like the backdoors we discussed in WordPress, simply deleting the files is not enough. In fact, the script tries to hide the suspicious files after creating a new user. Krasimir also covered something for WordPress users. There’s a fake plugin called Sitespeed you need to be looking out for. When this malware is installed on a WordPress site, it allows for a lot of functionality for bad actors, including user creation, ad injections, and backdoors.
So be sure to regularly audit your plugins to make sure nothing like this sneaks onto your site. One of the more surprising blogs we had this month came from Denis Sinegubko, who covered a credit card skimmer that was hidden inside of a PNG file. Now this is a common obfuscation technique for bad actors. What happens here, essentially, is that the image file is being used as a text file instead of an image file. So a script can be added after all of the binary code that makes up the image. And when you open it in an image viewer, it’s just going to see an image. It’s not going to see that text. But when it’s opened as a text file, it can actually load that little script that’s in there.
In this case, the script was actually referencing the exact lines within the PNG file. And this first PNG file was made to look like a Google tag manager component. So you’d probably not notice it. And then it would reference another PNG file that was hosted in a public GitHub repository that was allegedly a beta version of Magento 2.4. And with so many legitimate services involved in this attack, it’s clear, it’s becoming more difficult to spot this kind of malware. Website owners should use integrity control checks and a website monitoring service to help detect any suspicious changes.
And Chase Bank customers were targeted with a sophisticated phishing kit this past month. Luke Leal wrote about that on our blog. And he’s been focusing quite a lot on these phishing attacks in his work here at Sucuri. Now, with so many phishing attacks happening these days, I wanted to sit down with Luke to give a better understanding of the effects of these attacks.
But before I get started with Luke, I just wanted to remind you about our sister podcast, Sucuri Sync-Up. It is a weekly website security news briefing that you can find anywhere you get your podcasts, or as an Alexa flash briefing or in video form on our social media accounts. Get new website security content delivered every Monday.
Now, on with the show. All right. So I’m here with Luke Leal. Luke, thanks for joining us here on the show. Can you just go ahead and tell us a little bit about yourself?
Luke Leal:
Yes, sir. As you said, my name’s Luke. And I’ve worked for Sucuri since late 2015. And I work on the research team. So I analyze a lot of the malware samples and phishing samples that we get and just try and form a sort of threat model based off of those, that way we can help defend websites we protect a little bit better and be able to detect better new threats that are emerging.
Justin Channell:
Okay. Now, what kind of motivates hackers to create these campaigns? It seems you would know that from creating those threat models.
Luke Leal:
Primarily, financially based. The actual goal dangles financial but the process takes them through account takeovers. And that’s primarily what the phishing that we see deals with. So it’ll be targeting a lot of the brands, all of the most popular brands, specifically like software as a service and financial brands. So one of the most popular ones is, Netflix is one of them. And then Spotify is another, just commonly stolen through phishing account. And then it’s just offered for resell online.
Justin Channell:
Okay. So really, in terms of who’s most likely to be targeted, really it’s just any anybody would be. And if you’re buying a product, you’re most likely a target of a phishing campaign, right?
Luke Leal:
Yeah. Yeah. If you have an account with any of the largest services and even if it’s not one of the largest services, there’s also targeted attacks to smaller services. So yeah. As long as you’re online, you can pretty much be a target.
Justin Channell:
Okay. And with that in mind, so what are some common signs of a phishing attack that people can see whenever they’re online and keeping in mind security?
Luke Leal:
Oh, the first thing you want to look at, for the average user, you just need to be aware of the signs. And for example, if you received an email and there was a link that you were maybe suspicious about, you would just want to go ahead and verify the link by determining the actual URL it’s using. So you could right click the hyperlink in the email and select copy URL, copy URL location, and then you can just paste that into a notepad or something. And that’ll give you the actual URL that’s going to load in your browser. And that’ll help you determine if it’s good or bad, if it’s sending you to the right login page or the right website, or if it’s sending you to just some random page that doesn’t really have any affiliation with the brand that you think you’re trying to access.
Justin Channell:
Often, they’re going to be using URLs… Will they look like they’re from that? I know I can remember there was one where there was a PayPal address going around, but it was like instead of the “L” it was an “I” that then they capitalized and would the copy and paste kind of make those things a little bit more apparent too?
Luke Leal:
Yeah. Well, with those type of attacks where they use phishing domains, they’ll specifically sign up and register lookalike domains that use various techniques of changing out characters, they’ll use transposition. Or I think they also use homoglyphs, which they’ll use that. And when registering the actual domain and so it’ll use different text encoding for the characters and that can make it pretty difficult to tell. I know what I’ll do is, usually when I’ll paste it into a notepad to look at the URL, I’ll greatly increase the font size. I’ll just use control and mouse wheel or mouse scroll up or control plus the plus sign and it’ll enlarge the font. And that way it’s easier to read because yeah, it can sometimes be difficult to tell otherwise. Yeah, that’s a common technique that’s used to register phishing domains.
Justin Channell:
So yeah, sometimes they are found on the domains and stuff, but where are the attacks most commonly found?
Luke Leal:
On the website structure itself. Usually they’re going to be placing it just to avoid any signs that it will be apparent to the website owner. They’re going to place it into sub-directories. So they’ll pick a random sub-directory and maybe a wp-content/uploads for WordPress or inside the wp-includes directory. Somewhere that the website owner or users aren’t going to be looking regularly. And so there’s really no way for them to detect it on their own unless they happen to come across it in FTP or some other file manager. And that’s pretty unlikely unless they have a reason to be looking for it.
Luke Leal:
But yeah, otherwise usually the first signs, the first way they learn about it, oftentimes it’s through blacklisting. They’ll receive a blacklisting and it’ll just come out of sort of like left field. And they won’t know what to do. They didn’t even know they had a security issue and yet now they’re blacklisted and they have to go through the whole removal process that that entails.
Justin Channell:
Okay. And now, would you say that’s probably the worst case scenario of what that can lead to within an organization that has been hacked, would probably be that?
Luke Leal:
Well, with an organization, when you use worst-case scenario, it can really… To be honest, it can lead to total [inaudible 00:09:56] organization or business going out of business, being shut down, just due to the cost that it takes for remediation and all the costs involved regarding surviving a security incident like that. Yeah.
Luke Leal:
So for example, there’s a school district in Texas, and they suffered a business email compromise, which is a sort of phishing technique. Well, it is a phishing technique, it’s just a subset of it. And they were out for $2 million. So, that caused them to have to enact a different budget because now they were going to be over budget by a lot because they’re missing $2 million. And so yeah, it had ramifications and that’s for a public, sort of state-run organization. With a private one, yeah there’s been incidents where, specifically with smaller businesses, or yeah, it’s just unsurvivable.
It sounds kind of drastic and hardcore but that is the worst-case scenario. And for most organizations, it’s just going to be like a stolen email account. That’s not going to be that big of a risk, unless, like I said, business email compromise is probably one of the biggest risks that they’ll encounter.
Justin Channell:
Wow. Now, in the case that somebody has been targeted, to kind of avoid that worst-case scenario, what should they do? Let’s say they’ve already given up their personal information.
Luke Leal:
Yeah. And in those cases for a person, my recommendation really depends on exactly what information they gave up. So, if it was like a phishing page and it was for a Netflix account, it depends actually what’s on the phishing page. Because, just because it’s a Netflix account phishing page, they can still ask a lot of personal detailed questions, like your social security number, date of birth. So if you’re giving up the information like DOB, SSN, any of that, then yeah, I would go ahead and recommend that you just fully freeze your credit if possible. Otherwise, purchase some type of credit monitoring. That way you can stay on top of any new credit attempts that are created for your account. But otherwise, I would just recommend resetting the login and resetting your email account password that received the phishing email.
Justin Channell:
Yeah. Now, in terms of a business, should they kind of do about the same thing? Is that where they should start and then escalate further as they see kind of what’s come about? Or is there a different strategy that businesses should take, or any organization for that matter?
Luke Leal:
Yeah, it depends on the size of the organization and the kind of the security policy they have. I know for larger organizations, if a successful phishing page is delivered to an employee and they get phished, they go to it and they give up their login information. They’ll sort of quarantine that login and they’ll separate it to… they’ll remove its normal access, that way it [inaudible 00:13:41] say the attacker was able to fully login to it and use it. It would have limited access. So, that way the employee has some remains active in the organization. They have access to some of the tools but they don’t have as much access as before. And during that time, the security team would perform an investigation and take any other measures that need to be taken. They would go ahead and do that as needed. In terms of a set standard that’s followed, I guess that the only set standard would be to secure the account that is phished. Other than that, it’s an on basis type of deal.
Justin Channell:
How could users protect themselves from phishing campaigns, other than just detecting changes? Because that, as you’ve mentioned, it can be very difficult, some things could slip through the cracks. Is there anything else that they can use as to kind of catch these attacks in the while before they end up accidentally giving them their information?
Luke Leal:
Yeah. You can use a lot of antivirus programs, Malwarebytes. A lot of consumer grade security products, they’ll offer phishing detection. And so if you go to a phishing URL or if you try to go to a phishing URL or domain, it’ll just block it and it’ll come up with a warning notification and say, “Hey, this URL was blocked due to known phishing threats,” something like that. And so for most consumers, that’s the best way and the easiest way to go about getting some type of automated defense against phishing threats. But the only problem is they’re not always perfect. So you’ll want to also just stay vigilant in terms of checking the URL and not depending on that software entirely.
Justin Channell:
Okay. And now for businesses, how can they kind of test to see which employees are the ones that are falling for the phishing scams? Are there any tools or services for that?
Luke Leal:
Yeah. Yeah. There exist a few different companies. I’m not even sure how many, it’s definitely a growing industry in terms of a subset of the information security industry, in terms of training. And yeah, since phishing is such a large threat to organizations, specifically phishing training is something that’s really emerged in the last few years. And on top of the training, the training is something that’s great for all organizations. But yeah, in addition to the training, they also offer certain services that are more tailored to organizations that offer enterprise level email filtering and email scanning. And yeah, you can get that through… Some of the bigger companies are Proofpoint, PhishLabs, Inky, I-N-K-Y is also one of them. And yeah, they’ll monitor incoming emails. And they have sort of different measures and different methods they use for mediating or just intercepting phishing emails and quarantining them automatically without really any input from the employee in terms of they’re having to make a decision, “Oh, is this safe or not?” It will automatically quarantine it and they won’t have to worry about that.
Justin Channell:
Okay. Well, thinking about that, there is so much training and there is this market that’s there, it seems like phishing’s probably going to evolve in the future and become something that’s a little bit harder to detect. Do you have any predictions on what might happen in regards to that?
Luke Leal:
Well, half the battle is actually first getting to the recipient. So, usually they’ll use email and that’s where I’ve seen the most in terms of changes. So they’re always trying to use different tactics because the phishing companies I mentioned before, the phishing service companies I mentioned before, and Microsoft, Gmail, they’re always changing their filters and updating them to block phishing emails and other threats. So yeah, they constantly have to adapt and change their methods. And yeah, I think lately they’ve been using… Most I’ve seen lately have used different encoding methods. There’s a method called Zero font and that just changes the font size. It’ll use a random font size in the HTML of the phishing email. And yeah, the HTML of the phishing email, it’ll look nothing like the page that’s actually loaded.
Luke Leal:
So yeah, in terms of the last few years, that’s how I’ve seen changes being made to it because the actual phishing page itself, it really hasn’t changed too much in terms of the look and the feel of it. It’s just trying to do the same thing it’s always done, which is replicate the actual login page. It just tries to replicate it as closely as possible. So there hasn’t been too much differences in how that’s done. So yeah, really the changes I’ve seen have been in the delivery of it. Now, behind the scenes, on the phishing pages, that’s where it’s changed a little bit.
Luke Leal:
With so many new services and accounts requiring multi-factor like Visa cards, they have Verified by Visa that requires multi-factor and I think the same with MasterCard. It is the same with MasterCard they don’t use Verified by Visa, I think they use MasterCard Secure. And so they’ll target the multi-factor. And yeah, it’s been a little, I guess, maybe disconcerting in terms of how effective it’s been. Because, multi-factor came on the scene and it was supposed to sort of really help prevent these type of issues but it turns out there’s different flaws that are kind of specific in how the multi-factor is implemented. So yeah, it can vary depending on who they target, but yeah, it’s definitely possible for them to bypass or authenticate your two-factor authentication, whether it’s through SMS, like you’re receiving the SMS code, that’s the most common method that’s used to steal it. They can even still Google two-factor authentication, although I don’t really see that, but that is known to exist. So yeah, there’s just a lot of different things that they’re constantly trying out, to see what’s most successful.
Justin Channell:
Yeah. Because, I know at this point it seems… There’s always been debate as to whether or not SMS is secure. I kind of lean on the side of, it’s not. And I felt that it was really getting towards that a couple of months ago when it was unveiled that some hackers were claiming that they have rootkits installed at every major provider; which it’s hard to tell whether or not that’s true but if it is, it would make for the SMS 2FA to be very insecure. So it’s hard to tell again, whether or not it’s true, but it definitely seems like it’s where they’re looking and where it’s going to be most likely to cause problems.
Luke Leal:
Yeah. Yeah. And in these cases, the ones I’ve dealt with, in order to get around the SMS or not get around it, but in order for them to receive the SMS code, they’ll act like a man in the middle tech. So, the phishing page will ask for your phone number. And so they get the customer’s phone number and then they’re able to sort of replay that to the actual service, the legitimate service. And so the legitimate service then sends the SMS to the person that’s being phished, the victim. And then the phishing page will ask them for the SMS code they received. And since the victim thinks it’s the legit service, they just input it and then the person that’s doing the phishing can then use that again to actually access the service. Because when the victim put it into the phishing page, it didn’t actually authenticate with the legitimate service, it was just sent to the attacker. So the code wasn’t used yet. So it’s still valid for a certain length of time, depending on the service.
Justin Channell:
Okay. Well, I think that’s all the questions I had about phishing. I’m going to end with a question we’ve been asking every guest on this show, which is, what’s the most interesting piece of malware you’ve ever seen? And you know what, for this one let’s go with bonus points if it’s a phishing campaign.
Luke Leal:
Yeah, sure. The most interesting one is probably [crosstalk 00:23:20] phishing recently is some of the two-factor that I’ve seen target the MasterCard and also Visa cards that were out of Europe. Specifically, they were targeting a bank in the Nordic region. And so yeah, they would send out fake Netflix phishing emails. It would say, “Oh, you need to verify your information. There’s been some payment conflict issue.” And so the person would click the URL and load the phishing page and they would go through the process.
Luke Leal:
And yeah, this one used two-factor authentication. It used the Verified by Visa and MasterCard Secure services which are tied to the person’s card’s issuing bank, and it’s done through SMS primarily. And so it’s used whenever the person is paying at checkout, they’ll do the two-factor authentication to sort of authenticate the purchase with their bank, the bank that issued that card they’re using. And so typically that code is only supposed to be useful once, it’s supposed to be a onetime password and then it’s invalid.
Luke Leal:
But in this case it was valid, I think, for up to five minutes. And so it could be reused to purchase any items. And there was no limit on the purchase price, so it wasn’t verifying the purchase price. So yeah, once the attacker had the two-factor code and all the card’s details, they could fully use it without really any worry of being blocked or any fraud measures preventing their transaction going through. So yeah, it was just another example of kind of the weakness in using SMS because the companies have to add some sort of delay in terms of how long the multi-factor code will stay alive.
Luke Leal:
And one of the reasons they have to do this is just because the SMS network and the cellular networks, so I don’t know if you’ve experienced this, but sometimes you’ll get a delay in a text message and SMS message. You’ll send it to someone or some will send you a message and it could take, sometimes, a few minutes. And so the same thing happens with the two-factor authentication codes that they try and send you. So they have to allow for that type of delay that may happen. They have to incorporate that into their timeout period. And so yeah, some of the multi-factor codes will be good for five minutes, maybe longer.
Justin Channell:
Uh-huh (affirmative).
Luke Leal:
Yeah. That kind of lessens their security too. Also, when you take into account they can be used with some specific groups, they can be used more than once in a period of time.
Justin Channell:
Yeah. Wow.
Luke Leal:
Yeah. That’s the most interesting piece of malware I’ve seen. I think I wrote an article on it. There’s a post on our blog.sucuri.net.
Justin Channell:
Yeah. We’ll put that link in the show notes. I definitely remember that one. Well, Luke, thank you so much for coming on the show and talking phishing to us.
Luke Leal:
Sure, sure.
Justin Channell:
Great.
Luke Leal:
Thank you.
Justin Channell:
Have a good one. Thanks again to Luke for joining us here on the Sit-down. We’ll be back with another episode next month. So be sure to subscribe on Apple Podcasts, Spotify, Stitcher, and anywhere else you get your podcasts. Also, be sure to follow us on social media at Sucuri Security and check us out at sucuri.net, that’s S-U-C-U-R-I.net. I’m Justin Channell. And this has been the Sucuri Sit-Down. Stay safe out there.
