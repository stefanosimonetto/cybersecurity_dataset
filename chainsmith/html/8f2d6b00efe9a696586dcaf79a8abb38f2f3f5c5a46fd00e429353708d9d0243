<!DOCTYPE html>
<html lang="en-US">
<head >
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Massive Admedia/Adverting iFrame Infection</title>
<meta name='robots' content='max-image-preview:large' />

<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://mashshare.net -->
<meta property="og:type" content="article" /> 
<meta property="og:title" content="Massive Admedia/Adverting iFrame Infection" />
<meta property="og:description" content="This past weekend we registered a spike in WordPress infections where hackers injected encrypted code at the end of all legitimate .js files.        The distinguishing features of this malware are:      	32 hex digit comments at the beginning" />
<meta property="og:image" content="https://blog.sucuri.net/wp-content/uploads/2016/02/02012016_Admedia.jpg" />
<meta property="og:url" content="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html" />
<meta property="og:site_name" content="Sucuri Blog" />
<meta property="article:publisher" content="https://www.facebook.com/SucuriSecurity/" />
<meta property="article:published_time" content="2016-02-01T21:09:39-08:00" />
<meta property="article:modified_time" content="2016-05-20T11:40:25-07:00" />
<meta property="og:updated_time" content="2016-05-20T11:40:25-07:00" />
<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://www.mashshare.net -->
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->
<meta property="og:image:width" content="850" />
<meta property="og:image:height" content="400" />
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Massive Admedia/Adverting iFrame Infection">
<meta name="twitter:description" content="This past weekend we registered a spike in WordPress infections where hackers injected encrypted code at the end of all legitimate .js files.        The distinguishing features of this malware are:      	32 hex digit comments at the beginning">
<meta name="twitter:image" content="https://blog.sucuri.net/wp-content/uploads/2016/02/02012016_Admedia.jpg">
<meta name="twitter:site" content="@sucurisecurity">
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->


<!-- This site is optimized with the Yoast SEO Premium plugin v12.5 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="We discovered a massive javascript infection on WordPress sites that uses encoded iFrames to deliver malware and reinfect websites. "/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html" />
<!-- / Yoast SEO Premium plugin. -->

<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Feed" href="https://blog.sucuri.net/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Comments Feed" href="https://blog.sucuri.net/comments/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Massive Admedia/Adverting iFrame Infection Comments Feed" href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html/feed" />
<!-- This site uses the Google Analytics by MonsterInsights plugin v7.10.0 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<script type="text/javascript" data-cfasync="false">
	var mi_version         = '7.10.0';
	var mi_track_user      = true;
	var mi_no_track_reason = '';
	
	var disableStr = 'ga-disable-UA-4077922-18';

	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}
	
	if ( mi_track_user ) {
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

		__gaTracker('create', 'UA-4077922-18', 'auto');
		__gaTracker('set', 'forceSSL', true);
		__gaTracker('require', 'displayfeatures');
		__gaTracker('send','pageview');
	} else {
		console.log( "" );
		(function() {
			/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
			var noopfn = function() {
				return null;
			};
			var noopnullfn = function() {
				return null;
			};
			var Tracker = function() {
				return null;
			};
			var p = Tracker.prototype;
			p.get = noopfn;
			p.set = noopfn;
			p.send = noopfn;
			var __gaTracker = function() {
				var len = arguments.length;
				if ( len === 0 ) {
					return;
				}
				var f = arguments[len-1];
				if ( typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function' ) {
					console.log( 'Not running function __gaTracker(' + arguments[0] + " ....) because you are not being tracked. " + mi_no_track_reason );
					return;
				}
				try {
					f.hitCallback();
				} catch (ex) {

				}
			};
			__gaTracker.create = function() {
				return new Tracker();
			};
			__gaTracker.getByName = noopnullfn;
			__gaTracker.getAll = function() {
				return [];
			};
			__gaTracker.remove = noopfn;
			window['__gaTracker'] = __gaTracker;
					})();
		}
</script>
<!-- / Google Analytics by MonsterInsights -->
<link rel='stylesheet' id='sucuri-blog-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/style.css?ver=1.2.0' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://blog.sucuri.net/wp-includes/css/dist/block-library/style.min.css?ver=6.0.1' type='text/css' media='all' />
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel='stylesheet' id='select2-css'  href='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.css?ver=4.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='mashsb-styles-css'  href='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/css/mashsb.min.css?ver=3.8.1' type='text/css' media='all' />
<style id='mashsb-styles-inline-css' type='text/css'>
.mashsb-count {color:#cccccc;}[class^="mashicon-"] .text, [class*=" mashicon-"] .text{
    text-indent: -9999px !important;
    line-height: 0px;
    display: block;
    } 
    [class^="mashicon-"] .text:after, [class*=" mashicon-"] .text:after {
        content: "" !important;
        text-indent: 0;
        font-size:13px;
        display: block !important;
    }
    [class^="mashicon-"], [class*=" mashicon-"] {
        width:25%;
        text-align: center !important;
    }
    [class^="mashicon-"] .icon:before, [class*=" mashicon-"] .icon:before {
        float:none;
        margin-right: 0;
    }
    .mashsb-buttons a{
       margin-right: 3px;
       margin-bottom:3px;
       min-width: 0;
       width: 41px;
    }
    .onoffswitch, 
    .onoffswitch-inner:before, 
    .onoffswitch-inner:after 
    .onoffswitch2,
    .onoffswitch2-inner:before, 
    .onoffswitch2-inner:after  {
        margin-right: 0px;
        width: 41px;
        line-height: 41px;
    }#mashbar-header .mashsb-count { 
    display:none; 
}
</style>
<link rel='stylesheet' id='sucuriblog-google-fonts-css'  href='//fonts.googleapis.com/css?family=Open+Sans:300,400,400italic,700,600' type='text/css' media='all' />
<link rel='stylesheet' id='cookie-banner-css-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/css/cookie-banner.css?ver=20200427' type='text/css' media='all' />
<script type='text/javascript' id='monsterinsights-frontend-script-js-extra'>
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[]","home_url":"https:\/\/blog.sucuri.net","hash_tracking":"false"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/google-analytics-premium/assets/js/frontend.min.js?ver=7.10.0' id='monsterinsights-frontend-script-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.js?ver=4.0.1' id='select2-js'></script>
<script type='text/javascript' id='mashsb-js-extra'>
/* <![CDATA[ */
var mashsb = {"shares":"771","round_shares":"1","animate_shares":"1","dynamic_buttons":"0","share_url":"https:\/\/blog.sucuri.net\/2016\/02\/massive-admedia-iframe-javascript-infection.html","title":"Massive+Admedia%2FAdverting+iFrame+Infection","image":"https:\/\/blog.sucuri.net\/wp-content\/uploads\/2016\/02\/02012016_Admedia.jpg","desc":"This past weekend we registered a spike in WordPress infections where hackers injected encrypted code at the end of all legitimate .js files.\r\n\r\n\r\n\r\nThe distinguishing features of this malware are:\r\n\r\n\r\n\t32 hex digit comments at the beginning \u2026","hashtag":"@sucurisecurity","subscribe":"link","subscribe_url":"http:\/\/sucuri.hs-sites.com\/subscribe-to-security","activestatus":"1","singular":"1","twitter_popup":"1","refresh":"0","nonce":"c1b7e23fe8","postid":"14640","servertime":"1659523644","ajaxurl":"https:\/\/blog.sucuri.net\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/js/mashsb.min.js?ver=3.8.1' id='mashsb-js'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/html5shiv.min.js?ver=3.7.3' id='html5shiv-js'></script>
<![endif]-->
<link rel="https://api.w.org/" href="https://blog.sucuri.net/wp-json/" /><link rel="alternate" type="application/json" href="https://blog.sucuri.net/wp-json/wp/v2/posts/14640" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.sucuri.net/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.sucuri.net/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://blog.sucuri.net/?p=14640' />


<!-- This site is optimized with the Schema plugin v1.7.9.4 - https://schema.press -->
<script type="application/ld+json">{"@context":"https:\/\/schema.org\/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.sucuri.net\/2016\/02\/massive-admedia-iframe-javascript-infection.html"},"url":"https:\/\/blog.sucuri.net\/2016\/02\/massive-admedia-iframe-javascript-infection.html","headline":"Massive Admedia\/Adverting iFrame Infection","datePublished":"2016-02-01T21:09:39-08:00","dateModified":"2016-05-20T11:40:25-07:00","publisher":{"@type":"Organization","@id":"https:\/\/blog.sucuri.net\/#organization","name":"Sucuri Blog","logo":{"@type":"ImageObject","url":"","width":600,"height":60}},"image":{"@type":"ImageObject","url":"https:\/\/blog.sucuri.net\/wp-content\/uploads\/2016\/02\/02012016_Admedia.jpg","width":850,"height":400},"articleSection":"Website Security","keywords":"Hacked Websites, Malvertising","description":"This past weekend we registered a spike in WordPress infections where hackers injected encrypted code at the end of all legitimate .js files. Encrypted admedia code (shortened version). The distinguishing features of this malware are: 32 hex digit comments at the beginning and end of the malicious code. E.g. \/*e8def60c62ec31519121bfdb43fa078f*\/","author":{"@type":"Person","name":"Denis Sinegubko","url":"https:\/\/blog.sucuri.net\/author\/denis","description":"Denis Sinegubko is Sucuri’s Senior Malware Researcher who joined the company in 2013. Denis' main responsibilities include researching emerging threats and creating  signatures for SiteCheck. The founder of UnmaskParasites, his professional experience covers over 20 years of programming and information security. When Denis isn’t analyzing malware, you might not find him not online at all. Connect with him on Twitter.","image":{"@type":"ImageObject","url":"https:\/\/secure.gravatar.com\/avatar\/c9ef50b85bd345ea4e0d8da558816f3d?s=96&d=mm&r=g","height":96,"width":96}}}</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-4077922-18', 'auto');
  ga('require', 'linker');
  ga('linker:autoLink', ['ddecode.com', 'unmaskparasites.com', 'urlfind.org']);
  ga('send', 'pageview');
</script>

<script type="text/javascript">
(function(a,b,c,d,e,f,g){e['ire_o']=c;e[c]=e[c]||function(){(e[c].a=e[c].a||[]).push(arguments)};f=d.createElement(b);g=d.getElementsByTagName(b)[0];f.async=1;f.src=a;g.parentNode.insertBefore(f,g);})('//d.impactradius-event.com/A166802-5dda-4f98-aad8-1f58dbc8f1771.js','script','ire',document,window);
</script>
<script type='text/javascript'>/*<![CDATA[*/(function(n,d,c){d.setTime(d.getTime()+2592000000);c=(new RegExp('[?&]'+n+'=([^&#]*)','i')).exec(window.location.search);if(c=c?c[1]:null)document.cookie=n+'='+c+';expires='+d.toUTCString()+';domain=.sucuri.net;path=/';})('cjevent',new Date());/*]]>*/</script><!-- Tealium Universal Tag --><script type="text/javascript">(function(a,b,c,d){a='//tags.tiqcdn.com/utag/gpl/sucuri/prod/utag.js';b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a)})();</script><link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#menu-item-17506{ background-color: #619f42;}
#menu-item-17506:hover {background-color:#478237}
#menu-item-17506 > a { color:#fff;}
.nav-primary {
 width: 80%;
}

.genesis-nav-menu {
 display:table;
}

.genesis-nav-menu .menu-item {
 float:none;
 display:table-cell;
 text-align:center;
 vertical-align:top;
}

.text-right {
 text-align:right !important;
}

.genesis-nav-menu .languages-sub-menu a {
 margin-right:0;
}

/* Blog Background Green Color Replace*/
#menu-item-17506 { background-color: #008673!important; }
.home.archive-post-grid .archive-featured-post:first-of-type { border-top: 8px solid #008673!important; }
.button { background-color: #008673!important; }
#sidebar-cta .widget { background-color: #008673!important; }
.fwp-load-more:focus, .fwp-load-more:hover, .load-more:focus, .load-more:hover {
    background-color: #008673!important;
}
.social-icons a::before {
    background-color: #008673!important;
}
.footer-widgets .social-icons a:focus::before, .footer-widgets .social-icons a:hover::before, .footer-widgets .button:focus, .footer-widgets .button:hover {
    background-color: #008673!important;
}	
.button { background-color: #008673!important; }

.footer-widgets .button:hover { background-color: #26BA9E!important; }		</style>
		</head>
<body class="post-template-default single single-post postid-14640 single-format-standard header-full-width content-sidebar"><div class="site-container"><ul class="genesis-skip-link"><li><a href="#genesis-nav-primary" class="screen-reader-shortcut"> Skip to primary navigation</a></li><li><a href="#genesis-content" class="screen-reader-shortcut"> Skip to content</a></li><li><a href="#genesis-sidebar-primary" class="screen-reader-shortcut"> Skip to primary sidebar</a></li><li><a href="#genesis-footer-widgets" class="screen-reader-shortcut"> Skip to footer</a></li></ul><header class="site-header" itemscope itemtype="https://schema.org/WPHeader"><div class="wrap"><div class="title-area"><p class="site-title" itemprop="headline"><a href="https://blog.sucuri.net/">Sucuri Blog</a></p><p class="site-description screen-reader-text" itemprop="description">Website Security News</p></div><nav class="nav-primary" aria-label="Main" itemscope itemtype="https://schema.org/SiteNavigationElement" id="genesis-nav-primary"><ul id="menu-header-navigation-ii" class="menu genesis-nav-menu menu-primary js-superfish"><li id="menu-item-17495" class="menu-item-products menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17495"><a href="https://sucuri.net/website-antivirus/signup" itemprop="url"><span itemprop="name">Products</span></a>
<ul class="sub-menu">
	<li id="menu-item-17496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17496"><a href="https://sucuri.net/website-security-platform/signup/" itemprop="url"><span itemprop="name">Website Security Platform</span></a></li>
	<li id="menu-item-17497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17497"><a href="https://sucuri.net/website-firewall/" itemprop="url"><span itemprop="name">Website Firewall (WAF)</span></a></li>
	<li id="menu-item-20814" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20814"><a href="https://sucuri.net/custom/enterprise/" itemprop="url"><span itemprop="name">Enterprise Website Security</span></a></li>
	<li id="menu-item-20815" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20815"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Multisite Solutions</span></a></li>
</ul>
</li>
<li id="menu-item-17498" class="menu-item-industry menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17498"><a href="https://sucuri.net/website-security-platform/" itemprop="url"><span itemprop="name">Features</span></a>
<ul class="sub-menu">
	<li id="menu-item-17499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17499"><a href="https://sucuri.net/malware-detection-scanning/" itemprop="url"><span itemprop="name">Detection</span></a></li>
	<li id="menu-item-17500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17500"><a href="https://sucuri.net/website-hack-protection/" itemprop="url"><span itemprop="name">Protection</span></a></li>
	<li id="menu-item-17501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17501"><a href="https://sucuri.net/website-performance/" itemprop="url"><span itemprop="name">Performance</span></a></li>
	<li id="menu-item-19564" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19564"><a href="https://sucuri.net/website-malware-removal/" itemprop="url"><span itemprop="name">Response</span></a></li>
	<li id="menu-item-19911" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19911"><a href="https://sucuri.net/website-backups/" itemprop="url"><span itemprop="name">Backups</span></a></li>
</ul>
</li>
<li id="menu-item-19912" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-19912"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a>
<ul class="sub-menu">
	<li id="menu-item-19913" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19913"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Agency Solutions</span></a></li>
	<li id="menu-item-19915" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19915"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a></li>
	<li id="menu-item-20816" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20816"><a href="https://sucuri.net/referral/" itemprop="url"><span itemprop="name">Referral Program</span></a></li>
	<li id="menu-item-19914" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19914"><a href="https://sucuri.net/ecommerce-website-security/" itemprop="url"><span itemprop="name">Ecommerce</span></a></li>
</ul>
</li>
<li id="menu-item-20817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-20817"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Resources</span></a>
<ul class="sub-menu">
	<li id="menu-item-20818" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20818"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Guides</span></a></li>
	<li id="menu-item-20819" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20819"><a href="https://sucuri.net/webinars/" itemprop="url"><span itemprop="name">Webinars</span></a></li>
	<li id="menu-item-20820" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20820"><a href="https://sucuri.net/infographics/" itemprop="url"><span itemprop="name">Infographics</span></a></li>
	<li id="menu-item-20821" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20821"><a href="https://sitecheck.sucuri.net/" itemprop="url"><span itemprop="name">SiteCheck</span></a></li>
	<li id="menu-item-20822" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20822"><a href="https://sucuri.net/reports/" itemprop="url"><span itemprop="name">Reports</span></a></li>
	<li id="menu-item-22570" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22570"><a href="https://sucuri.net/email-courses/" itemprop="url"><span itemprop="name">Email Courses</span></a></li>
</ul>
</li>
<li id="menu-item-17506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17506"><a href="https://sucuri.net/website-security-platform/help-now" itemprop="url"><span itemprop="name">Immediate Help</span></a></li>
<li id="menu-item-17509" class="menu-item-login menu-item menu-item-type-custom menu-item-object-custom menu-item-17509"><a href="https://dashboard.sucuri.net/login/" itemprop="url"><span itemprop="name">Login</span></a></li>
</ul></nav><button id="responsive-menu" role="button" aria-controls="genesis-nav-primary" aria-pressed="false"><span class="screen-reader-text">Menu</span></button></div></header><div class="site-inner"><div class="wrap"><div class="content-sidebar-wrap"><main class="content" id="genesis-content"><article class="post-14640 post type-post status-publish format-standard has-post-thumbnail category-website-security category-wordpress-security tag-hacked-websites tag-malvertising entry"><header class="entry-header"><div class="single-featured"><img width="745" height="350" src="https://blog.sucuri.net/wp-content/uploads/2016/02/02012016_Admedia-745x350.jpg" class="single-featured-image wp-post-image" alt="" loading="lazy" srcset="https://blog.sucuri.net/wp-content/uploads/2016/02/02012016_Admedia-745x350.jpg 745w, https://blog.sucuri.net/wp-content/uploads/2016/02/02012016_Admedia-600x282.jpg 600w, https://blog.sucuri.net/wp-content/uploads/2016/02/02012016_Admedia-768x361.jpg 768w, https://blog.sucuri.net/wp-content/uploads/2016/02/02012016_Admedia-650x306.jpg 650w, https://blog.sucuri.net/wp-content/uploads/2016/02/02012016_Admedia-585x275.jpg 585w, https://blog.sucuri.net/wp-content/uploads/2016/02/02012016_Admedia-560x264.jpg 560w, https://blog.sucuri.net/wp-content/uploads/2016/02/02012016_Admedia.jpg 850w" sizes="(max-width: 745px) 100vw, 745px" /></div><h1 class="entry-title">Massive Admedia/Adverting iFrame Infection</h1>
<p class="entry-meta"><time class="entry-time" datetime="2016-02-01T21:09:39-08:00">February 1, 2016</time><span class="entry-author"><a href="https://blog.sucuri.net/author/denis" class="entry-author-link" rel="author"><span class="entry-author-name">Denis Sinegubko</span></a></span></p></header><div class="entry-content"><aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2016%2F02%2Fmassive-admedia-iframe-javascript-infection.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=Massive%20Admedia%2FAdverting%20iFrame%20Infection&url=https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--><p>This past weekend we registered a spike in WordPress infections where hackers injected encrypted code at the end of <strong>all legitimate .js files</strong>.</p>
<figure id="attachment_14644" aria-describedby="caption-attachment-14644" style="width: 750px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2016/02/encrypted_admedia_injection.png" rel="lightbox"><img loading="lazy" class="wp-image-14644" src="https://blog.sucuri.net/wp-content/uploads/2016/02/encrypted_admedia_injection-650x417.png" alt="Encrypted Admedia Injection with Removed Code" width="750" height="481" /></a><figcaption id="caption-attachment-14644" class="wp-caption-text">Encrypted admedia code (shortened version).</figcaption></figure>
<p>The distinguishing features of this malware are:<br />
<span id="more-14640"></span></p>
<ol>
<li>32 hex digit comments at the beginning and end of the malicious code. E.g. <strong>/*e8def60c62ec31519121bfdb43fa078f*/</strong> This comment is unique on every infected site. Most likely an MD5 hash based on the domain name.</li>
<li>The first comment is immediately followed by <strong> ;window[“\x64\x6f…. </strong>and a long array of string constants in their hexadecimal representation.</li>
<li>It always ends with “<strong>.join(\”\”);”));</strong>“</li>
</ol>
<p>The encrypted part mutates from site to site, but once decrypted it always looks like this:</p>
<figure id="attachment_14643" aria-describedby="caption-attachment-14643" style="width: 750px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2016/02/decoded-admedia-malware.png" rel="lightbox"><img loading="lazy" class="wp-image-14643" src="https://blog.sucuri.net/wp-content/uploads/2016/02/decoded-admedia-malware-650x365.png" alt="Decoded admedia script" width="750" height="421" srcset="https://blog.sucuri.net/wp-content/uploads/2016/02/decoded-admedia-malware-650x365.png 650w, https://blog.sucuri.net/wp-content/uploads/2016/02/decoded-admedia-malware-560x315.png 560w, https://blog.sucuri.net/wp-content/uploads/2016/02/decoded-admedia-malware-600x337.png 600w, https://blog.sucuri.net/wp-content/uploads/2016/02/decoded-admedia-malware-768x431.png 768w, https://blog.sucuri.net/wp-content/uploads/2016/02/decoded-admedia-malware.png 1520w" sizes="(max-width: 750px) 100vw, 750px" /></a><figcaption id="caption-attachment-14643" class="wp-caption-text">Decoded admedia script</figcaption></figure>
<p>&nbsp;</p>
<p>This malware only infects first time visitors, it sets the <strong>ad-cookie</strong> cookie (<strong>er2vdr5gdc3ds</strong>) that expires in <strong>24</strong> hours and injects an invisible iframe.</p>
<h3>IFrame URL &#8211; Admedia / Adverting</h3>
<p>The URL of the iFrames is the only changing part of the code.</p>
<ul>
<li>hxxp://<strong>template</strong>.poln1uewt1aniwki[.]ws/<strong>admedia</strong>/?id=8695834&amp;keyword=85c86e3646fb1b15c0bc0647c257c029&amp;ad_id=<strong>Twiue123</strong></li>
<li>hxxp://<strong>js</strong>.polnue2wtani2wki[.]ws/<strong>admedia</strong>/?id=8695834&amp;keyword=396f3d9d490aed315d71b60ec1efda53&amp;ad_id=<strong>Twiue123</strong></li>
<li>hxxp://<strong>get</strong>.malenkiuniger[.]net/<strong>admedia</strong>/?id=8695834&amp;keyword=8580b2135c1fdc0c650156eb174b4985&amp;ad_id=<strong>Twiue123</strong></li>
<li>hxxp://<strong>track</strong>.findyourwaytotr[.]net/<strong>admedia</strong>/?id=8695834&amp;keyword=46731f99a65ceac12e0632d08e551ca5&amp;ad_id=<strong>Twiue123</strong></li>
<li>hxxp://<strong>img</strong>.oduvanchiksawa[.]biz/<strong>adverting</strong>/?id=5345896&amp;keyword=fd2f2243cd2046d674aeec495cd2e74b&amp;uyijo=<strong>86tyh978</strong></li>
</ul>
<p>It’s easy to spot a pattern in these URLs:</p>
<ul>
<li>Third level domains</li>
<li><strong>Admedia</strong> or <strong>advertizing</strong> in the path part of the URLs (so we called this malware “<strong><em>admedia iframe injection</em></strong>“)</li>
<li>The same structure of URL parameter, including <strong>ad_id</strong> which is always the same – <strong>Twiue123</strong>.</li>
</ul>
<h3>Malicious Domains</h3>
<p>The use of the third level domains is typical for “domain shadowing.&#8221;  This involves adding malicious subdomains on legitimate second level domains after gaining access to DNS records.  In this case we deal with a domain registered specifically for this attack.</p>
<p>WHOIS records show that they all had been registered by “<strong>Vasunya</strong>” at <strong>valera.valera-146 @ yandex.ru</strong>  within the last two months:</p>
<ul>
<li><strong>poln1uewt1aniwki[.]ws</strong> – created on Dec 22, 2015</li>
<li><strong>findyourwaytotr[.]net</strong> – created on Jan 8, 2016</li>
<li><strong>oduvanchiksawa[.]biz</strong> – created on Feb 1, 2016</li>
</ul>
<p><strong>malenkiuniger[.]net</strong> – created on Feb 1, 2016</p>
<p>The last one was created Feb 1st,<strong> </strong> probably to work around blacklisting of the other domains. Nonetheless, Google has already blacklisted it as well: <a href="https://www.google.com/transparencyreport/safebrowsing/diagnostic/?#url=malenkiuniger.org" target="_blank">https://www.google.com/transparencyreport/safebrowsing/diagnostic/?#url=malenkiuniger.org</a></p>
<h3>Digital Ocean</h3>
<p>It is worth mentioning that all the malicious domains and subdomains point to servers to Digital Ocean&#8217;s network:  <strong>46.101.84.214</strong>, <strong>178.62.37.217</strong>, <strong>178.62.37.131, 178.62.90.65</strong></p>
<p>It’s not common to see malware hosted there, so it’s not a surprise to see Google listing only domains related to this attack as examples of known dangerous site on the <a href="https://www.google.com/transparencyreport/safebrowsing/diagnostic/?#url=AS202109%20%28DIGITALOCEAN-ASN-2%29" target="_blank">AS202109 (DIGITALOCEAN-ASN-2)</a> network.</p>
<h3>Previous Version of the Malware</h3>
<p>In the screenshot below you can see the <strong>gabosik12345[.]ws</strong> domain that I didn’t mention above. This domain was registered  by the same “Vasunya” on December 23, 2015. It was used in the previous incarnation of this attack along with some other domains registered last fall: <strong>trymyfinger[.]website</strong>, <strong>goroda235[.]pw</strong>, <strong>suchka46[.]pw</strong>, etc.</p>
<figure id="attachment_14642" aria-describedby="caption-attachment-14642" style="width: 750px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2016/02/safe-browsing-report-for-AS202109-DIGITALOCEAN-ASN-2.png" rel="lightbox"><img loading="lazy" class="wp-image-14642" src="https://blog.sucuri.net/wp-content/uploads/2016/02/safe-browsing-report-for-AS202109-DIGITALOCEAN-ASN-2-650x358.png" alt="SafeBrowsing report for AS202109 (DIGITALOCEAN-ASN-2)" width="750" height="413" srcset="https://blog.sucuri.net/wp-content/uploads/2016/02/safe-browsing-report-for-AS202109-DIGITALOCEAN-ASN-2-650x358.png 650w, https://blog.sucuri.net/wp-content/uploads/2016/02/safe-browsing-report-for-AS202109-DIGITALOCEAN-ASN-2-560x308.png 560w, https://blog.sucuri.net/wp-content/uploads/2016/02/safe-browsing-report-for-AS202109-DIGITALOCEAN-ASN-2-600x330.png 600w, https://blog.sucuri.net/wp-content/uploads/2016/02/safe-browsing-report-for-AS202109-DIGITALOCEAN-ASN-2-768x423.png 768w, https://blog.sucuri.net/wp-content/uploads/2016/02/safe-browsing-report-for-AS202109-DIGITALOCEAN-ASN-2.png 1624w" sizes="(max-width: 750px) 100vw, 750px" /></a><figcaption id="caption-attachment-14642" class="wp-caption-text">SafeBrowsing report for AS202109 (DIGITALOCEAN-ASN-2)</figcaption></figure>
<p>&nbsp;</p>
<p>We still <a href="https://sitecheck.sucuri.net/" target="_blank">detect</a> quite a few sites infected with the last fall&#8217;s malware variation:</p>
<figure id="attachment_14641" aria-describedby="caption-attachment-14641" style="width: 750px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2016/02/SiteCheck-detection.png" rel="lightbox"><img loading="lazy" class="wp-image-14641" src="https://blog.sucuri.net/wp-content/uploads/2016/02/SiteCheck-detection-650x238.png" alt="SiteCheck-detection" width="750" height="274" srcset="https://blog.sucuri.net/wp-content/uploads/2016/02/SiteCheck-detection-650x238.png 650w, https://blog.sucuri.net/wp-content/uploads/2016/02/SiteCheck-detection-560x205.png 560w, https://blog.sucuri.net/wp-content/uploads/2016/02/SiteCheck-detection-600x220.png 600w, https://blog.sucuri.net/wp-content/uploads/2016/02/SiteCheck-detection-768x281.png 768w, https://blog.sucuri.net/wp-content/uploads/2016/02/SiteCheck-detection-270x100.png 270w, https://blog.sucuri.net/wp-content/uploads/2016/02/SiteCheck-detection.png 1164w" sizes="(max-width: 750px) 100vw, 750px" /></a><figcaption id="caption-attachment-14641" class="wp-caption-text">SiteCheck reports malware in a .js file</figcaption></figure>
<p>&nbsp;</p>
<p>It also injected similar JavaScript code at the bottom of <strong>.js</strong> files and also used the <strong>ad-cookie=”er2vdr5gdc3ds”</strong> cookie, but the iframe URLs were slightly different, e.g. <em>hxxp://<strong>static.suchka46[.]pw</strong>/?id=6947627&amp;keyword=557334&amp;ad_id=<strong>Xn5be4</strong></em> .</p>
<h3>Constant Reinfections</h3>
<p>This malware uploads multiple backdoors into various locations on the webserver and frequently updates the injected code. This is why many webmasters are experiencing constant reinfections post-cleanup of their <strong>.js</strong> files.</p>
<p>The malware tries to infect all accessible .js files. This means that if you host several domains on the same hosting account all of them will be infected via a concept known as cross-site contamination. It’s not enough to clean just one site (e.g. the one you care about) or all but one (e.g. you don’t care about a test or backup site) in such situations – an abandoned site will be the <a href="https://blog.sucuri.net/2015/03/why-website-reinfections-happen.html" target="_blank">source of the reinfection</a>. In other words, you either need to isolate every sites or clean/update/protect all of them at the same time!</p>
<aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2016%2F02%2Fmassive-admedia-iframe-javascript-infection.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=Massive%20Admedia%2FAdverting%20iFrame%20Infection&url=https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--></div><footer class="entry-footer"><p class="entry-meta"><span class="entry-categories">Categories: <a href="https://blog.sucuri.net/category/website-security" rel="category tag">Website Security</a>, <a href="https://blog.sucuri.net/category/wordpress-security" rel="category tag">WordPress Security</a></span><span class="entry-tags">Tags: <a href="https://blog.sucuri.net/tag/hacked-websites" rel="tag">Hacked Websites</a>, <a href="https://blog.sucuri.net/tag/malvertising" rel="tag">Malvertising</a></span></p></footer></article><section class="author-box"><img alt='' src='https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=115&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=230&#038;d=mm&#038;r=g 2x' class='avatar avatar-115 photo' height='115' width='115' loading='lazy'/><h4 class="author-box-title">About <span itemprop="name">Denis Sinegubko</span></h4><div class="author-box-content" itemprop="description"><p>Denis Sinegubko is Sucuri’s Senior Malware Researcher who joined the company in 2013. Denis' main responsibilities include researching emerging threats and creating  signatures for SiteCheck. The founder of UnmaskParasites, his professional experience covers over 20 years of programming and information security. When Denis isn’t analyzing malware, you might not find him not online at all. Connect with him on <a href="https://twitter.com/unmaskparasites">Twitter</a>.</p>
</div></section><h2 class="screen-reader-text">Reader Interactions</h2><div class="entry-comments" id="comments"><h3>Comments</h3><ol class="comment-list">
	<li class="comment even thread-even depth-1" id="comment-7281">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/a8929cbe8ea27baed190656b316501cb?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a8929cbe8ea27baed190656b316501cb?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Halil Emre Özen</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-01T23:51:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7281">February 1, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>So htaccess url blocking can be helpful for detected URLs, right ?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7285">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Denis Sinegubko</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-02T13:44:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7285">February 2, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>.htaccess won&#8217;t help as this is a JavaScript redirect that works on a client level</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7282">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/bb2a6e85307e20ae78274f527a180f4b?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/bb2a6e85307e20ae78274f527a180f4b?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Canuckistani</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-02T00:25:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7282">February 2, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>&#8220;It’s not common to see malware hosted there&#8221; &#8211; that&#8217;s because Digital Ocean is known for hosting blog/forum and email spammers instead.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-7283">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/1d762f67ad598e44638be4d54d688e59?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1d762f67ad598e44638be4d54d688e59?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Chris Backe</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-02T00:45:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7283">February 2, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Best way to check / clean if infected?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-7287">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Denis Sinegubko</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-02T13:54:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7287">February 2, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>In case of this infection, the easiest way is to check any .js files if they have the malware at the very bottom (note, it&#8217;s being appended to the last line, not inserted a new line of code, so make sure to scroll the last line all the way to the right, to turn on line wrapping).</p>
<p>To clean up, just replace the infected .js file with their original versions. It&#8217;s the easiest part. Then you need to find and remove all backdoor and close all security holes &#8211; this part is trickier as there are many variations.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-7284">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/173b90bf8d238e87a2cd766221710df0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/173b90bf8d238e87a2cd766221710df0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Dave Brong</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-02T01:56:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7284">February 2, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I have a client site that got infected with this last week (not on the Sucuri Firewall, unfortunately). It&#8217;s everywhere &#8211; every js, I even see benign php files being inserted into every folder to throw off finding the actual infection point.</p>
<p>Has anyone found the vulnerability being used to insert/modify the code?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-7286">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Denis Sinegubko</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-02T13:50:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7286">February 2, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I believe they scan for multiple vulnerabilities and exploit whatever hole they find. On some sites I saw they used backdoors uploaded months or weeks before the spike. So it easily be a vulnerability that had been fixed some time ago, but webmasters failed to properly clean their sites (find and remove all backdoors) after previous infections.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-7288">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/16ed25a57ebf7b4e53a646f73cb2594f?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/16ed25a57ebf7b4e53a646f73cb2594f?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://desperatelyseekingwp.com/" class="comment-author-link" rel="external nofollow" itemprop="url">Cathy Tibbles</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-02T17:09:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7288">February 2, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Whats the bottom line? You guys need a translator some times!! If my site is on your monitor every 6 hours, will you catch it?  How will we know if a site is infected?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-7289">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/72345495398482431830b8470c59a582?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/72345495398482431830b8470c59a582?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Alycia</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-02T17:22:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7289">February 2, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hi Cathy! If your site is infected and you are set up with the Sucuri<br />
AntiVirus, you will get an alert from the server side or remote scanner,<br />
 via email (there are also additional alerting options in the Sucuri<br />
dashboard). The Sucuri Firewall protects against infection in the first<br />
place.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-3" id="comment-7290">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/16ed25a57ebf7b4e53a646f73cb2594f?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/16ed25a57ebf7b4e53a646f73cb2594f?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://desperatelyseekingwp.com/" class="comment-author-link" rel="external nofollow" itemprop="url">Cathy Tibbles</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-02T17:31:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7290">February 2, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>what does it look like if you&#8217;re infected? what happens?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even depth-2" id="comment-7321">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/79c6093e2ef50edd54c4a7c37b15999d?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/79c6093e2ef50edd54c4a7c37b15999d?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Jason Crawford</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-10T00:47:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7321">February 10, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>It&#8217;s times like this I wish there were a like button everywhere.  Thank you for expressing what I could not.  Translator did seem to be needed in this case.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-7291">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/38ecf1e492d6fdf491e7a941f8865ab5?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/38ecf1e492d6fdf491e7a941f8865ab5?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">John SomeJerk</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-02T19:58:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7291">February 2, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>So far I have been able to update WordPress, the theme files and all plug-ins (even if they are up to date) and it&#8217;s saved a couple of my sites. However preventing this seems to be the real challenge.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-7294">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://dcid.me" class="comment-author-link" rel="external nofollow" itemprop="url">Daniel Cid</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-03T16:33:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7294">February 3, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>You have to think of security as a never ending process of improvements until you can get to a point where your site is not being reinfected / infected anymore.</p>
<p>Updating WordPress and all themes and plugins is a good first step. Next is to find any left over backdoor that might be used to reinfect it. The next step is to add protection and visibility, which you can do with our own free WordPress plugin or even our paid WAF product. Next step is to start doing regular backups, Next step is monitoring&#8230; Next step is update it again.. Or do code reviews and so on and so on&#8230;</p>
<p>At some point your site will reach a point where trying to hack it is not worth the time and money that the attackers will have to spend to go through all the layers you have in place. At the point, you will likely not get infected/reinfected anymore 🙂 </p>
<p>thanks,</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-3" id="comment-7300">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/38ecf1e492d6fdf491e7a941f8865ab5?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/38ecf1e492d6fdf491e7a941f8865ab5?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">John SomeJerk</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-04T17:52:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7300">February 4, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Since I commented, all of my WordPress websites were reverted back to how they were before I fixed them, and now any adjustments I make do not seem to be sticking. HostGator is basically like &#8220;fix it or pay us&#8221; but can&#8217;t tell me how the &#8220;hacker&#8221; is getting into my account. They want me to pay SiteLock $200 to fix the issues but won&#8217;t tell me how I can secure my account so this no longer happens. Seems like a racket.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7292">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/adb53730d82dc50aea59df4a3e737ba2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/adb53730d82dc50aea59df4a3e737ba2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">thecodezombie</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-03T09:23:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7292">February 3, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>One thing I&#8217;m failing to pick out from this article is HOW the malware gets in.<br />
&#8211; Vulnerability in an old version of WordPress?<br />
&#8211; Vulnerability in a plugin?</p>
<p>You said in another comment, &#8220;The Sucuri Firewall protects against infection in the first place.&#8221; &#8230;so you know how, correct?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7293">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Denis Sinegubko</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-03T12:43:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7293">February 3, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>We know and protect agains thousands attacks but we can&#8217;t tell (without investigation) how some specific site had been hacked. That&#8217;s because hackers also know multiple vulnerabilities and they no longer use just one vulnerability. They scan your site for multiple security holes and exploit the ones that they find still open. Plus some campaigns re-use backdoors uploaded during previous attacks months ago</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7295">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/7afbf52eb7fb985acdef401843f347f0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7afbf52eb7fb985acdef401843f347f0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Pham Phương Bình</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-03T18:51:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7295">February 3, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Try to scan and replace it with php script. Include it on header.php To scan structure of malware script and replace it. It was help you to stop effect from this malware temporary.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-7299">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/7edc0c7374bc1e725e899f8bdac68c78?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7edc0c7374bc1e725e899f8bdac68c78?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Richie</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-04T15:23:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7299">February 4, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>What&#8217;s the risk to the end user visiting the site who get&#8217;s redirected? Nice article &#8211; thanks for posting.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-7301">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/da4ca60f90e1b474d72f4e4b3955c34d?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/da4ca60f90e1b474d72f4e4b3955c34d?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">kobo1d</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-04T18:48:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7301">February 4, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>This. What does the iFrame do?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-2" id="comment-7323">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/e2ffe24ed660754686b36f15451842f4?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e2ffe24ed660754686b36f15451842f4?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.slickrockweb.com" class="comment-author-link" rel="external nofollow" itemprop="url">Eric Nelson</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-11T04:28:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7323">February 11, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Other articles have now been published about this and it appears to be fairly well established that these code injections redirect users to domains appearing to be hosting ads. This is a merely a distraction as the ad is stuffed with more code that sends visitors to the Nuclear Exploit Kit. Here the user can potentially have their computer infected with Ransomware.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7306">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/da17d1a75040b0c648e914f75c4ab339?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/da17d1a75040b0c648e914f75c4ab339?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Joel Friesen</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-05T18:47:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7306">February 5, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Is there an online tool to check for this, or other fishy JS exploits?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7331">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/09162d5e4e50defa3654e6b3b18cf888?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/09162d5e4e50defa3654e6b3b18cf888?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Peter Kulcsár</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-12T14:54:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7331">February 12, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I&#8217;m using Quttera for finding malware code in JS files. But it can search only in files which are loaded on the frontend.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7308">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/da3204d7ff3f8ade7365a6bde5f33ab2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/da3204d7ff3f8ade7365a6bde5f33ab2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Benjamin Bernier</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-06T16:26:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7308">February 6, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>we wound up having to write some regex to cleanse up our files and this pattern worked for us. Hopefully it can save someone else some time:</p>
<p>sed -i -E &#8220;s/(/*.{32}*/;window[.*/*.{32}*/)/ /&#8221; ./*.js</p>
<p>someone smarter than me can probably make this recursive</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7309">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/da3204d7ff3f8ade7365a6bde5f33ab2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/da3204d7ff3f8ade7365a6bde5f33ab2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Benjamin Bernier</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-06T16:56:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7309">February 6, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>i got smarter and made it recursive</p>
<p>find /var/www/html/ -type f -exec sed -i -E &#8220;s/(/*.{32}*/;window[.*/*.{32}*/)/ /&#8221; {} +</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-3" id="comment-7329">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/807c104d44d833eb3bb57eb6fc70e860?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/807c104d44d833eb3bb57eb6fc70e860?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Namit Mhatre</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-12T07:25:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7329">February 12, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>You saved me!</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-3" id="comment-7338">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/0fba17a8a2835c8741e74c5d22acddd2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0fba17a8a2835c8741e74c5d22acddd2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Nicolay</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-16T01:29:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7338">February 16, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hello,</p>
<p>I&#8217;m a total amateur, can you please explain it to me where should I write these regular expressions you constructed?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-4" id="comment-7339">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/da3204d7ff3f8ade7365a6bde5f33ab2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/da3204d7ff3f8ade7365a6bde5f33ab2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Benjamin Bernier</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-16T15:44:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7339">February 16, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>if you run them via the command line (SSH) you should be all set.</p>
<p>Be sure to replace /var/www/html with your DocRoot</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-5" id="comment-7341">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/0fba17a8a2835c8741e74c5d22acddd2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0fba17a8a2835c8741e74c5d22acddd2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Nicolay</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-17T17:35:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7341">February 17, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks. 🙂 </p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7311">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/832e5c67d1940e52fac117387385eb3b?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/832e5c67d1940e52fac117387385eb3b?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.csorbamedia.com" class="comment-author-link" rel="external nofollow" itemprop="url">Stephan Csorba</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-07T22:05:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7311">February 7, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>find . -type d -name &#8220;wp-content&#8221;|sed &#8216;s/(.*)/public_html/.*/1/&#8217;|sort -u|while read path; do find $path -type f -name &#8220;*.js&#8221; -print|while read file; do grep -Hm1 &#8211;color &#8220;.join(\\&#8221;\\&#8221;);&#8221;));&#8221; $file; done; done;</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-7316">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/4f22b97d4b534bdec2238ba1479dd242?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4f22b97d4b534bdec2238ba1479dd242?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Ross Cooper</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-09T14:38:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7316">February 9, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Does your SiteCheck tool scan for signs of this infection?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7317">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f7efcc1e6be5057509b467142eb2954f?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f7efcc1e6be5057509b467142eb2954f?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">kevin ard</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-09T15:11:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7317">February 9, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>This rex gets the mal-js every time: (/*(.){32}*/);window.*1<br />
But the backdoor is the hairy part. I&#8217;m considering just removing apache&#8217;s write access from all the js files :/</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-7318">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/70ede3ebb0f1d0955c396584e1511aa0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/70ede3ebb0f1d0955c396584e1511aa0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Morris Code</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-09T19:14:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7318">February 9, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Can you share how you deobfuscated/decrypted the original malscript?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7319">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/70ede3ebb0f1d0955c396584e1511aa0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/70ede3ebb0f1d0955c396584e1511aa0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Morris Code</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-09T20:04:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7319">February 9, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Can you share how you decrypted/deobfuscated the original code?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-7324">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/09162d5e4e50defa3654e6b3b18cf888?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/09162d5e4e50defa3654e6b3b18cf888?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Peter Kulcsár</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-11T15:31:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7324">February 11, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hi for everyone,</p>
<p>I have struggled with this infection for a time. And I want to share my solution, which can remove this from every JS file within less then 5 seconds. Every command is called recursivily, so if you run it on public_html/ www/ folder it will include wp-admin, wp-content, everything. The pattern in our case is a regular express [a-z0-9]{32} means lowercase letters and numbers and exactly 32 times.</p>
<p>1. Search if there is a JS infection on your server, the -l switch will list only the file names<br />
find . -name &#8220;*.js&#8221; | xargs grep -E &#8220;/*[a-z0-9]{32}*/&#8221; -l | sort</p>
<p>2. Add a new line character before the pattern, this is very important, sed can only delete lines from files upwards.<br />
find . -name &#8220;*.js&#8221;  -exec sed -i &#8220;s//*[a-z0-9]{32}*//n&amp;/g&#8221; &#8216;{}&#8217; ;</p>
<p>3. Finally delete the malware code from all infected JS files:<br />
find . -name &#8220;*.js&#8221;  -exec sed -i &#8220;/[a-z0-9]{32}/,/[a-z0-9]{32}/d&#8221; &#8216;{}&#8217; ;</p>
<p>Before you try this please test it on one file, i have a CentOS server installed.</p>
<p>I have found two backdoors installed with the help of access_logs.<br />
/wp-content/plugins/yith-woocommerce-ajax-search/widgets/class44a.php<br />
/wp-content/languages/admin-network-hu_HU182a1.php</p>
<p>I hope this helps someone.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-7342">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f505340b270afe1a06370b650a004df6?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f505340b270afe1a06370b650a004df6?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Michael Thwaite</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-18T01:03:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7342">February 18, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Can I fax you a beer! You saved our site; that&#8217;s some smart code, thanks.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-3" id="comment-7343">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/9bd0fff9e2a1c20aefdd4242c109fd6c?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9bd0fff9e2a1c20aefdd4242c109fd6c?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.transportevolved.com/" class="comment-author-link" rel="external nofollow" itemprop="url">Nikki Gordon-Bloomfield</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-18T01:04:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7343">February 18, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I second what Michael just said. You helped solve a really nasty infection in 60 minutes flat. Thank you.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-3" id="comment-7348">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/09162d5e4e50defa3654e6b3b18cf888?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/09162d5e4e50defa3654e6b3b18cf888?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Peter Kulcsár</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-18T15:47:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7348">February 18, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I&#8217;m glad it helped you! 🙂 And thanks for the beer.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt depth-2" id="comment-7355">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/dfd8365fa9015c3e521a5bdec5f1eade?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/dfd8365fa9015c3e521a5bdec5f1eade?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.mister-wp.com" class="comment-author-link" rel="external nofollow" itemprop="url">Mister WordPress</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-20T16:01:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7355">February 20, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thank you so much. Can I pay you a drink ? 🙂 Your command lines save my evening, thanks thanks !!!!</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-3" id="comment-7356">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/09162d5e4e50defa3654e6b3b18cf888?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/09162d5e4e50defa3654e6b3b18cf888?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Peter Kulcsár</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-20T17:24:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7356">February 20, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>You are welcome! 🙂 Sure! I will take a beer 🙂</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt depth-2" id="comment-7365">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/74f1276e8f314eda6c8b6c1e0abfb497?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/74f1276e8f314eda6c8b6c1e0abfb497?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Thibault Richard</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-23T12:51:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7365">February 23, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Excellent ! You rulez !!!!!!!!!!!!</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-2" id="comment-7370">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/2350151ecf40f5accd98af2ffe1b9f3f?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2350151ecf40f5accd98af2ffe1b9f3f?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.archivosdeprograma.es" class="comment-author-link" rel="external nofollow" itemprop="url">Joe</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-24T08:59:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7370">February 24, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Perfect!! you have saved my life</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-2" id="comment-7378">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/3d0e8c4f62afd5e47252d67c10ec2fb6?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3d0e8c4f62afd5e47252d67c10ec2fb6?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">jonathanober</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-26T15:12:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7378">February 26, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>How would one address this on a Media Temple gridserver that has 20-30 sites hosted on it? Are you familiar with that set up? I have access to the main host via ftp. Not sure if I can command line in like this or no where I would start. Thank you for any help.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-3" id="comment-7389">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/09162d5e4e50defa3654e6b3b18cf888?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/09162d5e4e50defa3654e6b3b18cf888?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Peter Kulcsár</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-03-03T14:09:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7389">March 3, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Sorry, but I&#8217;m not familiar with the Media Temple gridserver setup. If you can get an SSH connection to your server you can run these commands lines easily.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt depth-2" id="comment-7383">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/470e145e6b167b8c87d680939461d26e?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/470e145e6b167b8c87d680939461d26e?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Derek</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-03-01T17:42:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7383">March 1, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hi Peter, thanks for sharing your solution as I&#8217;ve found it useful in a number of infected sites so far. I just came across a site with the same infection, however, the malicious code block is now at the top of every JS file rather than the bottom. I&#8217;m having a bit of trouble coming up with a matching pattern similar to yours above but instead adding a new line character after the pattern instead of before it. Any suggestions? Thanks!</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-2" id="comment-7391">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/8d0be33acff990fa32d7d5950831e245?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8d0be33acff990fa32d7d5950831e245?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Matt</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-03-03T21:17:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7391">March 3, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hello Peter, </p>
<p>I really need to do this process on my website as I have identified the admedia malware is what is affecting my sites. However, I am unfamiliar with how to go about completing your 3 steps. Could you tell me where I need to go within my FTP program to run these searches? I appreciate it. Thanks.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-3" id="comment-7417">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/09162d5e4e50defa3654e6b3b18cf888?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/09162d5e4e50defa3654e6b3b18cf888?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Peter Kulcsár</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-03-07T23:20:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7417">March 7, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hi,</p>
<p>You need to get SSH connection to your server, then you can run my commands :). Some of hosting providers if you have shared hosting does not provide this feature. In this case try to contact them :).</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even depth-2" id="comment-7416">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/feefadb8fc4c381f5e56723bc13b04cb?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/feefadb8fc4c381f5e56723bc13b04cb?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Gigi</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-03-07T18:59:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7416">March 7, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thank you very much Peter. I&#8217;ve been struggling with this issue about 2 weeks. It is an exhausting process. </p>
<p>I have completed these 3 steps but now how can I do the same thing for my infected php files? Please advise. Thank you.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-3" id="comment-7418">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/09162d5e4e50defa3654e6b3b18cf888?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/09162d5e4e50defa3654e6b3b18cf888?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Peter Kulcsár</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-03-07T23:23:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7418">March 7, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hello Gigi, I&#8217;m glad it helped you too :).</p>
<p>For *.php files you need to take another approche. I don&#8217;t think there would be a pattern like in JS files.<br />
But if thats the case you just only need to change:<br />
find . -name &#8220;*.js&#8221; | xargs grep -E &#8220;/*[a-z0-9]{32}*/&#8221; -l | sort<br />
to<br />
find . -name &#8220;*.php&#8221; | xargs grep -E &#8220;/*[a-z0-9]{32}*/&#8221; -l | sort</p>
<p>Try to find infected php files with the help of access_log and error_log files.<br />
In the access_log you can find who created the file on your server and block that IP to protect your server from future infections.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7333">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/666f3b009304bd4f384a6d9a484b7e23?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/666f3b009304bd4f384a6d9a484b7e23?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://william.solutions" class="comment-author-link" rel="external nofollow" itemprop="url">William LA</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-12T17:08:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7333">February 12, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks for this detailed explanation of the exploit and the different commands to clean the javascript files (in comments). I realized this morning that all my 20 WordPress sites have been infected for some time now. I have seen multiple &#8220;.php&#8221; backdoor files in different places. Now, I think I will have to manually save the databases and make a clean install of every site. What a real hassle and slap in the face : do not host temporary out-dated WordPress projects on production servers.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-7346">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/ce7f13954d8dc03a72817cbd2691bbfc?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ce7f13954d8dc03a72817cbd2691bbfc?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">iamswan</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-18T12:42:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7346">February 18, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I am not able to find .php backdoors? What should i look for?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7350">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/149e4aa42b709e863df9a9fed9bfb22d?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/149e4aa42b709e863df9a9fed9bfb22d?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Ron</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-19T04:22:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7350">February 19, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Dealing with this nightmare right now. Thanks to Peter again for his help.</p>
<p>I thought I would contribute my own observations as I try to root out the backdoors.</p>
<p>First, I&#8217;m not sure why my client has a bunch of files without extensions in his public_html folder. Many of them have seemingly legit javascript in them but they also have the malicious javascript at the end of them, in between the two comments, just like described in the article. So, in other words, it may not be limited to files with the *.js extension.</p>
<p>My solution? This might not be the most elegant, I&#8217;m not great with SSH / RegEx, but I just took Peter&#8217;s steps and ran them again, but instead of &#8220;*.js&#8221; I just put &#8220;*&#8221; . That seems to have worked.</p>
<p>Second&#8230; (see reply)</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-7351">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/149e4aa42b709e863df9a9fed9bfb22d?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/149e4aa42b709e863df9a9fed9bfb22d?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Ron</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-19T04:25:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7351">February 19, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Second, I&#8217;m looking through my PHP files for the backdoor. There was a file called &#8220;option.php&#8221; buried in the uploads directory. It seemed like an empty PHP file at first but in the first line there was &#8220;&lt;?php&quot; followed by a ton of spaces followed by the malicious code (so unless you have wordwrap turned on, it is not immediately obvious.</p>
<p>Here is an example of what I found in that file:</p>
<p>&#8212;&#8212;&#8212;-</p>
<p>&#8212;&#8212;&#8212;&#8212;&#8211;</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-3" id="comment-7352">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/09162d5e4e50defa3654e6b3b18cf888?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/09162d5e4e50defa3654e6b3b18cf888?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Peter Kulcsár</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-19T09:42:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7352">February 19, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>🙂 You can use: find . -type f instead of find . -name &#8220;*.js&#8221;</p>
<p>Try to run this check when there is small amount of visitors on your site:<br />
Anti-Malware Security and Brute-Force Firewall (FREE)</p>
<p>Also check the permissions on files and directories which should be 644 for files and 755 for directories.<br />
Keep WP/themes/plugins updated.<br />
Check access_log, error_log for errors.</p>
<p>There are so many things to do, even to protect your site or just find the culprit/backdoor of infections :(.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-4" id="comment-7354">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/149e4aa42b709e863df9a9fed9bfb22d?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/149e4aa42b709e863df9a9fed9bfb22d?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Ron</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-20T02:40:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7354">February 20, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks, yeah I was sure there was a better way, but not super familiar with SSH yet.</p>
<p>We managed to recover the sites we made for our client 3 years ago and get them up and running our server. As for the corrupted sites that he had other people do, I&#8217;ve given up on fixing those and I&#8217;m just going to pitch him on us rebuilding them since it&#8217;d probably take me less time. (He had a cheap shared server account on HostGator, so there&#8217;s a chance the whole server was somehow corrupted.)</p>
<p>Thanks again for the help! I wasted a bunch of time dealing with this but I&#8217;ll chalk this all up as a learning experience.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7361">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/51475580377f0fbae88e94ff05799da1?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/51475580377f0fbae88e94ff05799da1?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Shehab</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-22T11:51:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7361">February 22, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>We are going through the same issue, almost all .js files are infected with a code at the bottom, out technical team was able to run regular expressions and find all the infected .js files, however we are still trying to find the backdoors.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-7364">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/2856b83a0bd9210e2de9cc334c2ba557?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2856b83a0bd9210e2de9cc334c2ba557?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.coolestguidesontheplanet.com/" class="comment-author-link" rel="external nofollow" itemprop="url">Neil Gee</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-02-23T03:17:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7364">February 23, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hi Peter &#8211; thank you very much &#8211; your commands worked flawlessly!</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-7420">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/33e94609707a92be1eaed01b4403c78b?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/33e94609707a92be1eaed01b4403c78b?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Tom Stevens</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-03-09T10:27:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html#comment-7420">March 9, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I discovered all my sites got this infection too. I went through hundreds of javascript and php files selecting and deleting, selecting and deleting, but after hours and hours I had to delete three sites which just had too many infected files. It seemed that not a single .js or php file was untouched.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ol></div></main><aside class="sidebar sidebar-primary widget-area" role="complementary" aria-label="Primary Sidebar" itemscope itemtype="https://schema.org/WPSideBar" id="genesis-sidebar-primary"><h2 class="genesis-sidebar-title screen-reader-text">Primary Sidebar</h2><div class="sidebar-primary-wrap"><section id="text-5" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Socialize With Sucuri</h3>
			<div class="textwidget"><p>We're actively engaged across multiple platforms. Follow us and let's connect!</p>
<ul class="social-icons">
<li><a target="_blank" href="https://www.facebook.com/SucuriSecurity" rel="noopener"><span class="screen-reader-text">Facebook</span></a></li>
<li><a target="_blank" href="https://twitter.com/sucurisecurity" rel="noopener"><span class="screen-reader-text">Twitter</span></a></li>
<li><a target="_blank" href="https://www.linkedin.com/company/sucuri-security" rel="noopener"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a target="_blank" href="https://www.youtube.com/c/sucurinet" rel="noopener"><span class="screen-reader-text">YouTube</span></a></li>
<li><a target="_blank" href="https://www.instagram.com/sucurisecurity/" rel="noopener"><span class="screen-reader-text">Instagram</span></a></li>
<li><a target="_blank" href="https://blog.sucuri.net/feed/" rel="noopener"><span class="screen-reader-text">RSS Feed</span></a></li>
</ul>
</div>
		</div></section>
<section id="search-3" class="widget widget_search"><div class="widget-wrap"><form class="search-form" method="get" action="https://blog.sucuri.net/"><label class="search-form-label screen-reader-text" for="searchform-62ea523c872ce">Search the blog</label><input type="search" name="s" id="searchform-62ea523c872ce" placeholder="Search the blog" /><input type="submit" value="Search" /></form></div></section>
<section id="text-13" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://info.sucuri.net/wordpress-security-course?utm_source=Blog&amp;utm_medium=WidgetLogic&amp;utm_campaign=Email-Course&amp;utm_term=EN&amp;utm_content=WordPress-Security" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23218 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/04/blog-sidebar_widgetlogic_emailCourse_wordpress-security.png" alt="WordPress Security Course" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-30" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/guides/wordpress-security?utm_source=Blog&#038;utm_medium=WidgetLogic&#038;utm_campaign=Guide&#038;utm_term=EN&#038;utm_content=WP-Security" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23353 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_guides_wordpress-security.png" alt="WordPress Security Guide" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-37" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"></div>
		</div></section>
</div><div class="sidebar-cta-widget" id="sidebar-cta"><section id="text-6" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Join Over 20,000 Subscribers!</h3>
			<div class="textwidget"><p><a href="http://sucuri.hs-sites.com/subscribe-to-security" onClick="ga('send', 'event', 'Blog', 'Button_Click', 'Subscribe_to_Security_Newsletter');"><img src="https://blog.sucuri.net/wp-content/uploads/2017/09/17-EN-sucuri-blog-newsletter-banner.png" /></a></p>
</div>
		</div></section>
</div></aside></div></div></div><footer class="site-footer" itemscope itemtype="https://schema.org/WPFooter"><div class="footer-widgets" id="genesis-footer-widgets"><h2 class="genesis-sidebar-title screen-reader-text">Footer</h2><div class="wrap"><div class="widget-area footer-widgets-1 footer-widget-area"><section id="nav_menu-3" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Products</h3>
<div class="menu-footer-products-menu-container"><ul id="menu-footer-products-menu" class="menu"><li id="menu-item-15501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15501"><a href="https://sucuri.net/website-firewall/" itemprop="url">Website Firewall</a></li>
<li id="menu-item-15502" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15502"><a href="https://sucuri.net/website-antivirus/" itemprop="url">Website AntiVirus</a></li>
<li id="menu-item-15503" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15503"><a href="https://sucuri.net/website-backups/" itemprop="url">Website Backups</a></li>
<li id="menu-item-15504" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15504"><a href="https://sucuri.net/wordpress-security/" itemprop="url">WordPress Security</a></li>
<li id="menu-item-15505" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15505"><a href="https://sucuri.net/custom/enterprise/" itemprop="url">Enterprise Services</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-2 footer-widget-area"><section id="nav_menu-4" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Solutions</h3>
<div class="menu-footer-solutions-menu-container"><ul id="menu-footer-solutions-menu" class="menu"><li id="menu-item-15506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15506"><a href="https://sucuri.net/website-firewall/ddos-protection" itemprop="url">DDos Protection</a></li>
<li id="menu-item-15507" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15507"><a href="https://sucuri.net/website-antivirus/malware-scanning-and-detection" itemprop="url">Malware Detection</a></li>
<li id="menu-item-15508" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15508"><a href="https://sucuri.net/website-antivirus/malware-removal" itemprop="url">Malware Removal</a></li>
<li id="menu-item-15510" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15510"><a href="https://sucuri.net/website-firewall/stop-website-attacks-and-hacks" itemprop="url">Malware Prevention</a></li>
<li id="menu-item-15511" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15511"><a href="https://sucuri.net/website-antivirus/blacklist-removal-and-repair" itemprop="url">Blacklist Removal</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-3 footer-widget-area"><section id="nav_menu-6" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Support</h3>
<div class="menu-footer-support-menu-container"><ul id="menu-footer-support-menu" class="menu"><li id="menu-item-15512" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15512"><a href="https://blog.sucuri.net/" itemprop="url">Blog</a></li>
<li id="menu-item-15513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15513"><a href="https://kb.sucuri.net/" itemprop="url">Knowledge Base</a></li>
<li id="menu-item-15515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15515"><a href="https://sitecheck.sucuri.net/" itemprop="url">SiteCheck</a></li>
<li id="menu-item-15516" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15516"><a href="http://labs.sucuri.net/" itemprop="url">Research Labs</a></li>
<li id="menu-item-15517" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15517"><a href="https://sucuri.net/faq/" itemprop="url">FAQ</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-4 footer-widget-area"><section id="nav_menu-5" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Company</h3>
<div class="menu-footer-company-menu-container"><ul id="menu-footer-company-menu" class="menu"><li id="menu-item-15495" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15495"><a href="https://sucuri.net/company/" itemprop="url">About</a></li>
<li id="menu-item-15496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15496"><a href="https://sucuri.net/company/media" itemprop="url">Media</a></li>
<li id="menu-item-15497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15497"><a href="https://sucuri.net/company/events" itemprop="url">Events</a></li>
<li id="menu-item-15498" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15498"><a href="https://sucuri.net/company/employment/" itemprop="url">Employment</a></li>
<li id="menu-item-15499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15499"><a href="https://sucuri.net/company/contact-us" itemprop="url">Contact</a></li>
<li id="menu-item-15500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15500"><a href="https://sucuri.net/customers/" itemprop="url">Testimonials</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-5 footer-widget-area"><section id="text-4" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><ul class="social-icons">
<li><a href="https://www.facebook.com/SucuriSecurity"><span class="screen-reader-text">Facebook</span></a></li>
<li><a href="https://twitter.com/sucurisecurity"><span class="screen-reader-text">Twitter</span></a></li>
<li><a href="https://www.linkedin.com/company/sucuri-security"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a href="https://www.instagram.com/sucurisecurity/"><span class="screen-reader-text">Instagram</span></a></li>
</ul>
<p><a class="button" href="https://dashboard.sucuri.net/login/">Customer Login</a></p>
<p><a class="footer-logo" href="https://sucuri.net/">Sucuri Home</a></p>
</div>
		</div></section>
</div></div></div><div class="site-footer-widget"><div class="wrap"><section id="text-8" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><div class="site-footer-links">
<ul>
<li><a href="https://sucuri.net/terms">Terms of Use</a></li>
<li><a href="https://sucuri.net/privacy">Privacy Policy</a></li>
<li><a href="https://sucuri.net/faq/">Frequently Asked Questions</a></li>
</ul>
</div>
<div class="site-footer-copyright">
<p>&#x000A9;&nbsp;2022 Sucuri Inc. All rights reserved</p>
</div>
</div>
		</div></section>
</div></div></footer></div><script type="text/javascript">
ire('identify', {customerId: '​​', customerEmail: '​​'}); </script><div id="cookie-policy-banner" class="container-fluid cookie-policy-banner hide p-0">
        <div class="container">
            <button id="cookie-policy-decline-btn" class="cb-close cb-decline-anchor">X</button>
            <div class="row">
                <div class="c-lg-8">
                    <p class="mb-0 mt-0 highlight green heavy">Sucuri Cookie Policy <br> <a href="https://sucuri.net/cookies" target="_blank" class="bolder no-underline">See our policy>></a></p>
                    <p class="mb-0 mt-0">Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.</p>
                </div>
                <div class="c-lg-4 d-flex justify-items-start mt-15 align-items-center">
                    <button id="cookie-policy-btn" class="btn btn-primary ml-0">Accept</button>
                    <button class="btn cb-decline-anchor auto-track" data-gatrack="Cookie_Click, Decline">Decline</button>
                    <button id="manage-privacy-options" class="btn">Manage Options</button>
                </div>
            </div>
        </div>
    </div><script type="text/javascript">
		/* MonsterInsights Scroll Tracking */
			if ( typeof(jQuery) !== 'undefined' ) {
				jQuery( document ).ready(function(){
					function monsterinsights_scroll_tracking_load() {
						if ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) {
							(function(factory) {
								factory(jQuery);
							}(function($) {

								/* Scroll Depth */
								"use strict";
								var defaults = {
									percentage: true
								};

								var $window = $(window),
									cache = [],
									scrollEventBound = false,
									lastPixelDepth = 0;

								/*
								 * Plugin
								 */

								$.scrollDepth = function(options) {

									var startTime = +new Date();

									options = $.extend({}, defaults, options);

									/*
									 * Functions
									 */

									function sendEvent(action, label, scrollDistance, timing) {

										var fieldsArray = {
											hitType       : 'event',
											eventCategory : 'Scroll Depth',
											eventAction   : action,
											eventLabel    : label,
											eventValue    : 1,
											nonInteraction: 1
										};

										if ( 'undefined' === typeof MonsterInsightsObject || 'undefined' === typeof MonsterInsightsObject.sendEvent ) {
											return;
										}

										MonsterInsightsObject.sendEvent( fieldsArray );
										if (arguments.length > 3) {
											fieldsArray = {
												hitType        : 'timing',
												timingCategory : 'Scroll Depth',
												timingVar      : action,
												timingValue    : timing,
												timingLabel    : label,
												nonInteraction: 1
											};
											MonsterInsightsObject.sendEvent( fieldsArray );
										}
									}

									function calculateMarks(docHeight) {
										return {
											'25%' : parseInt(docHeight * 0.25, 10),
											'50%' : parseInt(docHeight * 0.50, 10),
											'75%' : parseInt(docHeight * 0.75, 10),
											/* Cushion to trigger 100% event in iOS */
											'100%': docHeight - 5
										};
									}

									function checkMarks(marks, scrollDistance, timing) {
										/* Check each active mark */
										$.each(marks, function(key, val) {
											if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
												sendEvent('Percentage', key, scrollDistance, timing);
												cache.push(key);
											}
										});
									}

									function rounded(scrollDistance) {
										/* Returns String */
										return (Math.floor(scrollDistance/250) * 250).toString();
									}

									function init() {
										bindScrollDepth();
									}

									/*
									 * Public Methods
									 */

									/* Reset Scroll Depth with the originally initialized options */
									$.scrollDepth.reset = function() {
										cache = [];
										lastPixelDepth = 0;
										$window.off('scroll.scrollDepth');
										bindScrollDepth();
									};

									/* Add DOM elements to be tracked */
									$.scrollDepth.addElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.merge(options.elements, elems);

										/* If scroll event has been unbound from window, rebind */
										if (!scrollEventBound) {
											bindScrollDepth();
										}

									};

									/* Remove DOM elements currently tracked */
									$.scrollDepth.removeElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.each(elems, function(index, elem) {

											var inElementsArray = $.inArray(elem, options.elements);
											var inCacheArray = $.inArray(elem, cache);

											if (inElementsArray != -1) {
												options.elements.splice(inElementsArray, 1);
											}

											if (inCacheArray != -1) {
												cache.splice(inCacheArray, 1);
											}

										});

									};

									/*
									 * Throttle function borrowed from:
									 * Underscore.js 1.5.2
									 * http://underscorejs.org
									 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
									 * Underscore may be freely distributed under the MIT license.
									 */

									function throttle(func, wait) {
										var context, args, result;
										var timeout = null;
										var previous = 0;
										var later = function() {
											previous = new Date;
											timeout = null;
											result = func.apply(context, args);
										};
										return function() {
											var now = new Date;
											if (!previous) previous = now;
											var remaining = wait - (now - previous);
											context = this;
											args = arguments;
											if (remaining <= 0) {
												clearTimeout(timeout);
												timeout = null;
												previous = now;
												result = func.apply(context, args);
											} else if (!timeout) {
												timeout = setTimeout(later, remaining);
											}
											return result;
										};
									}

									/*
									 * Scroll Event
									 */

									function bindScrollDepth() {

										scrollEventBound = true;

										$window.on('scroll.scrollDepth', throttle(function() {
											/*
											 * We calculate document and window height on each scroll event to
											 * account for dynamic DOM changes.
											 */

											var docHeight = $(document).height(),
												winHeight = window.innerHeight ? window.innerHeight : $window.height(),
												scrollDistance = $window.scrollTop() + winHeight,

												/* Recalculate percentage marks */
												marks = calculateMarks(docHeight),

												/* Timing */
												timing = +new Date - startTime;

											checkMarks(marks, scrollDistance, timing);
										}, 500));

									}

									init();
								};

								/* UMD export */
								return $.scrollDepth;

							}));

							jQuery.scrollDepth();
						} else {
							setTimeout(monsterinsights_scroll_tracking_load, 200);
						}
					}
					monsterinsights_scroll_tracking_load();
				});
			}
		/* End MonsterInsights Scroll Tracking */
		
</script><script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/hoverIntent.min.js?ver=1.10.2' id='hoverIntent-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.min.js?ver=1.7.5' id='superfish-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.args.min.js?ver=2.7.1' id='superfish-args-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/skip-links.min.js?ver=2.7.1' id='skip-links-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/theme.js?ver=1.1.0' id='sucuriblog-theme-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky.js?ver=1.0.4' id='sucuriblog-sticky-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky-init.js?ver=1.0.1' id='sucuriblog-sticky-js-init-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/cookie-banner.js?ver=20200914' id='cookie-banner-js-js'></script>
</body></html>
