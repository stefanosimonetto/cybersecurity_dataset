<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
	<link rel="alternate" hreflang="es-419" href="https://news.sophos.com/es-419/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software" />
	<link rel="alternate" hreflang="nl-nl" href="https://news.sophos.com/nl-nl/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software" />
	<link rel="alternate" hreflang="pt-br" href="https://news.sophos.com/pt-br/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software" />
	<link rel="alternate" hreflang="de-de" href="https://news.sophos.com/de-de/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software" />
	<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software" />
	<link rel="alternate" hreflang="fr-fr" href="https://news.sophos.com/fr-fr/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software" />
	<link rel="alternate" hreflang="es-es" href="https://news.sophos.com/es-es/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software" />
	<link rel="alternate" hreflang="it-it" href="https://news.sophos.com/it-it/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software" />
	<link rel="alternate" hreflang="ja-jp" href="https://news.sophos.com/ja-jp/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software" />
	<link rel="alternate" hreflang="zh-tw" href="https://news.sophos.com/zh-tw/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software" />
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>Living off another land: Ransomware borrows vulnerable driver to remove security software &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//cdn.jsdelivr.net' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Living off another land: Ransomware borrows vulnerable driver to remove security software Comments Feed" href="https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/feed/" />
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.0.1"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode,e=(p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0),i.toDataURL());return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([129777,127995,8205,129778,127999],[129777,127995,8203,129778,127999])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??-eJyNj9EOwjAIRX/IDpeomQ/Gb+komSjtmsJi+vfOmSXbm48XOMCBd3acUKZACqgKgdWglxFfTrgvvlRQq0JN5NTMAwfYEk+FSIE9CUVKtgtZfKXihAaP9T987m3zDsIx2XJiclmmgZOCki/4ABKvxpgLrf9/RcpcNgouj2rqfkaLia5r7/HWXs5ddzq21+4DN6hjBg==' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='global-styles-inline-css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel='stylesheet' id='all-css-2' href='https://news.sophos.com/_static/??/wp-content/themes/sophosnews-2017/style-2021.css,/wp-content/mu-plugins/jetpack-11.1/css/jetpack.css?m=1658840194' type='text/css' media='all' />
<script type="text/javascript" src="https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZqYWFkTmQyAIAr9AiMg==" ></script><link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/63980" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 6.0.1" />
<link rel="canonical" href="https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/" />
<link rel='shortlink' href='https://news.sophos.com/?p=63980' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F02%2F06%2Fliving-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F02%2F06%2Fliving-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software%2F&#038;format=xml" />
<style>img#wpstats{display:none}</style>
	<link rel="amphtml" href="https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Living off another land: Ransomware borrows vulnerable driver to remove security software" />
<meta property="og:url" content="https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/" />
<meta property="og:description" content="Sophos has been investigating two different ransomware attacks where the adversaries deployed a legitimate, digitally signed hardware driver in order to delete security products from the targeted c…" />
<meta property="article:published_time" content="2020-02-06T15:22:24+00:00" />
<meta property="article:modified_time" content="2020-02-11T22:41:56+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2020/02/robbinhood-graphic.png?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2020/02/robbinhood-graphic.png?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="360" />
<meta property="og:image:alt" content="Robin Hood" />
<meta property="og:locale" content="en_US" />
<meta property="fb:admins" content="28552295016" />
<meta name="twitter:text:title" content="Living off another land: Ransomware borrows vulnerable driver to remove security software" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2020/02/robbinhood-graphic.png?w=640" />
<meta name="twitter:image:alt" content="Robin Hood" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-63980 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="sr-only" href="#content">Skip to content</a>

	
<header class="bg-blue-600" x-data="{ mobileMenu: false, searchField: false }">
	<div class="container">
		<div class="flex items-center justify-between h-16">

			<!-- Logo -->
			<div class="flex-shrink-0">
				<a class="site-logo" href="https://news.sophos.com/en-us/" rel="home">
				<svg width="172" height="17" xmlns="http://www.w3.org/2000/svg">
					<g fill="#FFF" fill-rule="evenodd">
						<path d="M113.024 5.298V16.74h-2.595V.259h2.265l7.997 11.49V.26h2.619v16.482h-2.289l-7.997-11.443M126.064.259h10.78v2.307H128.8v4.521h7.549v2.214h-7.55v5.133h8.376v2.307h-11.111V.259M138.478.259h2.855l2.694 12.29L147.29.26h2.783l3.61 12.314L156.005.26h2.783l-3.62 16.482h-2.76l-3.751-12.126-3.426 12.126h-2.784L138.478.259M168.933 4.968v-.283c0-1.318-.778-2.425-3.492-2.425-2.43 0-3.279 1.013-3.279 2.284 0 1.201.708 1.743 2.218 2.073l3.491.776c2.123.448 4.129 1.602 4.129 4.333 0 3.014-1.675 5.274-6.204 5.274-5.214 0-6.559-2.26-6.559-4.52v-.307h2.737v.26c0 1.2.755 2.284 3.774 2.284 2.5 0 3.421-1.084 3.421-2.638 0-1.224-.731-1.907-2.289-2.237l-3.49-.777c-2.407-.517-3.917-1.742-3.917-4.309 0-2.566 1.77-4.756 6.016-4.756 4.553 0 6.18 2.26 6.18 4.639v.33h-2.736M85.303 16.718h8.88c2.492 0 3.549-.15 4.379-.677 1.308-.803 2.139-2.378 2.139-4.162 0-1.457-.504-2.868-1.258-3.622-.981-1.006-2.316-1.382-4.783-1.382h-2.693c-1.208 0-2.097-.05-2.6-.276-.605-.277-.956-.81-.956-1.562 0-.88.427-1.455 1.132-1.632.529-.124 1.14-.124 2.726-.15h7.949V.265h-8.754c-1.963 0-2.843.075-3.598.353-1.737.602-2.921 2.383-2.921 4.518 0 1.458.58 2.745 1.587 3.624.881.753 2.189 1.105 4.202 1.105h3.584c.805 0 1.46.1 1.813.3.678.327 1.08.934 1.08 1.714 0 .652-.301 1.122-.83 1.447-.426.278-1.158.403-2.49.403h-8.588v2.99zm-84.945 0h8.88c2.492 0 3.549-.15 4.38-.677 1.307-.803 2.138-2.378 2.138-4.162 0-1.457-.504-2.868-1.258-3.622-.982-1.006-2.316-1.382-4.783-1.382H7.023c-1.209 0-2.098-.05-2.6-.276-.605-.277-.957-.81-.957-1.562 0-.88.427-1.455 1.132-1.632.53-.124 1.141-.124 2.726-.15h7.95V.265H6.52c-1.964 0-2.844.075-3.6.353C1.185 1.22 0 3 0 5.136 0 6.594.582 7.881 1.587 8.76c.881.753 2.19 1.105 4.203 1.105h3.582c.807 0 1.46.1 1.814.3.678.327 1.08.934 1.08 1.714 0 .652-.3 1.122-.83 1.447-.426.278-1.157.403-2.49.403H.358v2.99zM71.99 4.596c-.52.813-.765 2.118-.765 3.87 0 3.845 1.331 5.595 4.294 5.595 2.915 0 4.248-1.75 4.248-5.546 0-3.847-1.308-5.571-4.248-5.571-1.604 0-2.864.592-3.53 1.652zm10.05-1.897c1.013 1.33 1.58 3.498 1.58 6.039 0 2.882-.914 5.249-2.544 6.555-1.233.986-3.11 1.528-5.335 1.528-3.16 0-5.654-1.037-6.937-2.884-.964-1.355-1.435-3.155-1.435-5.35 0-3.152.866-5.544 2.495-6.826C71.149.726 73.175.158 75.497.158c2.938 0 5.284.913 6.543 2.54zM65.36.279h-3.507v6.73h-6.345V.278h-3.507v16.439h3.507V9.94h6.345v6.778h3.506V.278zM43.533 8.042c.938 0 1.48-.123 1.852-.469.442-.37.715-1.158.715-2.07 0-1.084-.443-1.872-1.208-2.144-.272-.1-.717-.149-1.286-.149h-4.839v4.832h4.766zm-4.766 8.674h-3.507V.278h8.223c2.889 0 3.902.295 4.988 1.504.964 1.036 1.481 2.39 1.481 3.845 0 1.725-.69 3.327-1.826 4.289-.962.813-1.854 1.058-3.728 1.058h-5.63v5.743zM21.665 4.596c-.519.813-.764 2.118-.764 3.87 0 3.845 1.333 5.595 4.297 5.595 2.913 0 4.247-1.75 4.247-5.546 0-3.847-1.308-5.571-4.247-5.571-1.606 0-2.866.592-3.533 1.652zm10.052-1.897c1.014 1.33 1.581 3.498 1.581 6.039 0 2.882-.914 5.249-2.545 6.555-1.233.986-3.11 1.528-5.333 1.528-3.162 0-5.656-1.037-6.94-2.884-.964-1.355-1.432-3.155-1.432-5.35 0-3.152.865-5.544 2.496-6.826C20.825.726 22.85.158 25.173.158c2.938 0 5.286.913 6.544 2.54z"/>
					</g>
				</svg>
				</a>
			</div>

			<!-- Search Field -->
			<div class="lg:flex justify-end flex-grow hidden" x-show="searchField" x-cloak>
				<div class="relative w-1/2 rounded-md shadow-sm">
					<form role="search" method="get" action="https://news.sophos.com/en-us/">
						<input
							type="text"
							class="block w-full text-lg text-white placeholder-gray-100 bg-blue-800 border-0 rounded-md font-sansMedium font-medium"
							placeholder="Type to Search News"
							x-ref="searchInput"
							name="s"
						/>
						<div class="absolute inset-y-0 right-0 flex items-center px-3">
							<button
								class="hover:opacity-100 opacity-60 p-1 text-xs text-white uppercase rounded-full cursor-pointer"
								type="submit"
							>
								Search							</button>
						</div>
					</form>
				</div>
			</div>

			<!-- Main Nav -->
			<div class="lg:flex items-center flex-grow hidden" x-show="!searchField" x-cloak>
				<div class="flex ml-auto">
				<ul id="menu-en-us-primary" class="primary-menu"><li id="menu-item-77773" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77773"><a href="https://news.sophos.com/en-us/category/products-services/">Products &amp; Services<div class="menu-item-description"></div></a></li>
<li id="menu-item-77772" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77772"><a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations<div class="menu-item-description"></div></a></li>
<li id="menu-item-77774" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-77774"><a href="https://news.sophos.com/en-us/category/threat-research/">Threat Research<div class="menu-item-description"></div></a></li>
<li id="menu-item-85326" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-85326"><a href="https://news.sophos.com/en-us/category/ai-research/">AI Research<div class="menu-item-description"></div></a></li>
<li id="menu-item-77776" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-77776"><a href="https://nakedsecurity.sophos.com">Security News<div class="menu-item-description"></div></a></li>
<li id="menu-item-83702" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-83702"><a href="https://news.sophos.com/en-us/category/sophos-life/">Sophos Life<div class="menu-item-description"></div></a></li>
</ul>				</div>
			</div>

			<!-- Search button -->
			<div class="lg:block hidden ml-4">
				<div class="flex items-center">
					<button
					class="border-2 border-transparent hover:border-white inline-flex items-center justify-center p-2 text-white rounded-md focus:outline-none transition-colors"
					@click.prevent="searchField = !searchField; $nextTick(() => { setTimeout(() => { $refs.searchInput.focus(); }, 150);});"
					>
						<span class="sr-only">Search</span>
						<!-- Heroicon name: outline/bell -->
						<svg
							class="w-5 h-5"
							xmlns="http://www.w3.org/2000/svg"
							fill="none"
							viewBox="0 0 24 24"
							stroke="currentColor"
							:class="{ 'block': !searchField, 'hidden': searchField }"
						>
							<path
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="3"
							d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
							/>
						</svg>
						<svg
							class="hidden w-5 h-5"
							xmlns="http://www.w3.org/2000/svg"
							fill="none"
							viewBox="0 0 24 24"
							stroke="currentColor"
							aria-hidden="true"
							:class="{ 'block': searchField, 'hidden': !searchField }"
						>
							<path
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="3"
							d="M6 18L18 6M6 6l12 12"
							/>
						</svg>
					</button>
				</div>
			</div>

			<!-- Mobile menu button -->
			<div class="lg:hidden flex -mr-2">
				<button
					type="button"
					class="hover:text-white hover:bg-blue-800 focus:outline-none hover:ring-2 focus:ring-offset-2 focus:ring-offset-gray-300 focus:ring-white inline-flex items-center justify-center p-2 text-white rounded-md"
					aria-controls="mobile-menu"
					aria-expanded="false"
					@click="mobileMenu = !mobileMenu"
				>
					<span class="sr-only">Open main menu</span>
					<!--
						Heroicon name: outline/menu

						Menu open: "hidden", Menu closed: "block"
					-->
					<svg
					class="block w-6 h-6"
					xmlns="http://www.w3.org/2000/svg"
					fill="none"
					viewBox="0 0 24 24"
					stroke="currentColor"
					:class="{ 'block': !mobileMenu, 'hidden': mobileMenu }"
					>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="3"
						d="M4 6h16M4 12h16m-7 6h7"
					/>
					</svg>
					<!--
						Heroicon name: outline/x

						Menu open: "block", Menu closed: "hidden"
					-->
					<svg
					class="hidden w-6 h-6"
					xmlns="http://www.w3.org/2000/svg"
					fill="none"
					viewBox="0 0 24 24"
					stroke="currentColor"
					aria-hidden="true"
					:class="{ 'block': mobileMenu, 'hidden': !mobileMenu }"
					>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="3"
						d="M6 18L18 6M6 6l12 12"
					/>
					</svg>
				</button>
			</div>
		</div>
	</div>

	<!-- Mobile menu, show/hide based on menu state. -->
	<div
	class="lg:hidden container"
	x-show="mobileMenu"
	x-cloak
	x-transition:enter="transition-all ease-out duration-100"
	x-transition:enter-start="transform opacity-0 scale-95"
	x-transition:enter-end="transform opacity-100 scale-100"
	x-transition:leave="transition ease-in duration-75"
	x-transition:leave-start="transform opacity-100 scale-100"
	x-transition:leave-end="transform opacity-0 scale-95"
	>
		<div class="pt-2 pb-8 space-y-2">
			<div class="relative rounded-md shadow-sm">
				<form role="search" method="get" action="https://news.sophos.com/en-us/">
					<input
						type="text"
						class="focus:ring-blue-600 focus:border-blue-600 sm:text-sm block w-full placeholder-gray-600 border-gray-300 rounded-md"
						placeholder="Search News"
						name="s"
					/>
					<div
						class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none"
					>
						<button class="p-1 text-gray-500 rounded-full" type="submit">
							<span class="sr-only">Search</span>
							<!-- Heroicon name: outline/bell -->
							<svg
								class="w-4 h-4"
								xmlns="http://www.w3.org/2000/svg"
								fill="none"
								viewBox="0 0 24 24"
								stroke="currentColor"
							>
								<path
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="3"
									d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
								/>
							</svg>
						</button>
					</div>
				</form>
			</div>

			<ul id="menu-en-us-primary-1" class="mobile-menu"><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77773"><a href="https://news.sophos.com/en-us/category/products-services/">Products &amp; Services<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77772"><a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-77774"><a href="https://news.sophos.com/en-us/category/threat-research/">Threat Research<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-85326"><a href="https://news.sophos.com/en-us/category/ai-research/">AI Research<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-77776"><a href="https://nakedsecurity.sophos.com">Security News<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-83702"><a href="https://news.sophos.com/en-us/category/sophos-life/">Sophos Life<div class="menu-item-description"></div></a></li>
</ul>		</div>
	</div>
</header>

	<div id="content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-63980" class="post-63980 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut category-threat-research tag-gdrv-sys tag-gigabyte tag-mikhail tag-robbinhood tag-robnhold region-en-us">

		<div class="md:mt-16 container mt-8">
		<div class="relative max-w-5xl mx-auto">
				<div
						class="aspect-w-16 aspect-h-9 flex bg-gray-400 bg-right bg-no-repeat bg-cover"
				>
					<img width="770" height="433" src="https://news.sophos.com/wp-content/uploads/2020/02/robbinhood-graphic.png?w=770" class="object-cover wp-post-image" alt="Robin Hood" srcset="https://news.sophos.com/wp-content/uploads/2020/02/robbinhood-graphic.png 770w, https://news.sophos.com/wp-content/uploads/2020/02/robbinhood-graphic.png?resize=300,169 300w, https://news.sophos.com/wp-content/uploads/2020/02/robbinhood-graphic.png?resize=768,432 768w" sizes="(max-width: 770px) 100vw, 770px" />				</div>
								<div
						class="left-4 w-24 h-24 lg:left-12 xl:left-16 lg:w-40 lg:h-40 place-items-center absolute top-0 grid  "
				>
										<img
							src="https://news.sophos.com/wp-content/uploads/2022/07/Category-Icon-X-Ops-v2.png"
							alt="Threat Research"
					/>
														</div>
						</div>
	</div>


			
	<header>
		<div class="container mt-8 md:mt-16 md:-mb-4">
			<div class="max-w-4xl mx-auto">

				<h1 class="text-style-h1 mb-8">Living off another land: Ransomware borrows vulnerable driver to remove security software</h1>
				
				<div class="text-xl md:text-xl -mt-2">
					<span class="byline">
		Written by 				<span class="author vcard">
				<a href="https://news.sophos.com/en-us/author/andrew-brandt/" title="Posts by Andrew Brandt" class="author url fn" rel="author">Andrew Brandt</a>,				</span>
										<span class="author vcard">
				<a href="https://news.sophos.com/en-us/author/mark-loman/" title="Posts by Mark Loman" class="author url fn" rel="author">Mark Loman</a>				</span>
								</span>
						</div>

				<div class="text-sophos-gray-600 mt-4 text-xs font-sansSemiBold font-semibold leading-tight uppercase">
					<span class="posted-on"><a href="https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/" rel="bookmark">February 06, 2020</a></span>				</div>

				<div class="mt-6 space-y-2 space-x-1">
					<a href="https://news.sophos.com/en-us/category/threat-research/sophoslabs-uncut/" class="category-tag-pill">SophosLabs Uncut</a> <a href="https://news.sophos.com/en-us/category/threat-research/" class="category-tag-pill">Threat Research</a> <a href="https://news.sophos.com/en-us/tag/gdrv-sys/" class="category-tag-pill">gdrv.sys</a> <a href="https://news.sophos.com/en-us/tag/gigabyte/" class="category-tag-pill">Gigabyte</a> <a href="https://news.sophos.com/en-us/tag/mikhail/" class="category-tag-pill">Mikhail</a> <a href="https://news.sophos.com/en-us/tag/robbinhood/" class="category-tag-pill">RobbinHood</a> <a href="https://news.sophos.com/en-us/tag/robnhold/" class="category-tag-pill">Robnhold</a>				</div>
			</div>
		</div>
	</header><!-- .entry-header -->

	<div class="container md:my-16 xl:my-24 my-8">
	<div class="entry-content lg:prose-lg mx-auto prose max-w-4xl">
		<p>Sophos has been investigating two different ransomware attacks where the adversaries deployed a legitimate, digitally signed hardware driver in order to delete security products from the targeted computers just prior to performing the destructive file encryption portion of the attack.</p>
<p>The signed driver, part of a now-deprecated software package published by Taiwan-based motherboard manufacturer Gigabyte, has a known vulnerability, tracked as <a href="https://nvd.nist.gov/vuln/detail/CVE-2018-19320" target="_blank" rel="noopener noreferrer">CVE-2018-19320</a>. The vulnerability, <a href="https://www.secureauth.com/labs/advisories/gigabyte-drivers-elevation-privilege-vulnerabilities" target="_blank" rel="noopener noreferrer">published along with proof-of-concept code in 2018</a> and <a href="https://www.bleepingcomputer.com/news/security/asus-gigabyte-drivers-contain-code-execution-vulnerabilities-pocs-galore/" target="_blank" rel="noopener noreferrer">widely reported at the time</a>, was disclaimed by the company, who told the researcher who tried to report the bug that &#8220;its products are not affected by the reported vulnerabilities.&#8221; The company later recanted, and has discontinued using the vulnerable driver, but it still exists, and it apparently remains a threat.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-64136" src="https://news.sophos.com/wp-content/uploads/2020/02/certificate_screenshot.png" alt="" width="405" height="515" srcset="https://news.sophos.com/wp-content/uploads/2020/02/certificate_screenshot.png 405w, https://news.sophos.com/wp-content/uploads/2020/02/certificate_screenshot.png?resize=236,300 236w" sizes="(max-width: 405px) 100vw, 405px" /></p>
<p>The sha1RSA Authenticode signature for the driver, with serial number <strong>248472542c24ab8e429229acf121ca26</strong> and thumbprint <strong>32daee48ae406222c2bb92c4f1b7f516e537175a</strong>, expired on October 17, 2013.</p>
<p>In this attack scenario, the criminals have used the Gigabyte driver as a wedge so they could load a second, unsigned driver into Windows. This second driver then goes to great lengths to kill processes and files belonging to endpoint security products, bypassing tamper protection, to enable the ransomware to attack without interference.</p>
<p><img loading="lazy" class="alignnone wp-image-63986 size-full" src="https://news.sophos.com/wp-content/uploads/2020/02/robbinhood-ransom-note.png" alt="" width="640" height="558" srcset="https://news.sophos.com/wp-content/uploads/2020/02/robbinhood-ransom-note.png 1077w, https://news.sophos.com/wp-content/uploads/2020/02/robbinhood-ransom-note.png?resize=300,262 300w, https://news.sophos.com/wp-content/uploads/2020/02/robbinhood-ransom-note.png?resize=768,670 768w, https://news.sophos.com/wp-content/uploads/2020/02/robbinhood-ransom-note.png?resize=1024,893 1024w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>This is the first time we have observed ransomware shipping a trusted, signed (yet vulnerable) third party driver to patch the Windows kernel in-memory, load their own unsigned malicious driver, and take out security applications from kernel space. The ransomware that was being installed in both instances calls itself <strong>RobbinHood</strong>.</p>
<p>Ransomware trying to circumvent security products is not new. For example, Nemty <a href="https://www.bleepingcomputer.com/news/security/nemty-ransomware-update-lets-it-kill-processes-and-services/" target="_blank" rel="noopener noreferrer">kills processes and services</a> using regular taskkill, and Snatch ransomware figured out how to <a href="https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/" target="_blank" rel="noopener noreferrer">reboot PCs into Safe Mode</a> to get around endpoint protection. Obviously, doing the process killing from kernel mode has a lot of advantages.</p>
<p>This article takes a deep dive on how the attackers do it. We&#8217;re publishing this information now so other defenders can anticipate and enact defenses against this novel attack, where adversaries bring a vulnerable third party driver to subvert the Windows kernel, terminate defenses, and encrypt files unhindered by endpoint protection software.</p>
<h2>Attacking Windows defenses</h2>
<p>We&#8217;ve recently seen the RobbinHood ransomware family perform this strategy to encrypt files without being hindered by endpoint protection software. They successfully subvert a setting in kernel memory on Windows 7, Windows 8 and Windows 10.</p>
<p>Without diving into the ransomware or data encryption itself, we’re going to focus on the module with which the adversaries can kill encountered endpoint protection software. This part of the attack consists of several files embedded in <strong>STEEL.EXE</strong>. All of these files are extracted to C:\WINDOWS\TEMP</p>
<table>
<tbody>
<tr>
<td width="85">STEEL.EXE</td>
<td width="170">Kill application</td>
<td width="349">This is the application that kills the processes and files of security products, using kernel drivers.</td>
</tr>
<tr>
<td width="85">ROBNR.EXE</td>
<td width="170">Driver installer</td>
<td width="349">Deploys both the benign, signed third-party driver, and the criminals&#8217; unsigned kernel driver. Once deployed, the unsigned driver gets loaded by abusing a known vulnerability in the third-party driver.</td>
</tr>
<tr>
<td width="85">GDRV.SYS</td>
<td width="170">Vulnerable kernel driver</td>
<td width="349">A benign but outdated Authenticode-signed driver that contains a vulnerability.</td>
</tr>
<tr>
<td width="85">RBNL.SYS</td>
<td width="170">Malicious kernel driver</td>
<td width="349">The malicious driver that can kill processes and delete files from kernel space.</td>
</tr>
<tr>
<td width="85">PLIST.TXT</td>
<td width="170">List of processes (and their associated files) to destroy</td>
<td width="349">This is a text file containing the names of the applications the malicious driver will kill and delete. This text file is not embedded in STEEL.EXE and may be tailored to the victim&#8217;s environment.</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h3>STEEL.EXE</h3>
<p>The STEEL.EXE application kills the processes and deletes the files of security applications. In order to do this, STEEL.EXE deploys a driver. The driver runs in kernel mode and is therefore optimally positioned to take out processes and files without being hindered by security controls like endpoint protection. Even though they run under NT AUTHORITY/SYSTEM, most parts of an endpoint security product run in user space.</p>
<p>The STEEL.EXE application first deploys ROBNR.EXE, which installs the malicious unsigned driver RBNL.SYS.</p>
<p>Once this driver is installed, STEEL.EXE reads the PLIST.TXT file and instructs the driver to delete any application listed in PLIST.TXT, then killing their associated processes. If the process was running as a service, the service can no longer automatically restart as the associated file has been deleted.</p>
<p>Once the STEEL.EXE process exits, the ransomware program can perform its encryption attack without being hindered by the security applications that have been taken out decisively.</p>
<h3>ROBNR.EXE</h3>
<p>This application is dropped to the disk by STEEL.EXE. This is a convenient application that drops and installs both the vulnerable GDRV.SYS driver, and the malicious RBNL.SYS driver.</p>
<p>64-bit Windows computers have a mechanism called <em>driver signature enforcement</em> which means that Windows only allows drivers to be loaded that have been properly signed by both the manufacturer and Microsoft. This is a requirement for all drivers in order to be loaded on 64-bit versions of Windows.</p>
<p>The malware authors did not bother to sign their malicious driver as it involves purchasing a certificate. Also, a purchased certificate can be revoked by the certificate authority causing the driver to no longer work, as it will no longer be accepted by Windows.</p>
<p>Instead, the malware authors chose a different route. The properly signed third party GDRV.SYS driver contains a privilege escalation vulnerability as it allows reading and writing of arbitrary memory. The malware authors abuse this vulnerability in order to (temporarily) disable driver signature enforcement in Windows – on-the-fly, in kernel memory. Once driver signature enforcement is disabled, the attackers are able to load their unsigned malicious driver.</p>
<h3>Disabling Driver Signature Enforcement</h3>
<p>The attackers are able to disable driver signature enforcement by changing a single variable (a single byte) that lives in kernel space. On Windows 7 (or older), this variable is called <strong>nt!g_CiEnabled</strong> (NTOSKRNL.EXE). On Windows 8 and 10, this variable is called <strong>ci!g_CiOptions</strong> (CI.DLL). In order to resolve the location of this variable, the attackers use <a href="https://github.com/hfiref0x/DSEFix/blob/master/README.md" target="_blank" rel="noopener noreferrer">a strategy taken from DSEFix</a>.</p>
<p>On Windows 8 or 10, the trick starts by loading the standard Windows component CI.DLL as a data library using <strong>DONT_RESOLVE_DLL_REFERENCES</strong> in their process. Once CI.DLL is loaded, they query the location of CI.DLL in kernel memory via the GetModuleBaseByName function. It uses <strong>NtQuerySystemInformation</strong>(<em>SystemModuleInformation</em> …) to get the kernel addresses of all loaded kernel modules.</p>
<figure id="attachment_63984" aria-describedby="caption-attachment-63984" style="width: 640px" class="wp-caption alignleft"><img loading="lazy" class="wp-image-63984 size-full" src="https://news.sophos.com/wp-content/uploads/2020/02/ci_0.png" alt="" width="640" height="1139" srcset="https://news.sophos.com/wp-content/uploads/2020/02/ci_0.png 670w, https://news.sophos.com/wp-content/uploads/2020/02/ci_0.png?resize=169,300 169w, https://news.sophos.com/wp-content/uploads/2020/02/ci_0.png?resize=576,1024 576w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-63984" class="wp-caption-text">Decompiled: Showing how the variable is found that controls Driver Signing Enforcement.</figcaption></figure>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<figure id="attachment_63988" aria-describedby="caption-attachment-63988" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="wp-image-63988 size-full" src="https://news.sophos.com/wp-content/uploads/2020/02/ci_0b.png" alt="" width="640" height="420" srcset="https://news.sophos.com/wp-content/uploads/2020/02/ci_0b.png 764w, https://news.sophos.com/wp-content/uploads/2020/02/ci_0b.png?resize=300,197 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-63988" class="wp-caption-text">Decompiled: Showing how to get a module&#8217;s kernel address.</figcaption></figure>
<p>Once they know those kernel addresses, the attackers resolve the exported <strong>CiInitialize</strong> function from the module&#8217;s <em>export address table</em>.Then they disassemble the instructions of that function in order to find the <strong>call CipInitialize()</strong> instruction. Once that function is found, they look for the <strong>mov dword ptr [address],ecx</strong> instruction. That address is <strong>g_CiOptions</strong> as shown in the figure below.</p>
<figure id="attachment_63990" aria-describedby="caption-attachment-63990" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="wp-image-63990 size-full" src="https://news.sophos.com/wp-content/uploads/2020/02/ci_3.png" alt="" width="640" height="908" srcset="https://news.sophos.com/wp-content/uploads/2020/02/ci_3.png 840w, https://news.sophos.com/wp-content/uploads/2020/02/ci_3.png?resize=211,300 211w, https://news.sophos.com/wp-content/uploads/2020/02/ci_3.png?resize=768,1090 768w, https://news.sophos.com/wp-content/uploads/2020/02/ci_3.png?resize=722,1024 722w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-63990" class="wp-caption-text">Decompiled: Showing how to find the location of g_CiOptions using the HDE disassembler.</figcaption></figure>
<p>Now that they know the location of the <strong>g_CiOptions</strong> variable in kernel space, the vulnerable third party driver is dropped to disk and started. <a href="https://www.secureauth.com/labs/advisories/gigabyte-drivers-elevation-privilege-vulnerabilities" target="_blank" rel="noopener noreferrer">See this article on the exact vulnerability</a>. Any vulnerable driver that allows arbitrary read/write in kernel will do. So even though the attackers are using the GDRV.SYS driver to do this today, there&#8217;s no reason they will continue to use it if it becomes untenable to do so.</p>
<p>There are many other vulnerable drivers (with a similar vulnerability) in addition to the Gigabyte driver that these or other attackers may choose to abuse later, such as ones from VirtualBox (CVE-2008-3431), Novell (CVE-2013-3956), CPU-Z (CVE-2017-15302), or ASUS (CVE-2018-18537). But in these attacks, we&#8217;ve only seen the Gigabyte driver being abused in this way.</p>
<figure id="attachment_63992" aria-describedby="caption-attachment-63992" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="wp-image-63992 size-full" src="https://news.sophos.com/wp-content/uploads/2020/02/rbnl_5.png" alt="" width="640" height="203" srcset="https://news.sophos.com/wp-content/uploads/2020/02/rbnl_5.png 662w, https://news.sophos.com/wp-content/uploads/2020/02/rbnl_5.png?resize=300,95 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-63992" class="wp-caption-text">Decompiled: Showing how the malicious driver is deployed.</figcaption></figure>
<h2>The malicious driver</h2>
<p>Once the malicious driver is successfully deployed and started, the ROBNR.EXE process exits. Then STEEL.EXE starts processing the PLIST.TXT file, listing all the applications to kill.</p>
<p>This malicious kernel driver is used to terminate processes and delete the associated files. It employs several tricks to kill these applications, even when they are in-use and protected by tamper protection mechanisms employed by security products.</p>
<figure id="attachment_63994" aria-describedby="caption-attachment-63994" style="width: 612px" class="wp-caption alignnone"><img loading="lazy" class="wp-image-63994 size-full" src="https://news.sophos.com/wp-content/uploads/2020/02/rbnl_0.png" alt="" width="612" height="558" srcset="https://news.sophos.com/wp-content/uploads/2020/02/rbnl_0.png 612w, https://news.sophos.com/wp-content/uploads/2020/02/rbnl_0.png?resize=300,274 300w" sizes="(max-width: 612px) 100vw, 612px" /><figcaption id="caption-attachment-63994" class="wp-caption-text">Decompiled: How the malicious driver starts.</figcaption></figure>
<figure id="attachment_63996" aria-describedby="caption-attachment-63996" style="width: 561px" class="wp-caption alignnone"><img loading="lazy" class="wp-image-63996 size-full" src="https://news.sophos.com/wp-content/uploads/2020/02/rbnl_1.png" alt="" width="561" height="423" srcset="https://news.sophos.com/wp-content/uploads/2020/02/rbnl_1.png 561w, https://news.sophos.com/wp-content/uploads/2020/02/rbnl_1.png?resize=300,226 300w" sizes="(max-width: 561px) 100vw, 561px" /><figcaption id="caption-attachment-63996" class="wp-caption-text">Decompiled: How the malicious driver processes commands (IOCTL) from STEEL.EXE.</figcaption></figure>
<p>The following string was found in the malicious driver, indicating it was likely built by the same authors behind the RobbinHood ransomware.</p>
<pre>C:\Users\Mikhail\Desktop\Robnhold\x64\Win7Release\Robbnhold.pdb</pre>
<h2>Deleting Files</h2>
<p>The malicious driver has various ways to delete files. But it does not pick one way, it runs them all sequentially, in order to ensure the file really gets deleted.</p>
<p>To delete files that are in-use the malicious driver issues an I/O Request Packet (or IRP, a <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/gettingstarted/i-o-request-packets" target="_blank" rel="noopener noreferrer">low-level message passed between device drivers</a>) directly on the NTFS.SYS storage device. By clearing the ImageSectionObject and DataSectionObject pointers, the storage device assumes the files are not in-use and the file is safely deleted, even when the file is still running as a process!</p>
<p>This trick is similar to the technique <a href="http://0tutorials.blogspot.com/2011/10/learn-to-force-delete-running-file.html" target="_blank" rel="noopener noreferrer">mentioned on this blog post</a>.</p>
<figure id="attachment_63998" aria-describedby="caption-attachment-63998" style="width: 415px" class="wp-caption alignnone"><img loading="lazy" class="wp-image-63998 size-full" src="https://news.sophos.com/wp-content/uploads/2020/02/rbnl_2.png" alt="" width="415" height="229" srcset="https://news.sophos.com/wp-content/uploads/2020/02/rbnl_2.png 415w, https://news.sophos.com/wp-content/uploads/2020/02/rbnl_2.png?resize=300,166 300w" sizes="(max-width: 415px) 100vw, 415px" /><figcaption id="caption-attachment-63998" class="wp-caption-text">Decompiled: The malicious driver uses multiple ways to delete a file.</figcaption></figure>
<figure id="attachment_64000" aria-describedby="caption-attachment-64000" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="wp-image-64000 size-full" src="https://news.sophos.com/wp-content/uploads/2020/02/rbnl_3.png" alt="" width="640" height="693" srcset="https://news.sophos.com/wp-content/uploads/2020/02/rbnl_3.png 751w, https://news.sophos.com/wp-content/uploads/2020/02/rbnl_3.png?resize=277,300 277w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-64000" class="wp-caption-text">Decompiled: How the malicious driver deletes a file that is in-use.</figcaption></figure>
<h2>Terminating Processes</h2>
<p>Once the files are deleted, STEEL.EXE kills all the processes associated with the files. Again, it uses its malicious kernel driver to terminate the processes.</p>
<figure id="attachment_64001" aria-describedby="caption-attachment-64001" style="width: 627px" class="wp-caption alignnone"><img loading="lazy" class="wp-image-64001 size-full" src="https://news.sophos.com/wp-content/uploads/2020/02/terminating.png" alt="" width="627" height="272" srcset="https://news.sophos.com/wp-content/uploads/2020/02/terminating.png 627w, https://news.sophos.com/wp-content/uploads/2020/02/terminating.png?resize=300,130 300w" sizes="(max-width: 627px) 100vw, 627px" /><figcaption id="caption-attachment-64001" class="wp-caption-text">Decompile: How the malicious driver terminates a process.</figcaption></figure>
<p>Endpoint protection processes that rely on <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/ns-wdm-_ob_operation_registration" target="_blank" rel="noopener noreferrer">object handle filtering</a> for their tamper protection cannot prevent a kernel mode termination of processes or deletion of files. The process handles opened by the malicious driver are kernel handles, and kernel handles cannot be filtered. So, the malicious kernel driver can kill these processes without interference of endpoint security controls. One solution is for the endpoint protection process to watch for any process trying to install these vulnerable kernel mode drivers, and prevent the installation from taking place.</p>
<p>If the process was running as a service, the Service Control Manager of Windows will (usually) try to restart the process that just got killed. But it will fail to do so as the related file no longer exists. Consequently, the application is effectively and permanently disabled. The failed attempts to restart the service show up in Event Logs.</p>
<p>When STEEL.EXE has killed all the processes and files in the PLIST.TXT list, it exits. Now the ransomware can encrypt all the files on the system unhindered.</p>
<h2>What users can do to prevent this type of attack</h2>
<p>Computers that are fully patched and have no known vulnerabilities can still end up in ruin because this attacker brings his own vulnerability. So what can you do to prevent the initial access by the attacker?</p>
<p>Adopt a three-pronged approach to minimize your risk of falling victim to an attack.</p>
<h3>1. Threat protection that disrupts the whole attack chain</h3>
<p>Today&#8217;s ransomware attacks use multiple techniques and tactics, so focusing your defense on a single technology leaves you very vulnerable.<br />
Instead, deploy a range of technologies to disrupt as many stages in the attack as possible. And integrate the public cloud into your security strategy.</p>
<h3>2. Strong security practices</h3>
<p>These include:</p>
<ul>
<li>Use multi-factor authentication (MFA)</li>
<li>Use complex passwords, managed through a password manager</li>
<li>Limit access rights; give user accounts and admins only the access rights they need</li>
<li>Make regular backups, and keep them offsite and offline where attackers can’t find them</li>
<li>Lock down your RDP; turn it off if you don’t need it, use rate limiting, 2FA or a VPN if you do</li>
<li>Ensure tamper protection is enabled – other ransomware strains attempt to disable your endpoint protection, and tamper protection is designed to prevent this from happening</li>
</ul>
<h3>3. Ongoing staff education</h3>
<p>People are invariably the weakest link in cybersecurity, and cybercriminals are experts at exploiting normal human behaviors for nefarious gain. Invest – and keep investing – in staff training.</p>
<h2>IoCs</h2>
<p>We analyzed the following files in the course of this investigation</p>
<table>
<tbody>
<tr>
<td width="498"><strong>SHA256</strong></td>
<td width="106"><strong>Filename</strong></td>
</tr>
<tr>
<td width="498">791c32a95f401f7464214960e49e716656f6fd6fff135ac2a6ba607236d3346e</td>
<td width="106">STEEL.EXE</td>
</tr>
<tr>
<td width="498">99c3cc348f8ee4e87bce45b1dd185d31830c370ac43fd3e39ac50340f029ef79</td>
<td width="106">ROBNR.EXE</td>
</tr>
<tr>
<td width="498">0b15b5cc64caf0c6ad9bd759eb35383b1f718edf3d7ab4cd912d0d8c1826edf8</td>
<td width="106">RBNL.SYS</td>
</tr>
<tr>
<td width="498">31f4cfb4c71da44120752721103a16512444c13c2ac2d857a7e6f13cb679b427</td>
<td width="106">GDRV.SYS</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h3>Acknowledgments</h3>
<p>SophosLabs would like to acknowledge the contributions of Anand Ajjan, Richard Cohen, Sivagnanam Gn, Roland Gyorffi, Erik Loman, Peter Mackenzie, Vikas Singh, Gabor Szappanos, Alex Vermaning and Michael Wood to the analysis for this post.</p>
			</div>
	<div class="mt-12">
		
<ul
	id="social-sharing"
	class="flex justify-center items-center space-x-6"
>
	<li class="facebook">
		<a
			class="js-share-modal"
			href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=63980&#038;title=Living%20off%20another%20land:%20Ransomware%20borrows%20vulnerable%20driver%20to%20remove%20security%20software"
			data-title="Living off another land: Ransomware borrows vulnerable driver to remove security software"
			title="Share on Facebook">
				<span class="sr-only">Share on Facebook</span>
				<svg
					width="8"
					height="16"
					xmlns="http://www.w3.org/2000/svg"
					class="text-sophos-gray-600 hover:text-black"
					fill="currentColor"
				>
					<path d="M7.145 8.006H4.903V16H1.581V8.006H0V5.182h1.581V3.354C1.581 2.045 2.202 0 4.933 0l2.461.01v2.742H5.608c-.291 0-.705.145-.705.77v1.66h2.533l-.291 2.824z" fill-rule="nonzero"/>
				</svg>
		</a>
	</li>
	<li class="twitter">
		<a
			class="js-share-modal"
			href="http://twitter.com/intent/tweet?text=Living%20off%20another%20land%3A%20Ransomware%20borrows%20vulnerable%20driver%20to%20remove%20security%20software%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D63980"
			data-title=""
			title="Share on Twitter">
				<span class="sr-only">Share on Twitter</span>
				<svg
					width="14"
					height="13"
					xmlns="http://www.w3.org/2000/svg"
					class="text-sophos-gray-600 hover:text-black"
					fill="currentColor"
				>
					<path d="M12.567 3.238c.007.141.01.281.01.424 0 4.338-2.89 9.34-8.173 9.34-1.623 0-3.132-.543-4.403-1.475.225.03.453.045.685.045 1.346 0 2.584-.523 3.566-1.404-1.255-.028-2.317-.977-2.682-2.28a2.56 2.56 0 001.296-.056C1.554 7.53.562 6.203.562 4.613v-.04c.389.245.83.392 1.302.41C1.094 4.393.587 3.387.587 2.25c0-.602.142-1.166.388-1.65 1.416 1.986 3.534 3.292 5.92 3.43a3.735 3.735 0 01-.074-.749c0-1.813 1.286-3.28 2.873-3.28.825 0 1.572.397 2.096 1.034a5.324 5.324 0 001.824-.797c-.215.768-.67 1.41-1.263 1.816a5.178 5.178 0 001.65-.515 6.362 6.362 0 01-1.434 1.7" fill-rule="nonzero"/>
				</svg>
		</a>
	</li>
	<li class="linkedin">
		<a
			href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/"
			data-title="Living off another land: Ransomware borrows vulnerable driver to remove security software"
			title="Share on LinkedIn"
			onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;">
			<span class="sr-only">Share on LinkedIn</span>
			<svg
				width="16"
				height="16"
				xmlns="http://www.w3.org/2000/svg"
				class="text-sophos-gray-600 hover:text-black"
				fill="currentColor"
			>
				<path d="M16 15.293h-3.43v-5.52c0-1.386-.496-2.334-1.738-2.334-.946 0-1.512.64-1.76 1.256-.09.22-.113.526-.113.836v5.762H5.53s.044-9.35 0-10.316h3.43v1.46c.456-.705 1.27-1.703 3.091-1.703 2.256 0 3.95 1.473 3.95 4.643v5.916zM1.917 3.566h-.022C.745 3.566 0 2.773 0 1.783 0 .772.768 0 1.94 0c1.173 0 1.896.772 1.917 1.783 0 .99-.744 1.783-1.94 1.783zM.202 15.293h3.431V4.977H.203v10.316z" fill-rule="nonzero"/>
			</svg>
		</a>
	</li>
	<li class="comments">
		<a
			href="#comments"
			title="Leave a Reply"
			class="flex items-center space-x-1"
		>
			<svg
				width="16"
				height="16"
				xmlns="http://www.w3.org/2000/svg"
				class="text-sophos-gray-600 hover:text-black"
				fill="currentColor"
			>
				<path d="M8.5 0a7.5 7.5 0 11-3.916 13.898C3.317 15.273 1.773 15.36.256 15.135c1.011-1.185 1.678-2.357 2-3.517l-.007.027A7.5 7.5 0 018.5 0z" fill-rule="evenodd"/>
			</svg>
							<span class="font-medium font-sansMedium text-xs">17</span>
					</a>
	</li>
</ul>

			</div><!-- .entry-social -->
	</div>

</article><!-- #post-## -->

			<div class="container my-8 md:my-16">
				<div class="max-w-4xl mx-auto">
					<div class="article-author-block article-co-authors-block">
	
					<div class="author-block">
				<div class="author-block__profile">
					<img alt='' src='https://secure.gravatar.com/avatar/216532880604c8cf0600f4bc964cf01d?s=400&#038;d=blank&#038;r=g' class='avatar avatar-400 photo' height='400' width='400' />				</div> <!-- .author-profile -->

				<div class="author-block__wrapper">
					<div class="author-block__content">

													<div class="author-block__about">
								About the Author							</div>
						
						<h3 class="author-block__name">
						<a href="https://news.sophos.com/en-us/author/andrew-brandt/" title="Posts by Andrew Brandt" class="author url fn" rel="author">Andrew Brandt</a>						</h3>

						
							<div class="author-block__bio">
								<p>SophosLabs Principal Researcher Andrew Brandt blends a 20-year journalism background with deep, retrospective analysis of malware infections, ransomware, and cyberattacks as the editor of SophosLabs Uncut. His work with the Labs team helps Sophos protect its global customers, and alerts the world about notable criminal behavior and activity, whether it's normal or novel. Follow him at @threatresearch on Twitter for up-to-the-minute news about all things malicious.</p>
							</div> <!-- .author-bio -->

					</div>
				</div>

			</div> <!-- .author-block-container -->
					<div class="author-block">
				<div class="author-block__profile">
					<img width="400" height="400" src="https://news.sophos.com/wp-content/uploads/2020/02/mark-loman.png?w=400" class="avatar avatar-400 photo wp-post-image" alt="" />				</div> <!-- .author-profile -->

				<div class="author-block__wrapper">
					<div class="author-block__content">

													<div class="author-block__about">
								About the Author							</div>
						
						<h3 class="author-block__name">
						<a href="https://news.sophos.com/en-us/author/mark-loman/" title="Posts by Mark Loman" class="author url fn" rel="author">Mark Loman</a>						</h3>

						
							<div class="author-block__bio">
								<p>Mark Loman is a Director, Engineering, for Next-Gen Technologies at Sophos. As an ethical hacker with a passion for information security, Loman oversees a team of experienced developers responsible for delivering practical signature-less solutions. With more than 10 years of experience, Loman has a keen eye for innovating effective solutions and technology that stop zero-day cyberthreats. With in-depth knowledge of the intricate workings of modern computers and applications, Loman’s team isn’t shy when applying unconventional methods to test and create prevention techniques to battle even persistent attackers.</p>
							</div> <!-- .author-bio -->

					</div>
				</div>

			</div> <!-- .author-block-container -->
		
		</div>
				</div>
			</div>

			
<div class="pb-24 bg-white">
<div class="container">
<div class="max-w-5xl mx-auto">

			
			<h3 class="text-style-h2 md:my-8 my-4">
				Read Similar Articles			</h3>

			<div class="article-grid article-grid--3-column">
				<!-- Article -->
<article
	id="post-62404"
	class="hover:shadow-lg dark:bg-sophos-gray-900 border-sophos-gray-200 flex flex-col overflow-hidden text-gray-700 transition-all bg-white border rounded-md shadow-md post-62404 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut category-threat-research tag-ransomware tag-snatch region-en-us">
	<!-- Image -->
	<a
		class="aspect-w-16 aspect-h-9 flex block bg-gray-400 bg-right bg-no-repeat bg-cover"
		href="https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/"
		rel="bookmark"
		style="
			background-image: url('https://news.sophos.com/wp-content/uploads/2019/12/snatch-featured.png?w=640');
		"
	></a>

	<!-- Wrapper -->
	<div class="flex flex-col justify-between flex-grow">

		<!-- Content -->
		<div class="sm:px-8 sm:py-8 p-4 py-6">
			<!-- Date -->
			<div
				class="text-sophos-blue-600 font-sansMedium mb-2 text-xs leading-tight uppercase truncate"
			>
				December 09, 2019			</div>
			<!-- Post Title -->
				<h2 class="text-style-h2 line-clamp-3 sm:mb-4 sm:text-2xl sm:leading-snug text-lg leading-tight text-gray-700"><a href="https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/" rel="bookmark" class="dark:text-white font-sansSemiBold font-semibold text-gray-900 no-underline cursor-pointer">Snatch ransomware reboots PCs into Safe Mode to bypass protection</a></h2>			<!-- Excerpt -->
						</div>

			</div>
</article>
			</div>

	
</div>
</div>
</div> <!-- #secondary -->

			
<div class="bg-sophos-gray-50 px-4 pt-16 pb-8" id="comments">

			<div class="container max-w-4xl bg-white py-6 md:py-16 rounded-md">
		<h2 class="text-style-h2-lg mb-6 md:mb-12">
			<span>17</span> Comments		</h2>

		<section class="comments-list">
		<article class="comment even thread-even depth-1  " id="comment-173738" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													TD											</h2>
					<time class="comment-meta-item" datetime="2020-02-07T13:34-05:00" itemprop="datePublished"><a href="#comment-173738" itemprop="url">07 February 2020 at 1:34 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Good job with the investigation. How can we force Verisign to comply with shutting down something like this.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/?replytocom=173738#respond' data-commentid="173738" data-postid="63980" data-belowelement="comment-173738" data-respondelement="respond" data-replyto="Reply to TD" aria-label='Reply to TD'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-odd thread-alt depth-1 parent " id="comment-173987" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													TCM87											</h2>
					<time class="comment-meta-item" datetime="2020-02-09T10:57-05:00" itemprop="datePublished"><a href="#comment-173987" itemprop="url">09 February 2020 at 10:57 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Could Sophos release details / a copy of the code signing public key certificate the GDRV.SYS driver is signed with.</p>
<p>Presumably adding this to the untrusted certificate store through group policy would prevent installation of this driver?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/?replytocom=173987#respond' data-commentid="173987" data-postid="63980" data-belowelement="comment-173987" data-respondelement="respond" data-replyto="Reply to TCM87" aria-label='Reply to TCM87'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment even depth-2  " id="comment-174094" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													SlW											</h2>
					<time class="comment-meta-item" datetime="2020-02-10T14:46-05:00" itemprop="datePublished"><a href="#comment-174094" itemprop="url">10 February 2020 at 2:46 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Check VirusTotal</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/?replytocom=174094#respond' data-commentid="174094" data-postid="63980" data-belowelement="comment-174094" data-respondelement="respond" data-replyto="Reply to SlW" aria-label='Reply to SlW'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt depth-2  " id="comment-174159" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Oliver											</h2>
					<time class="comment-meta-item" datetime="2020-02-11T10:10-05:00" itemprop="datePublished"><a href="#comment-174159" itemprop="url">11 February 2020 at 10:10 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>@TCM87: don&#8217;t think it would. The trust store isn&#8217;t usable that early during the boot process, I think.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/?replytocom=174159#respond' data-commentid="174159" data-postid="63980" data-belowelement="comment-174159" data-respondelement="respond" data-replyto="Reply to Oliver" aria-label='Reply to Oliver'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment byuser comment-author-andrewbrandt bypostauthor even depth-2  bystaff" id="comment-174195" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/216532880604c8cf0600f4bc964cf01d?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/216532880604c8cf0600f4bc964cf01d?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Andrew Brandt											</h2>
					<time class="comment-meta-item" datetime="2020-02-11T17:49-05:00" itemprop="datePublished"><a href="#comment-174195" itemprop="url">11 February 2020 at 5:49 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>In response to this inquiry we have added the following line to the story:</p>
<p>The sha1RSA Authenticode signature for the driver, with serial number 248472542c24ab8e429229acf121ca26 and thumbprint 32daee48ae406222c2bb92c4f1b7f516e537175a, expired on October 17, 2013.</p>
<p>The certificate details are also all listed in the Details tab on Virustotal: https://www.virustotal.com/gui/file/31f4cfb4c71da44120752721103a16512444c13c2ac2d857a7e6f13cb679b427/details</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/?replytocom=174195#respond' data-commentid="174195" data-postid="63980" data-belowelement="comment-174195" data-respondelement="respond" data-replyto="Reply to Andrew Brandt" aria-label='Reply to Andrew Brandt'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment odd alt thread-even depth-1  " id="comment-174066" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Hugh Jass											</h2>
					<time class="comment-meta-item" datetime="2020-02-10T06:49-05:00" itemprop="datePublished"><a href="#comment-174066" itemprop="url">10 February 2020 at 6:49 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>I second  TCM87&#8217;s request to release the certificate so we can block it somehow.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/?replytocom=174066#respond' data-commentid="174066" data-postid="63980" data-belowelement="comment-174066" data-respondelement="respond" data-replyto="Reply to Hugh Jass" aria-label='Reply to Hugh Jass'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-odd thread-alt depth-1  " id="comment-174093" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													SlW											</h2>
					<time class="comment-meta-item" datetime="2020-02-10T14:46-05:00" itemprop="datePublished"><a href="#comment-174093" itemprop="url">10 February 2020 at 2:46 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>TCM87, those details about the driver on VirusTotal. Search for the hash and it should come up.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/?replytocom=174093#respond' data-commentid="174093" data-postid="63980" data-belowelement="comment-174093" data-respondelement="respond" data-replyto="Reply to SlW" aria-label='Reply to SlW'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-even depth-1 parent " id="comment-174099" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Ray Collazo											</h2>
					<time class="comment-meta-item" datetime="2020-02-10T17:01-05:00" itemprop="datePublished"><a href="#comment-174099" itemprop="url">10 February 2020 at 5:01 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Specifically which Gigabyte drivers are affected? I have a Gigabyte SSD made in FEB 2019 that I am now wondering if its safe to use</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/?replytocom=174099#respond' data-commentid="174099" data-postid="63980" data-belowelement="comment-174099" data-respondelement="respond" data-replyto="Reply to Ray Collazo" aria-label='Reply to Ray Collazo'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-andrewbrandt bypostauthor even depth-2  bystaff" id="comment-174196" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/216532880604c8cf0600f4bc964cf01d?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/216532880604c8cf0600f4bc964cf01d?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Andrew Brandt											</h2>
					<time class="comment-meta-item" datetime="2020-02-11T17:52-05:00" itemprop="datePublished"><a href="#comment-174196" itemprop="url">11 February 2020 at 5:52 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>The specific gdrv.sys file in use during this attack is 26192 bytes in size and self identifies its version as 5.2.3790.1830</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/?replytocom=174196#respond' data-commentid="174196" data-postid="63980" data-belowelement="comment-174196" data-respondelement="respond" data-replyto="Reply to Andrew Brandt" aria-label='Reply to Andrew Brandt'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment odd alt thread-odd thread-alt depth-1 parent " id="comment-174140" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Thorsten Schöning											</h2>
					<time class="comment-meta-item" datetime="2020-02-11T06:10-05:00" itemprop="datePublished"><a href="#comment-174140" itemprop="url">11 February 2020 at 6:10 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>I wonder how exactly is GDRV.SYS deployed and started? I might have missed it, but couldn&#8217;t read any details about that. Don&#8217;t users need to provide admin-privileges to do that?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/?replytocom=174140#respond' data-commentid="174140" data-postid="63980" data-belowelement="comment-174140" data-respondelement="respond" data-replyto="Reply to Thorsten Schöning" aria-label='Reply to Thorsten Schöning'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-andrewbrandt bypostauthor even depth-2 parent bystaff" id="comment-174197" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/216532880604c8cf0600f4bc964cf01d?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/216532880604c8cf0600f4bc964cf01d?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Andrew Brandt											</h2>
					<time class="comment-meta-item" datetime="2020-02-11T17:53-05:00" itemprop="datePublished"><a href="#comment-174197" itemprop="url">11 February 2020 at 5:53 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>The attacker convinces an end user to execute a file which requests administrative privileges.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/?replytocom=174197#respond' data-commentid="174197" data-postid="63980" data-belowelement="comment-174197" data-respondelement="respond" data-replyto="Reply to Andrew Brandt" aria-label='Reply to Andrew Brandt'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment odd alt depth-3  " id="comment-174200" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													TP											</h2>
					<time class="comment-meta-item" datetime="2020-02-11T18:52-05:00" itemprop="datePublished"><a href="#comment-174200" itemprop="url">11 February 2020 at 6:52 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Asking for a friend &#8211; let&#8217;s say a user &#8220;accidentally&#8221; runs a file, and it has the compromised cert.  Will current updated Sophos endpoint ignore the cert&#8217;s authority and process the file normally?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/?replytocom=174200#respond' data-commentid="174200" data-postid="63980" data-belowelement="comment-174200" data-respondelement="respond" data-replyto="Reply to TP" aria-label='Reply to TP'>Reply</a>				</div>
			</div>

	</article></section></article></section></article>
		<article class="comment even thread-even depth-1  " id="comment-174261" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Michael Gorton											</h2>
					<time class="comment-meta-item" datetime="2020-02-12T12:13-05:00" itemprop="datePublished"><a href="#comment-174261" itemprop="url">12 February 2020 at 12:13 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Do you have the MD5 hashes for those drivers btw?  Thanks</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/?replytocom=174261#respond' data-commentid="174261" data-postid="63980" data-belowelement="comment-174261" data-respondelement="respond" data-replyto="Reply to Michael Gorton" aria-label='Reply to Michael Gorton'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-odd thread-alt depth-1  " id="comment-174662" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Greg Christopher											</h2>
					<time class="comment-meta-item" datetime="2020-02-16T18:55-05:00" itemprop="datePublished"><a href="#comment-174662" itemprop="url">16 February 2020 at 6:55 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Some of the integrity protection products out there would prevent such an attack because the driver is not signed by a vendor on the tiny trusted publishers list.  A limited number of people are allowed to make changes and that list does not necessarily intersect directly with the windows administrator list.  They would never even see the UAC dialog- the install is just blocked.  If the cert was revoked and gigabit were trusted, it would be blocked too.  Installs on those systems have to be blessed by the security team operating the endpoint.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/?replytocom=174662#respond' data-commentid="174662" data-postid="63980" data-belowelement="comment-174662" data-respondelement="respond" data-replyto="Reply to Greg Christopher" aria-label='Reply to Greg Christopher'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-even depth-1  " id="comment-174663" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Greg Christopher											</h2>
					<time class="comment-meta-item" datetime="2020-02-16T18:58-05:00" itemprop="datePublished"><a href="#comment-174663" itemprop="url">16 February 2020 at 6:58 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>(IMHO microsoft should definitely revoke this one)</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/?replytocom=174663#respond' data-commentid="174663" data-postid="63980" data-belowelement="comment-174663" data-respondelement="respond" data-replyto="Reply to Greg Christopher" aria-label='Reply to Greg Christopher'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-odd thread-alt depth-1  " id="comment-175119" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Alex											</h2>
					<time class="comment-meta-item" datetime="2020-02-20T12:59-05:00" itemprop="datePublished"><a href="#comment-175119" itemprop="url">20 February 2020 at 12:59 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Thanks for the writeup! I downloaded steel.exe and ran it on my virtual lab; none of the other files were created. I had disabled all protection. Any thoughts why?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/?replytocom=175119#respond' data-commentid="175119" data-postid="63980" data-belowelement="comment-175119" data-respondelement="respond" data-replyto="Reply to Alex" aria-label='Reply to Alex'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-even depth-1  " id="comment-192923" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://sankgreall.com" itemprop="author">James Jackson</a>
											</h2>
					<time class="comment-meta-item" datetime="2020-06-29T05:36-04:00" itemprop="datePublished"><a href="#comment-192923" itemprop="url">29 June 2020 at 5:36 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Thanks for the write-up, some really useful information was presented here that I was able to use in my research on the threat group and their most recent attack methods: https://medium.com/@sankgreall/robbinhood-and-the-merry-men-5661b718e455</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/?replytocom=192923#respond' data-commentid="192923" data-postid="63980" data-belowelement="comment-192923" data-respondelement="respond" data-replyto="Reply to James Jackson" aria-label='Reply to James Jackson'>Reply</a>				</div>
			</div>

	</article></section>
				</div>
	
	
	<div class="container max-w-2xl py-6 md:py-16">
			<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> <span class="required-field-message" aria-hidden="true">Required fields are marked <span class="required" aria-hidden="true">*</span></span></p><p class="comment-form-comment"><label for="comment">Comment <span class="required" aria-hidden="true">*</span></label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='63980' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="4070a57cc4" /></p><p style="display: none !important;"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="112"/><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
		</div>

</div><!-- #comments -->
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


	</div> <!-- #content -->

	

<div class="bg-sophos-gray-50 md:py-16 px-4" x-data="subscribeForm()">
	<div class="container max-w-2xl" x-show="!subscribed">
	<div class="text-style-h2-lg">
		Subscribe to get the latest updates in your inbox.	</div>
	<form action="">
		<div class="flex flex-col my-6">
		<input
			type="text"
			placeholder="name@email.com"
			class="w-full"
			x-model="email"
			x-on:keydown="resetErrors()"
			required
		/>
		<div
			x-cloak
			x-show="message"
			x-text="message"
			class="font-sansMedium px-4 py-3 mt-2 text-sm font-medium text-white bg-black border rounded-md"
		></div>
		</div>
		<div class="mb-4 text-lg">
			Which categories are you interested in?		</div>
		<div class="my-2 space-y-1">
		<template
			x-for="category in Object.entries(categories)"
			:key="category[0]"
		>
			<div>
			<label
				x-bind:for="category[1].value"
				class="inline-flex items-center"
			>
				<input
				type="checkbox"
				x-bind:value="category[1].value"
				x-bind:id="category[1].value"
				x-bind:name="category[1].value"
				x-model="subscribeTo"
				/>
				<span
				class="text-style-form-label ml-2"
				x-text="category[1].name"
				>
				</span>
			</label>
			</div>
		</template>
		</div>
		<div class="mt-6">
		<input
			type="submit"
			class="round-button round-button--primary"
			@click.prevent="submit()"
			x-bind:value="buttonText()"
			x-bind:class="{ 'opacity-30 cursor-not-allowed': buttonDisabled() }"
			x-bind:disabled="buttonDisabled()"
		/>
		</div>
	</form>
	</div>

	<div class="container max-w-2xl" x-cloak x-show="subscribed && !loading">
	<div class="text-style-h2 md:text-3xl mb-4 text-2xl text-center">
		You’re now subscribed!	</div>
	<div
		class="text-lg text-center"
		x-text="`Check your email to confirm your subscription.`"
	></div>
	</div>
</div>

<script>
	let subscribeForm = function () {
	return {
		config: {
		endpoints: {
			signup:
			"https://sophos-mailchimp-signup.netlify.app/.netlify/functions/newsletter-signup",
		},
		},
		subscribed: false,
		loading: false,
		error: false,
		message: "",
		categories: {
		1: {
			name: decodeURIComponent( 'Products%20and%20Services' ),
			value: "products-services",
		},
		2: {
			name: decodeURIComponent( 'Threat%20Research' ),
			value: "threat-research",
		},
		3: {
			name: decodeURIComponent( 'Security%20Operations' ),
			value: "security-operations",
		},
		4: {
			name: decodeURIComponent( 'AI%20Research' ),
			value: "ai-research",
		},
		5: {
			name: decodeURIComponent( '%23SophosLife' ),
			value: "sophos-life",
		},
		},
		subscribeTo: [],
		email: "",

		reset() {
		this.loading = false;
		if (!this.error) {
			this.email = "";
		}
		},

		resetErrors() {
		this.error = false;
		this.message = "";
		},

		setError(message) {
		this.error = true;
		this.message = message;
		},

		setSuccess(message) {
		this.error = false;
		this.message = message;
		},

		emailIsValid(email) {
		return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
		},

		submit() {
		this.loading = true;
		this.resetErrors();

		const mcList = "8d6471d831";
		const mcLanguage = decodeURIComponent( 'en' );
		const mcTags = [...this.subscribeTo, mcLanguage];

		const payload = {
			email: this.email,
			listId: mcList,
			tags: mcTags,
			language: mcLanguage,
		};

		fetch(this.config.endpoints.signup, {
			method: "POST",
			headers: {
			"Content-Type": "application/json",
			},
			body: JSON.stringify(payload),
		})
			.then((r) => r.json())
			.then((data) => {
			if (data.status === "pending") {
				this.setSuccess(
					decodeURIComponent( 'You%20have%20been%20subscribed.%20Please%20check%20your%20email%20to%20confirm.' )
				);
				this.subscribed = true;
			} else if (
				data.status === "subscribed"
			) {
				this.setSuccess(
					decodeURIComponent( 'You%20are%20already%20subscribed.%20Thank%20you%21' )
				);
			} else {
				this.setError(
					decodeURIComponent( 'We%20could%20not%20subscribe%20you.%20Please%20try%20again.' )
				);
			}
			})
			.catch((e) => {
			this.setError(
				decodeURIComponent( 'We%20could%20not%20subscribe%20you.%20Please%20try%20again.' )
			);
			})
			.finally(() => {
			this.reset();
			});
		},

		buttonText() {
		return this.loading ? decodeURIComponent( 'Please%20Wait' ) : decodeURIComponent( 'Subscribe' );
		},

		buttonDisabled() {
		return (
			this.subscribeTo.length < 1 ||
			!this.emailIsValid(this.email) ||
			this.loading
		);
		},
	};
	};
</script>


	<footer
		class="bg-white border-t border-sophos-gray-200 "
		x-data="{ languageMenu: false, privacyMenu: false, legalMenu: false }"
	>
		<div class="container">
			<div class="md:flex-row md:items-center flex flex-col justify-between py-8">
				<div class="flex items-baseline flex-grow space-x-6">
					<!-- Language -->
					
<div class="relative mr-auto">
	<a
		href="#"
		class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
		@click.prevent="languageMenu = !languageMenu"
		@click.away="languageMenu = false"
	>
		Change Region		<svg
			xmlns="http://www.w3.org/2000/svg"
			width="8"
			height="4"
			class="inline-block transition-transform transform"
			:class="{'rotate-180': languageMenu }"
		>
			<path
				fill="#7F8C9D"
				fill-rule="evenodd"
				d="M4 2.178L5.915.262a.708.708 0 01.996 0 .702.702 0 010 .995L4.75 3.415A.7.7 0 014 3.94a.702.702 0 01-.751-.524l-2.16-2.158a.702.702 0 11.996-.995L4 2.178z"
			/>
		</svg>
	</a>

	<!-- Language Menu -->
	<div
		class="focus:outline-none border-sophos-gray-200 absolute bottom-0 left-0 w-48 px-4 py-1 py-4 mb-8 -ml-4 origin-bottom-left bg-white border rounded-md shadow-md"
		role="menu"
		aria-orientation="vertical"
		aria-labelledby="user-menu"
		x-show="languageMenu"
		x-cloak
		x-transition:enter="transition-all ease-out duration-100"
		x-transition:enter-start="transform opacity-0 scale-95"
		x-transition:enter-end="transform opacity-100 scale-100"
		x-transition:leave="transition ease-in duration-75"
		x-transition:leave-start="transform opacity-100 scale-100"
		x-transition:leave-end="transform opacity-0 scale-95"
	>
		<ul
			class="font-sansMedium text-sophos-gray-600 space-y-1 text-xs font-medium"
		>
											<li>
					<a href="https://news.sophos.com/es-419">
						América Latina					</a>
				</li>
															<li>
					<a href="https://news.sophos.com/pt-br">
						Brasil					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/de-de">
						Deutschland					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/en-us">
						English					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/fr-fr">
						France					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/es-es">
						Iberia					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/it-it">
						Italia					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/ja-jp">
						Japan					</a>
				</li>
									</ul>
	</div>
</div>

					<!-- Terms -->
					<a
						href="https://www.sophos.com/en-us/legal/sophos-website.aspx"
						class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block ml-auto text-xs font-medium leading-tight"
						>Terms</a
					>

					<!-- Privacy -->
					
<span class="relative">
	<a
		href="#"
		class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
		@click.prevent="privacyMenu = !privacyMenu"
		@click.away="privacyMenu = false"
	>
		Privacy
		<svg
			xmlns="http://www.w3.org/2000/svg"
			width="8"
			height="4"
			class="inline-block transition-transform transform"
			:class="{'rotate-180': privacyMenu }"
		>
			<path
				fill="#7F8C9D"
				fill-rule="evenodd"
				d="M4 2.178L5.915.262a.708.708 0 01.996 0 .702.702 0 010 .995L4.75 3.415A.7.7 0 014 3.94a.702.702 0 01-.751-.524l-2.16-2.158a.702.702 0 11.996-.995L4 2.178z"
			/>
		</svg>
	</a>
	<div
		class="focus:outline-none border-sophos-gray-200 absolute bottom-0 left-0 w-48 px-4 py-1 py-4 mb-8 -ml-4 origin-bottom-left bg-white border rounded-md shadow-md"
		role="menu"
		aria-orientation="vertical"
		aria-labelledby="user-menu"
		x-show="privacyMenu"
		x-cloak
		x-transition:enter="transition-all ease-out duration-100"
		x-transition:enter-start="transform opacity-0 scale-95"
		x-transition:enter-end="transform opacity-100 scale-100"
		x-transition:leave="transition ease-in duration-75"
		x-transition:leave-start="transform opacity-100 scale-100"
		x-transition:leave-end="transform opacity-0 scale-95"
	>
		<ul
			class="font-sansMedium text-sophos-gray-600 space-y-1 text-xs font-medium"
		>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx"
				>
					Privacy Notice				</a>
			</li>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal/cookie-information.aspx"
				>
					Cookies				</a>
			</li>
		</ul>
	</div>
</span>

					<!-- Legal -->
					
<span class="relative">
	<a
		href="#"
		class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
		@click.prevent="legalMenu = !legalMenu"
		@click.away="legalMenu = false"
	>
		Legal
		<svg
			xmlns="http://www.w3.org/2000/svg"
			width="8"
			height="4"
			class="inline-block transition-transform transform"
			:class="{'rotate-180': legalMenu }"
		>
			<path
				fill="#7F8C9D"
				fill-rule="evenodd"
				d="M4 2.178L5.915.262a.708.708 0 01.996 0 .702.702 0 010 .995L4.75 3.415A.7.7 0 014 3.94a.702.702 0 01-.751-.524l-2.16-2.158a.702.702 0 11.996-.995L4 2.178z"
			/>
		</svg>
	</a>
	<div
		class="focus:outline-none border-sophos-gray-200 absolute bottom-0 left-0 w-48 px-4 py-1 py-4 mb-8 -ml-4 origin-bottom-left bg-white border rounded-md shadow-md"
		role="menu"
		aria-orientation="vertical"
		aria-labelledby="user-menu"
		x-show="legalMenu"
		x-cloak
		x-transition:enter="transition-all ease-out duration-100"
		x-transition:enter-start="transform opacity-0 scale-95"
		x-transition:enter-end="transform opacity-100 scale-100"
		x-transition:leave="transition ease-in duration-75"
		x-transition:leave-start="transform opacity-100 scale-100"
		x-transition:leave-end="transform opacity-0 scale-95"
	>
		<ul
			class="font-sansMedium text-sophos-gray-600 space-y-1 text-xs font-medium"
		>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal.aspx"
				>
					General				</a>
			</li>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx"
				>
					Modern Slavery Statement				</a>
			</li>
			<li>
				<a
					href="https://secure.ethicspoint.eu/domain/media/en/gui/104916/index.html"
				>
					Speak Out				</a>
			</li>
		</ul>
	</div>
</span>

					<!-- Copyright -->
					<div class="md:ml-6 mt-2 md:mt-0">
						<span
							class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
						>
							&copy; 1997 - 2022 Sophos Ltd. All rights reserved						</span>
					</div>
				</div>
			</div>
			</div>
		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type="text/javascript" src="https://news.sophos.com/_static/??-eJyVjGEOwiAMRi8kZRCn/jGehZBmA6UQWp3Ht2YXGOn36+W92q2ZWEmQxMqKBdlybWtlwo2Nn9zVZtapVJ8JzceDB6cAdgCZT/bQj1j7gI1f6YGP+zuCt6TXeBVDaSEtNBy20IWwD3dLGE7+TKNHubvLfDvPelP+AaC7oEI=" ></script><script src='https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.8.1/dist/alpine.min.js?ver=2.0.1' id='alpine-js-js'></script>
<script type="text/javascript" src="https://news.sophos.com/wp-includes/js/comment-reply.min.js?m=1658827588g" ></script><script src='https://stats.wp.com/e-202231.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:11.1.2',blog:'166161023',post:'63980',tz:'-4',srv:'news.sophos.com',hp:'vip'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '63980' ]);
</script>
</body>
</html>
