<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: Evasions in Intrusion Prevention/Detection Systems</title>
<meta name="description" content="Abhishek Singh and colleagues look at some of the more common methods of evading IDS/IPS detection and the ways in which solutions can counter these evasive techniques." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 2162;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/remo_expand/blocks/remo_expand/templates/vbexpand/view.css" />
<script type="text/javascript" src="/packages/remo_expand/js/jquery.color.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/remo.expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<div class="titlepage" xmlns=""><div><div><h1 class="title" xmlns="http://www.w3.org/1999/xhtml"><a id="vb201004-evasions-in-IPS-IDS"></a>Evasions in Intrusion Prevention/Detection Systems</h1></div><div><p class="pubdate" xmlns="http://www.w3.org/1999/xhtml">2010-04-01</p></div><div><div class="authorgroup" xmlns="http://www.w3.org/1999/xhtml"><div class="author titlepage"><h3 class="author"><span class="firstname">Abhishek</span> <span class="surname">Singh</span></h3><span class="orgname">Microsoft</span>, <span class="orgdiv">USA</span></div><div class="author titlepage"><h3 class="author"><span class="firstname">Scott</span> <span class="surname">Lambert</span></h3><span class="orgname">Microsoft</span>, <span class="orgdiv">USA</span></div><div class="author titlepage"><h3 class="author"><span class="firstname">Tanmay A.</span> <span class="surname">Ganacharya</span></h3><span class="orgname">Microsoft</span>, <span class="orgdiv">USA</span></div><div class="author titlepage"><h3 class="author"><span class="firstname">Jeff</span> <span class="surname">Williams</span></h3><span class="orgname">Microsoft</span>, <span class="orgdiv">USA</span></div><b class="editedby">Editor: </b><span class="editor"><span class="firstname">Helen</span> <span class="surname">Martin</span></span></div></div><div><div class="abstract" xmlns="http://www.w3.org/1999/xhtml"><p class="title"><b>Abstract</b></p><p>Abhishek Singh and colleagues look at some of the more common methods of evading IDS/IPS detection and the ways in which solutions can counter these evasive techniques.</p></div></div><div><p class="copyright" xmlns="http://www.w3.org/1999/xhtml"><i>Copyright &copy; 2010 Virus Bulletin</i></p></div></div><hr /></div>
<div class="ccm-remo-expand">
<div id="ccm-remo-expand-title-3736" class="ccm-remo-expand-title ccm-remo-expand-closed" data-expander-speed="200">Table of contents</div><div id="ccm-remo-expand-content-3736" class="ccm-remo-expand-content"><div class="toc"><dl><dt><span class="sect1"><a href="#id4828374"></a></span></dt><dt><span class="sect1"><a href="#id3649350">Does the IDS/IPS provide support for bidirectional protocol decoders?</a></span></dt><dt><span class="sect1"><a href="#id4394119">Is the IDS/IPS able to decode encrypted data?</a></span></dt><dt><span class="sect1"><a href="#id4629589">Does the IDS/IPS provide support for encoded data?</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id4349855">Encodings in HTTP</a></span></dt><dt><span class="sect2"><a href="#id2752808">Encodings in MIME</a></span></dt><dt><span class="sect2"><a href="#id3141248">Encodings in RPC</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id3352689">Does the IDS/IPS support forwarding of data from one protocol decoder to another?</a></span></dt><dt><span class="sect1"><a href="#id4372963">Does the IDS/IPS provide anti-evasion measures for application-specific evasions?</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id4627936">Application-specific evasions in HTTP</a></span></dt><dt><span class="sect2"><a href="#id4394878">Application-specific evasions in MIME</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id3859187">Does the IDS/IPS provide support for the reassembly of segmented and fragmented data?</a></span></dt><dt><span class="sect1"><a href="#id3106888">Does the IDS/IPS protect against RFC compliance evasion?</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id4313490">RFC compliance evasions in HTTP</a></span></dt><dt><span class="sect2"><a href="#id3619380">RFC compliance evasions in Remote Procedure Calls</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id2628668">Conclusion</a></span></dt><dt><span class="sect1"><a href="#id3373156">Acknowledgements</a></span></dt></dl></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4828374"></a></h2></div></div></div><p>Use of an Intrusion Prevention System (IPS) and/or Intrusion Detection System (IDS) can be very effective in preventing and/or detecting the exploitation of certain classes of vulnerability over the network. This is most commonly achieved by matching patterns against the raw bytes sent over the network. This approach can be improved upon by breaking the raw bytes into constituent parts (protocol fields) before applying appropriate checks on the parsed data. The goal is to maximize both the confidence of the detection (match) and the resilience of the IDS/IPS systems to evasion.</p><p>There are many different types of protocol decoder in IDS/IPS systems. Some devices have protocol decoders which parse both the client and server messages, and have the capability of forwarding the traffic from one protocol to another. Some protocol decoders are limited to parsing the server messages, while others do not provide any forwarding of traffic to other layers. However, regardless of the type of protocol decoding used, detection can be evaded.</p><p>The structure and usage of each protocol is different. A protocol can accept an external input in various forms, and this can be a weakness. For example, in the case of HTTP, the web server www.microsoft.com can also be referred to as www.%6D%69%63%72%6F%73%6F%66%74%2E%63%6F%6D. While a strong signature can be developed to block attempts to exploit a given vulnerability, if the IPS/IDS itself does not take steps to prevent evasion, the signature will easily be bypassed.</p><p>In this article we look at some of the more common methods of evading IDS/IPS detection. Each section provides an overview of the problem, one or more concrete examples, and their respective solutions. A good IDS/IPS device should be able to address most, if not all, of the issues discussed in this article.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3649350"></a>Does the IDS/IPS provide support for bidirectional protocol decoders?</h2></div></div></div><p>There are two types of protocol decoder: single directional and bidirectional. In general, a single-directional protocol decoder denotes that a command has ended by using the delimiter of the command, whereas a bidirectional protocol decoder uses both the delimiter of the command and the response code. If both directions of a session are not parsed (the state is not kept), it is possible that the system will apply signature logic incorrectly. This introduces the possibility of false positive detections.</p><p>Let&rsquo;s take the SMTP protocol as an example. SMTP stands for Simple Mail Transfer Protocol and is defined in RFC 5321 [<span class="citation"><a href="#citation.1">1</a></span>]. The normal flow of commands in SMTP is shown in <a href="#figure.1">Figure 1</a>. The DATA is sent after the RCPT TO request.</p><div class="figure"><a id="figure.1"></a><div class="mediaobject"><img alt="Normal flow of commands in SMTP." src="/uploads/images/figures/2010/04/singh1.jpg" /></div><p class="title"><b>Figure&nbsp;1.&nbsp;Normal flow of commands in SMTP.</b></p></div><p>A single-directional protocol decoder will assume that the bytes that follow the DATA command are data and will allow them to pass through without checking for exploits. <a href="#figure.2">Figure 2</a> shows a situation in which the DATA command is issued before the RCPT TO request; the SMTP server will still be in a command state and will accept the command. The single-directional protocol decoder will be expecting the bytes that follow the DATA command to be data and will allow them to pass through. A bidirectional decoder, on the other hand, requires both the DATA command and the response code 354 to go to DATA state.</p><div class="figure"><a id="figure.2"></a><div class="mediaobject"><img alt="The DATA command is issued before RCPT TO." src="/uploads/images/figures/2010/04/singh2.jpg" /></div><p class="title"><b>Figure&nbsp;2.&nbsp;The DATA command is issued before RCPT TO.</b></p></div><p>To reduce the possibility of false positives, it is recommended that an IDS/IPS system implement bidirectional protocol parsers.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4394119"></a>Is the IDS/IPS able to decode encrypted data?</h2></div></div></div><p>Several protocols support the notion of using encryption to enable some form of privacy in support of security. The general problem with encryption is that it makes it difficult, if not impossible, for a man-in-the-middle (MiTM) implementation of IDS/IPS to interpret the raw bytes correctly. For example, upon starting a session, an RPC request is made for secure services whereby a secure context is established. This secure context might include a shared session key, sequence number, verification state, and so on. The secure context is used to form a secure connection between the client and the server. The client can send an encrypted RPC message to the server using the generated session key, with an optional authentication header. Upon receiving the message, the server decrypts it with the session key before processing the RPC. So exploit variants or encrypted exploits can be generated for many RPC vulnerabilities &ndash; such as MS08-067 (CVE-2008-4250), which was a propagation vector of the infamous Conficker worm. If the detection device cannot decrypt the traffic then the encrypted exploits can bypass detection.</p><p>As well as RPC, encrypted traffic can appear on port 80 for HTTPS connections, port 465 for SMTP, port 995 for POP3 [<span class="citation"><a href="#citation.2">2</a></span>] and port 993 for IMAP [<span class="citation"><a href="#citation.3">3</a></span>].</p><p>A detection device must be able to decrypt encrypted traffic and inspect it. In some IDS/IPS implementations, scanning encrypted traffic for exploits is possible by providing the IPS with decryption keys. The IPS first decrypts the traffic and then forwards the data to its signatures.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4629589"></a>Does the IDS/IPS provide support for encoded data?</h2></div></div></div><p>In many cases, protocols allow data to be encoded in various formats (encodings). These encodings are often published standards which can be used to transmit data. An IDS/IPS system acting as a MiTM should provide support for these various formats. If the IDS/IPS cannot return the encoded data to some &lsquo;common/normal&rsquo; form, both the number and effectiveness of signatures will be impacted. Let&rsquo;s consider a few encodings in HTTP, MIME and RPC.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4349855"></a>Encodings in HTTP</h3></div></div></div><p>The HTTP protocol is defined in RFC 2616 [<span class="citation"><a href="#citation.4">4</a></span>]. The URL field in HTTP can be used to exploit various vulnerabilities, hence many signatures are written to check the value of these fields. Signatures generally monitor the URL field in HTTP traffic.</p><p>The URL field can be encoded in many ways. The following are some of the encodings which are supported by various application web servers and can also be used by an attacker for encoding exploits:</p><div class="itemizedlist"><ul type="disc"><li><p>Hex encoding: this is an RFC-compliant encoding in which an ASCII value is replaced by its hexadecimal value. For example, &lsquo;A&rsquo; is represented as &lsquo;%41&rsquo;.</p></li><li><p>Double percentage encoding: this is based on normal hex encoding, the only difference being that the &lsquo;%&rsquo; value is replaced by its hex value, i.e. &lsquo;%25&rsquo;. In this type of encoding, &lsquo;A&rsquo; is represented as &lsquo;%2541&rsquo;.</p></li><li><p>Double nibble hex encoding: this is based on the standard hex encoding method, in which each nibble is hex encoded. For example, &lsquo;A&rsquo; can be encoded as &lsquo;%%34%31&rsquo;. &lsquo;%34&rsquo; resolves to 4 and &lsquo;%31&rsquo; resolves to 1; thus, the encoding resolves to &lsquo;A&rsquo;.</p></li><li><p>Second nibble encoding: this differs from the first nibble encoding in that the second nibble value is encoded with a normal encoding. For example, &lsquo;A&rsquo; is encoded as &lsquo;%4%31&rsquo;. &lsquo;%31&rsquo; resolves to 1 and &lsquo;%41&rsquo; resolves to &lsquo;A&rsquo;.</p></li><li><p><span class="emphasis"><em>Microsoft</em></span> %U encoding: the format for this encoding is &lsquo;%UXXXX&rsquo;, as shown in <a href="#figure.3">Figure 3</a>. In this type of encoding, &lsquo;%U&rsquo; is followed by four hexadecimal digits. For example, &lsquo;a&rsquo; can be represented as &lsquo;%U0041&rsquo;.</p><div class="figure"><a id="figure.3"></a><div class="mediaobject"><img alt="%U encoding in the GET request of HTTP." src="/uploads/images/figures/2010/04/singh3.jpg" /></div><p class="title"><b>Figure&nbsp;3.&nbsp;%U encoding in the GET request of HTTP.</b></p></div></li><li><p>Mismatch encoding: here, various types of encoding like hex, double nibble, second nibble and <span class="emphasis"><em>Microsoft</em></span> %U encoding are combined to encode a single character. For example, in hex &lsquo;U&rsquo; is encoded as &lsquo;%55&rsquo;. So, using mismatch encoding, &lsquo;%U0041&rsquo; will be encoded as &lsquo;%%550041&rsquo;.</p></li><li><p>UTF-8 bare byte encoding: this is similar to UTF-8 encoding, the only difference being that UTF-8 byte sequences are not escaped with a percentage. Byte sequences are sent with the actual bytes.</p></li><li><p>Parameter evasion using POST and content encoding: if base64 is specified in the content encoding, parameter fields in the post request will be base64-encoded. Hence, the detection device will first have to decode the base64 and then check the stream for malicious content. Decoding of base64 can add extra overhead to the detection system.</p></li></ul></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id2752808"></a>Encodings in MIME</h3></div></div></div><p>As per RFC 2047 [<span class="citation"><a href="#citation.5">5</a></span>], there can be two types of MIME encoding: &lsquo;B&rsquo; encoding, which is similar to base64 encoding, and &lsquo;Q&rsquo; encoding, which is similar to quoted-printable content-transfer encoding. When a MIME message contains unknown RFC 2047 encoding, the detection device can either block the connection, assuming the encoding to be malformed, or it will decode the messages. RFC 2047 encodings provide a vector for evasion in the sense that the client can successfully decode messages in cases where the intrusion detection system is not able to decode them.</p><p>RFC 2045 [<span class="citation"><a href="#citation.6">6</a></span>] provides the content-transfer-encoding field, which allows the specification of an encoding type to enable eight-bit data to travel successfully through seven-bit transport mechanisms. Content-transfer encoding supports seven-bit, eight-bit, binary, quoted-printable and base64 encodings. The content-transfer-encoding field can be used to support other encodings as well, such as uuencode, mac-binhex40 and yenc. By encoding an exploit using an encoder that is supported by the email clients but not by the IPS, detection can be bypassed.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id3141248"></a>Encodings in RPC</h3></div></div></div><p>The RPC protocol [<span class="citation"><a href="#citation.7">7</a></span>] is used to perform client-server communication. The protocol makes use of the external data representation protocol which standardizes the representation of external data in remote communications. In RPC protocol, the client tries to access a remote computer, and the server is a machine that implements network remote procedures. The client makes a remote procedure call to the server and receives a reply which contains the result of the call. RPC supports various transports: TCP, HTTP, UDP and SMB. The RPC messages require unique specification of a procedure to call, matching of response messages to request messages, and authentication of caller to service and service to caller. The data in RPC protocol can be represented in big-endian, little-endian, Unicode, EBCDIC or ASCII strings. The exploit-specific signatures in RPC are prone to evasion.</p><p>Some of the evasions that are a result of various encodings are discussed in the following sections.</p><p><span class="emphasis"><em>Endianness selection</em></span>: in the header of every DCE RPC request there exists a data representation field in which the byte ordering, character set and floating-point representation are specified. Little-endian is used as default. However, even if the flag is changed to big-endian, the RPC request can be treated as a valid request. Based upon the value of the flag, an intrusion prevention system should be able to parse the packet. The detection device can be bypassed if it is not able to differentiate between the big-endian and little-endian packets.</p><div class="figure"><a id="figure.4"></a><div class="mediaobject"><img alt="Endianness in the DCE header." src="/uploads/images/figures/2010/04/singh4.jpg" /></div><p class="title"><b>Figure&nbsp;4.&nbsp;Endianness in the DCE header.</b></p></div><p><span class="emphasis"><em>Unicode and non-Unicode evasion</em></span>: the SMB header provides a two-byte Flag2 field which is used to determine whether the strings will be in Unicode or non-Unicode characters in the SMB header. Non-Unicode characters are used when the value of Flag2 is not set. Hence, all SMB commands, RPC functions and data will be in non-Unicode format. Based upon the Unicode or non-Unicode characters in the header, signatures should be able to check the incoming stream for exploits.</p><div class="figure"><a id="figure.5"></a><div class="mediaobject"><img alt="Flag2 with Unicode strings." src="/uploads/images/figures/2010/04/singh5.jpg" /></div><p class="title"><b>Figure&nbsp;5.&nbsp;Flag2 with Unicode strings.</b></p></div><p>Where encoded data is concerned, the challenge is in making sure that the IDS/IPS system is capable of returning the encoded data to some normal form before signatures are applied. This allows the number of signatures required to address a given vulnerability to be kept to a minimum &ndash; for example, in the case of HTTP there will be at least eight signatures if the IPS does not provide support to decode data.</p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3352689"></a>Does the IDS/IPS support forwarding of data from one protocol decoder to another?</h2></div></div></div><p>Several application-level protocols leverage the TCP/IP stack to ride on top of one another; failure of the IDS/IPS system to decompose raw bytes that use one or more protocols during an exchange generally results in missing attack vectors and, in the worst case, false negatives.</p><p>For example, the MS-RPCH (Remote Procedure Call over HTTP [<span class="citation"><a href="#citation.8">8</a></span>]) protocol tunnels RPC network traffic from an RPC client to an RPC server through a network agent referred to as an RPC over HTTP proxy. The protocol is applicable to network topologies where the use of HTTP- or HTTPS-based transport is necessary &ndash; for example, to traverse an application firewall where the application or computer systems communicating over the topology requires the use of the RPC protocol. This is used as an attack vector/evasive measure for DCOM [<span class="citation"><a href="#citation.9">9</a></span>] exploits such as MS03-026 and MS03-039 which arrive on ports 135, 139 and 445.</p><p>The protocol decoder should be able to forward the MS-RPCH traffic data from HTTP to the DCOM protocol decoder. Similarly, the SMTP headers and the HTTP traffic should be forwarded to the MIME protocol decoder.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4372963"></a>Does the IDS/IPS provide anti-evasion measures for application-specific evasions?</h2></div></div></div><p>In different applications a given protocol may be implemented in slightly different ways. As a result, protocol decoders for an IDS/IPS system need to relax the RFC compliance enforcement (i.e. implement it loosely) to account for the different implementations. Evasive methods appearing in protocols might not appear in all applications. The detection device should have application-specific anti-evasion measures.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4627936"></a>Application-specific evasions in HTTP</h3></div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id3860052"></a>HTTP formatting</h4></div></div></div><p>The syntax for an HTTP request is as follows:</p><pre class="programlisting">Method &lt;space&gt; URI &lt;space&gt; HTTP/Version &lt;CRLF&gt;</pre><p>Some web servers accept a tab between the method and the URI, making requests such as those shown in <a href="#figure.6">Figure 6</a> valid.</p><div class="figure"><a id="figure.6"></a><div class="mediaobject"><img alt="A tab is accepted as a separator between the method and URI." src="/uploads/images/figures/2010/04/singh6.jpg" /></div><p class="title"><b>Figure&nbsp;6.&nbsp;A tab is accepted as a separator between the method and URI.</b></p></div><p>If the protocol decoders of an intrusion prevention system only check for a space between the method and URI, detection can be evaded simply by sending a tab between the method and URI. Besides space and tab, some web servers also accept 0x09, 0x0b, 0x0c and 0x0d as valid separators between the method and URI.</p><p>Some web servers also accept %00 as a valid separator between the method and URI. It should be noted that NULL characters are used to denote the end of the string: the intrusion detection and prevention system stops once %00 is reached and allows the URI to pass through. Hence protocol decoders which parse the method and URI should accept %00 as a separator between the method and URI.</p><p>The syntax of HTTP v0.9 as per RFC 1945 [<span class="citation"><a href="#citation.10">10</a></span>] is:</p><pre class="programlisting">GET &lt;space&gt; URI &lt;CRLF.&gt;</pre><p>Only three parameters are sent in HTTP v0.9, and no headers are returned. If the HTTP v0.9 requests are not parsed correctly, then the HTTP signatures can be evaded simply by sending an exploit using HTTP v0.9 syntax.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id3677173"></a>Forward slash/backward slash</h4></div></div></div><p>Many web servers are flexible in accepting requests. For example, the request http://www.domain.com/index.html is similar to the request http://www.domain.com\index.html. So if the detection device only checks for forward slash patterns it can be evaded by sending a backward slash pattern.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id3240814"></a>Method matching</h4></div></div></div><p>Based on the implementation of CGI, it is often possible to use HEAD in place of POST. In some implementations, the method is ignored. Hence in many systems, an attacker can use the GET or the POST methods interchangeably in an exploit. If the detection device checks for a GET request followed by checking the URI for exploits, it can be evaded by using POST and the exploit URI pattern.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id2113165"></a>Case sensitivity</h4></div></div></div><p>In many implementations of web servers, GET /exploit HTTP/1.0 is similar to GET /EXPLOIT HTTP/1.0. The signatures checking the URI for exploits must be case-insensitive.</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4394878"></a>Application-specific evasions in MIME</h3></div></div></div><p>RFC 822, section 3.1.2, specifies that header fields are lines which are composed of a field name, followed by (&lsquo;:&rsquo;), followed by a field body, and are terminated by CRLF. A separator is used to differentiate between the field names and the field body. Non-standard separators that are accepted by applications include a double colon, or the colon may be omitted altogether. If the MIME protocol decoders are not able to accept non-standard separators, they will not be able to separate the field name from the field body; signatures in turn will not be able to sanitize these fields and detection can be evaded.</p><p>RFC 2822 [<span class="citation"><a href="#citation.11">11</a></span>] states: &lsquo;Strings of characters that include characters other than those allowed in atoms may be represented in a quoted string format, where the characters are surrounded by quote (DQUOTE, ASCII value 34) characters.&rsquo; Non-standard quoting includes quoting fields that should not be quoted, duplicating quotes, and the omission of leading or trailing quote characters from a string. Often, these non-standard quotings are accepted by applications but are not accepted by detection devices. Hence, if an exploit uses non-standard quotings, these may be accepted by the application, and the detection device will fail to properly parse and sanitize the traffic, allowing the exploit to go undetected.</p><p>Quoting RFC 822 [<span class="citation"><a href="#citation.12">12</a></span>], &lsquo;A comment is a set of ASCII characters which is enclosed in matching parentheses and which is not within a quoted string. The comment construct permits message originators to add text which will be useful for human readers, but which will be ignored by the formal semantics. Comments should be retained while the message is subject to interpretation according to this standard. However, comments must NOT be included in other cases, such as during protocol exchanges with email servers.&rsquo; When an unexpected RFC 822 comment is present, the MIME message is either regarded as malformed and blocked, or the protocol decoder fails to interpret it correctly, which can lead to failure to detect an exploit.</p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3859187"></a>Does the IDS/IPS provide support for the reassembly of segmented and fragmented data?</h2></div></div></div><p>It is possible for an attack to be spread over multiple packets. Protocols like MSTDS [<span class="citation"><a href="#citation.13">13</a></span>], Sun RPC, RPC and HTTP support fragmentation of packets while streaming. Since a server provides the capability of reassembling the disassembled packets, exploits can take advantage of this and spread across packets.</p><p>Taking the case of MSTDS, the protocol has the following structure:</p><pre class="programlisting">Offset Size   Description
-----------   -------------

0x0000 1      Type (0x01 for query)
0x0001 1      Status
0x0002 2      Length = X (big-endian)
0x0004 2      SPID (big-endian)
0x0006 1      Packet ID (big-endian)
0x0007 1      Window (unused, must be 0)
0x0008 X-8    Packet Data (Unicode)
</pre><p>To monitor for vulnerabilities, generally the Data field containing the name of stored procedures must be inspected. The Length field is a two-byte (16 bits) field in the header. If the TDS packet to be transmitted over the network is longer than the maximum 16-bit integer, then it must be split into smaller packet fragments. Each packet fragment, with the exception of the last, will contain the value 0x00 in the last packet indicator field to indicate that there are additional packet fragments to follow. On the receiving side, the full TDS packet payload is reassembled from these fragments.</p><p>In the case of HTTP, session splicing can be used to send an exploit across the packets. For example, one packet will contain &lsquo;GET&rsquo;, another will contain &lsquo;/cgi&rsquo;, another will contain &lsquo;-bin&rsquo;, and the last one will contain &lsquo;HTTP/1.0&rsquo;.</p><p>Similarly, fragmentation of RPC requests can occur. A normal piece of RPC data will contain a header and data, however, the entire RPC request can be split into multiple RPC requests. Since this is an application-level fragmentation, the IPS will have to reassemble the fragments of the packets. The IPS should have the capability of skipping the header of fragmented RPC packets and reassembling the RPC header and data. It should also check for malicious content in the packet.</p><p>In order for a detection device to prevent the spreading of an exploit across multiple packets, it is essential for it to assemble the packets in a session and then inspect them for exploits.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3106888"></a>Does the IDS/IPS protect against RFC compliance evasion?</h2></div></div></div><p>RFC provides specifications for a protocol. Evasion often occurs when an IDS/IPS fails to correctly decode a protocol into its constituent fields. As a result, it is possible that one of two outcomes occurs: a false positive and/or a false negative, depending on the nature of the decoding and signature logic. RFC-specific evasions fall under this category.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4313490"></a>RFC compliance evasions in HTTP</h3></div></div></div><p>The URI http://www.microsoft.com/en/aaaaaaaaaaaaaaaaaaaaaa/../us/default.aspx descends into /en, then further descends into the aaaaaaaaaaaaaaaaaaaaaa directory, which may or may not exist. Following the next slash is a directory traversal, /.., which basically backs into /en/us. Hence the URL is similar to http://www.microsoft.com/en/us/ default.aspx and is accepted by the web server as a valid request, pointing to the same web page.</p><p>Sometimes IDS/IPS devices only check for the first xx bytes of a request. Thus, by sending a large enough number of &lsquo;a&rsquo; characters, the rest of the submitted request will be moved outside of the IDS system scan. So if the malicious pattern is &lsquo;/en/us&rsquo; and the IDS/IPS only checks for the first 1k bytes, &lsquo;/en/&rsquo; followed by 2k of &lsquo;aaa&rsquo;, followed by &lsquo;/../us&rsquo; will successfully avoid detection by the IDS/IPS.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id3619380"></a>RFC compliance evasions in Remote Procedure Calls</h3></div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id4394318"></a>Multiple binding UUID</h4></div></div></div><p>In the RPC calling mechanism there is one bind request which can contain one UUID and one context ID. The server uses context ID to identify the UUID. Generally, IPS/IDS signatures check the UUID of vulnerable functions in the incoming stream and then parse the argument for malicious content. However, it is also possible for the server to receive multiple UUIDs and multiple context IDs for every single bind request. This is called multiple UUID bind and is a valid request. IPS rules that check for only one UUID and one context per bind request will allow the traffic to pass through, yet the multiple bind part of the UUID may be associated with a vulnerable function. The server will use the context ID and may make a call to the vulnerable function. To prevent multiple bind evasion, an IPS device should parse the bind request. If there are multiple binds and multiple context IDs, then it should keep track of vulnerable UUIDs and corresponding context IDs. If there is a vulnerable function call using that context ID, the IPS rules should monitor the functions for malicious content.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id2809427"></a>SMB CreateAndX path names</h4></div></div></div><p>The path name \\\\\\\\\*SMBSOMESERVICE\C$ is treated in the same way as \\*SMBSOMESERVICE\C$. So, if a DCERPC signature is trying to block the path name, it can be evaded by adding \\\\\\\\. In order to prevent evasion, the IPS device must be able to check for the presence of extra &lsquo;\&rsquo;s in the path name.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id2615636"></a>Bind to one UUID then alter context</h4></div></div></div><p>A normal RPC call with a bind request contains a UUID with a context ID. The function opnum is called using that context ID. An opnum is an operation number or numeric identifier that is used to identify a specific RPC method or a method in an interface [<span class="citation"><a href="#citation.14">14</a></span>]. To open a new context for a different UUID over the same connection, the alter context DCERPC command [alter_ctx()] can be used. The alter context request leaves the previous context &lsquo;on hold&rsquo;. Alter context is required since, after binding to a specific interface, binding to another one over the same connection using bind () is not possible. However, the signature, which checks context ID, can be evaded by using alter_ctx().</p><p>In the first step of evasion, the normal UUID is associated with a context ID. The IDS or the signatures &ndash; which are checking the traffic on the basis of context ID &ndash; allow the traffic as normal traffic. Then an alternate context call is used to link the vulnerable UUID with the original context ID. This is followed by a call to a vulnerable function containing the vulnerable interface (UUID), which is made by using the context ID. Since the detection device tracks the context ID associated with the non-vulnerable UUID, protection can be evaded by using alter context.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id4222562"></a>Prepend an ObjectID</h4></div></div></div><p>In a normal RPC call, the arguments or the stub data generally appear after the opnum. However, it is possible for the opnum to be followed by the UUID, which is followed by the stub data. A detection device should be able to parse both scenarios. One of the methods to check such scenarios is to look up the value of the eighth bit in the packet flag. If the value of the eighth bit is set, the detection device should skip 16 bytes and check the start of the stub data.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id3106493"></a>Bind with authentication field</h4></div></div></div><p>The Ctx field appears at the end of a normal bind request. The RPC protocol also makes provision for authentication of the client to the server, and the authentication fields (such as auth type, auth level) can appear after the Num Ctx. These fields will not be present in the normal bind request. If a detection device treats the extra bytes as an extension of the context ID it will generate an error. This can be avoided by checking for the value of the auth length in the header. A non-zero value denotes the presence of extra bytes in the header.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id4787701"></a>One-packet UDP function call</h4></div></div></div><p>The RPC handshake consists of a 20-byte secret number. This can be avoided by setting the idempotent flag in RPCv4 requests. If the flag is set, the 20-byte secret number can be avoided, also making it feasible to guess the request source. Since the flag allows the sending of the two requests as a single request, and if the IPS rules are dependent upon the handshake process, a signature can be evaded by setting the flag.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id2763664"></a>Chaining SMB commands</h4></div></div></div><p>SMB commands ending with &lsquo;ANDX&rsquo; can be chained. This leads to the sending, for example, of SMB_COM_TREE_CONNECT_ANDX + SMB_COM_OPEN_ANDX + SMB_COM_READ in a single SMB request. If a detection device checks for one SMB command in an SMB header, then it can be evaded by sending multiple chained commands. To prevent this, the detection device must check the value of the &lsquo;AndXOffset&rsquo; field &ndash; if the value of this field is zero, then there will not be any more commands.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id4743389"></a>Out of order chaining</h4></div></div></div><p>The AndXOffset field stores the next SMB command, and every AndX command has the offset in the packet to the following command. Hence the physical order does not have to match the logical order and an arranged packet can be built. The first command in the chain will be the first command in the packet. An intrusion detection device must have the ability to parse an SMB header with out-of-sequence command chaining; otherwise it will fail to calculate the number of SMB commands in the header.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id2610621"></a>Application-specific evasion in SMB</h4></div></div></div><p>It does not matter to <em class="productname">Windows</em> SMB implementation if there is more data than needed in a command. The AndXoffset contains the offset of the next command and it is possible to insert random data between the commands. A detection device must be able to parse it correctly.</p></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id2628668"></a>Conclusion</h2></div></div></div><p>There are a variety of methods that attackers can use to thwart IDS/IPS systems. We have discussed several of these. To recap, web servers support various encodings such as hex, double percentage, double nibble hex, second nibble, <span class="emphasis"><em>Microsoft</em></span> %U, and mismatch encoding. Detection devices should be able to decipher these encodings. To prevent evasion in SMTP, it is recommended that the IDS/IPS implement a bidirectional protocol decoder &ndash; that is, the decoder should be able to parse both the client and the server messages correctly. MIME provides an option of various encodings, and the detection device should be able to decode the traffic correctly. MSRPCH is an evasion vector for DCOM-related vulnerabilities. A detection device should also be able to reassemble the packets and inspect them; otherwise an attack can be spread over packets. The RPC protocol is also prone to evasion. RPC provides various options of sending commands such as Unicode, non-Unicode, big-endian and little-endian format. A detection device also should be able to decipher these formats.</p><p>In this article we have looked at some of the commonly occurring evasion methods. For effective protection it is vital for intrusion prevention and detection systems to have anti-evasion measures.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3373156"></a>Acknowledgements</h2></div></div></div><p>The authors would like to express their gratitude and thanks to Jimmy Kuo for his feedback on the article and to Patrick Nolan.</p><div class="bibliography"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4909931"></a>Bibliography</h3></div></div></div><div class="bibliomixed"><a id="citation.1"></a><p class="bibliomixed">[1] <span class="bibliosource"><a href="https://tools.ietf.org/search/rfc5321" target="_blank">http://tools.ietf.org/search/rfc5321</a></span>.</p></div><div class="bibliomixed"><a id="citation.2"></a><p class="bibliomixed">[2] <span class="bibliosource"><a href="https://www.ietf.org/rfc/rfc1939.txt" target="_blank">http://www.ietf.org/rfc/rfc1939.txt</a></span>.</p></div><div class="bibliomixed"><a id="citation.3"></a><p class="bibliomixed">[3] <span class="bibliosource"><a href="https://tools.ietf.org/html/rfc3501" target="_blank">http://tools.ietf.org/html/rfc3501</a></span>.</p></div><div class="bibliomixed"><a id="citation.4"></a><p class="bibliomixed">[4] <span class="bibliosource"><a href="https://www.w3.org/Protocols/HTTP/1.1/rfc2616.pdf" target="_blank">http://www.w3.org/Protocols/HTTP/1.1/rfc2616.pdf</a></span>.</p></div><div class="bibliomixed"><a id="citation.5"></a><p class="bibliomixed">[5] <span class="bibliosource"><a href="http://www.faqs.org/rfcs/rfc2047.html" target="_blank">http://www.faqs.org/rfcs/rfc2047.html</a></span>.</p></div><div class="bibliomixed"><a id="citation.6"></a><p class="bibliomixed">[6] <span class="bibliosource"><a href="http://www.faqs.org/rfcs/rfc2045.html" target="_blank">http://www.faqs.org/rfcs/rfc2045.html</a></span>.</p></div><div class="bibliomixed"><a id="citation.7"></a><p class="bibliomixed">[7] <span class="bibliosource"><a href="https://www.ietf.org/rfc/rfc1831.txt" target="_blank">http://www.ietf.org/rfc/rfc1831.txt</a></span>.</p></div><div class="bibliomixed"><a id="citation.8"></a><p class="bibliomixed">[8] <span class="bibliosource"><a href="https://msdn.microsoft.com/en-us/library/cc243950(PROT.13).aspx" target="_blank">http://msdn.microsoft.com/en-us/library/cc243950(PROT.13).aspx</a></span>.</p></div><div class="bibliomixed"><a id="citation.9"></a><p class="bibliomixed">[9] <span class="bibliosource"><a href="https://msdn.microsoft.com/en-us/library/cc201989(PROT.10).aspx" target="_blank">http://msdn.microsoft.com/en-us/library/cc201989(PROT.10).aspx</a></span>.</p></div><div class="bibliomixed"><a id="citation.10"></a><p class="bibliomixed">[10] <span class="bibliosource"><a href="https://www.ietf.org/rfc/rfc1945.txt" target="_blank">http://www.ietf.org/rfc/rfc1945.txt</a></span>.</p></div><div class="bibliomixed"><a id="citation.11"></a><p class="bibliomixed">[11] <span class="bibliosource"><a href="http://www.faqs.org/rfcs/rfc2822.html" target="_blank">http://www.faqs.org/rfcs/rfc2822.html</a></span>.</p></div><div class="bibliomixed"><a id="citation.12"></a><p class="bibliomixed">[12] <span class="bibliosource"><a href="http://www.faqs.org/rfcs/rfc822.html" target="_blank">http://www.faqs.org/rfcs/rfc822.html</a></span>.</p></div><div class="bibliomixed"><a id="citation.13"></a><p class="bibliomixed">[13] <span class="bibliosource"><a href="https://msdn.microsoft.com/en-us/library/dd304523(PROT.13).aspx" target="_blank">http://msdn.microsoft.com/en-us/library/dd304523(PROT.13).aspx</a></span>.</p></div><div class="bibliomixed"><a id="citation.14"></a><p class="bibliomixed">[14] <span class="bibliosource"><a href="https://msdn.microsoft.com/en-us/library/cc232137(PROT.10).aspx" target="_blank">http://msdn.microsoft.com/en-us/library/cc232137(PROT.10).aspx</a></span>.</p></div><div class="bibliomixed"><a id="citation.15"></a><p class="bibliomixed">[15] A look at whisker&rsquo;s anti-IDS tactics. <span class="bibliosource"><a href="http://www.wiretrip.net/rfp/txt/whiskerids.html" target="_blank">http://www.wiretrip.net/rfp/txt/whiskerids.html</a></span>.</p></div><div class="bibliomixed"><a id="citation.16"></a><p class="bibliomixed">[16] Multiple vendor MIME field multiple occurrence issue. <span class="bibliosource"><a href="http://research.corsaire.com/advisories/c030804-002.txt" target="_blank">http://research.corsaire.com/advisories/c030804-002.txt</a></span>.</p></div><div class="bibliomixed"><a id="citation.17"></a><p class="bibliomixed">[17] Multiple vendor MIME field whitespace issue. <span class="bibliosource"><a href="http://research.corsaire.com/advisories/c030804-003.txt" target="_blank">http://research.corsaire.com/advisories/c030804-003.txt</a></span>.</p></div><div class="bibliomixed"><a id="citation.18"></a><p class="bibliomixed">[18] Multiple vendor MIME field quoting issue. <span class="bibliosource"><a href="http://research.corsaire.com/advisories/c030804-004.txt" target="_blank">http://research.corsaire.com/advisories/c030804-004.txt</a></span>.</p></div><div class="bibliomixed"><a id="citation.19"></a><p class="bibliomixed">[19] Multiple vendor MIME Content-Transfer-Encoding mechanism issue. <span class="bibliosource"><a href="http://research.corsaire.com/advisories/c030804-005.txt" target="_blank">http://research.corsaire.com/advisories/c030804-005.txt</a></span>.</p></div><div class="bibliomixed"><a id="citation.20"></a><p class="bibliomixed">[20] Multiple vendor MIME RFC822 comment issue. <span class="bibliosource"><a href="http://research.corsaire.com/advisories/c030804-009.txt" target="_blank">http://research.corsaire.com/advisories/c030804-009.txt</a></span>.</p></div><div class="bibliomixed"><a id="citation.21"></a><p class="bibliomixed">[21] Vulnerability Analysis and Defense for the Internet, Springer Publications.</p></div><div class="bibliomixed"><a id="citation.22"></a><p class="bibliomixed">[22] Caswell, B.; Moore, H.D. Thermoptic Camouflage Total IDS Evasions. <span class="bibliosource"><a href="https://www.blackhat.com/presentations/bh-usa-06/BH-US-06-Caswell.pdf" target="_blank">http://www.blackhat.com/presentations/bh-usa-06/BH-US-06-Caswell.pdf</a></span>.</p></div><div class="bibliomixed"><a id="citation.23"></a><p class="bibliomixed">[23] Legiment Techniques of IPS/IPS evasions. <span class="bibliosource"><a href="http://null.co.in/papers/legiment_ajit.pdf" target="_blank">http://null.co.in/papers/legiment_ajit.pdf</a></span>.</p></div><div class="bibliomixed"><a id="citation.24"></a><p class="bibliomixed">[24] HTTP IDS Evasion Revisited. <span class="bibliosource"><a href="http://docs.idsresearch.org/http_ids_evasions.pdf" target="_blank">http://docs.idsresearch.org/http_ids_evasions.pdf</a></span>.</p></div></div></div> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=Evasions in Intrusion Prevention/Detection Systems&url=https://www.virusbulletin.com/virusbulletin/2010/04/evasions-intrusion-prevention-detection-systems"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2010/04/evasions-intrusion-prevention-detection-systems'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2010/04/evasions-intrusion-prevention-detection-systems&title=Evasions in Intrusion Prevention/Detection Systems"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2010/04/evasions-intrusion-prevention-detection-systems&t=Evasions in Intrusion Prevention/Detection Systems"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2010/04/evasions-intrusion-prevention-detection-systems"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p></p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td></td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td></td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td></td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td></td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
 <div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">1989-2022 Virus Bulletin.<a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a><a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a><a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>