{
    "V_HwRtUk5tI": [
        "[Music]",
        "[Music]",
        "thank you",
        "[Music]"
    ],
    "qIzMKfOmIAA": [
        "foreign",
        "Park Android puzzles the bad the good and the better introducing Android safer puzzle my name is Hal I'm a security engineer from Google's Android malware research team in Android platform security at Google",
        "hi my name is Yang I'm a security engineer at the Google vulnerability reward program",
        "also a special thanks to Maria and Kevin who did great work making this presentation happen",
        "in the next 40 minutes we will walk through the Android puzzle mismatch for problems and cover an overview of known exploit techniques that abuses possible vulnerabilities including the technique known as bundle feng shui and the noble exploit chain identified in Android 12's better version that introduces arbitrary code execution in privileged processes also known as cve 2021-0928",
        "from there we'll share with you how Google's Android security and privacy AKA ASAP team worked on securing Android from this type of vulnerability the security hardening changes we made for Android 13 and why after that we will spend some time sharing insights about our Android vulnerability Rewards program and how we work behind the scenes at the end if time permits will take a few minutes for questions so first what is possible parcel can be thought of as a container for sending serialized slash parcel data across",
        "processes in another word puzzle is the container of a message for inter-process communication also known as IPC the parcel can carry different types of data including common string integer bytes Etc and besides that possible is a special type of data that can be carried in puzzles so the usage of possible Works in a way that senders can invoke the method right to parcel to serialize possible into puzzle while receivers can invoke create from puzzle to deserialize and construct possible from the data stream",
        "and with impossible there are containers that can carry arbitrary typed data these containers are arrays lists Maps",
        "sparse arrays Etc",
        "when digitalization or we can call it as a read happens on these containers the the reader will visualize everything within the container that includes any possible or serializable that lived in the sub containers let's take a look at this example at the bottom so starting the read procedure first it will visualize you know the string ABC the integer one two three the possible P1 then it will visualize the list L1 list L1 is a possible container I mentioned before and next in turn are whatever within list L1 it is string XYZ integer three two one Etc what's more list L1 can also embed other containers in this example we have the map M1 that will also be deserialized So eventually every entry",
        "in this diagram gets deserialized",
        "now what can go wrong in Puzzles now let's take a look at this code snippet it's less than 10 lines of code but it actually contains an inconspicuous and",
        "impactful mistake that could result in a Possible's right mismatches with its read when integer F1 is less or equal than zero the if clause on the right hand side in the red box will be no opt no read write array will be invoked this one simple mismatch would actually snowball into a sequential Corruption of parcels read take a look at this following diagram when receiver reads",
        "the First Data short will sequentially read all the following data from the wrong offset if there are no crashes or exception happens next we will have Bernardo to explain the self-changing bundle technique",
        "Bernardo",
        "thanks Hal so the mismatch is that how we introduce can be leveraged into so-called self-changing bundles first bundle is a serializable map over parcel self-changing bundle is a bundle whose content changes after round officialization then visualization in",
        "this example here B is the original bundle we are serializing B then this realizing it back and assigning to C simulating sending B over IPC",
        "at the end if the content of B is logically different from the content of C we have a self-changing bundle",
        "so before analyzing the actual exploits let's put the black hat on play the attacker and try to leverage this mismatch into a self-changing bundle so looking at the vulnerable participle on the right we can see that we read an in four bytes but we write along eight bytes this was actually one mistake that we've seen in one of the reports the idea is to leverage this in the following IPC flow involving three processes a b and c so first a sends the bundle X to b b inspects the bundle X at the time of check and sends it to C finally C uses X at the time of use",
        "so the challenge is to hide one item in the bundle from B that's going to be revealed to see that item is composed of the key intent and the value 42 that happens in Android 12. so this table represents the parcel content of the bundle the left side of the table represents the data before the first visualization in b b dance realizes that data back resulting on the right side of that table before the second visualization that happens in C",
        "looking at the left side of the table we're going quickly through the structure we see that the three the first three rows there represents the bundle header followed by the the key of the first item in yellow followed by the value of the first item in blue and so forth so the first item of that bundle is the vulnerable parcel we've seen before notice the zero at the end there we're going to read that zero but we're gonna write two zeros because remember we are writing along while we read an INT when reading the right side of that table at the second digitalization we're going to stop reading the first element at the first zero there leaving the second zero as the beginning of the data for the next item this will change the entire interpretation of the bundle from that point forward hence the red background there",
        "so",
        "the trick to produce the self-changing bundle is to choose values for X Y and Z such that content that's meaningful to one digitalization is irrelevant and opaque to the other starting with the hidden element that's meaningful to the second digitalization we hide that under a byte array on the left so we choose Z to contain the length of that hidden element I'll leave X and Y as an exercise to the reader this with Minor Details of media this is the final table of the exploit note at the bottom that the hidden element is hidden under a byte array on the left but in turn the metadata of that byte array is also hidden under another byte array but this time on the right I'll skip through the rest of the content so finally putting all that into code I'll leave the code here as reference but that code is basically constructing a parcel from the left side of the table from the previous slide at the bottom we are destroyalizing that parcel into a bundle printing that bundle the bundle a then we are serializing it visualizing it back to bundle B and then printing bundle B the output is shown on the right as we can see the hidden element is only displayed in bundle B after the second digitalization while in bundle a we can't see the hidden element",
        "I'll let how continue",
        "thanks Bernardo um so the self-changing bundle technique described by Bernardo can actually turn into a smart time of check time of use attack against Android's account adding you know Android has this workflow for an app to add an account that can be simplified by this sequence diagram the ad account workflow is actually a three-partis business including the application needs to add account and account manager service and settings app are the one to fulfill the request of adding the application can kick start and add account operation and implement the actual ad account method providing a bundle containing information about how to add such account the interesting part starts from Step number five where the app sends a bundle that is fully constructed by itself to a complemented service in Step number six in the middle account manager service checks and intent entry within that bundle and sends it to send that same bundle to settings settings app will not do the check intent anymore it will just launch the key intent directly",
        "well we saw a bundle came we checked the intent then we launched but this is a classic time of check time of year scenario where the bundle checked in account manager service could be different than the bundle visualized by settings due to the self-changing bundle technique described by Fernando earlier",
        "and this eventually contributed to the exploit technique known as launch anywhere where the attacker can have the privileged app in this case is settings settings app wrong with the shared system uid to launch arbitrary intents and this can lead to serious problems including silent package installation which was not only used in our campaigns in the past we will not cover the malware in this talk the launch anywhere exploit has been very commonly used as a proof of concept impossible which one the impossible mismatched vulnerabilities we received throughout the years now let's welcome Bernardo on the stage again to talk about how we mitigated this type of exploit we learned many things from the bond of feng shui let's start with the mismatches we've been fixing individual read write mismatches for years and will likely continue we should still fix those because regardless of the other fixes we put in place they are still bugs and there could be other cold paths that leverage them into exploits however the lesson that we learned there is that only fixing the mismatches simply doesn't scale we have too many of them so the natural generalization of the figs would be to look into account manager service which is the code path used by many of those exploits that Hal talked about so borrowing house diagram from before and focusing between steps number six and seven after the time of check but before the time of use in system server we're going to simulate the IPC to settings by serializing and this realizing that bundle then we're gonna check if the relevant item is the same before and after the simulation if it's not you're gonna fail and log I'm going to leave the code here as reference now that's good but what about other code paths future code paths we can't explain expect platform developers to proactively simulate digitalization and",
        "be aware of this issue so we turn our attention to bundle what's wrong with bundle well the first problem is that the bundle structure is implicitly defined by the items their payloads and the code that this realizes them this is what allows the creation of the self-changing bundle the second problem is that the digitalization of bundle is eager upon first retrieval we'll go over these in detail and see how we arrived at the lazy bundle so the first um the first item there we've seen this when we explored the mismatch um but let's revisit with a simpler example let's assume we're inserting two Parcels into that bundle P1 and P2 the cylinder there represents the backing parcel of that bundle the left side represents the read the rights and the right side represents the reads so after the header we insert the first key then we insert the bytes of P1 then the second key then the bytes of P2 but now assume there's a mismatch in the class of P1 such that it reads less than it writes now at on the right side we read the first after the header we read the first key we read the bytes of P1 but now we we read last bytes than before so when we start reading the second key we're going to start from the wrong offset and as we've seen before this will change the entire interpretation of the bundle now this was caused because the boundaries of the bundle or is the structure was defined by the payload and the code that this realized it so how do we fix it the idea is to prevent the mismatch from one item to a from affecting the other item to do that we're going to prefix each item with the number of bytes used during its serialization so that during this realization we can skip over the payload and start the read of the next item from the correct offset regardless of how many bytes we would consume if we were to digitalize the previous item conceptually this is equivalent to separating the section of each item in the backing parcel as shown there so in that example even if we read less bytes for P1 the read of P2 is not affected",
        "so the second item the initialization of one first retrieval previously without blank prefix we'd need to read all the preceding items in order to know the offset from which to start reading the current item that means that exceptions thrown during the read of those preceding items would be thrown when pairing the current item in that example there we have no way of knowing the offset from which to start reading P2 other than reading P1",
        "now with length prefix we can skip those preceding items to figure out the correct offset from which to start reading the current item that means that those exceptions that could be thrown during the digitalization of those preceding items won't be thrown when the current item is queried anymore",
        "this reduces system crashes which helps with DOs attacks and system stability and the other nice obvious side effect of this is that we only read data when we need to this is why it's called the lazy bundle now let's look under the hood and Android 12 and 13 and see how this is implemented so the first thing to note is that bundle can be in one of two states in the parcel form or in the map form in the parcel form bundle holds a reference to the backing parcel that contains the data for the items in the map form bundle has a map from key to item now focusing on the difference between Android 12 and Android to your team we see that in Android 12 whenever we query any item from that bundle the entire bundle is digitalized and the items are converted into live objects in contrast 2013 in Android 13 when we",
        "query for example the first item only the first item is dclized the other items are held in the in the map as lazy values lazy values are containers that hold the reference to the backing parcel and have metadata necessary to visualize each item",
        "so looking at this example we have a bundle with three items the first two are well behaving while the third item crashes upon this realization",
        "so if you look at a code there that code is retrieving the first item which is supposed to be a well-behaving item in Android 12 even if you're querying the first item we're going to digitalize the entire bundle which is going to mean that we're gonna throw because the third item crashes in Android 13 that won't happen anymore because we only destroy the first item the third item is held as a as a lazy value in that map",
        "and I'm gonna hand back to how thanks Bernardo for explaining how we address the bundle feng shui type exports now among all the possible mismatch issues reported through vrp program besides the majority of them actually use the POC within the bundle feng shui exploits we have received a brilliant novel exploit chain of getting arbitrary code execution in privileged applications processes in 2021 just slightly before Android 12's official release the vulnerability was reported and pocified Mahal banaski who is one of our top security researchers participating in the Android vrp program let's take a look at how it worked to understand the exploit we first need to know some details about the Android inter-process communication scenario one",
        "example of Android's IPC is that applications can send broadcasts to a different application but what happens under the hood of the broadcast well it is actually another three-party business",
        "including the application sends a broadcast system server resolves such broadcast and it will send to this target application that actually implements the broadcast receiver it can be simplified by this sequence diagram",
        "um pay attention to the middle section here the system server deserializes the intent that is received from the sender app after resolving that It prepares another remote procedure called RPC called the schedule receiver with the visualized intent parameter that is Center controllable followed by System server generated parameters including activity info",
        "sorry among all the system server prepared parameters the activity info is the most noteworthy one this parameter actually has a source stir value that is supposed to point to the targeted applications app directory which is used to create the target applications class loader so in short if an attacker can tamper with the source dirt value within the activity info param the attacker would be able to have the target application to load and execute arbitrary code in another word the object code execution is all about controlling the activity info parameter",
        "and it all originated from this code snippet it's less than it's around five lines of code it may look just like a classic try catch but the inconspicuous problem here is that if there are any exception happens within the try clause uh what does the try Clause do the try Clause is doing the digitalization work that is reading from the Apostle to reconstruct an object now if any exception happens there it this would not crash because the exception is caught but the object the output configuration objects read would abruptly stop right there",
        "so this was the expanded code submit snippet for output configurations deserialization it does nothing fancy it's fancy it just reads the object field sequentially note the last field in the snippet is called sensor pixel modes used this Apostle container it's a list if we can trigger an exception in the read list the read would stop right there leaving some left over data at the bottom all right now let's start to put pieces together remember the activity info object is what the attacker goes for and it is read right after the intent object and remember that intent is coming from the user input in previous slides we had this idea of having something to read stop before consuming all the data and if we can have the intense read stop earlier the victim app on the right hand side would read the following parameters starting from the wrong offsite on wrong offset",
        "um yeah take a look at the right hand side the activity info is read from the attacker control buffer if that happens and that is how the arbitrary code execution worked out so as a recap system server prepares a",
        "possible object for the schedule receiver RPC method with parameters as intent following by activity info when",
        "victim app visualizes such parcel received from system server exception happens then intent stop uh intense read stopped earlier remember exception is called digitalization continues the next parameter it reads is active info but from the wrong offset starting in the leftover data section that is attacker controlled next thing that happens is arbitrary code execution to develop such exploit there are two prerequisites first the attacker needs to trigger Inception second the attack the hacker needs to embed the payload which triggers the exception within the intent object for the first prerequisite the POC Mahal banoski developed uses the class not found Exception by embedding a system server specific class",
        "and for the second prerequisite building the POC within the intent object this is only made possible by a change introduced in Android 12 which included",
        "an activity info field within clip data clip data is another field from intent so this is roughly how the intent object would look like in Android 12. within the intense object it contains a clip data field within clip data it contains an activity info field within that it embedded an application info field that invests a split dependency field well this all sounds complicated object in object in object and object but what's important is that the split dependencies is a sports array and now if you remember Sports array is one of the possible containers that can contain arbitrary typed data and they all get visualized in the read",
        "we have to Omit a few details due to the time constraint but the final PLC intent look like this a package manager exception bomb is embedded within the payload that is nested within the split dependencies the password container we saw in the previous slides so visualizing such intents within the victim applications process would trigger exception and exception is called so this the read would stop right there when the victim app you know the target application with the broadcast receiver reads this it reads the first red box as the first param intent then it would reconstruct the second param the activity info from the wrong offset and so on the POC eventually would leave some data in the end not red more details about this POC can also be found at Mahal banaski's GitHub repository linked at the bottom now let's welcome Bernardo again to talk about what we learned from this this exploit and how we fix the problems well there are many things to unpack here how do we fix all that so first we start by applying the targeted fixes so you fix the exceptions following we fixed the mismatch between the read list and the inter-ray and remove the activity info from clip data from the internet but now let's try to generalize The Fakes the first thing to notice here is that lazy bundle doesn't help because the new exploit doesn't involve bundle so let's look into each exploit and see their differences and similarities so looking at the legend on the left side here um a blue rectangle means trusted data a light red rectangle means untrusted data a bright red rectangle means untrusted",
        "data that's assumed to be trusted and that's the problem in both exploits and the yellow rectangle just means system server trusted process so in the bundle feng shui we see that the bundle has always been attacker controlled however the system checks that bundle for verification after the bundle passes that check it's considered to be trusted but the problem is when we hand off that bundle to settings the mismatch inside the bundle is able to change the bundle because it becomes a self-changing bundle now the data changes and is untrusted but settings assumes that the data is trusted and that creates the problem here in the novel exploit the parameter 0 has always been an attacker controlled and assumed to be untrusted even in the app the problem is the parameter 1 originated from a trusted object inside the system the problem is when that IPC happens and both parameters are put together the mismatch in parameter 0 allows the attacker to taint parameter 1. so the app assumed that parameter 1 was trusted but in fact the content changed so it's untrusted now and that creates the problem there so despite the differences there are some similarities here similarities the similarity is that",
        "a mismatch in one element affect the next element and in bundle that happens across the bundle items in the novel exploit that happens across IPC parameters so a natural idea would be to prefix the length of IPC parameters or prefix the length of every parcel Bolt",
        "and this is actually where we started before the lazy bundle so can we prefix every parcelable or IPC parameter well",
        "in most binder apcs in Android that involves a manually written IPC interface whose Java code is automatically generated for us",
        "um the code inside that red rectangle there is responsible for serializing industrializing in that case it's only digitalizing the parameters the IPC parameters of that interface according to their types the mapping between type and code involved into their serialization in digitalization can't be changed in a backwards compact way",
        "the methods write to parcel and create from parcel are part of that mapping and those methods are the methods designed to be overridden by possible implementations that means that we don't have available hooks to prefix the length",
        "one solution out of this backward combat problem would be to make this change obtain but making this change obtained would severely reduce its impact and on top of that their performance considerations into prefixing every possible nipc parameters across the",
        "entire platform so because of that this fix is not feasible in practice",
        "so we turn our attention to validation across domain specific code and infrastructure code we weren't doing enough validation for example in domain",
        "specific parcelables often the create",
        "from parcel method assume that the data was produced by the rights of parcel method but that's not necessarily true incoming data should be considered untrusted and properly validated",
        "and an infrastructure code we were missing stuff too for example let's look at the parcel class remember when Hal talked about the arbitrary decilization parcel container I'm bringing here an excerpt of a piece of code from the Nova exploit even if the caller expects the list of a certain item type nothing prevents items",
        "of another type from being visualized out of that list in the first example there in application info which I wrote with three p's there should be only two the split dependencies field is a sparse array of interrays but the attacker is able to insert a Zen policy item there looking at that in more detail the first item there in the first sorry in the first line of code we happily digitalize in policy as an item but we know that split dependency in Split dependencies only holds into arrays in the worst case this enables attacks like this cve but even in the best case the no malicious case this will likely cause exceptions later on when the code assumes to be dealing with interface it's likely it's likely going to throw Class cast exceptions or other Pro create other problems so the idea is to validate the type that we are about to digitalize make sure that that type is expected by the caller",
        "so due to Java generics type Erasure we",
        "introduce wholesale replacements for across parcel bundling intent apis the new apis take an extra class parameter that represents the type we're going to use that class parameter to validate the type that we are about to digitalize is expected by the caller and we deprecated the old apis",
        "now we need to migrate a good chunk of code in the platform in order to benefit from those new apis and protect the platform so how do we migrate almost 700 call sites well for each call site you need to infer this static type by surrounding code then replace the call with the calls the new API with the added class parameter",
        "in order to do that at scale without menu intervention we leverage Android lint we wrote a checker and after moving some files around we were able to migrate close to 700 call sites reducing the attack surface of vulnerable possibles in the platform",
        "that's good the other check the other change that we implemented in infrastructure code is the parcel and the file check in IPC interfaces as we can see as you saw before we can't enforce boundaries in IPC parameters but there is one relatively cheap fix that we can do and that is to verify that the parcel was fully consumed after unpacking IPC parameters before calling",
        "into the IPC method this is not a strong mitigation because depending on the cold path the attacker could craft a parcel",
        "that seeks to the end of the data after unpacking parameters but this is a cheap check it's a correctness check and depending on the code path that could be helpful and this also uncovers mismatch",
        "and security issues along with non-security bugs as well as we've seen during the development of Android 13.",
        "so borrowing house diagram again looking",
        "at the right cylinder which is in the attack scenario we can see that if we finish unpacking parameters at the red line there but to leave leftover data the idea is to check that there's no leftover data there so this is a Java generated code from that IPC interface um the code inside the red rectangle is unpacking the parameters on the incoming parcel right after that code we're calling enforce no data Avail that's the euf check we're talking about so looking at the diagram on the right there the cylinder on the left ends after unpacking parameters so that",
        "passes the check while the cylinder on the right still has leftover data after unpacking parameters so in that case we throw so it's worth noting here that we are throwing more than before with this change and when we talked about lazy bundle we said that we reduce system crashes because those helped the reducing system crashes help with DRS attacks the difference here is that leftover data in the parcel is indicative of either an attack or corrupt data both of which are worse than failing early and crashing early",
        "so the last mitigation we put in place was mismatch detection at runtime and we leveraged the lazy bundle to do that since now we have the link prefix to be able to check so to recap we apply the targeted fixes we looked at validation domain specific code and infrastructure code we introduce wholesale replacements for across parcel boundary and intent apis that take an extra class parameter migrated a good chunk of the platform we introduced the parceland of file check and IPC interfaces and we implemented mismatch detection at runtime",
        "now Yang's gonna talk about vrp",
        "uh thank you Bernardo thank you before we conclude this talk let's look at the history of personal mismatch where the problem started and how creative has been from the ecosystem perspective the first report on parcel mismatch was received by Google back in September 2014. and it was before the Android vulnerability reward program was established his first it was reported by",
        "mihal badenowski and his first report already contains the bangle feng shui how entrepreneur explained earlier",
        "in 2016 the Android viability reward",
        "program established since then more than 28 exploitable parcel mismatch was reported to the program was reported to the program five years later now we still seeing report in this area and in fact this year we have a six exploitable parcel mismatch hopefully the safe password work will put an end unless a eight-year long long",
        "lived exploitation by making the parcel and bundle serialization safer",
        "please also note process mismatch is not theoretical concern just like how mentioned earlier we have seen some vulnerability was built in the malware the malware can certainly to update your update package without any interaction",
        "Eternal research report are one of the input to Android vulnerability queue we also have other findings as you see on the chart on the left through the writing engagement continuous fasting and automation Etc we triage thousands",
        "of reports each year we provide security reading that are taking into account the consequence of the exploit and real user risk",
        "based on what severity reading all the exploitable person mismatch has been readed as a high because of because it's allowed to launch arbitrary activity as a system user system user with UI demands out that is about the most privileged user on the platform it could be used to install the arbitrary package or reset the lock screen password Etc",
        "so as many of you know are probably contribute the Android operator",
        "evaluated reward program on top of that we also have four exploitation reward program me house amazing work on novel exploration was qualified into the arbitrary code execution in the privilege process the reward amount can up to a hundred thousand US dollars that amount may be adjusted based on the initial attack Vector reliability of attack the attack is the only targeting to the specific view of across the whole ecosystem",
        "so I also want to take this opportunity to give you a peek behind the curtain how vulnerability like a person which might make his way from the researcher right up to the security updated Android device once you receive the report we first go through the reproduction process where we want to validate the proof of concept code is provided we produce the same as research reported we want to make sure when we do the security analysis we see the same things as researcher is foreign",
        "activity as system user",
        "once the reproductions are done Android security engineer will analyze a write-up and the reason recollection log and click any necessary information to determine the severity reading whether it's a critical High moderate low another security issue that we including the security update once the fixed the severity reading according to determines research reward amount and also the uh and also how we prioritize the fixed and release once the fix is developed and we could we need to make sure the fix going to be shipped to all the Android partner Cloud ecosystem High severity back like a parcel mismatch will be shipped in the next available security bulletin we release the security bulletin once a month with a collection of security patches of the Android OEM will take and ship to their user so during the triage process if we identify the issue is potential exploitable we'll work closely with the malware team see whether we can create some detection on the Play Store in parallel to the back fix and also in addition to do the target effects as the venerative report it is we also look at the nature of the issue and the trend of the report uh try to identify any systematic way to improve Android security such as through the API hardening system mitigation with the target fighting Target like even Loop into the writing to do like a in-depth review of the critical software component",
        "so by reporting your vulnerability our exploitation to our program you not only help protect the whole Android ecosystem make some money and get cve you also have a chance opportunity to influence the direction of the Android security so please join our program and have feedback hunting thank you I think we only have 10 seconds okay so we'll off we'll answer the question offline we'll be here thank you thank you everyone [Applause]",
        "[Music]",
        "[Music]"
    ],
    "Dxqb-q2OjoM": [
        "foreign",
        "welcome I'm going to talk about attacking Kerberos as it's used in",
        "Windows Active Directory",
        "from a small theoretical crypto bug to",
        "eventually turning that into a practical exploit",
        "my name is Tonto forz I work for sa pen",
        "tester and vulnerability researcher for Sakura a security specialist based in the Netherlands in a subsidiary of Bureau veritas uh two years ago I discovered the zero logon of vulnerability which was due to a crypto bug in ad that turned out uh to have some pretty big consequences uh and it also got me it's all cats uh black hat USA so I thought well Windows uh active directory crypto stuff seems like a nice research area maybe it can get me into blackheads again and uh well it did so uh first I'm going to give a brief introduction about Kerberos",
        "um and the specific uh encryption type uh where I found a vulnerability uh then I'm going to relate that to the protocol where that's vulnerability can actually be exploited the uh pack protocol uh showing how to exploit it uh",
        "then exploiting it in a different manner and seeing what we can actually do with that and how well Microsoft responded to this and some lessons learned",
        "ah so Kerberos is a network Authentication",
        "Protocol uh it was originally designed by MIT in the late 80s but probably the most common implementation in practice is actually active directory which uses Kerberos for Authentication and the main idea behind it is that members of a network can authenticate to each other without having to send passwords to each other but instead there's one single Central Surfer a key distribution center in active directory that's domain controller and they maintain shared secrets in the form of cryptographic keys that I share with every single member of the domain so when Alice wants to uh log in to Bob or to communicate securely with Bob Ellis asks this KDC uh",
        "Hey I want to talk to Bob KDC says okay here is a so-called tickets and a ticket is really just an encrypted message intended for Bob that only Bob and the KDC themselves can encrypt for Alice cannot decrypt it it's just an opaque a block of bytes so then Alice passes this tickets on to Bob Bob decrypts it and sees inside the tickets okay the owner of this ticket is named Alice has these privileges and then Bob knows that this is else this of course Very simplified um but what's important here is that um the type of encryption that you can use to make these tickets and to run the various steps of the protocols um there's various options there um over time these changed and I'm going to zoom in on one specific encryption type namely rc4 hmac",
        "so the rc4 hmac or the rc4 hmac md5 type is one of the three standard default support encryption types in Kerberos and windows but it generally also supported by MIT or Heimdall implementations because they have to interact with Windows there's also desk encryption types and a bunch of others but in a default active directory setup you won't see those um and any and someone who is familiar with cryptography uh and sees this name May uh well this may erase some red flags first of all we have rc4 uh a stream Cipher that is well known to be broken and by broken I mean is that the key stream it generates has statistical biases and that means that if you encrypt the same uh the same thing a lot of times um eventually you may be able to recover this uh plain text uh so that's already not very good in an Authentication Protocol of course actually exploiting this aspect in in Kerberos there's not that many uh static secrets that are encrypted uh with the same key A lot of times uh seems a bit difficult but still uh potentially problematic",
        "another red flag is md5 md5 is a hash function uh where it is possible to compute collisions so two different inputs that produce the same hash that's not something you want a hash function to do uh but luckily uh they also use hmac and this is the one uh cryptographic primitive that shouldn't raise red flags hmac is actually great it's um converts a hash function into an cryptographic authentication function a message authentication codes or Mac",
        "um and if and it works well even if the hash function in question is no longer Collision free so hmd5 by itself is a",
        "broken hash function but when you combine it with the hmac instruction it is still a perfectly adequate authenticator there are no known practical attacks on HVAC md5 whenever it's used correctly uh well besides these",
        "potentially Troublesome Primitives",
        "there's also some known issues with this Cipher and it mostly has to do with the way it actually derives the uh encryption key which is based on the user passwords and specifically the ntlm hash of a user's password that's also used for legacy ntlm protocol and also the thing that's domain controllers store uh one of the problems is that once you have an antelam hash obtained to some other means you can uh you can already request a ticket you have enough material to authenticate a so-called overpass the hazard hash attacks which is very useful for pen testers also the key derivation function it uses to turn your ntlm hash into an encryption key and also nclam itself neither of these are built to resist a dictionary or Brute Force attacks you can compute them very efficiently so you can try millions of passwords and click succession and see which one matches the key so once you obtain something encrypted with the passwords you can go brute forcing very easily and figure out which password the material was encrypted with and it's used to make kerberosting attacks a lot more efficient",
        "um there are also some downgrade problems where you could uh cause her first to use the uh this week of Cypher for encryption and there's also a very interesting reason to take by James Forshaw that involved downgrading",
        "um active directory to a legacy variant of the cipher that didn't include the hmac md5 part so basically it was unauthenticated rc4 and it allowed you to do all kinds of interesting attacks um and also because especially due to the use of rc4 and generally you this Cipher is recommended against um it's deprecated uh by CIS benchmarks and rfcs but if you have a standards Windows setup and to be fair almost every active directory instantiation I encounter in practice this Cipher is still supported as some fallback function uh specialist fallback functionality when the more recent ciphers are not available",
        "so what I was interested in because most of the uh prior weaknesses uh well mostly about the key derivation or like variants of this Cipher I wanted to look at how this mechanism was designed itself um rc4 hmac as used in Kerberos is defined in RFC uh 4757 and it defines",
        "four different algorithms",
        "um one or two message authentication code",
        "algorithms and two authenticated encryption algorithms the first two are",
        "used within Kerberos related protocols themselves and the second two are exported through the GSS API which basically a standardized interface to do encryption to other protocols like",
        "RPC protocols ldap win a rem and the",
        "like and usually well off the authenticated with Kerberos you can negotiate a key and then these protocols can then use these algorithms to perform",
        "transport encryption for example uh probably the most important of these functions is the encrypt function because that is actually used to create Kerberos tickets",
        "um so I started to take a look at the specification and how these different algorithms were defined and I already noticed something that looks a little bit problematic here and maybe some of you will already be able to spot it and this is this the checksum function it's basically to provide a cryptographic authentication within Kerberos protocols themselves and what I noticed here is that um this function takes uh well a type indicator and the data it wants to authenticate computes an md5 hash over this data and then calculates hmac and D5 over this hash so it hashes first and then does hmac again well if it would just hmac the data directly there would be no problem but in this case well md5 is vulnerable to Collision attacks so if this data if you have two different pieces of data and they would collide uh you would be hmacking the exact same hash so even though hmac itself is secure even when used with amd5 if you try to hmac and md5 hash",
        "um and you have two inputs that's uh whose md5 hashes collides you'll also get a checksum coalition which basically means there's a theoretical forgery attack possible here that was not just the case for just a checksum function also the two GSS API functions uh basically had the exact same uh problem uh they would first compute an nd5 hash of the data and then they would authenticate that nd5 hash so if you could have nd5 collisions in your data you could have collisions in your authentication tag in the case of the encryption function it would allow a type of chosen ciphertext attack as well um the only function that was not vulnerable luckily or maybe not so lucky for me was the most important one the one to create gerberos tickets this one actually used hmac md5 properly I didn't do any pre-hashing so um this one was not vulnerable at all so any kind of collision attacks would not work directly on Kerberos tickets only on any kind of mechanism that used the other functions",
        "also the other problem with actually trying to exploit this theoretical vulnerability is that there are some constraints in what you can actually do with an nd5 Collision there's different types of collisions you can compute the uh the one that's really cheap and efficient is a so-called identical prefix Collision there you pick some prefix or message you choose yourself and you do the computation and you get two different variants that have some uh well basically random data appended different random data you can also add some suffix to that and these two messages available have the same prefix and suffix the random part in the middle will be different so you have two different messages with the same hash and that can be if you employed carefully and depending on the protocol you can do useful things with this but it's pretty restrictive uh basically the most powerful known Collision attack is it chosen prefix Collision there you have two completely different prefixes then you do an X more expensive computation well expensive",
        "let's say on commodity Hardware takes a few hours it's it's not that uh infeasible",
        "um you do some calculating you produce a lot of random bytes that you add to both messages and then you create two messages with these two different prefixes that you picked a lot of random garbage data and they have the same md5 hash and afterwards you can also add the same suffix to both messages",
        "um and yeah you have two different messages with a lot more control that have the same md5 hash unfortunately what you can't do is you",
        "just have some message with a certain hash that's defined by someone else uh in this case uh you would have hxm computed over some interesting message and you just come up with another message that happens to have the same hash that would be a type of free image attack and no practically executable",
        "pre-image attacks against nd5 are possible so we can't just get grab some authenticated message come up with something else with the same hash and attach the attack again so we are pretty Limited",
        "so let's say we want to exploit this uh these vulnerabilities uh we need to find a scenario where a",
        "number of um uh constraints apply uh we need",
        "to be able to prepare two different messages that have the same md5 hash that here is like an identical prefix Collision or a chosen prefix Collision so they will probably include a lot of random data in the middle their suffixes must be identical you can only control their prefixes really and the first of these two messages actually needs to be produced or authenticated by a server",
        "um so if you have this Jackson function the server needs to be executing the detection function on this first message including all these Coalition bytes",
        "um this is probably the trickiest part of the attack like there's a famous attack against x509 certificates that was also used by the flame malware back when it was still possible to have nd5 signatures in there in those certificates there's a serial number and the tricky part is when you request a certificate you cannot determine the serial number so the attackers actually had to do a lot of effort in trying to guess what the schedule number would be and pre-computing a lot of collisions and here there's some similar issues you need to be able to get something uh authenticated that you can completely predict but that you have to pre-compute so when when a surfer gives you this M1 message you can then well take the authentication tag from that and put it on your other colliding message and then this other message needs to give you some achieve some kind of attack or goal because if the attacker already knows the key well this is not very useful and if an attacker is capable of getting M1 signs there needs to be some other M2 that they cannot get signs through other means uh so yeah the challenges here are you have to find um basically uh something that will produce this first type of message this first type of message needs to complain a lot of random data that you control and you need to break some type of security boundary so with this in mind I started going through uh active directory protocols trying to look for something that used any of these functions I use them in a way where this attack and all these conditions May potentially apply",
        "and that's where I landed on the back signature protocol",
        "um this is a open protocol specification for Microsoft and I noticed uh on a page there's a feature called a pack signature and it makes use of the vulnerable checks and function that I showed you before so the Kerberos authentication mechanism that first computes an nd5 hash and then does an hmac this is part of the so-called spec protocol the privileged attribute certificates this is basically a Windows extension to Kerberos to provide authorization information inside the tickets because Kerberos by itself only provides authentication and it gives you like an identifier of who's trying to log in but it doesn't really tell any surface what the Privileges of that user are that's basically an extension that's left up to implementations so in active directory a pack data structure is used",
        "and this data structure is embedded in an already encrypted ticket and what's in the part that interests me are these signatures on the data structure so first of all there is a surfer so-called server signature which uses the same key that's already used in that encrypted tickets and there is a KDC signature",
        "um that is made by uh the prb TTT key which is a key that only the domain controller knows and what's interesting here is that normally you would say well this is already part of an encrypted tickets if I get a ticket I should not be able to decrypt it or mess with any contents of it so the pack should already protect it so why are there is there still any cryptography being done here now according to the documentation this is to facilitate a functionality called pack validation and that addresses back spoofing uh well guiding against certain",
        "types of privilege elevation attacks in certain contexts so there are cases when you actually are in a position to mess with the pack in uh in a checkup like you have and this security feature is supposed to prevent this so okay apparently you can achieve interesting uh uh goes with this otherwise the security feature would not be here so let's take a look at how we could use this uh cryptographic vulnerability to spoof one of these back data structures",
        "so first of all we need to get a lot of random bytes inside our back data structure and then gets the domain controller to authenticate it for us",
        "um when you're a you have a low prefetched domain user you can't really contain the contents of your own pack you can get a copy of your pack that shows you all your privileges but basically all the fields in there are not directly under your control uh however um Regular domain users by default can join up to 10 computer accounts to the XF directory and once you add a computer account that gives you control to a lot of ldap properties of that computer account that you can't control for your own accounts which includes properties",
        "like uh the script pulse property which",
        "is basically a long string containing a parts it's supposed to points to something to run when logging in it's not actually really used for computer accounts but it is included inside a pack data structure and it gives us more than enough space to put in all these Collision bytes only problem though this field and basically all the other pack Fields uh when needs to be textural strings they need to contain valid unicodes and they will be encoded as utf-16 while if we compute an nd5 Collision are the bytes that this Collision algorithm generates are basically random I do not have to match unicorns",
        "luckily the chance that a bunch of random bytes just happen to be valid utf-16 or at least valid and off for Windows to accept it it's pretty large",
        "utf-16",
        "uses 16 bits words that each represent a",
        "single Unicode code points and most of them uh basically most two",
        "byte combinations uh will just be accepted and mapped to some kind of code points and even if it's not assigned anywhere um windows will not mind if you said put that in an ldap property the only exception to this are a few uh surrogate characters and these basically indicates they always need to be two of these in a row and these allow you to kind of extend the character space and allow you to encode even more characters by using uh 32 bits instead of 16 bits and when a surrogates",
        "word is put next to something that's not uh a correctly matching other circuits words then it's no longer valid unicodes then it can no longer be properly encoded using utf-16 and a huge F16",
        "parser or writer will not accept it",
        "so if we want to create a an mb5 Collision we need to basically make sure there are none of these surrogates uh words in there and it turns out this was actually not that difficult to achieve I used Mark Steven's hash Clash tool to compute chosen prefix collisions it's a an excellent tool and",
        "um I didn't even really need to dive too much into the details of how uh md5 charge and prefix collisions works because what this tool basically does it produces uh 64 bytes blocks block by",
        "block intellective uh that each get a little bit closer to the collision and it already had it was a probabilistic algorithm that could fail at these steps and when it would fail it would just retry generating the last block and does it probabilistically so then it would generate some other outputs so I just included a very simple hack into um scripts that would just check if any",
        "block that was produced happened to contain invalid utf-16 and if that was the case it would just reject it and the algorithm would just try Computing that block again and because it's probabilistic probably something else would come out because the chance that a random 64",
        "bytes block just happens to be valid huge F-16 by coincidences one in is one in three we basically have to take three times as long to compute the Collision but when you do that you have a completely utf-16 compatible md5 Collision which may have some other applications as well but it's very useful here and it allows us to carry out an attack so now we'll go through how the actual attack works first of all you um well",
        "come up with some completely fictional pack that you can give all privileges that you want uh here um it shows some uh attacker user that gives themselves",
        "domain admin privileges Enterprise admin privileges basically anything you can config in a data structure you can just completely come up with yourself this is what we are trying to spoof and then we'll obtain an authentic pack that belongs to the computer accounts it was just created and um well there's means uh you can use the utu protocol in Windows to get a copy of a pack of any domain user there's standard tools for that so it's no problem to see what the pack looks like so first you can create these computer accounts maybe already fill up the logon part with some padding and you can get that back both of these um well you don't know what the signature is supposed to be of the spoof backyards but you do get a valid signature of the authentic one and both of them will of course have completely different md5 hashes",
        "so now we're going to do the uh the expensive step the hash Collision",
        "um we take the entire spoofed back as a prefix and the authentic pack we basically cut off at the start of this logon path uh data structure that's where we want to inject our Collision bytes we'll run the Collision algorithm and well it adds a lot of bytes to both of our packs",
        "and the results this complete spoofed",
        "pack filled with some garbage at the ends and this half of an authentic pack with also some garbage at the end they will both have the same md5 hash",
        "now at this point what we can do is uh do an ldap update to this computer accounts and copy all the bytes that",
        "would previously appear at the bottom here basically we put this in ldap query update the logon Parts property so",
        "the authentic pads would actually contain the same types of collision bytes and then we request this new updated pack",
        "the domain controller would give us a signature again and what's interesting about that because nothing else changed in this prefix at the md5 hash of the first part of the pack would still be identical to the spoofed",
        "pack that we can that we computed now mb5 has the nice property that's um if you have two inputs with the same hash and you add the same suffix to both inputs they will both share the same hash as well so we can kind of swap these two uh merge these two packs together we take the suffix of the authentic pack stake it to the end of our spoofed pack which results in the entire thing having the same md5 hash as the entire authentic pack",
        "uh so we can plug in the signature from there as well and these will be computed using the same hash so they will remain valid and the end result is a pack that starts with well a valid back data structure that tells uh that says that my user is a domain admin and there's a whole bunch of garbage data at the end luckily the parser that is used to process packs it will basically allow it",
        "to be extended with garbage bytes these are all uh well basically all these fields are prefixed by lengths so the parser will just ignore this whole part but it will still include this whole garbage part insights into the signature computation so um even though this will this will just be accepted and when a validator would try to compute the signatures again and the five hash would be the same signature would be the same we now have created a valid back",
        "and while I was basically uh getting",
        "this attack to work I also noticed something else because this still all took advantage of the uh weakness in the rc4 hmx cipher and the alternative of which are AES based encryption types that don't have this weakness but I know just a little bit of another problem with the back protocol as well and it is the way that this how these signatures work so there is a server signature that's just a Mac using the key of",
        "um that's the same as the key used for the tickets that contains the pack and there is a second mac o computed over a Mac with a key controlled by a domain controller and when this spec is validated by a domain controller it will first compute the first Mac and then computes the second Mac over that first Mac with a different key and the whole idea behind this second signature is that even if somebody knows the key for the first Mac they will not be able to spoof the second Mac this creates some problems first of all if the second Mac is computed using the secure as based algorithm the first Mac is computed using rc4 and that's actually what happens in practice because she it turns out you could downgrades to rc4 for your surface signature but not for the KDC signature that's determined by the domain controller not under the attacker control uh but yeah if you have a secure Mac over an insecure Mac if two values have the same insecure Mac they will also get the same uh well KDC signature over that Mech as well second of all uh we have an attack scenario here where this first share for Signature is computed with a key that the attacker knows and a cryptographic Mac is supposed to protect to be unforgeable by those who do not know the key a cryptographic Mac could have as a side",
        "effect the property that if I know the key I still can't compute two Maxes are the same for different data but it's not guarantees that is not a required property of a secure Mac so secure Macs exists the that still allow me if I know the key to just have two completed different pieces of data two different messages and use my key to somehow compute a Mac that matches with both of them and it turns out this is exactly what is the case for the um well secure alternative for rc4 mhmac and those are the other AES based encryption types actually for cryptographic authentication they just don't use as but hmac Shavon truncated to 12 bytes",
        "um hmx chavon even though Shavon itself is not collected free anymore but hmx Chevron is secure uh this construction also doesn't have the whole pre-hatching filter ability so by itself this construction is safe uh truncating the results with 12 bytes is normally not really a problem uh into a context where an attacker well doesn't know the key um has uh has limited options for spoofing uh message authentication codes but when you do know the key this whole cryptographic authenticator is hmac function basically just turns into a regular old hash function um an attacker can do offline attacks where they can just try Computing hmax of two randomly inputs or two Junction prefixes with random additions",
        "and the chance that just by coincidence these 12 bytes will be the same it's about a one in two to the power of 48 and that is well this is a lot more expensive than Computing an mv5 collage Collision this is still very much in the realm of feasibility and um all you need to would need to make an optimized implementation for this this is something you could compute in like half a week with a bunch of gpus so in theory it's even also possible to spoof backed signatures when the secure as Cipher is used so that was kind of like not something I was originally looking for it was like office and additional finding I made as well that was basically really just looking for ways to exploit rc4 hmac so okay",
        "we have now spoofed a pack how can we do something useful with this uh this was actually uh kind of tricky pack validation is used in different places but actually making a useful",
        "exploit that achieves a useful attacker goal uh with a fake back",
        "um was not always trivial and well the one exploit I could actually get to work in a well a realistic setting is an attack on",
        "constraint delegation now I'm not going into the details of how exactly it works but constraint delegation is basically a feature where in a domain you can configure two surfaces",
        "to allow uh delegation of usual accounts",
        "so for example let's say the first surface is a web interface that allows you to click through files and the second surface is an SMB share um when you say surface this web service is allowed to delegates to that SMB share that means this servers can impersonate",
        "um any user within the domain where it's allowed and then log into that second service as if it was the first user so that's very useful I log in to the surface one with my domain account and then that surface uses my account to communicate with some other surface so it can only access files that I can access and any file access events are locked as if they came from the original user and well they ask for you to proxy protocol that facilitates this whole mechanism involves KDC signature validation and according to the protocol specification a domain controller would verify the signatures and basically just accept a pack and also the reason why this was necessary is because this whole protocol involved somebody handling a ticket",
        "encrypted to themselves so basically a",
        "surface one here has a ticket that is aimed at themselves encrypted with a key day control so they can decrypt the stickers Mess With The Pack if an updated server signature then re-encrypt the pack again so the signature validation is necessary to make sure that during this process the surface is not going to mess with any privileges",
        "now what this enables uh enables there already is a well-known attack where well basically you compromise a surface a that has a constraint delegation relationship with surface B when you can do that you can impersonate users do the same uh to This Server B and if there's no restrictions on that you could basically just say hey Surfer B um I I want to impersonate the domain admin and well if you own server a then that will allow you to probably own server b as well um for this there's uh there are mitigations you can Implement to uh to",
        "reduce the scope of these types of attacks or mitigate them all together and that is by not allowing certain user accounts to be delegated for example any user account in a protected users group is not allowed to be delegated you can also set a separate property on usual accounts preventing delegation of them as well and if you put all your administrators in the protected usage group for example which is a good practice then an attacker that compromises server a can no longer impersonate an admin when attacking server B",
        "uh and what you can achieve by box proofing is bypassing this whole restriction so you can turn uh you can just come up with some potentially non-existent user that is domain admin and does allow delegation because whether or not a user allows delegation is included inside the pack",
        "so in the end what I've got here with descriptor bug is a practical security feature bypass Works in practice it is a little bit limited it's similar to another uh attack called the brown speed attack in the effect that it achieves um it basically allows well privilege escalation on the very specific circumstances",
        "um and it is definitely um useful in these circumstances when you are dealing with a domain where you compromise a server uses constraint delegation and there are other controls in place that would stop your attack in your tracks um but in general it's not the uh it doesn't have super high impacts however it does show this that is theoretical crypto bug can lead to practical consequences it may not be the most exciting exploit but it is an exploit it is a security feature but uh the Bible saying ad and of course there's a lot more mechanisms",
        "relying on this broken Cipher so while I",
        "have not been able to find uh interesting other exploits that doesn't",
        "mean that they are there so there's a whole bunch of new attack surface here",
        "so last month this issue got batched even though I already disclosed it in May 2021 so yeah one and a half years time to implement a fix it's a little bit longer than usual I would say not really a 30 day disclosure timeline but you would do have to take into account that this is a protocol buck and there's a lot of Legacy software uh relying on this",
        "Legacy protocol and actually",
        "get uh getting these fixes implemented take a whole amount of regression testing in a whole bunch of settings also hold the work let's use active directories is fairly tricky and so you can imagine it's must have been quite a pain to get it to work so uh our two CVS got registered there were two batches uh for the the one the rc4hmec issue and the other for the more General pack issue uh the first batch basically changes defaults and disables",
        "rc4 hmac on user accounts by default",
        "um there are some ways to get around that and still use the insecure type but if you don't change anything and you don't have any configurations diverting from the defaults suddenly this weak encryption type is no longer allowed but it's going to have some beneficial side effects or not so beneficial if you're a red team or a pen tester because this should have entirely verified this yet but this should probably make gerberos thing more difficult and limits the impact of overpass the hash attacks which probably are actually more useful than actually mitigating my far more restricted attack so that's a nice side effect and finally we're getting a step further and getting rid of this Legacy encryption type the other fix is supposed to address the general issue with tax and that's also supposed to address the issue where you used to secure um uh Mega Collision issue with the as ciphers and that's basically to add a new uh back signature with the KDC key that covers the entire contents of the pack so it doesn't just apply to some other signature doesn't use the insecure Mega for Mac structure but it just signs the",
        "whole thing again um it is not really enforced yet though uh only in July next year a patch will cost uh checking of the signature to be enforced in the meantime it will just generate order defense when somebody tries to do the spec proofing attack which means that this attack is still actually possible in current Windows domains uh you would need to first come up with an optimized implementation it finds uh hmax Shavon collisions with a known key uh that's something that is not entirely trivial and takes on computational resources but the attack is still possible unless you actually go ahead and enforce the signature",
        "validation Yourself Microsoft profiles instructions on how to do that but if you don't take any actions you will remain vulnerable until July next year",
        "so some conclusions uh well first of all I hope that with this uh practical attack even though the impact is limited does definitively show that rc4 hmac is broken and we should really try to get rid of it and there are some good steps by at least disabling it by default it also shows that it's still possible in 2022 to achieve attacker goals with",
        "nd5 Collision attacks even though most people would probably think that mb5 collisions are something of the past because well we're not really using md5 anywhere anymore right",
        "um and it also shows especially the long time it took to implement a patch and even when they did the patch still broke things that active directory relies on a",
        "lot of Legacy crypto not just this but also a bunch of other protocols that are very hard to modify or to get rid of so yeah that was my talk and unfortunately the counter was broken for most of the time so I'm not sure do we still have five minutes left for questions or okay well",
        "are there any questions [Applause]",
        "[Music]",
        "[Music]"
    ],
    "PhGDZad0DdA": [
        "foreign",
        "from Central Technologies I will give",
        "the session Bridging the Gap between research and the priorities intelligently and",
        "bypassing Rock",
        "first let me briefly introduce myself to you I'm a technical expert at support and knowledge responsible for exploring the",
        "application of AI technology in network",
        "security my research entries include AI security and that driven security and I have published and several top drawn here and the conference such as using security army imp CPR and the",
        "tripwire",
        "my home page is also shown on the slide I will start my session from the following parts first I will start with several representative Works to introduce the",
        "latest latest research programs of enabled intelligent server attacks",
        "then I will want us to two key issues",
        "that this research worker will face when we want to embrace them in practice",
        "then I will describe what our research is trying to achieve and what the audience can gain from my session the first part I will describe how we try to solve some two problems mentioned about next I will introduce so-called algorithm in our scheme finally I will",
        "show the experimental results we have achieved so far so let me introduce some related works in the field of AI enabled intelligent disciple text",
        "from research work form and game for the sport inviting machine learning power",
        "detection at higher USA 2017 use",
        "reinforcement learning algorithm to fight against AI detection energy in the",
        "diversion of static window P",
        "files the setting of the environment is",
        "similar to ours the system of our AI",
        "based static classifier and the score of",
        "the classifier is directly used as a",
        "reward feedback",
        "agent also takes this as input and all outputs selected actions",
        "the feature used here has 2000",
        "uh 350 Dimensions including Fair",
        "information either and the section",
        "features",
        "mutation methods are also classified",
        "which can be divided into three categories operator add and modify",
        "after 50 hours of training and the 100",
        "000 rounds of iterations a past successful rate of",
        "28.5 can be achieved",
        "the team of Professor Truman who from Georgia University also published uh research work photo Spirit was automatically bypassing and",
        "I inspect him from web application for awards like Asia this year to use the model Cloud free search algorithm data research on Circle injection attacks",
        "mutation techniques based on syntax tree",
        "is used the key process in their scheme has four parts first of all the payload must be passed partialed into a tree structure to achieve parsing",
        "payload is first right into three parts",
        "the left and the right borders and the circle integrated into the carry and since the query part is partialed into a tree structure",
        "the second step is to mutate the payloads roots or preset mutation",
        "measure",
        "also called algorithm guiding the",
        "material",
        "mutation search is Arrow research",
        "algorithm and the search process is divided into four steps selections expansion",
        "simulation and propagation",
        "finally you need to reverse to view the stream into a payload",
        "uh in addition to reinforcement learning algorithm there is another type of Representative methods that use on genetic algorithm",
        "take the work of 71 University in South Korea as an example the first mutates the original pillows through multiple random selections of actions and the third another",
        "generative mutate pillows will be scored by the",
        "detection Energies and the top K payloads will be selected in this in descending order according to the score and the certain amount will be randomly selected from its operation history pedal list and the original pillow list and then repeated about the episode for this below until the maximum number of limitations is reached",
        "in terms of environment Construction",
        "unit addiction to directly using one",
        "some researchers also use machine learning models to simulate",
        "involve a more research work of University of genoria let's say first constructed a data set of manages a payload and the normal traffic",
        "between the sum machine learning binary",
        "classification models through this data",
        "set and the extract them through some circle feature extractors to obtain the features are then send it to svm graph Network and the RL for training",
        "use this model to score the mutated payload until the payload score is lowered set",
        "threshold or reach the maximum number of",
        "mutations to end the current payload",
        "mutation process",
        "next I will Point all through key issues that this research Works will face when we want to inflate them in practice",
        "first uh previous research work looks small on",
        "simple generation no matter reinforcement learning in our",
        "genetic algorithm or other AI enabled",
        "method or rely on huge number of times",
        "to generating enough data to train the model we all know that uh AI algorithm rely on",
        "Big Data larger than the amount of data the patterns uh effect of the",
        "trained model however current commercial valves have",
        "the blocking ipe function if too many attack attempts are made IP will be blocked so we need to minimize the number of attacking times in the actual application environment and strive to",
        "achieve the effect of one hit one hit normal",
        "another key issue is that traditional",
        "web fast methods changes the semantic of the payload for example when we mutate secure injection a load",
        "we often insert some special characters",
        "into the payload which may cause change in the semantic of the payload related payload may pass the bar we cannot execute the attack directly on the servers",
        "therefore we should try our best to ensure the semantic of the payload remain unchanged during the mutation process",
        "so I will describe the uh what our research is trying to achieve and what the audience can gain from my sessions",
        "here I give a real and specific example",
        "to show the effect of our subject",
        "I take physical injection as a example",
        "uh here we have one original payload One",
        "Union selector one version it has simple list payload to create the version information of the database I'm sure that I will work with the block this payload and we also have three autumn",
        "Atomic bypass action",
        "number one adding all false logic to the payload number two replace all two",
        "double vertical bar reverse Ray replace",
        "equal to like is these three actions are the most basic bypass sections are to use them to bypass motor one",
        "I will show you how skinny use the combination of these reactions to bypass Commercial Valve the progress is fully completed by reinforcement learning agent and it is shown in the slide first true",
        "or false logic I think below this material to one or eight nine one six",
        "equal in 917 or",
        "7641 equals 7642 unions level one",
        "version uh then two or I replaced to double",
        "vertical bar finally two equals are",
        "replaced to like",
        "so far this pillows can already bypass several commercial Buffs and we briefly introduce how it works at the right and blue line show in the slide it is a syntax difference between",
        "my circle and Oracle semantic of this below the image circle at the same of at the same as original payload and however double vertical bars are",
        "contamination operators in Oracle",
        "connecting two strings is processing",
        "priority is higher than like and therefore during the passing process",
        "when it's found that the two sides between the double vertical bars are no strings or if you think that it does not conform to the Oracle syntax",
        "and we'll let him go reinforcement learning agent in our scheme we're going to Simply combine Atomic bypass actions to this",
        "power unplugs the bypass pattern is the",
        "most valuable contribution of our work",
        "here we summarize three main takeaways our research is helpful to security researchers of unders and the nutrition",
        "test Engineers the foreign",
        "researchers can use some basic mutation",
        "operations to obtain some complex bypass",
        "patterns which is very helpful to the research and the utilization of",
        "well now build his but vendors can use our algorithm framework to fight against their own web search for bypass points and fix them it kind of achieve the promotion effect of attacker defense",
        "a nutrition test engineer can directly use our model for penetration testing",
        "which is uh which can automatically bypass the specific Buffs",
        "next I will describe how we try to solve the two problems mentioned about",
        "we first review the workflow of all human bypass well the human want to bypass one it will force the travel as well to original payloads",
        "if it is blocked it will mutate the dangerous function of variables in the payload and then use the mutated pillow to try until it can bypass successfully",
        "we find that the whole progress process is instantly",
        "interacting with the environment and the learning with accumulated",
        "experience it is very similar to the",
        "process of reinforcement learning",
        "so we designed the whole scheme based on reinforcement Journey in our scheme we",
        "treat offensive defense kind of retention as a game for enforcement learning agent to play a desired bypass action library that is similar to the operation actions when playing game",
        "muffin targets strawberry present the environment of the game giving the agent feedbacks I will tell it whether the data package Bypass or not and successfully execute or not",
        "agent choose the Next Mutation actions",
        "based on the feedback and the current state this way we model the offense defense confrontation problem as a reinforcement",
        "learning problem in our scheme in addition to setting up the environment and trying to",
        "reinforcement learning algorithm",
        "also need to construct the atomic bypass",
        "action library and the original religious payload Library",
        "uh the atomic bypass action library is",
        "similar to the basic operation we do when playing games here we collected the bypass techniques",
        "commonly used by expert and splits them into Atomic level actions",
        "original malicious payload library is a",
        "collection of payloads commonly used by security expert in a text this payload are usually blocked by bar",
        "the goal of our project is to use the original payload in this library to bypass above the correctly execute on",
        "the target through a combination of bypass actions",
        "this whole probe process is automatically performed by the tree in the reinforcement learning agent with very few attempts",
        "in order to reduce the number of attacks in actual combat the device environment",
        "of the entire solution to two parts",
        "when you add the actual combat scenario including external Comfort retention and",
        "internal correlation first we deploy valves and the volunteer",
        "environments of virus within the vendors",
        "in the training environment between reinforcement learning agents in the training environment to learn how to bypass puffs of various vendors",
        "in the actual combat scenario are we in",
        "integrate the trained agent into the",
        "automation tools or develop a set of tools by ourselves it work in his workflow the tools will first charge the Target off",
        "manufacturer",
        "and then automatically select the agent",
        "model according to the manufacturer",
        "then we rotate the payload used by tools",
        "achieves the purpose of the Innovation testing the Target website",
        "through the splitting the of the two",
        "environments our heat knockout effect",
        "can be achieved in actual combat",
        "in order to solve the second problem that is to maintain the semantic of",
        "payloads and improve the exclusion security success of the mutated payload",
        "we propose a mutation method based on",
        "grammar and lexical analysis",
        "the workflow is at first below this passed into a Lex Lexi code tokens",
        "or lessons sequence and uh since a",
        "syntax tree the mutations are performed on The Token sequence and this syntax between to maintain the semantic environments of",
        "the payload on the other hand the reward design we not only consider whether or rough and be passed or not and also consider whether the payload can export correctly or not only this samples that can boost by Parts above and executed the attack correctly can get the maximum reward",
        "we improve the semantic environments of the mutated payload through the two improvements of the sample generation phase and the feedback rewards phase",
        "thereby increasing the success rate of the attack",
        "then I will introduce the core algorithm in our scheme",
        "reinforcement learning algorithm we use is the PPO algorithm proposed by overnight in 2017.",
        "the people algorithm is a policy grid in the algorithm deposit Grid in the algorithm is very sensitive to the step size but it's difficult to Choice a suitable",
        "tab size gives a difference between the new and the old policy changes during the training process is too large it is",
        "not conductive to train up to learning",
        "it will propose a new objective function",
        "that can update small patches in multiple three new steps which solves the problem that steps Us in the positive reading algorithm is difficult to determine in fact a trpo is also to solve this",
        "issue I'll compare with the trp or algorithm PPO is easier to solve",
        "the core problem of the policy gradient method is a bias of the data because the advantage estimate is not completely",
        "accurate and there is a bias then if the policy update is too far away the next assembling will be completed divided",
        "causing the policy updated to completely",
        "divided position thus forming a racial Circle",
        "therefore so-called idea of trpo is to",
        "make each policy update in a trust region we ensure the multitude is Improvement of the policy",
        "deposit reading method is on policy so it is originally required to use the on",
        "policy data from for training every time",
        "but obviously it is too efficient to",
        "throw away the on policy training ones",
        "therefore trpo and PPO are said to be on policy but in fact they are all policy in most cases and can only be said to be near on policy or to do it that is the data",
        "sample or 16 divided into mini patch to",
        "train the neural network to it",
        "iterate multiple times",
        "generally we will reuse the data that is simply sample reuse",
        "then due to the use of policy data in training only the first update is on",
        "policy followed by of policy the data",
        "distribution is different so we need to use the import importancy sample into adjust also core idea of PPO is very simple all the ratio that is that every the",
        "division between the current policy and",
        "the old policy will clip",
        "if the racial division is good",
        "eczema will creep after the clip uh the",
        "gradient will directly become zero and the neural network will no longer update the parameters in this way in terms of implication it does matter",
        "how many steps are updating",
        "and you don't have to worry about the training being fast",
        "finally I will show the experimental results we have achieved so far",
        "first let's look at the effect of an",
        "internal confrontations scenario",
        "we carried all the confrontation into Stage the first stage is Black Box conversation which means that we treat wealth as a black box and the only feedback information about advisor payload upload or not in this stage we generate more than 20 000 possible and",
        "executable samples and we extract more than 20",
        "bypass modes from them it further promotes the Improvement of our work second stage is white box confrontation at this time the program interface inside the buff will also be open to the enforcement learning agent in addition to whether uh blogger or not",
        "agent will also know what caused the block in this stage we found more than 50 bypass modes",
        "in the external confrontations scenario",
        "we fight against several mainstream one we have almost",
        "100 bypass success rate our function is",
        "integrated into the supermarket rules",
        "and the effect of one click injection has been verified in dozens of customers",
        "that's all thanks for your listening I'm sorry that my physical condition is not very good today so I will cancel the QA session here is the QR code of my home page please feel free to contact me if you have any questions",
        "[Music]",
        "[Music]"
    ],
    "RpXoVwCSHA0": [
        "[Music]",
        "foreign",
        "okay good afternoon everybody Welcome Aboard my train uh this talk uh will",
        "take you to deep Waters of mqtt protocol",
        "which is not a new topic but I will try to present the kind of a new point of view how the mqtt can be misused in an",
        "unusual kind of ways how many of you know mqtt protocol just yeah great so",
        "I will be your train operator today my name is Martin um I used to work for Avast for 12 years and now I'm independent researcher my",
        "domain of expertise is mainly like everything glow level that means from Chip and for a few last years also to Cloud I have a few YC's myself I'm a pretty heavy coffee addict and with that comes also my hobby which",
        "is breaking the coffee machines and reversing them uh and if you want to ask my age I can tell you I remember the BBS bulletin board system and that's all the information I'm going to present you today uh came from oh just kidding so",
        "let's make a plan for our journey or for our trip today uh at the first stop uh we will do some planning so I will try to explain a bit what the mqtt is for those who don't know and also to map the landscape so how is the situation with the mqtt protocol out there is specifically like the publicly facing mqtt servers that means like the",
        "servers connected to the internet and available in the next station we'll hop on a train and I will show you a few use cases of misconfiguration and security mishaps I would say that come with the mqtt protocol and mqtt brokers",
        "then in the next stop we'll change the train and I would like to show you how it is possible basically from okay like Hope",
        "from the mqtt and ethernet internet",
        "protocols to a different technology so for example zigbee Bluetooth low energy then before I'll leave you at the Terminus we will do a short demo which",
        "is probably the cherry on top of this presentation when I'll show you how you can misuse the mqtt to break the whole perimeter from the inside out and at the terminals I will leave you with few thoughts you can you can ask questions if there is going to be a time left so usually my talks about iot and iot security itself starts with the like iot rant about how bad the situation is how how the S stands for security in iot abbreviation uh I will skip that this time because that could be pretty pretty long talking I will leave you with this quote that for me is like uh just on point with the computer security and specifically with the iot security that's just that's how it is and to prove it I will show you how bad the situation is now So speaking of mqtt like I have this naive model for you who don't know what the mqtt is it's very handy lightweight protocol uh that is based on a publisher subscriber model so you can basically publish to some topic on the other side there are subscribers that subscribe to a topic and the broker itself which is the implementation of the mqtt uh realize the messages",
        "to be more versatile it allows you to subscribe as a subscriber to wild cards uh topics or for example the last subscriber here on the picture uh basically consumes all the news from either the weather or or sport news",
        "so this is basically very simple model this is this is how it is in terms of some specifications as I said it's a publisher subscriber model it's spelled agnostic so it really doesn't matter what the payload is it's just for for the implementation it's like a binary blob so whatever you put in there it got transmitted the topics are organized into real life structure what we've already seen uh when subscribing the wild cards can be used there are actually two wild cards the one is Hash time which stands similarly to file system for asterisk so anything and then there is a plus sign which means like one letter in in terms of for example the file system and file names in this case it means like one level in a tree one and exactly one uh usually it operates through TCP port on 1883 if there is a TLS implementation",
        "it uses 8080 83",
        "two distinctive features of the mqtt itself are last will and the retained topics last wheel is basically used in",
        "an environment where the connection is not very reliable and it's used in a way that when the broker loses the connection with the client it's able to publish on behalf of a disconnected client some payload on some topic which",
        "is set during the collection so that's typically being used for notifying all the other subscribers that the client went offline for example the return topic is just the flag when you're",
        "publishing you can say this is a retain content and the content stays at the topic so whenever new it's like a last state of the topic so whenever any new subscriber subscribes uh to a retain topic it gets immediately late latest",
        "status or the last things sorry",
        "in terms of implementations of the of this protocol the most prominent and probably most famous one is mosquito if you crunch a bit of data you will see that like 80 percent coverage or 80 percent of mqtt servers around the internet are based on mosquito server",
        "uh this particle implementation supports",
        "ACL list which is very important part you can set basically like fine-grained access to topics and clients so you can say this client can exist this topic this coin can write read only or write only so it's it's very useful feature then the implementation supports",
        "obviously the plain text transport which is over TCP then TLS and also websockets",
        "uh in terms of authorization and authentication you can have like the username password combination client certificate you can even basically do a",
        "kind of authorization by by just name of the client so when the client connects it specifies its own ID and that could be used as well but it allows on top of that is like you can create multiple listeners that's handy for a situation when you for example have I don't know you have you have clients that are not uh let's say computational able to support TLS so you have like a segment of network when there is no TLS supported and then you have another segment when you can connect the clients using the TLs that's why the multiple listeners are uh",
        "supported",
        "so speaking of my ycs and my diagnosis in the beginning I didn't say that I have a slight OCD and that is basically why",
        "this talk uh it will happen because",
        "I intend to return to previous things I've done and I've done this research before specifically in 2018 we published the",
        "article that there are almost 32 000 of mqtt servers openly available on the internet and by misusing them you can",
        "ship the data from home automations out there on even control some of them",
        "so I written back and the whole thing uh",
        "is because of the out of the box problem that's the term I came up maybe maybe it's it's like uh normally uh used but",
        "the thing is uh almost 60 percent of",
        "installation of mqtt servers have never been set up so that that's a common problem you know with with everything basically not just the software packages and devices like if you leave default credentials or actually if you install anything and it works and you don't need to set up anything it stays like that uh any guesses what the default credentials for mqtt server is or are",
        "none the axis is completely Anonymous that's the way how you install the mqtd server just to prove it I'll have this very short demo recorded recorded So up there there is a VPS server publicly facing the internet and by just issuing the APT get installed mosquito you'll install the mosquito server the demon",
        "starts and it just works it's open and you've created in 11 seconds instance of mqtt server that is widely open to the internet so that's the probably main problem why there is so many servers out there so since 2018 it got better a bit so we've",
        "been in a situation where the defaults if you don't specify the anonymous access in a configuration file what's the true so you had this implementation that is able to do all this kind of stuff like such as TLS ACL authorization authentication but Nev like nobody ever",
        "use that so it improved a bit so fast forward to 2022",
        "in a new version of mosquito implementation uh the defaults is to false so the no Anonymous access is available anymore but still uh nobody",
        "uses the ACL lists which is a huge problem and I will show you why",
        "If We Run The Showdown query on and most",
        "prevalent mqtt versions nowadays this is like a really fresh data you can see still the version 1.48 which is full of vulnerabilities is out there and it's on the top what's more interesting here is these are the sir or these are the servers that are openly available on the internet with no authentication and you can see there are even the versions 2.0 so that's kind of",
        "interesting fact and the the reason for that is obviously because it inherited the configurations and also sometimes",
        "you know you know the the feeling you upgrade something and it slowly works it's not working so",
        "you just change the configuration and allow all again",
        "if we speak",
        "these 32 000 of servers on the internet open then it went up in 2020 there was",
        "like 85 000 already and then I got lazy and in 2021 a lot of things happened for me so I skipped that year to simple so I did that this year",
        "wow if I were a marketing person I would say see I told you so but this is this is not possible right I was digging into a data why is this even possible",
        "and the thing is there is one country causing this anomaly and that's a South Korea that's interesting",
        "uh particularly One ESP",
        "and also the versions of the mqt are actually the brands of mqtt implementation uh is just mqtt because",
        "there is no fingerprint and The Showdown can't tell you what kind of mqtt server it is and it it turned out actually that this can be another research",
        "for uh for us or at least for me because that's interesting they are selling uh kind of all in one box for fiber optics to homes and that box implements the",
        "mqtt server for unknown reasons because if you connect to it there is no data flowing it just sits there it's open but you can publish to it you can subscribe to it you can store to it so you can possibly store your own data there",
        "so I fixed the chart so I subtracted the South Korea and now it makes more sense you can see it keeps the trend but what's more interesting is that there is a slight shift in open servers on the internet so it went actually a bit down and that's maybe because of the mosquito version 2.",
        "so let's hop on the train uh I will show you few use cases which are bad but",
        "at least you'll get the feeling why the situation is bad so this is like a typical implementation if you have some mqtt broker for example in home automation it sits just in the middle there is some business logic which is usually the automation itself so very popular is for example home assistant probably many of you know and then there",
        "is done some bridging so the idea is to bridge all the devices you have from different vendors or even data from from cloud services into mqtt so everything speaks and qtt and it's easy for the devices and cloud services to cooperate in case of a devices so that would be smart light bulb or switch it even Bridges the technology so Bluetooth low energy",
        "zigbee whatever comes to your mind so this is like a typical typical model and implementation",
        "but there is one problem if you don't set up the mqtt properly if you don't use the ACL list you are creating a huge huge security hole because you are basically breaking the borders between the parameters because if if anything can speak to anything there is no borders we've seen also this implementation so the mqtt server is running on some public-facing VPS servers and everything is connected to it it from the security standpoint it really doesn't matter because all these two situations are are pretty bad",
        "so this would be my first recommendation always set credentials",
        "always use ACL in the case of mqtt and",
        "if possible use TLS you will see this slide once more maybe twice more",
        "so this is one use case for example and it's a case of what we call data poisoning uh actually there is there is no issue this is some BTS station somewhere in Serbia spinning out the data or a Telemetry data through the mqtt server to Republic internet like I know it's bad it's leaking data for example uh part of the data is uh like numbers of key cards being used to access the BTS station through the electric Rock but still it's just like Telemetry you can't really control anything through that open mqtt server but the problem is if you don't set up ACL the data is still read write so if an attacker connects to This Server he can easily poison the data he can change the Telemetry and that could be a huge problem for example the snapshot from the camera is updated By The Station once a minute if you going to update it every second",
        "you can overwrite basically and poison poison the data on the telemetry",
        "another application or another use case is application called ontracks that's Android iOS application often used by",
        "home automation or just to basically share your geolocation with the rest members of your family or or with the whole automation so the automation knows where you are that's all good the",
        "problem is it speaks to mqtt and many users connected to mqtt that is open to the internet in that case you have a life stream or live feed as an attacker about when the user is and you can easily record it over a period of week in this case and deduce some let's say Behavior you can find out where his house is so",
        "this is this is really bad as well if you look Showdown and basically search for ontracks topics you will you will see a lot of devices or a lot of mqtt servers out there with this topic a pretty unique thing is this application that's again for Android iOS I think maybe just for Android and the idea here is you can create your own dashboard to control something through mqtt but what is unique in this case is that the configuration of the dashboard including all the scripts all the basically tweaking you did it stored",
        "into a one big Json file which is published to the same mqtt server and stored there as a result topic so if you are attacker you just connect to a server consume these topics or consume this topic and you will have the exact copy of the dashboard of someone else and you can really use it right",
        "so again all these things all these use cases can be mitigated just by setting the credentials and using ACLs possibly",
        "use TLS as well now let's see how we can change the train so how we can actually reach out to devices that are not connected to ethernet or Wi-Fi I prepared I didn't want to mess with someone's devices so I prepared a short demo uh we will be speaking about the open source firmware which is quite common as well in home automation the idea behind this open source firmware is that you can create your own device which speaks mqtt on one side that's",
        "handy for the home automation systems and different Technologies on the other side so Bluetooth low energy Laura GSM GPRS however you can configure the firmware and the problem here is usually with the",
        "Bluetooth low energy it's used for a kind of and how to call it it's like a presence control or presence detection so it basically scans its surroundings with the ble and uses that for uh for",
        "the automation to know that the particle person or device is in the reach so you are at home or you are in some room that's that's basically the idea behind it but the advanced future feature of of this firmware is also that it's able or capable to write and if anything is able to write what could go wrong right",
        "it's done in a kind of not very intuitive way but this alone is just enough to write to some ble device so you just need to send to a topic which ends with Slash config that's the counter-intuitive part Json",
        "which includes the address the Bluetooth address or Mac address if you wish then The UU IDs of the service and the ID of the particle property you you want to write and then the payload and that's it so if you find this topic on the internet on the open server you can scan the the surrounding of the device and you can even control the devices",
        "so meet a unicorn board that's a that's a toy I brought back from us when I was there uh it's a Lego like toy uh it has",
        "a RGB horn few servos and it speaks ble",
        "so let's put aside that I had to reverse the communication protocol before but",
        "I will show you on this toy how easy is to control the ble device using that qtt through that Gateway so you can see the Unicorn bolt sitting on the table and next to it there is kind of a monitor of what's going on on a mqtt topic open mqtt Gateway BH",
        "so we can see how the data is flowing",
        "and a terminal down there or fell",
        "so I prepared few payloads that I'm going to send through just the mqtt through that open nqtt gateway to ble device",
        "so you you can see the data flowing through the mqtt and the Unicorn bot",
        "reacts that funny case and it's it's uh it's",
        "let's say not nothing",
        "serious but I can tell you that for example this story is also able to update a firmware uh over the ble and there is no check",
        "now let's move to another open source framework which is like widely adopted around around the globe and that's a task go down like the transmoda firmware itself it's an open source it's a great firmware it supports a lot of devices and basic idea is to replace a firmware",
        "or to be able to replace a firm virus on iot devices to break them free from their original cloud so usually you buy a bunch of devices from different vendors all these devices they have like their own cloud and the problem is to control them or even to keep your data private so break the ties between the clouds you need to somehow modify them and that's when the test motor comes in actually it supports pretty impressive number of iot devices it's right now it's like two and a half thousand devices from different vendors and the support means you can Flash the firmware uh over the original one and then you'll get a lot of new features the smaller itself has a rest API and also speaks mqtt",
        "and there are a few interesting comments and features of the dasmata one of them could be group topic so basically when you install the firmware every device is by default in a its name like a like by a group topic which is tasmatas so you can ask all tasmodas in your network to update the firmware for example or to turn on and because it's a default group topic it stays like that",
        "again short demonstration I found out one server this is a real server so I I was trying to hide the IP address and it has a lot of transmoga devices on it",
        "the application I'm using it's mqtt Explorer it's a very handy tool so you can see there are the topics and the start topic is actually a transmitter topic on which the task model publishes statuses of devices you can see there is around 57 topics under under that node",
        "and if I issue the command status for cosmopas with zero that means give me all statuses for all devices and right now you have all the configurations uh from the devices in",
        "the whole network or actually in all devices that are connected and for example part of the configuration is IP address of default gateway DNS server ssids and so on",
        "so this is how how easy is to use the group topic to animation of all the devices there is one particularly interesting command which is website that has been replaced by a web query which is even more powerful in new versions and the basic idea is to be able from the device create a HTTP get the request to control something else so the original idea was",
        "another device using rest API but there",
        "is no check you can ask any server for for HTTP request",
        "so if you combine these two features you can easily create a DDOS right this is just a details on a small scale so I'm running the HTTP server on my own server and then using the previous mqtt server I found with a lot of transmitters by just issuing one command",
        "I'm getting all requests from all the devices at the same time",
        "so this is example how you can misuse just open mqtt connection",
        "and we are getting uh to the end of the presentation and now I will show you how easy is to misuse the m just the mqtt with anything else to break someone's",
        "perimeter to get inside the perimeter",
        "for that we will need a transmitter any transmute a device you can find on like hanging on on imqtd server there are",
        "actually two commands and because there is no fine-grained access control uh you",
        "can easily issue a comment through mqtt which sets the URL",
        "from where the device will take the update of firmware that's the OTA URL then you can issue the upgrade comment as well which basically is the trigger to do the update if you put there one as a payload it ignores the version check so it basically downloads whatever you set in a first instance and like happily update the the whole device",
        "so let's make some plan uh we are going to misuse one Infamous device which is the microtic routers probably you heard many cves around",
        "um microtic and research we are going to misuse the one particle CDE which is able to enumerate all the user accounts",
        "and the passwords from the device and because the router in this case is closed from the outside like from the internet we will do that from the inside",
        "we have the mqtt server in this perimeter it really doesn't matter if it's out of the perimeter or if it's inside and then we have one smart switch which runs the model",
        "so the whole thing works like this",
        "we upload the Rogue firmware remember it's an open source it's very easy to create your own firmware because it's open source you can just change few lines and create a new version which you can upload wherever you want",
        "then through the mqtt these two commands I've shown you on on a previous slide we will trigger the over-the-air update",
        "that leads to a device getting its update from our server or from server that we control and it gets extended with the new functionality so we have a transmuta that is able to speak generic TCP mqtt",
        "to TCP proxy",
        "then we run at the at the computer of attacker the counterpart which transforms the TCP to mqtt decrements",
        "the tunnel is created",
        "and then we can happily run the CV exploit through the tunnel",
        "that's pretty easy and actually it is less easy these are the devices we are going to exploit just as just for you to have like the physical uh physical",
        "look of the devices so that's the switch and the microtic router and this is the only thing we had to do in a firmware we added three new commands TCP connect TCP send and TCP close then we modified the main Loop which processes the data and that was it it's like 20 lines of code maybe altogether",
        "and this is a demo of uh the first step updating the firmware",
        "so the our Rogue server where the dasmota and the Rogue firmware",
        "is located then using again just the",
        "mqtt to publish into open mqtt server",
        "which resides inside the perimeter we are going to issue the demo switch which is the name of the device and the command OTA URL without any payload that gets us a current configuration so this is the default configuration for dust mode affirmware update URL now we issue the same command and as a payload we'll put our malicious URL",
        "so if everything works we should get a",
        "kind of result from the test motor or",
        "which which says that that the address changed",
        "okay so here we go you can see replied that the result is the new OTA",
        "URL now I'm running the server to actually serve that file from the server",
        "and now I'm going to issue the command to upgrade as I said we need to provide the payload with one which means take whatever is there no version checks",
        "yeah and you can see the request is being made from the task motor to a rogue server for the firmware the device goes offline now the update is taking place so it shortly goes online again and do the final restart",
        "so from now on the device you you would probably even notice that the device restart restarted itself so from now on the device is extended with that functionality that talks mqtt to TCP",
        "the next stage is actually to to attack the router we need to know the IP address of it and we can Leverage The plasmoda again we can leverage the command for getting the status of the device which contains the the configuration of a network",
        "from there there will be probably a default gateway and we can assume that the default gateway will be the router IP address so let's do that",
        "so now you can see the dasmota replied back and there is a gateway address which is presumably the IP address of the of the microtic router so now the only thing we need to do is run our proxy script which takes the",
        "mqtt server then the local Port it we will listen on which is 10 000 in this case then the target IP address and the Target Port in case of the windbox vulnerability the Target Port is 8291 which is the interface for the winbox management protocol and the name of the plasmota device again so we are ready and the only thing we need to issue is now is to run the exploit I have the version for python here so it's pretty easy you run the exploit with the target of localhost and the local board the proxy is listening on",
        "so now you can you will see that the exchange of data is happening and we successfully run the exploit and we've got all the usernames and passwords for",
        "that particular router which is inside the perimeter we didn't like access anything from the outside and using the same proxy we can now leverage all we know already to actually connect to the router through that proxy",
        "so you can say I'm again connecting to localhost Port 10 000 and I'm using the",
        "already exposed credentials to connect to the router",
        "the exchange of data is happening through the mqtt",
        "and you can see I have a full control of the router and I can do whatever I want to open the parts or add user whatever",
        "so that's how easy it is to proxate traffic in someone's perimeter just using the mqtt",
        "so what to say uh at the end",
        "[Music]",
        "I promised you will see this often uh in case of mqtt this is really crucial and especially the part using the ACL because nobody really sets the",
        "fine-grained access control in mqtt servers and it's a mess and it's a huge security risk because you can update firmware for example that's not only the case",
        "always secure your mqtt ideally don't",
        "put it on the internet use VPN if you if you must because the risk would be sometimes High",
        "it's turned out that that the mqtt is very very well suited for automation of your garden",
        "okay so that's it thank you for your attention I'm ready to take questions actually it went pretty good we still have like six minutes if if I sit correctly so there is a GitHub report that's going to be the part of",
        "of the website of blackheads or you can you can go there uh I put there all the scripts I've used for for the demo uh the only thing I didn't put there is the source code for the modification of a tasmota I don't want to get in any trouble but there is a binary if you wish",
        "so any questions",
        "so in that case thank you for your attention [Applause]",
        "[Music]",
        "[Music]"
    ],
    "D17-yJg3ML0": [
        "foreign",
        "so welcome to our session where you are here for confidence and Chaos strategies for world-class security operations my name is Catherine erler and I've been in the security field for",
        "close to 30 years that's a long time I got my start at one of the first incident Response and Analysis teams in the United States um that's that group was responsible for the first intrusion detection software the first centralized patch management and for helping to organize what is now first the form of incident response teams back in the day fast forwarding because you probably don't want to hear all of it um today I am working for miter miter is a not-for-profit company and we are striving to solve problems for the and give back to the community by",
        "um solving challenging problems some of the things that we provided include cve which is the common vulnerabilities enumeration enumeration we have cwe and",
        "then most recently attack so attack is a way of describing ttps and adversary movement so that's what we've been doing lately my role is as a department manager in cyber security Assessments in our cyber Innovation Center and basically I'm responsible for evolving and you know fixing state of the art for security assessments so we're doing things like this security automation framework and some other things like that hand it over to Carson hey folks my name is Carson Zimmerman I've been working in security operations for about 20 years now most of that was at miter where I worked in various government security operations centers and doing a bunch of other fun work I'm not going to talk about today and for the last six years or so I've been at Microsoft I lead one of the teams that performs a security incident investigations in the cloud and I'm really excited to talk to you about our book today and our third partner I I have to mention is Ingrid Parker she's the senior managing senior manager for intelligence at Red Canary Ingrid also worked for miter we all that's our Common Thread together and in addition to all her Technical and writing that she contributed she also helped keep us on tasks during a shifting times during covid and all those things so we're thankful to Ingrid who couldn't be here with us today so the thing we're going to be talking about today is actually a book it's freely available it's on the miter website and Carson will talk more about how to get it but it's a pretty hefty read if you're tired at night so we're looking forward to that we actually have a couple of them here that we might be able to do something with at the end here if we have time um so that work is based on our thoughts so I like to think about technology as shifting constantly shifting moving around kind of like sand dunes right so you can't just when you get your grip on it you know things move on you and that's a lot of what we have to deal with in security operations so basically",
        "we're operating in a shifting landscape all the time in security operations you heard this morning that about cloud an awesome development when it comes to security you know you can now secure these environments and control them and constantly patch and do all of those things for security operations when those first rolled out some of us were blind we could no longer see where data was in these environments because we didn't own them and we didn't know the the way of monitoring or anything else so it became a challenge for us and so we've had to figure out uh in security operations how do you keep things moving in these Dynamic environments and so we've come up with some organizing principles there are 11 strategies basically each one is a chapter in this book that can help you to figure out how to organize your security operations and how to be just that more effective knowing that your technology is just going to keep changing forever so today on our time frame we're going to go over six of these strategies we're going to talk about the first one knowing what you have the third one which is about the sock structure itself the fourth one which is about growing and hiring your staff the sixth one which is about cyber threat intelligence seven which is all about your data and eight which is about the tools and bringing things together more effectively in your security environments",
        "okay so with that we'll jump right into the strategies themselves try to give you all the content we can and the limited time we have the first one we have is about knowing what you're protecting and why this is arguably the most important of all of our strategies it threads through everything right so if you don't know what you have you can't know how to monitor it you can't know how to protect it and it won't work out for you um be curious about what your organization is meaning what is the business that you do what are your missions uh what is your intellectual property where is it do you do e-transactions what are all the different things you do in your environment and then from there what can you do about it right for monitoring and designing and detecting and even preventing when you can so have a business mindset literally when I first started security operations tended to be in the basement so it's metaphorically you're in the dark right there's no root there's no you know Windows there's no nothing you're in the dark you don't have to be in the dark today it's much much different now to be able to talk to your businesses and talk to your business units Mission units to know more about your organization and most of all importantly asset inventories I can't say it enough about have an asset inventory now",
        "traditionally security operations don't maintain an asset inventory right so you got to make friends with the it organization if you're not within the it organization and you got to partner with them and I'll tell you a story I got the call I was on incident response and I was the one on call and I got the phone call that all incident responders dread that someone from out your outside of your organization is telling you you've been hacked you know that's my favorite and then so I took down the information that they had about you know the system and the organization and all that that I could um everything I could know and then I went and we didn't have it in any of our inventories or monitoring or anything else and guess what neither did I T so those that were doing the asset inventory had no record of the IP address or anything else well eight hours later you were hearing about timing this morning eight hours is a long time when you're doing incident response a long time to not know where something is where in the world literally this machine was so we eventually found it long story short it was a research organization that had set up this Rogue little Network and not told I.T and certainly not told security operations so um my moral of the story is keep a really good asset inventory or work with the it organization and help them to be successful if they're underfunded tell them they need more money and also keep track of information like where it is the physical location of the device and that means virtual too for just because it's virtual doesn't mean it's not physically somewhere right and then the business owners or the data owner or the system owner so you can contact people when you need to so that's why my story on assets over to Carson I'm going to talk about number three here you need to build an organization a structure for your sock that meets the needs of your customers your constituency the people you're defending and there's a lot of ways to break this down when we actually wrote uh the book here the second edition of 10 strategies we call 11 strategies um we actually took the inventory we had from before and uh from first first.org inventory of different functions the security operations center can provide to its constituents and we actually came up with 41 and I actually recommend none of you do all of those 41. instead you need to think about from that menu what's going to be right for you and you can see here this cartoon we talk about socks of different sizes everyone everything from two people in their basement doing this um part-time to sprawling several hundred thousand analyst National coordination centers so",
        "we think about that many when we lay it across these different organizations and no let me I'll talk about this in a few minutes but no two socks are organized exactly the same so one of our major points here is that a world-class sock is one that excels at the things it's chartered to do and doesn't try to do everything we touch on a couple topics here including uh the location of that sock and remote work um through covid almost all of us I would bet uh worked from home at least somewhat so the nation the notion that you have to be in one physical location isn't necessarily true anymore so we see them come in all different shapes and sizes there as well",
        "24x7 some people say oh if you're not 24x7 you're not really an OP Center maybe maybe you're using Outsourcing to achieve some of that chances are you're using asymmetric Staffing in fact I don't think I've ever run into a sock that had just as many people",
        "on shift at 3am is they did 3 P.M",
        "putting that one chair of 24x7 is expensive that's 4.8 um full-time equivalents that's expensive so we want to think about different approaches there and then Outsourcing I've come in contact with Outsourcing all sorts for folks all across the Spectrum here we all have Staffing problems we're going to talk about that in a few minutes let's drill down on some of these pieces if there's something I've learned over the years is that the further the analyst is from what they're monitoring",
        "physically organizationally geographically Etc the poorer they're understanding as what is normal and therefore their ability to understand what is abnormal on those networks systems Cloud assets Etc back to strategy one so what that means for us is that on the one hand we want to be big we're going to have a Consolidated sock for a huge sprawling Enterprise who consolidate our authorities our resources we sustain that Cadre of experts in this area but on the other hand we want to be small we want to maintain that visibility and that ability to act with relevancy and precision we want to understand what's going on on all those networks so striking that balance is different for each of us so the way we didn't organize things goes back to this piece is how are you going to use one of these different models to serve your constituency",
        "one of the most common ways not the only but one of the most common and one of my top recommendations",
        "is if you can get all the elements of",
        "security operations for a given portion of your Enterprise if not the whole thing Under One Roof virtually or physically under one person it generally works out the best you want one team organized oriented on One mission you want trust in camaraderie and unity of effort between these folks your incident triage your response analysis hunting CTI",
        "architecture of the the sock tools operating and maintaining those sock tools and communicating all that situation to learn it's all those pieces of security operations you want them Under One Roof to support these things because when you respond you want economy of force and unity of effort and you want that shared situational awareness across all those organizations both in peacetime and during a major incident drilling down further let's talk about the engineering piece I've been an engineer embedded in socks for 20 years and I'm here to tell you with the the most recent buzzwords something I've held true for that whole time is that you need those operators and those Engineers talking to each other every day in some cases those may be the exact same team there's different ways to achieve this however you achieve this what you want are the patterns and not the anti-patterns shown on this slide you don't want us versus them you don't want Solutions and requirements thrown over brick walls every single time I see a sock with an engineering organization over here organizationally and Ops over here meaning they're very desperate it is awful for everyone every single time so think about how are you going to bring these operators and these Engineers together sometimes that means they are in fact the same team exactly there's one sock I've run into the people who operate maintain and evolve there's bespoke seam are the same people that do alert triage right wrong and indifferent there's different models here one way or another you want you can think about Ops owns engineering you can think about the engineering resources being matrixed into Ops maybe you have a rotation one way or another you need someone in that Operation Center tracking and driving those requirements they say when it's finished they're making sure that we deliver what we need and when we need it off to count through for number four yep okay so we're gonna shift gears radically for a minute again and we're going to talk about hiring and growing your staff which is our strategy number four the thing about staff is that they're challenging so",
        "I'll start the thing about hiring in a sock is that it can be counter-intuitive um you know at least I learned it to be counterintuitive over time so I'll tell a story basically I had a guy that we'll call Rich because he is now rich and I helped him get rich he was pretty new in his career when I got him and I hired him and he was a superstar absolute rock star could do anything technically and this guy um basically um you know he he went on and he helped our our sock for two years I did everything right I paid him fair market value I gave him more money I gave him raises I gave him tools he had four monitors where other analysts had only two you know I did everything I could think of to try to keep this guy comfortable and really liking it after two years he came to me and he said he told me that he was leaving and I was absolutely stunned I thought okay well I've just poured everything I can into this one person and I have an entire staff and he's leaving me a crater so the moral of this story is you can do everything right and you're still going to lose people so what I'm saying is there's an ephemeral nature to hiring and uh you know Staffing security operations so that became my model I just assumed that I'm eventually I think about my hiring with the end in mind this person is eventually going to leave and all along the way I work with the staff on okay how do we make it so when this person leaves there's not a deep crater so I still look for that technical expertise but I look for a couple of other things now too when I'm hiring staff for security operations one of them is curiosity and you heard that mentioned a couple times this morning which I was thrilled with you have to have curiosity if you're in this environment just because you're technically brilliant if you're just sitting there and you're not thinking about wow that's kind of weird I really wonder what that is if you don't have those kind of people on your team you're not going to get very far because adversaries like to do subtle things and move around without you noticing them so curios capacity is important the other important thing is teamwork teamwork so when I'm talking to someone to come on the staff I look for that person who wants to explain to me how they figured something out I'm looking for the enthusiasm that that someone likes to share hey this is how I figured it out hey can you see that and teaches others right those are the ones you want on your team doing teamwork so as they get ready to leave they've taught some other team members more junior or less experienced how to do what they're doing so those are really great things to have ephemeral nature of Staffing that's what I got to say about that the next one I want to talk about is cyber threat intelligence which is all the rage today I know everybody's doing this now um and basically",
        "um there's some tricks that come with cyber threat intelligence the first thing I want to talk about are the three areas that you need to have to come together to do great cyber threat intelligence or useful and actionable cyber threat intelligence the first one is what we all think about and that's about adversaries so you have your ttps you have your motivations you have your behaviors you've had what they do in the past you have all of that kind of stuff the next one is the technical environment what is your environment are you all Cloud do you have Linux systems do you have Microsoft you know what is your vulnerability profile are you able to patch things all of those things feed into your what Your technical environment is and the next thing is relevancy so this is about what is it do you do that's important you know are you a bottled water company that has intellectual property on how bottles are made you know from recycling or are you an electrical distribution company the threats may look different you know and probably do and that brings me to all of these data feeds that you can now purchase right my words there are someone else's data may not be yours it may be but it may also not be so really you need to look at these three things in your environment and look at the actions that come at the intersection of those three things coming together okay",
        "I also wanted to talk about anticipating adversaries this is the Holy Grail of",
        "using cyber threat intelligence and socks I don't know if you all have experienced this but I've had Executives come to me and say okay if I buy this cyber threat intelligence feed are you going to be able to tell me the the threats before I get to them I would love that too that is not the case as it turns out um but you know uh we can come closer if we start looking at things that are outside of just the ttps looking at your adversary's behaviors because they tend to want to hide so this is where that curiosity is really good that from your staff members of Ah that's kind of weird but it's also looking at your ttps in context of other information so for example if your adversaries are looking at your intellectual property again back to the Recycled bottling intellectual property",
        "that's one kind of um person if your folks are looking at Financial like e-transactions or your payroll",
        "that's a different kind of adversary potentially right so it's putting together some of those pieces and thinking about your adversaries it is well worth your time and money to spend a little bit time in security operations to look for your adversaries and think about them in bigger contexts other than just your ttps",
        "um okay and I'm going to hand it back over to Hartson so the next one is all about data let me ask you all a question when you ask your analysts what data they want to collect what do they say everything right and then you ask them how long are you going to store it for what do they say",
        "forever right can we do that",
        "absolutely not",
        "uh thinking about it for a while I actually came up with a graph you see here where on the x-axis you have the amount of data usually volume velocity veracity all the v's and on the y-axis you have the value and what I've seen time and again is you were either under over utilizing our collection platform uh on the left hand side you're not working to its value on the right hand side uh the the goodness is lost in the volume in fact I would argue you collect too much the volume the value of all of it goes to zero eventually if you're if you're totally overloaded your analysts so the question for you is is how are you going to get to that Peak let's we'll talk about that in a second but along the way so we want to align our sources and our retention with our priorities",
        "um the the days of saying that all of the and the the data that the analysts are going to use go into the Sim are over now mind you folks I've clocked thousands of hours in front of sim products I was a champion for buying a bunch of them in the early 2000s they still hold you still need a SIM or something lock and I'll show you how in a few minutes but the point is is that we want to think about also using data in place",
        "we also think about look it's just it's beyond just endpoint or just Network now right the days of slapping a network IDs on an inclinic monitor are are also kind of over should we still use network uh monitoring in places yeah probably but in in a in an environment where you've got more and more Cloud there is no end point for you to monitor so this is forcing the sock to have to dress issues it kind of kicked the can down on the road on for years",
        "we want to measure that coverage along not just one but four dimensions",
        "our organizations our businesses go back to that first strategy we use our our asset inventory our composite asset inventory to form our denominator and we measure everything else we do in what the security operations does against that denominator both during this piece as well as incident response hey how many how many things have been mitigated have we reached some acceptable percentage at any rate we think about the technology type Linux Windows Etc the height of the Computing stack firmware base OS applications Etc and then",
        "finally and it's a miter presentation so we have to use the word attack at least once right Catherine okay we're going to also monitor uh legitimately actually against star attack or kill chain coverage now how do we do this um here's another way to think about it we have our actionable alerts we have our contextual data for every alert we need contextual data to understand is it true positive false positive something we just need to be worried about something we're not sounds obvious right for every Telemetry Source we collect we should also think about having alerts now I know you're like duh but time it again we don't do this we collect raw Telemetry we don't generate any alerts and then when something bad happens the system owners are like you didn't do your jobs well sir you know we didn't we didn't create detections for that because we didn't have that agreement set those expectations up front folks conversely all too often we get alerts from something really shiny we don't have the contextual data what are we going to do we don't know um so here's a here's a little Venn diagram that talks about some of those different pieces volume of data goes from really big to really low as you move from left to right so the point is is providing one without the other gives the illusion",
        "of coverage you need both",
        "number eight leverage tools support workflows so we're Gathering all that data we're bringing it into the sock and here's something I see how happen really often we have all this cool technology we spent millions of dollars maybe on our Sim",
        "and we're like ooh shiny and then we go buy more and more technology and then it gets put on a shelf for three years the period of the maintenance contract and then when at the end of three years we're like that's garbage we're gonna throw it away it's happened to everybody anybody here yeah yeah good times right um bad news obviously we need to practice continual",
        "evolution of that Tech over its entire lifetime and for you and I that means generally speaking building those alerts those analytics those use cases that apply to your business again back to strategy one",
        "and you don't just have to do it yourselves spoiler alert I'll tell you how in a few minutes now and then you need to integrate that into one coherent workflow the way you do that can look way different depending on your needs maybe you just need a SIM maybe you don't maybe you need an ER maybe you don't it depends on what your mix is what you want to think about is having a picture to look something like this some of those blocks for you might be missing some of them might not be this picture looks different for everybody the point is you've got some of your event data flowing into some stuff maybe it's a Sim maybe it's not maybe it's big data Maybe it's not maybe you've got a sword maybe you don't but the point is is that you're bringing the data that's most important to you into an architecture and you're alerting on it and then your analyst can pivot between that your case management or your store or whatever have you your threat management platform and maybe your assets um uh platform",
        "there is no single pane of glass folks there's not what there is is a curated set of tools that you need to have seen or an interoperability between them",
        "so that your analysts are pivoting between them seamlessly",
        "some of the best analysts I've ever run into were so good not because they knew how to write great query so they did all right I like to write some really long ones myself uh it's not because they were free of analytic bias so that's true as well what made them so good is that they were able to find and leverage other data lakes that belong to others while using the data in place some of the best stocks I've run into despite their fancy Claude based seams",
        "had less than 10 or even less than one percent of their total data estate under their own control meaning 90 or perhaps even 99 percent of the data they used on a daily basis belong to someone else that's so powerful because they could achieve just those couple detections and just those couple analytic use cases without having to pay to put it in their own data architecture food for thought",
        "at the same time when we build this architecture we have a balancing act on the one hand we can be completely open all the sock tools are in the same identity plane same network fully integrated Etc as the rest of the constituency now what happens when your main domain gets broken into",
        "can you trust the socks date anymore not necessarily so on the other hand you can have a completely closed architecture I've actually lived in socks like this where you can think of the SOP as a sock as a a black hole of data an event horizon forms around it light goes in and never comes out is that beneficial",
        "now you've got problems with that too so somewhere in between these two extremes you need to find that balance because when you find that balanced approach it also enables the sock and I'm doing a little spoiler alert here to one of our other strategies is you can actually deputize some of your most",
        "important business stakeholders",
        "hey they're asking you for 23 different detections that you need to write by Friday why not have them help you write them and they might do a better job than you can so you can find a way if you build that architecture right with the right Integrations of bringing those other folks in can be very powerful I digress",
        "so for those of you taking pictures of these slides as we move along you didn't have to you can download this whole thing for free at miter.org whack 11 strategies as",
        "I mentioned earlier I let slip I wrote 10 strategies in about",
        "2013-2014 and the three of us were inspired to update it so it's not just one new strategy folks it's actually three and 120 new pages of material we wrote a whole lot more um you can do this on print on demand or ePub that's going to cost you money the PDF is totally free and just to be clear folks I don't make a dime on this Catherine doesn't make a dime on this neither does Ingrid and neither is miter it's actually free so when you're paying money for the Epub or print on demand that doesn't go to us trust me I'm also required to tell you um that we're not speaking on behalf of our employer's past or presence and that this uh this work was put together under Public Funding",
        "so with that I will close with a couple quotes for you now here you see it takes all the running you can do to keep in the same place if you want to get somewhere else you must run at least twice as fast as that that was the Red Queen talking to Alice and Through the Looking Glass this quote inspired the concept of the",
        "Red Queen effect you have to keep evolving your capabilities to actually keep parity",
        "with your adversary and your changing environment just as Catherine talked about in in the introduction so think about maintaining your capabilities actually falling behind you need to be constantly evolving the second thing I'll offer you is a quote by Williams Gibson the future has already arrived it's not just evenly distributed yet people often ask me Carson what does the Next Generation security operations center look like and sometimes I'll respond and say it's your job our job all of us to provide that set of capabilities all oven strategies and whatever of those 41 functions we talked about to your whole constituency so think about measuring that and driving that to as close to 100 as you think you can manage so with that we're going to take questions I'm going to park it here on the 11 strategies",
        "[Music]",
        "[Music]"
    ],
    "x57acY3f90s": [
        "foreign",
        "well hello everybody thanks for coming um you know I am so excited uh to be here in front of you um I was rehearsing last week and I realized with the amount of content I had I would need four hours but I have the best of what I had previously to share with you the only thing I worry about people in here and those watching virtually you might need some seat belts because we just have you know a lot to talk about but before we jump in and go too deep I just want to set some perspective usually with friends and family you know other people um you know when the topic of nft first comes up and this happened to me too we first try to wrap your brain brains around what this thing is um the most often the knee-jerk reaction seems to be it's just a jpeg right or hey look I can I can take a screenshot of your nft and copy it right and that's understandably so and we'll be talking about collections that have to do with photos but you know the future of nfts really is the metadata and the utility that they're able to provide I'll try to touch on some of that but if you look at the most uh you know High market cap collections the market uh it's not talked about it often but probably will become obvious in a couple of months and years these are actually utility tokens not really photos or board monkeys and inherently right um so from a monetary perspective if you take a look at the highest market cap collection today you know the crypto punks you'll see that there the market cap is a million and mind you that's an eighth right so as if today I think the price of heat is around 1200 US dollars so we have a nft collection that has a market cap of a billion right and you kind of go down that list and you'll see a couple hundred million a couple hundred million and also keep in mind that we're still early we're just we're just getting started with the money that's pouring in here right and so it becomes a lucrative Target for for attackers as well as people who want to make sure that we're well protected I think it's what we said about it and then it's not just about the market cap but it's also about the trade volume right so every time you sell it in Ft or buy one you pay the nft marketplace",
        "your percentage of the sales and you also pay the owner of the nft collection whatever the royalty they would like to receive so if you look at openc that's the most populous nft Marketplace to date they have done about 40 billion dollars a worth of volume in their Marketplace and open C takes about 2.5 percent of every sale so you do the math they've probably made about a cool billion dollars",
        "um in Revenue so far right not a bad place to be if all you are a website where I can just trade tokens made by somebody else and again just keep in mind we're just getting started",
        "and when we look at when you think about the blockchain specifically ethereum I would say is true for all blockchains um you'll find something peculiar from from a math perspective right is that there is no concept and and this is intentionally of a floating point or a decimal number right so when somebody sends you one eat or ether you basically get one followed by 18 zeros right and so the idea there is instead of dealing with the complexities and nuances of decimals you could fractionalize your 18th however you like within those 18 zeros",
        "right and then when you have people that are in Middle Earth like you and me that have to write code using JavaScript typescript python to interact with these smart contracts and in our Middle Earth we have decimals right so one thing you'll find is that becomes a ripe attack you know space where when you when you look at JavaScript the max that's possible before it you know vomits on you is much much lesser than the value of a typical unsigned end in the ethereum blockchain which is 2 to the power of 256 minus 1.",
        "um and so we'll see a lot of underflows and overflows occurring um in the middle alert code what we also see quite understandably so is the number zero appearing in in causing havoc right I want to say understandably so it's because",
        "I think from what I understand in in our human life we don't encounter zero as we're like walking around the park so you're not gonna",
        "take a look at this a space with with that lacks a bunch of flowers and admire it right so you you're probably not gonna really look for the absence of things unless you have some really great friends with mushrooms going on right um so",
        "the other element is that when you look at the number zero it's really why we're here in the sense that you start with binary base two you have one and you need the zero right for anything to make sense and when you have base two figured out you build base three four five ten that we used to in 16 and but if without the placeholder",
        "that is zero without but signifies the absence of something you couldn't have anything right so there's like craziness from a philosophical and mathematical",
        "perspective that's probably at play here so let's just take an example",
        "here's Luke's rare the second most popular nft platform",
        "and in order to incentivize people to list on their platform they came up with a great idea and it still works it it's amazing where what they do is every day they set aside about four hundred thousand dollars and then the reward people that are that have nsts listed on their platform right so because openc is much more popular this is incentive for people to come to luxray and lift list their nfts now there's a gotcha element to it where it looks rare will give you more rewards the closer you are to the flow price and what is the flow price the flow price is the cheapest nft that's listed for sale in any given nft collection right so for example if in nft that you own is worth a hundred thousand dollars at the flow price but you list it for 2 million you're not going to get the rewards because it's highly unlikely that somebody's going to transact and buy your nft and look for it wants that two percent right",
        "and one of the things I realized with looks rare is you could list your nft for sale for zero and you'd be stupid to do that because if you were to try to do that within milliseconds there will be a bot that will take your Nifty sure right but what you could also do I found is that you could list it for amount zero",
        "right in the off chain world that is their website and once you do that because it allowed me to do that",
        "and then somebody tries to buy the nft the smart contract Rewards because the topic you see the logic code that's in the smart contract they say the amount has to be greater than zero makes sense but now you have a disparity between the off-chain world which is the website and the on chain so what's the big deal well the big deal is that if I'm able to listen nft for sale for zero that nobody can buy what does that do to the flow price the floor goes to zero right so if you were to take an nft in the billion dollar Punk collection or a couple of other nfts that have a high market cap and you list it for sale in a way that the flow price is zero you will see Panic right you will see nft holders for example if you may hold identity that you think is worth fifty thousand dollars and you see the floors at zero you probably want to not want to exit because the floor the price is tending towards the floor that's usually what ends up happening and this opens up an attack Vector where if you're the attacker your investment would have to be an nft each from the high bucket cat collection for zero amount zero nobody can buy watch the Panic happen",
        "price drops right and then as the price drops you as the attacker then go in and buy it for really cheap and by the time looks rare water Marketplace fixes their thing",
        "and the price goes back up you exit for profit right so this is like a combination of somewhat of an input validation issue but in in order to really figure out what the attack Vector is you really have to understand the business Dynamics at player right",
        "the other side effect of something like this is that when you look at open C and looks rare their flow price that these two marketplaces advertise are relied upon by other smart contracts they are the spot contracts that have loaned out millions and hundreds of millions of dollars worth of crypto for nfts right so there there's marketplaces where you can actually provide your nft and and borrow a money but in in these smart contracts using chain link will monitor what looks rare and openc are saying about the flow price so if you're able to take the flow price momentarily and get it to zero you would liquidate hundreds of millions of billions of dollars of loans just by doing that right so there's that you know if you're running a Marketplace you have to have a very crisp understanding of what the floor price is and what the big deal is here and I will tell you when I reported these two looks rare they were pretty great they're on they got it however there's some other marketplaces that I had trouble with the incident response team in three others that I could explain to them why the flow price was important right and I think that is a bad thing and so take away number one",
        "is that external researchers should not have to explain your business Dynamics to your incident response team right that's just a very awkward place to be and it's just a bad sign right so you know one of the things I would recommend is that if you have any business whatsoever to do with a blockchain it doesn't have to do be about nfts take a look at you know if there's if you have a bug Bounty program or you have external researchers contacting you",
        "take a look at some of the cases that have been submitted in the past and make sure that your triage is in your instant response team are able to understand what's actually been reported",
        "so let's do that again here again it looks rare after they fixed the previous issue",
        "and I was kind of reversing during how the nft marketplace works one of the things things that stood out is how does the off chain world you know communicate with the on-chain world right and in the case of looks rare the way they do it is by using anons which were mostly familiar with at computer science where every time you list something on sale for for on looks rare your non-based that's based on your wallet increases by one right so for example you list five things for sale you're non-start to zero now it's at four and then you know imagine you decide",
        "that you don't want to sell your those four things anymore well then based on the architecture what you end up doing is you say cancel my listing and you'll you'll watch looks rare do two things one it'll remove your listing off chain and when I say listing your payload actually has your signature on it your sign signature and then what it also does it'll spawn your metamask wallet where you will connect to the smart contract and say hey going forward",
        "and four or less than four if you get a payload for any of those with that nonce do not let the transaction go through so basically you're you're canceling your order on chain as well which is very important and so there's this you know this Play Between the off chain wall and the unchain world and the kind of sync up using nonsense in this case you know that I was testing I looked up my my nons in the off chain side of things and it ended up being 103. and then what I was able to do is connect with the luxurious smart contract and say hey going forward 99 99 is the lowest non-seal except you",
        "know anything above that is great and then I made the listing",
        "we have the same effect I was able to make the listing for 0.001 watch the full price crash and nobody could buy it because when somebody tried to transact it the smart contract complained the nonsense expired and the off-chain world had no light has no idea this was going on so this creative situation where there is no way to get out of this the only way to get out of this is to use a completely new Wallace address right which may be easier for some of us but probably not an experience you want your customers to go through now I had to cut out a lot of stuff but I will tell you I could show you 20 different examples of where the off chain was tries to glue into the on-chain contract and they're not able to do it in the right way and you know I've talked to a lot of people in the industry and I've come to realize in my opinion the root cause of this and this is pretty rapid is that",
        "organizations that build applications on top of blockchains have this really bad habit of organizing their engineering teams in such a way that they have a separate smart contract team and then you have a separate team that does the web two or three gluing into the smart contract and it is my professional opinion that is a No-No you don't have two separate teams right and so",
        "takeaway number two is all the engineers if you have anything to do with the blockchain even if you're researching with it you have to make sure the team working on it can do off-chain and on chain and let the cycle through that the responsibilities no silos",
        "right and the other thing I would also say is if you're a board member or somebody that the product security leader reports into",
        "try and find out how how they think about this right and if the answer you get is I have a really smart team that does a smart contract and this other team there's something else fire them because that's not how it's supposed to work right and these are the fundamentals",
        "so we're still on zero",
        "and speaking of zero I'd like to introduce you to Xerox that's how the project team says it but I looked through the documentation there's no how to pronounce her name thing so I'm calling it Direct because that's your name um think of 0x as a library of smart contracts for the public good right so",
        "what what's happened in the blockchain world is more than 60 to 70 percent of the time people issue their own cryptocurrency right and then they want their users to be able to swap in and out of their own cryptocurrency and so they write a swap function and what 0x really is a bunch of functions that people write and rewrite and rewrite in the smart contract world so that if you do if you're writing contracts that most people write contracts for instead of writing your own contract you could just use your ex right so theoretically you could you know launch a a d app or decentralized application without writing a single piece of Code by leveraging 0x",
        "and during my research of like how people are you know I was very curious on how people are using their Ox as a library and I stumbled upon about five different contracts with with this pseudocode right and these contracts by the way are still alive three of them have more than a million dollars so if you can find these you can take the million dollars um so what what the pseudocode that you know described these contracts what they're what they're doing is they're taking a raw payload from an arbitrary user and then calling",
        "the Xerox swap function but instead of actually calling the specific function they're just sending the raw payload",
        "so it's like you know life lesson here is whenever you",
        "have the word raw and payload bubble up to your consciousness you know pause for a moment and ask you know what can go wrong right because a lot can go wrong and has gone wrong here is that the people who've written these five contracts that I was able to find I think there's probably more of them out there are expecting that the payload begin with the top the two you know what we call um function descriptors right which is basically the name of this function they're expecting that most all the payloads will call the swap function and I think my guess and why this may have been is that when the Xerox project started earlier on they only had swap functions and later on they added more and more in the smart contracts that were written were written past right and so for example the zero X bunch of contractors don't just have swap functions they have the ERC 721 function erc721 begin nft standard",
        "so now you can exploit this",
        "to steal money from a contract using an a fake nft",
        "from a contract that has nothing to do with nfts right so you could basically send this contract",
        "a payload that looks like this right where the function descriptor is really by erc721",
        "and in the red in HEX is how much of our money you want you'll probably want to pick the amount of money that's in the smart contract and you know you send this your way and there's a there's an ad you also have to replace one more parameter with your fake nft address and you'll find that the smart contract you know be a response by buying your fake nft and giving you all the money that's a smart contract um so there's that",
        "let's take the Xerox thing a bit further as I mentioned it also has functions that let you buy erc721 tokens and also one one five five in essence what Xerox has done here is you can create your own openc and look for a competitor without writing a single piece of smart contract blockchain code by just leveraging their libraries and if you were to do so if you were to launch your own nf2 Marketplace",
        "the the code there shows you all the parameters that you would need to you know really understand",
        "and the onus will be on you in the off chain world to make sure you're not listing orders with arbitrary parameters",
        "for example one of the parameters there is the address of the contract that signifies the currency in most cases you want it to be a bunch of ease which signifies ether",
        "the other case you probably want it to be the address of the wrapped ether token or you're most probably you'll probably also want to allow usdc",
        "die right but if you were creating if you're creating marketplace with this Xerox bunch of contracts you have to check that before you allow those listings right so what I found in about four different microplaces um I'll talk to you about the first one because they didn't check the currency right so what you can also do in an empty Marketplace is if you have an nft I can send you an offer even if you haven't listed for sale but especially if you're listed for fail you're probably paying attention right and when you send an offer depending on the marketplace you probably get an email some notification that you have an offer so imagine you get an offer for a hundred thousand each you're probably going to pay attention to that I would so you could send an offer for a hundred thousand eight because the marketplace assumes that this is all eth the way this is written or usdc but because there's no you know nothing being checked I could create my LOL token out of thin air and basically offer you 100 000 of my LOL token but the offer in the UI Marketplace will come through as a hundred thousand each right and then when you accept the offer to add insult to injury not only is your nft taken away from you you don't even get the LOL token and here's how there's also the fees parameter and what's supposed to go in there is the amount of fees that's taken out for the marketplace and also for the royalty that the contract wants to get right and if that can be arbitrary in this case it was what an attacker can do is basically",
        "say that they are the recipient of all the money and so you know the the victim get Gerald let me show you what this looks like in a simulation to prove that this would work",
        "Here We Run The simulation and we find that it goes through that the attacker gets zero and the seller pay zero well let's run that again but with more detail",
        "all right so what's going on here you go back up as I mentioned in the payload that the off chain accepted the attacker sneaked in the address of their own LOL token and said I'm going to pay zero then stick in their own address and said I'm going to pay myself 100 000 of these tokens",
        "and then you see the LOL token of zero go from the attacker to the seller the attacker gets the nft",
        "and then the attacker basically pays themselves 100 000 of their own token right",
        "I the habit of calling The The J pow attack where J Powell meaning Jerome Powell",
        "because I think he knows how to print money out of thin air if you've been keeping up",
        "I know we're close to time so I'm going to leave you with this one other thing that I'm seeing is that from an off-chain perspective years and",
        "nft lending application that has done about 40 million dollars worth of volume and basically what you can do is if you have an nft you want to loan money against your nft or you want to supply the collateral you would go here and this thing has done a lot of transactions so far but here's a here's the catch so you go to this website and you say Okay I want to loan 10 eat for this nft Collections and I want to earn interest as people borrow my Chinese",
        "you'll happily make the listing for example let's just assume you mistyped that 2008 and you have a thousand it in your wallet and if you're lucky and the bot doesn't take it you can go and click delete and it doesn't matter if you can't read it but the bottom right it just says okay yeah delete it but the crazy thing here is there is no on-chain interaction so this Marketplace is recording your signatures on the back end and an attacker and by the time every time you make one can also record these things and there's no telling the spot contract to cancel never accept this payload",
        "so you know in the future my estimate is",
        "that",
        "anybody recording these signatures depending if the if the flow price goes up or down can can can rock pull people who think that their offers or listings have been canceled but they have not right the other way to think about it I'm not saying this about this this Marketplace it could be is that if I was a marketplace where I wanted to eventually rockpool rockpool meetings steal money from my users at a future date and make it look like it was an honest mistake this is how I would do it right I guess you could say that about anything so",
        "there's a lot I couldn't talk about but you kind of sum those things together one of my predictions is that in the next coming months that it's the nft collateral lending smart contracts and dials is where I see the next generation of unfortunately rug pulls coming in people losing money",
        "um I'm gonna sum it all up what do we do about all of this um I think again we're still early and I kind of look at the nft world and the blockchain world as you know look at what happened to pgp makes sense but until you have a UI where the the normal users doesn't have to worry about the technical details we're going to have to deal with stuff like this right so unless we get to a world where people can transact with nfts without even knowing what an nft is that's when we'll get there but until we get there unfortunately all of us will have to be technically proficient",
        "to make sure that the transactions they're committing to are not going to you know cause them harm",
        "[Music]",
        "[Music]"
    ],
    "TJJxhcKyM-w": [
        "foreign",
        "ER closing the case of half double and Beyond I'm Andreas kogler and with me is yunusinga today we're gonna talk about a problem row Hammer that exists since 2014 and in this almost 10 years numerous exploits have been built and overall there are countless mitigations proposed currently there are mitigations in place in your modern memory but we show that they are ineffective and we think and we think that we can build something fundamentally better and we will show you today so we brought a research question with us and we think that it would be amazing if we could transparently correct arbitrary data",
        "flips from rohem attacks or general data Integrity um in memory if the operating system is in use and to start off we first will introduce the problem a bit more so the problem we have is raw Hammer row Hammer acts on dynamic dynamic random access memory or short DRM as we know it theorem is large cheap and energy efficient so we want a lot of theorem in all our devices this is why we use dram and it works the following way it's built every bit is stored in a Cell that's built from one transistor and one capacitor and the keyword here is the capacitor capacitors lose charge over",
        "time so we need a frequent refresh interval to reapply the charge to capacitor Story and there's also like another constraint for the drum the drum is usually organized in rows so if we speak today about the attacks or in general we've always focus on rows this is basically a unit of these cells in a drum",
        "now let's talk about row Hammer rohama is the hardware fault inside the drum where frequent accesses to ghiram rows can flip bits in neighboring rows you can see here the code on the right it's accessing two pointers across the one and the grass to two these map to the memory as you can see it on the left to these rows and if we now access these aggressors a lot in this loop after some time bits in the victim Row in between will flip so as we see here that's only the code required to produce flips in your memory so this problem gets even worse when we consider new and new generations that has the reason because um we want to increase the density of memory because obviously your devices get smaller and smaller but you want to have more and more storage on your device",
        "and this Ro Hammer enables many attacks and many counter meshes have been proposed and we will talk about the countermeasures today so so there's not",
        "only one variant of raw Hammer the one we have shown you is the classic double-sided grammar where we have like one aggressor above the victim data we want to Target and one aggressive below the data we Target and there's also a variant where we move one aggressor to a different position this is this one single-sided hammering where only we need only one neighbor and then finally we have a more complex variant where we just have one aggressor so we can already see that we have some spatial requirements from an attacker's point of view to actually Mount the attack on the drum let's talk about mitigations so the mitigations usually focus on some characteristics and I will start off with the first characteristics the Assumption I have is basically that these raw Hammer flips are infrequent so we could just use ECC then VCC memory right yes that's a good keyword we can now use error correcting codes so you might have heard of what it is heard about it we can basically build in the hardware additional Hardware written density to basically correct and detect a few flips and this is with this we can basically catch a low number of lips in our memory on every axis we perform another thing we could do because we need this sporadic Refreshers to refresh the cells in our dram it can just increase this refresh rate so growham is not quick enough to charge deplete the charges of the cell so we simply increase the refresh rate and we won't see any flips anymore and also a good point here is that the attack we showed in the beginning where we have X alternating accesses to this far at the regressors and we introduce the flip in the victim we need to perform that within one refresh interval if our tactics longer than a refresh interval the data will be refreshed again in the capacitor and we won't see any flips so from attackers point of view we have to optimize the time it takes in order to induce a flip and this is usually 64 milliseconds it's the standard refresh interval for Dram the second characteristic is that attacks are deductible usually we can use performance monitoring counters to look at the cache",
        "behavior of our CPU because we got a lot of cash misses if you do row Hammer because you always have to go to the dram we don't want to do any data from the CPU caches so we see a lot of cache measures we can deduct this and if we detect something like an application or a process that has so much cache misses we can then proactively act on that and probably stop the execution of the program the third characteristic we will focus on is like you've seen in the patterns we have to have this neighboring constraints so one characteristic here is that we say is flips only manifest in the neighboring roles and with that we can basically",
        "um classify or build a few uh mitigations the first one is guard rows you can use every second row in our drum for other data for example there is work that uses this for intricity protected swap space so you effectively reduce the memory of your real dram and have more swap space but then you're protected because you cannot Hammer the victim here hammers",
        "he will flip guard Rose after some time but the victim is protected a different idea is the targeted row refresh as we talked about the refresh window is important and now we can place additional Refreshers on the victim if we see that the victim is getting basically hammered so if we see here the access is too aggressor after some point we count the axises and after some threshold is reached we will issue a refresh to the victim and prevent any data flips on the victim roll this TR is actually part of the lpdr4x standards so probably every phone you use and every smaller handheld device uses this memory that has this active role mitigation built in okay so if we have now talked about the characteristics so if everything would be fine we will not give this talk so let's start the cat and mouse game about the raw hammer mitigations and Terror attacks",
        "because there's some problem with Rohana mitigations so let's talk about it so the first assumption where we say that frips are infrequent that I can simply build ECC into it and catch raw Hammer that's sadly simply not true modern devices are so badly vulnerable to Raw Hammer that there are just so many bit flips that ECC is not enough ECC can at most detect four bit flips it can only correct one bit flip that's simply not enough sadly what about the second characteristic that we can detect them with performance counters so me as an attack here I can just monitor my system behavior and see if I have cache mates and go to memory cannot then proactively do something let's for example report the attack into an sjx enclave as Jacks enclaves are completely protected from the other system and there are no performance counters updated and we actually did this in one work so other characteristics 2 is not that good for against raw hammock for Roman for rawhima countermeasures but what's the final one the distance one hammering we have seen that all these patterns the induced flips with a distance one so trr and also the guard Pages they should be fine right so that's a big problem with trr it's that it's a mitigation built in hardware and it has to count the excesses to rows and there's just not an infinite number infinite number of counters in the hardware so if you do really complex success patterns where you do multiple attacks at the same time you just exceed the counters and TR doesn't work anymore okay so similar to Resource exhaustion yes okay so but I'm still this sounds like an implementation problem so if I have a limited amount of counters I still can make a better TR implementation and fix it so I brought to you a question can we build the perfect trr in order to fix that raw Hammer problem no sorry not I present to you the half double effect so this effect is a bit more convoluted so we have to start off back again so we go back again to distance one hammering so with distance one hammering we have seen this attack pattern where we interchange these aggressor axises and we Simply Now measured how long it takes an amount of excesses to induce a flip into the victim role and we can see with 20K accesses we get the victim to flip this takes around 1.2 milliseconds and if you remember that's within the refresh interval of the dram however we have an active defense against that that's trr so we are protected against that then we have distance to row Hammer where you where we Hammer one row further out if you do this we see the first flip after 4 million hammers this takes 270 milliseconds so that's a lot longer than the standard refresh interval so it's not possible to use distance to row Hammer to hammer on commodity devices",
        "yeah and the half double effect is now basically the combination of these two we have a lot of a lot of with many accesses with resistance to aggressors combined with only a few of the distance one aggressors and if we perform this pattern we have to trickle tunable parameter here that we can basically change the rate between those two but if we perform this we can induce a flip within 20 milliseconds of hammering and that fits into refresh interval and the problem now is we don't we have to be a bit more precise what the role TR plays here",
        "so yes let's take this example so an attacker is hammering again and it the attacker only hammers the far aggressors here after some time TR wants to predict this new aggressors because here are things they are attacked by row hammer and here R does accesses to the near aggressors and it's only really a really small amount of near aggressive excesses but these are enough to somehow transport the rohuma effect to the victim row and flip a bit so here are the mitigation is actually helping us hammer and the best thing is or the worst thing the more refreshes trr does the better it tries to protect our system the more bit flips we see so we turned here are completely around so this means by now that we have basically in our chips we have an active TR which have active TR in there the half double effect is actually um there and also we try to find commodity devices which use which are affected by this effect and we build an end-to-end exploit to show to demonstrate that this is actual problem and for that we focused on a Chromebook device which basically our Target is these um physical um physical frame number specific page frame problemas which are located in page tables yes and we defined four",
        "challenges that every Rohan exploit has to solve and we found novel solutions for each of them the first one is every Rohan exploit needs contiguous memory because we need a mapping from virtual memory to a physical memory which we usually don't know if you have a continuous mapping this helps a lot think about the patterns where we have to place the rows at the specific order in order to build those patterns we need to know where the location where the rows are located in memory then we do an alternative to memory templating the device we have here is protected by trr and ECC this makes rohe Hammer bit flips a bit unpredictable so we skip the templating process altogether",
        "then we do memory massaging to put page tables where they should be to put them in the victim rows to hammer them and then finally we do bit flip verification where we verify that the hammer is the bit flips we introduced with row Hammer actually well it's and Do Not Crash our process and we will go into detail for the fourth challenge the fourth one is a bit more interesting because if we flip a bit by accident so as an access point of view if we flip a bit which we should not flip we have the possibility to crash a complete system this doesn't bring the attacker anything except for the narrow service so we need a way to verify that we can basically safely access that memory location we just hammered and we combine this with transient execution so basically we found that these Corruptions which the operating system detects and then shuts down the system are not performed if you perform it transiently so we can start a speculation window then perform the memory access and if the speculation window succeeds we know that also the X's without speculation will succeed and we can access that memory location we just have targeted yeah this makes our group exploit really robust and this makes it possible to exploit the device in under one hour we are able to get full read and write access to the whole physical memory of our Chromebook device and from there we can read and write kernel memory induce our own codes and do whatever we want basically so with this figure we show that we can also paralyze a lot of the steps in this end-to-end exploit and we will now focus a bit on the longest part of the C2 that's basically the hammering process so it takes on average 23 minutes across multiple devices to get a flip and we will now demonstrate that with um foreign",
        "we are sshing into one of the Chromebook devices we have at home in Austria because someone forget to bring them but we hope the connection is stable",
        "and Andreas is now starting the program that does the flipping so here we get our physically contiguous memory to know where which virtual addresses we have to access to access the rows in the drum we need to hammer and now it's hammering so now we usually make the big gamble if we see a flip before we start stop looking at the terminal and so this is a real thing this happens by chance there's a chance we see bit flips in the next minute we hope so so also like are the commodity devices and here's the first flip so yeah so this is a real problem and with that I hope I have convinced you that this is actually the case for modern devices and we have to be a bit more specific so we're just searching now for oval flips so we're now hammering with this pattern we showed you where we have like only accessing this file grasses since the near aggressor accesses so these closes are actually performed by the hardware so an attacker only accesses those systems two Hammers and",
        "um yeah and also the point is that this is our most affected Chromebook so this is",
        "so there are multiple devices and an average it takes 22 minutes this one is a bit more affected by half dollar than other devices yeah and also like to be searching for any flips for an attack to work we need a precise flip yes this is why we see so many bit flips now and then real Attack it will take a bit longer but yeah so this is a real problem this is a bad problem this device should be protected it uses ECC and trr can we do something better",
        "so by now I hope we have convinced you that the current state of the art of mitigations with these underlying assumptions is simply not true we have seen that some of these assumptions can easily be broken and even the most obvious and convincing assumption that you can only induce spit flips into distance one is by now broken so overall we have all these mitigations seen in the past and now we want to finally rethink for him and mitigations we want to have a general approach to take the Integrity protection where we don't have any assumptions on how rowheimer Works what the characteristics of row Hammer are where the pit trips even come from it can also be cosmic rays or whatever we just protect data integrity",
        "and we do this by using a message authentication code for all the data that we store with the data and compute and compare to detect data Integrity failures so we've talked a lot about this ECC so the error correcting codes and now we'll make a similar approach we replace ECC but with something different with the Mac yes so but this is easily done so we can easily replace we have the Space Center we can easily swap those two out but it comes one big problem with a Mac we can now suddenly detect all those bit flips by design a cryptographic Mac is there to see um so changes in the data and the Mac if the max don't match the data has changed however Max are not designed to correct the data again so we have to be a bit more complex the correction gets made complex than in error correcting code yes so we can only do a best effort correction we cannot uh we cannot prove that we can correct any number of bit flips but it's still enough because if we just detect all the attacks if we just detect every bit flip in the worst case we degrade all row him attacks to denial of service so even if we are not kind of correct the bit flip in the worst case the device has to reboot or we have to shut down some processes but the analog service is the worst thing an attacker can do so that looks super theoretical how does it look like okay I prepared a small animation here this is the dram this is where your data is stored and this is also where row Hammer destroys your data and here we have the memory controller and it has a small Hardware a change to compute the Mac for every data that is stored on the dram okay but now you use the DCC chip right from yes then we use this Mac and we actually use ECC memory so we have the same Army overhead as every server or something like that and we can even drop in replace different modules so we work with normal ECC different modules and on this additional chip of the ECC Dura module we store our integral information that's the mac and a few parody bits okay so now we know the Mac we know that we have the data and we have a Mac so I assume on a read we now compute the Mac again and check if it changed exactly and I read we just do exactly that if the max are the same we know the data is fine if they are not the same we can correct the single bit flipping Hardware and this is okay for most of the use cases so we're just correcting one flip yes that's not much that's not much that's enough for a lot of cases where system is not under attack a single bit flip can happen if a system is under attack we throw hammer and the ram is really bad more bit flips can happen and this is where we bring software in we have a new corruption exception that's handled by a new exception Handler in the operating system everything in software and this uses correction as a search I will come to this in a second to correct the data and we have three new CPU instructions that this correction as a search uses okay that's a cool idea to bring software in there because suddenly we have not only the data in the Mac we also get the context of the data and that's super important because the operating system knows best at which location which date is located think of if this page is actually located on disk we don't even need to correct it because it's just a copy of the disk data we can drop the corrupted data and reload it from the disk we suddenly get a lot of new opportunities to recover data except for correcting the actual flip",
        "yeah that's really nice there's one small problem this operating system and the exception handling everything that software that's in the dram so if I know a super smart attacker I would just Target another software with raw Hammer so if they're doing something like this yes so the software is also located in memory so I can now induce flips in the exception Handler that should handle flips to prevent this we added a small secure memory to the CPU it's only four pages large that's nothing compared to all the CPU caches we have in modern CPUs so area overhead is not a problem here and we had our exception Handler in this small cqs RAM on a CPU die it's not affected by raw hammer and we are pretty much so that memory is actually different technology than the DRM we want to protect exactly so Jason or him are there okay okay that looks like an interesting concept but now we do a Mac computation on each memory axis in memory right that must be super slow it's not so we use this Mac design we use a pmec construction where we do most compute 4 data blocks in parallel and we use the karma block Cipher which is developed by Qualcomm and used in almost all arm CPUs for pointer authentication so it's already in use in CPUs right now and it's really low latency so we can compute the Mac of 256 bits data in only 5.13 nanoseconds and you have a if you have a bigger data World 512 bits we can compute the Mac in 6.6 nanoseconds compared to the average 100 nanoseconds a duramaxis takes that's just a small additional overhead okay I'm getting more convinced but how does this correction in a software sense actually work so now we have this exception and you handle that exception right yes so we have this exception it looks a bit like a page full Handler from the outside we get the physical address from where this bit flip happened where the corruption is and the CO2 register and then we have three new instructions the first one write the physical address that's a good question because you cannot trust page tables at this point page tables are a really good Target for Rohana attacks as we've seen in the explored so if you would have a virtual address we need the page tables to resolve to the physical address and therefore we directly get the physical address and then we have a load instruction that loads this corrupted data into a CPU register using the physical address then we have instruction to compute the Mac so we are not doing the Mac computation itself in software that would be too slow so we do their Mac computation on Hardware and then we have instruction to write the data back into the memory if it is corrected okay so there's only three instructions we have to add to the instruction set in order to perform the correction yes but but still we're going back to the error correcting code case we're now using a Mac a Mac can not correct bit flips that's true so this is why we do only a best effort correction the only thing we can really do is boot for search with approximatic quality so both for search means we flip one bit we compute the Mac We compare it we flip the next bit we compute the Mac We compare it until we flip the correct bits the max match and we are happy we know that we corrected the data the problem is that the Macs are also in the dram and if an attacker hammers the dram also bits in the Mac could change so what we allow to help Miss we allow a small number of bit flips even in the Mac to be different so here we see that we have the same data but one bit in the Mac changed we still say okay we're pretty confident that our data is correct more on this in a second",
        "and then we use some parity bits to shrink the search space so we actually get a quite good performance with our boot for search so with the approximate equality basically we we say that it's unlikely that the two Max are similar enough right exactly the chance the two Max is similar if the data is similar at the same time is extremely low and this protects us here okay okay we're getting there do you have any numbers so how how fast is software brute forcing that sounds like a terrible idea to brute force and make it does but it's not that bad so here we have this graph on the left the bar you can see ECC memory this is just the it's a bar because we use the numbers for many different CPUs ECC correction takes a different amount of time from a few nanoseconds to up to 10 milliseconds and then the Green Dot is how fast our single bit correction in Hardware is and then the blue line is the correction in software first there's a huge overhead because of the exception and everything these are these 200 200 microseconds and then the overhead from The Brute Force search itself takes over but you can still correct up to five bit flips in under seconds and under second and eight bit flips in our almost reasonable time of a few hours if the data is really important maybe a few hours is still a valid trade-off",
        "okay um the video we also have more evaluation based on the game 5 Hardware simulator so we implemented CSI rohama in hm 5 we",
        "implemented the Mac computation we implemented all the CPU instructions and then we also modified the Linux kernel to include the exception Handler and do the Brute Force search and everything so there's actually like a real prototype of that simulated right because they can't build Hardware we cannot change the CPU Hardware sadly but there is a real prototype in software that does everything",
        "and we evaluated the correct functionality with this so we just simulated bit flips in hm5 in HTML5 memory and it was able to detect them and to correct them and then the system kept running even with bit flips in the kernel and everything and we also use this to evaluate the performance overheads for a system that's not under attack we just added the latency for every Mac computation to every memory access to the dram and we use this performance or to do to get the performance overhead which you can see here so in a graph you see around on a mean overhead of two percent which is five percent one percent sorry and we",
        "have a worst case of four percent overhead so if you think about it it's a back in impact on the performance however with that we have seen we can basically fix all raw Hammer type data corruption we can fix normal data corruption or like um the cosmic rays you mentioned from yes from different sources we will just detect any number of bit flips for a worst case overhead of four percent still there's one part still missing and that's the approximate equality we maybe we have some crypto people in the crowd and if you're talking about we have Max and something we don't care about a few bits that sounds dangerous it does so we of course have alerted the security of this whole approach because doing stuff with Max is always about probability that things things can go wrong and things will go wrong after some time it just depends on how long this time is first in the approximate equality",
        "if you have for example five data bit flips then we need p",
        "um different Mac computations to check all the possibilities for which we can have for five data bit flips so during the push first search we have to flip five bits and all the different possibilities are p and then we take log 2 of P at the same time we allow D3 bits in the Mac to be different so that's the approximate equality that's the proximate equality three bits can be different this decreases the strength of our Mac from 56 bits that's our make length to only 41.2 bits so by only allowing three bits to be different this decreases the Mac strength by a lot but the 41.2 is still a lot larger than 26 and therefore this is still secure so the chance of finding a second pre-match instead of the real correction is still really low and the further we go up with data bit flips we search we have to go down with the number of bit flips that are different we are in the Mac so if you have eight the bit flips we cannot allow any bits in the Mac to be different otherwise the chance of finding a second free image instead of the real data would be quite High",
        "we also also looked at the silent data corruption rate for a system that's not under attack so we took data from different works that looked at bit flips",
        "happening in huge server farms and how how often this happens and we computed that if we use this natural data of bitflix happening the chance that the silent data corruption happens which means that one bit flip changes the data in a way that it is actually a second pre-image of the original data and the max are the same happens once per 10 to the power of 9 billion years so that's quite secure will take some time yes yes and if a system is under attack if throw hammer and this row Hammer is attacker is really fortunate the attacker is able to flip bits every 128 milliseconds for a",
        "full year so this is way way worse than the Chromebook you just saw it's like 10 flips per second for a full year straight then the attacker has a chance to find a second pre-match um with the chance of 10 to the power of minus four percent so still really low and also this attack is not really realistic that has so many bit flips so let's go back to Chromebook case again so basically what we saw if we do it for one year straight through we would have seen I don't know millions of flips on a Chromebook yes okay",
        "okay so we mentioned that we have software in the the big advantage of this approach is the software but we also wanted to take a look on how easy would such an approach be to apply on a wider scale and if you think about it it's a software Hardware co-design so we have software changes which are usually easy to deploy and also we have Hardware changes which take some time to get adapted to but if you now think about like virtualized environments like server Farms like AWS or something like that we can basically use a virtualized environment in order to transparently protect our guests now against data corruption basically we just perform the approach which has talked about on the host system and if a guest accesses data and the corruption exception is raised we just catch it in the host system the host and transparently corrects Brute Force searches the correct value and then each restarts the guests after the corrections of after the corruption is fixed so we have guest support is only optional we don't need it if a guest supports you it would support CSI raw Hammer then it could also do Advanced correction mechanisms like Reloading Data from disk and stuff like that but this makes upgrading relatively easily so if the hardware changes are there then a server Farm could easily upgrade all the systems to CS arohama by just upgrading the hosts and the virtual machines can run as is which is quite neat so let's talk about about a few possibilities we have so we have seen that we have now basically the problem to find a correct value for a given Mac and we can simply think about it get a bit created so we could offer basically like data corruption correction as a service so you give me your corrupted data and I give you back the original data that matches the Mac sounds reasonable we could also do something like correction by GPT software opens up so many possibilities so you can just ask ask.bd find the error in test message you probably already found it so let it test the following hash this should be the hash of the correct message and chatgpt answers the",
        "following this is not really possible because a hash function is a one-way function therefore it's not possible blah blah blah I mean that sounds quite reasonable but yeah so I asked it if it can Brute Force the answer for me and that's certainly not possible I mean maybe we need a new version of this you forgot to you maybe it does the problem",
        "so no no back to topic so if you really think about it if you have like a server farm with big scale we could for example deploy an fgba is on accelerator that's dedicated for the specific task of finding finding the correct value for the corruption and we could forget like a half a million Karma blocks on the device and largely scale up the performance of this correction finding so it would no longer take five hours on a standard CPU but only 40 seconds for an 8-bit data flip in a single data world and if you go back again to the Chromebook case there we see not so many flips in a data world we see a lot of flips but not like many in the same data world so there we already gain a lot you're thinking that okay we are going from a hardware deduction to software and now back to Hardware acceleration that doesn't really make sense but it does because we don't need this Hardware acceleration in every computer in our server farm for example if a server Farm has only a few correction nodes this is enough because 8-bit flips don't happen all the time they have maybe for one system that's under attack or for another system once per year so we just have a huge server Farm we have one data correction node that has some Hardware accelerated correctors specialized data",
        "correction notes exactly this is all stuff that's possible because we can do things in software",
        "and also if we go back to the examples we mentioned now we have finally like the context for the data stored in memory and with that and the kernel and the operating system probably knows best we can now basically protect things where we know where to reconstruct the data from so think of Kernel code if we know that we have a flip on that position in the kernel we know probably the function which it belongs to and usually columns don't do cheat code or something like that so we can simply reload the code from somewhere else we know that code also for page tables the one thing we targeted in the exploits we cannot use the the operating systems representation of page tables to reconstruct the page table simply after we've seen that there's a flip or other structures like for example the task struct there are many values in there we know which ranges these values can have we know which are valid values so when we do a boot for search for structs where we know the data or how the data should look like we can extremely improve the Brute Force search because it's not the Brute Force search over the whole data but only values that are valid for this task struct let's say user ID can be at most 65",
        "000. yes and then we know we only have to search this range if we know there is a bit flip also there might be data structures where flips are irrelevant if you have a flip in a JPEG for example or pH of a JP not for B and G you might not even care about it so if you know context to the data you're actually protecting it makes Much More Much things more flexible in the same sense and the biggest example we could have is think of a page if we have like four four kilobytes of memory and we know that we can reload the data from the disk we can basically correct 32k bit flips in the worst case or in the best case with a single reload of a page that's way more than the eight flips we can correct as a search because now we have the context we know how to get the data back and also like there are a lot of optimizations we could use if we mentioned that so like this program mitigation or this data corruption mitigation in general to beyond that scope we're currently yes the same thing because the main performance impact of CSR rohama is caused by doing the Mac computation on every memory read and every memory writes we always have to compute the Mac but the Mac will be true 99.999 of the time the Mac will be correct and the data will be fine so we could simply transiently execute with unverified data while the Mac is checked we already do transcend execution but yeah there's a whole track about Trends and execution attacks and how they go wrong are you sure you want to do that I just say it really shortly here there is work that tells us that this can be made secure we didn't evaluate it fully but we say it is possible to do this and then we would have CSL Ro Hammer with no performance impact",
        "that sounds great so with that we already come to the conclusion and I hope we have convinced you that mitigations for Roar Hammer with assumptions on characteristics of roheimer can go wrong are they are going wrong that we have basically we ran through a list and yeah if you bring software to the error correction and process we have so much more flexibility to do things we can do the Brute Force approach to try to find the correct data to the Mac we can reload the data from disk or I don't know from a network outside the correction yes we can do so many things",
        "if you are interested in this stuff all our code is open source so the exploit is the half double you can look at the exploit code and all the hardware simulation and modified Linux kernel and everything for CSL Hammer it's open source and you can run it yourself and experiment with it and also for the exploit code there's also like like we heard in the keynote it's more like how to find if you're affected we also have like tools to find out if you're affected or not yes you can simply run yeah if you're interested in more details read our papers there is a lot more stuff going on that's interesting and with this thank you very much and we have two minutes for questions so if someone has a question there's a microphone in the middle actually we have seven",
        "equals 240.",
        "what no we have seven minutes for questions oh we have seven minutes great so if there are any so thank you",
        "[Applause]",
        "[Music]",
        "[Music]"
    ],
    "TDSgRWOeS-4": [
        "foreign",
        "thank you for coming to my talk I'm sorry that I cannot be in person for this great conference but I have my best on this on this online virtual speech so let's just start so I'm from China and my name is you can just call me 11. the topic of my presentation is deep into Android Bluetooth spark hunting attack service",
        "and record patterns so next site",
        "so first is some introduce some",
        "introduction about myself right now I'm a security researcher at Oppo Amber security nav uh in recent years I have many folks on Android vulnerabilities research and also work on iot and workers in my spare time so if you have any question about this talk or other topics so you can contact me at any time with Twitter or our email",
        "the printation is divided into formation",
        "so in the introduction section I will talk about some basic information about the Bluetooth and some previous research and historic vulnerability analysis Android Bluetooth and next I will show you some uh Tank Service I know and then I will introduce some useful messages including code audit and filing so the family uh there will be a brief summary and a look for future work",
        "so let's talk about some history of the Android Bluetooth thing",
        "uh before Android before enter 4.2",
        "Google purchase producer which is the default Bluetooth protocol stack for Linux but but however blue is not suitable for Android platform therefore about two years later Google and broadcom developed to be a player to proceed and for Android 6 to Android 13 Google uh changed the name of the Bluetooth protect stack twice so uh the rapid iteration and code refactoring a few years makes Android Bluetooth more and more powerful but but on the other hand it also makes the code more valuable in addition the Bluetooth codes next unit test and the script audits so making uh",
        "its secret ads are wearing low level in the year years so and moreover Bluetooth has a wide range of application scenarios and the complex protects so",
        "this reason means two constant discovery of security risk in Android Bluetooth stack",
        "uh look right look at this diagram this diagram shows that Android Bluetooth architectures it shows this relationship between the different layers they are five layers so from top and to from top to report those as follows application",
        "framework layer and Bluetooth system service GLI Bluetooth stack and window and each layer communicates with other layers through the different IPC such as band IPC and the GI calls uh and based on the principle of least",
        "privilege this architectures reduce the",
        "attack damage but on the other hand among layers also give me more chance to find more attack surface so next slide so in recent years researchers have also published many research results on Android Bluetooth the Bluetooth is among the most influencing ones so it is a series of Bluetooth mind abilities in dangerous multiple operating systems including",
        "Android iOS and windows and Linux",
        "and and due to this disclosure of blue point and more researchers began to focus on Bluetooth security and of course I'm aware of them so I'm really grateful to This research researchers for publicity for publishing uh their their real results",
        "and I checked uh the statistics of",
        "series of the Bluetooth module in the past six years uh based on the data from the Android secret proteins so since Anderson no longer published detailed information about media and no one abilities so the statistics only",
        "include high and critical and you can see the data the data shows and security researchers have found at least 148 vulnerabilities and including",
        "including 1999 high and 49 critical",
        "and finally chart below it can be present almost half of the vulnerability were discovered in 2018 so this is",
        "because many gestures began to Bluetooth vulnerabilities after the disclosure of blue point and the other reason is the code quality of the produce Bluetooth module was not high in 2018 so for example almost our protect stand",
        "codes do not check evidence of the input data so this which results are United's number of memory passing vulnerabilities uh and up to now a most of uh most of the the bugs are also still memory corrupting type",
        "so next sites so this is the most uh most important section in this talk and because I think it is necessary that to send out our our possible attack surface",
        "before finding one abilities so this technology and tricks about how to find vulnerability are just icing on the cake of course uh this is my own way",
        "so before starting to expand I explain",
        "the attack surface I will first literally a Bluetooth architecture diagram for the perspective of the attack so the diagram is complex so our grants that we realize the content to show you what I know what to know about what I know about the Bluetooth attack surface so first of all I activated it into three areas the host the control and the remote the host error I implements our Bluetooth stacks",
        "on the up layer and under the control error can be simply regard as Bluetooth chip which is used to receiving Banking",
        "and transmitting Bluetooth video data and the remote error is just a Bluetooth",
        "device just like uh but it was hit set bluetooth mouse so and so on and other other Bluetooth device any things",
        "ah so let's come uh this comes the Bluetooth system applications so which implements most Bluetooth core functions explaining concepts of three modules so",
        "the first module contains multiple bluetooth profiles Java service this service provides capabilities to update",
        "applications through the exposed interface",
        "and some of the more complex Java service communicate with the Gmail module with the geometry through the Gmail interface",
        "after doing some type of conversation from Jr to Native will continue to cover the native module named Bluetooth through the registered interface function and this native module implements the core functions of the most Bluetooth protects and profiles and most of the vulnerabilities are also found in this module so let's look at the framework",
        "layer the framework layer there is a Bluetooth managed Java service so this this",
        "JavaScript is resist in the system service process and it burns it depends a JavaScript of the Bluetooth system application and then it explodes the",
        "public interface to the up to the up-use application",
        "Android also also implements a local",
        "native Health sales called uh called Bluetooth PD but this service is not enabled by default uh on my on any mobile devices",
        "but but according to the public's information I found so I found it will be enabled enabled on some Linux platforms or other Android TVs so and",
        "Google has also assigned a serial number to these servers so maybe this is uh need to learn but good attack surface",
        "uh let's go let's go on so so the top uh the top is application application layer uh activities in uh into untrust",
        "unswaster app and and Hardware",
        "applications are based on the privilege level the untrust the untrust application is just it's just a third-party application that can be done in the Google APB store and other and",
        "other APB store and the hardware application has high privilege so that so that can have this right to call a hardware service okay next",
        "uh next uh is",
        "uh",
        "so let's go on",
        "okay the first attack scenario is the most common one uh named named the money shows Bluetooth video and somebody speaking it is refused to the malicious Bluetooth data packs sent by Bluetooth device such as headphones and keyboard",
        "so when I talk to Android device I receive these monitors and my formed data packs and and if the code is not perpendic handled it may cause some vulnerabilities",
        "so in this scenario the test flow is exist",
        "the first a Bluetooth device will send some Malaysia State Banks and at this moment the Blue Chip will receive it and transmit uh transmit it to HCI layer",
        "through the Canon driver after some internal process work",
        "in the native module the packs will be unpacked and attracted and distributed",
        "distributed to each particular and profile fulfillment processing and for example the Bluetooth audio data will be transmitted into every DT and Arc and avct and HTTP for for fielding",
        "parsings",
        "so uh so through through this tracking of the data flow uh they are at least three vulnerabilities here the chip code",
        "maybe I had to do a skill when processing manage your status and and memory corruption bugs may occur with the native code passing and the transforms the protocol stack data and the addition the Callback interface of the gni may have the security risk when processing data that is either large or short",
        "so let's let's look at the six tank scenariators so that is uh managers and",
        "Trust applications so image if a tank",
        "can install an application with no more permission to on the attack device so what attacks can be performed",
        "let's sample follow the address to see the enter calling process",
        "so data will flows through four four module modules and two types of risk are approach to occur so first with the untrusted applications versus Java",
        "service if some high risk interface do not perform a permission check so it may need to risk such as unauthorized assist",
        "on the user previous leakage and the",
        "second some Bluetooth profiles also allows the user application to do some initializing initialize the settings so",
        "that means the untrust application can",
        "pass some data to the native module so at this point if the native code can handle the data improperly it may cause some memory corruption when a bit artists",
        "uh so this is uh similar to the previous one and let's look at the flow",
        "so the difference is that the Bluetooth PD service is a native service so it contains some C and simpler Plus Code so there may be some memory corruption box if the codes do not check uh the inputed consider if the uh if the input date is too big or is too small",
        "uh the source unreal is magnesius Hardware application so if an attack has",
        "already gained local privilege uh explanation so then it is possible to",
        "launch a text on the Bluetooth Hardware application how do we uh no no uh Bluetooth Hardware service",
        "this risk",
        "oh sorry so there is this risk here mainly depends on the security of each window code itself and this most likes why are some risk conditions and out of bounds read and the right one abilities so I have found some some very bug uh a few days ago but I cannot give you the details today",
        "so the last attack scenarios is malicious Bluetooth chip so this is because uh in the Bluetooth architectures the host layer and the control name are separate uh so so uh so in series uh the host layer should not complete trust and data passed as fast as any data passed by the control uh so of course uh since it is uh difficult to satisfy the",
        "preconditions so this risk would be small if there is anything but but I haven't found some some parts in this scenarios",
        "uh the Blue Chip uh just uh passed the data to The Host the host news was a Keno driver so during passing of the some method even type data packs memory corruption bugs may occur",
        "so next site",
        "okay uh so uh let's pull out the tank scenarios in one picture",
        "so you can see this picture uh so but but due to the Limit term of this talk I cannot explain all details so I have marked some three numbers in each module so you so so if you are interested on this you can check this history vulnerabilities and take a deep div into this attack service and you uh and you also can contact me",
        "the next site",
        "so in this part uh I will give you a proof a brief uh introduction on how to find these vulnerabilities through this attack service talked before",
        "we've used two methods code audit and funding and the code audit allows us to review the whole life scale cycle of Bluetooth spec data but the biggest disadvantage event it will take a lot of Manpower and resource so so therefore I built some weak code patterns and use code scale for automated code audit the",
        "other method is fighting so I have used the Thousand technology on other modules such as multiple media file browsing so I often used AFL tools and nip father for testing but however in the Bluetooth module the situation is different so in",
        "some previous week researchers usually fast bluetooth remote training but uh in",
        "my opinion as this this method is if inefficiently and question and it is hard to combine code coverage to improve the first effect uh so so",
        "based on these reasons I decided to use local files with uh simulated simulation",
        "also uh before before talk about the technology you need to know uh two types that are frequently used in Bluetooth source code so uh the left side this side the PT HDR structure are used to define the header of each buffer used in the Bluetooth stack as then and the data in the structure as evidence of the input Bank data and the input Bank data buffer advice so the following three codes blocks will come in source code so you can see this code in everywhere and are many used to obtain this star advice and understands of the buffer and in addition we are a series of common macros definition mainly used to",
        "extract data from user input you can see the Maxwell in the website these markers themselves have no bounce check so this is important which means that as a column needs to ensure that the bank check are performed before calling these markers so main history uh many historical vulnerabilities have occurred in this Marcus course",
        "okay let's talk about some record patterns the first come type is inter-overflow in stream B",
        "instrumentalization so let's look at uh some example so this function this function receives and the process incoming data the code using markers to",
        "expect one of type answer in the 16 from",
        "the untrust data and then it will store it in the number variables then the damper variable is multiport by four understood in the size variable of the same type so uh since the input data is complete controllable so if number is a is a large enough so inter under workflow will occur during calculation of the size so you can see the comment in in this code and make the value of the size smaller than the expected value and then need the size of memory space located by",
        "the digital variable is more than they expected and finally it will cause a lot of bounds right vulnerabilities in this for Loop so so also this is a very simple example but it actually Bluetooth code I I did",
        "find some some Series so let's just uh try to write a codecare script to check this time back",
        "oh okay uh the first step I just we need to find our calls to these macros by filtering only assigned expression type",
        "okay you can you can see the uh say the code the left side is the codecare code and the right side is as website is a c plus code",
        "and the sixth step is to identify our expression that called the macros and showing the code and you can use insta you can use instead of carrot to achieve this goal so this so this code this codecare code is simple",
        "also in this in the third step we need to find the case uh whether this is the serialized value are used in arithmetrical Explorations so uh and",
        "which can be done by uh enumerating",
        "common Expressions such as safe self self extreme selfies",
        "self self increment and audition and",
        "multiplication and charging where this",
        "deserialize the wine used in this white wine uh so a last Point uh in order to reduce false positives I include the case where there is a very high probability of low overflow such as the situation uh with",
        "the maximum value of the left while variable is much quicker than the maximum maximum value of the white wide variable uh this situation you can see in the uh and in the right in the right",
        "so the last step uh after running this script on the nipple's library I got a lot of results with quickly however this script is is used and codecode itself has limitations imitation so most of the react are false positive uh such as cold here such as they say code here uh the script can also recognize its relative complex calculation expression",
        "but fortunately uh",
        "through the fusing menu analysis I also found fourth really secret box",
        "so let's just talk one of them so this vulnerability is located in the sdp protect stack the value of the current handle is read from the controllable buffer and it can take on",
        "any value from zero to answer in 16 marks and the current",
        "handles will participated in multiple",
        "subsequent asthmatic calculations",
        "and multiple inter overflows may occur which will bypass this check of data data boundaries so finally needs to add out of boundary bugs in the for Loop so I have with some comments in in the code so you can you can look this next site",
        "let's talk about another one of the things I found so this is one vulnerability is also the lens check is bypassed due to enter under float",
        "this is similar seminar with the previous vulnerabilities and you can give the details from the code",
        "okay so uh let's look at the six the way code patents I used R3 due to including error States so the Android Bluetooth implements a simple memory management mechanisms uh the OSI molecule and OSI",
        "free function are simple income solution of medical and free functions so uh we have audit the code I found that the pmsg object will be passed in multiple functions especially send others received between different handles for processing through the message Suite so this architecture uh was uh will bring some potential risk",
        "after after this object are followed many times some memory securebox approved local such as users are free and double fluid so let's look at let's talk take a look at this simple example",
        "so after this P Mastery object is passed into some function uh it will be free under interpret it will be free on the third condition but but the color does not check the return value of some function and directly use the pimentary object later so this this will need uh",
        "use a few use of user user free one abilities",
        "also so the conclusion is that the code is possible when ability if this if this is a reach ability for between the allocation flow source and this reference sync",
        "uh so let's write this code script",
        "so this code scale script is slightly more complex than the previous one we will use which ability alliances technology so first we need",
        "we need to define the OSI free function in the script here here you can directly",
        "use the dialect function which is provide provided by codecode itself and",
        "you you can you can field it by the spatial function name you can see I this is the space function the spatial function name here is OSI free and OSI",
        "free and received",
        "so the next step the next step is to find all expressions and call the OSI free function so here I mainly looked for three types of course in so C code Block in the right",
        "the first is directory call analysis is",
        "a direct free call with assigned one and the third is Intuit free calls so so uh with this with these three types we can cover most of the case so maybe we we also may include some some situation but uh that's okay",
        "so another we need to find the expressions and may uh please reference the object uh the current logic can be then understood by technical blocks on the left and right side uh you can see the left side left is a good care code and the right side is the same bus code",
        "so we have used some some API from the clear itself",
        "so the last step I just built uh which which ability licensed in addition to in",
        "addition to the source function and the sync function we've talked before uh there is also a is battery function so this function is used to fill out double three case so why why as we announced as we all know in the double phase actually a special users are free case so of course you don't have filled out to use the uppercase but uh but I feel hot because I also write a larger script to catch uh use the R3 bug",
        "uh after learning this script more than 30 results were generated and after many",
        "others after many analysis I found three really secret box so let's check uh let's let's check this one so this vulnerability is located in the bmep or text tank and you can see the code in the left the pnep right buffer function uh is used to send the pnep data packs to the peer devices and but in some special case for",
        "example when a large number being impacts incent and Source blocks and",
        "Source blocks the Queen the sending will fail at this time and then the internal function Will Will just free P buffer objects but but the band is that the app",
        "course includes the errors without and continues to use its release debuff object uh in the in the subscreen code so this Behavior will will cause and use",
        "the are free user after free bugs",
        "okay so uh in this talk I have talked about two uh record patterns but I except except these two weeks buttons I have read some others you can check you can check in this in this site but but uh given the time is limit so I cannot end debug found by this script have not been fixed so far so I I cannot introduce uh them today",
        "but you can you can ask me uh uh with the with the with the email and the in addition to writing critical script I also write some look first based on uh simulate the same missions for some spatial function interface so uh you can see these three functions uh which are used to register our air to cap best provided Cloud Bank functions and by looking up the code to these functions you can quickly look at the entrance of the other projects such as sdp and bnep gntt",
        "and ifcom and so on",
        "so let's focus on the different donation of the second parameters the member variable in the suite in the right box here points to the data process callback function and we can quickly induct all the code assigned and then assign the member variable by by browsing the online OSP code website so just the",
        "sales.android.com",
        "so in this talk uh let's just take the sdb protection as an example the SD data",
        "in is a data call Bank function which is used to process our sdp data packs received from Air to Cup and two different process function will be called according to the type of the data point",
        "and different from the file formal funding we cannot we cannot simply call an interface directly we need to configure some uh nationalization data and then we need to set up different estimations to simulate",
        "different Bluetooth connection States so",
        "that the father can can reach deeper I thought you can you you can only get nothing so I have posted some main code here uh so and if you are interested in this whole source code just call me I just contact me I will give you the only source code",
        "so through this ideas I have discovered a total of 631 abilities in 2022 and",
        "among which three have been duplicate site but it has been fixed and the",
        "others are still in the process",
        "so you can you cannot get all the survey number are indeed in this site finally just uh just to make a summary of today's topic",
        "I've introduced to some basic information about Android Bluetooth and analyzed some Bluetooth vulnerabilities in recent years and shared the full attack surface I know and they introduced some vulnerabilities hunting",
        "Technologies and that I have used in this years so uh including codecare script and some funding text and analyzed the root cause of some Civic case I found",
        "okay the future is future so for the Bluetooth modules so also some partition out of punch read and write vulnerabilities will become next and next but but we can pay attention to this secret risk that may be caused by the design of the architecture itself so such as some some decking points some of",
        "this condition in sweet messages and some type confusing in measuring point so I have I have some submit uh some some variables about about this",
        "about this uh and uh",
        "and annotations so every Majors with your update of Android will also introduce some new Bluetooth features so such as Le audio in Android searching so",
        "uh and maybe we can also focus on some some Bluetooth stack implementation of",
        "other windows such as the cocom",
        "yeah so here are some materials as referred",
        "for for writing the site and I appreciate this work uh very much",
        "so this is and thank you for taking time to listen any question",
        "[Music]",
        "[Music]"
    ],
    "9BIAuwo4xvU": [
        "foreign",
        "thank you for attending our talk I'm joking from and group FG security lab and this talk lamb the data binding to show lower Pathways to RC web Frameworks today we are going to show our research and findings about the advantage mechanism first edit introduction about us is located down by me and the whole room also faster from unskilled FG lab and my college is also a city player at allow team well I'm going to start with the introduction about dead body vectors what data pointing is how it works and I will show the previous research about it and then I'll text green as an example to detail how we analyzed it by the mechanism implementations and the journey of a heightened Supreme for shell and then my college Halloween will present different implementations on the design principles of data binding mechanism between different web Frameworks and the show some interesting findings she will also detail how to exploit them to achieve RC and finally some approaches to defense will be provided let's start with an example Suppose there is a UI on axis a user is creating an account and the user information is sent to the background at the different HTTP request performance however in backend the server this information is stored in the Java beam named user which is a very common scenario in objective oriented language so the developers always have to mapping the HTTP request environment to an objective instance",
        "fortunately some web Frameworks do this vaping work automatically for example in Spring the develops just have to create a controller that accept the user object as the pyramid and the Supreme framework or instances and making the HTTP request payments to the field of use object automatically in this talk the process of finding request element to effect to a domain object is called Data pointing",
        "obviously the dead body mechanism helps develop the load and make code container because they don't have to write the running code to construct the Java beam object before using as a popular feature the text binding mechanism is widely implemented by best web Frameworks writing in trading language including Java JavaScript rui python Ruby and",
        "donut however previous research showed that the data binding mechanism can sometimes cause harm for example Suppose there is another field in use class which named the admin flag it makes whether the user have admin privilege a lot and then and when user registry the HTML form contains the user and the engine only like in the slide so the developers expect the URL like username X hacker and H equals 25. but",
        "what if ultimate equals one is also sended to the backend server",
        "there is a low difference between the field admin flag and the other field so the ultimate flag will be set automatically too and allow the user hacker has admin privilege which is only intended by the application this is the Mason assignment vulnerability it's occurs when the attacker is able to access the sensitive field of a domain object for example it means flag in the scenario so most web Frameworks provide a solution to communicate the risk for example in Spring the develops can even work save this loud field method to stop streaming framework from finding the field automatically",
        "we find that the previous research mainly focused on improval use of data funding so I was the security of the advantage mechanism has been eaten mode for a long time so we decided to contact the research on the security of data party magazine itself and see what we can find first of all let's choose a great Target",
        "Supreme framework is the most widely used Java web framework and they they and there is a low critical security vulnerabilities in the past 10 years so let's take the challenge and choose it as our first Target",
        "the super framework provides several ways to map the HTTP request Department to controller pyramids as we can see in the slide and how does this baby works and what's the differences between them",
        "this is the status of handing annotation at the request performance and this we",
        "can see the structures of data findings in screen",
        "just like that we can see the difference between then we can see the data party mechanism is much more complicated",
        "between more security risks",
        "to answer this question we have to find out how the advantage is implemented in Superior framework the key message of data binding mechanism implementation is",
        "the method called the two bind of the data binder class",
        "for convenience I prepared a better example to demonstrate how data pandemic didn't work since brain framework the user class has one extra Field address which is also a complicated object",
        "and when a dress taught City to the postcode equals three triple zero seven one is set to screen application the postcode of the city object will be set automatically let's see what happened in the two Band Method during the process",
        "the argument of two findable two-band method is unlike hashimab the key of the map is called the product path and the value of the map is called the property value they are passed from HTTP requested pyramids first the method checks whether the probability path is allowed or required and then invoke the method called apply property value which do the main binding works first of all the supply property value",
        "method split the property pass",
        "the approved path will be split by separators such as the daughter and the left square bracket this property pass is split into three parts and they will be handled one by one will handle the first part to address the Supreme framework will get the address from the user object and the second part is the city the Supreme framework will get the city from the object the address object and the master will be different the Supreme framework will set the postcode of the city object in one word there are four more parts Gateway used while the last one set values father holds the gate and the set values implemented we all know that there are two types of two ways in Java one is to use reflection to access the field and the other is the work set or get method so bring us later so the next important step is to reserve the gate and set method of the Java beam in Spring this part is in case the introspective result class it is Implement implemented by invoking it being info method it will reached a bin info described from the given target class which included the Satan and the gate method of the given class itself and its super classes",
        "specification to specify what",
        "information should be included in in info and what is the load and it also specifies what kind of data and data method is probably described for example there are three simple methods inside and the formal two methods here is a property structure while the third is load because the return value of the State method should be avoid according to the Java beam specification",
        "so let's see the property disk factor of our user class this screenshot we can see there are four property described in user class but we can see there is a strange one here the class why it appears",
        "do you remember that the cabin information that will receive description from the keyword class and the super classes or class in Java have a common superclass",
        "which is also a property described",
        "so this prep this particular gate message that bring a lot of trouble we can see some security restrictions about it here and we are going to analyze it later and let's back to the that binding process after we after we resolve the data and the set method The Next Step must be in walks in just a bit just a new work at the center and the get method then we finish the data binding process",
        "hold on let's back to the example the type of the postcode is the integer but we all know that the HTTP request parameter is a string so they must be something we missed",
        "before in working set and the get method type conversion must be done Supreme framework can handle two types of conversion",
        "one is the example shows convert the",
        "stream to some particular type like integer double Etc",
        "this is implemented by conversion service the interesting is that we find the particular conversion service it can conversion stream to any class if only the target class has a Constructor which accepts only one string argument for example we can convert a string value to a Java connect to the UI or object because the URL class has constructed of except the one string arguments this feature do benefit the develops but sometimes it also calls some side effects",
        "the other kind of conversion is about Collections and map objects",
        "the Supreme framework provide the capabilities to these types",
        "so let's back to the example when the Supreme framework by The Imposter code is just like the full name for shield code user.get",
        "address.getcity.set postcode",
        "okay along with all the details of data by the magnetic implementation in super framework let's start to handbox",
        "there are four main steps of data binding implementation screen every step design tips analyze during the research",
        "we find that something interesting when resolving the data and the same method",
        "just like the we can see there are some Securities restrictions here which show our attention at the first time this skill registration is the fixed of cue 2010 6022",
        "so if statement is this patch which is a little confusion added for the glance this statement filter some filter and set method from being u4 let's see whether we can bypass it",
        "we all know that the and operator has a more priority than the O operator so if condition 1 is true then the if statement will be true and the condition 2 and the 3 will be ignored so the problem is is there another object which has a class of the field and can be accessed by gate method",
        "and this patch Works in 10 years ago but allowed is there any changes the jedication team is released in their any new features impact the patch",
        "we noticed that the Java 9 bring some big features one of them is a module system",
        "the field module and its get method has been added to Java to London class and so in constantly the module class has a database order named the gate class model which Returns the classroom of the current class so this change the class and the clustered Again by class.gov dot class load",
        "so we can bypass the Blacklist by class to the module to the class loader and allow we can manipulate the class load",
        "this is the most important step of the Supreme share with probability and finally we'll chill RC Instagram Frameworks and the exploit will be shown in the first part of this talk",
        "let's look at the Supreme shell for Shell from another perspective the Silvery 2010 60 22 has been fixed by remove dangerous gate method and this",
        "dangerous get method are reached from Tower launched class which means the page renowned on the immutability of java terminal class which is a jdk class and maintained by",
        "jdk team instead of supreme Developers so when a new get method the get module is added to Java launch class the page can be bypassed so I want to ask if there are more cases like this your patch rely on something which you cannot control and the low body from me promise is the immutability and you will not be notified when the changes happens I think this kind of scenario should draw more attention by developers and security researchers",
        "okay let's back to the data body method as a fundamental mechanism that exist in lots of web Frameworks will begin with the security risk of data binding mechanism is widespread so we went and analyzed a lot of web Frameworks and let me switch to my",
        "college hogwen and she will present what we find",
        "hi everyone I'm Howard the rest of this session will be present by me let's start this chapter more Frameworks in the finance in the previous part we should stream for a lot of Frameworks and we finally find Supreme for sure so we can think about the problem do the rest of the Frameworks have the similar risk the answer is yes we have found some interesting scenes from the research and choose something typical Finance to share in this findings the most intuitive is a different data binding implementations in Frameworks",
        "so we will start drawing it",
        "first we will introduce the data binding implementation of Grails growth is a framework employment by a groovy language and implements the logic of data binding by itself the implementation logic is mainly represented by the recursive Loop processing of the data simple data binder we use the URL sample to introduce its passing process which mailing consists of three steps",
        "in the first step similar to bring growth also stability HTTP parameters by",
        "dots and passes them in order in the Second Step growth get the get meta",
        "property function from The Meta class of data binding and object to find a value there is a properly matching The Key Of The Binding object then in the third step call the set or get method in a repeated the previous steps",
        "the second framework we will introduce is Micronaut which writing in Java in the common data binding Logic the processing Logic for HTTP phone data and the data in special formats such as Json and XML is different however a various virtual Implement solution is used in macronaut after receiving the HTTP form data background automobile store the form data in the linked hash map then convert it to Json node in the complete the class regression through Jackson this means that even though the content tab you pass in is form URL encoded it",
        "is actually puzzled in Json format",
        "so the third implementation we want to introduce is the play framework which writing in Scott the play framework select a specific processing class according to the number of fields declared by the class which completely avoids The Hiding Fields however",
        "due to the one-to-one marking the play framework only supports the processing of classes with up to 25 fields",
        "so different Frameworks have different",
        "implementations of data binding and these Frameworks is very different language you said there are different language features affect the security of data binding next we will introduce it",
        "okay imported the future of groovy language is meta programming which is very Dynamic and in this coding example the person class only one name field is",
        "no Setter or getter functions and the name field is provide in groovy after instantiant first we can",
        "directly access the provider tribute name and assign it to value therefore the provided property of class loader can also be said directly such as pass in UCP",
        "another important future of groovy is that meta programming introduces more properties than Java for a common class the growth framework have many additional properties such as metacast metal property values and so on then the springform work these additional attributes are related to group with meta programming",
        "in fact they are also well known running vulnerability because of either a similar route such as prototype pollution in node.js in this code there are two properties in the demo class but in knowledges it also automatically inherits some implemented attributes",
        "such as the proton in addition to the demo class common objects such as strings number and rails also",
        "automatically inherit the Proto attribute when they are created the Prototype production attack with the use of this language feature in node.js",
        "after introducing the different framework implementations and the language features we turn our attention to the security restrictions of the data binding mechanism in the first fix for screen the main layer is to add three new Blacklist with the help of these new flag list the access to the class builder attribute of the Class Type is blocked",
        "in the next repair for spring it added a lot of white list which subjected a question",
        "that muted",
        "hi we can't hear you hey",
        "just hold one second just wait one second please open the probability of",
        "through unexpected field access zero four the data binding mechanism is secure under the strict mapping mechanism from the play framework this is a strange but you save practice",
        "in the growth Frameworks both whitelists and Blacklist are implemented in the security restrictions of the data binding mechanism in this code proper name represents the content of the parameter key passed in from the HTTP data while the list and Blacklist are a world manually specified by the developers and the content is specified",
        "field name we previously introduce a type of vulnerability which called a nice assignment and it took spring as an example to introduce how to defend it through set it as a load field however said it is allowed field is not Flawless and can also be bypassed before data binding Subaru will determine whether the key matches the value in set it as a load field this matching process is case sensitive when binding field screen will convert the first letter of the field name and the true uppercase and the lowercase give it a specified figure cannot be obtained from the object and retrieve the field again this means that the case of First Data of the field name will not affecting the actual pending logic but it will prefer to set this load field",
        "therefore we only need to capitalize the first letter of admin flag to complete data binding well by passing since this allowed field",
        "next let's continue to look at the security restriction bypassing the growth framework due to groovy's language Futures there will be many potential attributes when data binding is performed for the book object the properties that can be done include the title meta class meta property values and so on for the title field of the book object the potential attributes will also be automatically incremented",
        "so you can access these potential properties and find the inherited properties of zing in the exploitation of a data binding the common idea is to find and manipulate the class builder for this code you can bypass the flag list in the white list restrictions to obtain the class loader attribute in this week we also found some interesting features when digging for vulnerabilities in the spring framework such as constructed course occur during the type conversion and multiple body parts with a low of f5c in this example we need to convert the string to URL",
        "the core logic has two parts the first part is to select the prevention method according to the source type in the Target type with certain conditions are made the Constructor of the target type will be written the second type is to instantiate through the Constructor if the target type at this time is not a URL but a class customized by developer",
        "The Constructor of this class will be triggered which may cause potential security problems",
        "foreign",
        "obtains the file name of the uploaded files through the file name parameter in the process of file name password there are also some and lower special formats when we started with founding the",
        "the following content will be separated by a single quotation marks in the possible specific Logic the first part",
        "is the chassis used for passing and the third part is the URL included the value of the actual file name when possible this is encoded value will be converted into the corresponding text",
        "so if we upload a file with such boundary what will the file name be",
        "actually the last part will be identified in the file name is passed with specifically the chassette in this case is utf-8",
        "even if we replace the position of file Network tribute the result will be unchanged",
        "and now let's explore it",
        "this is the bread for sure we can modify the value of class divided attribute through the model attribute how can we make use of it when scenery we found its Tomcat work package in this scenario the first question is what is the difference between the class loader in the fat chart and the war package deployment",
        "when accessing the class loader property of the model the type of class loader in word package deployment is web app class loader and the web app class loader is set separately for each container",
        "therefore different web containers will have unique web app class loaders with different configurations",
        "the first exploitation we will introduce is RPG fire rate with web app class loader in Tomcat the Apple base attribute determines the director that the root actually points to when accessing the application",
        "you can directly access the system root",
        "directory by setting the value of updates to the system root phase",
        "at this time we can read the content of the specified file by setting the URL to the absolute path corresponding to the system file such as it is a password in another page between the contents of Etc password",
        "won't try to answer you with web app class node we need to use the access login mechanism of the web container access log wave is a logging mechanism",
        "that creates log in the specified format and supports the configuration of multiple tributes",
        "by setting the suffix of tribute you can control the suffix of the accredited log for example when it is set to JSP you can change the generated log file into a JSP script the pattern attribute can control the content of the generated log file setting the wrong time code to pattern can make the generated log contains this magnitious code",
        "when setting the contents of pattern we use two special values what are they in the documents of access Law data in this format means that data is obtained from the specified HTTP header we said FG in",
        "the live so we take values from the FG and arrive in the HTTP header why do you want to set it in this way because the left bracket and person cannot be directly inserted into the file content by pattern",
        "without this format is a term for log file creation which plays a key role in determining whether the log file is to be regenerated if the file date format is not matched with the program step the log file will be recreated we said founded format to a value different from the default value such as 4y which means",
        "the log file name is expressed in years since no log file of this format exists by default the generation of the log file will be triggered",
        "this technique of modified class loader has appeared in",
        "2014 similar operations can be seen in the use of struts 2 and we will use it in spring for shell",
        "but Tomcat has repaired this exploitation Tomcat brings the access chain of parameters by setting it resources too low which leads to the failure of the exploit",
        "in many introductions to Spring Force Shields restrictions on exploited were mentioned however these restrictions are not all correct actually Tomcat will package deployment is only an available situation and there are other available ways",
        "we will take glass space and PR as examples for the same resources attribute some had represents web resource route via glass fish and play era represent another class so what's the difference between them there is a property name that the IR context in proxy there are contexts the actual implementation of this property is webdr context",
        "in webdr context there is an attribute named phase which represents the",
        "absolute path with the current web container is accessed by setting the phase attribute you can control the system absolute paths that the home page actually points to when accessing the web container it should be noted that the attribute needs to be accessed with dog base",
        "therefore if the top base attribute instead to Etc the ETC password will be downloaded one-way access the same file",
        "name",
        "another exploited way of data binding is remote class loading we will use grills as an example to introduce how to exploit in this exploitation we set the chart set attribute that does not exist by default in the content type of the HTTP data such as Evo since this chart cell does not exist by default girls will travels or job has to find it",
        "through growth data binding mechanism in the groovy's language Futures we can modify the provider properties of class students in our exploitation we need to set three properties of the UCP attribute to the same remote Java file",
        "address the input graph file is the malicious file reconstruct",
        "is used to provide the evil child set survives the evil class exchange set",
        "provider and insert malicious code into",
        "the function at the same time the SPI mechanism enables the chassette to be automatically discovered when the application is looking for charset",
        "when we specify charted as Evo in the HTTP header application will automatically trigger the logic of",
        "loading the chassette and execute the command to achieve rce",
        "is an example of malicious used through chest and we set the path of the UCP attribute to the HTTP address starting with the chart protocol if we send request twice in sequence and the second request send the address in the evil",
        "protocol what will happen",
        "since there is no processing method of evil protocol by default rails will generate a handle class they are based on evil protocol for loading therefore when searching for classes application will finally find them in the remote chart address we have set",
        "therefore we only need to create a class in the evil chart with the same name and insert malicious code to achieve our city without the child set mechanism",
        "now we reach the final part of defense and the takeaways",
        "we can think about a question what this vulnerabilities have in common the first is open they accept the data from arbitrary user the second is dynamic then make use of dynamic features of programming language the last is the Civilized they all convert 5 stream to object combine their first letters we also call it odd vulnerability the concept is from the serialized part not only the serialized",
        "we can we can summarize some approaches to the first possible attack in the data binding mechanism for developers we have the following suggestions first try to use white list instead of The Blacklist when you write the defense code for example Supreme Family use",
        "widely used to defend against the problems of data binding mechanism",
        "second be careful with programming language Futures they may betray you programming language Futures can bring many convenience for developers but they",
        "also introduce risks for example in",
        "girls may use the language futures of groovy to complete the modification of provided properties of class loader",
        "third developers can defend by breaking",
        "the attraction for example some can set the value of gated resources to Newark and duplicate the function so that it validates all exploit that rely on the resources failed",
        "in our talk there are three key takeaways first you will know the method knowledge of analyzing the data binding mechanism writing in different programming language in its own security researchers can get some new exploit technicals and the trick is to achieve RCA last developers can understand the",
        "security design principles of data binding and then know how to prevent Security box",
        "thank you again for being here if you have more questions you can contact us with Twitter thank you",
        "[Music]",
        "[Music]"
    ],
    "Fpb4eL3vMgk": [
        "foreign",
        "welcome to my talk dirty vanity a new approach the code injection and ADL bypass my name is elyran Nissan I'm a security researcher at Deep Instinct this is my Twitter handle if anybody would want to contact me after the session a bit about my background I started around 10 years ago as a security researcher and IDF forensic researcher and then I moved along to 2001 research in both the offensive and defensive side but my main forward and what I like to do is the defensive side I like solving security issues and windows internals and I don't like cyber crime or lactose I'm sensitive so please none of these in this in this session so a bit of overview the goal of my session is to showcase the dirty vanity a new injection technique that abuses forking which is a mechanism for process Creation in Linux but it's lesser known to to be existing in Windows as well before we'll dive into dirty vanity we'll lay some foundations starting off with forking background a bit of forking in Windows and whites there API to invoke it the internals behind those forking mechanisms and we'll go to the Divinity finally",
        "so starting off",
        "uh forking background so forking is the act of creating a new process from the calling process of it a lot of you know this it originates from the Unix system calls of process creation for can execute in this example here we have parent that will issue a four call and it's this will create an identical child that will resume its execution just after the forks return and then the parrot as well will resume execution after the fork but what will differentiate between the parent and the child that are identical is the return code here the return code will be uh will be zero the for the child and symbolize the child's execution to in this example execute an exit call to replace its image and the parent will execute on a different return code on the else branch okay so most of you maybe know this so the origins of the windows Fork so Windows doesn't use uh fork and execute for process creation but it did support it with its Legacy posix subsystem a subsystem that is intended to support basic Unix binary execution",
        "in this subsystem is included the ps6 dll which exports basic unique API and",
        "among them this Fork snippet or the fork to support Unix runtime and we can see that internally it's implemented with a call to RTL clone user process and ntdll Export we'll dive into it later but this is how the fork is introduced into windows",
        "so a bit of mechanisms nowadays that use forking windows first one is process reflection the goal of forces of election is to allow analysis and processes that should constantly provide service and why is this an issue why is this a need let's take for example this debugger here and let's say it wants to debug service exe that provides some crucial service to the operation systems runtime if the bugger will resume to debug this process it will render the service unable to provide service and then disrupt the system so what reflection does is it allows us to Fork the set process to be analyzed and then we can analyze the suspended Fork without interrupting the system how its work is this is the component's windows that uses a wdi Windows diagnostic infrastructure that makes use of process reflection to do such things in this example wdi instead of debugging service directly will issue a call of RTL create process reflection that internally causes service to Fork itself and will create a clone service then wdi would can resume to debug this process or do whatever dump its memory okay another mechanism some a bit more well-known one is process snapshotting another mechanism similar to the last one that allows us to query data from process States and memory data but it does so this is a descriptions of msdn using the windows internal posix for clone capability the one that we just covered the API name that invokes it is PSS capture snapshot",
        "okay our next example of forking is that involves the credential defense realm let's cover a basic credential cadential attack and credential defense in it we have the Elsa's process that contains the OS credentials and an attackers would usually want to read it using let's say mini dump ride damp or other reading apis and then edrs for CDs and protect these attempts forking is introduced to credential theft it's a known example of abuse of forking and in it instead of the reading Elsa's directly the attacker will issue a snapshot or reflection API which is underlining implemented with a fork to clone Elsas and then the attacker could then proceed to do a mini dump or read of the answers clone which will leave the EDR unaware of most of some of the areas don't attempt to foresee this",
        "so we moved along basic lines of working usages and abuse and a common abuse in Windows let's go into forking internals the forking has a forking has as we as we saw has a point of power in the system and can allow us to manipulate the system before diving into 4K internals internals let's distinguish between two forking types the cell fork and the remote Fork so when the cell Fork a process will request the kernel to Fork itself causing a fork to be created which is identical to the process to the calling process in a remote Fork which is allowed in Windows the process can request from the kernel to Fork a different process the target process which is done in the reflection snap floating mechanisms and then the kernel will create a targets clone for the process and it's called to Target the Target clone will be considered the target's child okay starting off with the first 4K API that we've seen the RTL clone user process the self Fork that implements the Unix work in ps6 dll contains a regular set of parameters and when issuing it it will clone the calling process let's see how it's actually implemented in ntdll this is its code basic acquiring of flux at the beginning of its runtime and then calling a wrapper to rtlp create user processor wrapper to anti-create user process the Cisco to create processes in Windows which traditionally points to a section handle file and creates a process from it but when given the correct parameters it will create a process from a parent process handle",
        "after the API executes article clone is",
        "a process uses the return code in Windows 297 signifies uh child handling and the child code will be handled in this if condition and on a zero return code set to success the parent will be managed",
        "okay this is how the actual anti-create user process is called looks and what creates the actual fork and the parameter that's responsible to it is attribute list PPS attribute list and when populated with the correct way it will clone the calling process we create the public attribute list and populate it with a PS attribute parent process this is how Windows treats processes to be cloned and if we set its value value PTR to get to the current process handle and set these arguments to the anti-create user processes call this will clone the calling process but what I want to see because I want to see if this is a okay this is this is capable of forking a remote process because this is the stronger way to manipulate the system so uh I'll try to I want to check if this is possible if I can set our remote different process handle to the calling process so let's see what I did to examine this I created 4K vxc just to use this to clone and explore XA and and uh issued the the call with attributes that point into the Explorer parent and I got this status invalid parameter in Windows that signifies something went wrong so I want to see if something went wrong because of this is an API limitation or something I wrote wrong in my code so let's debug this in win dbg",
        "a side of integrate user process and this is a large function so I don't want to step in every assembly execution line but I want to see where this return code of status and value parameter originates okay so I'll take the call stack and I'll see the return address from this function and then I'll issue this command PIR to step to each and every assembly line of execution of this function and I'll see where this return code of establishing value parameter originates I can see that finally it returns it in our in the RX register but in order to find why it's originating I will search the entire output for the for this value and I can see the address in which it's uh originating and I can see the reason why it's originating because of a comparison between two registers r13 and R6 I can get the values from the trace I see because they are not equal the value is being assigned so looks like the API is intended to do this these values are e-process values I'm not showing it here but it can be seen with the disassembly but when I'm checking these eprocess values I can see that they point to the Explorer that I'm trying to clone in my own calling process so this API is limited to a local Fork not good for a remote forking means so how do how is the remote forking working because remote for can can execute in Windows so I'll examine the known working mechanisms snapshotting starting off with snapshotting in order to invoke a remote fork with SNAP floating I'll point it to a process handle to 4K to create a snapshot of it and underlyingly it points to PSS Capital snaps PSS and the capsule snapshot of anti-dll that redirects to anti-create process ex and older siblings integrate user process and all the system calls for process creation but those this one can actually Fork a remote process how it's very simple we can see here both anti-create process ex and it's even older sibling and the great process can be pointed to a parent process simple as that and then we one will provide this argument and put a null section handle we'll get a fork of the calling we get a fork of the for process store liking this is how the parameters need to be set process to before to be inputted here and now for the section handle and this will Fork a remote process okay on to the to the next remote forking mechanism we've covered reflection so reflection has an even more interesting signature it can be guided into a process to Fork uh process handle and then it has two extra parameters that are interesting start routine and start context meaning I can start a fork from from a location of my liking with a limitation that we'll examine and a context a parameter to be executed to be inserted to the routine so this is interesting to me so let's dive into the reflection mechanism and see how it's actually implemented in Windows",
        "this is the flowchart of the uh reflection mechanism of the reflection API flow but I'm going to guide you through each step first we have in this example reflection requester that will request a reflection to be made on the target process reflection requester will issue a call of RTL create process that will execute over the target with the target handle and for the first step it will allocate a parameter block and we will map it to the Target memory space and for the second phase it will invoke a call to rtlp create user thread which is a wrapper to create remote thread that will work over the target with the starting entry point inside interior level stop called rtlp process of election startup winning meaning the entry point or reflection So This Thread will execute this entry point with the shell parameters that are mapped to the Target and it will cause it to actually invoke a local code to RTL clone user process the local mechanism to request a fork in this case and as we've covered this will call to",
        "the RTL 2 anti-create user process the system calls it Forks a local calling process let's check how it's looking in the kernel side of things",
        "the kennel side of things looks pretty similar starting up with the candle side of anti-create user process moving along to PSP allocate process for process Creation in the kernel when things start to get different when moving to this API I'm a initialized process address space and this time around the Boolean flag that signifies this is a clone operation is being turned down because of the parameters that I've inserted to and to create user process that points to our parent attribute",
        "and this time around the function has been invoked is hey my clone process address space which does which does the actual cloning it creates a copy and write view of the of the target process the process that is targeted and assigns the student to the newly created process effectively creating a clone of the process okay this function finishes and returns to the context of anti-creator the process in the kernel side and it returns two status codes status success to the to the Target that called integrate user process and RTL cologne child 297 to the newly created Target clone which contains the shared parameters block from the first step of the allocation meaning and Shadow locations in other allocations that are created on the target will get cloned as well so this is very good for me for my intentions we'll cover them in a bit so the RTL clone status code is returned",
        "and the fog starts within the startup of outer process reflection startup just after the call to octal clone with the process and for the first step of this clone runtime it sets the parameter in the ldr to shut down in progress to be one this is the intentions for this fog so if we want to call these poses to be more functional we're going to remember this for later to set this back to zero and according to the Shell parameters block that I've specified it's going to choose whether to suspend the thread in normal cases to allow it to be analyzed or to invoke a start routine that I've entered in the calling parameters so according to Windows internals the Bible for Windows internals start routine must be implemented inside ntdll context okay so I'm limited maybe I",
        "cannot write everything I like this is what I'm where I'm going from and to end it to start executing the fork from it uh but so let's check this let's check the invocation of the actual start routing in assembly this is the uh the entry point of the the fork entry and how it's being actually invoked to start routine start routing is being pulled in in the fork child to our ex and start context to R6 and then they are being invoked with the call to guard dispatch I call fptr which",
        "if you know it's the mechanism of CFG being executed here CFG being controlled flow guard and control flow God is a defense mechanism that prevents an execution of an invalid address and and it verifies the address to be invoked in this case start routine to be a valid address but what it protects from is memory corruption vulnerabilities and",
        "start within here is not caused with a memory corruption it's caused because it's dynamically allocated and if if I'll allocated it with a page execute on the process to be forked it will get forked and contain the same permissions and if I set it with a page execute CFG will not protect from it so this is bad and I can execute every allocated process I've allocated a memory from the fault parent but without",
        "limitation from cfgc if you want disabled me to do this so I can abuse it so let's recap what they just covered we mapped the remote forking methods of anti-create process and",
        "and rtlk rtlk process reflection integrate process and process the XR system calls that are being directed to a remote process and the kernel will Fork them for me completely and RTL create process reflection will cause the process that I'm targeting to invoke itself a call to a local Fork to be invoked by focusing on the second method we can familiarity with the forking internals including the kernel side which is similar to the anti-api authentic related process and process CX and we see that we've seen that Mi clone process address space does the actual clone and copies the parent's memory as a copy and write view to the child memory and we established that a protection that supposedly existing on the start on the start address of the fork in the reflection it has a flaw that it doesn't protect from dynamic memory addresses that contains executor privilege so it's time to talk dirty vanity",
        "uh so dirty vanity is an injection technique okay so let's cover basic injection and injection defense before doing uh dirty vanity in injections we have a couple of necessary Primitives allocation writing and execution allocation is optional because someone might find an area that's already allocated and right to it and then execute it but any other combination aside from writing and executing any other combination is not is not enough to be in an injection if any ideas will try to correlate this and they will get a ton of false positives because only allocating and writing let's say is only as a legitimate communication method in Windows so in this example we have injector exe that will try to inject to explore and from the ADR perspective ADR monitors uh events being made on Explorer and a fence being made from injector and we'll try to correlate this being made on the machine so for simplicity's sake I've chosen a injector to do an allocate primitive of virtual analog X most simple one and the ideal notices it and I'll look and monitors it to itself when injector will write to the allocated space the same allocated space that it created edl cogulates this and monitors this as well and when finally when the inductor will wrap things up with a execute primitive here create remote thread ADR detects that this injector created an injection on Explorer Explorer is injected and will do things its way from now terminate this or whatever it chooses",
        "so the Divinity vanity what the vanity does differently the Divinity makes use of the three remote forking apis that I've shown RTL create process reflection and the correct process in process ex and use them as two New Primitives of fork or four can execute so how it's actually working in dirty vanity things will start off similar injector will allocate space or",
        "can allocate space in the in its Target and then we'll issue a right primitive this time I adopted the initial right primitive why because it's not the final right so the right is going to get happened anyway again so this is the",
        "initial right just to create the location in Explorer in the parent process and then for my first my third phase I'm going to use a forking primitive for the sake of Simplicity of this demo I'm going to use a 4K and execute primitive RTL create process reflection and when setting it with a start address to the address that I've allocated on the parent the same address is going to be allocated on the on the Clone child of Explorer that's now newly created and when I finish this API call of RTL Care Plus reflection this Explorer clone will already have this mic injection up and running my shell code already executing inside it from the ideal perspective it it caught allocation and writing on Explorer but no execution he doesn't know the forking primitive and nothing was ever written to the to the newly created Explorer by the EDR site so when it's finally starting to execute an injection uh nothing is new here to DDR so this is the the strength of the Divinity in this side",
        "so some prerequisites for the fork and execute step I'm going to need for the RTL create process reflection variant process VM operation",
        "create thread and process duplicate handle and for the anti-create process and process ex variant I need only a process create process permission and for the initial y step it can be anything that you can think of by using the write and allocate for Simplicity but it can be section creation and mapping and set setting thread context to do ghost writing or anything else exotic that you find the writing attempts will get cloned to the newly created child",
        "so let's take a look at the POC of uh of uh the definitive via artillery process",
        "reflection in it we have a shell code here a normal Shell Code and we're going to open a Target handle let's say Explorer and then we're going to allocate paste them our space on it and right to it on the Base address that you got from virtual alloc for the first third step again not",
        "executing but forking and executing later and this time around with the fork with executing the Base address and the fog chart will execute our injection our Shell Code that we created so let's test this my first attempt with it was reflecting a simple message box shell code I bet you encountered those and it invokes a message block say from user32 dll when I break in Breaking a clone process and resume my execution I got this disappointing screen of access violation uh access denied",
        "so let's check the call stack I get I get the access violation from this address user32 get DPI for current process and when the messing around with the contents of the RX register uh I am getting some invalid address so",
        "I'm checking the I'm checking the call stack here and I'm saying I'm still originating from the message box that the fork child actually invoked but something goes wrong here so I need to check out why okay so let's starting with disassembling the get API for current process and checking what's what's failing I can see the RX register is being pointed into user32 GPS side uh symbol from user32 and when actually reading it later the contents we fail let's get the address of the actual symbol what it's pointing to and from using this command I get this address here to one zero next",
        "and when I'm checking the contents of the actual address in the fork child I can see it's actually non-existing it's it's free it's a free page so it's a surprise to me I thought that for the fork should copy or the entirety of the memory of the parent so what happened to this address so let's let's check it let's try to try to see what why the symbol gpsi is missing so starting around I'm going to examine this address on the parent process to see what its features and maybe will give me a hint of why it's not getting Fork this address uh so the contents of this address is those committed address with a permission of mapped meaning a shared memory address okay uh",
        "so let's let's check further and let's",
        "check the gpsi symbol from user32 this is the this is its in initialization and I see that during the boot of user32 this is a dll main user client dll initialize",
        "gpsi is pointed to G to the G shared info symbol a symbol that points to a shared info structure structure from kernel that is mapped to every process that loads user32 this structure is a good structure that holds a session specific data in GUI handles and all sorts of this stuff and it resides",
        "in a shared read-only section that is mapped from channel to each process that loads is 32. let's see how it's getting loaded okay process here loads user32 which executed",
        "dll main which invokes a call to win from Winter to you anti-connect process and use end user connect process which invokes the kernel side in the kernel side of in the wind 32k driver and the user connect process invoking init map shell section an informative name that Maps the actually the actual shared info object to the address space of process that loads this Revenue that contains the contents of the shared infrastructure so this is the GPS I this is the contents that I'm missing I want to check now why and now I want to check why it's missing I got a lot of I got my info that I need so let's check why my first guess is maybe addresses are not getting mapped to my Forks so let's check it I'm going to check every map address in the created fork in my example here and I'm saying there's a bunch of mapped addresses including the address that I uh that the reflection demo that I've shown you the shell parameters are also getting fought so there is no reason for failure here so let's check deeper in the kernel implementation of the folk I'm going to check how the how the forking process works and why it skips this allocation of the GPS side uh okay I'm going to start off things with Mi clone process address space as you recall we've died we we took the dive from anti-create user process up to where Micron process address space this is the function this does that does the actual clone from the parent to the child uh it receives the e-process of the parent two clone and the process of the child to populate and it invokes this function am I allocate child vets a quick definition of that is the kernel object that describes a uh that describes a basically an allocation of the process that contains it and each process has a pointer to a vadri a root of its allocations and this is how it manages its own allocations this function in my allocate child Advance iterates through the parent process that and creates them to the child but first it applies them with the filter this filter is a my Val should be forked sounds promising it contains this function receives every vad of the parent process and applies the condition to it and if the if the condition will be correct that will get forked",
        "so let's check it this is the pseudo code of the actual of the Mi that should be Fork function uh shortened for the sake of Simplicity and for most private uh private vets meaning everyday allocations it's going to",
        "return one meaning uh going to get",
        "forked but in the case of maps or showed shared allocation shared beds it's going to test something it's going to test whether the field here in the Ved long Flags too a flag the flags two member in the vet is going to check it's 26th bit to and if it's set to one if it's set to one it's going to say this vat is ready to get forked else it's going to return no don't work this one and we're checking the struct definition of the flags too I see that the 26 bit is the inherit field",
        "sounds sounds good sounds like it's the right way I want to see if I can set this inherit bit that I'm missing to one to one to yes inherit this so let's check what is this inherit bit and how can affect it okay I'll try to Google this uh I'll try to check the flex to inherit and I get this track definition from Google so it's a loop I'm not getting anywhere from Google so I'll try either I'll convert this flag to its hexadecimal form this value here and my aim is to detect usages of it in ntos kernel I want to see how it's getting manipulated and how it's getting inserted to a vad and then maybe I can set it myself to this step uh okay so I'll search this little uh this string in little endiness in the entire binary of entire scandal uh when I when I searches I get a ton of uh output a lot of locations that use this value because it's a very generic value some of these places are not even code in my in my search query but I can sort it and if I sort this search query to search only in areas that are Mi prefix functions that manages memory in current US candle and only operations that are not test but move that actually use this flag and set this flag I found two interesting hits Mi map view of image section and Mi map view of data section let's actually set this value to a newly created allocation so I'm going to check how",
        "so I'll reverse these two these two areas and when what I find is this pseudo code I can see that the inherit flag is being controlled by a Boolean and this this Boolean is being controlled by arguments if this Boolean is true this actual flag is going to be set to the newly created web good for me let's see how we can affect it let's check what is this argument I'm going to follow up the call stack from the area that I found in my map view of image and data section and following up to empty map view of section and I reveal Arc 6 to be section inherit in Harry this position parameter of anti-mapped view of section okay this this thing I can check in Google it's an API and when I check it I get that inherit disposition is defined in this way specifies how the view is to be shared with child processes the possible values are view share the view will be mapped into any child processor that are created from this parent process or view on map the child The View will not get mapped into child processes sound like exactly what I'm messing with and we even have a recommendation from msdn drivers should typically specify view on map from this for this parameter so this is exactly what's happening gpsi is mapped from kernel space from win32k driver which is uh and when I check the actual mapping code in 132k in it publisher section I can see that the search shared section is being mapped with a view on map value so let's recap things okay I try",
        "to Fork a process and I I wanted to invoke a message box in it but it used this value and this value is mapped with view on map so and we are not sections are not getting copied to the folk child so this is my martial code crashed GPS pointing to this section and message book and the message bookshelf code fails so what are my options now okay the couple of options some of some are more difficult than others I can try to reload user32 dll and this way the",
        "shared section will get Reloaded invoking The the load of the anti-connect user process",
        "again I can copy the contents from the parent of the shared section uh from the parent to the Clone and I can even call the API anti-connect",
        "and and user called process connect to remap this shared infrastructure from the from the folk child",
        "but what I've chosen to do is to write my reflected Shell Code with only NT API anti-api are independent they don't need",
        "any other layer of shared memory to support them by the way I can use any low level API from Canon 32 like load library and others uh it's a it's a",
        "method of try and test but anti-api",
        "works flawlessly and let's explain also",
        "why V1 map is existing here the why the forks are faulty uh how it's actually working in in the Unix subsystem that's supposed to actually function so when I'm examining the actual forking code uh the actual mapping code of locations in uh in the posix dlls I can see that every mapping in deposit subsystem uses the view shell member and The View on map is only a Windows usage",
        "value so this is how the Unix Fork works and able to create our executing processes and this is why it's interrupted in Windows so I'm going to reflect the Shell Code and the API for my demo and my shortcut is going to instead of creating a message box invoke a call to anti-create user process invoking invoking a a message MSG",
        "executable that says on a hello prompt and this is what motion code is going to do I'm going to set the contents of the ldr again to shutdown in progress to be zero because this when this is one it it runs the process runtime it harms apis and I'm going to find my anti-dll API from dldl and perform parameter creation for this anti-creator process without thelk process parameter ZX and then invoke anti-create user process from the reflected Shell Code invoking CMD and a command line of MSG hello from the Divinity and I'm going to suspend it to allow you to see it okay let's now it's time for the demo demo demo okay we have a demo here of a system that's protected with an EDR and in it we're going to Target Explorer this is the Explorer process three this is its PID and I'm going to apply to Target this PID first with an ordinary injector and",
        "by setting the period of Explorer 6480 I'm getting my injection walking Hello",
        "message and I need the album prompt down here the ideal cut this attempt I censored it so in case I don't want to mess with anybody and when I the ADR created a new Explorer because it contains Shell Code and new Explorer is created I'm going to invoke the active entity on it the prompt is being is being executed",
        "and when checking the actual process 3",
        "I can see that Explorer indeed created a new Explorer image and it's this this child Explorer created the CMD that invoked my message box so the Shell Code in any delay actually operates",
        "thank you",
        "okay so this is this was the demo time for uh uh summary and takeaways",
        "to detect to detect injections in their Solutions you usually Monitor and correlate attempts of allocation writing and execution it allocates and correlates these attempts on the process on that are being invoked on a single on a single process on the same process what folk API do is they introduce two New Primitives to this injection game fork and four can execute and what it does it basically splits the edr's vision and the Divinity makes use of forking to reflect any attempts of allocation and written writing to the newly created Target process the child clone process and from the ideal perspective the parent was never executed and and it won't and the child is never been allocated or written to and thus it will never get flagged when finally when eventually I will choose to execute it either with a fork and execute primitive or forking with the forking apis and then finally actually in the executing it in every other execution primitive that I want to follow up with and a couple of takeaways for you uh dirty vanity changes how we look at injection defense because uh forking changes how we monitor the system what details should how should edits should respond is should they should monitor the all the poking Primitives uh that I presented eventually tracking forked",
        "processes and applying them with all the knowledge of the parents their Divinity can be used or the forking can be used in other attacks we saw we were saw an abuse of credential dumping this is the injection world and we must apply the entirety of the knowledge of the we have on the parent to the child process to prevent this kind of attacks and more variation of the dirty vanity injections exist up to you to map them all we can do the anti-create process the processing X system call within follow-up execute primitive we can patch the entry point of the fork to do anything we like and we can try to fix it's possible higher level apis but generally anti-dl can do anything with younger brothers can do up to you to catch them all all the variations and thank you this is where I'm finishing this is the link to the GitHub that contains the POC demo to dirty vanity it contains also the Shell Code generation framework that are used that invokes the Shell Code of ntdl API you can customize it quite easily this is my Twitter handle if anybody would want to contact me after the session and some references that I've used and time for questions if anybody has has one",
        "foreign [Music]",
        "[Music]"
    ],
    "ygWgQcMrPvc": [
        "foreign",
        "University and today I'm going to present uh TNT decompiling deep new network compiled binary",
        "uh as you know like uh give new networks students have been applied in many UC scenarios for example based recognition waste recognition Healthcare Etc",
        "and there's a trend of deploying deep new networks on each devices and so-called and so there's a term called agai where AI computation is done near the user near the user at age instead of instead of at a cloud and there are several benefits of of doing computation at each devices",
        "the first one is it has loaded latency so each AI can analyze the data locally rather than in a far away Cloud which is delayed by long distance communication so it can respond to users requests in a real in real time and the second benefit is it provides a hybrid availability because it doesn't need internet access so either without",
        "it results in higher availability and reliability for some Mission critical and production grid application",
        "and the student benefit is that it provides better privacy because the data",
        "collected by The Edge devices are usually are usually very private for example some medical some medical data and for the Hai enhances the Privacy by con by containing the data locally instead of uploading the data onto the cloud",
        "there have been some real world cases where like some products use AGI for instance uh the next p release the iot solution for secure Facebook coordination with livelisted action it essentially a Facebook recognition camera that powered by their model and can do some authentication in a smartphone scenario and also for infrastructure there's a company that deployed the new network model or cortex on cortex and cheap to",
        "achieve remote grid power grid monitoring and so Healthcare HDL can be used to detect early blindness and diabetic",
        "when deploying deep new networks on each devices dedicated in compilers such as globe and TBN are usually used to compile the dealer model into a binary module and this module and this binary module will be linked with the main problem with the link will be linked with the main program and the Flash onto the edge devices",
        "in this work we explore the possibility of decompiling those DN binary but in",
        "binary we are refer the DNA binary uh the compilation we are referring to is not just doing the DNA binary into State uh feature or either Pro and get tons of Studio C code that we have totally no idea what it is doing instead the different binary compilation",
        "is the referred to the process that automatically reverse engineer the different binary and acquire a high level specification high level representation of the compiler model including its uh accurate architecture",
        "and its parameters",
        "and why why we compiled it why we decompile the DN binary why it is Meaningful the answer is now ratio has many security applications for instance like almost obvious one is uh steel model stealing an accurate and a performance leader model usually cause lots of human efforts and computation and computation power so essentially lots of money for this reason obtaining it often has high commercial value",
        "and furthermore the stolen dealer model can be the stepstone that turns black box attacks into a white boss attack for instance a membership inference attacks and adversal attacks and I will make some examples of adverse attacks adversal text basically is uh is an adversary maliciously influenced the predictive results of the model by adding some imperceptible noises to the input",
        "is that after adding some infrastructible noises to an image of a stop sign idea model will misclassify a stop sign as a teddy bear",
        "and the figure on the right shows that an object detection model cannot recognize the people who is wearing a carefully designed clothes",
        "and Russo attacked a huge threat to doing for dinner model deployed on each devices if the attackers can acquire the deal model attackers and know the internal information of the DM and conduct white box attack which are more efficient and richer which are more efficient and effective than the black horse counterpart",
        "yeah you might ask can we just use the existing compilers like like either Pro or Deidre it turns out that uh the general purposely compilers they can only recover C language levels in tactics from their binaries and but they have several limitations when dealing with different binaries the first limitation is that there are a lot of vectorized mathematical computations Indian binary and which essentially it leads to uh in the capability result there will be a lot of long Loops bodies and excessive device operations",
        "here I saw either probability calculation results of a single convolution operator function it contains 380",
        "348 life of code with multiple long loose bodies and many bitwise operations",
        "if I were a reverse engineer I have totally no idea what this operation function do and keep in mind that you this is just the completion result of a single function and a typical deal in binary contains hundreds of functions like this",
        "foreign",
        "results of different binary varies",
        "the complexion results the combination a result different differs significantly depending on the compiler's analysis and even with the same with even with with the same setup the same compiler same essays and stem function but with different parameters of the DN operator the compilation result will will also will also change significantly because of the compiler organization we will explain it later and for the more examples you can refer you can you can check the you can check the GitHub link provided below",
        "and the last reason is that the existing General purposely compilers they lack the knowledge of their semantics and topology so",
        "so uh intuitively they cannot generate a high level representation of the piano",
        "therefore we need a new decompiler which is capable of capturing the mathematical semantics on a binary and convert the mathematical semantics into a high level different semantics",
        "before we discuss about the details of our technique please let me please please let me briefly introduce some backgrounds about the ends and how they are deployed on each devices the figure below shows the snippet of resonate model represented with omx format in the figure again you can see uh each box is a different operator and you know later they are the building blocks of the end I didn't operator take output of a previous operators as its input and computes the output based on its operator type parameters and attributes we extend those terms later and there are various types of students operators with different high-level semantics",
        "currently there are 174 different operators defined in One X and the number is still growing for example there are convolutional greater average pool operator and value operator it was already very commonly used operator",
        "and dealing model information include operator levels information such as type attributes and parameters",
        "and model level semantics like uh the topology which determine how The Operators are connected",
        "and there are two uh in case of compilation schemes there are two combination schemes that compile the model into binaries which are intermediate based approach and ahead of time AOC approach for the interview for the interpreter-based approach there's it generates a different configuration file such as tensorflow Lite and there's a generic uh and this generic real-time Library which implements each every every type of DNA operator for instance it it has a convolution operator implementation and has a value operational implementation and they are they are they're generic and during the runtime there's an interpreter that passes the process configuration file and generate a complication graph and invoke the generic DN operator implementation in the runtime Library however it has two disabled it has two",
        "disadvantages when deployed on H by 6. the first is that it introduced it introduces space and time overhead because of the need to include the runtime library and to financially pass the unconfiguration file and the second one is that since the since the uh since it use generic Green Time Library it mixes fun opportunity to optimize the operator function given specific parameters",
        "so there's another approach aot approach it compiles when the iot compilers it will specialize the operating implementation according to the attributes and parameters of specific operator instance for example for the highlighted box boxes you see in the figure below uh there are there are convolution to n conclusion 3. also they have the they have the same type of operator which is which are conclusion but because of they have different attributes and parameters they will be compiled into two very different binary functions with very different control flow and data flow",
        "and uh you know in another dimension uh the accommodation backhands uh they're basically they are there are two types of backend one is uh the device with with only CPU and second is the device with with uh the accelerator such as uh mpu GPU or even Asic",
        "and so the CPU only devices uh it does all the computation on the CPU for example the uh this as we mentioned there's a Facebook recognition camera released by an XP and it's basically all the computation happen only CPU and there are also some other embedded systems where it needs a more more powerful computation power so at and",
        "they they will be equipped with sound DN accelerator such as Google http",
        "foreign",
        "our objective is to recover the DNA model in Ox format on the compile binary when your CPU only devices so this is what we only we only cover the binary on CPU devices and how to how to read the percent engineer the binaries running on the devices with ideal accelerator will be left in our future work and yeah and our address is like is our season should be generic enough to support different compilers and Isis and it should be it should be issued recovered in models in uh with very high accuracy",
        "let me first give you an overview of our technique",
        "so the first step will be given the DNA binary relocate the function that implement the DN operators",
        "and the second step is for each located in an operator function we generate our operator summary which is capable to summarize the to capture the manual semantics of that of that function",
        "and the third step and the last step is uh given the generated over here summary we recover the high level modal semantics and output the model in Olex format",
        "and let me give some details more details about of each step in the first step we look for the binary function that have",
        "uh in the first app we we locate the DN uh the function the binary function that implement the Dr operator so essentially uh how we do it is we look for the we look for the binary function with certain structures so we look for the binary functions that have a Neti loops and a vector-wise computation and these functions are identified as the function implementing the RDM operations uh note that I'll work at a binary level but for easy understanding in the presentation we show our running example in the source code in kind of a different data file source code in the following slides",
        "yeah",
        "in the second step we generate our operator summary of each DN of each operator function which can summarize the mathematical semantics to do so for each identified operator function we first conduct Loop analysis to identify induction variables we also we also usually call the induction variable as Loop indexes so the first step is Loop analysis to verify the induction variable for instance uh in the in the figure below the induction variables are the variables i j u v highlighted in the",
        "blue box",
        "we also identify the information such as our initial value step size and loop count yeah and for instance for for the variable I in the figure for variable I in the figure uh the initial value step size and loop count are zero one and two respectively and it's a it's an easy example I think everyone can follow it and to anything to identify these uh inductor variables we Leverage uh some Ibis properties which are they are usually initialized as a constant at a Loops entry and this IV is determine if Loop if a loop continues",
        "and they are incremented by a constant inside a loop so we assume the iris has have these uh",
        "properties and we use these properties to to do a static analysis to identify this verb to identify those variables in the binary function in a binary function",
        "and with identified industrial variables we symbolize these identified IVs for",
        "instance the ijuv show in the figure and we contact symbolic execution this step is to extract a symbolic expression that can that can capture the semantics of this function and this is and extracted symbolic",
        "expression we uh will represent the function's output with its input and parameters the output essentially we Define output as the memory the memory right of this function and inputs is the memory of this function so in this way we can cap we can we can use a we can use the Expression to capture these systematics and for this for this easy example after this step after this symbolic expression extraction step uh we will output a simple expression like this like the like like the one song at the bottom of this slide",
        "and then in the first step we leave the extracted expression into an operator summary represented with the intermediate representation the IR redesign for example we lived the exactly Expressions on the left to the operator summary on the right shown on the screen and we are refused would be represent the plus equal on the left to the summation function we're defining r y r in the right and replace the multiplication with the multiplication function in the right and also we attach we attach the induction variables information indicating the possible values of each Loop index for example for the variable uh its possible ranges from 0 to 1 and we increment as well",
        "after I operated summary generation we",
        "finally recovered the high level DN semantics we first we have the operator type of each operator function with ASD matching",
        "specifically at the very beginning we we will generate a reference as the database in advance which Maps each DN",
        "operator type to its corresponding AST",
        "for example here we show a reference as the model of a convolution operator",
        "and after that uh we match the AST included in the operating summary the operation will be previously we previously generated and with the reference as this we consider the operator type as that of a reference entity if the SD are matched with each other for instance here",
        "we match the AST included in the operator summary with the convolution of greatest reference entity in our database",
        "and it is a match so we will consider the",
        "uh this operator is a convolution operator",
        "and after we decide the operated type of of a binary function we then recover the DNA's topology by laryngit dependencies Between each DN operator function",
        "for instance we can identify we can identify that like for two operators or",
        "two operator function we identify the input of convolution three and output of a convolution right they point to the same memory address and so we can know this uh dsh from this H from convolution one M consonant three so we draw H and we recover the connection between these two operators",
        "and last we cover the attributes and",
        "parameters of each Operator by leveraging the operating summary and the recovered the end topology for instance with the operator summary we can we can recover the values of filter by extracting from their corresponding memory address",
        "and our compiler can also correctly handle the idea and binary with some very common with uncommon compiler organizations such as operator fusion and loop and loop rerolling sorry and the loop I'm rolling",
        "for the operation Fusion it is uh it is a common uh optimization technique that deployed by",
        "a DNA compilers it essentially it combines Loop bodies of two adjacent operators to to improve the say a cash locality",
        "and yeah and it typically it combined the active activation operator for example relu with the previous operator for instance uh is it is the most uh typical scenario where the compiler combined a convolutional operator with a value operator and in the code you can see that before this organization there are",
        "there two Loop bodies",
        "and after urbanization uh they emerge",
        "into one and the value is kind of is merged into the previous operator function",
        "sorry the previous the previous operator Loop body",
        "and uh to handle with the loop operator Fusion we develop we leverage we Leverage The observation that the combined set that",
        "when there's two operators combined the second operator is usually an activation operator for instance so uh our 10 is",
        "quite yeah it's quite simple we first identifies the activation operator in the extracted in the extracted symbolic expression so here we we use some",
        "pattern matching to identify the relu",
        "in our you know extracted simple expression and then we just divide and divide the value from the previous expression and so we have we have two operators in our generated operator symbol",
        "in case of uh in case of loop I'm rolling for instance it unloads the loop with induction for instance here is on it on rows the loop with induction variable V and yeah I just we just make and this Loop just disappear and it results in uh two two different uh updates",
        "so this this Loop has been has been unload so uh in order to handle this we",
        "developed a rolling techniques sorry I look really rolling techniques which essentially uh the compiler's organization",
        "as a decompiler we we identify some we",
        "recognize some pattern and we do some redrawing to uh create and create recreate and do and so we develop a loop uh rerolling analysis which recognize the similar pattern on multiple expressions and motion together",
        "for instance uh in the extracting simple Expressions we identify",
        "the similar pattern between line one and line two and so we managed to merge them together into One X into one uh extra expression",
        "can also handle with uh cancel handle composite operators the compulsive operators they usually they are quite complicated we will use a we will use recurrent operator as as an example",
        "uh so for for the recurring operators such as RN or lstn their inputs can",
        "affect this subsequent out the output can affect the subsequent input so that they can they can exhibit some temporal Dynamic behavior and this type of operators they are usually used in ILP model",
        "so when so when these uh when these title type of operators they're compiled they're using their rollout and decomposed into some basic operators for instance uh for instance the fully connected or or the value of tensions",
        "so and these basic operators we are ours already support support those so our",
        "approach is we can recover those basic operators first and then we use pattern matching to recover the composite",
        "operators",
        "foreign",
        "operator so if you go out into a sequence of operators and for each for each operations inside is essentially is a composite of fully connected and addition and bitwise addition and attention that we first we identify those basic operators and then we use Statin machine to merge them into a into a into one RN operator",
        "and uh yeah and this that's basically our our season design and I've been playing we Implement our system with python on top of anger and we we reused",
        "many uh angular components such as CX recovery and loop finder and our system is open source and GitHub",
        "uh for evaluation we first evaluated Network the generality by evaluating how",
        "many widely used their models we can support",
        "we can see the ideal model supported when all of its operators are supported",
        "we collect 370 models from from two",
        "onto Benchmark versus uh on x2 and",
        "the second is ml Perth tiny benchmark and it includes uh includes many widely",
        "used and famous models such as a resnet YOLO and GPT tool",
        "and it and they cover uh they cover many",
        "different types of the operators",
        "our evaluation show that our system can support uh 59 different operators so if uh 84 of",
        "the 70 or already total 70 and and we",
        "can and and in turn it uh",
        "support 30-year models which is uh it is 85 of our data set",
        "then we evaluate the correctness of our system by checking if our system can decompile RDM binary and generate the",
        "model equivalent to the original one we test with 15 DM binaries and they are",
        "compiled by two compilers through ntvn 3 isas on some uh um architecture X6 64 and x36",
        "and it's three models Ms president virtual run and mobile net version one version two and we compare the inference results of the decompiled model and the original model you",
        "given 10 given 10 000 test inputs our evaluation shows that our system can decompile all the tested binary without 100 accuracy",
        "for example here we show uh at the bottom sorry at the top we show the architecture of the original resnet model and at the bottom we saw the",
        "decompiled model by our system and as",
        "you can see they have they have the identical architecture and we further evaluate correctly is we further test these two models with 10 10 000 tested inputs and they have the same inverse results",
        "in the case study uh we also we also conduct case studies on a real world in a real world microcontroller with a resident model is deployed it's like essentially it's the resnet model deployed on the nxp IMAX RT 1050",
        "evaluation board and we saw that our system can be you can use to steal the design model from abroad specifically we thumbed the",
        "binary uh redundant binary from the board and they compiled with our season and we verify the correctness of the compile DNA model by comparing the internal results with the original one",
        "besides we also showed that the compiler DNA model can be leveraged to boost adversal attack",
        "with the decompiled with the decompile model we launched whiteboards at visual attack with uh and which successfully reduced",
        "the inference without the inference accuracy from 88 with the original inputs to the 11 with the ribose and reversal input while the white while while the black horse attack can only degrade the inference accuracy to 57.",
        "and yeah and in summary uh decompiling the binaries requires custom customized techniques within specific knowledge and in this work we post DND uh the first compiler both compiler models and",
        "our system is open source at GitHub",
        "yeah and yeah and that's all for my presentation thank you I will now I will now take questions from the audience",
        "[Music]",
        "[Music]"
    ],
    "mPiv0eZlx9w": [
        "foreign",
        "thank you all for attending our presentation event-based passing cash-based research and commonplace finding back through a bank it's a great pleasure to participate in blackhead Europe and we are sorry that I couldn't be there we are currently in Chengdu China hope you have a good time I'm Yahoo Indian today I will be representing with my colleague",
        "firstly a brief introduction I'm a",
        "security researcher in Opel Ember security lab my job is to take care of security of opal products many of our OS and I also spend some time on Chrome and Android security and so my briefing today will involve both of them now I will let you to introduce himself hi everyone I'm meeting you I'm a supportive researcher in Oklahoma security lab I mainly focus on vulnerability Discovery exploitation and",
        "the defense of the Angelina's tunnel",
        "yeah okay our briefing today is about finding more back to one bag from some other perspective we have learned from studies and presentations of many excellent security researchers on how to find more Mobility through their tax service analysis and module analysis which is",
        "very effective but to find the potential value of availability as a way to find more we've summarized towards key strategies these four key strategies we're going to share today includes one writing fast solution and three other experience add",
        "to these models we have found over 40 vulnerabilities in Chrome and Android vendors",
        "so agenda for today we will start with the story the beginning of the journey we identical three use and then we will show four effective and intriguing back handling purchase and finally come to the conclusion they offer will be lightning",
        "the left part here is a familiar page Chrome Security Box are publicly disclosed by Google active fixing which have great new value it was April 2020 when I first decided to look for vulnerabilities in Chrome so I started looking for inspiration from here the twenty thousand dollar report on the right for my eye immediately and I decided to take a look at the entire way",
        "series",
        "2019-13699 founding fire restriction model may allow stand for escape from a compromise renderer looking at the profile concept it appears to be a 325 sample for the media module interface but vulnerability does not occur in the media module interface this is triggered from the desktop caching model interface better use after 3 actually happens in that top capture the screen capture notification your eye views is raised by the blink module media stream type of display video capture",
        "I won't go into detail about how the vulnerability works we just need to get a concept not have better vulnerability starts from the desktop capture module interface and goes to the screen capture notification reviews",
        "also I verify the proof of Concepts into the latest latest version and yes it seems to be fixed nicely but with naturally strolling clips",
        "it crashed",
        "um what happened I first thought there was there was some problem with the catch and I looked at some more information here and it looks like another problem",
        "well I thought it's been public for over three months and no one has ever done anything like this for that I got lucky 15 000 for CV 2020 6466 a really",
        "fantastic start to the comeback hunting Journey",
        "and after a brief analysis it seems that some user clicks enable this code to turn deeper from the notification UI to",
        "catch sharing unlike some module interface bus which may have been discovered and fixed by advisor before the early release",
        "now I have the story ended not really after a period of time researchers found",
        "320",
        "16001 based on civil 2020 6466 which",
        "also showed the exact same with two class proof of Concepts which means that this receiving use were triggered by the same use of concept except for Diagon selection foreign",
        "[Music]",
        "so the first model is about adding different gas to the fast the important experience which has got this user action now all your background for extensions extensions has more software programs that customize the browser browsing experience till I use the telephone functionally and behavior in many ways",
        "there are thousands of different examples of publish exam extensions in the next world for me personally I find that the dark background and Page translation very convenient and useful",
        "extensions to let you extend a browser by using apis to modify browser Behavior then access web content like activating",
        "tabs modifying that request and strong",
        "for example using the from bookmark API",
        "to create organized and otherwise manipulate for Max and to create an extension your examples and resource a manufact JavaScript HTML",
        "files images and others",
        "so the obvious way to here to start as fast is to generate this value content files so I used tomato to generate API",
        "forms and show which worked well in the beginning and there are some Tuesday we found it and as you can see these two proof of concept is relatively simple as inside the grammares",
        "now the normal Next Step will be parallel plasma exploring communication",
        "events every condition possibilities for",
        "that we've got CBE 2021 to",
        "30614 to divide two extension S3",
        "2021-143 areas condition pack",
        "what's next next then I thought of the story at the beginning I mean discussion can also involve non-user interface such as tabs and windows and Boomers that the user can manipulate and the advantage of this is that it can trigger events or back functions of user interface not just extension event fallback",
        "of course I can't have many Clips at random which is neither realistic more difficult to reproduce so what I need is a constant flow of events and reliability of reproduction",
        "so I'll use some choose that simulate their user actions Capital here is a",
        "node.js library which provides a high level API to control room over the depth to protocol cafeteria can run in both headless and not have its notes any supports extension interaction it supports some powerful features like automate forms definition right testing keyboard input but for my purpose it has some limitation basically the scope is limited to browser context",
        "and we are X2 here is a small system",
        "level tool which adds Unlimited skill which is more ideal for interacting with fast outside of page or just any other software it is quite easy to use as well",
        "um these are some cool tricks they are very useful for plasma manipulation this is clicking closing recitement browse dragging I found many vulnerability to treat about drug events in losing times and this is helping up program and visit analysis blackhead group",
        "regarding a real example they accidentally discover vulnerability mentioned at the beginning of the presentation can be treated by such an admin script which is simple and effective",
        "so we add extra two to five and with the help of X2 we found this interesting vulnerabilities three 2020 6554 requires the user to",
        "close tab Windows which is actually a special situation here where the vulnerability occurs at the stage after the browser receives a close event",
        "and this duplicated issue requires the user to close tab very quickly and if you are not fast enough it will not trigger this is one of the reason we strongly recommend using air simulated simulated approach",
        "3D 2021-14 and ask better environment",
        "variable Network State related",
        "here I would like to share some tips for user interaction in fact",
        "the first point is that the focal point can be anywhere for a state for page that lack of value performance more than 90 of the space is useless days for this matter we can use a reading approach for optimization for example reaching the",
        "effective area the top part of the browser and also the constant position of the area can be stacked separately the second point is The Blacklist area is necessary you certainly do not want an accident or from the shutdown or change of strange system settings",
        "the other third point is that some code is executed only when the browser is closed and if something goes wrong in this part the father parent the normal fat parent presets from churches but it",
        "can be captured by a user clicking close this is an actual benefit",
        "foreign",
        "and most of them are relatively dangerous you can search fibers attachment for them that again while most of them are 11 format but of course there are some other people formats",
        "and there are a large number of user interaction events on cell phones some",
        "of which are well known such as Bluetooth connection and disconnection and the reason it's a screen lock and transformability and there are others like the USB then conviction here to be very strong",
        "now here is a quick recap of these main point of view section firstly delving into valuable box can be answered rewarding and enlightening secondly focusing on event handling logic to serve actions Etc can increase the coverage of cloud execution and therefore it serve as a kind of other input",
        "now in this lecture we will touch on some experience with clean from the touch base research and then show two examples as illustrations",
        "first four moments recall how you might feel when you lose your checkpoint or a monthly securitability do you feel pity because another vulnerability is missing or feeling frustrated back hunting has become more difficult well on the other side it can be different you may be wondering if this patch is perfect sometimes you might be inspired by a particular detail hopefully you'll be excited because this means the execution flow here can grow deeper",
        "foreign",
        "6509 is an interesting bypassing sample",
        "as a browser process is after free this is a potential sample Escape but as you press the user to install an extension this is mitigated down to high security the fixed opener function of capture strip model is called when a trap is in detached or moved as its name is openers it is called to ensure that no reacting and data has its openers that should erupting chance have a given index",
        "it does this by setting the opener of any tabs and reference to tab as index to that type opener",
        "and from a security points of view if such a tab establishes its own opener is",
        "removed the same fixed opener logic will plus the opener of any tabs referencing to referencing it to point to a standing pointer so that we can lead to this after three errors",
        "so first try to appoint a tabs opener as a chapter so things are not so easy and we get this error which is a obvious for people what about Updates this seems like unfeasible either",
        "fortunately however there are a lot more than just two piece of code that can set this property as you can see through caps move function the index of the test will be updated and this is purely position related so if we construct two tabs make an opener for each other and then select our positions we can finally get the opener from their own and therefore treat this vulnerability",
        "in our second case is about green paper let's DCB 2022 32625",
        "um in this multi-layer of two which is very common in modules like GPU and nearly a newly pattern on its own first Loop however the second Loop chart is not so sufficient as the first one which can cause a response rate foreign",
        "distribution here it is reasonable to assume that Patches from modules are with more complexity are different",
        "investigation",
        "now brief summary for this section incomplete or insufficient shafts happen from time to time as for Effective phase try other way to bypass or go deeper into the subsequent logic which is more feasible for more complex modules now I would like to pass it over to you who's gonna talk to you about another interesting strategy",
        "in this section we will summarize our experience in Europe these are some real world scenarios that can create our vulnerabilities",
        "as we all know the Android ecosystem contains a large number of terminal products including Mario Phantom vendors and Warrior contents and application providers and he's a security scenarios of these from new products there are more diverse situations",
        "for a simple example the gka is after version 5.4 of the Android you know Common kernel to make the kind of more consistent and so forth there are vendors are the color story",
        "from here we can already see that the branches are increasing and that Android is not only the colorful but also a lot of native and simultaneous",
        "from the annual monthly supporting quality we can see some of the main vendor figure and now vendors will add their Driving School to support their own Hardware energy and then Supply the two different area notes that each vendor will here will create a different Mainline Branch because of the different specification of the hardware platform",
        "for different products different targets and diversity oh yeah I'm so different models of hardware and inherit the different branches in order to adapt to different product features each product will merge different tone therefore the kernel branches further increase",
        "besides Hardware OEM will also developed their own special features since in a software for example now many cell phones focus on camera as a selling point this will lead to different camera video and multimedia Library as well as inheritance upstream's vulnerability some may have the other branches commit or where open source lab then develops their own Vision this awkward situation would create new vulnerabilities",
        "therefore we just have an abstraction of some Gap situations perhaps this is a reality four-dimensional coordinates because each sub-responsively under the vehicle project may also be in different timeline these situations are due to the optional scenario of each product which brings some security risk which gives a lot of opportunities outstanding vulnerability",
        "the important thing we want to talk about is the direct impact of the upstream and downstream relationships in fact the Upstream limit Linux kernel also has its own option some modules such as networks a few years ago once a week 2017 8890 the highest vulnerability from lab",
        "simulink or PR we looked in angular",
        "phones that have not yet impact and a year later we Supply us to find that the POC still worked on the then lead with the Central West distribution then we explore the",
        "this is a powerful example the Upstream limits kind of generic model vulnerability but that's almost all Android device and is also fixed in a public earlier diameter which is equivalent to account with the attack for the downstream result regarding the firmware",
        "this year I found CV 2022",
        "24022 using a simple cell really rather",
        "faster then I found out that a few months ago it seems to have been a patch in the Upstream Linux panel this can be a glimpse of the impact of that swim too in my first year our learning security I learned that Linux is based on the file system so I have added a random video to test all final nodes also assault how can limits have such a simple video vulnerability until this year I put this little fast on different device after a period of time I got at least 50 flashes and over 5 CV from them these problems are most similar I think this is meaning due to the complex Branch using the Android ecosystem",
        "s of similar functions it is easy to have similar vulnerabilities perhaps",
        "developers plan to mix similar mistakes",
        "first we look at the 35 famous this year it looks very similar with the previous cup red caps the first the pep mask patch would add in 2013. Amazon the 35 appears to repeat the same value this year we can use a simple battery statement on the web to scan the 352 functions that were not fixed before we can analyze the patch and summarize one operating model and design uses the truthful or widely to find these problems exactly is a static could scan input developed by Google project zero very",
        "convenient and efficient we have used badly to summarize some vulnerability models and some with some security issues",
        "compared to the Android common funnel there are more milky plants and multiversion problems in the Wonder and oems product this is the vulnerability in the USB type-c Barrel we found this 1.0b draft problem our model with the help of case and then we found the second similar problems in another model by using the cookie on the left",
        "and this is the camera recovery problem we first upon this integral workflow problem in the files of a module and then from the several similar vulnerabilities in different modules with similar functionality by using the torga on the right",
        "these are some vulnerabilities waveformed by one vulnerability real complex scenario perspective",
        "my friends grandmother said to me when you see one bug you already have 1000 bucks in your home so we have to download more parts to one part sometimes we trust the plural spline which has an upstream manager suppliers because that the code function will return back so the vulnerability appear for the Midstream and downstream kernels if a vulnerability is missed it may not be fixed until the next major chronology upgrade while vulnerability is enough for tractor so for the mean OEM which have a large number of users it is necessary to find efficient ways to solve the vulnerabilities under the upswing and the downstream and the multiversion branches",
        "we also found that the hair the convergence of the model the more accurate your scan results will be and the lower the first positive way the hair and the fastness the more results we get from the first positive movement will be held in the same module using a model with hair convergence will give battery loss",
        "next would be relaxed session",
        "there are also cases of commonplace in the curve where keywords including show the error exactly",
        "are missing next we will discuss a few interesting examples although this case may not cause a crash but will cause a logic level",
        "first take a look at this code very perfectly common this common does almost everything which perfectly explains the",
        "structure of our EQ and resp and the success of each member you can see that every 16 bytes however",
        "in the later code directly ignite all be reading infrastructure is sometimes not check the based on if you are interested you can search what types of vulnerability is and cannot be kept so this common can be a big help for us we summarize such as checking comments and the code here on the web can help us",
        "then look at this function it successfully doesn't check and printers will not error login but unfortunately there is no written there's one data will continue to fly in the code and generate the evolution we summarize this kind of situation as check and one result can help us to balance some of these problems",
        "in this program in Vietnam is posting an exam example Global variable Jam check is set at the point that the wrong value has been gotten to the global variable to summarize such as a check after use",
        "some of these problems",
        "in the red box in the code below both are into an image says are to accept the return value of a function that have passed to The Next Step without checking an example later we summarize such cases as we can result check and the turkey on the web can help us done some of those problems",
        "this is a problem that program has fixed I think this problem with the function does not use the parameters passed in the user through the red program we found over 10 similar problems",
        "and here are some of problems we found with these models we can use popularly to help us scan for such problems and different models are super for different products",
        "unlike other vulnerabilities we discussed earlier which are coding this type of error is more feminine and we hope to reduce the attack surface ballista situations we have seen",
        "and finally come to the conclusion there are basically some methods we shared today well sometimes unexpected",
        "defending can Inspire new approaches and even based advising Improvement can help identify the floating problem in compact system",
        "to fix does not mean completely secure you can try bypassing or going deeper three using put here already could be a better solution to elastic product scenarios make spark hunting for customized products more efficient",
        "and we'd like to thank all the vendors for working diligently with us to remediate the security vulnerabilities",
        "we thank you guys so much for your time today and I hope you pick up a couple things",
        "[Music]",
        "[Music]"
    ],
    "A5eG7cmVri8": [
        "foreign",
        "good morning everybody and welcome to black hat we're uh super excited to be kicking things off here this morning we're going to give a little bit of a different presentation than what Philippe and I are used to giving typically at conferences you see us talking about the latest and greatest zero day that our team has discovered or end day research but we thought it'd be interesting to give a presentation on some on things that haven't worked for us over the last 10 plus years and lessons that we've learned as a result of it uh if the presentation's geared slightly more towards a junior audience but hopefully if your experience you'll still get something fun out of this in the process so first off uh who are we who are the two idiots standing in front of you my name is Douglas McKee I'm a principal engineer and the director of vulnerability research for trellix I've been in offensive security for 13 14 years now kind of hacking all the different things and this is my friend and co-worker hi I'm philippewitz I'm a senior security researcher at relics I've been there for like four years I had all this stuff I prefer like systems so I look at like iot devices embedded systems ICS medical devices and so on",
        "but otherwise I do like software and enterprise software and so on I call this stuff all right so to get started in order to understand all the different things we're going to talk about we kind of got to give you a very short background on the different projects we've worked on that comprise this presentation so this will be less than than five minutes we're going to give you a real quick run through of what's good all the projects that make up the rest of the presentation so to get started the first one on Deck here is a patient monitor that we did research on uh several years ago so you have the patient monitor itself and you have the central monitoring station they talk over proprietary protocol called the all are what protocol and we were able to find vulnerabilities that allowed us to falsify patient information uh on the patient monitor itself",
        "next up a consumer project this is on the Belkin WeMo Insight plug these are real basic devices you can turn these on or off remotely with with your phone and you can see it has multiple circuit boards in it that we deconstructed the device here we were able to find a buffer overflow that allowed us to remotely control the device",
        "uh we don't just do Hardware we do software too so this project uh came out about around the the coveted time period and it's centered around distance learning uh this software's uh produced by netop it's their Vision Pro application it allows teachers to monitor what students are doing on their machines pass files back and forth remotely control them and such we found many vulnerabilities in this which allowed us to take over the student and teacher machine through different mechanisms",
        "this is a Delta building controller if",
        "you don't know what a building controller is I promise there are many of them in this building right here they control things like HVAC lighting even Access Control in some scenarios we this is a deconstructed picture as well and we were able to find a buffer overflow in this that allowed us to remotely over the Internet control this device and okay this one is a fun one it's an infusion pump um you'd find that like in hospitals for like you know pain medication anesthesia chemotherapy and so on so he has like spacecom which is a communication module and we are like able to get fruit on spacecom and from there uh the tempo is the settings of the infusion pump to make it deliver drugs way too fast which can lead to really bad outcomes you know if you're like receiving an infusion at that moment that one um was like a Avaya view IP fund I had one of those on my desk unfortunately not the one with the cool stickers um and I was using you know like how secure are those devices uh clearly I made it on the slide so not as much as that uh but there was a quarter Goose where everything is fixed but basically I was able to find you know like a third-party software like in the firmware of that that had like a non-vulnerability and from there from the network we could take over the phone and uh you know Snoop on the microphone and one that and that turned into like a really interesting like Hardware hacking project and the last one of our list is like Azure sphere so it was an iot device uh from Microsoft and um is that like as they were running a like a private bed Bounty program with some of the partners and um you know it's like really locked on uh device like create like a new chip called Crouton and they were like wanted to kind of like have the stuff like some edited and um in the end we were like changing multiple",
        "um like CVS we were like able to get like a remote code we were like able to get fruit on on the device and we again and we we got like something like 160k in big bounty so with all of those um you know it's most of most of these like projects you know like are Hardware based and you could be wondering like oh we really like the hardware experts and it's not quite I mean this is something so uh here's the other iPhone like the inside you know like I really open and when I was looking at it I was like okay so if I can modify this flash chip here I could re-enable a bunch of uh debug capabilities and from there I could also you know probably like that serial console it's like your output and you know if I enable the debug ports and stuff I should have like a console and that would be really nice for doing one research so this thought you know you have like nice uh you know like set up your tools you have flux uh enamel wire to do like tiny soldering disordering birds with a cleanup so it's all nice and tidy but really when you actually do it that looks like that so it's really crappy uh you know like don't go through the job oh yeah right so um here you can see like all the wires are ready to break if you just move it a little so that's why I put like some tape I'll probably burn the tape with the soldering iron it's sort of like a sticky from the flux so it's a mess but nonetheless I was still able to reprogram the chip and it actually succeeded into an apple like the console so here you can see it's not because it's like dirty or not good that it it still get the jobs done which is important and then you know we as like you had like this like you out like it's like little pads uh and it's nice it's labeled as you watch so you know it's a Serial console uh that you could like uh connect to So in theory like the way to go is you have like these things called like Pogo pins which like spring loaded like spikes and you know you create like a rig you put the board everything is really calibrated and stuff but we have none of that and instead you know I went with like this like little chip like uh fly wires and the idea was like one side was connected to my machine and the other was just like holding it and started like poking at the stuff to see if it works or not and uh you can see here like a picture I took was like I was probing a port that's not an ethernet port it looks like it but it isn't and on that one I was looking for um like a transmit pin so that I could like send data to the console and I was you know holding the thing in one hand pressing the key on my keyboard at the same time and looking at the screen to see if it worked it's really crappy but it actually did work and from there I was you know able to get like a root shell on the device so of course you need like physical access so that's not like the great breakthrough but that end up like one research further and the point here is like we don't need like fancy tools it's really crappy and stuff but it still actually works yep so you would think with the Litany of projects that we showed you that were Hardware based that would be pretty easy for us to identify like where a flash chip is and where firmware is and when we were working on the infusion pump project as Fleet mentioned we knew that there was this uh software called spacecom and it was we had completely deconstructed the device so we had pulled off all the flash chips and we were like where the heck is this spacecom software it has to be on here somewhere well I'm rummaging through the components and I end up picking up the battery of the infusion pump and I see that there's a MAC address on a sticker on a battery and I was like that's odd when since when do batteries have mac addresses and so I very delicately start to take apart this battery to make sure that I can keep it in pristine condition to see if there's anything besides just the battery inside and we're actually really excited because there was there was an entire circuit board that had a microcontroller on it it had an RF module and it had a flash chip and and we had just got a new VGA rework station in the lab at the time and super excited to be like hey let's toss this in the BJ rework station and pull off the chip probably should have read the directions first but I'll come back to that later and so we extracted off the the BGA chip we had more experience at the time working with t-stop ships than BGA chips and once you get the chip off realized we're gonna have to reball this thing in order to get it in a reader and so we did the national logical thing and tried to manually re-ball this chip and I could see a few snickerings in the room because if you've ever tried to do this this is absolutely insane and I can also show you point out a few more key failures in this in this picture right so we've got a chip with electrical tape on top of a plastic spindle of wire that we're looking through a microscope that's stacked on two dead computers using a soldering iron head that's way too big for this job so needless needless to say this didn't work right we had completely fried the chip at the time and there was no hope in getting software off after everything that we had put it through now obviously the project ended up being successful and we'll I'll let Philippe tell you a little bit more about how we overcame this problem here shortly but the the lesson learned that we're trying to give that has nothing to do with these specific projects is that breaking things in is part of the hardware hacking process and you should expect that if you're going to do any type of Hardware research you know we highly recommend that you don't embark on any of these tasks unless you have multiple versions of the device that you're going to uh to analyze and also try to do the least invasive process first you don't necessarily need to go this length a lot of times we get excited and we want to jump into the hardware because that's the cool thing to do but there's so many other approaches we can take and we'll talk about some of them here here shortly",
        "and just clear like on that one you should have like do like the probably stuff I was talking probably that would have helped but yeah so like another important factor like when you do like research sometimes just being lucky which you know it's uh that's that's what it is but um another example I was going over like our extended documentation on that Slack and um looking at spacecom you know I was Googling art the keywords related to that and at some point I found some guy who was like actually building space come on GitHub and was like what what's going on here so it's uh probably like some like GPL release type of things but I started like digging through that in GitHub and I found that stuff where it says like oh I know in one of the Comets you had like www.tar which like you know like an interesting and exciting artifacts for like me because you know I wanted I wanted to get my hand on the on the web stuff that's what we're trying to do in the previous slides so you can see like this time I was not all mistake there was somebody else mistake but over there like the guys that kind of like messed up and committed like all of the binary artifact of the stuff on GitHub at some points and I think like a year later someone was like yeah maybe that's not a great ID but really what happened is that GitHub remembers and so from that we were like really lucky and able to um capitalize on that",
        "the second example of like weird luck that was interesting was the asosphere project so to give an idea that board is extremely locked down and for that we were like doing a backbone TVs Microsoft because we like partner with them and the idea is like this really fancy chip like super secure elements but to start like probing that you'd have to get you know like root access on the device itself and Microsoft was not giving us that and um the idea is to you can unlock features by providing a capability file and I was curious which what are the capabilities and I decompiled the command line tool that lets you like provision the stuff and I found like all of the capabilities existing and one of them was like yeah you can actually debug the fancy chip and I think we try like ask for likely like Microsoft is they would like give it to us like that capability for all board and select yeah no that no that's not going to happen and I was like ah crap um and so I kept reversing that tool and I realized it mentioned like you know it was fetching these capabilities from I know prod dot you know Microsoft Azure sphere.com or something but also like mentioned there you are like pre-prod and staging and Dev and so that has a great ID maybe if I talk to Dev environment instead of fraud environment they would give me more capabilities so I tried and that did not work like you can see on the screenshot that's the result I just get exactly the same capability I had before that was that was just a failure but I remember that thing like in the documentation of visual spheres like you can only claim a device once so you can only say this is my device once and then it's over and that's how you like able to like uh get the capability to push code on it but if we go back to the previous slide we can see here like so it says now in the pre-pod environment but it asks also asked me to claim the device again on that pre-prod environment and then everything works just fine and so you know that's all I was looking for was like wait a minute why did it ask me to claim it again that's that's weird that shouldn't happen that's breaking the security posture here because you know I can claim twice and yeah we told like us of that and they were like yeah that's that's a critical bug here's like 48 000 for that so we were like that was extremely lucky so what happened was you know I try something that failed but uh by picking uh you know this weird situation where like something was off it was I was able to like move on and get I think get something actually interesting so you know sometimes you need to capitalize on your luck and uh be able to handle those like situations",
        "another thing that goes hand in hand with getting lucky is uh assumptions and a lot of times assumptions can be the death of the way that we we do a research project we assume oh the the vendor or the developer definitely would have thought of this and so we're not going to look at this or this is going to be too hard so there's no there's no way a reason to go in a certain direction and I'm going to use uh the NetApp project for for this example and NetApp again is a student monitoring software and it had a huge wide range of features right and so we're going through enumerating these features and investigating what this can do and one of those features is this remote control feature and this remote control feature is uh for lack of a better term it's a wrapper around RDP basically it allows you to log in using Windows credentials to a student's machine and you have full access to that now when I say wrapper around RDP or you're thinking Windows credentials and login it's really easy to make the assumption that well of course they encrypted those credentials why would they possibly be in clear text on the wire and never look for these type of things and we actually ran into this looking for something completely different in the Wireshark capture and found out that the credentials for the Windows system were not encrypted going over the wire this is on no Advanced hacking that you know Philippe or I did or anyone else in the project it just happened to be that way but you have to to know to look for these things and not make that assumption and so that's that's kind of our takeaway from from this section of the presentation is it some there is a degree of luck and you have to understand that when you're doing research but there's also learning from your past experiences and just going through the motions and knowing and looking at all the different components whether you think it's going to be that way or not",
        "so the next topic we're going to talk about is documentation I love talking about documentation the researchers because I feel like there's no way that that you don't hate it you either hate reading documentation or you hate creating documentation or you hate both but the funny thing is documentation ends up playing a really key component in a lot of the research projects that we've done and one of uh one of the examples I'm going to use for this and again even as researchers have done this more than once we forget to read the documentation all the time so the the patient monitor project I had pulled the Sam file off the central monitoring station and they had different levels of authentication and that allowed you different access and of course my knee-jerk reaction being in red teaming for I don't know how many years was let me throw this on the GPU cracker right and get these and get these passwords so that way I can get into the next level of the system and learn more about it and continue my and continue my research well after some time I wasn't able to produce the passwords using using a cracker and several months later I finally got around to reading the documentation where which clearly had all the passwords in plain text right in the documentation not only so but found out that they're hard-coded to the point that you're like you're not supposed to even be able to change them so if I would have simply taken the time to read the docs before doing this I would have progressed my project a lot further ahead of time uh another thing I think we forget as researchers that code is documentation and we can get into an argument about whether or not we always have the source code because of reverse engineering and ASM but for the moment let's let's talk about uh just open source code and most of our projects there are some component that contain third-party components that are open source and therefore you have code to read well during the the WeMo project I actually the vulnerability was discovered very quickly it was very easy to leverage it was through sending an XML packet to the device jumped right into exploitation didn't even think anything further of it and I struggled during exploitation in the beginning which it was a classic buffer overflow should not have been any struggle at all and realize that my characters weren't getting through or especially my shell code was not getting through to the stack well if I would have taken the time to read the XML Library it's very clear in here that the XML code filters out quite a bit of characters and this is something we encounter in exploitation all the time and it's extreme really limited character set that's that's allowed through the XML filter and so just another example of where I could have saved an immense amount of time if I would have taken it taken it taken the time to read through uh what what's going on in the code that I'm actually working with so what's our takeaway from this the good old classic rtfm still applies and this also accounts for open source resources too don't get so narrow into chess the the manual but as fleeve is demonstrated finding resources on GitHub you know the old adage still stands true yeah and I also think like finding GPL stuff can be extremely powerful like in all situation like that so that's a another good one to remember anyway uh one of the thing is you know like when you do like one research it's not always you know like Smooth Sailing you know like sometimes they're like actually like trouble that can happen um one of them was um in the in the space like in the in the infusion project we were working on so I said we got fruit on uh spacecom but before that we only had you know like a limited user like RC and we wanted to access skeletal privilege so by reading the code and stuff we eventually found that where uh you know they CD to like the root uh directory and they extract like a tar file uh and Roots is doing that and the star file you just go back up of the configuration and so you could like back up the configuration plan to the suid binary in it and push it back and from there you have like a preview registration so that's nice to have Roots exploit and stuff and we're like okay we're like perfectly in a great position to like the next step of the project which is targeting the infusion pump itself but you know because life happened like Doug and I had to like put this project on hold and and a few months later we are like finally ready to resume that that stuff and as I said I love to Google all the stuff and eventually I found that stuff which is um white paper that was published like like two months prior where like some German um agency commission like a state of the art of medical uh iomt devices medical uh medical devices and uh the the research team like looked at exactly the same device we had looked at and disclosed all of the bugs we had found so dog and I were like really sad about it um and that was really like one of the lowest parts of the other project but we didn't give up and you know eventually we like persisted because these guys would like release that stuff stopped at spacecom and so we moved on and uh targeted the pump and eventually we would find some really fun stuff but that happens you know and you know there's like reason for that uh if we had like submitted too soon and that might that might have tipped our end and also the project to stop Flex sooner so level like reasons but it's going to happen you know uh the Collision happens and that's the way of life",
        "another thing that we we deal with on a regular basis is I like to joke that I spend 70 75 percent of my time just building out a system or learning about a system and only 20 or 25 percent of my time actually doing any hacking and I think that's something that's very common that we don't often talk about is that there's a lot of work that goes into setting up for our testing and doing just our research and there's some a lot of struggles in that and one of those struggles has to do with cross compiling and I put on the screen here a screenshot of a co-worker of mine Mark pereza who wrote this in our document our Confluence and documentation uh in a joking manner but it's true right so he talks about here that we found an embedded device that was perfectly preserved in metaphorical cyber Amber and what do you do do you donate it to a museum or do you try to hack it and of course we try to hack it and this and this requires a lot of legwork to be able to cross compile tools we actually had to go back all the way to Ubuntu 12 in order to build out a system this is for the the Delta controller project to build out a system that we could build tools to put on that project and this we struggled with or we struggled with this for weeks and eventually found that there was one small flag that needed to be set in the build root system through going through messaging boards and it says here the extended local support and that one flag was the difference between our our lib C versions matching or not matching but on the device and you know I also like to talk about how most of the time we're looking for like to get GDB server or those type of tools on the device to do research and there's a hundred different GDB server versions already pre-compiled on GitHub and I swear none of them ever work for any project that I need and I have to start from scratch but the point here is that not to show you one specific flag that you need to turn on for your compilence that's going to be different for every single project that you do but is to kind of highlight that we all go through these struggles and these are these are struggles that aren't commonly talked about in you know Defcon black hat presentations where someone's telling you about how they went from oh I decided to do this research project and here's what I finished at the end but there are things that we we all work on and we have to fight through and they're common",
        "uh and along that we a lot of this industry suffers from imposter syndrome right thinking we're not good enough or perfectionist uh working really hard to get something to what we think is done and you know the adage that Perfection can be the the enemy have done I'll show you a few examples of uh imperfected pieces of code that have actually worked well for us during projects and that you can still be successful so this is talking about the uh Delta building building controller project and we ran into a watchdog a software Watchdog if you haven't done much embedded research before a watchdog is simply either a piece of Hardware or software which it checks if the system has been stalled in any way shape or form or if an action hasn't occurred in a certain time period and then it takes an action as a result typically that action is to reboot the system you find these all the time in critical systems or real-time systems and so we uh we're doing some static code analysis and we ran into a software Watchdog and we thought we were all super Elite and we opened up Ida and we patched it real quick and spit out a new binary and and then put that on the device just to find out that uh that didn't fix our problem at all because there was actually a hardware Watchdog that was was causing us a problem and so we had to figure out how are we going to disable this Hardware Watchdog and I decided to write a very small piece of C code that would proverbially kick the dog and I is called a external function from a dll that was already on the system in this really sophisticated piece of C code this is literally the entire program except for the int Main and it's an infinite while loop calling one function every millisecond to make sure that the uh make sure that we didn't trip the Watchdog and I even went through the awesome C style here of hard coding how many characters are in my error messages right I'm pretty sure my C Professor is cringing if he's watching this right now because this is not the best way to write C code but it works right and it solved the problem we had and were able to move on from it another aspect in this is I like to talk about fuzzing uh fuzzing sometimes for for our industry can be like this huge mountain or hurdle that we're afraid to tackle or or work with because we just feel like we don't know enough about it and don't get me wrong fuzzing is can be extremely complicated there's lots of uh techniques out there and different methods and different tools but it doesn't have to be and here's some example of some I'm going to use air quotes fuzzing uh that I did on the patient monitor project that actually produced useful results uh and and my point with this is don't let complex topics deter you from trying techniques during your research and don't don't let that be a hurdle make it super simple give that a go and then grow from there and learn further about it so what's our takeaway from this section is that your solution might not be a might not be elegant but if it works who cares right at the end of the day if you're trying to accomplish the goal for research let that be your Mantra you know sure if you're going to release the tool publicly or you're going to you know work on production code you want things to be polished but a lot of times in research on the back end that's not that's not what we need to do all right so the last topic uh one of the last topics we want to talk about is uh rejection and resilience in general so we're going to talk about this in two aspects and the first is uh from a vendor disclosure perspective so at trellix we practice responsible disclosure because our ultimate goal is to hopefully produce more secure products in the industry and so we disclosed to vendors and then of course uh publicly after we disclose to vendors hoping that there's a patch available and we really do this with the best intentions in mind right we're not trying to drop zero days uh and and make vendors look bad or anything like that we truly want to make things more secure but not everybody sees it that way uh and for for a disclaimer uh these that we got these Snippets are not related to projects in this deck so you cannot try to correlate who said this from these projects they're from projects we're not talking about today but we still have disdain in the industry when someone tries to go through responsible disclosures and these are just some examples that we've been threatened with legal action we've had conference presentations be threatened to be taken down or wanted to be scrubbed we've had vendors not communicate with with us at all which makes responsible disclosure hard and decisions to make and I will say in the last I don't know five to ten years I think this has gotten a lot better and I would say 90 of our disclosures go very very smoothly and vendors do a great job working with us but this does still exist and if this happens to you you shouldn't take it personally and you shouldn't think it's something that you're doing wrong this is something we have to work better on a better at as an entire industry smoothing out in the process so my question Philippe to you is have you ever got rejected from a conference before all the time unfortunately that's that happens so uh yeah if you look at um do there's like some screenshot of some of the rejection Doug and I both got so I think um the first two um it's um you know we submitted like a talk to like you know big conferences like yeah no that's that's not for us but really like what happened was like the same talk got accepted in like multiple conferences you know worldwide and stuff so sometimes you can be like thinking well maybe um you know do you really match the cfp and whatnot but also sometimes something you help is like well it's so hard for the ego but it's better just to say like zeldos than like you know like going into like existential crisis and um the next two at the bottom um Doug and I submitted to a conference and uh a few months ago and I had submitted a second talk just to be really sure like at least one accepted and what we knew was that both was like shortlisted among the the last ones so like maybe maybe not who knows and eventually we got like a first um refusal for for the first one but they were like really specific that each stock that was still pending would receive like either like an approval of denial and for like the following like three weeks I think I was really hoping waiting you know keep refreshing the the email the website like trying to see like crossing my fingers am I getting accepted and that's probably a good like three weeks I messaged them it's like hey you've been you're like a month late like what's going on and like dude we already rejected your talk like two or three weeks ago was you and so I think what happened was I just you know as I just you know why you got crossed and they just you know forget about it so and I think in that that's what I'm trying to say sometimes you know like you can build your expectation and that's unfortunate so it's good sometimes to be a little more assertive or so and uh you know being the cfp board you know not you know respectfully uh but you'll not build too much expectation and because I never learned from my own mistakes the the submitted button on the on the bottom right is like another conference I um submitted to and I think the conference happened in like a month or two ago and I'm still waiting to hear if I'm presenting or not so you know sometimes you know you should you can get also ghosted by conferences or just forget and so it's good you know to uh to Ping them who okay so on the other hand to try to like optimize your chance uh to get accepted uh framing is important uh so the have I have and I was talking about you know like it was a vulnerability in third party component that was already known the thing people didn't know was that that vulnerable component was in the firmware of the device so by all means that's not like a sexy vulnerability you know I didn't even find the bug itself I just found it was there uh but those funds are like everywhere you know like when you like know to recognize them you see they're like really like all the places uh even at the conference hotel we were at but anyway the point is uh I was like why like if a bird has been there for like 10 years why nobody noticed and my assumption was like well you know Hardware hacking is a different um set of skills and that's a little scary when you've never done it but you know you've seen in my previous slides you know you can do like sheet work but it still get the job done so it's fine and so I was like well maybe I could help people like overcome this like discomforts and turn that project into like a neutral addition to Hardware hacking to show how it's done because that was not hard and everyone can do it and so I present I submitted that and actually got accepted so I was able to turn that you know like crappy vulnerability into like a really like useful like tool to share with people so framing is important and you know understanding like the expectation of the cfp review board like the attendees and so on so that you tailor like what you submit to like the conferences you want to go to so yeah I think the lesson here is like you have to reject rejection um or accept rejection I don't know like the point is you know it's part of the process um I know like friends of mine was like scared of like submitting like to talk because it wasn't too confirmed because he wasn't sure we feel that good enough or you should just submit if you have like something that you find is interesting other people will likely find it interesting and you should try worst case yeah you're going to get like a rejection like later but who cares you know and best case scenario you actually get accepted and that's great so it's important not to uh you know cut yourself short and you know just not try so I would really like to say that to people like embrace it and just you know frame it and understand how things works but go for it and I would like to just to like wrap up like what all the stuff we have like a couple of Life advice that I guess I wish someone like told me at some point um the first one is like one of really important is like watch out for burnouts I think one of the like Mantra to people like repeat all the time is like try harder and for sure like persistence is important but sometimes it's not great like you can you know Bang Your Head on a problem and eventually something is going to crack is that the problem or your heads and that's not necessarily great so in the case with the infusion pump um originally dog like reached out to me because he had them the firmware of the thing and he was like oh do you think there is Flash on that stuff and I'm sure like dog would have been able to like figure it out on his own but that's one of my forte to find that kind of stuff and because he reached out instead of just trying harder to figure it out on his own like we both worked on that wonderful project I'd like to create results and so on so you know try other maybe sometimes but also you know like reach out and understand you have like teammates and whatnot so you know not always try other but try smarter Maybe the other one is you know like this overused like comic like this is fine well sometimes it's not you know like this Bulldog is actually surrounded by fire having that situation not in description but in the past and I think it's easy like in our industry to think that you know like we go from one fire to the next and the next and sometimes it's warranted you know like if you're doing you know like um incident response and there's really like a fire right now that's one thing but sometimes it might be like mismanagement or like weird expectation and you know just people are abusing the fact that we all love what we do and we're actually intense in our work and so everything becomes like critical because you know like management say that so you know don't be this dog don't assume this is fine you know at least acknowledge it sometimes you cannot that cannot be helped sometimes it can so try try to be a little smart about that and protect yourself",
        "and the last one uh I wanted to put some like cool art um but the idea is like don't be like Icarus like if you fly close to the Sun you know you you burn your wings and you fall uh for me that was like the isosphere project so you know there was like a three months really intense uh challenge that's really fun I was really excited you know there's like a lot of like cool stuff to work on it was really hard and exciting and yeah I worked you know like 200 on that I was like full on because it was fun nobody forced me but when I was done I felt really empty so you know it was like the cool stuff was over and it took me I think months to recover from it just to like you know get excited about something again and so that's the thing I want to say here is like it's good to pace yourself you know the fun stuff you're working on Friday will still be there on Monday so you know you don't have to work the whole weekend on it sure you can do it if you want but you know at some point you know like a candle that bright that burns really bright like like burnt shot or something not the right item but you get what I'm saying it's like a yeah it's easy to get burnout on stuff and we should be like mindful of that and and protect ourselves and I think one trick to help uh preventing that is to keep it fun so um you know we're lucky like you know on this tree like we have a lot of fun stuff we can work on you know like CTF going to conferences you know meeting the all peers and whatnot and that example I picked just like an old project of mine where I was like I'm going to reverse Final Fantasy 7 and extract some text in Japanese and you know left translated so I can learn Japanese that one was also kind of a success because it worked but I never learned Japanese through that I did learn some mips so that was useful but the point is uh it's fun there is no point in that it's just like you know I'm not going to find a CV it's not you know you cannot monetize it but it's fun and I think if you ask me like like many other projects that couldn't fit on the slides from other people who also work on really fun stuff and I think it's important for everyone in this room to figure out like why are you in security why is it fun for you and use that to nurture not sure your excitement and you know don't um they don't get sucked dry from you know like all the Crazy Fire around you and remember to enjoy you enjoy it while you can so I think now it's time to wrap up uh We've covered like tons of projects and I think by all means they are all really like successful you know like bounties tons of CVS confront stocks and so on but we're like not here to brag about it the point we really want to make is you know at all the conferences you go to like people who share like the shiny results all the good stuff you know at conferences on YouTube or however the bouncy people they all share their success and and if you like new indie industry or if you like you know try to get into one research you know you might compare yourself to those you know like the shiny results and you will never match that because you know you struggle it's difficult there is rejection and all that but the truth is you know like what we see on stage is just like a tiny sleeve of like reality and that should not stop anyone from trying and you know having fun and you know submitting to conferences and just following like quite exciting so I think that's the the important stuff we wanted to share here and um yeah I think we have like a three minute four questions and otherwise uh you can find us on social media and we'll have a follow-up description tomorrow so yeah uh we have like three minutes for questions attendees are welcome to come to the microphone and thank you guys [Applause]",
        "[Music]",
        "[Music]"
    ],
    "uqWiZXMh8TI": [
        "foreign",
        "thanks for coming uh my name is Andrew and I work at Microsoft I'm on the msrc vulnerability mitigations team and let's talk about kernel exploitation",
        "so most of you are probably aware of who msrc are and what we do but my team of vulnerability mitigations team we handle all of the security vulnerabilities that come into Microsoft we are Microsoft Central Security team we triage the vulnerabilities to work out the severity of these issues and then we work with the various teams product engineering groups throughout Microsoft to fix those issues they typically then be patched you know in a patch Tuesday at some time after the initial reporting of vulnerability so I spend roughly 50 of my time doing this I use the case information to try and find patterns within the vulnerabilities that we see such that we can develop mitigations to kill potential",
        "whole classes of vulnerabilities rather than dealing with Point fixes across a series of issues and when I'm not doing that we're doing uh well so typically I do red teaming exercises where we hack infrastructure in Azure and work with the product teams to fix vulnerabilities proactively in our internal infrastructure and products so I worked on this piece of work with row here to unfortunately can't join us today because he's over in the US",
        "so what I want to talk about here really is our handling of some kernel vulnerabilities that we see so we get a lot of vulnerability submitted to Microsoft now typically the bug which is submitted to us is clear you know we double click a POC we get a blue screen you know we can root cause that and work out what the cause of the crash was but the exploitability of an issue is not always apparent and this is because we don't require you know researchers and finders that we work with to give us a full exploit because you know we want to patch the operating system we want to fix vulnerabilities proactively and sometimes writing an exploit for some of these bugs particularly in kernel can you know be more time consuming than simply just fixing the vulnerability",
        "um and so for this reason some there are some classes of vulnerability that it can be hard to triage and work out what the real severity of that issue should be um and and I guess I kind of want to talk here about a couple of outliers so there's so if we have an out of bounds read in kernel for example where the attacker is not able to retrieve the content of that read um you know typically we're gonna uh call this a Dos maybe it's an information disclosure if you can probe the memory address which is read or something to work out whether it's resident whether it's mapped or whether it isn't um but",
        "not all bugs are equal here right there are some out of bounds reads that we see that that potentially could be more critical than others and there was one specific example that we got uh that that got us talking so let's cover the example which sort of led to us you know doing this if you will feasibility research study um and we'll talk about memory mapped i o so device uh drivers communicate with Hardware which is attached to a system potentially via mmio we'll talk about whether you know it might be possible for example to Target mmio ranges with a blind kernel read in order to be able to corrupt device state or device driver state which runs on top of this and whether the right exploit Primitives which are applicable in that area I'll cover some kind of reverse engineering over various drivers which Implement mmio what we need to look for to work out whether a driver is using this or not and some kind of interesting patterns that we've seen in there",
        "so I'll start with the vulnerability which got us talking about this this was presented at blackout us 2021 after I",
        "started at Microsoft this was one of the first hyper-v cases that I handled so in",
        "this case it was presented by palega norfia at um",
        "sorry palega northier at uh blackout",
        "last year but essentially a guest virtual machine is able to issue a packet which is sent to the host or the root partition the root partition dereferences an attacker control pointer and it crashes the host so that's a picture of my of our machine in my office just blue screened with this bug",
        "um now the bugs in VM switch which is the hyper-v virtual network switch so uh this provides virtual ethernet services to guests which are attached to the machine and Communications happen via renders over VM bus from a guest to the host in order to reach this code now the crash itself was like I say it's a dereference for read but the value which we are dereferencing from the packet was used for nothing in this case apart from logging and so it checks a field within this structure which is partially attacker controlled we de-reference a value in there if it's not null um so here's an example of this structure it's kind of unimportant really apart from uh there's this field here which contains data which comes from a packet of the attacker controls and the code or at least a minimized version of the code which handles this on the host side takes the data which has been passed in uh casts it to an example of that structure I've shown we check if that field is null and if it's not we dereference it and we get a nice 4141 41 plus hex 20 crash now",
        "we we rated this vulnerability",
        "um 9.0 CVSs guest to host rce or VM",
        "Escape and the reason for this was because we we can't guarantee that A Primitive like this is not exploitable um in a case where we could for example point this to any memory region that exists within the host infrastructure or the host uh can we guarantee that that doesn't lead to memory corruption because if we could point this to a device mmio range if we had a device which implemented a kind of quote-unquote interesting Behavior would it be possible to turn this into something which causes an onward memory corruption with potentially like a right so let's talk about memory mapped i o so mmio is used or can be thought of as kind of a message passing mechanism which operates between peripheral devices which are attached to your machine so your hardware and the device drivers would communicate with those so we can kind of view the logic at a high level as a state machine and if we were to inject a reed into that state machine a during operations which were transiting that region of memory would it be possible to corrupt the device driver which is reading and relying on that memory in order to cause a more critical memory corruption with our initial read",
        "so there was an article which I mean is six years old now this is discussing the implementation of mmio in the Linux kernel and you know that they highlight a bunch of issues or questions areas in that code which could be of concern there's a couple of points I'd like to pull out I suppose one is that the size of a right to an Mio region is important a device can respond very differently to say a right of a d word than it might to the right of a byte so the size of the access is is is important",
        "the second point is that um if you considered a device which may be operated like a Serial input buffer",
        "um that would imply for example that if we were reading characters from a queue which existed on Hardware device into device memory when we read a character it should be removed from the state of the physical Hardware device also and because this implies State between",
        "the two devices I mean you could imagine a scenario where you have a length prefix buffer for example if you interjected read at the point that the length was read from the start of a buffer but what then happens if the device which is reading from that relies upon the subsequent characters uh you know as the length then potentially we've got corruption issues",
        "um so there's been a few bugs in the mmio space discussed um I won't go into the first two in much detail because they are they're Hardware based and and I want to talk more about software-based attacks here um the Intel one's interesting because it backs up the point that we made about the size of a read muttering here if you read data from an MRI region and the size of the read is not the same as or at least as large as the instruction set architecture size so 64-bit for example then a data can be leaked",
        "um the the last example which was presented at cansec West this year was was particularly impressive they demonstrated a full VM Escape uh running on a Linux system with Kimu or KVM and in that scenario they chained together four bugs in order to ex to to break out of the VM one of those bugs was a recursive and not my own floor this is uh essentially using Mio regions to the overlap or that you can use to trigger a UF vulnerability for example so it's kind of sort of demonstrated that uh these bugs can be bad for for kind of guest to host escapes but their research focuses",
        "primarily on using something like coql to analyze a Linux source code to find vulnerable patterns and use those to find places that we might want to exploit the issue is on Windows we can't do that right it's closed Source we can't use code ql we need to be able to find drivers via some other means uh in",
        "order to try and work out where the places are that we might want to be able to build attack Primitives uh and and kind of that's the difference between what we want to talk about here so how do we find something on a system which uses mmio",
        "um there's a couple of kind of basic methods which one of the slides are published you'll have links here but I won't go into these because they're not too interesting I'll talk about acpi and I'll talk about hooking the kernel in order to do this information or to dump this in a debugger um the first the first point is that mmio ranges as are mapped are physical address ranges they're not virtual address ranges so if we were going from user mode to Kernel mode and trying to use an attack primitive like this this implies that we would also need a kslr bypass we need to know the physical address range where that resided in kernel memory",
        "um so what is a CPI um the advanced configuration and power interface this controls kind of at a low level operations which include things like system power hibernation States sleep States i o flow like I O probing plug and play and it's kind of designed to reduce the Reliance on older Technologies like smm or SMI so that we can bring control of some of the lower level Hardware uh into the realm of the operating system rather than relying on some Intel secret source to do this for us now acpi is a subsystem which runs in ring zero it's managed by the acpi sys driver and it contains a full virtual machine the virtual machines are capable of interpreting AML which is uh acpi",
        "machine language bytecode and it can execute this so that is a turing complete programming language you know you can go to the apica website and download all your like computer science 101 Fibonacci Sequence you know programming examples and write them in acpi AML",
        "um now all of this information is built",
        "in the UAV pre-boot environment it's handed over to the operating system in Phase zero kernel initialization and it's stored in the registry that is accessible by low Integrity callers uh so it's not protected uh you know to high integrity users or anything like this and it contact well we can use these public tools to just dump information from in there um and and as as is relevant to our Point here there's a bunch of optional tables which exist within acpi one of which is the mcfg table which contains pcie configuration information for the",
        "system which you're running on um now we're told that that particular table is the what Express mapped configuration space address description table which is a mouthful but this contains information on all of the PCI devices which are registered on the system so it contains the bus device function numbers BDF for every device which is attached to a bus and has been enumerated at system boot so we can decompile these tables at runtime from the desktop operating system we can dump the mcfg table and we can take the address of that and just pump it into a public tool like RW everything",
        "and if we do that then we're able to see any devices on the system which have mmio ranges registered",
        "now I caveat this with when I've been doing this on test systems hyper-v virtual machines do not have this table registered under a default configuration at least a physical Hardware devices that I've tested do um so your mileage with this may vary but using these tools we're able to dump the acpi table information which will show us all of the optional tables that we have registered and some of the compulsory ones like the dsdt which will contain all of your code for all of the devices attached to the system uh given those we can extract the information to adapt file and use the iasl decompiler to decompile that information and in doing so we'll get something that looks like this it gives us a base address in physical RAM where the mcfg table is stored if we take that and put it into the RW everything tool we'll get something like this for every device on the system so I've selected one of the pcie devices attached to this system and we can see that it's a PCI Bridge so it's a root PCI to subordinate PCI bus and we've got",
        "the memory range where that is mapped so this is one this is one way that we can enumerate all of the devices that exist on the system we can then go find the driver for this and start to reverse engineer it the other mechanism is hooking um so ntos kernel exports a bunch of public interfaces from the memory management executive which allow us to map an mmio region to a physical kernel vas virtual address space",
        "and if we hook this and the associated unmapping then you know we can get all of the entries on the system which which",
        "use mmio",
        "um which is what I've just said these are publicly exported so it's fairly easy to do so um the slides that I'll publish will have scripts in them um but just for here I've got a video I think the guys at the back might have to click on play",
        "so here we have a kernel debugger attached to Windows VM and just to prove that I'm not using any Microsoft secret Source we've got public pdb symbols we're not operating on private symbols we'll dump the map i o space and unmap routines that we've got symbols for just to prove they're there set a set of scripted breakpoints that just simply print out the physical addresses and the virtual addresses that are mapped as we go through so that we can see for every mmio region mapping and unmapping the the values which are which are used and and you know you get a ton of output in here for doing this but if you issue something like a log off or sign out uh command",
        "then you know typically at this point you're going to hit a bunch of these in the debugger so by doing particular actions or exercising functionality of given pieces of Hardware with these breakpoints enabled gives you the ability to not only see where they come from in terms of drivers but also what those are potentially used for where they are mapped and so on",
        "so one of the one of the things that we notice in the output when doing this is that in a bunch of places we we kind of see this pattern where we map some memory to a given virtual address and then immediately unmap it again and we go through this pattern where we map and unmap and we map and unmap now from kind of like a fuzzing perspective this makes things difficult because you can't just pick one of these regions and start to fuzz it because the chances are it's going to be immediately unmapped and then you're gonna you know essentially seg forward the system by reading an address which is no longer resident um there are some which if you measure this early on in the boot process remain resident throughout the full boot of the system here's some examples of those um",
        "now given that we can find some things that use mmio we can find some you know driver files or like what do we want to do with those um so there's a list here of some that I spotted which use mmio I've looked at some of these but not all of them I'll talk about a couple and and some of the points that are interesting within them um but one thing that I've not looked at at all is is the hyper-v attack surface here like when we originally started looking at this work we were trying to work out whether we could exploit the kernel from user mode but actually the attacks that we're talking about here I think apply much much better type of e and for that reason I've not looked at any of these drivers and I think that actually this is if anyone wants to continue you know building on this work for example that's a great place to go and look like for example if you examine something like virtual GPU or vgpu and hyper-v this is a virtual device which runs root aside so on the host and it is a virtual device implementation which talks with a driver installed in a guest directly using my own regions and and there's actually some benefits to an attack of that nature because we don't need to understand complex things like virtual machine bus and how the information is transferred between the two we just need to reverse engineer the driver on the host and if we find bugs in the way that it's handling the mmio code then you know as an attacker you completely control the guest right you don't need to worry about these physical address mappings you can issue reads and writes and potentially even trigger particular actions within a given piece of hardware and then start to spray your rights or reads for example and in this way I think that some of the Primitives that we're talking about here potentially can be particularly powerful in that case and the other thing that's worth note in in that respect is that you know msrc are paying bounties of up to like two hundred thousand dollars for bugs in hyper-v um so if anyone's got spare research time go look there",
        "um so one of the drivers I looked at to start with was um this one the Intel AV stream camera driver this is the embedded camera in this Surface Book laptop that I'm using here um and the reason I started looking at this is simply like I I run a new strings found the mmio base addresses and as I know I'll start looking there um and the first thing that we see is it does mmio map IO space ex so this is the API that we talked about before the first thing we do is we map a region of memory from the physical address into this local variable we pass it to some routine called cache region and and then that is essentially stored for use throughout the rest of the driver so it's a plug-and-play device which means that you know when you turn the camera on you get that little red light to tell you it's active at that point you get a plug and play device arrival event and in the device arrival event we map this mmio region we cache it to a global variable stored in the data section of that driver and it's used for the duration of the time the camera is active when we turn the camera off and the red light goes off we'll get a device interface removal event and these mmir regions will be unmapped from memory",
        "um accesses to those regions are in this driver case correctly uh synchronized so that there",
        "is not you know opportunity for race conditions within a given read routine",
        "so",
        "apologies if you can't see this in too much detail at the back but the details somewhat unimportant really this is the code which will issue an mmir read basically what we're doing here is you know we we get the call we make sure that we're running at a DPC level or and if we're not we'll raise the occult that the driver is running at we'll acquire a spin lock to ensure that you know we're not going to be preempted we'll read an offset from that mmio range and then we'll release the spin lock so the other thing that's worth note here is that we've got MML fence calls which prevent CPU speculation past these points so I guess that's kind of an example of of a good read function we're issuing a single read from an mmio region we're ensuring that it happens atomically and that we can't be preempted when that happens and we'll read a particular range into a result field uh like drop the Urkel back down potentially and and then return",
        "um now in the driver this is used so when we first map the region we should pass it to this cache routine which basically stores it straight in a global variable which is used throughout the rest of the driver and that and that routine we've looked at just before uses one of these range offsets to read from that now I guess what this is to say that like this is in typically kind of a common pattern that I've seen in some of these drivers right we we map a region while we're going to use the device we cache that somewhere and and it's available for use throughout throughout the time that we're using it and this is the original function that I showed you before we mapped the address and we cache it",
        "so if we if we examine cross-references",
        "in either to some of the places that use this code um in this one driver there's 260 locations that do mmao rights and there's 180 that do reads um now a lot of those are not very interesting they read performance counter information or something from the device and just you know use this to to make various decisions but I've included this example here because it's kind of a nice one because it has some print statements in it and things and it kind of makes it obvious what's going on um I don't think this particular one is exploitable uh to be clear but what's interesting here is the pattern and is the pattern that is more interesting and is this kind of what I was hoping to see when we first started looking at these we have a function which we're told is authenticate firmware the first thing that we do in there is we do an MMI or region read and then we're told that the value that we've read from the devices the security CTL register before authentication we go off and we perform some function that I'm going to wave my hands past at this point but afterwards we do a second read from the same mmio region offset and then we're told that the security CTL register after the device firmware has been authenticated is this now as we've talked about like you know these do read calls correctly synchronized to make sure that operations happen atomically within themselves but ultimately what we're looking at here really is a potential double fetch vulnerability in the usage of the mmir regions themselves where we have this pattern that we issue a read we perform some conditional operations and we reissue the read that you know there's a chance to exploit a double fetch or talk to in this case right",
        "um and so this is kind of a pattern that's that's interesting",
        "the second driver that I will talk about here is is an entirely different class of driver this is a a bus driver",
        "basically to support integrated circuits",
        "uh so specifically uh it",
        "it is to support the registration of devices onto a PCI bus so when the system enumerates devices that are on a bus they'll be registered with like the bus bridge and and that contains a set of functions for example within a given device which it is able to issue Communications or commands to so one of the things that we'll register is things like interrupt service routines and deferred procedure call handlers for a given device uh we'll register things like d0 and D3 sleep State Management functions on prepare Hardware on release Hardware functions this kind of thing now the in in this case it's kind of our suspicion I guess that mmio is employed here to support things like the registration of acpi compliant devices with a given PCI bus Which would mean that where a device supported something like a temperature cut off sensor then it can be registered with the acpi subsystem and acpi can dynamically issue device i o based upon interrupts that can be registered in that framework so this means at a kind of a high level you know if you've just spent two thousand dollars on your brand new 40 90 and it starts to overheat right you you don't want you don't want it to burn out so instead what we'll do is we'll uh register and interrupt with that device which will trigger uh and and essentially you know we'd be able to perform an action like triple fault the system in order to not you know protect the hardware and not burn it out that's kind of the purpose of some of this um and so here's some code from within this driver which does um you know we can see we've got dco entry in and exit those are device power management states which kind of support you know the description that I've just given",
        "um and and the code in here should again look very similar to the one before we map an mmio region and once we've done it we store it in some struct and that struct is used throughout kind of access to this device so this happens on prepare hardware and we've got a similar routine on release Hardware which will do the reciprocal unmapping for this call now we've already said that here this is used to support registration of devices with a bus um so system control interrupts or SCI interrupts in acpi can be raised on things like I say thermal event triggers those are registered with an acpi AML control method which runs inside that virtual machine that I already talked about in ring zero now the question here is like basically",
        "this exhibits the same pattern that we've just talked about in drivers we have an mmira region which is mapped for the duration of use for a device and you know callbacks can be issued to the host OS which happen to be executed inside a virtual machine which is running a full programming language which can do whatever it likes including issuing device i o requests and",
        "yeah essentially this means that it looks like we can Target code that runs inside this by code interpreter in the same way that we can Target code which runs on drivers so you know discussion of some of the internals of acpi is kind of beyond the scope of the talk here but if you're a nerd like me you can go and read this back that's out there um so this potentially means that anything which is using acpi is interesting as well and that those regions are mapped throughout the usage of that device once it's attached to the bus that region is resident",
        "so to start to you know",
        "to wrap up some of the the observations here typically we have this pattern which happens a lot in drivers where we map some region we allocate a kernel virtual address space we copy information out of that virtual address space and we unmot the region if we have patterns where we do some action that relies on this state and then we do the same action again then we've got opportunities potentially to exploit double fetch Primitives here and you know we've seen this in more than just the place that I've that I've demonstrated and and typically these end up wrapped up into these functions like do a read do some action do another read um and because each individual one is synchronized but there's perhaps not synchronization across the the two calls you know that that that's where we have a potential to exploit this and and like I say I think that this applies far more as a hypervisor attack primitive right if we've got a driver for a virtualized device which runs on the root partition then being able to Target this uh directly removes actually some complexity from uh the path of the attacker",
        "at least one person doesn't think we're crazy uh so this this individual's a finder who's known to msrc for high quality submissions they kind of agree with us that you know this double fetch primitive is something that potentially can you know is potentially exploitable",
        "um the other issue that we talked about is kind of the opportunity to exploit race conditions here so the order that these operations are executed is important to depending on the type of mmio that's used there are two mmio schemes we have uncached which would mean that every read and write that's issued is independent it's Atomic there's no combining prefetching caching in those scenarios the other scheme that we have available is uh WC all right combined in that scenario we cannot guarantee the order of two sequentially issued MMI operations reach the device in the same order the hardware is free to reorder those and in that scenario if we have a device that is actually uh sensitive to the order that those are issued then we need to ensure that we are locking in the way that I just showed in that driver before and if we're not we also have the ability to exploit race conditions in the issue of those operations",
        "and and you know you may use the second uh one of these schemes if you were doing something like modifying a graphics buffer right it doesn't really matter what operation you or what order you modify all the pixels in a buffer as long as they've all been modified before you send it off to be rastered um so caching memory fences and barriers are important if you're using the right combined scheme is the main point here um I guess this is complicated and where this complexity that you know typically there's potential for bugs",
        "um so so if we move to wrap up some of this you know like programming devices at this level is complicated um you know and and there's a lot of devices out there like we've we've barely scratched the surface by examining a few which exist with on the systems that we've that we've looked at um and you know I suppose the other point is that today like why would you go down to here and exploit this stuff when you know there's much lower hanging fruit out there like the number of bugs that I see in a standard driver I octals which cause region rights and kernel you know it's not really worth spending the effort down here in order to exploit this kind of a primitive when it's much more easy to find an exploitable primitive in a if you will standard ring zero component um and so expending effort on weaponizing bugs in this space is is you know probably uh not going to give you a great return on investment um unless you're able to do something like develop a complicated fuzzing platform which enables to find you to find you know large swathes of these books potentially in classes of device that that are um used a lot because that's the other point like one of these bugs is going to be specific to a hardware device which uses it but the same is not true like I say for hypervisor exploitation if you can find a virtual device implementation which runs on the root partition which uses mmio it gives you a direct means of communicating with that code from a guest",
        "um and you know in in terms of theoretical discussions like what could be more cool than getting Aussie on a host from Simply reading a memory buffer where you don't get any data returned and so I guess like my my final plea I suppose is like you know there's a there's a ton of security researchers here um go look at this tell us if you can find some bugs you know hopefully I've tried to give you some two-length to be able to understand how you can find drivers which use this some patterns which you know based on our experience look exploitable um so you can you know go and start to reverse engineer some of these look for patterns and if you find anything cool please let us know",
        "that's it does anybody have any questions",
        "[Music]",
        "[Music]"
    ],
    "XeSSuWR5PaU": [
        "[Music]",
        "hello everyone this is Jen I'm very glad to be here and share my research partings at black hat Europe 2022 today",
        "really appreciate the P the topic I would like to share today is Bing and breaking security functions of sematic",
        "PCS okay before I begin our like to introduce myself real quick my name is Goen from Shian CH currently at industry",
        "control system security researcher and focus the research mainly focus on PC besid SC industrial equipment and the sister working includes things like",
        "renewability discovering industry field",
        "security testing and evolution for the past few years and reported Ser vulnerabilities to Simmons could V ner",
        "and so on go dozens of three years and of course sex notes for these complaints and we it help showed my research and several companies this include H Gun HB",
        "EMS HB sing ICS cyber security",
        "conference Chanel Ken SDC kingom 2022",
        "and so on if you have any question or ideas regarding the security is batch or Industrial control system please feel free to continue me here is my email I'm looking forward to your",
        "emails please allow me to introduce our lab gole Lab which focus on seis aot and",
        "internet or witness related to security",
        "issues so here is the outline of today's presentation first of all a brief introduction to the SS architecture py",
        "concept stic PC and provs related",
        "research the second part introduced some security design and functions after the releas of TI 17 such as security visard",
        "settings configuration data Interruption communication project in and so on next",
        "we will explain the TRS based as s comp prole including how to as secure",
        "communication what is the particular like how to obtain the NTS package how to create a Rog C to conure the latest ver of s7200 and s715 haer in the four",
        "part the access projection which are used to prevent authoriz access in the forw for our",
        "T6 and a 7 CH head W phone pun phone can be bypassed using POS H method in this part we analysis whether the access control design of TI a with and the latest for Waring can be",
        "bypassed the next part will be the most not part of this topic in this part we will introduce how to conduct for test for as comp Plus Ts Pro step best step",
        "and introduce in process in detail including C making mutation stratching",
        "morning detection building automa foring",
        "tform and so on and least but not least",
        "we will introduce how to protess schematic PS summarize reality issues",
        "and point out possible resarch directions for this subject in the future okay let's get started industry",
        "control system is a Col term used to describe different types of control system used for industry production",
        "including SC syst distribute control",
        "syst and programable logic",
        "containers which are wiely used for the industri sees and critical infrastructure such as power plants water faciliates transportation systems",
        "chemical plants food and agriculture aom",
        "manufacturing and zoo and so",
        "on okay in the P mode we usually most ConEd with the manufacturing Zoo which is the place where all the actions are ConEd and exed being brid between the",
        "physical word and the IT word the manufact manufacturing Z is the C part of the whole P mode and Sh the rram it's up that the C is the coner which is connect with the sensors and actors in this case the coner is the cor of the P mode normally coners include",
        "dcis PC RG and so on",
        "but in our topic today we are talking about PLC in",
        "particular a PLC is a industrial digital",
        "computer that has been reg and the",
        "adoped for the control on manufacturing processes such as assemble lens J",
        "devices or activities that re High relability easy or programming and process for to diagnose the adventure",
        "The numers Avengers but Sim PLC has the larest market sh in the global market Sim PC is used a variety of complex and",
        "Har industri environments and it has",
        "been provided by customers for its",
        "excellent performance that's part of the reason why we start Simmons",
        "PLC okay catic is a PC produced by sens",
        "for industry the latest serious now is S7 which has been the most popular PRC in the marage and US areas of crial",
        "infrastructure the first insures in S7 L",
        "were released in 1994 available product range and show on the right this include the fitb based S7",
        "300 and s74 and the new generation of industria",
        "ins light based the plc including the s72 head SM s72 head and s715 head the",
        "new new coner television p is s72 and7",
        "15 head has an up toate CM architector",
        "the new generation coner adopts the",
        "latest to communication proo S7 plus with integrated check TI 17 which was",
        "released in May 2021 together with the latest War of the for I designed to use a communication Pro with",
        "TS okay a lot efforts have been put on",
        "sematic as s p research in recent years for M researchers and M result come or",
        "this will have Simons improve the PC security and make more reliable",
        "products the previous research based on",
        "a 166 which doesn't have the enhanced security Design By Nature our new targets are new leg with 2.94 S7 15",
        "which comes with enhanced security design the are F research goals one to get a PL in traffic and compare it to the old protocols two to construct a z",
        "CL so that we could conure the PC with Newar forare three to discoverability",
        "of this enhanc sematic PES quickly and",
        "build a foring platform and for how to explain this stic p with h the security",
        "features before we di into this Focus let's have a look what enhan security features SS have mostly the security",
        "projection for configuration date if user enable this option and set a password the date in configuration software will be protected from the F or",
        "taing secondly the enhanced",
        "communication design with this new feature enabled the communication will be based on",
        "TRS secure protect this could prevent",
        "traffic St and sensitive information",
        "leakage thirdly there will be a security",
        "wiard when creating a new project F and it will guide user two enable necessary Security Options last security",
        "communication access protection Le and this true feature will be the M focus in today's talk now let's see how the how trable the secur communication",
        "option to start with we create a new project and only enable the secure communication project option leave the research options just for now see the",
        "project and and load the T PC TR thec and constructing location FS we then use",
        "V to capture the traffic so that we could see the communication between the L and PLC for the traffic we know that there are several steps in this Communications that are fixed first TTV connection will be established follow by the C connection and then the clean signature initialize SSL to ensure the secure communication and then comes the Aged TLS",
        "traffic okay here is a traffic sver we",
        "can see that apart from the erupted T part we have a CP part in the header We Now call this prole as 7 Car Plus",
        "TLS we can't analysis the interrupted TS",
        "traffic so how can we get our hands on the player chest okay there are many ways to do that like hook or theup it with PR King in our research we did it with hook",
        "first we analysised the OM OMP C manage",
        "DOD field and locate the functions before Interruption and after de ruption",
        "and then down the package to get the plan test",
        "we have managed to capture the traffic of St PC into different configurations let's have a look we can see that as 7 Plus Ts uses the virual prot and removes",
        "the integrated part the 33 by part and",
        "the security of communication is fully guaranteed by",
        "TLS now that we are clear about the pl message of S7 comp s foral we are able to make a y cl to control the PC we use the method uring the deine first obtain the test message then",
        "add SSL in",
        "Cas SSL to the pl test message and forly added tvkt and CP parts and send them to PC with care or proxy when the PC responded to message we just reverse the process first the tvt and CP parts are remote and then the",
        "pl response message is obtained by disrupting the SSL message the conent",
        "process is showing the diagram on the right to implant your Cent using passing",
        "you need to go through the process of TCP connection CTP connection and SSL",
        "initial Edition and s stage",
        "interaction okay it's demo T",
        "sorry",
        "okay let's look at this is the repl demo",
        "we use the latest ver of the phw the the phone s",
        "s is way 4.",
        "6.0 and another phw is V 2",
        "9.4 okay now we can say it we can",
        "perform run and stall",
        "to",
        "ASC and see",
        "another",
        "demo we can use Z cl to contr as s 15 H",
        "PC also can per form",
        "stop",
        "wrong okay okay this stem only shows run",
        "and stop operations but more can be performed such as downloading programs regard reading and writing variable values and uploading projects and so on",
        "let's continue to prevent author the modifications auen alterations s design",
        "access contr features",
        "that when a can block mly attacks including rep attacks pive lure attach",
        "re write Val attach however most of the time users don't a it thus introducing",
        "lot show security",
        "risks with",
        "TI and as s CH with 4.4 for version it",
        "can be bypassed even if Will access projection is enabled let's take a look at how to do that for PC the pass R is storage in har form without further Interruption so we can obtain the harsh value of the password using memory jum or disordering Flash CH and then use the pass has method to bypass the access projection lead so now what about TI G with the",
        "latest for r is it possible to bypass it we further investigate the issue and found",
        "that the new variant of the password had been proceeded in the PC using the pbkdf2 Der keing to protect the password H",
        "therefore unfortunately the old method W work anymore during authorization the X",
        "algorithm is used to interrupt the possible host value however this",
        "algorithm is very simple ters can obtain the passord H by sing TLS traffic and disrupting AG so far we have talked about the aast",
        "design and secure communication but how to attack a PC with enh security protection enabl that propose M changes that CH not",
        "been able to use the pro method to bypass access proection and the secure communication is projected by TLS the",
        "previous research method is no longer appliable to the latest Waring of theh schematic PS so we adopt the most",
        "popular method or when discing fing",
        "testing next we will explain in detail",
        "how to perform the fing test for the enhanced security plc",
        "here we will explain step by St the methods of setting out for test environment including station mutation",
        "strategy morning detention and so on and",
        "as comp plus TLS is a complex protocol which CH the 4 modu based on",
        "mutation first of all we can do some takings on the repl a tag script such as",
        "replacing a single batch or mul with special values anything assemble a new message and thatc to say what will happen this is the simplest single SE foring test",
        "mode mutation based f is sers and to",
        "some extent the rich list of sers determines the number of vulnerabilities there are two method to make sers the first one is to perform various operations on the TI with such as",
        "downloading online checking for meting and so on and then capture and see the dest message all this operations to",
        "build the funny F field to make the S richer we also need to RSE engine to AS",
        "Plus",
        "for we need foundation called instruction mtion the go is to mutate the DAT part or S compal after the mutation the D lens part need to be fixed we combine various",
        "mutation strategies M AFL R and some",
        "customers want to build a",
        "mutation draging engine which randomly",
        "select sers from the cors and through the mutation mutation edgy which the",
        "which then randomly select the mutation strategy to carry out the mutation output on the sent",
        "Sabers okay we also need to pay attention to the Target statos during the whole fing process with the Target",
        "ures and FAL statues like protal St",
        "crushing not being able to responded",
        "through the request Arrow LED lights up and so on",
        "well how can we find out this C of ab normal results we can send special S7",
        "plus request to tet PC to check if stack",
        "exceptions or use AER part di module to",
        "acire teal signals from the test Target",
        "PC outo to check program exceptions I",
        "use the third part appalation modu to acire the voltage singles of the PC Arrow led to check PC to see if a if we reach a defective",
        "State okay with the three most important",
        "steps covered we need to set up a platform to perform fing testing as show",
        "in the diagram B we use pass to write the fing TS script the M compos of the script include a 7 TRS overcome",
        "fast enging MTH recording and repal module",
        "SSL processing module so proxy modu",
        "exception detection modu in addition to the S Fu made earlier for writing this par functions",
        "and making them into a fing test platform we can now go test the target PC however there is a problem for",
        "example",
        "when the target PC crashes this fing process will end how can we s it and continue the next R of the",
        "test here we use the power control unit to have Target PC reset to do that the degr shows the automatic fing test platform in addition to the",
        "admit addition to the mutation part the",
        "detection part and the communication part the power control part is also added the fing process of the over fing test platform is show in the blue chart first the plan test message or result elastic protoc is used to make sever fields and then the saers are the M program the mutation engine performs mutation operations and the saers are the target PC this process enable",
        "automated foring testing the test platform is not only suitable for S7 TLs",
        "but also with modifications for other projectors such as UMAS and CES V2 and",
        "V3 this is the for test platform we buil we can clear see that the target PC detach module power control unit power",
        "supply and how to make aor LED light detection",
        "okay it's also a demo",
        "T this demo based on the B buil fing test platform we use the platform to test the latest war of and 15 C the",
        "warant is with",
        "4.6.0",
        "okay is it working",
        "wait a",
        "moment okay when the arrow LED light is",
        "on the message will be recorded and the program will automatically reset PC to start the next run of fing test this greatly improves the efficiency of the whole fing test",
        "you can see the",
        "continue okay let's continue since",
        "August 2021 we have sub zerotic PES when",
        "abilties to Simmons after investigation",
        "reproducing and fixing the vulnerabilities Simons ured a security evision for three of these vulnerabilities on February 8",
        "2022 Sims is do investigating the REM",
        "vulnerabilities and pl to adjust more of them in December 2022 we call this",
        "vulnerability A S Plus crush and it cause serious consequence such asula Al wise pH PES Al you en access",
        "protection D to our three just vulnerabilities have",
        "a wide impact and can be successful exposed if the access protection is",
        "enabled in particular 3 2021 37",
        "24 F wide range op do including for that",
        "only support a s comp with for therefore",
        "we chose to analysis this vity we found out it results from two factors one being the change of be zero in the ch",
        "Port plan part of the package when Bit Zero is one is an exception the second being that the next con is quickly created after the abnormal package is sent this will cause the program to use the initialized memory value and the function address in the process which will cause the PC to crash so how does s fix it we compare the functions before and after the pH and found out that there is an extra if statement to check for abnormal package and collection states which ensure that",
        "the P will not crash even if it receives a normal",
        "package how to protect the customers P",
        "here are some suggestions first following the venters recommendations",
        "upgrading to the latest over a possible",
        "second you users perform the best practice to minimize the risk of exception of this V abilities constract",
        "a de and vertical defending",
        "structure third P addition to",
        "Security Management all operation of",
        "managing Personnel need to be AIT it's worth not it's worth nothing",
        "that there is no real security product",
        "supporting S7 comp plus TLS Pro Che so",
        "customers should pay more attention to the security automatic",
        "PCS okay so let's conclude what we have",
        "talked today first compare to a S Plus",
        "we3 L is let security pro use we2 ver",
        "second attacker can construct groups to",
        "perform repacks targeting a 7 haard and",
        "750 header with the latest Waring and",
        "conductive actions like run St up",
        "uploading projects downloading projects and so on third provide a detailed",
        "introduction of f as seven comp plus TLS Pro including the method of",
        "creating ters mutation strategy morning",
        "detention power management building",
        "automatic foring platform and so on for",
        "the security of the latest project M depend on TLS okay starting from this project",
        "there are many future future work and in research we can do such as more in research about several generation a me to enrich the past coverage second more inde depend research about medition",
        "algorithms that are more effective and intelligent third research un foring methods with the feedback and pass covering features targeting sematic PES",
        "first research on debuging sematic PES",
        "aiming to facility quick Allis of vulnerabilities which can also be combined with efl to achieve security",
        "gestion this allow you to dive deeper into the Cod and find more when your B TR okay that's all for today's presentation thank you for joining the talk if you can question please fre feel",
        "free to continue me here is my email I'm looking forward to hear from you thank you",
        "[Music]",
        "[Music]"
    ],
    "7OjwRylGP8M": [
        "foreign",
        "Europe and the video share some interesting finding about mpu usage in the real rtosis and another first short introduction for",
        "us and my name is Vigil I'm the associate professor at the foreign University and of science and technology technology China under Lu Chi Jiang is my Master's student and this is also a joint work with Dr Juan he is a source is a associate professor at UGA we are all focused on the systems security especially in the iot area and this is her great paid if art cannot be in the London user travel reception and I hope everyone will be safe and I will see you in the panel okay go back to our presentation this is the gender I will first give some basic background about mpu and the easy adoption in the popular embedded OS and",
        "then we will focus on their common pixels and the intention in their MP usage it will also give some mitigation suggestions and these issues and finally",
        "summarize our foundings so what is the mpu I think everyone here will be familiar with mmu it has been ready to use in our modern operating system for memory protections however mmu usually absent in the Metro controllers and so on until I'm a leading chief designer for many mcus has proposed the mpu as a stripped down version of NMU to protect their system the function of mpu is simple then po can send different uh permissions for different memory rooms based on the current private level and if the permission is about it for a Ford Handler will be released and it can only be configured by the previous code",
        "so how to program the mpu typically only",
        "the three register are needed the control register is used to enable the mpu and the address register is to use to configure the starter address and the set of the user memory range and the ADD and attribute size register is used to configure the access permissions including the read write and IQ and IQ symbol for different permissions and memory address and no side the first one range can be further divided into eight subgrids and",
        "it all have the same permissions and also if you're able to background during this unmanned memory space can only be accessed for uh by period levels under",
        "also we can see there are some memory or some cartoons for the Memories for students at least for the three device and the size must be the Power of Two for the line and the most uh and the the most constraint is it must be is the random numbers it's up to the eight for the armor for this I'm serious and in the um V8 Arch the program will become a little bit of Select let's go and the name and the number of the mpu reads will be increased up to 16 and also if you separate and start limited address to define the abstract address uh space for memory range and the interviews will also introduce a new memory attribute inter register to share",
        "some to share Sim memory address with different memory ruins with different access permissions so it seems the mpu should be useful but let's look at how the real world OS use mpu and what the specific Square function can be provided right mpu first we can see the OS always sends the",
        "code range as a non-readable to create code integrity and no accessible for the",
        "data render for the dep also can be used to trade with a stock card with a small inaccessible memory range after the stock binary and the",
        "most importantly the rtos and take advantage of mpu to retrieve the user space and the kernel space operations they will detail this later with the create examples and we first say whether it is to create structures are all adopted in the wild we just reveal the popular rtos uh",
        "digital code and documents but to our surprise as showing the tables only a few OS use mpu especially for the open source even and even if the mpu is supported and only a few security features we can see are enabled by default so in this work we are trying to find why why the mpu has been automated rtos",
        "okay uh I will shut down there the root cause of these situations first we summarize uh the common piece",
        "Force as a first server as four point first I will show how to disable and easily pass the protection provided by the mpu with a real world at your wise and the first sum OS like iot just use a",
        "few NPO filters and if you run the old code under the previous level so it's just to provide some basic protections uh less dep and understand card and the",
        "for the dep the RT just enables the mpu",
        "range number zero to cover the whole Ram range as a no xfo",
        "under Florida stock and for the Star Card the iot defined the permission of the last uh",
        "13 2 banneries of the main start as red only for the kernel and also and also",
        "for the each a task it also a small",
        "accessible memory as a Foundry of the stock to to present the price to present",
        "the task overflow and know that it cannot detive the task or flow of the individual transform and it also cannot detail control",
        "so the problem is here I think uh as",
        "just mentioned before the mpu can config by the previous code so the mpo can be disabled by the control flow hydraction attack",
        "and also the iot also provides the attacker and easy to use driver API for the mpu configurations like here the mpu",
        "disable functions in the iot kernels we found so uh any address if I have uh",
        "just overflow buffer is a it can be",
        "taken one did you buy the attacker and then the fifth time to redirected the execution to this mq disable functions and just to shut down then po",
        "and this is a short demo to to show our attacker process",
        "and to see we just craft a receive Handler functions with with just a",
        "buffer which can be overflowed by the attacker",
        "and soon we start the rtos",
        "and we also can see the this disable",
        "functions and just after the rtos start",
        "we can see we can see",
        "uh at first the mpu is enabled and then we call the receive function to input our Shell Code it will be overflow the buffer to read the factor to the uh mpu disable functions",
        "now after we just input our Shell Code",
        "we can see the mpu mpu able base the last space in the NQ control register is to have been changed now the mpu is has been disabled",
        "okay uh now we go further to say or more completely used in the fragile mpu the",
        "frontier as a mpu use the 5 range 34 as shown in the table and to a tray will not only the dep under and it also has been a traveled kernel and the task as Solutions",
        "and as for the uh CRP and DP is a very simple you just use this memory range for the no red ball and no access code",
        "and to to retrieve that",
        "and for the task memory and solution and the kernel memory Solutions interview as soon uh the current the kernel code and data range can only access the private code",
        "it's the kernel and the task it can only access its own cost stock only and she cannot to access other Transit stock and also the OS kernels",
        "so uh if what will happen if a task wants to use the kernel API it must use the system call and for the foreign",
        "it does not provide the kernel API for the system call uh individually but just wipes the original kernel with the previous switch functions with SVC handlers so for example it's an unpreviewed task wants to use the kernel function let's hear the mpo task delay",
        "either will forced to call the oh the system call and since we call will will force to reach the provision and then call the kernel and the kernel will go back to the system core and reset the private and then go back to the task",
        "so there we can see a easy bug in the unpreviewed task it can risk is privilege but just called the internal function like the the by functions for the receive private functions under it",
        "also can be easily passed and the foreign the original function as a",
        "as a macro and so it cannot to directly",
        "call functions but it is really uh",
        "so but the problem is really solved let's go deeper with these problems and we can see the particle is at here",
        "oh sorry record the task delay functions awful Force to write the uh is a privilege or not and there is a employee record interview release is privileged as a previous as a privilege code and then to go to the kernel functions and the problem is here the the value used to store the original preview level is on the stock so if the data overflow or the attacker can populate the value on the stock it can just change this property levels",
        "so we need to go back to system core it will judge again in the previous level or not and this will be filled so if the previous will not go down we will not drop the privilege so it will just return for the original task and now the task has been a previewed class uh so let's go further to this detailed explosion steps with a simple uh buffer overflow and we can see this is the buffer and it can be overloaded",
        "and we forced to overflow to just the return address and so to make the",
        "program to jump to the internal SVC",
        "interrupt to list the privilege",
        "and the next it will go to the kernel function and we further to overflow the privilege levels as on the start so winter is finished the kernel",
        "functions",
        "here it will to judgmented the original preview level and from the stock values and and the flag under stock value here has been changed with a predictable level so it will directly to return these functions and will not to reset the privilege",
        "uh we also uh recorded a short demos we",
        "can share this is the unprivated task",
        "and the interview through",
        "okay uh and we just start",
        "and there is a view called the receive functions which have a visual buffer which can be overflowed by the URL interviewed and now",
        "we can see at the first the current stock is unpredictable",
        "no we just input our Shell Code to overflow the return address and also the previous also the previous level value",
        "now we can see we go into the the system call as the SVC handle",
        "oh sorry",
        "no we can first say after the interrupted the privilege have been raised",
        "now go further here it will force us to to restore the pretty level from the start but start now has been overflowed by us as a previewed level so it will just to return",
        "it will not reset the privilege",
        "and we just to to see the private level right here and now we can see the current Castle is free",
        "and the demo is finished and we also can't it can output from the uart",
        "under this and this file is also a further attached by the character of radios it adjusts to",
        "uh to let the previous privilege level Judgment at the beginning of the uh with the control register uh in the system call however we found the other problem can still works uh he said also we cannot just to modulate the survival on staff to modulate the private levels but we fund so for articles can't read the tasks with this Chrono functions named",
        "the task tweet and these functions also has been wrapped by many suitable costs for example as a pre as an mpo faster grade npu task uh greater static and and",
        "this problem is since the unprivileged",
        "task can also cause this free task",
        "functions with mpu wrapper and this",
        "tasks have a parameter and to indicate that the task is the privilege or employee so the unprivated Tasker can call this system call to directly to create a previous task",
        "as we can see survive the system core here this parameter to indicate the weather is a privilege task or I'm pretty task will be great",
        "uh this is on call will call the kernel and to create a a private task",
        "so it can the previous Target itself so it's got we can also trade to the previous solution",
        "uh we also detail the explosion stamp here with the simple buffer overflow and the folder will just to overflow our return",
        "address to these web functions",
        "here and the folder we can just to overflow uh any parameter of the new Creator task",
        "and we can all we can also to rewrite the task a but this uh",
        "and live here like with the high provision level which indicated status",
        "parameters",
        "on the stock",
        "yeah we can see when I go here a new stack with the Free level will be created",
        "we also record a short demo so this to this through this problem",
        "we can hear when it starts with unpreviewed task and it is unpreviewed right now",
        "and we just uh to call a functions we this has a over also a buffer a buffer can be overflowed",
        "no uh we just input our cell code to overflow the buffer",
        "so",
        "uh the custom grid functions here",
        "and now further interview to to site so",
        "this new tasks per minute from the stock which has been overflowed and modulated by us",
        "now here we create a new task with a preview level",
        "with just the same trust code",
        "so when we go back to the to this task we can see this task is has been the has been the previewed right now and there is just the same test code but just a new test we just created before it's a preview task",
        "now we will also to discuss some other pitfalls of the mpu and we further to fund if the implementation of the mpo has no vulnerabilities but the protection provided by mpu is also very limited for example it cannot protect the interrupt handlers since all the interrupter Vector address tables cannot buy",
        "trackified mpu and the interval of the handlers is also always be in the under the privilege levels so uh the developer",
        "cannot assess the specific interrupt for the unpreviewed talks and also due to the constraints of mpo is not very suitable for protecting the peripheral for the Visa small room and also the advanced protections as no",
        "exclusion only or it is not cannot fly",
        "provide by the mpu and the previous permissions is also always for greater",
        "than the amplitude information so it cannot protect you some various Steel security applications when the OS has been compromised and also to give the mpu to realize in Solutions is also very uh will also",
        "improve many over High for example in our instrument our experimental Flow side for the kernel as",
        "Castle as Solutions the previous switch will uh include the many time delays and",
        "also the amplits also need to be reconfigured reconfiged during the different tasks so it will also to encourage the time delay",
        "and also to limited mpu rates for the real world applications also construence its usage um we found there are very few that used to define the advantages for the for for the peripheral Solutions and uh as I've shown the table before node OS provides a peripheral resolution by default and a very few also available range for the for the memory share between two tasks and then we also found no OS provides a shared memory protections about it before by default and the user also is impossible to enable many functions at",
        "the same time as we can see",
        "range for the Developers",
        "and also porting the mpu with a real rcos you also to encourage many companies issues they have seen many complaints on the developer phone",
        "and lastly we will give some some mitigation suggestions to better use than Po and to minimum this uh fat Force",
        "also we can we need to be careful about the pervader overlap we can see the most ois just use a lower number of the increases for the kernel protections but the armor allows MP already to overview and the higher numbered arguments always",
        "have the high priority",
        "so we just recommend the OS should use a higher number mq ratio for for the OS protections under just let the user Define the I'm curious as the lower numbers",
        "second as I just mentioned before any",
        "privilege solution interest to be careful especially for the system recall ideally we just recommend the OS to use the individual system call for the kernel apis to force the Privateer switch adjusted like the modern OS and",
        "if not you need to Performance additional tracks for the caller to make sure that the provider will be dropped after system will fall and also and also the previous separations is also needed for the general protection also some ois just want to provide some general protections with all the user space and the kernel space Provisions uh but we recommend the systems to drop the provision immediately after NPR configurations",
        "and we also give some advice from me to minimum the amp range usage because the number of the wind is very limited for example we found no of os particular advantage of the sub rules and supplements can have a lot of uh for us first I will assume there are two tasks the task a uh just about to use the three KB for the for their stock and the task B will use the only 5 KB from Star but but as we just mentioned before due",
        "to the alarm problems uh we have to assign 8 KB for the task B and 4 KB for task a the total 5 KB memory will be used",
        "features there are only one kbn memory",
        "base that we needed and we can switch them and during the if",
        "we run it has copy we can just enable the higher a higher submarines and disable the the lower sub range forecast a and if we run into the task a we can just enable the task a for the lower server range and just disabled higher",
        "and submarine",
        "so to figure one teacher of the sub ruins we can also to save many mpu ranges when you want to retrieve the pro uh peripheral protections uh we assume",
        "that there are 844 if we only want to a size uh the 443 a as a privilege level",
        "and other is unpredictable level if you miss all the sub Ranger features they have to ascend at least the three a separated mpu ranges but the info will just enabled separate functions there are only one mpu ranges is needed they can adjust the disable uh the three private access and",
        "they will go to with the background range which does the privilege access thus satisfied our usage and the others",
        "will just go with unprivated access",
        "so as last uh to protecting the user defines results we can also learn from the academic Atomic communities",
        "for example some research propose to use",
        "those task with the memory will switch with just reduce the overhead incredible",
        "by the previous switch",
        "and against the data can run the task and kernel also or under the unpredictable levels and also as a research transfer in slow the con some small functions and based on the code of functionalities and it will also do not use true to many MP usage",
        "and also uh the redesign IPO will be",
        "better uh kind of address this this problem fundamentally uh battery is a will cause a hardware uh and also we can use a trans Zoom it will provide the functional extensions you can also use the square Ridge uh for the additional range to ascend more uh mpu uh range in the previous levels and",
        "in the screen on the normal world and also some new uh Hardware architectures that translate provide a new mpu which are not which are not only but it is a data access but additionally consider the current active execution point I subject to perform the access",
        "and we just summarize our presentations we found mpu as a ready to use the security features but it's rarely using the real world product and we just starts to fund their Community force and",
        "some Force we found is harder to",
        "rhythmic in the short term which has to give some recommendations for better use of the mpu at last",
        "uh we also closed our funding with the NPO kernel as their developer team and the rtos developer team also has now our foundings but he thinks the benefit of disabled access to mpu is a limited detail because it is a only provides",
        "such in the protections and know the user space and the kernel space conditions has been adopted and this is all my presentations and we",
        "are also ready to help you to take any questions",
        "[Music]",
        "[Music]"
    ],
    "jqLjAP16g8I": [
        "foreign",
        "sub presentation and Main presentator",
        "xinjiang",
        "I'm a security engineer and the founder of the ascent box we have prepared for this talk as much as we can but if you require something more specific it's going to take some time but we will respond as quickly as possible please contact us",
        "well I will begin the talk",
        "most of our our work involves evaluating for embedity system security and finding",
        "vulnerabilities recently I have been",
        "interested in testing to validate",
        "vendors claims",
        "and they claims the product the liberal secret value but is but it is difficult or impossible to prove that value",
        "and also when the share of Reason II no reliable information about product",
        "in this aspect I think it we would be worthwhile to analyze proprietary RF",
        "protocols because our world still have",
        "not heavily explored in secret pill",
        "does as part",
        "of its project we will talk about your own RFC link security we put the main talk let me just explain what's going on the Drone RC Market",
        "in this previous version there are many count pages were on the market as far as we know since it's released in 2019 the access protocols has been analyzed",
        "yet and no clones have been made because the",
        "vendor has been effort to prevent counterpainting",
        "the safety on up open up and proprietary",
        "RF protocols May mean",
        "the same as whether open source is secure or closed source is shaped",
        "the propriety are a protocol not heavily",
        "explored so many for implementation exist in this talk we will analyze your own omnic protocol based on the frequency hoping techniques",
        "the fhss technology is considered a",
        "secret benefit and kind of security mask to the public",
        "for many vendors focus on early performance rather than hoping for security I wish security engineer would reconsider adapt security",
        "and we urge bender and stack hold to consider security",
        "we will discuss this security risk in RC",
        "FHS implementation which are affected and",
        "showed the result of practical drone",
        "Isaac attack and provide your rebelling insight into the Drone omnic communication analysis",
        "by in-depth analyzing the newest",
        "protocol it will provide analytic skill to check the security",
        "aspect another commercial RF protocol",
        "to this end we also discuss technique for mitigation from the vendors and open source bearable point of view this study might provide some",
        "inspiration for the skewer property and",
        "protocol work that can satisfy security",
        "and other performance",
        "the order of explanation we explain the",
        "technical background and the internal structure of the analysis Target next we will look at the analysis technique of the collected alip signal and package structure",
        "based on analyzed content we explain the cloning and hijacking method",
        "the main speaker xinjiang will explain",
        "the details of this",
        "I I then I will continue to talk first I will give a leader back background and then I will take about details of techniques and I also have prepared three demo videos which is about sniffing and cloning and hijacking I hope you will enjoy it historically FHS was in fact designed as",
        "security protocol during World War II patented by movie actress Eddie rammer as the secret communication system that could guide Torpedoes to their target without being intercepted by the enemy the main idea is to send radio signals over multiple frequency and random",
        "pattern",
        "or though FHS is an orbital technology",
        "today it is still useful as an interference avoidance",
        "generally a Hopping sequence consists of a set of operable channels arranged in through the random order therefore since it is difficult to intercept or signal something the FHS",
        "provides added security besides it has many good characteristics on today among them being strengths are as far as the interference and co-existence and high power and multiface fading",
        "I would like to talk about FHS from a secret perspective first do not rely on FHS for eavesdropping protection because",
        "they can still receive some packets and Second Use complicated frequency hopping pattern and third use wrong frequency opening sequence and force set or sequence pattern across all model differently and last use more channels",
        "it is highly registered to deliberate jamming unleash the adversary has knowledge of frequency hoping pattern",
        "as mentioned earlier one of advantages of FHS is registered interference the",
        "person adversary is interfering with two channels in this figure if we lose a packet for the position value corresponding to fs7 and F and F4 it",
        "will not affect the overall traveling of the Drone just on your leader effect on its movement eventually it is important to have as as much Channel projection as possible in the whole operating times",
        "so what if he cannot use 100 channels there need to be some kind of mechanism to bring the channel back into use at some point if there is no mechanism the transmitter may not be able to match the receiver sequence forever therefore FHS want to redraw the",
        "sequence mismatched by synchronization technique there are many ways to implement it I will show you two simple ways the case one is just staying in listening mode on current Channel the case too is a way to give a wrong change interpret time than usual",
        "so in case one a whole sequence is lost but case two onions rightly smaller number of sequence or roast to maintain quality this list synchronization time must be kept minimum eventually if they have a more longer sequence the mechanism should be elaborated and complicated",
        "the next is tear down and anti-liversity Engineering is to slow down the process of reverse engineering and tear down is essentially a way to find out how it works in this chapter we are going to tear down in our Target devices to reveal the internal circuit and Isis that Implement core functionalities of products and also examine the way of Bender against reverse engineering",
        "the figure shows the inside of transmitter consisting of two boards with main CPU and RF SOC the main CPU is",
        "only able involved to make payrolls by user action the key chip is in here RF SOC so and they have unique identification battery which is called as a txid",
        "this figure shows the old protocol xcc as the receiver I could see the details of the chip model even by looking it at it with the naked eye and there is interconnection wire between the main CPU and RF chip on PCB so it it makes it easy to obtain RF parameter and other critical information such as hoping sequence through tapping",
        "now this time let's see the latest protocol access receiver the vendor",
        "seemed to know the issue caused by intercarnation wire Exposed on PCB so",
        "they have shifted from separate design to an SOC and just like transmitter chip identification has been removed by laser therefore wiretapping is not possible like the previous version axis test receiver so the only way left in device is finding very important is Transformer",
        "so hiding make hiding marking is commonly used as a security throw of security technique in attempt to make a device reverse engineering more difficult but it isn't just minor hindrance to reverse engineer if there is software chain links and so we can find out this shape STI",
        "cc2652r and their debugging port",
        "we tried connect is sharing the hardware debugger but we could find that they have harder security deposit mechanism debug Rock and erase the world debug Rock and erase literary means if adversely try to access debug report the internal fresh memory forced erase by internal circuit so it is Major hindrance to Rivers engineer although there are some ways to bypass such as glitch to internal logic in January it embedded reverse engineer decide to let go remove on eventually it seems or action has been taken to protest reverse engineering but we have one left attack surface which can be accessed on anyone it is a radio frequency",
        "there are some options to analyze RF the cheapest option is SDR and I think there are two options to make RF package snipper one of the ways to think packages using transceiver IC supports 2.4 gigahertz",
        "this way is easy and or I have to care about these testing parameters but our Auto required to check the target frequency in right Str is the best choice for making our drone stiffer and also the one of the advantage of such of this what we can design to increase agility and flexibility",
        "for now I'll review a signal with an RFS carrier frequency of 2.4 gigahertz we",
        "found that the signal consists of 47 control channels and one binding channel in Fr Sky The Binding channel is used for pairing with transmitter receiver and as you can see in the figure it is use raw power it is intent that pairing is only possible at close range",
        "if we take a root crossword",
        "changed from one way to to the two-way",
        "and also access and only 20 package for pairing it is spirit that they worry about deliberate signal by other people's inviting time such like Bluetooth repairing",
        "and if we test check control channels FHS is a method of transmitting radio signals by rapidly changing or Carrier among many frequent channels as in this figure you can see signals by rapidly changing the 47 frequencies when",
        "magnified one of channels it is easily known that the moderation is pfsk the BF SK singular deviates from the center frequency depending on the minor message thus in FSK of binary 1 represent one frequency and binary zero represents",
        "another frequency our snipper aims to demodulate this signal correctly",
        "the figure shows our simple genu radio bra diagram for the moderating upper Sky signal so I will explain shortly about the design we left all the details parameters such as filter design in this block diagram once we have decided to create Source device to choose we now want to focus in on the signal of interest and filter out any other signals present in baseband we have recorded we have determined RX bandwidth is about 232 kilohertz so we",
        "put this as the cutoff frequency although we use the usrp in this block diagram but it does not matter if you use a chip model like hagrance and then we have to demodulate the signal as you know there are many ways to moderate the moderate bfsk but",
        "commonly used method in general implementation is the quadrature de moderation so we already know one is represented by the app frequency Center frequency plus deviation and zero is represented by Center frequency minus division in IQ signal",
        "a positive phase change corresponds the positive frequency and negative phase negative phase change the correspond negative frequency so that if we set the correct deviation it monitor the change in phase and output the demodulator signal",
        "if we examine successful of the demodulated wave in review the package starts on the left with the Preamble immediately followed by Sync word and we can see the packet length and bear dioxide payrolls before the",
        "symbol to beat we need to check what digital encoding is applied it is energy coding so we don't consider additional digital decoder",
        "now that's we have come this far we should check the symbol timing this figure shows the demonstrated digital wave for both X access and accft to get this baud rate we just can minimum symbol length Preamble signal let me",
        "know the minimum generally so we can get we can calculate the baud rate the point to notice in this axis has a 60 percent higher baud rate to compare to accst",
        "now we can extract a symbol at the correct time I use the craft recovery mm which is to recover sample from a signal in the block the parameter Omega is estimate estimate of number of sample per symbol so we have already got a battery of Xs and accst 124 kilo K and 77k is expected before if",
        "we just put 64 and 103 according to",
        "protocols",
        "and for practical experiment I will shall be snipping transmitter with two different distances",
        "if there are someone is using drone to peep I think it will be there on the rooftop so I just put it there let's see the video",
        "first transmitter because it is far from the my sniffer you can see the weak signal and there is even noise",
        "if we and you feel lazy if it adjusts K2 sorry you can see the better signal than before",
        "and if you raise it a little bit noise is also Amplified as well",
        "but we can distinguish to control channels of 47.",
        "and I select and set the frequency we can get the packet",
        "so you can see the package captured you can see the pack capture the packet",
        "you can see sync world and txid",
        "and current Channel info I will talk with later and payroll than CRC",
        "for transmitter B it is close to Destiny first so you can see more power per signal",
        "and we select and set the frequency Above This",
        "we just said and and you we can also get the the packet but the transfer B has other TX ID so you can see the",
        "different exide with transmitter a",
        "so we can capture the transmitter package in layer time this time we should inspect the packet field since interesting point related to the FHS has been identified in the packet so we analyze Focus focusing on hopping sequences and pattern information on the packet this diagram shows the x68 St timing diagram of spi so we can see the receivership the channel frequency every about 8 milliseconds it is about",
        "20 120 holes per second based on the IU",
        "interrupt signal it takes off approximately 1.4 milliseconds for the",
        "next packet to arrive immediately after frequency calibration",
        "so the therefore packet are reached somewhere at this point by the transmitter so the hijacking signal from the adversary should be reached with within about 1.4 milliseconds after the channel",
        "has been changed so I suppose that adversary signal have a fair chance to be acceptable their packet within the time if we related to more zoom in on the signal we can check the changing hopping frequency by observing Hardware register and if we list this value we can see the total hoping sequence has always 47 hop period but the sequence we get from the tapping is just a mutated sequence added by hop distance so there are two options to get base sequence first first is to turn off transmitter and enter in listening mode second is send package with hop distance to top distance to one I will talk it later a carrier frequency is determined by channel number and channel spacing that can be configured on the RF chip and our spacing has been confirmed to be about 300 kilohertz by our prior analysis in this device the maximum",
        "frequency range that apple sky Motors can have is from such like this an equation as far as we know Channel spacing and base frequency so we are able to calculate the channel number if we just find their Center frequency of the each Channel eventually this channel number will be sent frequency synthesizer according to the hopping sequence",
        "the base sequence table can be obtained through tapping but the table is constructed contained containing a permutation of frequency Channel numbers",
        "generated by device ID and the generic carriers of the two Protocols are identical fundamentally the hopping sequence must be ensure role encouraged by themselves as well as between transmitters so this device seems to just want to avoid sequence of wrapping in short time for create communication therefore base sequence is generated with linear and it enters the Channel's Road only once in the whole sequence cycle and their first cycle of Base sequence and number of channels are identical with 47.",
        "moreover we were able to get important important information about hopping in packet is a space sequence number and hope distance value are exposed in packet two packet field two in fact period 3 as mentioned earlier to their full cycle of a base sequence and number of frequent channel is identical with 47 so this packet field tell us which base hopping sequence numbers and hoping distance they are using in old version it was exposed to row number but in excess new protocol version they seems like add bit masking trick",
        "if we look at the correlation between the second field and base sequence we can get their face sequence table this figure shows the mapping between the sequence and frequency for two transmitters the information exposed in",
        "the second field identically match their base sequence number of fhss",
        "thus when an adversary correct or the second field of 47 packet the entire base sequence could be completely listed in other words if an attacker can",
        "calculate a channel value only with the extent of frequency so they can obtain base sequence by each the second period field of 47 packets",
        "and sorter field is Hope distance it means how much distance will be added to",
        "the base sequence index thus there can",
        "be different hopping sequence by different hope distance but the FR sky",
        "or the button photographics hop distance to 7. I think",
        "they trying to make the originally intended rf4 signals characteristics but",
        "I don't know exactly why they are then let's check out what the Hop distance of access protocol",
        "this figure is frequential frequency hopping of excess protocol in slow motion as you can see we can see very regular pattern of their Channel shifting although the accft protocol was",
        "able to identify it as seven through tapping but we don't know hopping distance of access yet so to identifying hope distance we focus",
        "on first hopping as soon as when I power on the transmitter so we can see that three pigs are shown on this animation",
        "as you can see they are hoping with the gaps as a nine basis on frequency channels but if we project them to base hopping sequence table",
        "they also have seven hop distance on basis of Base sequence",
        "to sum up first case final sequence is created by",
        "adding hope distance to the index of Base hopping sequence table and then it feeds to frequency indicator the result so far show that it does not have any random factors in its mechanism it is just a sequential hopping the",
        "barrier of distance may be used to select a pattern but this hope distance seven are all the same and fixed on the fs High transmitter",
        "so let's look at the hopping pattern by transmitters in time domain it is shown in this figure you can see look like the same pattern in two different transmitters in my opinion they consider more effective the robust communication or multiple transmitter",
        "and I also noticed that the RX role change of Hope Distance by TX packet when the sequence is mismatched between RX and TX the RX is entered into electricity mode which has a long interval time of sequence change than usual the important point is the receiver can be re-synchronized by arbitrary hopping distance barrier of the packet field so it means the next hoping channel is determined prior package and also adversary can add to hoping pattern",
        "we could now Forge a packet and control the Drone in whatever way we want finally we now have enough information to make Chrome transmitter using the information obtained obtained from analysis such as our parameter and packet so we just download and our formula to DIY I promoter so I will show a demo video FR Sky access cloning transmitter for better understand rcfhss I have two versions one is wrong hoping sequence transmitter and correct sequence to run transmitter let me show you a bit demo video first txtv.ncorrect sequence so you can see it does something like lag when I control the the destroy stick",
        "so it's like this",
        "you can see the Rook right correct in incorrect sequence",
        "and after",
        "foreign",
        "with the correct hopping sequence",
        "so you so",
        "so you can see the hopping correctly and the receiver is permanently on",
        "and",
        "when I control the stick you can see those the most movement it is working well",
        "and we just added some trick for if effective hijacking unleash the transmission interval between the two transmitter system is exactly the same collisions will occur at some some point we hope to disable the original transmission Channel more effectively so",
        "that we set hope distance to 1 when I send the packet so that it might be more faster than victim transmitter except",
        "reverse case and also it is also effective in Breaking the original hopping pattern so that reducing the collision with authentic transmitter I",
        "think smart attacker has to make additional complex strategies to make low collisions with authentic TX in",
        "order to perfect hijacking but our",
        "simple braking pattern strategy also showed good lizard in hijacking",
        "as you know the use of directional antenna and amplifier oral to increase the level of sweeping signal when measured by a list for which I made receive the strength for us authentic signal is about minus 80 dbm my attack",
        "signal is to look better than authentic in same distance with the transmitter so we can check that this is enough to overpower the rear signal within and without a radius of 50 meters if they just miss one packet they are synchronizing will face it will be changed to me and my tongue so you can just so you can just to stamping it and then kidnap it first",
        "we should find the lowest frequency of 47 channels it is always in range from to",
        "2.404 gigahertz to 240",
        "2.408 gigahertz",
        "set the frequency to our snipper and after that we only get the three field txid and sequence number and list of our",
        "ID then set these three parameter to form error then put it to RF module it will take a Hopping sequence and breaking it you can control the Drone in where you'd want to go lastly I will show a demo video don't take over attack while it is flying",
        "for accept the reason I perform in Hardware in the loop simulation the test environment was done in my office it is good it is not good condition to hijack because the distance between Chrome trans Chrome transmitter and authentic transmitter is to cross but there are there are meaningful leaders despite this handicap you can see the Chrome",
        "transmitter in here and authentic transmit is in here",
        "so",
        "let's see the video so you can see the correct with authentic TS I'm in this time you and when arming the Drone or something in authentic transmitter",
        "you you can see this is being operated by authentic TX",
        "and I'm learning to other room for turning on adversary TX",
        "if we turning on the adverse or TX so you can see us you you please look at here for a while and now we connect with adversary the tone red LED to turn the green",
        "so you can you can see drone is being controlled by other circum transmitter",
        "the the important thing is our",
        "occurrence of hopping sequence collision with authentic TX they try to connect again",
        "so the the red red area is is turned on the direction but the racing chronic with the red adversary so return on to",
        "green LED so adversary is winning back of the race and continue to attack",
        "so in this section I will summarize our attack and examine practical fix tips so talk about with point in our foresight first number of Channel and sequence of the ranks are same and the hopping sequence information is exposed on packet and so these two points adversar is easy",
        "to restore the sequence in the in only the band scanning and hoping pattern could be broken by adversary so it could effectively hijack King by low Collision",
        "in Flight control abuse such as Pig's Hawk it does not reconsider a phase step scenario in which RC is fully controlled by adversary",
        "generally the standard standard RF",
        "approach towards the most common way to implementing for FHS is throw to random",
        "sequence that using 20 shift register so they have a long sequence such as M SQL sorry such as M sequence kasami and gold",
        "the longest strength better at least the length of sequence must be longer than the number of channels but in many cases of a small device proprietary area for pro course does not seem to consider from a security perspective their purpose may have been focused on radio's interference and latency in chaos ISM band and increased receiving rate because improving response time in omnic make more competitive in Market",
        "view in the packet I think it must not expose hopping sequence relative data in packet in our work if adversary can correct 47 channels packet the entire sequence could be completely restored so",
        "that this data should be kept secure enough unless the protocol used to pseudo-random sequence and in many",
        "property RF devices txid is open often",
        "involved with a critical function such as the device identification so it is also necessary to consider about this finally I believe that they have sufficient Hardware resources such as capacity and crypto accelerators",
        "basically RC has highest priority than",
        "others such as modeling commands if entering up for the mode BF mapping message RC able to out of off-road mode using RC toggle switch Auto autonomous",
        "phases method can themselves be fraud",
        "when they are very specific right loot",
        "such flying through buildings so they seem to prefer to take over with own RC to hopefully be able to take manual control of the Drone before it smashes therefore I believe that they are not considering scenario in which RC is not fully controlled by the adversary",
        "conclusion",
        "resonance the last thing I'd like to say is this don't trust fhss the point is",
        "hoping sequence generation in many RC prng is not adopted in Express spectrum and it is surprisingly unsecure from alpha attacker so we have not covered in this talk not just specific vendors such as FR Sky most of these RC systems are made like this it seems necessary to study on FHS as implementation considering both security",
        "and performance",
        "you the project we are working on we have completed the smart door project as another topic of the article analysis I decide to call it smart lock picking attack now I look at about 20 vendors of smart Dora products although they have AES",
        "encryption algorithm I have identified",
        "almost the same crypto implementation defects in Vendor product so I can",
        "unlock the any door using my device now we're preparing for a presentation I hope to meet in coming the event thank you",
        "thank you [Music]",
        "foreign",
        "[Music]"
    ],
    "wSTI3vFFDTM": [
        "foreign",
        "a PhD student from Institute of information engineering Chinese Academy of Sciences my current research interests include Cloud security and iot security",
        "of today we bring you a presentation titled iot manufacturers not new net",
        "smart design blogs and deployment kills in cloud based out the consent control policies this is John worth by six",
        "authors including Iran me and yenza",
        "and Luigi and I will be presenting",
        "and this one he also also published on CSX 2022 and the name of the paper is pre-verify and Sandy and the mitigating security effects in cloud-based Health Science policies uh eBay will bring the",
        "first part",
        "first of all we'll get started with the background knowledge the internet of sync cloud is one of the key pillars of the foundation upon which a modern iot system rest new iot devices and the manufacturers take advantage of the much less starting third-party platform as far as also named paas infrastructure access advice",
        "also named iaas iot cloud service such",
        "as AWS iot core other iot Hub and Twitter out Cloud which offload much of the security responsibilities and deployment burden to the public Cloud providers such iot clouds just attract marriage hundreds of many millions of iot devices and and a profile device manufacturers is reliable and usable tools for secure iot developments",
        "in general the convenience of accessing resources in the cloud is made secure by developers with specific Access Control",
        "policies a cloud-based access policy is",
        "an expressive specification of what resources can be accessed using what actions by whom and underwater conditions Cloud providers such as AWS and other generally Define a policy language that lets developers govern access to resources in the cloud a cloud-based iot access policy taking AWS iot as an example inherits the syntax of the suffice agnostic AWS IEM policies and its extension of IEM policy in the iot context",
        "an iot policy species files which uses or clients can access which iot devices or resources on the word constraints and a specified action or resources types in the iot context such as publishing a mqtt message",
        "to better understand the iot context of the modern iot Cloud we now introduce the MKT protocol here mqtt is the short name of message killing Telemetry transport protocol",
        "mqtt is arguably the most popular messaging protocol in the cloud-based iot communication mqd leverages a classical published",
        "subscribe pattern the client published",
        "messages to enable the topic hosted by the server which then relates the message to other clients that subscribe to the topic the topic is named similarly to fire paths with multiple levels separated by slash such as slash device ID slash",
        "status the above figure shows an empty topic the green ones are the content of top levels and the red flashes as topic level separators and classic usage is to use different levels of the topic to delimit the scope for example home rule or device",
        "let's see the figure first of all the client connects with the Cloud Server and iot device subscribes to its unique topic by sending a subscribe message to the server the server maintains the subscription status the user's app can command the device by population messages to the topic that the device describes to also the device can publish messages to the topic that the user app subscribes to",
        "once the service subscribers are published channel is established the mqd broker or specify specifically say the application topic is working as a communication Channel and users and devices can exchange messages through this channel lightweightly",
        "clients can use mktd wildcard Plus or",
        "hash to subscribe to multiple topics",
        "plus is a single level card that represents one topic level and must be placed along as one level and hash is a multiple level World card and it must be placed as the last character also as the last level",
        "now we've introduced the basic Computing blocks of cloud-based iot context we note that the mqtt approach to upload communication is lightweight but more complex than the traditional request response model of communication then this communication model with the cloud-based iot count Access Control can",
        "bring developers huge error spaces let's take a look at the flows we found to understand the Aerospace and security challenges in cloud-based iot development we studied the practices of",
        "36 mainstream iot devices manufacturers",
        "and 310 GitHub projects note that the",
        "Aerospace means the design of AWS iot core provides spaces for vendors to make Big Sticks node AWS iot core itself leads to the error of laws",
        "the first airspace we want to share is a design Aerospace semantic Gap in iot Access policies let's take hippocore as an example and it is a Japanese well-known online consultation platform in its design and",
        "user requirement only needs to know the communication Channel with the doctor to communicate with each other using the mkd protocol supported by AWS iot for",
        "example users can subscribe to its XMD slash session slash session ID to receive the message sent from the doctor and publish it to their own XMD slash",
        "session slash session ID to send a message with this design the application topic works as a secret Channel however as we mentioned employee supports one card",
        "One World card can be used the session ID in the mqd topic loses its frequency kibakura is also aware of this problem and they have rejected the xmb slash session slash hash in the iot policy however as the wildcard hash can match multiple levels another topic such as",
        "XMD slash hash can also access the resource XMD slash session slash session ID so an unauthenticated attacker can",
        "monitor all the messages on cable cross AWS iot",
        "another Fender that made these mistakes is scoring similar to Heaven Coral",
        "coffee uses LWT slash as a notification",
        "channel for devices disconnections",
        "and they taking advantages of another feature of the mqtt protocol which is called the last real message coffee has even stricter restrictions on Wild Card than hypocror which according to our backwards speculation restricts",
        "stop loss and star hash however it does not restrict topics such as last slash so we can subscribe to LWT slash with",
        "plus slash",
        "now let's see this demo video",
        "the attacker can subscribe to the topic XMD slash session slash hash",
        "to see the messages because of the hypocris policy",
        "but he can use the topic XMD slash has to bypass the restrictions so he can monitor others message",
        "and he can also subscribe to specific private topics",
        "uh yeah that's what I understand the airspace it has introduced the overall architecture of the cloud-based iot platform focusing here on AWS Cognito",
        "and AWS IM that I'm saying is the uh stabilizer permission Arrangement service that allows clear denomination and permissions between services",
        "goals and users Mr I have and policy AWS",
        "coordinito is a user and identity management Service uh in iot context developers or vendors can live with the service to add user management to their iot service let's see this figure this is a typical structure of iot apps based on AWS LT and AWS Services users login and obtaining identity from AWS Cognito servers on the devices direct interact with awt they are still device certificates users can control monetary",
        "devices under a search control from AWS IM and AWS LT but when we type deeper into understanding and understanding the principles of this architecture he found confusingly contacts in-text interaction",
        "principles let's see the second design ever space affordable cooperation between IM policy and LT policy",
        "uh I designed by AWS the identity pool created by the manufacturer is associated with one or more IM pulses the user or clients presenting the credential authenticate uh can make data",
        "requests to any AWS service such as awslt S3 and the dynamootp that's",
        "allowed by the IM policy on receiving the requests the target the target AWS service requires Cognito based on the credential authenticated to",
        "obtain the user's Cognito identity and the associated item policy and based on the service specific statement in the IM policy enforces the policy by determining whether the particular action in the request is a lot and I like common AWS service use IM",
        "policy to authorize the API request it",
        "comes out additionally but it requires an iot policy with the clients take LT",
        "published as an example one can publish to a specific topic if and only if the iron policy and the SLT policy both gave",
        "him the permission uh however we found that Cognito also",
        "supposedly authentication method that does not require logging our client can obtain the identity directly as a guest similarly Uno School bind one or more",
        "and policies but unlike the previous case the client gets iOS credential can go directly to interact with AWS iot without spanning and iot policy so the authority of the ion squared is rather greater and is huge uh maybe huge but because it will track the permission of the whole proof the consequences of the attack may include controlling or monitoring other vendors devices",
        "in summary we notice that we'll also this design is reasonable the LT policy but I also must be permissive by the Outsource must be permissive to ensure all users can interact with the AWS core uh password",
        "for the ions flow it is not possible to attach an iot policy to a single identity so design has to be like below to be a total usability",
        "and so uh also tiger can take a credential arms without looking into water the IM policy loss",
        "note that the iOS attacker needs anybody and no need to be a registered user uh also either else or Oslo uh May",
        "attach a and policy of the dangerous art API uh the LC API is that awt opens to Developers for managing iot applications uh type policy uh for example attack",
        "policy or ID or relate uh devices or things uh suppose the prognito user identity Pro is bounded it's bounds to such a policy every user has permission to call these standards apis and in severe cases tiger can even directly relate the all the vendors data on the AWS LG so let's take a look at at a demo video of the this attack so that we did this Attack video on our our own awt core",
        "accounts",
        "now the the left is our identical and",
        "the right is the rplc",
        "but the draw is the new test and it is attached with a over different missing I am pausing and we aim to delete the thing the name is testing",
        "and The Identical ID will be taken as a parameter as a",
        "first",
        "and we get a credential from cognito",
        "and the stream has been deleted through",
        "the attack",
        "there's nothing no noticing",
        "foreign",
        "that we use the same credential",
        "from the cognito",
        "okay",
        "um",
        "now that we have covered two designs with aerospaces we'll move on to the 2D implementation spaces the first is the information implementation RS3 uh Delma",
        "which iot policy templates positive techniques are widely adopted as a dynamically compiled across the schema that is some variables such as thing name are supported in the policy and the value of the variable is dynamically augmented for the request is received the same name is something like a device device number and it is unique identifier of the thing developers can attach the scene to a certificate or not however uh the semantics of the templates are not enough uh see the left figure if the device is under the users allow you the same name as their policy variable the allowed and critical topics are totally different and they can now communicate to each other and each developers want to make the policy secure they have to implement different state static positive for each other",
        "like this the process is tedious and error from uh",
        "and these processes are not easy to manage foreign",
        "[Music] policy to avoid this problem such as net view whose policy is written like the right for public section they just use the real card to let our users share the same policy templates but this policy also means every user can publish to every topic that is control every device on cloud",
        "let's take a demo of net views attack",
        "and the last is the host and the red is a guest so the attacker monitored monitors the traffic of the his own traffic",
        "to get the AWS Cognito clear credentials",
        "and",
        "because its credentials",
        "and the host will delete the guest we",
        "booked the gas permission",
        "now the gas permission has been revoked and",
        "you can confirm it",
        "the gas emission has been revoked and",
        "the guests can steal",
        "control the device",
        "okay",
        "okay um let's take part in uh another Implement Aerospace uh it's a constraints about the policy Mutual inclusion uh this is a high level flows by vendors that is the principle of an equity ACC section is not clear now some vendors like switchboard design another oxide control model see this picture the switchboard tab is the control center of all other devices and the Hub can connect to awt Via an equity protocol although the policy of the Hub is the Hub user is a clearly designed and economic multiple users can share the same permission in other words share the ownership and they can even not know each other",
        "uh differently switchboard select device to the class Access Control process which means the password is safe to under device uh inspirational expectation when the password is set up only the user run can control the",
        "password",
        "um however all the control flows must go through the same hub so that's to say all the users share the same and critical Topic in the AWS iot so the password is not a good design and tell you can easily monitor the cloud and replay other users control components who can control the other user's devices so let's take a look at three parts attack demo",
        "um multiple user can control the same device at the same time",
        "so the",
        "post about set a password",
        "to the device",
        "and the host can only include the password to control the device",
        "like an attacker can go into the clouds",
        "data encrypted control command",
        "now he cannot control the device by the app but he can use the script",
        "to replay the control command by The Host",
        "you can control the the device",
        "attacker can even control the device when the host eventually delete the device",
        "uh release the right all the vendors",
        "that we found to be in error on the entire consequences are including control the device monitor all the device activities or status or fake device messages or two users control the vendors are awt data",
        "to navigate mitigate the impact and help developers find the iot policy philosophy we mentioned we also present a formal verification tool to check the security of the policies uh teaching this thing that she verifier fee verifier has three basic check capabilities which are lighter and iot",
        "policy suddenly includes the permission as infected but uh how to policy is natural equally recent download influence policy whether multiple independent policies share conditions uh the main Insight of the tool is that the refreshing and encode the iot policy to write something formulas and be Liberate the state-of-the-art group C3 to solve the founders and to here is how we do that take the policy X as an example this policy allows the client to subscribe to topic filtered stuff with a slash B slash or basic encoding of the policy is like the effects zero uh see the right formulas",
        "the action under the resources will be encoded as the Assembly symbol for the first statement the action equals to",
        "uh biggest income throughout the Subscribe and the resource matches is slash B slash point star note that the star will be encoded similarly to the point star in regular expression the a variable is the action and R is the result similarly the second statement in",
        "the policy X will be encoded to if X1 and since the second statement",
        "is a denied statement so we can encode the policy into that some people made with a conjunction at X zero contact notes 5x1",
        "and similarly in a policy y also the",
        "the hash character is an Unity well card but we don't encode it now to make it easier to better illustrate the challenge of",
        "pivot file design let's review the flow box example the policy failed to deny topping a b x y but because it cannot cover the unpredicted semantics",
        "we must handle this problem here since we have to follow the semantics of the policy so we have to design an algorithm or something else to fully semantic release notes suppose the iot policy but not only the iot policy also discussed",
        "so the first thing we need to do is to encode the unpredictable characters throughout the policy treats them as normal characters we will encode the plus and hash to as well as analytics to",
        "encode the mqtt connectors we must",
        "pre-design the character inside of an electricity broadcast the U is the site of utf-8 singles or we Define the U as the very basic side the U.S is the chemical side of the hash and just almost the same ICU but we including the site of I'm pretty Reserve characters such as the hash and vanilla Plus",
        "and the up is the character side of the bus it is the U.S excluding the character uh Slash so",
        "the AP has been encoded as Abus star the",
        "star means the Crowder operation it's The Offspring generated on the character side and a B plus will be encoded at apup Star then the mqtt well card are",
        "encoded as the same as the unpredictable semantics",
        "uh however even with this level of encoding the policy semantics is not fully covered let's see the the same",
        "example policy X does not contain unputative but the topic resource abxy",
        "can still be oxidized by the welcome topic filter such as ad hash so the error is due to the welcome topic that can refer to the same topic we call this these topics are the symptoms so give me a deny the mqtt topic filter we first confirmed that it is relative to one or more a lot statements and then we must find out the whole side of their artist signals so we designed an alphabet",
        "reduced algorithm which can automate the generation of iot signals from the Star well card of the LT policy once uh iot seen them is generated and has been accepted by policy we confirmed that the denied agreement can be bypassed or the security property is not satisfiable",
        "we also evaluate p-valifier by comparing its weights awfully Defender and the verifying a policies of 3600 and",
        "302 open source iot projects and we also",
        "summarize the Benchmark for health policy including 403 for three floats",
        "for policy under 303 security secure parts of security",
        "policy because the defender does not deal with iot signums and does not take advantage of the security properties the result of the policies is not as good as RP verify and we also generate a large number of policies from two Dimensions uh the number of statements and the",
        "string lens the result shows that the",
        "complexity of pivotal increases approximately",
        "oh okay now I will make a conclusion of our work we found new flows from vendors practices and brought new understanding of iot policies security including two design Aerospace and three implementation space some realistic security risks and serious consequences uh we also present a formal verification tool on digital can better reason about and fully semantically support the iot policy and based on our evaluation this tool is highly effective and efficient if you are interested in our work and want to see more details please see our paper on CCS 2022",
        "okay thanks to the August or presentation is over and you are welcome to ask the questions",
        "was the microphone and ask questions",
        "no questions from the audience",
        "[Music]",
        "okay",
        "okay um about the questions I get asked you",
        "okay one of the questions I I get asked the most is how do I know the vendors policy configuration on the cloud uh we think this by reversing the app and then simulating the app with our own program after a lot of testing we can infer the policy contents through the response from the form and in addition we can also infer the way the cloud organizes the policy by deleting the device finding the device with another owner user and so on thanks",
        "[Music]",
        "foreign",
        "[Music]"
    ],
    "a9hsxPdRxsY": [
        "foreign",
        "my name is Chava fitzel and",
        "the presentation is win against TCC also",
        "known as 20 plus new ways to bypass your Mac OS privacy mechanism my name is chabar I'm currently working for offensive security I'm right now the lead content developer for our Mac OS control bypasses training I used to be a red and blue teamer for eight years before that I do Mac OS buck hunting in my free time as a hobby as part of work now I'm married have two kids and I love hiking and trail running my core presenter is voycheck unfortunately he wouldn't join us due to some has issues so we he recorded his part and we will play it back now and then I will pick up from there",
        "mobile security at security",
        "unfortunately due to my bad health condition I couldn't be there with you at blackhead in person however I will be",
        "still able to report the TCC from from the recording so I'm a blogger",
        "um but you could go about a Blog where I of course document my iOS and macro",
        "security findings for mostly focus on",
        "iOS and Marketplace application security somebody of you may also know me from IOS Security Suite that I'm creator of that's a free open source Swift library that helps developer making sure that their application is run on secure IOD devices and also engage in macca's",
        "environment security testing markers red teaming Etc",
        "so this is the second part of our presentation we gave with Jabba last year on blackheads in the us",
        "where we focused of course on on bypassing micros privacy mechanisms so",
        "yeah that's that's the second part the recent continuation and that's because that's the second part in the first part",
        "of the agenda I I'll just quickly remind you what stcc and what are the basic privacy fundamentals of markers if you are interested in learning in details",
        "how it works please check our first part of the stock so yeah that we will then focus on uh technical stuff on TCC",
        "bypasses and as you can see here on the slide there are a lot of utcc bypasses and in the end uh Chapa will cover some",
        "new uh security improvements released",
        "and markers Ventura",
        "so let's start with the I think the most fundamental uh Mac OS security mechanism",
        "that the system Integrity protection uh based on Sandbox kernel extension so on Mac OS if you have root you are not the God because even if you are rude you can't do anything with your operating system because the Sip will",
        "restrict access to many directories will deny debugger attachment to processes signed by directly uh by Apple you may not be able to change some of the contents of of some restricted crucial from the system perspective files",
        "etc etc and when the system Integrity protection is turned on um there is a new mechanism that's also turned on which is transparency constant and control uh",
        "watch the abbreviation is of course TCC uh",
        "when you for example open a new application that will try access some",
        "privacy sensitive resources like for example your contacts your address book uh you will see you will see a problem because",
        "the operating system wants to know if",
        "there is a clear clear user that user is consent to give the application",
        "access to your privacy sensitive resources and if you open privacy and security settings uh you will see that there are a lot of different resources that are controlled by the operating system and the TCC mechanism even if you go to uh to the automation tab you will see that TCC can be really granular because we can even control what application can control which other",
        "applications",
        "and yeah PCC is really huge uh nowadays",
        "and we observed that when Apple released a new major Macos version uh there are new TCC checks that are still added magnets yes so that's that's still that's that's really huge and will be problem even more big",
        "okay but that was the quick recap of the theory let's now focus on the exploitation so one year ago uh we showed you that there was a huge possibility to attack this city via uh plugins loaded to the applications contexts",
        "and yeah here again from the year one year later uh still there was a possibility but now from vrd uh device",
        "abstraction layer plugins so those plugins are are loaded when applications",
        "uh open camera stream using the coromandia io and those plugins are",
        "stored in library core media i o plug install directory which is not predicted",
        "with system security protection and those plugins are written",
        "let's say the old way there is no middle layer between the core media IO and",
        "those plugins so they are directly loaded to the process context which",
        "yeah allows us to if we are able of course to load the plugin to the vulnerable application",
        "we can control the whole application and",
        "use all of the permissions that were already granted to that app",
        "so let's create a plugin uh it's a bundle a standard bundle with",
        "um with Dynamic library that will be of course loaded we have to add those two CF plugin factors and see if plugin types entries to the info Palace of that output bundle and using this simple old Objective C",
        "Constructor trick to deconstruct the",
        "Constructor is executed when the plugin is loaded to the to the context of the of the main app is executed so in this Constructor we are able to execute our opcode",
        "um and yeah after I created the plugin I decided to grab the file system for all Apple's",
        "applications the standard standard installed on markets that have the private TCC SEC service camera",
        "permission granted because if an app has the private TCC permission and title and uh it the app does not have to ask uh",
        "for access to the grant that already uh private resources because there is a private time right there are Apple controls which at which their app don't have to ask the DC for accessing the private resource so I grabbed for all those applications with that private entitlement and I decided to open them up",
        "as you can see uh quickly almost instantly I got five hits",
        "which is a big deal for somebody uh",
        "participating in Apple security party I have to say so I was that happy that I decided to go AFK and I went on went on vacation uh but coming back to the expectation the idea uh is really simple just create",
        "a malicious plugin save the one that this one plugin dial directory and open all vulnerable",
        "applications with interesting entitlements",
        "uh yeah so one of those five heads uh",
        "was photobooth so let's take a look at its entitlement uh camera microphone",
        "address book looks good",
        "now let's see the demo I created the plugin and installed in the in the directory I told you let's now open the photo booth application",
        "under the hood the plugin is loaded and as you can see I made a screenshot of that application so yeah I was able to access users uh camera without reading an atcc prompt",
        "but from those five hits I think the most interesting one was uh the contacts application because as you can see there are a lot of different TCC permissions and one of those permissions was TCC",
        "manager which allows us to fully take",
        "over the control uh over the uh the whole PC database so",
        "let's take a look at the demon I open the contacts I will do it also manually uh to show you where the code is actually executed as you can see and full disk actors only those apps have the the permissions granted and when I create a new contact manually",
        "and I opened the camera stream the plugin is now loaded and the terminal application",
        "has been added by my code because I have the full control over the uh the DTC",
        "database so yeah that's the ultimate TCC bypass model vulnerability",
        "so those uh five fine findings uh had",
        "five different CVS assigned because in all of them the hardened Grind Time has to be turned on",
        "uh the second part of us I wanted to share with you is via alarm services but before we start exploiting it let's uh let's focus on what Mac L is so when you open Terminal and want to cut you know so file from from a directory here for example from document that is protected by PCC then the temperature should not be permitted because you didn't grab access to terminal but if you drag and drop the file to determine now",
        "you will see that now magically uh this the terminal has access to that file and that's because that's because the Mac L uh extended attribute with which we can see we have the X after uh Dash L uh to",
        "to see the account Apple Mac L estimate",
        "attribute so this attribute has managed managed by sandbox and it cannot be modified by user or even root and the idea of Mac L is to have the clear wizard intention that user wants to open this particular file and the that particular application had has to access",
        "this file without raising addition of this prop so the Mac l extended attribute is applied in two situations when user drags and drop a file to to",
        "the app or when user double clicks uh on a on a file so the application that is responsible for the file uh will automatically open it",
        "so you tell me that Mark L extends attributes is applied when users doubling to double clicks file",
        "foreign TCC",
        "I found out that the only thing required to bypass the whole mechanism is just to reduce their malicious app to handle all file extensions and call that services",
        "to open the juicy files right it's a really good stock really that's that's the my my most favorite bug in TCC I've ever found",
        "so unless they get a good deal again",
        "ah markers 12.2 uh system figure",
        "detection is enabled",
        "you will now see in security and privacy",
        "that there are no additional privileges granted to the Bible TC via me application that will be using the perfect app",
        "and now when I open it",
        "you can see when I put it on address book Let's copy to the TMP directory",
        "and the same with my message",
        "and when we go to the temporary directory",
        "you will see that we actually have access to those files which shows that we were able to bypass the TCC",
        "of course the",
        "new cve was granted for for the Edition",
        "another have honorable that I wanted to share with you is there TCC bypass via",
        "SQL tracing mechanism so there are a lot of small applications on Mac that use under the hoods sqlite free to store data some of those applications are apps that have resources protected by the DCC like for example male male contact knows iMessage",
        "Etc and all of them use leap sqlite3",
        "Dynamic library",
        "that of course handles all of the SQL live freestyle but the the the framework the",
        "dialect respects the issacing light Auto",
        "Trace environment variable when it's",
        "said it locks all of the used SQL queries",
        "and I'll mark there is a simple way to enable a environment variable globally so we've",
        "just launched CTS at amp I was able to do so and again I started using those applications that used you",
        "that use the sqlite free one of the the one of the examples contacts when I started creating one contact",
        "UM the details were locked",
        "the same with mail because mail has to store somehow your remains that are sent uh locally on your on your disk uh they are saved in a secure and free database so yeah let's just scroll right we are locked",
        "again uh read this demon so when you use iMessage uh this demon stores that the",
        "information about your recent contacts",
        "foreign",
        "was a bit harder but it wasn't really",
        "hard to attack so if you create a new node uh you will see that the data is is",
        "visible in a SQL queries however if you",
        "just um unhactify this data you will see you will see the context and funny thing is that every application that it's not some boxed Mac can access the deluxe",
        "so there is no special additional",
        "entitlement uh required to do so any app could could",
        "access this notes",
        "okay and the next vulnerability is to",
        "bypass the Celia iCloud so some of the normality protected data uh is the",
        "default synchronized with iCloud uh",
        "however in this part we want even touch the TCC protected data I mean by",
        "attacking the TCC itself we will extract",
        "them directly from the cloud",
        "so I identified two interesting applications a garage window type movie that had both come up with private I can I can access the title months and the congressman additionally disabled Library presentation",
        "so with the private iCloud account",
        "access entitlement we can communicate with an old C written ecstasy API",
        "provided with the iCloud helper service",
        "and this that service will happily uh",
        "provide us with iPhone tokens with nicely apps but in order to do so we have to have the code execution within",
        "the privileged processes uh countless",
        "right so in GarageBand",
        "the attack was was pretty easy uh because we because I just use the starter dialog proxy attack to modify",
        "why one of garagebands framework",
        "and execute code with the GarageBand",
        "in iMovie",
        "it was still easier because I already didn't have the Highland runtime turned on so we've just built inside the libraries uh variable I was able to",
        "inject",
        "my dialogue uh to the iov context and execute code within it so when I did when I did",
        "exploited those two applications uh that",
        "was the that was Json returned from",
        "returned from the iCloud helper service",
        "and as you can see there are a lot of hyper tokens that were provided",
        "I created also demo that will exploit the location service",
        "so if you provide the the stolen token under the hood the script well",
        "I refer to find my session and we'll have the Json written from iCloud so latitude and longitude",
        "of myself without raising any TCC prop right so yeah we were able to exploit it the idea for other resources to run into your iCloud is the same so which is actually the exploitation of location services",
        "[Music]",
        "and of course uh those issues are now fixed you may ask but poetry why there are two CDs for each vulnerability",
        "because again Apple forgot about the",
        "upgrade attack so I was it was still exploited by help by just using it",
        "against the older version of it but now it's all fixed uh that's the end of my part thank you very much",
        "thank you uh so you might think already that TCC is fully broken on my quest and you haven't even seen the second half of the presentation so let's continue with some more box uh so the next round of vulnerability class uh we call it TCC bypasses using sysadmin tools I really like the rule of diversity from Eric Raymond's 17 unique Soul which he says developers should design their programs to be flexible and open this rule aims to make programs flexible allowing them to be used in other ways than their developers intended and I",
        "think this this idea catches this partially there because we use sysadmin tools in the way they were never intended to be used uh some of these two's have very powerful entitlements and basically they will allow us to either fully or partially bypass TCC",
        "uh so the first one called ASR which is the Apple software restore utility basically it can be used to restore and clone full disk images and has some very powerful entitlements and I had the idea okay tc06 us from accessing certain parts of the file system but what if we take the entire file system clone it somewhere and then just access that disk or image",
        "uh turns out that ASR is a super buggy Tool uh I really feel sorry for all the Mac admins who have to use it uh it's basically broken on every single version in a different way I actually had to",
        "search for how to actually use it and I found a very good blog post from one of the Mac admins which says okay these are the steps how you use ASR on Catalina because ASR is very sensitive to all the apfs display out the problem was that I was already on Monterey are not and not on Catalina so that the steps uh he described didn't work anymore so I had to find my way too I eventually managed to make an apfs layout and disk layout which was happily assetted by ASR and",
        "simply as is I could basically clone the entire disk to another partition then",
        "open that partition mounted and then",
        "list all the private stuff I wanted so on the screen we can see that I can access messages uh on the newly created partition but I",
        "cannot access it on the on its original location",
        "uh the next one is time machine time machine is Apple's backup utility",
        "um if if we back off to an apfs disk it will use snapshots uh to make the backup Now by default it seems to be very well protected uh by TCC so if we try to go and restart backup volume in the hope that we will find private files there uh it will not be permitted um if we try to list the snapshots of",
        "that backup it will not be permitted so it looks good but it turns out that if we start to browse The Time Machine backups in",
        "finder finder via Mount those backups in",
        "a new location under the hood which is under volumes slash dot time machine",
        "then a good and then the the backup date and that location will not be protected by TCC so if by any chance the user browses his backups for restoring",
        "something or whatever at that point you can access all of his files uh",
        "unfortunately what this has been fixed uh the next one is Apple mobile backup",
        "utility uh this is a small utility to backup iOS to Mac OS Now the default backup location is under the user home folder library application support mobile sync backup this is protected by TCC as it should be because iOS backups contains private information of course",
        "but can we back up somewhere else uh turns out we can uh so we first need to grab uh get the uh the ID of our iOS",
        "device we can use the system profiler utility for that and then we can call the Apple mobile backup utility with the dash dash root option and with the dash dash root option we can specify uh the root directory for the backup so we can basically back up to the temp directory and once the backup is complete we can access those files",
        "um that verse anytime the user plugs in his uh or her iPhone to the machine and at",
        "that point we can access all the private information now Affair came back to me at that voice that went uh Ventura beta 5 and they said David we fixed it and it turned out what they did they removed the root option from the utility which seemed to be nice on the surface but it turns out that the Apple mobile backup utility uh",
        "it doesn't have any specific entitlements to do the backups first and it uses the device link private framework now this private framework has",
        "the function to set the root folder for the backup location and the framework still had this function um so what someone can do is",
        "load this framework on its own and call",
        "this function and basically mimic the",
        "utility on its on his or her own program",
        "uh so this was one uh the other thing",
        "I could take an old version of Apple mobile backup put it on the latest Ventura run it and it will still work",
        "um so we are back to square one and I'm pretty sure Emperor who's looking some like this okay so this is not good um so they re-architected the entire fix",
        "and ultimately they sacrifice usability",
        "on for security uh sorry for that",
        "uh someone called me out on Twitter that hey did you break our automated backups for iOS and I was like no I haven't done anything",
        "um like is is the cve related to uh to the broken feature and I was like probably not maybe and I started to look",
        "into it and and eventually it turned out that yes um uh they can blame me for that so whatever did is whenever you want to backup your iOS device uh",
        "you need to enter your passcode on the iOS device for the backup to happen and this breaks any automated backups",
        "unfortunately",
        "hope I hope this will change so for example if the backup is encrypted then there is really no bypass here because the backup will be encrypted and regardless the backup location an",
        "attacker cannot decrypt it so in that case I think asking for a passcode is not necessarily we will see if if it will be changed in the future or not uh the next sysadmin to Remote Management or apple remote desktop",
        "we can enable this service as root so it",
        "requires root if it's not enabled and this the Apple remote desktop agent",
        "the AI the agent",
        "has a system policy or files permission",
        "which means full disk access so it can write files anywhere so what we can do and here's a video of the",
        "exploit for this you need to be root so on the video I'm showing that the TCC database it's empty it doesn't Grant permissions to anything",
        "let's try this again",
        "so the TCC database is empty uh what we will do is",
        "create a new user again we need to be root for this it can be any user it will be an admin user and then we will enable remote desktop",
        "service",
        "we can we could do this without any specific permissions uh beside being root",
        "and once it's enabled",
        "okay it keeps crashing",
        "so basically what happens is",
        "once the new user is created and remove desktop is enabled we can use the remote desktop utility to copy a file to the file system a remotely over fried the existing TCC database and basically take over TCC",
        "with any new rules we want",
        "um we cannot access like the user desktop uh",
        "with enabling remove desktop display but we can still copy a file uh remotely and this was fixed uh mainly at the sandbox and and backup by Apple",
        "uh there are still a few that being fixed so maybe in a future black hat or conference we can present those uh the next one is the TCC bypass through mounting uh the idea is basically that DCC protects many directories and we mount a new disk image over this directory and maybe drop a new configuration file like a new DCC database or let the system write there something and then we can read it back by unmounting it I heavily have used this back in 2021 and eventually Apple learned the lesson that they now properly protect most of the directories from mounting and I said most of them turns out not all so TCC has two main databases one for the system processors and one for the user turns out there is a third one which I wasn't aware of and it's only used by the location services demon and it's not a database",
        "but it's a property list file but it acts as the database I have no idea why this is separately and why these permissions are not in the in the main TC database I think it should be anyhow this location wasn't protected so what I",
        "could do is create a new custom P list put it in a disk image and mount this disk image over the VAR DB location directory and Grant any",
        "excess Grant any application access to",
        "location services",
        "and then there was a very interesting bug I call it hardening confusion so some directories like documents address book as we saw so earlier are protected by TCC so we cannot read and modify files that exist but we can",
        "create new files there which is viewed at the first time and I frequently got asked this question is this normal yes it is it's confusing but it's still okay because if you create a new file as an attacker it's not you don't really access the user private stuff so so it's it's okay it's weird but it's okay uh the second thing is that we cannot create a hard link pointing to a TCC protected file uh which is good because if the hard link is in a different location we could access that file immediately but what if we combine the two so is there like some sort of check raise uh",
        "here turns out that yes so what we can do again we try to list documents we try to list the address book and we can see that it's not permitted but and which was not right what we could do is create a hard link inside the documents directory pointing to the address book",
        "this shouldn't be shouldn't work but it did work so at that point uh we have a hard link pointing to the address book from the document so we still cannot access any of them but now if we try to access the address DB in documents we will get the pop-up the terminal wants to access your documents and now if the user approves it we can access that file we still cannot access the address book but we can access the hard link and this is a problem because the user thinks that he gave access to the documents folder but not the address book but we can actually access the address book it's been fixed again in the sandbox",
        "now let's switch to Ventura changes uh quickly one of the new TCC feature is application bundle protection basically TCC we now prevent",
        "applications from modifying other applications this has been abused way too many times for pawning electron based application or simply malware by dropping files inside other applications so this is good unfortunately I managed to bypass this three times so this is still being fixed the other thing is the endpoint security clients uh they used to require full disk access permission for them to operate and I had another talk at objective by the Sea about the Oculus 0 of endpoint security basically it was really easy to revoke this permission for endpoint security clients and you could disarm any uh",
        "security software on a Mac so this went back and forth between me and Dapper and eventually they redesigned the way endpoint security clients got this permission and now instead of food is accessed they required this endpoint security client permission but it still shows up under full disk access which allows",
        "some confusion and it turns out that they made a mistake and",
        "Mikey found it that",
        "if you do the upgrade on Ventura beta then there will be two new two entries now for the endpoint security client and it will be confusing for the process and eventually the endpoint security client will not work so my friends Patrick Wardell Thomas read and anyone who writes endpoint security software for macdaver overwhelmed with bug reports that hey your application is broken and articles like these started to show up",
        "uh my request wrapper please don't break",
        "stuff while fixing my stuff this is not the fame I want",
        "um other improvements this these are not TCC specific",
        "um there was it was a very common attack uh to do downgrades as we saw earlier so",
        "basically we can either use an old binary from another order OS",
        "or we can take an application copy it out from its location embed the plugin and and run it there are many blog post talks about it um so one of the improvements is trust cache this is coming from the iOS word and it's only for Apple silicon the idea is that the trust cache will have all the hashes of all the upper binaries present on the system and if your binary is signed by Apple it can only run if it present in the trust cache otherwise not so it will prevent any downgrade attacks so I cannot take for example the old Apple mobile backup utility from an old system because it will be blocked because it doesn't present in the trust cache uh so this is pretty nice unfortunately it's not on the Intel based version but I guess that will go away anyway in a few years and the second big one is launch constraints um which basically controls from where",
        "and who can start an Apple sign binary on the system uh so for example even if an Apple sign",
        "Daemon meant to be started by launch D only launch D can start it so I cannot start it anymore from the command line and the other thing is that I cannot copy out an application from its trusted location and run it so it has to reside",
        "on their system uh which is pretty nice more from it",
        "is written by Linus hanza on his blog post thank you very much that was all uh either a question I'm not sure if I have time for question but you can find me here afterwards thank you",
        "foreign [Music]",
        "[Music]"
    ],
    "qIwKg2qny0c": [
        "foreign",
        "protocol vulnerabilities again",
        "before we start let me introduce myself first I'm a senior security engineer from concept team of logistics and changing group currently and many folks on iot and product security and have fun Modern World 100 vulnerabilities devices",
        "from cellulite micro loads your view Cisco and so on also I would speak at a conference like POC and hacker in the Box before",
        "hair will go loud this talk is broken down into four parts and part one as that of fight introducing for the LST department is and the motivation behind it in part two as many sometimes describing the selection and ldb protocol as well as the differences in part three I'll repeat llcd Point research and present us studied into several common CDP and ildp components",
        "powerful is the summary of this thought so that with introduction",
        "what's LCD pound LCD pound is a series of zero day vulnerabilities in layer 2 protocol CDP and ldp which affects",
        "several cdb and the ildb components as",
        "with that nearly 70 kind of devices from 30 wall vendors are available",
        "the following are the saving ideas assigned at the moment",
        "under rough classification of fun bugs",
        "are followed like Auto abundance right but overflow memory and so on while some",
        "of them will only cause July of service some military code execution",
        "Cisco Discovery protocol is a Cisco proprietary protocol and many users in",
        "Cisco manufacturing devices as a result",
        "the effective CDP components many",
        "existed in these devices while link layer Discovery protocol is a more General and vendor Mutual protocol there are many implementations for it during our research several common ldp",
        "components are found to be widely used and available",
        "among them some",
        "the first four are from open source projects and the largest street are closed Source components",
        "these two projects are common on network",
        "devices like switch and router we have evaluated some devices from wallow vendors and the following are affected like Cisco your music let's take care and so on",
        "why was digital city pound research many",
        "of you may have heard of CD Punk yeah it's the origin of our work the city pound research conducted by the arms lab in 2020 shaded on the severe impact of attractive exposed by the CDP protocol",
        "it can identified zodiac vulnerabilities four of which could be used to achieve code execution",
        "also it affected a wide array of Cisco products including switch rooted Arch",
        "cameras and IP phone",
        "while learning State Department says several questions came to our mind or this volume will be were fixed with the early variant what about other vendors or it's just Cisco's own business to ask this question origin is not it",
        "all right we have a general idea of our city pound on its background let's move on to the next part in positive I'll cover the basically about CDP and ildp protocol to give you a general understanding",
        "according to the city pound research some common layer to protocols used unless of Appliance as follows among",
        "them to Discovery products named cdb and ldp",
        "are folks of RLC Depot research by the way besides these two protocols there are other vendor specific Discovery protocols such as extreme Discovery",
        "protocol for extreme devices electrical",
        "switch Discovery protocol for let's go devices mycological label Discovery",
        "protocol for mechanological devices since the studyb and ldb Protocols are widely used we only considered on these two at the moment",
        "as I mentioned before CDP is a Cisco proprietary protocol used for collecting",
        "directly connected labeled device information like Hardware software",
        "device name details and so on it has two versions at the moment the virtual machine is the most recent release and provide more feature than real one therefore it's more prevalent on Cisco devices the following is an example of CDP frame format as we can see the certificate layer is above the easily layer and The Logical link control layer with the prototype to 2000",
        "as for the CDP pdu it starts with three Fields namely version time to life and check sum Then followed by a list of type list menu per",
        "the description for each field are as follows among them the gov part is",
        "dedicated to a steady package and the useful current information to meet differently each Tov connects type less",
        "and value field independently",
        "some common usage theories are listed as follows such as the device ID Tov indicates the device name address is still way connect Network addresses for both receiving and sending devices",
        "I've left the menu with the CDP protocol let's take a look at a lot of similar protocol called link layer Discovery protocol compared with CDP protocol",
        "iodp protocol is more General and Fender independent and since ildp is an open standard it's supported our most advanced network devices the following is an example of ldp frame format as can be seen the ldp layer is above the easel 2 layer with each cellular type double it double C as for ldpu it recommends a list of five",
        "lists and value per",
        "similarly some common illustrator with are listed as follows such as yes I need your weight indicates that she has a management address POV indicates the",
        "address used to assessment Discovery by Network management",
        "to the differences between these two Protocols are discussed from secured",
        "perspective too many differences between them are key of order and a two of the lens at 40 of the order there are low explicit requirements in CDP protocol while in ildp protocol it must start",
        "with shift ID Port ID and at heart to life to over in the correct order as 40 of the lens it seems more interesting instead of protocol the length of each Theory includes the type analysis field and is range from fourth to ffff while in ldp protocol the",
        "length of each T of a excludes the type analyzed field and is doing it from 0 to 1 double f after having a general understanding of CDP and every ldp protocol let's move on",
        "to the most important part as I mentioned before city pound research is the origin of our work when learning Stadium research firstly we started by a little lighting the five zero day vulnerability during this process we are familiar with decoder for passing status package and also then some volubility pattern then",
        "we conducted an in-depth analysis against the encoder to pass City packs again",
        "and founder allowed 20 bucks in five types of devices including nxos switch",
        "iOS XR router IP camera and analog",
        "telephone adapter among them some can be used to achieve code execution",
        "next I'll show some interesting vulnerabilities found in this stage",
        "first let's start with an autobund write variability affecting Cisco IP phone",
        "it can be triggered by sending a cdb peg leg Community multiple addresses POV the",
        "IP conference phone 7834 with version",
        "14.11 is used in this example on the",
        "right is an example of CDP packet Company addresses gov",
        "in cdb battery CDP receive pack function",
        "is responsible for passing that received CDP package here we're only clear model logic to pass address still way it will do proper validation and failed and the Copic corresponding lens into a large buffer",
        "items when passing these items there are",
        "two exit a condition one in the variable rate 24 big long one dividend match the code only passed the remaining IP address item if exist the other is a long exit if an account of IP address items equal to number of address it means all the IP address items have been passed then the routing for this address is still way is done at four single addressed two way the above large box will however if a",
        "CDP packet connects multiple address two way then there is the floor the key Point here is that the variable v24 is",
        "initialized at the beginning earlier than the loop to pass steel wage let's look at in in detail in case one only one addresses two way exists in the state package and it recommends three",
        "ibb6i address items the if condition",
        "under 35 and order three IPv6 address",
        "items will be passed since v24 will",
        "is always zero although we can pass Med IPv6 address items the copy operation",
        "undercode Auto boundary line the logic works well in this case in case two that is also only one addresses Theory while attacking industry IP address items so if",
        "condition only has well the information will satisfy and the two IP address items will be passed the v24 will be 2",
        "and on the course out of bounded right either what about multiple address to V",
        "in this case there are three addressing two way and each addresses two way connect only one IP address items when passing the first address two way that if condition will certify and the variable weight 24 will be one then the routine access normally then",
        "when passing the second addresses go away 24 will be updated and the routing",
        "axis due to rate 24 bit 1. in the Looper for passing two weights it will continue to pass the third address residual way variable weight 24 will be updated to 3. hence we break the logic if we corrupted a CDP packet can multiply addresses to read like this then we can increase the variable with 24 continually thus causing Auto or bounce right since variable s points to above on stack we can even overwrite a return address on stack",
        "next one is Savory 2022 2846 which",
        "affects the Cisco iOS XR router it's a",
        "heap of low vulnerability one passing addressed copy however due to the limitation on the buys can be written achieving code execution may be hard iOS",
        "extra router with version",
        "7.4.2 is used in this example foreign",
        "common function we can see the patch for formula stream vulnerability saving 2020",
        "3118",
        "in this same function there is a loop used for copying converted IP address streams into a paper buffer what's interesting is that the side of hero power is fixed while the loop condition depends on the number of address field from CDP packet",
        "if we cover an IP address with a big number of adjust menu thus we can quote heap of flow on coin memory copy and one since the copy that contents are from the result of ntop function the bytes",
        "can be written are restricted thus make the equal role taking harder",
        "the third one is Savvy 2021 1131 which",
        "affects the Cisco its owner service IP camera also it's a head of low vulnerability when party addresses COV and may be used to achieve code execution radio",
        "surveillance H20 IP camera with release",
        "1.0.95 is used in this example",
        "in cdpd battery the cdpd handle adjust",
        "COV is responsible for handy",
        "in this function it will first first get the size of total IP address items by subtracting data from turbulence at one then allocated above based on number of address field at 2. in the following Loop it will try to pass the content IP address item and copy it can condensed",
        "into allocated buffer in the loop there are multiple accident conditions",
        "however the water dependent",
        "on validation remember that the size of allocated path depends on the number of address field that's the point",
        "since the exit condition of low fat depending on the G of a list field if we collaborate our IP address to V with a",
        "large Geo Village and a small number of addressed value then we can quote have a flow from coin memory copy at 4.",
        "so far when starting the 30 pound research where land can management patterns from both the original and the newly founder vulnerabilities what's more we have a better understanding of the CDP protocol format",
        "what about the ildp protocol compared",
        "with CDP protocol ldp protocol is more",
        "General and Fender independent it can be used on most Revenue network devices",
        "from previous stage will continue to",
        "investigate the implementation for passing ldb packs on network devices",
        "our work in this stage can be divided into three steps when the selection divides selection and bug hunting to be wallaced the bug hunting part is is straightforward and relatively easy while the first two steps are tedious let's take a close look at each step the first step is the vendor selection the purpose is to get a little Advantage which supports ildp feature on its devices we approach it in two ways the",
        "first is to find and check the corresponding documents from vendors including product catalog and devices",
        "specification some vendors provide a",
        "product like catalog which includes all its products under related parameters if",
        "those such catalog exists we stick to the device specification to check if it supports ldb feature or load the other into such a relationship in our firmware database such as ldp wrong turbulence tube error",
        "and so on the last step in the device selection we approach it in two Dimensions render on the device firmware as for vendor it should be overload so that is a devices will be widely used then the vendor should have a public way to receive bug reports and open to them as for firmware since when many conducted This research by Static analysis the device formula",
        "should be available without actual contract or license needed moreover the",
        "device firmware can be unpacked easily or with small efforts",
        "with a list of targeted devices the left side is bug hunting since there are many different devices synthetic analysis is all my Approach of",
        "course Dynamic analysis is used for verification if Leslie we choose to use emulation is that for packaged drugs in the powerful sketch framework is used",
        "during this research several common ildp",
        "components are found in firmware from a wider variety of level devices among them the first four are from open source projects and the last three are closed resource components what's more nearly 50 bugs are found in a wide variety of devices among them some are common in ildp components others are introduced by the vendor the type of founder bugs includes five of flow and flow memory and so on",
        "the following are the seven ideas related to ldp at the moment",
        "of course there are some limitations in our research on one hand since medical analysis is Alma approach although the",
        "device firmware can then affect the ildp components the market load has been actually actually used on the device fortunately when we reported this box to rendered and communicate with them most of all bugs are valid and have been fixed on the other hand due to our targets learning strategy some events and devices may be omitted there is a high probability that the actual impact will be much larger next I'll discuss several common ildp",
        "components and some vulnerabilities inside them in detail",
        "the first and open source component is ldpd it's a 802.1 a b implementation to",
        "have a nuclear levels of War equipment according to our research this component",
        "is widely used in devices from planets like Cisco to muted and so on moreover",
        "it's even in the packaging list on systems like Ubuntu and FreeBSD",
        "there are some were released in this component in the past among them three are related to ldp protocol 70",
        "2015 8011 is a critical path overall",
        "vulnerability occurred when passing management address COV",
        "on the left is an example ildp packaged kinetic management address POV inside it",
        "there is a field limit address student lens which indicates the total length of address subtype and the management address field on the right hand is the face for this part of low vulnerability and we can say before coping data with adjust screen",
        "left side into address stream buffer a lens validation is added on the address student lens field prettiest beautiful order as you may think since this is the end of vulnerability from 6 years ago and had already been fixed it shouldn't existed in nowadays however it's loaded",
        "to choose and during our research it turns out that this vulnerability still exists in 2021",
        "for example there are",
        "510 AP from from rocks left box with",
        "this release fashion surface from this part of low vulnerability",
        "and the RV 132wvn router from Cisco where this is released version also started from this path of low vulnerability",
        "interesting the end level Village from 6 years ago Studio survived in 2021 let",
        "alone the mechanical vulnerability found in 2020",
        "the second component is the ildp implementation is open with switch project open base switch is suited to function as a virtual switch in virtual machine environment and support ildp feature its",
        "lldp implementation coming from the previous iodvd project and with some",
        "customer change this module is found in products like the large glass Memoir SST and so on",
        "since it comes from the ldbd project",
        "it accepts from the same vulnerabilities at ldpd as we can say the older buffer",
        "overflow vulnerability was low fixed until November 2020 on the other hand",
        "whether this vulnerabilities for faced in the open waste wage project it does not mean that the products using this module was to fix them",
        "besides those vulnerabilities coming from ldbd Project it's custom changes",
        "also introduce extra vulnerabilities take the following code as an example in",
        "ldp code function if T over time equal to 7 F the routine will reach one word two of balance is validated then if work ID equal to 04 OD and the two of a subtype equal to C then at three 36 will be subtracted from",
        "T over length and the result will be assigned to variable number mappings which will be used to control the loop condition later however the validation at one only",
        "ensures that the two valence should be bigger than or equal to four if we collaborate an organizationally specific two way with two of ls equal to five then we can call energy and flow at 3 and the lead to Auto Bond rate at four",
        "let's component open ldp is also an open",
        "source project and was found in devices from boxer and train alert and so on also is in a package list on previously system",
        "and we can say from its source code page the legislature version is 0.4 Alpha and",
        "the last modified time is June 2010 almost at 10 years outdated project",
        "after auditing the source code several vulnerabilities were found such as lamppointed reference image and flow have a flow and so on",
        "in RX process frame function when passing the ldp package actually there",
        "are many validations however when validation is fail it will last itself increasing the variable better frame and the routine will continue this Behavior leads to decisive vulnerabilities",
        "so far we have talked about Street open source projects the next one is a closed Source components called l2d ldp torque",
        "whole as this name indicates it's a loadable color module this module is used in switched from Cisco your music and so on several vulnerabilities were",
        "found in this module like energy and flow path of flow Auto abundant read",
        "taking a Cisco small business Smart Switch as an example Savvy 2021",
        "34780 is a part of low vulnerability occurred when passing the Tia tr41",
        "committee Tov the smart switch with version",
        "1.2.0.6 is used in this example",
        "on the right is the example of ldb package containing Tia tr41 committee",
        "tlv",
        "being ldp packet X function in the",
        "following Loop it will get a chill with type and turbulence field then for check",
        "turbulent function to do validation if we just satisfy and the T over time equal to 7 F the routine will reach 2 if all the use code is 1 2 Double B work",
        "survive and look the format are both equal to 3 then the routine will reach 5. wall variable base 73 will point to",
        "the offset BB data from one straight at the buffer and five will be subtracted from 2 over length and assigned to 74",
        "then these two variables will be passed to memory copy as seven however at 40 times 7 F the range of two",
        "valence is from 4 to 1 double f while the remaining side of this buffer is 7c1 coin memory copy it's possible to",
        "put five overflow at seven in addition your main notes is that there is a lot of energy and flow overability and sales",
        "the last component we will talk is switch drvr it's also a closed Source",
        "component and founder is switched from ubiquity and the left gear this module suffers from foreign",
        "model with version",
        "4.3.22 as an example in ldp video",
        "receive process function positive type",
        "less function will be called to get to the type and turbulence field if T over time equal to 8 functions are two six one triple four will be called at one in this function addresses units will be read and two then address is really less minus one will be saved to memory pointed by A1 plus one later there will",
        "be a validation on this value at 3. if we just satisfy in normal cases memory copy will be caught at four what's interesting is that the maximum of size can be one f while the maximum size of this Barber is only one C is possible 25 overflow on coin memory copy",
        "during this stage we learned some new vulnerability patterns related to ldp",
        "packet passing also will get a better understanding of the city the iodp protocol format at the end of this part we will give a glimpse of the attributes standard 802.1 a b and see how this vulnerabilities validity",
        "the iodb protocol is formally referred to by the igb at the station and the media Access Control connectivity Discovery specified in IEEE",
        "802.1 a b the standard has three versions 2005 2009 and 2016. in addition there are",
        "many net th 2021 at sports to transmit and receive our dvto risk that exceeded",
        "the space available in a single frame however this feature segment will not be used on network Appliance yet so we'll",
        "focus on the 20 16 imagine",
        "the standard has explicit definition to",
        "the basic management COV such as G of order T of a repetition management address to the information students and",
        "the management address lens",
        "in addition the corresponding item is done that also have expressed that linked to organizational specific Tob",
        "like a valence limbless information stream location identification tube",
        "location and ID Sujin lens and the location data formula type menu",
        "according to our study the following is the summer of how this ldb imagines violence the standard",
        "the last part is the summer of this talk LCD pump is a series of zero day vulnerabilities found in relative protocol CDP and ldp wouldn't we can't",
        "learn from it first variant analysis is cool on the",
        "one hand we can try to look into the same implementations to find more bugs on our hand it can be done on a broader level such as looking into similar products or components for the same implementation on different devices or system next software build of materials are",
        "important in software security and software supply chain take Cisco as an",
        "example at 450 at 4 30 feature there are",
        "at least 80 different implementing on its various products and as for ldb feature there are also at least five different implementations since each product team has different responsibility when one of the products has secured issue it's not easy to determine whether other products suffer from same issue a lot",
        "after having software work build of material it's recommended to come cable",
        "component update and avoid using our",
        "related components if possible",
        "finally we should pay attention to the OEM software and the impact will be Amplified if vulnerability existed",
        "inside it okay that's all I share today wish you all have the hardest thanks for listening",
        "[Music]",
        "[Music]"
    ],
    "gUcAFAI7IIM": [
        "foreign",
        "closing session for black cat Europe 2022.",
        "give yourself a round of applause you've lasted this long",
        "so you are the most die-hard of the die hards that are toughen it out to the end so we're going to try to entertain you and try to make you think a little bit differently and we're going to have a conversation on some topics and uh just",
        "explore some areas around technology maybe some social issues and then we'll open it up questions from the audience and uh and so the idea is if you're not familiar is we're just trying to have a conversation and you just happen to be in the room uh watching it um and then at some point you get involved and so it's no real pressure it's just meant to be a nice way to wind down the conference in a more conversational way trying to put a lot of things in context instead of trying to have one more uh one to many uh kind of speech so with that Ted I'm going to start with my left and uh the review board members are going to introduce themselves uh and kind of give you just brief context of their perspective and then we'll start off with our first secret subject they don't",
        "know about",
        "your mobile network",
        "um hi hi everyone my name is federicomagi from Italy I'm a next academic who moved to the industry about six years ago now I'm working as a security researcher and happily Review Board member for black Europe",
        "Galloway",
        "everyone I'm an interest I work on a research firm mainly focusing on mobile security",
        "over to you fantastic okay well the the easy first question is going to be around what we saw this morning with our keynote we sort of built on Daniel's talk and so Jen was talking a lot about what we can do to try to make the internet uh safer and that seemed to involve a lot of um like personalizing getting personal involvement taking time out of your physicists or corporate responsibilities to try to engage with policy makers or raise awareness what did you guys I'll start on my left um what did you take away from that what did you think um did it resonate with you or does it feel like um like it's very hard for people in our community to engage and make the internet better and so instead we just withdraw into like our technical bubble because that's what we know and understand yeah that's an interesting question like I've been asking myself what can I do like to whom can I speak I don't really see myself in policy making like I think it's not so much my strengths but at least like communicating with journalists telling people stuff in a",
        "way that's easily accessible like I do teaching a lot so how do I tell not only technically Advanced people something no no thank you ah yeah okay yeah so how do I tell stuff to people in a way they understand it even if they're non-experts okay so",
        "and and would you go out of your way to do that or is it just sort of when it happens you would take the opportunity a little bit as an addition I mean it means a lot of effort if you have I mean even if you have a talk here you can either choose to make it accessible to beginners or you just say yeah I don't care black hat people the visitors here are experts I skipped the introduction I only have 30 minutes yeah go right to the decision that you can do and that you can put effort into yeah yeah but what I really liked um of Jen's speaking and the way she she suggested",
        "that we um take a little time out of our professional like engagements or daily",
        "job maybe just with a colleague or one or two colleagues to explain them why a certain thing is security relevant or not because that I think is the most ubiquitous and pervasive way to to raise awareness because yes you can run training you can run cyber initiative to promote awareness of consumer or non-security people but I think that the one-to-one communication at the workplace um in the workplace is is much more applicable to reality and everyone any of us can do it we don't you don't have to be a good trainer to suggest your colleague to do this and that I have a slightly different opinion great which is",
        "um I do think we all have a responsibility to educate those around us but",
        "the most significant changes in security are fed down through policy",
        "and so this is really important is it's not just about us as individuals but right about having this conversation with policy makers which she did touch on and this is how we change security fundamentally",
        "for everyone so this is the thing that uh good point the thing that really frustrates me um is we're sort of powerless in we're kind of in the middle so it's either top down like you mentioned it's a regulation it's an act of the the state or it's the person or the company closest to the levers of power so for example a lot of things will never get better unless apple or Microsoft or Google makes them better like we can invent every product in the world to put on top of the operating system but ultimately unless the operating system improves",
        "we're kind of standing still and so we're sort of in the middle we don't create the policy the regulation and unless we are on the development team at Microsoft or Facebook or whatever where it's not getting better either and so we're kind of stuck in the middle and that we get all the arrows oh the security Community you can't fix anything it's like yeah but it's not I I'm not there Microsoft fixing the thing and so I think we might have either have oversized expectations for what we're capable of okay it's not my fault that Facebook can't fix their two-factor authenticate right um love to help them uh but you know so I'm wondering if we're also setting ourselves up for for disappointment and we're accepting all these inbound arrows that really don't belong to us right they should go toward manufacturers",
        "how do you get there how do you get there to the manufacturers yeah to you know incentivize internally to the good right so so maybe if it was more around around I hate to say this but there have been some successful campaigns around naming and shaming okay how come this feature or the company is prioritizing 50 different things and so you're trying to influence them to say oh well I'll just prioritize number 23 and I'll make it number five and then it'll get fixed sooner right and so maybe",
        "maybe you don't feel guilty when there's another outbreak maybe work harder to try to convince them to improve right security so the this one angle which a lot of people basically miss out we are cynical by nature one of the other person also said the same thing the nature of job makes us cynical but the problem is we only Point flaws we keep finger pointing this is wrong that is wrong that is wrong right we never have Solutions we are never on the table to discuss the solution unless you're the developer on the team at the company right so we're just admiring the problem yes",
        "yeah it's fun no but but that breaking and forcing them to fix is something that is actually moved the needle which is very unfortunate yeah but then let's take case of say Twitter there were problems there people found that things are not working the way they want they built mastered in they built activity bourbon whatever systems and they kept experimenting with it that kind of an effort is something that maybe what the security industry needs to start doing build Solutions build some pocs put them forward focus on the solution aspect rather than just because that pay the mortgage yeah exactly there",
        "isn't an incentive to build there is yeah I mean unless you have Goodwill in your heart yeah what is you're not getting paid what is that saying you'll never convince a man as long as his paycheck is from the miseries yeah is tied to not understanding the problem yeah yeah",
        "okay so um so then my question then on that is uh you were talking a little bit about incentives",
        "um and there's also been some work on on nudging right so you're either nudging people in the correct direction to make the right action or you're incentivizing them or whatever what you're trying to do is incrementally when and where you can have people change your behaviors but when you look at a lot of uis and web experience it's all dark patterns and anti-patterns and trying to trick users into accepting the tracking cookie and so",
        "I'm I'm a little bit skeptical about the incentives and I used to be a big believer in them and then I thought the insurance company was going to provide the economic incentives companies would choose a better product because the insurance companies have forced them to said they'll get lower rates they'll do the economically rational thing then consumers will buy the thing like buying the Volvo because you want the safe you know the airbags but that's never happened and so I am if it's not insurance and it's not rational consumers",
        "who are we nudging now we're talking about nudging Regulators policy makers",
        "to do the things that we can't do right so so we're pursuing nudging it's just we keep changing the audience yeah I mean that's kind of what we're doing we're trying to nudge everything possible we're trying to put the stick everywhere whatever works whatever gets us to the Final Destination and so far I think we've exhausted a lot of options not much progress and like Leanne was mentioning policy could be a way we've seen that happening with gdpr we've seen that happening with a bunch of other policies so that could be the way to move forward I want to throw in something something else here do we have a good conversation with software Engineers like each of us who has worked as a security researcher or vulnerability researcher remembers having a good productive conversation with a software engineer to help them understand what could be the good consequences or the of their knowing what happens when their software gets abused yeah you know when the incentive model when you have these giant rant on when you have these giant uh like hyperscalers like Google and their incentive model is to reduce Network latency right more interactivity you end",
        "up with things like well we're not going to do certificate pinning we're not going to do Dane what we're going to do is certificate transparency so after",
        "your horses have run out of the barn we'll tell you your horses are out of the barn with certificate transparency right after you've already suffered the harm we'll let you know there's a lot of data to collect around that they can analyze it they get all this you know Telemetry they can study the web that's great but as a small business I want the barn door to be very secure and stay closed so I like certificate opinion and I like Dane I like all the things that Google didn't like because it was cumbersome or slower or didn't give them the analytics that they wanted but because they have so much outsized weight and they have Chrome they just throw out what they don't like they throw in what they do like and the rest of the world right that's not necessarily what's more secure but what's better for them and and you feel as like the little person we don't have that much like I said that much influence so I want to see you by show of hands people in the audience even though I can't see you um during black hat here how many people are either looking for a job or change jobs or are hiring I wanted to see what the the job turn is very very few well there's some yep some okay by show of hands how many people are totally happy where you're at and you're not looking to move wow that's nice more a lot more happy where they're at",
        "than looking to turn so so Mike my question my follow-up question for the panel here is then community versus industry",
        "so black cat we're pretty much a community Defcon chaos Computer Club b-sides right Community more Community focused um but that doesn't necessarily pay your mortgage right A lot of people come into the industry now through television or they read a book and they're like I can get paid it's paying well you know the stocks are growing and they don't necessarily come for Community or to comment on the latest legislation they come to make money to make money and you know grow their family um do you see there's a do we have a problem sort of socializing people into quote unquote the community or is this normal like Automotive makers there's people that are passionate about making automotives and there's people who are just there to like assemble the thing and go home is this a thing we should worry about I mean I I would imagine it's applicable to other Industries the biggest question I have around that is whether it will still motivate and drive creativity critical thinking",
        "or whether it will push individuals in a slightly different direction so my perspective is this is a common pattern across every industry that you take there are people who are passionate about things there are people who are there to do the job does not necessarily means that they won't be creative they'd be creating creative between nine to five five they'll switch off they'll go back home live the life with the kids with the family and whatever so that's the reality that we all have to accept if the industry needs to grow if we need if we keep talking about skill shortage resource shortage if you want to fill that Gap we need people who are here to work and those peoples a lot of them would not care about how good the community is or even if the community exists they don't care about it they're here to do the job they'll do the job and they'll move on and what I see is we",
        "should not be hostile towards that attitude if you want to keep moving forward keep growing forward that's the attitude we can accept yes this is the reality some of us are passionate not everyone is and that's fine",
        "yeah I can see that sometimes um in in the new generation I'm sometimes I Mentor Italian students who wants to go abroad uh for for this Association and I can roughly make a 50 split between students who come to me and say what's the fastest way to get into security and find a good internship in a top tech company and the other half are like let's talk tell me what you do why you like your job and so on right and usually I answer both of them with the same the same answer I say try to look around the community try to orient yourself into what we do into what conferences and so on and then what I get is the 50 who came with an open mindset they keep going with open mindset and in the first 30 50 who came with you know I want to do an internship I would say that another half of them will stick to ask me yes but I want to do an internship and then maybe 25 percent I sort of convert them into thinking first about what they really want to do your um your comments reminded me of uh in the early days of the internet cyber security sort of Revolution there was this big split in the people um that were sort of professionally creative and naturally creative right and um and this is kind of something that happened in the I guess you would say the 40s or the 50s in America in the ad industry where people who would create advertisements and that's because they were great at it and then it became an industry right you cranked out you had to be professionally creative every day of the week you had to go to Disney or wherever you had to make you know creative pieces of Art and same thing sort of happened with hackers there's people at incredible exploitation or understanding but they can't do that every day that's not their thing and so then you had this split between the quote-unquote the sellouts right the anti-sec movement oh you're a commercial infosex sellout you're doing that you know to get paid um you're not doing it because that's what you love right and and so bad attitude is now a long long gone but it reminds me there's some people that can only be creative in coding when it suits them and there's other people that can sit down grind it out for eight hours a day right yeah but I've seen people who are creative especially because they're limited to eight hours like you will burn out when you do over hours for too long so I wouldn't say like everyone who says I want a nine-to-five job is not also loving their job so so it brings up another thing and this was a secret one I did not tell you about but it's it's related is um the generalist versus The Specialist so how many here in the audience here with hands would you consider yourself a generalist raise your hand",
        "okay now do you who considers themselves a specialist like you are the Ida Pro Ninja",
        "oh oh close to equal maybe a few more generalists",
        "and so for the longest time the generalists we're dying off all the money was in specialization right how deep how far you could get how well you understood the technology really controlled your next paycheck and the generalists kind of outclassed because they could never get that deep and I think that's changed is it anybody have perspective on that I remember seeing a um a comment on LinkedIn about a person who was looking for a job and he was sort of a toning down this aspect of being a generalist and he was saying I feel myself as a generalist I'm good for those hard to feel positions I don't think is negative aspect at all I mean having deep generalists in in key positions now is much needed because we have good Specialists we've been having good Specialists now we need to sort of glue them together in a strategic way so this reminded me of talk you and your research where effectively the idea was that you",
        "can either be a generalist or a specialist but if you are going for a specialist position you have pinpointed focused and that does not means that it is going to run the entire thing to run the entire company you not only need pinpointed Focus you need journalists and now more than ever we need more originalists around so yeah journalist is a way that people should be looking for and the other angle of it is and including the part about working nine to five and investing time in other things creative process can also draw Inspirations which are not from infosec World you do gardening you do something else and that can give you the inspiration to do better job in your current uh work area so being a journalist being able to explore other areas could be another good thing it's not like this is something you should not be doing I'm sort of surprised at the audience response because I know plenty of people that have shifted slightly throughout their career so I'm really surprised that there were so many people who said I'm a specialist but I wonder whether if they look at their career whether they have done different versions of a thing and therefore also have this broader skill set",
        "you could ask them the question yeah is that the case or have you just been how many people have been doing the same specific area of work for out throughout",
        "their career",
        "two three four yeah there's a GDP people",
        "yeah",
        "no offense",
        "okay so we're going to move on to the next subject and then we'll move it to audience questions um and this is kind of a a perennial centralization versus decentralization question right um by centralizing you get economies of scale you get efficiencies you get one spot to monitor I think I made the comment yesterday when Russia invaded Ukraine and Ukraine has certain infrastructure on Microsoft Russia now has to battle in Microsoft's territory right that's great in the sense that that those economies of scale um in centralization for their infrastructure but you also have these very convenient uh places to be regulated right when everybody ran a mail server harder if there's like five dominant mail servers and they get some order to filter nobody can ever send email to China or something now it's it's convenient for regulation centralization breeds I guess uh what lawyers would call an attractive nuisance um it's very attractive to regulate it um so I'm curious on the audience's thought we always you know the internet was sort of began decentralized economic models forced centralization is there any hope for decentralization that the thing people point to is DNS but look at what's happened there quad one quad eight right I mean it's centralized again right even time services are centralizing right so should we get over that should we stop telling these myths of the internet being designed to withstand nuclear war or should we actively be trying to create more decentralization",
        "I know you've got a thought I mainly want more people to go decentralized yeah the hacker in me wants decentralization I want people to have autonomy over their data and over their servers and maybe internet speeds have gotten so great that the benefits of centralization of decrease to the point where it's less noticeable like in the olden days it was very noticeable but maybe yes maybe we're fast enough I mean there is multiple angles one the internet speed has increased it gave more access to people resources are more prominently",
        "available what I don't expect is everyone in the world running their own no that's right yeah that's impossible but people who are technically capable right now running a web server from your home on a Raspberry Pi is not a problematic Affair",
        "it's like you spend a few hours you can get things moving exploration",
        "the whole creative aspect that could be the input the Indie Web the whole idea about setting your own websites having your own blog not being controlled by a central Authority with the whole moderation and picture is what excites",
        "me personally but it's dangerous I mean if you forget to apply security updates in the end like you might lose your data yeah like I can now choose yeah do I give all my data I don't know to Microsoft Google Apple or do I host it on my own and now I have to check every day is there a security update have I been preached is my data now like not with the big companies but did it not get to anyone maybe maybe if more people self-host it will auto check for updates faster this one other angle around it it's the cynical in us which says hey I'll get hacked I'll get compromised things are going to go bad when we are going towards centralization are we 100 sure things are not going bad there we have examples where cloud service providers with the whole responsibility we're running like five-year-old software yeah yeah so it's",
        "it's not like just moving the responsibility on the other side is just going to cover everything",
        "Jeff I think romantic idea haven't you about grass",
        "Roots Uprising I am a sucker for the Grassroots Uprising and it could be from reading what is it the Shockwave writer or Neuromancer or whatever it is the early days it was very kind of romantic right the power of the individual and in the early days individuals made the largest contributions yeah right the breakthroughs and I remember years ago I was talking to some of the if you remember the Cypher punks were this kind of movement of of kind of punk cryptographies in the Bay Area that really",
        "move the needle on privacy and anonymity and then it died out as the.com bubble grew and they got jobs and then things became more commercialized but I remember talking to one about 10 years ago and I said I want to cause some I want to be chaotic like what can I do as an individual can I run a remailer do I run tour nodes like what do I do if I wanna and they said you know everything's done in teams now you need like a team of people to develop the software like that the time of the individual making a big contribution to privacy of security is kind of over and that really depressed me for about three or four years and now I realized no they're wrong some of the contributions are still being made by the individuals by individuals yeah it is much harder now though to just do your own and it's more based on luck I think you're sort of at the right place at the right time when people need that thing that you've built sure um the other angle is the pr part mastered and existed got the pr when some other disaster happened right so the people were working on it it's not like no one else was working on it the work was going on it was not promoted it was not publicized yeah so we're talking about Mastodon the most popular version of a Federated service right on the activity Pub protocol but it's been around for five years yeah and only until somebody starts mismanaging Twitter to people waves of people look for an alternative a plan B and there it is Plan B and all of a sudden they have their moment yeah but for five years they were not definitely not having their moment yeah because neither they were interested in promoting it nor anyone else was interested or incentivized to actually talk about but they kept working on it despite yeah they were still working because they liked working on it I'm not working on it right but now they're gonna have like three years of development in the next six months I mean they're gonna get so much attention right um but is that then the dawning of a potential movement toward decentralization somebody will improve on that some VCS and the value will say I'll do a better job and they or is this just like the one-off weird mutation and then we'll go back to when the next person who runs Twitter who's saying right we all go back to our centralized ways when the next person buys Facebook or LinkedIn yeah yeah because I worry about um centralization around DNS around you know you can't do much about routing but use of centralization around rpki and um or the holders of the keys that control rpki and I've just just",
        "there's the trade-off and there's the regulation and I just feel like what can hackers what can we get what can we do for our own plan b or do we just say you know what there's no more Plan B we're just on whatever",
        "I mean like I said about mastered and you need to keep making efforts or or the entire activity protocol because there's so many softwares around it the part about incentive or internal incentive comes into picture if you feel that you have something that that's different work on it well so the thing and we're not going to beat this do the dead horse but the interesting thing for example with Mastodon is there's a lack of an algorithm right so if Twitter or social media is optimized to generate interactivity that algorithm is missing so then what happens with it missing how do people behave differently right so it's not a race to get the maximum likes it's not constructing an attractive post that gets you the most retweets or whatever it's it's different",
        "um and the downside though is there's no monetization there's no influencers there's nobody to get paid and there's no way for the administrators of these servers to get paid yet so I have a feeling we'll see if if a decentralized model can work we'll see introduction of some monetization so server operators can get paid because not getting paid means there's a million teeny instances if you can get paid they'll be larger better more professionally run instances and if you can monetize content providers somehow then you have professional creatives coming in more likely to share so and if if you can do that without the the toxicity of the algorithm then then I think you have a viable that's a good thing yeah I'd like to see something that incentivize administrators of method of nodes to host good Services because you know now they're not getting paid essentially they do it for free just because they want right there are instances maybe another spin on the monetization aspect is not only on the content production aspect but also on the platform and infrastructure management which good question by show of hands who here runs any kind of service so for example Defcon We Run Tour nodes and we run a form for over 20 years okay who runs something that helps the community 20.",
        "thank you thank you for that everybody who's taking advantage give them a round of applause that's right",
        "I think that's the that's the way forward right the people who who want to can provide the services",
        "[Music]",
        "[Music]"
    ],
    "4TopXiSkseU": [
        "foreign",
        "good afternoon oh quite quite busy room",
        "uh if you need more seats I have some extras here",
        "uh yeah so but don't be here just just you miss it all right so let's get started so in this session",
        "in this session we going to cover Microsoft Defender for office anyone",
        "work with Defender for office for upstairs cool",
        "because when I asked that Microsoft Microsoft conferences everyone raised their hands but if I ask them do you know what a virtual is they're like uh what shell so Defender for office",
        "the defender first is 365. um evasion that was the session after my uh discovered vulnerability in that service and I'm going to show you how it was um how I did that how Mike has to fix it maybe they didn't fix it let's we'll see we'll see",
        "few words about myself my name is Sergey",
        "I'm a security consultant instructor",
        "conference speaker",
        "um if you by the way most common question do you have a Twitter no I don't I don't I prefer LinkedIn so I'm too lazy to write something down LinkedIn I'm a Microsoft MVP in security and many many other certifications uh just try to guess where I'm from",
        "Netherlands oh",
        "oh",
        "okay",
        "uh so yeah I do have Armenian passport as well but I identify myself as a Russian so and I say that everywhere and when I go to the conference sometimes I get feedback you know they send feedback to me with commentaries and so that was my favorite commentary I ever got thank you",
        "uh here at black hat they will also send me commentaries so please you can do it even better don't make me sad uh all right so uh I what what I'm going to do in this session not going to just hack something and show you slides about this I'm going to give you many demos I prefer live demos and so you may expect many many demos if something goes wrong with demo you know it might happen I have a recording just in case so let's take a look at the agenda agenda first of all I'm going to show you what Defender for Office 365 is and the feature that I'm going to show you is called safe attachments really quickly because I believe most of you know what it is but I want to make sure we will build on the same page next I'm going to show you something that Microsoft doesn't tell you about this sandbox so that's a Sandbox but they don't tell you what it is what exactly how exactly the sandbox work I'm going to show you after that",
        "how I buy attackers or me whatever how",
        "attackers can bypass this safe attachments and how Microsoft respond to my",
        "submission",
        "uh after after that we're going to work with safe links pretty quickly so that will not be the main part so safe links and how we can also bypass safe links protection all right good to go so very quickly to make sure that everyone knows what it is if you haven't worked with Microsoft Services before or haven't worked with this service Defender foreign",
        "specify that's the number of features to protect your collaboration and email and Communications so it can protect when you send an email oh by the way I should have that note oh it's working so if you send an email to office65 or you send the teams attachment attachment in teams or you open Excel or documents or upload files to SharePoint what will happen in parallel",
        "um this document will be opened in a",
        "special sandbox",
        "and this sandbox don't have doesn't have any protection",
        "no protection just a sandbox and some kind of tools based on machine learning will analyze what this attachment does in this sandbox so example if attachments start to encrypt files documents on the sandbox hmm it is not very good right or Depends for whom um but anyway so we opened that",
        "micasa opens that in a special sandbox let me quickly show you how it looks like on a Microsoft webs on a Microsoft security",
        "in micro security Center so if I go to to one moment",
        "here",
        "um let me Zoom it a bit and scroll down to save attachments",
        "I have a policy let me see create new call that BH ick next oh I see I can see it here type username I want to protect it doesn't really matter and here I can choose Behavior so Behavior will be just monitor or block means block attachment and an email itself another one replace so block only attachment but keep the email and dynamic delivery which is like block attachment but delivers email immediately without so email will be delivered immediately attachment will be reattached so that's it that's all that Microsoft says to us about safe attachment just use it and you'll be safe that's it and quite often many people that work with Defender for office even those who work for Microsoft anyone here from Microsoft no all right so even those who work for Microsoft they really think that this attachment is something something something special that something that micro Secrets but especially for this service",
        "um let's take a look what what it really is let's think about one moment if attachment will be opened in the sandbox what if what if we send something to the sandbox to enumerate",
        "one example very stupid reversial",
        "so I mean of course it's more document so if I send something like this um oh this button something like this to the sandbox and that will be my reverse shell",
        "maybe I can get a shell we'll see or another example what if I if I send if I send Powershell script files and partial script and this partial script using using wmi enumerate the sandbox and then",
        "um so Powershell must be zipped and then send me an email to one of my mailboxes",
        "in this case I can gather some information about the sandbox",
        "wanna try",
        "let's try",
        "um so so so",
        "I have a listener",
        "and now I need to send email I",
        "do you want to see one funny thing when I try to send an email from here look what happened",
        "so I'm going to send an email from my remote machine if you don't mind",
        "who did it that wasn't me so I'm gonna",
        "um use my remote machine let me say send a new email that will be M Smith and subject will be whatever BH",
        "and the most important I must add attachment so attachment should be somewhere on my desktop BH and the first will be strick one",
        "all right so now this email oh by the way let me show you first show you what it is",
        "that whole big cell Excel Excel and if I go to developer mode",
        "I will find this very simple reverse shell",
        "so let me first test it I'm gonna",
        "say um I want to",
        "ah",
        "let me say in oh let me round again let me open that again",
        "enable content",
        "and now I should get a show so a document is working now I want to break the show and this time I would like to send it to the sandbox",
        "uh so open it up compose",
        "that was sent",
        "and here is my mailbox",
        "come on can you accept it here at least",
        "uh let me check which address I used maybe it was the wrong address",
        "compose",
        "no that was right that was correct",
        "hey come on",
        "which corner other screen",
        "uh no that's a different one that's a different one uh all right so if you don't want to do it here I'm going to send it to different address because I have some spam policy oh wait a second",
        "and oops uh where's my yeah I have two screens here correct uh this one",
        "let me say try again this time I'm gonna come on yep",
        "and remove that all right so let's try again this time different different address",
        "and that will be the same file",
        "strike one and",
        "click Send",
        "and let's take a look I hope this time it should be fine",
        "because I already used that email address for the previous one for to send emails maybe it now blocked me in that tenant",
        "how about now",
        "not again",
        "that's funny so those email addresses did not work anymore",
        "all right so what we do in this case if it doesn't work in live demo",
        "of course show video so it looks like I will show you many videos today uh if I cannot just simply send an email so it looks like I'm gonna send you I'm gonna show you many videos all right then",
        "um let's chh",
        "let me find this moment",
        "um and let's take a look",
        "um now I'm saying something there",
        "uh probably and now when I send an email it's hap it just scanned in progress right so scan progress now if I go back to to my",
        "oh that someone tried to connect to me in parallel and in a way um and now what we should we should have",
        "I should have should have",
        "do you have higher speed the speed oh here we go so look at this now I just want to make a pose so that is the sandbox",
        "what it is",
        "it's just Windows 10 machine",
        "it's just windows 10.",
        "so it's not something unique and super special it's just a Windows 10 machine",
        "let's take a look",
        "um how this machine uh how how this machine look from inside so from inside it's just Windows 10 machine it works on hyper-v",
        "and not it's not really in Azure because Azure has limitations to deploy those templates so it just machine and hyper-v and it's only one gig of memory it used to be one core then they also create fake user and decoy content why decoy content I guess for to test run somewhere because they will analyze if those files will be encrypted so they will see that those it was encrypted so it also has a number of applications like office Adobe Reader on the next slide I'm going to show you a bit more uh and number of custom tools so and every time every time when we see this instance by the way test that from the hotel yesterday it used it used to work used to deliver the email at least so um every time instance is the same the same so they don't don't change the operating system version they don't change any software they don't change anything it's just a new template with like fresh template but this but from this they deploy instance from the same template every time so we have software",
        "um Google Chrome Firefox um basic edge browser office applications even project and video and number of C plus plus and so on distributables",
        "so different code may run there",
        "um and we have number of custom tools",
        "those custom tools",
        "it's just a bunch of dlls um don't ask me to reverse Engineers on them because it's like terrible gigabytes of data uh just number of number of tools that Microsoft create or maybe Fiddler is not Microsoft but most of them are by Microsoft at least I I don't know them about them I haven't seen them on the market so so uh now do you think um if we know about this if we know about",
        "um what what what's inside if you know about what's inside we know about software we know about other tools how can we bypass the sandbox yep",
        "fingerprinting all right and after that",
        "wait so the first commentary was I know to to make it to record that I need to repeat that so just to add a sleep instruction like wait uh it will not work they if if they cannot if they see sleep instruction they mark this file as not trusted so I tried did not work and that was that that's not the most obvious for sandboxes but this one didn't work um what is the most common bypass evasion technique after sleep",
        "um so to know the configuration of sandbox to find the difference between sandbox and the normal workstation and do not execute in this sandbox configuration if we know that machine virtual machine has some specific build of windows",
        "and then number and amount of memory and number of processor cores what you can do we can create our script I mean I mean our payload with this condition and do not execute in the in the sandbox so look at this uh by known configuration attacking generate script macro that will not be executed",
        "in in the sandbox",
        "and so in this case what I did for uh what what what we can do execute oh sorry um we can execute code only if amount of memory for example larger than two gigabytes and here is",
        "um example of old macro old macro here is the macro with evasion",
        "so we use using wmi we find out number amount of memory",
        "and not and and just any stupid condition but I just say here if amount of memory is larger than two execute my script I mean reverse shell if smaller I just want to say not enough RAM",
        "make sense",
        "so and I submit that to Microsoft",
        "I submit to Microsoft and that's what I got from them",
        "so it was very funny email because the email said email said uh so where is that the issue was by Design",
        "let me just go there It Is by Design",
        "so sandbox uh vulnerable by Design is vulnerable by Design",
        "Center is vulnerable by Design so um it means that and the most funny there it was by Design but",
        "we're going to take action to improve security of sandbox",
        "it's like we're not going to pay you but we accept your report",
        "and we will do something to fix it and your reward is your reward is uh recognition on the portal",
        "cool",
        "at least I don't need to pay taxes from that",
        "um",
        "I hope",
        "look at this it's very old version",
        "anyone has this version of Windows",
        "just let me know",
        "so that's very very old so probably not none of the users will have this uh this version now what we can do instead what they can do let me find the video this time again uh where I made those fixes so uh",
        "where is that",
        "so",
        "Windows build oh by the way when we run System Info it just shows most of versions of Windows and what we can do look just a different wmi uh www my class",
        "and here I can say so first in first script on this one I can I can run by the way I didn't need the email I didn't need to email that so first I can do first first first what I can do uh where's my strike to",
        "uh developer mode",
        "look at this so this this will just detect the version of operating system and and just show me the message box let's try if I say like that macros disabled thank you one moment I'm gonna do it again this time enabled",
        "enable content and look at this so that is my build my build 22 621",
        "if I do the same on my remote machine on my remote machine then it will be something old I guess",
        "at least older",
        "so that is 19 something something",
        "so now the the new new script will look like this",
        "um",
        "is that a new one",
        "uh so now let's say if if",
        "um the windows build is smaller than lower than number lower than 20 thousands uh then give the message box the build is too old all right so let's try I need to enable macro of course",
        "so no no complaints here up to date",
        "and if I do the same on my remote machine where build is a bit older",
        "is too old now the last step",
        "instead of this message box oh no instead of the previous message box we just add our reverse shell",
        "um again will not be oh let me let me show it to you here so if I have",
        "what it was",
        "I got an email really to which mailbox and here uh",
        "uh I don't see the email but I got a reverse show at least",
        "so it's working so all the things I showed in the video still still works I didn't know where me oh oh I I know I know yeah I know why there's no email uh the reason why it's no email we have uh quarantine policies and if it detects malware it removes that right right after delivery uh I'm not sure which what was the mailbox and why we haven't seen it during the delivery but at least we see that it it used to work so we get a reverse shell and that was yeah it's not video look it's my Kali machine that's me so now if I send an email",
        "and this time I will have",
        "a windows up to date so uh",
        "windows up to date",
        "and if but file I want to send is the last one as developer",
        "now so if the version of if quite is quite new like larger than 20 thousands then we execute the shell and if else MSG box for ss28 so guess what in a sandbox in a sandbox it will see message box is message box something dangerous",
        "shouldn't be of course it depends what they say but",
        "but it shouldn't be but on the on most operating systems it should be executed normally and",
        "that should bypass protection so let's",
        "try again I don't know which what was the mailbox let me send two emails I don't know which which one was accepted let me try to send them if not again I have a video you know so uh let's just send that to",
        "here and say BH again",
        "and home run",
        "and send that",
        "and come one more email",
        "and BH again",
        "and home run",
        "send so somewhere I should have I should get delivery um and for the sake of time for the sake of time let me oh yeah what",
        "One Moment One Moment",
        "nothing here",
        "so look at this scam progress by the way while wait for the scan I can give you one offering",
        "how about uh horse bit no dug bit",
        "so anyone 100 on that number one",
        "or you prefer British ducks",
        "uh by the way uh this duck number one is Donald Duck",
        "so uh 10 seconds",
        "10 seconds now",
        "eight any 100",
        "no",
        "oh look at this anyone hear from you asked no one oh one sorry about that uh all right so let's take a look what we have with steel scan progress",
        "uh so don't you mind if I just move on and get back to it slightly later and you'll see like a new email in the mailbox because we have we have just a",
        "um just one more demo so was it clear about sandbox more or less how can we bypass it's still work uh oh that the most important",
        "no way and and don't submit that as well so they don't pay I know uh so uh one more thing that we can also test while we wait for oh we also have here uh the email skill student progress",
        "what we also have we also have one more one more feature is what is called safe links so let me show you what safe links is I send an email to myself uh I just want to find the right window send an email to myself with a link so Microsoft has another feature called safe links when you click on the link in the email what what must happen",
        "look come on",
        "it used to work just right is it the right one no that's not the right one sorry um",
        "the right one should be somewhere",
        "um somewhere somewhere somewhere here yeah",
        "oh yeah so they say hey don't go to this website because this website is malicious and just we don't allow you to go there and yeah when you just start to click on the link from teams from email it doesn't allow it doesn't allow them to do it how can we bypass that very easily to be fair we need to take that link outside of the vendor for office system the easiest way to do it is to create middle tier so let me show a few examples",
        "um for the sake of time I already sent those emails if you don't mind I'm going to use existing emails uh so first what I can do I can create the meet my own website that will automatically redirect to malicious website so my mine's fine but it will just redirect",
        "and now look at this yeah it's still browser that blocks me browser but not the previous that but not the fender system so not not this one but the browser so now we bypass one of the layers and if you if we use third-party browser like any other browser they may not block it because they have different protection that's one of the way another one maybe uh so it may redirect or we can create middle tier and ask user to click so choose whatever you want it will forward it to the same website so that's the way to bypass safe links as well all right let's take a look what do we have in my mailbox",
        "when I check that this it contains the my my favorite show I'm not lying let me download that",
        "uh home run documents",
        "let me close all of the Excel Windows first",
        "Excel where are you",
        "all right and",
        "so just in case showing you that it's like my documents not any other folder",
        "and developer mode visual oh thank you",
        "so",
        "let's try again",
        "oh it's here",
        "enable editing",
        "oh thank you Excel you're not you're not that you're smart so but from the email I was able to deliver I was I was able to bypass Defender Defender for office I mean and",
        "that's it so that's the file with reversial",
        "all right now quite common question well we have four minute and 43 to one second",
        "uh quite common question what should we do how can we mitigate that",
        "and I would say for this specific vulnerabilities I don't know how to mitigate this specifically so um the only thing you can do is to have have more layers of protection I guess you heard the defense and death so you saw that I bypass the email protection but Excel said no way I'm not gonna I'm not going to run it so when you have those multiple layers that may help but this specific vulnerability is I don't know maybe submit it again to Microsoft and don't get paid again and maybe after a few iterations they finally do something but they will they will they will they",
        "will update their sandbox for example and you will not be able to use operating system build then made then they add more processor cores so we're going to rubber them all right so so so so so um we have three and a half minutes any questions",
        "[Music]",
        "[Music]"
    ],
    "C3ta-uUthfA": [
        "foreign",
        "today I'm gonna talk about perfect spray which introduces a new type of logical flow and how to apply it to the Linux color hip exploitation",
        "first of all I'm currently PhD student in Southern National University and I'm a team member of team gyg we focus on CTF and bug hunting if you have any question about this presentation feel free to contact me using the same email so let's start for attackers the strategies of an",
        "attack is one of the most important requirements when launching the exploitation this is because if the exploitation fails the attack could be cooked by the defender for example if",
        "the exploit is failed Quest information is located locked so that the defender detector attack triers",
        "maybe it may even be patched by identifying the loot because of the zero-day pernerability",
        "in addition if the targeted application is corner it's pretty fatal leads to the corner Panic which is very suspicious symptom that Defender can notice",
        "therefore the attackers are highly motivated to improve the success rate of their attacks",
        "so let's start with my motivation that",
        "why I research the method to improve the success rate of exploitation",
        "last year I found a strange vulnerability this bug is it is covered through this color which is a Linux color I thought this bug could be exploited for information leakage this is because",
        "this bug is difficult to use after free vulnerability which write a counter pointer to the freight object",
        "explaining this type of user-free vulnerability is simple we decided to",
        "decided to use a message message structure as an overwrapping object message message structure has a data and",
        "it it has a function to transfer the corresponding data to user space",
        "therefore we use message message structure for explorating the process of exploit starts with allocating the parallel object then",
        "freeing the Paranormal object and allocate the overlapping object at the same address as the vulnerable object and then if we trigger you just for free the data area of message message structure is overwritten lastly if we",
        "execute the transfer function of message message structure the corner transfer the overwritten color pointer to user space in other words the attacker can lick the corner pointer",
        "however we think our exploit is perfect",
        "but the liability of the exploits is horrible testing this exploit a thousand times it",
        "only shows about 13 success rate at this time we thought the exploit had a problem however however no matter how much we think about it the problem was not sin because we follow the typical process of user-free exploitation",
        "meanwhile we knew that the corner hip",
        "mechanism was different from the user hip mechanism and we began to wonder if",
        "if this might be a problem so we started to analyze the cleaners",
        "Corner Hema locator",
        "Linux has its three different hemo locator flap flap and slope however",
        "Linux used slower locator as a deferred human locator therefore we analyze the mechanism of",
        "slope allocator",
        "I think",
        "most of you are familiar with user applications Hiba locator therefore here",
        "is the big difference between user applications here allocator and syllable locator user applications he will locator use a hip address hip area and if there is no",
        "space application increase the Heap area and use it on the other hand Global locator uses a single unit called flap",
        "which consists of one or more pages and the feature of the slab is non-consecutive",
        "and there is a slab cache slap cache is Australia Storage storage for a specific",
        "type of object",
        "flap Cache can be classified into General cache and special cash",
        "General cash Representatives the KML log",
        "series which classifies the objects according to the size special guests literally represents the",
        "special object such as task struct",
        "each slab belongs to specific case cash and that is the flag is used to allocate",
        "objects that belong to that flap",
        "let's do a deeper analysis what happens",
        "if there are multiple flaps which belong to one slab cache and what slab will be counter you will be the where the color used to assign the object to answer this question we need to note how the corner manages the slabs first the corner manages the slab by each slab cache and then too many to manage slept",
        "efficiently slope uses perm CPU",
        "mechanism and per node mechanism therefore there is CPU slab and node",
        "each CPU has a free list page and partial page and node also has a password page and page and password page contains",
        "flaps",
        "and the CPUs free list has a linked list for the print object in the slab which is the CPUs page all of the allocation is done by using the CPUs free list",
        "and then we analyze the allocation mechanism of slab as we operations all of a location is done by CPUs free list therefore if we allocate an object",
        "flop or locate an object from free list and what the color does if the cpu's free list is empty the answer is the color updates the free list from CPUs page and what happens if we assign our object in CPU CPS page",
        "if art of object in flat is allocated then corresponding flap is moved to full list then the color moves the CPS password page to CPS page and update",
        "the free list for objector location once again if we allocate our Arrow of the ncpus page corresponding slab is",
        "moved to full list at this time if the corner tries to allocate the object the corner moves the doors posture page to CPS page and update the free list lastly what the corner does if the CPU is released page pressure page and those",
        "project page are empty the corner calls a body allocator to allocate new slab then the corner moves",
        "the new slab to cpu's page and update the free list",
        "now you will be able to understand how does love allocator works so let's let's back to the motivation with the knowledge of love we analyze the vulnerability with the perspective of object's allocation",
        "the vulnerable object is allocated in kmlog 4096",
        "and the system code which called locate",
        "vulnerable object or locate Seven additional object and kmlog 4096",
        "lastly each kmloc",
        "4096 left contains eight objects",
        "did you notice what is the problem of low reliability",
        "I said the system call which allocates vulnerable object allocates seven additional objects it means if cpu's",
        "page contains at least one allocated object the location allocates our object in CPUs page",
        "and then corresponding slab is moved to full list and partial page is moved to a page and allocate less object in that slab at this point the important thing here is cpu's page is changed to another",
        "flap",
        "how do you think that the CPUs page change affect to exploitation",
        "ASI of formation the general",
        "exploitation mechanic method against UW",
        "flea is freeing the vulnerable object and",
        "locate",
        "overreacting object at the same address as the Bernal rules act however since the cpu's page is changed the color or locate the object from the current CPUs page in other words the",
        "overall thing object is allocated located to the wrong area",
        "to summarize the problem of low reliable reliability of this vulnerability the",
        "system call which allocates the parallel object allocates seven additional objects and the number of objects in one slab is eight objects",
        "if the slab assigned to",
        "cpu's page contains at least one allocated object the CPUs page is",
        "changed and leads to fail for allocating",
        "over overwrapping object at the same address as the Paranormal object thus",
        "to successfully exploit this vulnerability the CPU page should not",
        "use any object",
        "then the CPUs page is not changed and the attacker can allocate over a big object at the same address as the bernoullable objects",
        "then how to know the slab is not used we organized",
        "over this question in many ways after",
        "much anguish we came to one conclusion",
        "we thought that if the attacker could know the allocation status of this lab he could solve this problem",
        "this conclusion is concluded to another question how to know the allocation status of this lab",
        "the best way to know the allocation status of this lab is that the corner provides the information about slap to user",
        "however unfortunately there is no",
        "function in this corner which provides the information about kernel in other words there is no method for users to know allocation status of the slab",
        "so we thought a lot about finding a methods for the user to know a location status",
        "actually we didn't we did not think a lot because we already found a method when we analyze the slope allocator",
        "let's go back to the allocation mechanism of slower locator this figure shows how slow slop allocates an object",
        "please track down this lab Dot",
        "the first pass is if there is over deck in cps3 List It allocates object directly and the medium pass one is if there is no object in CPUs free list it promotes",
        "objects from cpu's page and allocate an",
        "object medium Pass 2 and 3 is that the slope",
        "moves the CPUs or no spotter page to CPS page and from us object and allocates",
        "lastly flow pass is creating a new slab",
        "using body allocator and moves from us and allocates can you find The Logical flow in here",
        "I give you a hint let's see one more time Fastpass",
        "medium press one",
        "medium pass through",
        "we don't pass three and pass",
        "[Music]",
        "did you guys catch it flow pass is much slower than other passes this is because slow pass create create a new slab using body allocator",
        "creating a new slab is accompanied by mapping unused memory and as you know mapping is very slow task therefore we",
        "think flue packs can be distinguished with other pests using timings art thinner and if flow passes executed we can",
        "notice unused slab is create created and one",
        "object are located in corresponding slab",
        "that is the user can notice the allocation status of current flap",
        "to prove this Theory we simply made a",
        "POC code",
        "the code includes allocating Corner objects thousands time and measure the performance each allocation",
        "and compile it and executed",
        "you can find it's almost measured performance is higher than others",
        "let's see these results as graphs",
        "the first figure is the leaders of total thousands on location Even in our class you can notice that the performance differs between the slow pests and other passes",
        "the second figure shows the location from 300 to 400.",
        "what we should focus on here is that flow pass is executed at regular",
        "interverse",
        "this is because came along 2048 slab contains 16 objects in other",
        "words it can be seen that better performance is not caused by noise but caused by a slow pass",
        "using this discovery we have created a",
        "new exploit technique called P spray",
        "is the technique that utilize the timing side Channel using logical flows in slow location mechanism",
        "ultimately peace pray aims to improve",
        "the reliability of the corner heaviest exploitation",
        "let's back to the case it allocate one burnable object and",
        "seven additional objects so to prevent the CPUs page is changed it needs unused slip",
        "first using p-spray we find",
        "when a new slab is created that is we better the performance for our location and catch the moment when a higher higher measures performance comes up compared to other measured performance",
        "at this time since slow passes executed CPS page has a new slab and corresponding slab has one allocated object but we needed we need a new slab for successful exploit so a location to fill",
        "corresponding flag",
        "after that since slab is fully allocated so corresponding slab is moved to full list and CPU space becomes empty at this",
        "time if we execute the system call which",
        "allocate bernoullable object the corner create a new slab and allocate one vulnerable object and seven additional objects then freeing the bernoullable object and allocating the operating object to the same address as the bernoullable object if there is no noise the experi will be successful because cpu's page is not changed",
        "so we measured the success rate of exploitation which utilized pea spray in",
        "conclusion the success slate has increased by about 80 percent",
        "the reason why success rate is not 100 is due to noise for example another",
        "process is scheduled and allocated an object during exploitation it interferes",
        "the exploitation",
        "for proving space is not ethical",
        "technique a specific case we evaluate five more vulnerabilities and the",
        "readers show shows oral success rate is",
        "significantly increased",
        "uh while looking for a Target to use PSP spray I thought it could be applied to out of balance vulnerability",
        "currently the exploitation of out of bounds have a very low success rate due to one mitigation",
        "the mitigation is called slab freely slendum it randomized our allocation order when",
        "a slab is created that is before this configuration is",
        "applied to the corner the allocation order was sequential from the beginning",
        "however after flap freeze free this",
        "London is applied the allocation order is randomized",
        "how do you think that the location order is randomized affect the exploitation",
        "as you know out of bound paranability corrupts the very next object from the Bernard object therefore the attacker needs to place the target object next to the partnerable object to this end the techniques such as hip fungsu is invented",
        "however after this mitigation is applied previous technique have becomes obsolete",
        "as the allocation order became randomized it became difficult to place",
        "the target object next to the bernoullable object moreover since the attacker cannot know",
        "how many Target objects is allocated in the current flap it increased the failure rate in other words we judged that the reason for the failure was that an attacker didn't know the allocation status here we thought we can avoid the circumstance that we don't know how many Target objectives are located located",
        "to the current flap using p-spray",
        "first using peace pray we can find when",
        "a new slab is created that is we measure the performance for our location and catch the moment when a",
        "hired higher measured performance comes",
        "out compared to the other measures performance",
        "at this time since slow passes executed CPS page has a new slab and corresponding slab has one allocated object so we are located seven objects to fill corresponding slab just like you'd have a free case",
        "after that this slab is fully allocated so corresponding slab is moved to full list and CPU space becomes empty",
        "then we allocate seven Target object and",
        "one parallel project to the new slab please note that the allocation order of Target object and vulnerable object is unrelated unrelated to the success",
        "at this time the vulnerable object will be of the day sent to the Target double deck with a very high probability",
        "and note that even if we use P spray the X3 really failed if the bernardovic is",
        "placed at the edge of the slab",
        "we evaluate peace prey against out of",
        "bounds with four vulnerabilities and the",
        "results shows are of success slate is increased please note that the success rate even using pea sprays does not reach 100 percent is because the bernoullable",
        "object may be placed at the edge of the slab",
        "so let's summarize when the vulnerability is used after free if the system call which allocates the parallel object allocate additional objects the page the CPUs page can be changed if CPS Pages page is changed the typical",
        "you'd have the free exploitation may be failed however using display we can make a",
        "circumstance that CPU space is not changed so that this spray leads to exploit success",
        "and against the outer bounds the problem",
        "is left freely slam them moreover since",
        "the attacker cannot know the allocation status flat 3D slant them hopefully mitigate the Paranormal object and Target object is an adjacent",
        "however using p-spray we can fully allocate over text in one slab so except for the one case when the Bernal over object is located in the edge of slab we can successfully make the bernoullable object and Target or reject adjacent",
        "for the conclusion",
        "we introduced the new technique which",
        "combines previous coronal exploit techniques with",
        "timing side Channel attack or so we applies this prey from the perspective of use after free and out of bound but I think this technique can be applied to on another area personally I hoped this technique and",
        "this technique will develop further",
        "lastly I think this type of logical flows are exist in Linux corner or else",
        "because many developers do not consider the time size Channel attack when develop a software so when analyzing the coast please see",
        "the code from various perspectives",
        "please consider not only the memory caption parallel abilities but also side Channel attacks",
        "this is the end of my presentation please feel free to ask me a question or send me send me an email for your question [Applause]",
        "[Music]",
        "[Music]"
    ],
    "pOuzZzNmqFY": [
        "foreign",
        "[Applause]",
        "hopefully that's not the most impressive thing you'll see in this session um so I'm Jeff Moss I'll be the host this is our lock note session the first day and what we're going to do is in this little blue book we've got some topics we're going to talk about you're going to listen into US debating each other and then we're going to break it out into the audience and start involving you in the conversation",
        "got a microphone on each side so instead of raising your hand if you want to ask a question go to the microphone and since the session's being recorded you got to get on the microphone to get the question recorded otherwise it's going to be really weird we start talking about something that nobody in the audience can hear okay so with that said I'm going to introduce who we have here from the Black Cat review board we have Sharon",
        "right on my left then we've got Matthew swish um we've got uh Meadow Ellis and Stefano zaneiro who you may or may not realize he's a speaker like what the second black cat or something really early days um so yeah we go way back and I love arguing with him because he's great he's a professor so he argues fairly you know he doesn't cheat um so we've got a couple of topics we're going to start with and uh and one is we're just going to start at the top defensible internet from Daniel's keynote this morning um so defensible internet tying back to halvar's Keynote are are we building a defensible internet and what does that even mean anybody want to go at it we talked a little bit Matt and I this it's breakfast this morning not realizing that that it was going to come up here and it was all this excitement around memory safety right like you can't get away from that buzzword it's a thing now um and so what does it mean and does that magically mean you have a defensible internet I don't think so yeah so um I guess it's mostly about reducing the attacks your face because memory safe bugs represent around like 70 percent of bugs of exploited bugs",
        "yeah so and like we have seen over the past years security is always like incremental where we get multiple mitigations and after we have like a defense in depth yeah but memory safety like you said it's probably one of the most significant one in terms of",
        "in in terms of like long-term impact because we're arriving to a new generation of programming language we start to see uh being able to adopted more and more for instance with Android like we were talking about this morning but so then somebody pointed out log 4J was a memory safe language right so even with them you're gonna it's not the Silver Bullet it just helps reduce the total yeah I guess also because like uh when we talk about memory safety uh memory safe language we mostly think about trust yeah and since it's one of the main uh potential candidates replace",
        "C C plus plus I guess that's why we hear more about it compared to other like memories of language right right and then um does the compiler save the day do we move to memory tagging does like is uh",
        "there's not enough programmers at no rust to save the internet right so is there some Force multiplier do we go to chat GPT and say rewrite this all in memory safe languages um or is it really we're just stuck in this incremental age forever no are there any game changers coming up for defensible internet I think",
        "trying and that's important because when Dan started talking I was worried that I'm gonna hear another keynote or talk about how everything is bad right because we usually we like to say this we like to say that everything is Doom and Gloom and we are not we're very good at admiring the problem yeah yeah however towards towards the end of the talk I realized that the the point was that we are actually trying and this is important right and we are slowly moving into yes it has been five years or six five five years since since um Harvard stock and",
        "I wouldn't say this time was wasted because we are getting better at building this defendable internet so I think that's important that we have been shown that there are measures being put",
        "in place right now to make it actually safer we are moving slowly maybe maybe we are actually moving slowly away from just attacking everything and trying to defend it more I think that one of the takeaways for me was about the non the",
        "part not related to technology that much but related to how do we make this happen and uh I mean it's it's been a very",
        "it's been a very long-standing argument how do we somehow push the industry in the right direction and I think that as painful as it is for hackers who generally do not",
        "really trust that much government maybe being a government employee of italya should not talk about that but um the the",
        "realization that actually there is a need for some like maybe light touch but policies in the direction yeah of aligning incentives for companies to actually produce so this is the regulation right it is time for regular and nobody wants no regulation and we talked about this decades ago and it was like no we'll inform the consumer we'll have all this extra stuff on softer boxes back when software came in boxes and consumers would read it and they'd go ah this is a better product than that one all by the safer product right I'll buy the Volvo with the airbags instead of the crappy car and then consumers couldn't make up their mind they couldn't make an informed decision oh that's okay the insurance companies will do it for them and the insurance companies will mandate that oh you have to run Lotus Notes at the latest patch or whatever it was and then the companies will buy the better product and then that is how the consumers will learn oh that's the better product that's what the company then that didn't work with the insurance company so now we're down to regulation I don't think there's you open up the toolbox and the informed consumers gone and insurance companies gone I don't know of any other tool in the Box besides regulation I'd love to hear it if anybody's got one but I don't think there is no so then it's a question of how big is that tool to clunk you over the head or is it a fine you know exactly but",
        "so the European commission has been trying for instance with the light weight for once with the lightweight approach of uh saying okay so industry here's the tools for voluntary certification build your own schemes that then you will adhere to just just tell tell consumers tell the market what are the standards that you will keep to your products and how they will be certified so there's a starting point at least yeah yeah it's not really it's not really working that much so I think that something slightly less light touchy and will be needed or something an extra finger or two involve a couple of fingers yeah that's that that seems to be the world we're moving into so then the question is who does the regulating right who does the standards and I think that's maybe why um venues like this we're trying to get the subject knowledge subject matter experts involved more in policy a little bit so at least they can make more like if I have to read one more time about the UK wanting to put back doors into everything and ban vpns it's like what decade are we in like haven't we learned this before and and it's just Groundhog Day and it's very frustrating um okay so that got us defensible internet I would say if you brought the subject up 10 years ago I would say rpki bgp SEC DNS SEC right big and",
        "infrastructural things now there's no more of that on the horizon it's still the same things there's not like the next thing on the horizon is that because we've migrated everything into the cloud and things are being controlled internally and so for",
        "example when Ukraine say move some of its infrastructure into Azure it's now Russia versus Microsoft right it's not",
        "um it sort of takes it out of the the internet as a whole or do you think there's something else going on I don't hear Too Many Grand",
        "schemes for increasing the overall raising all the boats on the internet can you think of any one because there's two things from the regulation point of view does that mean like security is just becoming like a checklist like we always like we're afraid of and the second thing is if it's a nation-state against a tech giant does that mean like uh Tech Giants have more power than nation states which is something that has been raised few times and yeah I mean I'd bet on Microsoft in that situation yeah I mean you're in there playing that's their playground they control that exactly you know what I mean across country yeah it's not only one geographical boundary",
        "yeah and so I think I think maybe you could say cloud is sort of an uplift I think uh maybe Daniel mentioned that also is a is a big change um but I can't think of too many other big reorganizations everything seems to",
        "be more political now um unless deploying the latest version of whatever routing or name service",
        "I don't think um",
        "okay it's getting more political but I think it is actually needed because",
        "we okay we hate governments right it's in our blood it's in our nature this is what we do we hate governments but those are those people I don't I like governments do you like any government those are those I would say organizations are the only ones out outside enough from the industry to be able to govern it properly I'm not saying that they will but they have the ability the point that they are allows them what can allow them to make it right so we're in this danger zone where now we've run out of options and we're into the regulation Zone and that could be wonderful or that could be terrible but we're in that realm now and we have to navigate it I think absolutely but what we we failed to build a defendable internet so far right right maybe you would have to try something else that the things that we talked you talked about a moment ago 10 years ago we seemed to have many solutions to security problems right and now we are finding they don't actually work because we are still not there and",
        "something has to change maybe the the regulation is the answer maybe right all the other options nothing's really worked right security industry has been going quite a while now nothing's worked so maybe time for this yeah isn't that is that a little scary it's like we must try something and this is something",
        "it does work it's just we don't have 100 coverage it's like whenever you do like application security against the same thing with internet you cannot have one matching solution for everything it's just gonna be a bunch of different solutions and you know they're gonna work with a different uh rate of success and uh yeah but you it's I think it's a bit harsh to say like okay nothing worked until now I know otherwise it would mean like whatever we did not always worthwhile yes it's well enough and I think that's one point is that like the losses never were so bad that we decided to throw up our hands and quit yeah it's just we just wish it worked better yeah no absolutely okay it's bad right now but",
        "I'm very much not could be better there is room for him however we are at the point that many many many people are actually looking into the the regulation side and thinking about like maybe how about we try this as we tried other things they work but not good enough not well enough and we are getting to the point where",
        "one thing though I do feel better about is the collapse of Bitcoin",
        "from an environmental standpoint I'm like wow we're trying to buy uh a video card or yeah",
        "oh but I kind of feel like oh good I'm glad it's not more gpus for the rest of time I'm glad we diverted geared away from that that Cliff um yeah that was super frustrating sorry that was just me saying there's a bit of sun sun sign out there um speaking of gpus though like we can't get around it we started talking about this and we realized we have to bring up chat GPT we can't right we have to talk about it so um I made this joke the other day it's like I know call for paper and review boards we're gonna get hammered with chat GPT generated submissions so we have to ask chat GPT to detect chat GPT submissions and it will detect it for you um but you know that it's going to get better and so that's led to a whole slew of uh",
        "there's unexplored aspects one of them is a very much of an ethical aspect on deploying you know human impersonating technology on an unsuspecting population",
        "is that ethical should we be doing that",
        "do you want to hear no or um before",
        "before he sent me like an Elisa prompter ran a bot on IRC you know I mean like five questions or four questions I knew you know they're messing with me now maybe not so much now I can elicit a little bit of information over a long period of time and generate this whole profile around how I feel about different things or whatever just like there's cookies there's going to be all this metadata around how I responded to various chat agents on various customer service portals asking me about how do I deal with stress or whatever just seems like we're entering into a different this will enter into a different era right of type of information we can gather about individuals that's more than just they check the yes box or the no box it's like sort of like sentiment analysis on a whole different level yeah and and then the so going back to one of the the points of the keynote that I really liked uh we will ask Davey in accounting instead of not clicking on the link yeah or my personal favorite is when we ask to people in accounting when you receive an email with an invoice attached to it",
        "do not open it well what's my what what do we do with my jaw right yeah and so we will need to ask David to account into the I'm sorry for accountants around but and",
        "um please when you are talking online with a chat customer for handing out any company information ask a couple of symbolic reasoning",
        "questions that are very hard for machines to solve and or question a normal customer would never know exactly square root of 943 everybody knows it is going to become the new capture yeah that's why we've got to build a defensible internet because we can't rely on day from accounting and you know we've done years and years of phishing tests now to what end you know are people any better now are discovering them than they were no that's been the biggest waste of energy I believe it's demoralizing more than Bitcoin",
        "burned up more Carbon on yeah but yeah it's I don't think fishing training is has there been a study that says it helps besides just angering your employees",
        "yeah and I mean in this day and age with covert and the cost of living Etc it's a hard world for everyone I think your resources can be better deployed at the moment and it comes back to ethics again you know right well I fondly remember that during one of the first engagements when I still was not a professor I founded a company doing penetration testing which was a terrible idea do not do that to yourselves founding a company I mean um but um I I remember one of the first customers",
        "um like signing off on a very very large penetration testing agreement so large budget and striking off one specific item on it and the one specific item on it was a social engineering test to try to use emails to engage with people and we were like okay so I'm curious It's evidently not a budget thing because you approved everything else and something",
        "why did you strike this out was it formulated badly there's something better that we can do for next and just like no I just know that you will get in I don't need the best I already know and um I don't think that the situation changed dramatically the following the training so",
        "there's um so do you think chat me chat GPT then will become in integral to any of our sort of processes are we going to teach it the language of I know iocs and then tell it to tell us when it sees some you know or is it just open AI is going to rule the world and they're going to be the next Google that we have to contend with I think you were you had some thoughts around that earlier yeah well I guess one of the thing is people are going to become better at that skin question so now like instead of having people just saying oh it does not work or whatever they're gonna have to elaborate on their thoughts and instead of having like data scientists you know just like sending like SQL queries on that type is they're gonna ask like proper questions against like a new type of uh yeah database so I think we're gonna see an evolution on the prompting engineer exactly like uh I think it's scale AI they uh hired someone and they called him like a prompt engineer yeah that's yeah um but I think that's going to be one of the the main changes where people are gonna have to self access better whenever they ask questions or they want to do something or like for instance back in the days when we would be on IRC and someone would ask a question and be like oh rtfm you know I think we're gonna have a new version of that uh well isn't it I mean and it wasn't it was ask uh Alexis or Alexa or whatever right or",
        "this is just the Next Generation or is it fundamentally different",
        "I think it I think I mean we have to remember that chat GPT is just a demo of the technology right it's not about text it's about how it learns and when I am trying to talk to it",
        "not even talk ask it questions and I'm every time I'm Blown Away about the quality of language and and the consistency and coherency of what is",
        "providing and this tells me that we probably will not because this as I said this is just a demo right but the the engine itself is pretty amazing and I am actually looking forward for it the engine itself helping us in security especially like soccer operations right I still haven't seen a a good solution and this is not I'm not asking an event to talk to me about this please don't",
        "that would help eliminate",
        "alert fatigue for example right but the the in the way that I could trust it I want this is why I want aai to help us in security for example and seeing how",
        "chart GPT how I can ask it ask it questions and it answers in a good proper way this may actually be something that we can use maybe eventually we will be able to no no you just quickly triggered a memory um years ago uh uh Eugene uh Kasparov",
        "gave a talk on",
        "Chess Masters working against computers and Chess Masters working with computers and his can take away from it was that the highest performing were teams of a human working with a computer against another human working with a computer like if his computer versus computer it was very predictable if it's human versus but the the best result was always a human and computer working together each complementing each other's weaknesses and and bolstering each other's strengths and that kind of sounds like what you're describing here is that we'll learn how to use these tools already use zardoz who who used to run the Defcon Capture the Flag contest he says he's already coding with a window open on chap GPT just one more input to help him refine his thought process around code and so maybe that's sort of like yeah spoken about it you flipped the security mindset you're not thinking about how can it be used for bad purposes but how can we use it in a positive way how can it help us rather than what's wrong with it or how can we destroy the world with it so I think that's a fundamental change to our mindset as well yes I mean as I said looking at uh again coming back to how it's how it is funding and I tried it with different things not only security like I asked it to write a song with a specific theme specific topic it was perfect okay it wasn't as perfect as as songwriter would do it but it would be a great starting point right yes yes I'm thinking I could use it to sew to help me with my work in so many things so many places where I actually have to repeat something it cannot I cannot automate it with a script because it has to think in a way so it has to involve me but I'm thinking maybe finally we have this thing right and it's actually going to help us like even for example things like detecting malicious activity on your network right instead of static analysis which you can do and we are doing without doing this actually there will be a GPT free something looking at your network wireless or copper it doesn't matter and not looking packet by packet but looking actually at patterns right and learning from it and I want to see this and seeing GPT charge deeply how it works I'm thinking maybe finally we are getting there you can't you still have the problem of like because in that uh uh case uh in that scenario you're still assuming like the data you get is correct so if you have to filter like events from your endpoint and ask you mean okay like chat GPT help me to filter like all those like false positive you know like maybe there is a lot of events that are being missed by like you end point or like networks I mean there's also a risk obviously right because you would come after in the triage phase absolutely I'm not saying I'm not saying that I don't know if it's going to be I'm just saying looking how it's processing text input yeah I know that the the back end the engine is actually may be capable of doing things we weren't not able to do before in terms of security for example plus we're burnt out we need all the help we can because we only need all the help",
        "so um you touched on an interesting point which is I'll go back to the sort of Ukraine uh Russia uh cyber war and we started to debate this uh I'm sorry Russia invaded Ukraine yes and uh there is conflict there and",
        "um what we were discussing is the uh in the early days it seemed like Russia used up all their offensive tools very quickly like their whole tool set and then they waited a while and they recalibrated did sort of their bomb damage assessment and then they attacked a second time but the attack was not as sophisticated it did not last as long and then they did it a third time and now it's a sort of attacks as they opportunistically occur",
        "and so I was talking to someone in Ukraine who works on defense there and I said do you think that's because they've used up most of all their tools or do you think they have some sort of Mission Impossible Ultra weapon and they're they're just not pressing the red button because it's just so overwhelming and their take on it was no it's they've used up all their tools and they might have the ultra weapon but maybe it's you know implanted in Western power grids or something else it's not in Ukraine and so I'm sure they have other capability but it's not useful to them now in the current structure of the conflict um and we're getting better at detecting and responding and rebuilding so when they do attack now our time to respond is shorter our Defenders are getting better and they can just do less and less harm to us and partially it's because they're on our networks and so that's made me think that a lot of the sexiness energy is around offense but in an actual conflict it's really on the Defenders right or or you know I think we is it that the offense counts before it goes fully kind of kinetic and then the energy goes to the Defenders I think that the um the entire story of this not specific",
        "conflict but uh it was written down by Thomas Reid like 12 years ago there's a book called The Very I mean",
        "it's a book that you can even not read you just need to read the title cyber war will not take place that's the title and which pretty much contains the entire book but it's a very well reasoned book I I keep recommending it every time that I end up in a cyber warfare discussion even before the",
        "current events and um in that book there is um the fundamental message which I I agree with wholeheartedly is",
        "if you think of War as War as what humans have defined as War for forever",
        "there is no such thing as cyber War there are cyber operations that support a war that uh increment a",
        "war that help scouting targets and we have a word for that and that word has been Espionage for like hundreds of years uh it has been uh information gathering for hundreds of years you go back to read soon Seuss being far and you find information gathering right there this is information gathering with digital means so as you were saying all of the offensive penetration capabilities they are Espionage sabotage",
        "and those are the phases that happened before the shooting start because when the once the shooting starts uh there's a lot of mess there's a lot of things and at that point what really matters is how well you can keep up the lines of communication how well you can protect Communications but those only partially",
        "Transit through the internet and but that that we have seen right in the role of starlink or or other Technologies in",
        "giving access to Battlefield information",
        "and so on so I think that well and I was wondering too do you think we're getting better at taking away the weapons taking away the zero days so",
        "um or do you think it's a they can generate new exploits faster than we can take them away because it seems like uh if you are Ukraine and you were being attacked you just pipe everything to virus total right you just try to take away their tools as fast as you can so it's of limited value and that seems to be a lesson that fenders have been working on for a long time I don't know how far along we've gotten but it seems like we've got to raise the costs and this is the the venue where we can see like where the rubber meets the road is it actually are the just like every military is sending weapons to Ukraine to see how they perform I'm I'm sure probably every Network vendor in the world is trying to get stuff Microsoft cloud everybody wants to get in on that and I think they're learning a lot of lessons I'm curious to see when when we'll learn um from that like those studies over the next look where the ACM journals from the next couple of years of Lessons Learned I think they're going to be counter-intuitive in some areas you know I didn't go the way we thought it was going to go okay",
        "we've got 10 minutes and 27 seconds left I'd like to open it up uh to the audience a little bit so if we have any questions please go to one of the two microphones and we'll turn up the lights a little bit otherwise we'll just keep talking",
        "[Music]",
        "[Music]"
    ],
    "9JS5pdYcpOM": [
        "foreign",
        "thank you so much for being here my name is Sophia Sally and I'm a cryptography researcher at Brave and I'm joined today with Martin Opera Professor from Royal Holloway University of London Dan Jones a PhD student from Royal Holloway University of London and Benjamin darling a lecturer from Sheffield University and today we're going to be talking about our paper and research practical practically exploitable cryptographic vulnerabilities in Matrix and if you want to learn more about the research and our Associated paper you can go to the link that is listed into this slide",
        "okay um so just to give you a limit of an outline of our talk uh first we're going to be introducing what is secure messaging and also why it's important in the context of Matrix then we're going to talk about the cryptography in The Matrix Matrix protocol then we go forward with our attacks and then we leave you with some take-home messages and some lessons today also next slide",
        "so what is Matrix uh Matrix is basically uh this protocol that is used for secure messaging and why is important is because secure messaging nowadays is really vital for our societies because it provides security and privacy properties for end users that use it and it's really vital to look into this protocols and really attest to the security and privacy properties that they provide so we can we give Assurance to the end users and indeed their conversations are predicted and that they are not sent in plain text next slide so as I said what is Matrix Matrix is a standard for very Federated decentralized group message and they also have encryption enabled by default the flagship client is element which is the one that the majority of people use basically they have a threat model in which of course they are working over the end-to-end encryption in which the home servers are considered as not a trusted entities but we will see next that maybe this assumption was not taken rightly from the developers of the Matrix protocol and if you want to contracts with other applications there's of course a slack Microsoft teams so Lipa matmos which indeed provides some end-to-end secure messaging Properties or some decentralized properties but none of them provide all of the properties that Matrix aims to provide next Supply so why would we looked at Matrix into our research press because it is widely used a city listed on the slide element has over 60 million uses and some of the uses of Matrix include for example the French government with an application instant messaging application called teacher and also the German healthcare system which has adopted Matrix so as you can see from this slides Matrix is widely used the second one we looked at it is because of what I said because Matrix occupies a unique Niche place on",
        "the market because it's one of the few secure messaging protocols that works also over a decentralized system and the third one is because many standardizations protocols such as the IDF are currently looking at actually standardized secure messaging in a group chat setting with for example MLS and they're also looking at the standardized interoperable secure message in which Matrix can be an actual candidate for that and just to give you a little bit of my overview how the architecture of Matrix works you have basically three big entities of Matrix you have devices uses and you have the Home Server so Matrix is user is is associated with a list of devices so set devices could be for example the laptop a tablet or any kinds of computers and the usage registers those lists of devices with the Home Server this Home Server is the entities that server but basically acts as the entity the relays messages in a room between the different uses and it's also the one that has the list of the devices that the user controls",
        "um next home service are the ones that maintain the link between a user account and its devices and lastly a room is a collection of devices of the devices the different users calls and they are the ones who are actually trying to communicate with each other in a group set so next slide and now we go for the cryptography in Matrix hi uh thank you very much Sofia so now we're moving over to the cryptography that's used in Matrix and I'm going to give you a really high level very quick uh overview of how these functionalities come together so Matrix has a set of what we called core functionalities essentially three subparticles that are going to be used to actually enable group messaging within Matrix on the left hand side here we have device and entity authentication where users and their devices generate public keys and then use the cross-siding framework in order to authenticate those public keys to each other once you have authenticated those public Keys you are assured that Bob owns the public key that you expect we then move over to session establishment so if you're familiar with signal sender Keys architecture this is going to sound very very familiar to you what happens is Alice and all of the devices that are communicating within her room establish pairwise own channels you can think of these as roughly similar to Signal channels being established between Alice and her devices and all other devices in the room once you've established those own pairwise channels you're going to use that to actually communicate the keying material used to encrypt messages from Alice's device to all all other devices in the room enabling unidirectional group communication",
        "through the composition of these Mega ohm channels so once you've established these home channels you send across some keying material using them and then we go into actual session communication using the ohm sub protocol so let's dive into these a little bit more so the cross signing framework essentially allows you to establish a web of trust what happens is each user is going to set up an account with a particular Home Server which allocates that user a user identifier the user then generates a set of what we call cross signing Secrets or user secrets and these are going to be used to authenticate lots of different public keys in order to establish own channels so we have our master key which serves as the long-term identity of Alice and is also essentially the root of trust from Alice everything flows from this master key this master key is going to be used to sign two other public Keys a user sign-in key so the user signing key is going to be used when Alice and Bob get together and verify their Master public keys so now that Alice knows that Bob's Master public key is actually owned by Bob she's going to use her user signing key to sign Bob's master key then later when you meet up with Alice you're going to be able to verify not just Alice's Master public key but through this root of authentication you're going to be able to verify Bob's Master public key as well finally Alice generates a self-signing key and this is going to be used to sign per device public keys",
        "so Matrix is a device oriented group messaging protocol so how is this established well whenever Alice has a new device that she wants to be able to communicate with other users in her room she's going to log on to the Home Server with its account credentials and this is important the Home Server is going to allocate that device a device identifier that's going to be used as a vector in one of our attacks then the device generates per device keys and registers those with the Home Server these are the long-term device Keys these are the things that are being signed by Alice's self-signing key and also the omkey bundle and this is going to be used to establish per device pairwise channels",
        "using the ohm protocol so how does that work so once Alice has established these these omkey bundle she's going to upload that o key bundle to the Home Server and then later at some point Bob's going to want to communicate with her so Bob's going to retrieve that public key bundle from the Home Server and then use that to establish some shared symmetric key that's going to be used to encrypt messages from Bob to Alice importantly this isn't going to be used to encrypt application layer messages messages that are actually seen by the user and typed by the user but this is instead going to be used to communicate session State this Mega ohm session state is actually what's going to be used to encrypt messages from Alice to the rest of the members of her group so Bob does triple Divi Hellman he dubs double ratchet to derive a message key and then he's going to use that message key to encrypt the mega arm session state so the mega room session state is actually what's going to be used to encrypt messages from Alice to the rest of her room so what is this actually consisting of so this Mega room session state which is encrypted using these ohm pairwise channels consists of the message index how many times Alice has tried to use this particular state to encrypt messages to the rest of her group the internal ratchet state which is this keying material that's going to be used for derived message keys and encrypt actual messages and the group signing key this group signing key is going to be used to authenticate ciphertext between Alice and the rest of our group so the idea here is this internal ratchet state is some symmetric keying material which means that everyone else in the room knows this so everyone else in the room can encrypt messages as if they were Alice this group signing key prevents that sort of within the group Insider impersonation attack",
        "uh this can be split up into outbound and inbound sessions where the outbound session contains the actual signing key used to authenticate messages from Alice to the rest of our room and then the inbound session which contains the public key used to authenticate those so on a high level that's the mega ohm session State that's what's actually being communicated via these own pairwise channels so what is this internal ratchet state at its core Mega room is a symmetric ratcheting protocol similar to the signal symmetric ratcheting protocol used within the double ratchet scheme so the idea here is that every time you want to encrypt a new message between Alice and the rest of our group she's going to ratchet forward her State go from I minus 1 to I and then she's going to use a key derivation function to derive a message key used for encryption then she's going to ratchet the ratchet stay forward again going from I to I plus one the next time she wants to encrypt a message she takes that ratcheting state uses a key derivation function and derives a new message key for encryption this gets us two properties the first one is it allows us to drive a new key for each individual message and secondly it means that the compromise of Alice's current state let's say she's at stage I plus one doesn't impact the security of keys derived beforehand so you can't roll back that ratchet state from I plus 1 to I in order to derive the same key Ki and decrypt previous messages",
        "so we've looked at what the ratchet is we looked at what the session State communicated between these devices are how do you actually use this to encrypt a message so the sender generates a fresh symmetric key from the ratcheting State as we saw in the previous slide we encrypt that message under that key and then we sign it using the group signing key that's a single ciphertext and a single signature that is then communicated to the Home Server and in that Home Server distributes out to the rest of the devices within the room then this fan out way similar to Signal Center keys",
        "okay so that's the core functionality of Matrix what about the backup functionality so Matrix is interesting it allows you to be able to recover from device loss by backing up your secrets and as we saw before there are essentially two big sets of Secrets there's the user secrets that enables the web of trust and then there's the mega ohm session secrets that enable",
        "um actual group communication within um the the room and so for user secrets we have user Secrets backup via the secure secret storage and sharing protocol this is fairly straightforward the user generates a backup key usually from a user passphrase and then they use that to encrypt the master public key the user signing key and the self-signing key and then upload that ciphertext to the Home Server later if they lose that device and they want to be able to get those user Secrets again they regenerate that user backup key retrieve the ciphertext from the Home Server and then decrypt it locally thus allowing them to recover the user the user signing Keys the master public Keys sorry you can use the secret keys and the self-signing key so that's for the user secret backup what about Mega ohm the the lowest level of of sessions well in that case Matrix actually has two distinct protocols for doing this one in an online setting and one in an offline setting so in the online setting this is enabled by what we call the key request protocol and it looks very similar to the way that session initialization or session establishment Works using ohm so let's assume that we have two devices both owned by Alice device one and device two device one has been participating in all of these Mega ROM sessions and device two is a brand new device and wants to be able to participate in those sessions from this point onwards so device 2 triggers the Home Server in prompting a key request to device one that device is going to do a series of checks is device 2 actually owned by Alice have I verified this device things like that and if all of these checks go through then it's going okay fine and that's going to send the mega ohm session state to device 2 via the OM pairwise Channel shared between the two devices and so this allows the user's device to share Mega ROM session information with each other but what happens if both of these devices can't be online at the same time Matrix provides for you in this case by doing offline session recovery via server-side Mega ohm backups it's kind of a hybrid of the two approaches that we just saw the idea is that I as the user generates a recovery public key and I authenticate using some secrets that I own I'm going to upload that recovery public key to the Home Server at some point let's say a second device of mine wants to be able to back up the mega arm sessions and so they're going to download or retrieve that recovery public key encrypt the mega room sessions under that recovery public key and then upload that ciphertext back to the Home Server so at some point later I can download that and recover the mega room sessions and what's important to note here is that while the recovery public key is authenticated the actual ciphertext the actual backup is not and that's going to be another point of contention that we're going to use in our attacks and speaking of attacks I'm going to pass it over to our resident PhD student Dan Jones",
        "Matrix um why it's interesting and um sort of how how the cryptography and it works we get to show you some of the attacks we found whilst we were studying it um so the first two attacks we're going to talk about really what they're exploiting is",
        "um too much trust being given to the Home Server when organizing and kind of controlling the metadata around groups so in the first case and we're going to look at group membership which is mostly managed through events so like Alice might say oh hey I'd like to invite Bob and then Bob replies yeah great I'd like to join the group and these are sent via messages in the group but those messages",
        "are not authenticated in any way there's no cryptographic control over them so a Home Server if it's malicious can just fake this message exchange and sneak in",
        "um a user that's maybe under its control to eavesdrop on the messages so you don't really need to do any kind of cryptographic breaks here but it's just um too much trust that's given in the Home Server to the Home Server similarly there's another attack where",
        "as we described earlier there are users and each user has many devices and when you want to send a message to a user you need to figure out their list of devices and the primary source of like",
        "source of this list comes from the Home Server and the Home Server can forge it and they can even sneak in devices that are under their control and those devices will be included in groups that the user is a part of and allow to kind of read the message the messages that they send and just to impersonates that user to an extent",
        "um so in both of these attacks um there's quite a bit of damage you know like attackers can eavesdrop on your conversations um but you do end up with some kind of indication in the user interface that it's that this attack is happening um you can see as a user that like oh there's an actual user in this group that probably shouldn't be there um and I think that's the main kind of rationale behind this feature in the first place because um it was almost like a a design Choice initially um you know and the idea was that well element shows the list of users so it's up to the the user to figure this out and to inspect it and to be sufficiently eagle-eyed but we argued that kind of this is a bit burdensome on users and it's not necessary like there are solutions we can use to solve it and that's what Matrix are doing so they're working on a fix for this where they're going to sign these group membership messages",
        "cool so our take-home message that we'd really like to push here is that you can't really get confidentiality without authentication and what we mean by this is like it doesn't matter if you're encrypting messages when you're sending the or Distributing the decryption keys to anyone who asks you've got to like you've got show you and you just speak the decryption keys to um to the people you want otherwise yeah there's no point encrypting them um our next attack is on the out of band verification in Matrix and this is that bit um in Ben slides earlier where the two where the two users sign each other's Keys it's called like kind of the Cross signing um and the idea of outer band verification is that um you know we're doing end-to-end encryption so we're trying quite hard to not trust the server but one thing that is often we often need to trust the server for is to introduce two users so say like that at some point the server has to say oh by the way this is Alice and this is her like cryptographic identity and suddenly like this is Bob and this is Bob's cryptographic I don't see at this point they can make a um kind of a secure channel that the server can't can't play with but um what if the server just makes up fake cryptographic identities and distributes them well they can do kind of this active processing attack this Mallory in the Middle where I just proxy all the messages using these fake cryptographic identities and get control of you know things like um the messages that I sent get to read them get to impersonate so that's not very good and that's the problem out of band verification is trying to solve the short authentication string protocol is one of the ways Matrix solves this essentially the way it works is that the two um Alice and Bob will set up some kind of like secure Channel between the two of them and they're then going to construct the special string and it that encodes their view of the",
        "secret Channel and it's a special string because if they have different views of the secret Channel such that it's been tampered with then these strings won't match so what they can do is well in this protocol they get encoded as a nice little string of emojis and you can maybe phone someone up or meet in person and you can kind of check that they match and if they don't match then you know the Channel's been tampered above if they if they do match well now you've got a secure channel that you know hasn't been tampered with so you can send your long-term cryptographic identities over that and you will end up with kind of like you've cemented a real root of trust that you know the server has um no control over in our attack we was able to trick devices to into instead of sharing in that final step instead of sharing the cryptographic identity they created they accidentally share one of the Home Server controls so I'm just going to detail how that trick works how do you trick devices into doing this well there are two types of verification sometimes there are two users verifying each other like we spoke about before but other times um two there are two devices maybe I've logged in on my laptop and I'm already logged in on my mobile phone I need to do some kind of verification to make sure their their connection isn't tampered with to distinguish these two cases they have a key identifier field in that message that's sent in the final step of the SAS protocol",
        "in this key identifier field in the first case when it's two users they you they send the user's cryptographic identity but in the second case when there's two devices they send the users I mean the device's device identifier and this is this is um worrying because it's controlled by the Home Server and the Home Server can and this is what they do in this attack generate their own fake cryptographic identity for a user and allocate it as the device identifier and now when that user does a when that device does a verification it'll send its device identifier and the receiving party will interpret that as a user's cryptographic identity at the end of this process and will now instead of trusting that device they trust the the",
        "cryptographic identity",
        "that the Home Server controls and this enables a complete break of the protocol um attack at the attacker can eavesdrop on the conversations they can impersonate users and there's no indication in the user interface other than a slightly funky looking device identifier if you if you look look closely um so it's a pretty pretty damaging uh attack a complete break so we should probably try to avoid it um and how should we do like how should we do that well the key problem here was that these device identifiers and these cryptographic identities share the same like space it's hard to distinguish the two you can make a valid device identifier that is also a valid cryptographic identity and that's kind of bad you want to separate these domains and this is our kind of the take-home message we're pushing for here it's like uh domain separates everything you can um yes cool so the next three attacks kind of iteratively build upon each other starting with a like an impersonation attack then we kind of strengthen the impersonation attack a little bit more and that allows us to break the confidentiality of the protocol as well so to start with our first impersonation attack so earlier Ben was talking about the key request protocol and how it's important that when you're sending Secrets you're sending these decryption keys to your other devices you check that you actually trust this device by checking this kind of web of trust and checking that it's been verified but it's also super important um that when you accept secrets you only accept your decryption keys from devices that you trust as well and this was the implementation mistake that Matrix had made they'd only implemented the verification on the sending side and not on the receiving side so a device a malicious device can generate a new session and send via this key request protocol a message to Alice to say oh hey by the way um I like um oh by the way like uh this is Bob's decryption Keys the decryption keys for Bob session and then later on um Alice will just say yeah great thanks and I'll assign anything that decrypts any messages that decrypt from that session as coming from Bob even though they came from the attacker and we do this on the mega ohm level so there's like a lowest group message group messaging layer",
        "um so yeah what's the damage well yeah you can get some kind of impersonation but importantly",
        "um the messages that are decrypted using keys that are sent by this key request protocol end up with a little flag in the user interface quite often that says like you should probably trust us a little bit less than normal and we would really like to do better than that so that's what our next impression impersonation attack does",
        "uh the key idea behind this impersonation attack is that whilst key requests messages sent via these key request protocol are flagged as kind of like slightly less trustworthy if they if the session came from like a normal Mega ohm session setup",
        "from the person who actually owns the session they are not flagged they're kind of they've seen as fully trusted um but we've already gotten the First Nation attack on that person so what we can do is we can simulate we can pretend that we're that person using our previous impersonation attack to start a new session not using the key request protocol but using the simulating the normal session setup um and this kind of works and it's great but there's one roadblock and that's that our previous impersonation only worked on the mega ohm level this lowest level but um it's expected that uh Mega",
        "ohm sessions are initiated using the own protocol that's like what the specification says um luckily for us this wasn't uh",
        "there was there were no checks so we could just do the attackers the scribes simulate this session setup and this",
        "gives you a full impersonation that provides no kind of evidence to the user that it should be slightly less trustworthy so now that we've got a nice strong impersonation attack our next step is to try to convert this into a confidentiality attack",
        "so um we were talking about these Mega ohm backups earlier and the way this works is that you kind of you've got these Keys you want to back them up to the server so you encrypt them using a symmetric key and you share them between your trusted devices",
        "cool so",
        "but we just got an impersonation attack so potentially what you could do is maybe like just",
        "ask them whilst you're sharing these encryption Keys these backup keys you can use your impersonation attack to share share a key that you control and so that's what happens the attacker using the previous impersonation attacks says oh hey by the way we're using this new encryption key now let's upload our um our backups using that and they all go oh great you're a trusted device because it's a we've done the impersonation attack and they will",
        "upload their keys straight to the set to the server using um the encryption key that the attacker controls and that this gives them access to all the messages so this combine these three attacks give us a complete break of the confidentiality and authentication that protocol we can read and we can impersonate users and the take-home message just to drill it down again as the same as before there is no confidentiality without authentication and in this case we saw how an authentication break these impersonation attacks let us eventually break the confidentiality of the protocol as well",
        "um we have one final little um attack that we found and this is a theoretical attack where um I kind of being the Integrity of this initialization Vector in the AES encryption for for backups wasn't um wasn't protected and this leaves this means that this the scheme is not indcca secure um this is like a theoretical break of the confidentiality that you get from a lack of Integrity protection but in kind of importantly um whilst it's through theoretically only a theoretical break it was dangerously close to being a practical attack as well um so again this take-home message similar to the ones before is you can't get um like good real confidentiality without Integrity um and these like these security properties were intertwined",
        "so just to recap um we came up with a bunch of attacks that all um work with different parts of the protocol",
        "um some that are more kind of implementation focused some are more on the design attack just the the fundamental design",
        "of the of the protocol but overall they've primarily been fixed importantly attacks two to five we were able to develop proof of concept code for all of them so like they certainly definitely do work and we were able to get these breaks in practice um but luckily for us they've all been well the vast majority of them have been mitigated by matrix and you can kind of read more about that in our CD their CDs um I'll pass on to Martin all right so Dan already gave you a few kind of take-home messages but I want to leave you with one bigger take-home message from this work and the first thing uh kind of to appreciate here is like maybe that came across it's like this is a complex protocol right there's a lot of different subprotocols and what Matrix is trying to do here is really hard right this is a hard problem that they're trying to solve they're trying to do secure group messaging in a Multi-Device setting there's also scalable to thousands of devices in a single group right that in itself is a daunting task they also say like we want backups we want history sharing right because we you know think that this is what users expect of a chat protocol they want authentication identity verification right and but you don't want to kind of verify every device so they want to build like some infrastructure that makes this somewhat easy somewhat seamless to use once I've verified that you are you I can chat to all of your devices when you get a new phone it's fine",
        "they also and this really sets them apart I want to do this in a Federated setting right so in the same way as email kind of back in the old days kind of was a Federated protocol uh now it's no let me not go there um they want to do that the same for chat right so you have these different home servers they talk to each other and they want to support a variety of clients across many platforms this is a complex problem to solve right so let's just appreciate and then in some sense you could say it's a hard problem to solve some mistakes are unaptable okay fine",
        "so the standard response so we've been around the block a few times kind of with some attacks and like the standard response that people give when you know these sort of cryptographic attacks are published are don't roll your own crypto or crypto's heart this is not the take-home message that we want to leave you with this is not what we want to say of course cryptography is hard like is any other signs or any other area of computer science or engineering like yes hard problems are hard this doesn't set cryptography apart from any other of the heart problems that all of us all people solve all day the re we have to tackle with a lot of complexity here but the science of cryptography gives us the tools to do that right so yes there are many different protocols and how do they interact how do you reason about that and modern cryptography gives us the tools of doing precisely that that is we can reason about cryptographic protocols we can say like if you have an attack against this protocol then you have also solved like some computationally hard problem such as factoring big numbers for example right so we have and these are formal proofs we can write theorems and we can prove like if an attacker can do that they can also do this other thing that the internet runs on right so Matrix being broken is not my concern but if there's an attack here then it will be really big news and we have bigger fish to fry so that is something that the science of cryptography gives you so what you should say in the future whenever you see such an attack as cryptography needs security models and proofs that is really the number one take-home message we want to leave here as much fun as it is to give a black hat talk ideally we wouldn't have to be here and in that fact we don't have to be here because we have tools to prevent these sorts of attacks from happening by doing formal proofs and formal theorems",
        "Thomas Patrick put this very eloquently on Twitter I'm just going to leave that hanging here for a second right and I feel seen all right",
        "so that is all we wanted to talk to you about um we have time about five minutes for some questions so please line up on the kind of in-room microphones if you have any questions thank you for your attention [Applause]",
        "[Music]",
        "[Music]"
    ],
    "sSLUjr3PQmM": [
        "[Music]",
        "thank you",
        "so hello everyone and welcome to my talk real world detection of vision techniques in the cloud so let's kick off with some formalities before we get started on the content for today",
        "first of all I'm Matt Muir and I'm a threat intelligence researcher at Cado security",
        "prior to working at cadill I was a Mac OS malware researcher and I've got a background in devops digital forensics and operational cyber security",
        "so you can follow me on Twitter at the handle on screen and that's if anyone else is actually still on Twitter of course and the slides for the talk will also be available to download later today",
        "so as part of Kato Labs kados threat research team I'm regularly involved in researching new software threats affecting Cloud infrastructure",
        "as the name of the talk suggests I'm here today to talk to you about detection evasion techniques we've observed in various Cloud native malware campaigns",
        "the talk will focus on three specific campaigns all of which we've been tracking over the last year or so so while the techniques described here are not necessarily exclusive to the cloud they demonstrate a certain Ingenuity and",
        "often review the attacker's knowledge of the incident response process",
        "so without further Ado I'll first go over the agenda of the talk before diving into some real life examples of a detection evasion techniques in the cloud",
        "so kick off this presentation by providing some background around the current state of cloud security and common infection vectors for cloud malware next we'll move on to the first malware family coin Stomp",
        "as we'll see coinstomp is a cloud native malware campaign that exhibits some interesting anti-forensics techniques",
        "we'll then take a look at some recent activities from watchdog I name those of you who follow Cloud security research will likely be familiar with before finally moving on to denonia a malware family we discovered earlier this year which we believe may be the first publicly reported campaign to specifically Target serverless environments",
        "finally I'll wrap up with some considerations about the future of cloud malware and provide you with some references for further research",
        "to begin I'd like to discuss something that I refer to as the cloud challenge if anyone saw my talks at besides Vegas or gercon in Michigan they'll likely be familiar with this concept already",
        "despite a sustained migration to the cloud from companies across the globe organizations are increasingly susceptible to attacks which are advancing in both severity and sophistication",
        "recent cloud-focused malware campaigns have demonstrated that adversity groups possess an intimate knowledge of cloud Technologies and their security mechanisms and not only that but they're using this to their advantage",
        "Cloud compute environment should remain an obvious Target for such groups however we're now also beginning to see a shift of focus towards serverless Computing and containers",
        "on top of this the ease of which Cloud resources can be compromised has led to adversity groups competing over potential targets",
        "now unfortunately Defenders haven't adapted at the same pace which is a big reason why I'm here to talk to you today there are a number of reasons for this with visibility into Cloud infrastructure being a commonly cited one but it's an unavoidable fact that the campaigns I'm going to cover are both successful in achieving their objectives and are widespread",
        "clearly attackers in the cloud space are utilizing this to their advantage by employing ttps aimed at evading detection foiling attribution and covering their attracts",
        "with that in mind I'd like to take a moment to discuss some common Cloud infection vectors",
        "people who follow Cloud malware research or deal with its remediation will likely be unsurprised by this list as it doesn't really change very often much like other forms of malware the most prolific Cloud native campaigns are opportunistic and generally take advantage of misconvigorations in the Target environment",
        "services like Docker and redis continue to be lucrative targets for these types of attacks people seem to love exposing the docker engine API to the internet without authentication for some reason",
        "similarly the developers of redis strongly recommend against exposing their TCP port or Unix socket directly to the internet even after they went to the effort of implementing a feature that provides optional authentication to the data store",
        "despite this a cursory glance of showdown at the time of creating this presentation shows that almost 50 000 nodes have Port 6379 open to the world",
        "of course many of these will have authentication enabled but several won't and I would imagine that they aren't honeypots either",
        "more sophisticated today actors will make an effort to exfiltrate credentials post compromise we've seen this from people like team TNT who are known to use aws's instance metadata service to retrieve IAM role credentials",
        "in the case of cloud compute instances we've also seen the contents of local credentials files being exfiltrated in a similar manner",
        "now on this object of I am earlier this year unit 42 published research on the state of permissions Management in the cloud they found that 99 of cloud identities including users rules services and",
        "resources were granted excessive permissions which were ultimately unused",
        "they also found that many built-in provider policies were overly permissive by default and that these weren't being properly managed by users",
        "this of course makes additional compromise of related resources easier and can serve as an infection Vector for cloud malware",
        "finally many of the malicious scripts and malware samples that we analyze rely on SSH for propagation which is an obvious choice includes compute environments see your Cloud compute instance has a vulnerable service running and code execution is achieved it's very easy for an attacker to enumerate the contents of known hosts look for a relevant SSH key and propagate their malware to any nodes that they find",
        "so after using cloud-specific knowledge",
        "to deliver malware via one of the relatively technical infection vectors that we discussed on the previous slide what do Cloud threat actors actually do with their access",
        "well the main cryptocurrency of course",
        "and often not very much of it in many ways I wish this was more exciting but the reality of the matter is that cryptojacking in the cloud is still an incredibly prevalent threat despite it being low hanging fruit for many campaigns it doesn't seem to be hugely profitable for the attackers this was evidenced by this story from all around this time last year",
        "some of you may remember seeing this but this developer received an unexpected bill from AWS for forty five thousand dollars it turns out that their AWS account had been compromised used to deploy some lambdas which ran XM rig and ultimately mined a measly 800 worth of Monero",
        "now this hardly seems worth the effort given the amount of stress that it likely caused this developer that is supposed free money is good money and if you're doing this often enough you could certainly build up a large payout",
        "fortunately this particular issue was settled with AWS and the fees were eventually waived",
        "of course with access to Cloud resources there are a lot more nefarious things you could do I'm sure everyone has heard of instances where companies have left S3 buckets exposed to the internet and customer data has been exfiltrated",
        "we also often see Cloud campaigns making use of malware such as tsunami which is used to connect infected machines to a botnet and has DDOS capabilities",
        "so this shows that the impact of cloud breaches is wide ranging and that's unlikely to change",
        "now as we'll see despite the penchant for crypto jacking Cloud today actors invest significant effort into evading detection and ensuring their miners execute unimpeded",
        "what should concerned Defenders is how we mitigate these attacks so that when we do eventually see attackers becoming bored of cryptojacking we're able to detect and prevent more serious threats",
        "on that note let's move on to discuss our first malware family coin stump",
        "coin stomp is a crypto Jack in malware Campaign which exploits resources hosted primarily by Asian cloud service providers so for example companies like tencent and Alibaba cloud",
        "there have been a couple of theories about why these csvs are specifically targeted it could be the case that it's simply due to location of the attackers and familiarity with the csps in their region however I suspect that since many of these csps are newer than for example AWS Google cloud and azure",
        "the security controls that are in place are perhaps not as mature as other service providers making it more likely that instances will be deployed in an insecure fashion now if you're someone that follows Cloud security research you're probably bored to death at this point by a family of cryptojacking shell Scripts but with coin stump we noticed some interesting techniques which hinted that the attacker's awareness of cloud security measures and the incident response process",
        "these included the use of timestamp manipulation otherwise known as time stamping an attempt to remove system cryptographic policies in order to weaken the target system C2 communication via a reverse show",
        "and a reference to a prior crypto jacking campaign potentially in an attempt to foil attribution",
        "so the first thing that caught our eye when analyzing a Coinstar payload was the presence of this date time string which you can see passed in as a parameter to the touch commands T option now hopefully you can actually see that but I've highlighted the relevant section in the screenshot",
        "so the function on screen here begins with an existence check for the file user bin mod user",
        "if this isn't found the script then grips for a sequence of strings found in the true mod binary in a subshell and uses grep's dash out option to return the file name only we can see evidence of this on line 16.",
        "it then renames the chamod binary to mod user and runs the touch command with Dash t and a date time string of 22-23 on the 20th of May 2019.",
        "now this may be common knowledge to some people in the room but this is of course a pretty nice way to perform time stomping with a command that's virtually ubiquitous across unix-like systems",
        "on line 21 we see the exact same technique employed for the chatter or change attributes command except this time with a slightly different date time string",
        "now why is the malware in this case obfuscating usage of Charter entry mode in the first place well of course both of these commands are specific to fail Access Control most Cloud native malware campaigns as soon as assume that certain files of interest will be restricted for editing either via file attributes or permissions",
        "using the chamod and chatter commands to overcome this is the most obvious way to modify these permissions or attributes and this is why we see it in virtually all malicious shell scripts that we analyze",
        "in this particular case the touch command updates both the modified and access timestamps to the date time hard-coded in the shell script and we verified this later after analyzing a machine with this malware running on it in cable however with this particular flag the created time Still Remains correct",
        "it seems likely that this was an attempt to obfuscate usage of the charter into mod command line tools as some forensics tools may prioritize files recently accessed or executed when building a timeline of events using a copy of these system binaries also avoids alerting admins who may have set up monitoring for execution of things like chatter into mod",
        "so this was another interesting technique employed by Coinstar for the purpose of evading detection at the network level",
        "the function cuddle that you can see on screen here is used to retrieve additional payloads and communicate information about the target back to a C2 server",
        "on line four we can see a reverse shell connection being established via the dev TCP device file to a remote server at",
        "106.53.115 0.114",
        "now for those that don't know the dev TCP device file is a feature commonly found in Linux distributions in combination with the exact command it allows you to specify a file descriptor in this case three which can be used for read write operations via a socket to the specified IP",
        "as you can imagine this is very useful for anyone wishing to implement a C2 Communications Channel and it's natively supported across Linux systems",
        "in the example on screen the malware mixture support 443 which is of course the port used for https traffic it's likely that this port was chosen as it's commonly used and unlikely to be blocked by any outbound firewall rules in the Target environment",
        "so this was an interesting and unexpected finding when analyzing the coinstorm payloads",
        "Coinstar made use of KRON as a persistence mechanism and registered a crown job under the root user",
        "other than using this persistence to launch or relaunch malicious payloads as most malware would coinstom instead used the Crone job to kill the tail and mask scan utilities the latter of which is often used in these types of campaigns to find vulnerable servers to Target",
        "we noticed an interesting comment in line in this ground job which you may be able to make out on line 243",
        "at one point it seems as if the code hosting service and on Pastor was used to host an additional payload for the coin stomp campaign",
        "we can see on line 243 that the URL for this provider is still added to the Crone job but it's commented out resulting in it having no effect on the job itself when we visited the URL we found another URL pointing to the Anon DNS Anonymous DNS provider this URL contains a couple of strings that we recognize from a prior campaign the first of which was xanthu a crypto mining campaign discovered by Cisco Talos",
        "furthermore one of the payloads in the Zante campaign that we'd analyzed was called fczyo which is the same as the resource in the URL here",
        "unfortunately the URL was down when we attempted to retrieve the FC YZ or payload so we couldn't determine whether it was the same installation script as we'd seen in the Xanthi campaign we also didn't notice any overlap of infrastructure between these campaigns or anything else that would suggest that they were linked so this led us to conclude that the URL will likely contain those names in an attempt to file attribution",
        "finally to round off our overview of coinstomp we noticed this rather interesting and amusing spelling mistake when statically analyzing the custom version of XM rig through the coin storm scripts dropped we're not sure if this is deliberate or not but it was jokingly suggested that it could be a reference to British crime actor Jason Statham who may well have had some involvement in this campaign so I've included a photo of them on the next slide for a visual reference",
        "so let's move on now to discuss watchdog",
        "Watchdog is a name that any follower of cloud security research will like will likely be familiar with they are a cloud native adversity group known for conducting crypto jacking campaigns since at least 2019.",
        "Watchdog are opportunistic and generally",
        "Target misconfigured services such as Docker and redis as we discussed in the infection Vector slide",
        "now they often meet use of Internet scanning utilities to conduct wide-ranging scans of the IP address space searching for vulnerable servers to infect",
        "several of their ttps overlap with those of Team TNT occasionally making attribution difficult",
        "they've even gone as far as using team TNT ASCII art in some of their Scripts and have included the team the TNT string and their naming conventions",
        "similar to what we saw with the coin stump campaign Watchdog campaigns typically make use of Linux specific knowledge and living off the land techniques to evade detection",
        "so this was a fairly interesting technique that we discovered in a campaign attributed to Watchdog that targeted our Honeypot infrastructure",
        "it utilizes a similar time stomping technique as we saw in our overview of coin stock but and perhaps more interestingly we can see the attackers implementing a very rudimentary albeit effective process either",
        "first the binary for PS is copied to another file named PS lanigiro",
        "a very simple shell script is then written to bin PS the sole purpose of which is to call the renamed PS binary and pipe it through an inverse grip to filter out processes with the strings ddns and scan in the name",
        "now as you might expect ddns and scan are two malicious processes run by the malware amazingly this actually works and it's perhaps the most Unity process Hider I've ever seen but more importantly this demonstrates that you don't need fancy root kits to have effective detective evasion",
        "so this was another very simple but effective technique employed by Watchdog for hiding artifacts on the target system when analyzing their payloads we saw multiple references to paths containing directories that were named with three full stops or an ellipsis it turns out that this name is perfectly valid for files and directories on Linux systems and it has the added benefit of looking similar to the two dot Alias for The Parent Directory in Long listings",
        "so as you can see on the screen here the Ellipsis directory is hidden and could easily be mistaken for The Parent Directory by an unsuspecting admin",
        "now obviously this won't fool proper EDR Solutions but include compute instances or containers where you may be manually investigating a breach this is the kind of thing that could be easily overlooked",
        "so this technique seems to be a favorite amongst Cloud threat actors and we saw it in use during the coin stomp campaign and several several other Cloud native campaigns",
        "in this screenshot we can see existence checks for a file named cd1 now this is actually a version of Kuro that's been renamed in order to obfuscate its usage",
        "the malware then sets an environment variable with a path to the renamed version of Kuru so that any attempts to retrieve additional payloads make use of cd1 and not the coral binary itself",
        "it's difficult to see just how effective this would be but I suppose if you're monitoring for invocations of Karo then it's a way for an attacker to avoid generating an alert",
        "this technique has also been observed when obfuscating usage of other data transfer utilities such as WK",
        "now aside from the techniques we'd observed ourselves in the campaign against our Honeypot they also heard about another detection evasion technique attributed to watchdog",
        "now I'm sure everyone here is familiar with the concept of steganography if not then it can be briefly summarized as the practice of concealing executable codes within another file",
        "when it comes to malware the other file is typically an image file as these are usually considered benign and non-executable",
        "this allows the embedded code to be delivered stealthily to the Target machine acting as an additional malicious payload",
        "we encountered some interesting research from race work when uncovering information about prior Watchdog campaigns",
        "they had found an example of a campaign where watchdog had used this rather low resolution image of the 63 building in Seoul to conceal an additional payload the first stage payload retrieved this image and used the Unix DD utility to skip to the end of the file and extract amblicious shell script",
        "sure enough when viewing the image fail in a hex editor a malicious shell script had been appended to the end of the file starting after bytes representing the letters i-e-n-d this of course denotes the end of a PNG file",
        "so the script itself contains behaviors typical of Watchdog including disabling",
        "of SC Linux and monitoring agents associated with Alibaba cloud multiplication and deletion of iptables rules and of course the persistent installation of XM rig for the purpose of illicitly minor Monero",
        "steganography like this is somewhat rare on non-windows systems although it's a technique as old as time when it comes to malware it demonstrates watchdog's willingness to adapt and try out new techniques for a wedding detection",
        "excuse me I know you enter a final malware family denonia",
        "denonia was a malware family we encountered when hunting for samples that interacted with the AWS amds endpoint",
        "it's notable due to it being the first publicly analyzed malware sample specifically targeting AWS Lambda",
        "now Lambda is aws's serverless Computing platform meaning that it's a service provided by AWS where users can execute codes in response to events and the underlying infrastructure is managed by AWS themselves",
        "the discovery of denonia suggests Cloud adversity groups are now beginning to Target serverless environments which made this quite an interesting find",
        "so the malware itself is delivered as an elf binary written in goal line unfortunately it's yet another cryptojacking sample but it uses interesting address resolution techniques for command and control",
        "it also includes other detection evasion techniques which hint at the author's knowledge of cloud Technologies",
        "so to give some background on our analysis of denonia we discovered an elf binary named python which despite the name was actually written in gold static analysis of the binary revealed a number of interesting packages including one named AWS Lambda goal",
        "this turned out to be the official AWS package for writing Lambda functions in golang it included libraries samples and",
        "tools",
        "of course this immediately made us interested as it definitely seemed like this malware was intended to be executed in Lambda",
        "continuing with static analysis we found several references to xmrig within the binary which turned out to be from an embedded customized version of The Miner",
        "not only that but the miner itself appeared to be excreted in memory with a config file written to slash temp and we'll come back to that later in the top so with static analysis complete we moved on to executing the sample itself shortly after execution the denonia process exited and we were greeted with a log statement that you can see on the slide here this made us even more excited than we were before as these environment variables referenced in the log statement are specific to Lambda",
        "we soon knew that we were dealing with the first publicly disclosed malware sample to Target serverless environments",
        "now in keeping with the theme of this talk we discovered a number of detection evasion techniques utilized by the denonia Developers",
        "our work at the static analysis stage had revealed a goal package named Doh go",
        "this of course turned out to be a protocol implementing DNS over https in",
        "the go language",
        "the package allows you to interact with Doh as a client from your go application and it supports providers such as cloudflare Google quad 9 and dnsbod",
        "for anyone that doesn't know DNS over https effectively allows you to send DNS queries via the https protocol",
        "this means that the DNS queries are encrypted in transit preventing them from being sent in plain text as they typically are when vanilla DNS resolution occurs",
        "excuse me Yusuf denonia in malware is relatively newsworthy in its own right while denonia isn't the first malware discovered making use of it it certainly isn't a common occurrence",
        "so what advantages does leveraging Doh give to the denonia authors for one AWS would be unable to see the DNS lookups for the malicious domain preventing the malware from triggering an alert and depending on how your VPC is configured DNS requests from lambdas may be prevented",
        "the screenshot you can see in the slide here demonstrates a Doh request that we observe the malware making",
        "as you can see the requested domain includes the string denonia which is how the malware got its name we can see the request is made to dns.google.com and it's clear from the URL that's where the resolution is performed",
        "once the request was made we observed the Doh server responding with some Json that included the IP that the domain resolved to",
        "you can see an example of this on the slide here so once denonia received this response the IP was then written to a hidden file named xmrig.json under the slash team",
        "directory",
        "this was interesting in a Lambda context because slash demp is the only directory that you're permitted to write to we'd also observe the malware updating the home environment variable to a value of Slash temp essentially setting the user's home directory there",
        "it's likely this was to ensure the XM rig functioned as intended",
        "with XM rig running in memory communication is established between the compromised Lambda and a custom meaningful",
        "the meaning tool resided at the",
        "ip116.203 0.4.0 and utilize Port 3333",
        "the screenshot shows the Json request body for the initial mining pool request",
        "the pill then responds with the status of the mining job as can be seen on this slide",
        "so we touched on this already but as I'm sure many of you know the only file system storage available for use by Lambda is the slash temp directory data stored in slash Dent is preserved for the lifetime of the execution environment and can be reused by multiple Lambda invocations",
        "given the ephemeral nature of Lambda functions items stored in slash temp are probably the closest you can get to persistence",
        "so this is beneficial to those behind denonia as Lambda functions are only granted a runtime of 50 minutes per invocation",
        "obviously this isn't very useful for operating a minor so having a config file processed across invocations allows multiple Lambda functions to be run with the same minor configuration",
        "this of course increases overall mining",
        "time which results in more Monero for the attackers",
        "finally this was an interesting discovery that we made during static analysis of the denonia binary and subsequent variants",
        "the screenshot you can see in this slide shows a number of user agents and HTTP request strings there were thousands of lines of these far more than indicated by the screenshot",
        "at first we thought that this might be indicative of botnet or DDOS activity but both static and dynamic analysis showed that they weren't actually used by the malware we're now under the impression that these were used to pad the binary helping it to evade EDR and malware analysis tools with file size limits",
        "since denonia is already written in Gold the size of the boundaries is quite large adding this extra padding could be enough to push it over a certain file size limits and defensive tools",
        "it could also be used to confuse eager analysts like myself obscuring the true objectives of the malware",
        "so to summarize we've looked at three distinct Cloud native malware campaigns all of which employ interesting detection evasion techniques",
        "although all three of these campaigns have the common objective of crypto jacking we've seen that the methods used to achieve this objective differ",
        "Linux specific knowledge is evident in each of the campaigns we've discussed which is to be expected given that the cloud essentially runs on Linux Cloud native attackers rely heavily on living off the land techniques and use Simple Linux utilities to craft custom process ideas and obfuscate their payloads",
        "most of the payloads we've seen are shell script based which makes them easier to detect and analyze",
        "but despite this the campaigns are widespread and effective",
        "perhaps the most interesting example is denonia not only is it a binary payload but we've seen the developers Target Lambda specifically potentially signaling a move to serverless environments for these types of attacks",
        "we also saw the denonia developers make use of relatively Advanced Techniques such as binary padding and memory execution and DNS over https",
        "these techniques would be notable in regular Linux malware never mind malware specifically targeting Lambda",
        "so that shows that will likely continue to see Cloud native campaigns mature and develop in technical sophistication",
        "now if you're interested to learn more about Cloud security then here are a list of references that we used when conducting research for this talk I've included interesting blogs from netlab 360 unit 42 lace work and anomaly",
        "these organizations are all well worth following if you're a fan of cloud security research or you work in this area",
        "now here's a list of our own blogs that we published about the malware families in this talk you can find these and many more in the blog section of our website kadlescurity.com blogs",
        "finally let me leave you with these three key takeaways from this talk",
        "we're currently at an interesting point in Cloud malware research we're campaigns Target include infrastructure are still lacking somewhat in technicality",
        "this is good news for Defenders as many of the techniques used in these campaigns are easily mitigated and detectable however the payloads themselves don't",
        "need to be hugely technical if they're effective the example from Johnny Platt the developer that was unexpectedly built forty five thousand dollars demonstrates that these types of campaigns are indeed effective and can have a big impact which brings me to my next takeaway the success of these campaigns depends heavily on mistakes made by customers of csps with this I refer to the deployment of misconfigured services such as Docker and redis as we mentioned automated scanners looking for security misconfigurations in these services are scanning the internet at a rapid rate to illustrate this when we first deployed a redis in Docker Honeypot it was compromised in only 12 minutes",
        "so I'll leave you with this third point to finish off cloud3 actors are becoming increasingly sophisticated and that's clear from the three campaigns discussed today although payloads are typically delivered as shell Scripts we've seen cases where Cloud threat actors have deployed more advanced Linux malware such as tsunami and Counting",
        "this makes me suspect that eventually we'll start to see a shift away from cryptojacking and onto more nefarious activities",
        "so I hope that everyone enjoyed my talk today and thanks a lot for coming to see it I don't think we've quite got time for questions but please feel free to contact me on Twitter if you have any I think you can also message me via the black cat vents app as well so I'm happy to answer any questions there so thanks again and I hope you enjoy the rest of the conference [Applause]",
        "[Music]",
        "[Music]"
    ],
    "5bNQnNdZeb0": [
        "foreign",
        "okay hi everyone welcome to scam issue scam scammers hakuzu hack hackers my name is Matt wixey I'm a senior threat researcher at Sophos before that I worked at PWC in the UK doing threat intelligence pen testing research and development uh before that I worked in law enforcement and I did this research with my colleague Angela Gunn who is also a senior threat researcher at Southwest previously worked in IR privacy and threat modeling and has extensive experience in journalism and as a columnist so today I'm going to talk to you about criminals who rip each other off on cyber crime forums we call them meta parasites so a parasite who feeds on other parasites and I'm going to talk about why that's not only hopefully interesting but also provides us and you with some insights and opportunities so I'm going to talk about the meta parasite ecosystem so the forums and marketplaces that they operate on I'm going to talk about how various scams work and why through some case studies and then I'm going to talk about why that matters why it's important so let's talk about that ecosystem so during our research we looked at 12 months of data across three forums Expo xss formerly known as damage Labs these are two russian-speaking marketplaces which tend to specialize in Access as a service listing so RDP VPN access is that kind of thing although a lot of other stuff goes on there as well malware is bought and sold sharing of criminal know how that kind of thing uh exploits slightly more exclusive and today it's had about two and a half thousand reported scams of its users scamming other users um xss has had slightly less so 760 but exploit does have twice as many users as xss and then we also looked at breach forums which is an English language uh Forum a Marketplace it's the successor to raid forums which was taken down earlier this year it's less exclusive and as the name suggests it tends to specialize in data leaks rather than access",
        "so a quick overview of the stats um as you can see it's pretty rich pickings so over the 12 months of data that we looked at scammers scammed users of these forums out of about two and a half million US Dollars uh that was only looking at scams which mentioned monetary amounts there were a lot that didn't and as you can see export suffered the worst although as I said it does have twice as many members the mean average amount of money that was lost due to scam as per scam is about the same across all three forums um which suggests that the scale of scams is consistent regardless of the marketplace you'll notice that exploit has two columns and I'll come to why that is a bit later but looking at the range of Forums on the bottom row you can see that they they really range from really small amounts or as little as two dollars in some cases right up to low six figures although this those tend to be quite rare so scams are pretty prevalent on criminal marketplaces and there are a few reasons why there's no recourse to law enforcement obviously it's a semi-anonymous culture the sites tend to be exclusive so there's a degree of implicit trust and alongside that criminals may be unlikely to consider themselves as potential victims uh it's also an open market with no regulation or QA in terms of the products that are bought and sold there transactions are conducted with cryptocurrency and while there are safeguards and I'll talk about those a bit in a bit they are optional and they can themselves be weaponized as well so just to give you an illustration this is from xss this is a snapshot of some of the scam reports and you can see that they tend to be quite low so 98 17 there is one for ten thousand dollars in there but as I said the higher ones tend to be uh anomalies and then on breach forums again it's like the low hundreds um so yeah on exploit I don't expect you to read all this but this is an example of a higher value scam so this one's for 130 000 relating to the sale of a kernel exploit in Windows",
        "so what a form's doing about scams because they're a big problem they've been going around pretty much since these forums started in the mid-2000s and they affect a lot of users so they've taken a number of measures they warn users about potential scams so this appears quite prominently when you log into breach forums warning people to use a guarantor which I'll cover later there are Ripper lists so on xss there is a very long list of so-called Ripper sites so these are fake marketplaces which try and defraud people out of activation or deposit fees typically of kind of 100 or so there are plugins so this is from verified which is a Russian language cyber crime Forum which we didn't look at as part of this research but on verified there's a plugin where you can check that you're on the right domain and you can also submit Java names for checking as well exploit has a similar plugin and then transparency reports so this is unique to breach forums but on the first of every month breach forms publishes a transparency report to confirm that its infrastructure hasn't been compromised that's probably a result of what happened to raid forums earlier in the year but the main thing are the Forum moderators and administrations are doing about scams is they set up dedicated arbitration rooms and these again have been running pretty much since the forms were created um so export actually has two it has an arbitration room which is for open scan reports and then it has a blacklist which is for confirmed scam reports",
        "other sites like verify do have these as well xss along with its thread for Ripper sites also has an arbitration room so the arbitration process on these forums is pretty simple if you've been scammed by another user on the Forum you go to one of these arbitration rooms and you start a new thread and you supply some information so on breach forums you have to supply the name of the user that scammed you you have to link to the thread in which you were scammed provide some sort of proof of purchase and then notably you have to provide details for the scam so screenshots the more information the better and I'll come back to that later similarly on xss you have to provide a link to the scammers profile contact details and evidence which in this case includes chat logs screenshots wallet details and details of transfers what then happens is the moderator reviews the report they ask for more information if it's needed and they will then tag the accused person and give them somewhere between 12 and 72 hours to respond depending on the Forum so here you can see an example of that the moderator has responded to a scan report and given the the accused scammer 24 hours to respond what might happen then is that the accused user might accept that they've scammed the user and make restitution that's pretty rare as you can imagine what more commonly happens is that the scammer um or the person accused of being a scammer disputes the report which is the case here so the accused scammer has said it's due to a misunderstanding of the terms of the sale not due to any deliberate fraud",
        "in this case the moderator acts as an Arbiter and decides who's in the right and who's in the wrong typically though people who are accused of scamming just don't respond and in that case they're either temporarily or permanently banned in other cases the moderator might close a thread just because of a lack of evidence as in this case on breach forums or they might find for one party or the other or both parties as in this case where they have given the accused scammer 24 hours to pay back 50 of the claim rather than the full claim because both parties were to blame",
        "um what you do sometimes see which is quite unusual is this case in breach forums where the administrator personally compensated a scam victim um to the tune of 200 so we only saw one example of that that was quite rare more commonly what happens is that the person accused of scamming launches their own counter accusation and says that the person reporting the scam is a scammer and you end up with this kind of very oroboros kind of loop um so this is what happens here the person accused of being a scammer has called the person reporting the scam a scammer and a ripper which just goes to show kind of how important people's reputations are on these forums if you're accused of being a scammer it's really damaging to your trade and no one will want to trade with you so I mentioned temporary and permanent bans on exporting xss if you're banned you're just band and you can't log in under your um your profile a lot of dedicated scammers will just set up new profiles and log in with those on breach forms they do it slightly differently and if you're banned the admin will publish your registration IP your last known IP and your email signup address so essentially partially doxing you um presumably as a deterrent to other scammers",
        "so when we first first started looking at this research we thought um it would just be pretty small time criminals and threat actors involved in this but we did find a few examples where more prominent threat actors were involved so this is a scam report an arbitration request which someone has uh has reported um targeted at the operator of Conti the Conti ransomware group on behalf of a Conti victim and what they're saying is basically quantity of being too greedy and asking for too much money we originally thought that this reporter might be an employee of the company but when we looked at their profile we found that they'd been on exploit for about three years and they'd expressed an interest in buying and selling stolen data realistic data so they appear to be some sort of threat actor in their own Riot um so their relationship with the victim in this case isn't clear they might have been hired by the company or or something like that the user Alan Wake is a prominent threat actor named after a computer game they were a sponsor of the most recent contest on xss so both export and xss run annual offensive security research contests they've previously been accused by a lot bit operator of being the the leader or senior member of conti and black bastard ransomware gangs in this case the user has accused Alan Wake of not paying the user's salary for making traffic from from web shells um this complainant as you can see was eventually banned not for scamming but for as the administrator put it inappropriate behavior",
        "and then lastly a prominent carding group called all World cards were themselves the victim of a scam all World cards are also a previous sponsor of contest on xss in this case um about a year before lockbit announced its bug Bounty program all World cards did the same thing and launched the bug Bounty program and they were scammed out of two thousand dollars when someone sent them a video of a fake vulnerability in their store so they sent an advanced payment and the vulnerability turned out not to exist so one of the reasons that scams are so prevalent on these forums is just the sheer diversity and amount of scams um so I just wanted to pick out a few to highlight the first is rip and run which is probably the crudest kind of scam there are two variants of this a buyer receives goods and doesn't pay or a seller gets paid and doesn't deliver the goods that's the rip part and then the run is the scammer refusing to answer messages and just disappearing from whatever platform it is usually these are for pretty small amounts but there are some exceptions and the scammer is usually banned for these so here's an example from breach forums of a rip and run scam report where someone tried to buy a crypto account so accounts on a cryptocurrency platform they sent the seller money and then the seller just disappeared without giving them the data slightly higher value rip and run on exploit this one for fifteen hundred dollars where someone um received fifteen hundred dollars and then just stopped responding and disappeared from jabber the platform that's being used there and then an even higher one from xss this for four thousand dollars uh someone wanted to buy a builder for XLS macros and paid the money and then the Builder never arrived so these are pretty simplistic kind of crude scams fake leaks and tools so these are really common with databases so very popular on breach forums they're also very popular on raid forums as well here you have scammers uh selling databases to users which are either already publicly available or have previously been leaked or they claim to be exclusively sold and then they resell them to multiple users um so here's an example from Beach forums where someone wanted some data from Germany um they paid for it and then it turned out that data was just randomly generated so it wasn't actually real data at all here's an example from exploit uh this one is not a database it's a service so what someone wanted to do here was they wanted someone to bind and executable to a PDF with the intention that when the victim clicked on the PDF the PDF would load and then in the background the XE would run silently so a malware um so they paid 200 for this and then what the scammer actually did was just sent them back in executable with a PDF icon which wasn't what they were after um so this person opened up a scam report so this is kind of less outward fraud and it's more just hoping that the buyer doesn't really know what they're asking for how to check it and then finally on exploit again this is one to do with invalid credit card data which is pretty common so when credit credit card data is bought and sold on these four rooms they will typically advertise a percentage they'll say 30 of it will be valid and in this case it was a lot less as you can see ironically the person who's opened this scan report was themselves later banned for scamming we also found that to be quite common as well a referral scam so these are two or more scammers working together and what happens here is that one will build a rapport with the victim um to do some sort of work or provide a service they'll then say um that they know someone else who can actually do this work much better who's an expert on the subject and they will often Point them to a forum where this second person works and operates that form will typically be a scam Forum which requires some sort of deposit or registration fee the victim pays the registration fee and then both scammers just disappear and because they're operating the fake Forum so here's an example here of someone who paid 240 for this is actually a bit more than 240 they were introduced to a second scammer who could um build this config for whatever it was as part of their scam report this person also uploaded this as a screenshot from a private chat on telegram this is them talking to the first scammer about the second scammer and you can see from the first two messages they've got some doubts about the trustworthiness of the second person the first camera reassures them and as you can tell from the last three messages both scammers then disappear",
        "uh alt ripping and impersonation so alt repping is a variational referral scams uh here what you've got is one scammer operating multiple accounts to inflate their reputation score which is a really key metric on forums when you're deciding who to trade with um so um",
        "so an example of this is um hear someone creating two multiple accounts to try and resell uh the same items so someone bought an access listing for a thousand dollars and then found that the same user under a different name on a different Forum was setting the same access listing so that's an example of alt ripping and impersonation a much stranger case on xss where one user was operating two accounts set up a trade between those two accounts and then opened up a scam report reporting one of those accounts as a scammer presumably because they thought the Forum itself would compensate them for that but the admin saw through it and just banned both of the accounts we also saw impersonations so people impersonating known users on forums on other platforms like telegram or jabber so this is an example of that in order to either jump into in progress negotiations or to just try and um artificially kind of inflate their reputation",
        "fake guarantors so on criminal forums guarantors sometimes known as middlemen or middles are essentially an escrow service so they hold funds until they've had confirmation from the buyer that the goods have been received and are as expected usually they take a commission for that as a percentage although on breach forums it's offered as a free service if you refuse to use a guarantor when you're asked to it is a bannable offense on some forums as you can see here on xss um but some scammers weaponize this concept so they will conduct impersonation attacks whether register a misleading telegram or jabber name as here um to try and trick people into sending them funds so you can see you've got um someone registering a jabber name with guarant at the the start of it and then a misspelling of the exploit Forum after it similarly on xss uh someone trying to pass themselves off as the admins on telegram for pretty much the same reason so as I mentioned earlier exploit has a safeguard it has a fake jabber Checker so you can submit a jabber name to it and it will tell you if it's legitimate or not",
        "blackmail so we only saw one example of blackmail and it wasn't the blackmail that we thought it was going to be it wasn't someone threatening to dox a user or report them to law enforcement or expose them to another crime group or anything like that it was a buyer of data who threatened to accuse the seller of being a scammer if he didn't send them more data for free which just shows how seriously users take their reputation because it's their it's their livelihood",
        "backdoored malware so we saw a few examples of this where people bought malware that they alleged was then backdoored so an example of this is a product called cipherat which the complainant here alleges when you install it installs a back door in your machine and then stops you from using it anymore we also saw uh this scam report so someone here wanted to buy a fake copy of something called axi Infinity which is like an nft based earn as you play type game so what this user wanted to do was defraud legitimate users of axi infinity by Distributing this fake copy and then siphoning off their funds the fake copy they bought contained a back door which then stole the stolen funds as you can tell from that scam report the the irony of that situation situation was completely lost on the uh the reporter",
        "um backdoor malware isn't unique to marketplaces so there's a security researcher who goes by a Bushido token on Twitter who's previously reported about software piracy sites serving up malware Builders backdoored with info Steelers and jfrog the security firm in February this year reported on malicious npm packages containing code designed to steal stolen tokens from threat actors who had themselves stolen them from legitimate users",
        "and then probably the most common attack we saw which range from pretty crude to very sophisticated was typer squatting fishing and the use of Ripper sites and fake marketplaces so um this is a clone of the exploit forum and uh typically this fake Marketplace is designed either to trick users into paying a deposit or an activation fee or to harvest credentials for genuine marketplaces and there are a number of reasons why people might want to do that they might want to steal funds the people store in these marketplaces they might want to impersonate a particular user ruin their reputation or artificially inflate their own reputation so this is an example of the exploit one which was spelled as xplault it redirects to the genuine site upon login amusingly with this one when someone reported it on exploit export users found across like scripting vulnerability in it here's an example of a similar Forum fake Forum being used in conjunction with a phishing attack on Jabba so someone here is both impersonating an admin on exploit and trying to get someone to click on a fake export link we also saw a clone of xss called xss",
        "which redirects to a PHP page upon login presumably it's a process install credentials there was also a site called xsx which as you can see here demanded 100 registration fee it looks nothing like the the actual xssi but it's presumably set up so that people unfamiliar with xss might be fooled uh so some people have fallen for this this is an example of someone an exploit who got fished um using a fake exploit Forum as you can see again they themselves were later banned for scamming and ripping themselves um we also very commonly saw um people using uh domains similar to now defunct marketplaces so mazafaka is an example of one uh direct connection is another um so people trying to get users onto these fake forums where they were then scammed out of activation and deposit fees",
        "so this is another direct form example and note again that someone's uploaded a screenshot of a private chat to their scam report and again and again and you can see here that the person has said um I've had so many people take 25 or 50 payments from me so people do fall for these consistently sometimes there are fake sites that are unrelated to marketplaces that try and scam users so one that came up in an xss scan report was grimexploit.com so here I use a rented malware which worked for two days then the C2 panel disappeared followed shortly by the site's owner and this is what Grim exploit looked like at the time and then lastly on scam types we found a few examples where people were so annoyed at being scammed that they tried to scam the scammers who had scammed them um in some way or fashion so on xss a user who was really annoyed at being scammed uh docks the scammer and revealing their name address phone number social media profiles and just to add insult to injury also published their mother's name number and passport number and a couple of photos as well",
        "um the funniest examples though are on breach forums so um one example from Beach forms was someone on telegram claiming to be omnipotent now omnipotent is the it was one of the founders and admins of the old raid forums and the scam was that they were trying to get people to visit this new raid forums and New link and um they afford them of 250 as a joining fee",
        "so the admin of breach forums set up a contest and said I'll give a hundred dollars in Bitcoin to whoever trolls this scammer the hardest um so there are a number of entries to this contest I'll share a couple with you um this one so someone messaged the scammer and said I've been trying to get on this new raid Forum site and I just can't I keep getting this error page here's a screenshot and sent them this so as you can see it does contain an error page but there's a very subtle subliminal message in the background as well for the scammer um the eventual winner of that contest was this person who um showed the scammer a server status page for the fake grade Forum site and managed to convince them that it was a critical security hole that was in danger of being hacked imminently leading to the scammer taking the site down",
        "um and then there was an instance where the breach forms admin scammed a scammer personally so what happened here was a scammer registered a telegram name very similar to breach forums and was trying to sell users fake databases so the breach forms admin emailed this scammer and said to them you know who I am would you be willing to sell me the telegram name and we can kind of put an end to it so the scammer said give me an offer the admin said uh ten thousand dollars after a bit of back and forth um and that was agreed the admin said I could pay you via Bitcoin or Monero whichever you want um the scammer then got cold feet a little bit and said what stops you from scamming me switch the admin said my reputation I've got a reputation reputation to maintain I'm working really hard on this forum um I wouldn't scam you so yeah the scammer said okay you're the owner of this telegram name now and transferred all the permissions to the breach forms admin at which point the breach forms admin uh booted the scammer off of it and unsurprisingly didn't pay them ten thousand dollars uh the scammer wasn't thrilled about this as you can imagine and sent various fake threats to the breach forums admin um this was the preach forums admins response",
        "so",
        "um eventually I think that scammer did try to deal speech forums but didn't really get anywhere with it um so yeah so since then there's been another contest um against the same scammer this time for 300 so yeah",
        "so I want to talk now about a particular case of um of scamming that we saw which involved a network of 20 fake marketplaces this didn't actually take place on any of the marketplaces that we looked at but it's it's kind of related to them so the starting point for this um a few months ago a colleague of mine Angela did an article on Genesis Market and she came across this clarinet site called genesismarket.org which appears really high in the Google results when you when you Google Genesis market now this looks nothing like the genuine site um it for one thing it demands 100 deposit which the real Genesis Market doesn't it's Invitation Only and it asks users to pay this hundred dollars in Bitcoin and Monero now we noticed a few things about this site um this weird onion Link at the start the fact that the lost password functionality doesn't actually do anything um they were like uh really obviously falsified Forum posts on this fake site as well and we assumed this was a really crude one-off scam basically designed to rip off script kiddies maybe the odd inexperienced researcher as well but then a few things peaked our curiosity so the first is that onion link on the home page doesn't actually link to that site it links to another onion link with the word be Nom in it so B num is a carding site and we wondered if someone from binom was maybe running this scam and made a mistake with um with putting out linking the second thing was that this copy address button here which ostensibly copies this Bitcoin address to your clipboard actually has some JavaScript which copies a completely different Bitcoin address to your clipboard and then the last thing was that someone was actively promoting this fake site on Reddit as well so we thought it was maybe more coordinated than we first thought so we visited the Phenom link and we found a site that looked pretty much identical used the same template it looks again nothing like the genuine B num site and again it's asking for a hundred dollars uh via Bitcoin or Monero we also saw that the credit card numbers on the home page are here were identical to the ones on Genesis Market um leading us to think it's probably the same person behind both of them so we then started querying search engines for portions of the text in the activation notice the credit card details and the cryptocurrency addresses and all in all we found 20 sites registered between August 2021 and June 2022. there may be more of them by now virtually all of them imitate either existing or defunct criminal marketplaces including unicc uh yarrow",
        "Lodge wwh Club Brian's Club poison cards",
        "and more all of them ask for a hundred dollars all of them have a similar look and feel some have that clip called substitution script and some don't there are some minor differences in terms of the background color in the Spiel and that kind of thing but generally they're the same and some of them are being advertised on Reddit as well so this is the full list I've clipped out the Monero addresses just so the table fits on the slide as you can see most of these are Clearnet there are three onion sites and there's one clean outside that's masquerading as an onion site they all have pretty similar hosting details um you know not all of them are active anymore and as I said there may be more to add to this list now so how lucrative has this scam been um so we had a look at the Bitcoin balances we couldn't look at the Monero balances because of the way Monero is designed but there has been a total of 132 000 coming into those Bitcoin addresses um and a current balance of only 1600 so a lot of that has now been moved out um some addresses however made their first transaction before the site associated with them was registered so some inputs might be completely unrelated to the scan but even taking those out the final tally coming into those addresses is over eighty seven thousand dollars so a pretty lucrative um sideline so we went to see if we could find out who was behind this scam so we found a possible clue on some of these fake marketplaces there was a footer linking to darknet dot markets so there are a few versions of this site there's also darknetmarket.org and dot dot markets they're all pretty crude directories of marketplaces and vendors and as you can see here they look similar to the scam sites they have similar hosting and registration details and they also list some of these fake marketplaces we also noted that some of the activation notices the ones that ask you to pay 100 I mentioned Cafe dread which is a criminal Marketplace although it's one that has quite an emphasis on drugs rather than pure cyber crime so we looked on Cafe grid and we found a post by this user called Walt Cranston who came to have made darknet.markets um that post has since been deleted we found it one at least one user on Cafe dread who had fallen for one of these scams so in this case the B num one and we dug further into the the index sites that are dark net markets and so on and we found that what cranston's own site was advertised prominently on them um so Walt Cranston is a self-proclaimed methamphetamine vendor and by their own admission they're based in the US this is their website so there are some visual similarities between this and scan marketplaces again some similar hosting and registration details uh Walt Cranston also authored a post on one of the fake Forums on one of the scam Marketplace sites so we looked at what cranston's post on Cafe dread we found that there was a familiarity with sites like genesis Market that they had",
        "given other users advice to tailor-make fishing sites to specific markets and shops and this very inspiring quote about uh",
        "stop vending drugs and then becoming a scammer so we found that a user on dread had come to the same conclusion as us and accused Walt Cranston of running all these scam sites um Walt Cranston didn't deny that allegation they did respond to that thread um and the reaction from other users on Cafe grid was pretty mixed so some of them thought um it was uh pretty bad that this person was running these scam sites and scamming people other people thought it was actually pretty clever um I will emphasize that most of the evidence linking this user to the scam marketplaces is circumstantial there's no direct concrete attribution um but there's certainly some circumstantial evidence um and because of the nature of the offense the methamphetamine and the fact it's based in the US we've passed that into the appropriate Authority so lastly uh why does any of this stuff matter um I mean it's interesting some of it's funny but why is it actually important so um many criminal marketplaces if you remember from the start of the talk demand proof when a scam is alleged and that includes things like screenshots and chat logs and that kind of thing and victims are typically only too happy to oblige a minority of them redact that evidence or restrict it so it's only visible to a moderator but most don't they will post unredacted screenshots and chat logs which often contain a treasure Trove of cryptocurrency addresses transaction IDs email addresses IP addresses victim names source code and other information and that's in contrast to most other areas of criminal marketplaces where obsec is normally pretty good so maybe scan victims assume nobody's paying attention to arbitration rooms or they're just so ticked off about being scammed that their normal precautions take a back seat so we looked at the most recent 250 scam reports on all three forums we found that almost 40 percent of them included some kind of screenshot 53 contain text only accounts",
        "of the scam of the going considerable detail about the negotiations that led up to it only eight percent of scam reports restricted access to evidence or offered to submit it privately so this is an example of a typical scan report which includes 14 screenshots including screenshots of private conversations contact details and so on you'll notice there is some stuff redacted but that's stuff that we've redacted we've redacted The Forum name from this but um the screenshots themselves here weren't redacted at all so some examples of the kind of things that we found in these scam reports we saw numerous screenshots of negotiations and sales complete with cryptocurrency addresses and links to transactions so that potentially gives you both parties in a transaction both cryptocurrency addresses as well as the date and time of course some threat actors may still apply anonymizing measures to those but it's certainly better than nothing so you've got a Bitcoin one here's a an ethereum one this person's done a full screenshot of their desktop which shows you not only the Bitcoin um or the cryptocurrency information but also the date the time the weather the language and the applications they had open at the time as well in a similar vein we found a number of people posted series of screenshots that contained uh full screenshots of their desktop including again date time and language tabs that they had open on their browser which included email addresses email names applications that were open helpfully proof of purchase in the form of an invoice and in this case the usernames of other people that they were talking to at the time again you've got date time whether language and applications are open unfortunately with this one you can't type much from the the tabs at the top because there's so many of them IP addresses we found a few of these typically they were seen while users were troubleshooting or as proof that malware or in Access wasn't working so again this is stuff that we've redacted it wasn't redacted in the original but you have IP addresses here you have a MAC address from a Wi-Fi adapter as well as names of people that the complainant is talking to at the time and here you have an IP address and a computer name as well",
        "uh malware source code so this was pretty rare we only saw one example of this but um yeah full malware source code a screenshot of it again along with date and time and other applications that were open at the time were being used uh victim names so typically on criminal marketplaces if you're selling access as a service whether it's IDP VPN whatever you don't normally name the organization instead you provide a link to zoom info or something similar where you can it will show like the revenue the sector the country that kind of thing but you don't name them because you're concerned about organizations being tipped off to the fact that um they've been compromised but we saw a few examples where scam complainants posted detail catalogs which included victim names I mean this one's for a database it tends to be a little bit more common for database victims to be named but this one is for Access as a service advice Cisco in this case I think so you've got unredacted links um to the zoom info thing",
        "and then negotiations and plan campaigns so we saw several cases where scam complainants posted detailed chat logs about projects and attacks as here so the complainant in this case is not only",
        "talking about the actual scam but they've included a chat log which sets out exactly what they want to achieve in this case it's a Spam campaign they mentioned the head of a very private team of spammers and they want to do this specific thing",
        "and then here there's detailed information not only about a possible sale of exploits but also the alleged scammers GitHub profile and a website containing vulnerabilities which they've purportedly found and again you have applications installed on the compliance machine that talks name the date time temperature and weather so in this case uh you can see the button there's zonig I'm sure I'm mispronouncing that but Sonic is Dutch meaning sunny I mean there is one caveat to this stuff is that since these details are posted in arbitration threads they can't always be relied on upon to be representative of the underground economy as a whole but they do provide a starting point and since scam reports are created by both buyers and sellers there is material from uh legitimate users on both sides of the transactions and as I noted only eight percent of scam reporters in our sample in the data we looked at offered to send evidence privately as this user did here",
        "so I'm going to wrap up and talk about the key takeaways so I guess kind of one of the biggest takeaways that we found is that the underground economy is absolutely riddled with a really wide variety of scams they net scammers billions of dollars a year just on the three marketplaces we looked at and as Microsoft noted it way back in 2009 these scams result in an effective tax on criminal marketplaces uh making it more expensive and more dangerous for everyone else to uh to operate in so three key takeaways from that is that um the first is that scam reports could be a really rich source of intelligence um while some threat actors do have solid operational security um it often for a lot of them seems to Fall by the wayside when they've been scammed so we found numerous instances of sensitive data to remember both details and screenshots and chat logs attached to scan reports uh in some cases that's discrete identifiers which could be used for tactical specific investigations in other cases it was more general information about negotiations sales attacks and projects so in general scam reports can be useful both for technical intelligence and for strategic intelligence because they give insight into things like rivalries and alliances wider Trends and foreign cultures",
        "second key takeaway is that threat actors don't seem to be immune to deception social engineering and fraud in fact they seem to be as vulnerable as anyone else which is kind of interesting because they're the exactly the kinds of techniques that they're doing against other users so that implies that certain",
        "kinds of defensive techniques things like honeypots decoy data Canary data and similar measures might be worthy of more attention investigation and research and development",
        "and then lastly we hope that this research will help prevent a number of people including inexperienced researchers analysts journalists law enforcement agents and any others who monitor criminal marketplaces from falling victim to some of these scams themselves they're obviously not the primary target um but scammers don't really care where the money comes from um so ways in which those users could fall victim is giving away credentials um you know genuine credentials to fake marketplaces or paying to access closed forms which are actually Ripper sites some things that we'd like to do in the future I mean this has been quite an exploratory dive we're not aware of anyone having done research into this before we hope it's a start of more research in this area there's a lot more we want to cover so we'd like to do more detailed quantitative studies of scams we'd like to look at a broader range of marketplaces other than the three that we focused on and we'd like to explore and learn about other scamming techniques that are out there and being used uh if you'd like to know more we're publishing a detailed series of research blogs on this subject the first one I think is going live in about an hour that will be on new sofas.com and then there'll be three parts after that every Wednesday um subsequently up until the 28th of December um so thank you very much I hope that's been interesting and or useful if you'd like to know more get in touch privately both myself and Angela or Mastodon so feel free to message us there otherwise I'd love to take any questions now by the two microphones in the office thank you foreign [Applause]",
        "foreign",
        "[Music]"
    ],
    "Lz8NMkirn1I": [
        "foreign",
        "Welcome to our talk my name is Tao Yen this is my coach speaker Ken today we're glad to be here to share our research about using Code patterns to find a bug variants and exploitation Primitives in binaries with the help of our new panel search too you can see our title is a secure statement actually it's a valid Circle query which can be processed by all new pattern search too and you can use it to find code patterns like whatever you want we are security researchers from Pilot networks we have vulnerability researchers control winner conference",
        "speakers in the meantime we are regular patent inventors for new defense and detection techniques",
        "here's the agenda firstly we'll cover background challenges why we need codependent search and why we need a new code pattern search too for binaries",
        "second we'll cover everything about a new pattern Source 2 for boundaries and then we'll introduce how we create and search for unique code patterns in windows binaries with R2 and final",
        "vulnerability variants and exportation Primitives last summary and takeaways",
        "why we need cold static code analysis on one hand developers made similar mistakes repeatedly for example there are huge number of memory copies string copy vulnerabilities most of them are caused by not carefully checking the copy lens besides there are some bad apis such as SM printf or return unexpected lens which will be misunderstood or misused by Developers on the other hand similar vulnerable codes appear everywhere but might possibly be patched in one place so in those situations static code analysis a way to locate possible vulnerable codes if we can categorize a similar vulnerabilities and extract code",
        "patterns code pattern search is a good method for vulnerability variance",
        "Discovery however code pattern extraction is not always easy to complicate it or too simple are both not good besides there's no code pattern search to to effect eventually",
        "um a search coder pattern a huge amount of binary modules called curl is awesome but it is only for open source code software in our presentation we'll introduce our research and practices to solve those challenges",
        "then we'll come to the first part a new pattern search 2 for binaries I will hand it over to my code speaker Ken",
        "all right before we get to the juicy part I will do a brief intro on the biofin the tool that we build ourselves because Pac-Man to the best of our knowledge let us know of the short solutions they could do binary core pattern search in binaries we also decided to build our own quality language because to facilitate the",
        "research and then automate aware the pivot task",
        "but it does get quite annoying at times we have to constantly modify in the scripts uh enrollment against thousand binaries the tools built on either python x-rays API the dependency on c3's reversal makes the tool for my agnostic and generic Mark you it is not a full blown tool because it's primary driven by our research it should be sufficient for hunting bug variants and core patterns they have security implications some tweaking stack is needed though for Generate reverse engineering",
        "here's a list of features they are currently supported the search Primitives are not only capable of finding variants and functions for our interests but also called patterns like",
        "integral flow expression in loops and conditional checks in addition enter and intra binary cross references are also also supported and of course the analysis is like a must-have nowadays",
        "this is how our Tools looks like on the high level Leviathan is the top layer that handles user interaction as well as parsings queries and dispatching jobs here is the second layer that interacts with our Leviathan library to carry all the work the third layer Leviathan util is our library provides abstraction to either pros apis and structures for our handlers you may notice that the inputs from query mode and script mode they have they have different rounds in the first two layers eventually Leo tap into this layer to get a drop down at last all the heavy lifting is done by either Pro and the hexade compiler",
        "in addition to aforementioned code basis we have three databases command database is used to encue jobs it's from this database they are handled that will fetch the command query based on command hash and does the work analysis results as you may have guessed it is used to store the result the result of each job is stored as a table this allows quicker lookup if the query has already been executed before when being info contains workspace that stores the basic information of the binaries as well as the let the user wish to query",
        "so what is a workspace exactly in our terms essentially is a database table that contains all the basic info of all binaries in a specified directory this basic info includes function names Imports and Etc a workspace is created via any command when a user wishes to work on a set of binaries in addition to info extraction there are some simple heuristics like kick in and categorize the binaries for example a system Services likely have specific permission related enforce like impersonation and reverse self",
        "services like RPC interface typically",
        "have higher privileges so it's also worthwhile extracting this info we did so by leveraging the idol plugin code of fine RPC the characterization can speed up the subsequent search process because the user may only be interested in the subset of binaries they share similar features and functionalities",
        "here's a list of commands like advising career supports init initialize the workspace set workspace is like switching to an existing workspace show workspace pretty much shows the current info of law workspace query enters the prompt for",
        "the command uh query and create an access that's pretty self-explanatory",
        "this is a diagram that shows what happens underneath when the user initialize a workspace the main Handler first creates an empty workspace or empty table provides sorry it involves the init Handler to process all the binaries in the directory in extract all the relevant info and store them in the workspace",
        "foreign this is the workflow when the user enters a query command as a prompt when the main Handler receives and process a query it fetches the target list of binaries from the workspace for the Target filter and then enqueue the command query when handlers involved against the binaries it first fetches the command query does the job and save the result finally the main Handler fetches and displays the result",
        "there are two search modes that the user can initiate in there at the query prompt the first one is the SQL query mode just like any typical SQL query",
        "it's designed to find a result in one or multiple SQL statements and then there's a script mode it offers more control on the granular level since its comp is a combo of python script plus our custom query syntax and apis which we will get to in a second a library mode that only has partial access to all of the biotense capabilities script mode has full access and thus it can yield results with better accuracy",
        "the query parcel is based on SQL Parts a python package for processing SQL queries since we have our own syntax implementation it's nowhere near any of the real SQL query process used in real databases while this mode only has access to a subset of capabilities that we provide in the marathon is there enough to handle common texts like conditional checks on functions arguments as well as for analysis within the function as shown in our design and diagram architecture slide every dispatch SQL query command is handled by a general Handler the idar Handler",
        "this is what a query format look like output filter is the selected output that a user wishes to display is the binaries in your target workspace it can be a subset of binaries depending on the qualifier this is where the binary characterization comes in handy as the hand the user may choose availability Service as Target for example finally we have our own constraints like keywords and operators to narrow down our search",
        "here are some examples that we actually use for bar hunting the first one is looking for Target function with specific argument and type",
        "the second one is searching for Target function in all binaries in the current workspace the last one is looking for functions containing the target function call in your target binary if search functions are found do flow analysis from a second argument of source function till the third argument of sync function",
        "in order to get our big back end and handlers to work with the user Supply SQL queries these queries first have to be parsed and transformed into a format that both the handlers and the backend can understand which is a python dictionary and this is exactly what a query parser does as you can see here the conditions and the corresponding key value pairs are color coded in the same color to give you a better visual on the mapping",
        "once the query is parsed and stored in the queue it's unfetched by the either Handler as shown in a snippet the Handler extracts the desired key value Pairs and passes the value to the appropriate API based on the keys in this example the query command is looking for functions containing calls to import function low Library EX with specific arguments this the plus the argument sorry lastly Handler first initializes import color Tracer and then sets the anchor condition before you finally search for match functions",
        "the reason why we chose python dictionary because it makes these two criteria first you can nicely represent your parse user input second it works well with the condition back lookup and very value comparison in a structured manner since it's straightforward to convert a dictionary to Json and vice versa it does provide some degree of flexibility for future changes if any and of course this design is now final we'll go with flow when it will adjust how we receive it as mentioned earlier SQL query mode only has partial access to the search parameters it is not by Design it's simply because it's hard to abstract certain patterns nicely in SQL format as you can see here in this one um the format can be quite convoluted",
        "it's technically doable but it's not very user friendly in addition now all features are worthwhile incorporating them into SQL query mode and that's what will result to a stream mode",
        "the plugin used in script mode is specialized version by creating our generic query Handler totally customizable by the user within this plugin the user can leverage all search Primitives and API to find core patterns of their interest",
        "this is what the format looks like pretty similar to the SQL query format the only difference is the keyword pattern this is how the Handler knows which mode you should operate in",
        "and this is how a screen mode plugin may look like in this example the query invokes a plug-in code into overflow which searches for integer overflow expressions here's C5 traversal is the key API that's used to Traverse the C trees and control flow graph the set constraint functions is a function that allows us to do flow intent analysis by passing the first argument constraints we effectively Define the scope the second argument is optional and is expression pattern that represents the core pattern that a traverser should look out for while it traverses the tree in this case it's looking for integer overflow expression pattern the third argument is also optional it's used for specifying 10 sanitizer we Implement our 10 sanitizer this way because there's so many ways to skin the cat",
        "so this is our utility and such parameters provided by Leviathan",
        "basic utility apis are essentially just a wrappers that wrap around the Ida Pros apis for our need import color Tracer is a helper performance function matching as well as common color tracing conditional checks on their arguments and value are actually done by C fund traverser C fund traversal is the soul of Leviathan it provides apis and",
        "let users can use to do function matching copy them search as well as tend analysis",
        "so this is the format and example for function matching we have seen this before when we're talking about query mode and how it works",
        "and this is how it works underneath for condition one you traversal first Finds Its coal C item and then checks for the function name if the function is indeed a match it then proceeds to check the subsequent conditions condition 2 and 3 applies to argument one's value and type so the traversal travels to argument ones corresponding C item extract is type and value and just a check against the target values condition 4 requires checking augment 3's value along with a bit mask so this time you try pressure extract argumentaries value apply the beef mask and just a check",
        "our expression matching format on the other hand is quite different since its intended usage is for specifying expression as well as hand sanitization",
        "here's an example of real values the other condition is like an anchor and the C item matching the anchor condition is like a current pointer as the nested",
        "although necessary conditions won't be checked unless the anchor conditions are met next is like the next pointer it instructs where the sea function traversal should move the anchor to this is important because our expression pattern matching is relative not absolute",
        "and this is how it works underneath the conditions and and the corresponding keyword pairs are again uh color coded in the same color to give you a better visualization the dash pink arrows indicate the places that the anchors was previously pointing to a pointing to them the solid pink arrow means this is where the anchor is currently pointing at know that every condition is relative to where the current anchor is as a traveler troubles down a tree or condition must be evaluated to be true otherwise it will just stop and quit and thus the expression fashion is not considered a matched",
        "full constraint is used to set boundaries for our 4 and 10 analysis boundaries are defined by all path from the source to the sink each basic block in a path contains a list of C item indices Each of which are ordered by silica line numbers and our SC trip also is done in that order additional expression matching and tension can be applied during the process essentially just like a dictionary of dictionaries in the code",
        "python has this awesome feature that allows one to add attributes to object at runtime and this is exactly how I do my painting by adding the tended attribute to every C item as soon as the source is set in concept constraints the 10 starts to propagate conventional propagation rules during the propagation process the variables are of course tracked so we know whether the variable of our interest at a specific line is tinted or not",
        "LeBron also supports correspondary course references it is done by our cross ref cross ref Handler which basically leverages all the apis that we have just described in this example the Handler first find the core path to export from the cross 4 sync from the previous job Eden tries to find the colors that involve this export functions in this current job finally it enumerates the core path of all colors in search for crossfall source and that's how you build a relationship from the source to the sink now that we have some high level understanding about the towards capabilities I will hand it back over to Tao and he will show you how this tool is used in real bug hunting",
        "thank you Kim so we know all details about our new pattern search too for binaries let's see how we use it to search unique patterns and find vulnerability variants and Export exploitation Primitives",
        "we'll introduce four unique code patterns covering memory corruption vulnerability logic vulnerability and exploitation Primitives",
        "let's start from the simple but classical fire hydrating vulnerabilities you can see there are two seed vulnerabilities the first is the classical DL hijacking vulnerability you can see the vulnerable function called Low library to load a non-existing DL",
        "so if the attacker create a fake DL in a directory from the past environmental variable and when the nervous function is called the fake DL will be low load successfully the second one is driver installer file hijacking and you can see this file pass can be fully controlled by the standard user so the standard user can modify override or create a fake hello phase.if",
        "and lead to some unexpected situations",
        "it's a straightforward to abstract the vulnerability model for the file hydrating pattern you can see firstly create a fake file trigger the file access and high privilege application access as missing file and the load or open the fixed file which will lead to privilege escalation Wireless bypass Etc",
        "based on that we can extract the classical DL hijacking vulnerability pattern you can see we will firstly search sensitive API calls such as low Library load rbex and query optional delay loaded API Which is less recognized but can also lead to DL hijacking vulnerabilities you know we also don't want to make sure the DL file is a constant string and not ends with a DOT DL now start with API Dash now loaded as data or resource and most importantly not existing in a system directory with that we can create code queries for those three sensitive apis you can see our queries search the the function contain the sensitive apis and check the argument type value and",
        "uh and last we'll uh check if the DL",
        "file is not existing in a system directory running those queries we got those kind of results load Library six four",
        "um low Library ex five to one and the query optional delay load API will find file result permutation the last one which is very interesting it is related hyper-v host Computer Service and named",
        "VM compute and the vulnerable function actually called the query optional delay loaded API to load a ccglaunchpad.dl which cannot be found found in the system directories",
        "to find the triage we Traverse all call Path aesthetically and find a interesting course deck the vulnerable function is finally called by the service me which means the Window Service started already started and the vulnerable function will be called and we can create a fake file in the directory from the past environmental variable such as say Python and the window admin start or restart the VM compute service or fake ccg Launchpad",
        "audio where I'll be loading into the um process successfully second second reporting pattern you can see there are two parts in the state of vulnerability the first part is uh we read a report Point data it calls divisor control with",
        "the divisor control code get it get a repairs point to get a replacement data and you can see there are some filtering uh by",
        "comparing the repairs Point tags after that in the the function in the right figure is used to process reposition data and you can see this line of the code which has the integral flow there's a word value at a constant assigned to our word value when the integer flow happens",
        "now this check will be bypassed and the memory copy will cause a lot of boundary access vulnerabilities",
        "and we extract the vulnerability model for this pattern like this Saturday price point data trigger reverse Point data access high privilege applications get a reverse Point data finally the low privileged user controllable data will return to the higher privilege applications there are two parts in it firstly",
        "comparing our filtering according to the",
        "reverse Point tax and then process reporting data",
        "based on the vulnerability model we extract the the vulnerability pattern like this you can see there are two steps the first step is to find the reports Point read to do that we will search the threshold Control Function",
        "and check the signal argument to see if it is the get over parse point and we'll search the code of comparing the output buffer with the reverse Point tags in the second step to we find uh we want to find the",
        "integer flow exactly for to do that we will do tending from",
        "the audible buffer to the memory copy and we we we will check if there are word Value Plus a constant and assign a sum to our value which lead to the integer flow and we will also make sure there's a no integer flow check",
        "with that we can create the queries in query mode to find the replace Point rate you can see the query I will search device control and check the second agreement value and also check the fifth",
        "argument to see if the if there's a equal or not equal to a number of constant lists here is uh here are examples of the WCI related",
        "reports Point tags after running the query we we can get some results now the the functions which",
        "call we which uh find a replace Point",
        "rate and if you want to step further to find your price point data process and you can create a queries like this find search the function which contain the replace Point read function and do the tinting from the output buffer to the memory copy finding reports Point read and the person data process is good enough for us to get some results to to to review to find that possible vulnerabilities but if you want to accurately find the",
        "integer flow we can also Implement in or in in the script mode you can see there are four steps in the script mode the first step is to find a reverse Point rate which share the same logic with the query mode it is used import color tweezer just to find the target anchor function device or control and you see Funk C func traversal class to find the reverse point tag or comparison after that in the Second Step we'll find all the colors of the replace point point read function and the inner third step will find the integer flow of for in all the colors with our customized expression matching mechanism here is a detail of the expression matching mechanism you can see the first expression is to search and match this",
        "line of the code which has the integral flow and you can see we we will search assign operator and we will check if",
        "there are arithmetic operation and the number pointer and also we have the sanitizer expression to find",
        "if there's a integer flow lens check",
        "Ronnie running those scripts and queries",
        "we've got five results and some of them got our cves and some of the some of them were silently patched by by",
        "Microsoft and worth mentioning we have",
        "um one more results um which is still vulnerable so we have to hide details about it and we we can confirm all the results has a vulnerable integral flow and a lot",
        "of boundary access vulnerabilities in different binaries",
        "here's another example to find a triage RBC interface function is one kind of entry point we finally find the connection between the vulnerable function with the RPC interface function statically",
        "and so we can create a RPC interface",
        "function in the RBC client and the salary personally data in the meantime to crash the app info service",
        "third pattern ACL over Rhythm pattern um the set of vulnerability for this pattern is very interesting which we use in the Pontoon 2021y and you can see the vulnerable code will call a gnm security info to get the ACL of a file with error 4 in the ecl and calculates ecl and set",
        "the new ecl to the same file by calling sending secret info so if the attacker can redirect the file to a system file in this time frame and the system files ecl will be overwritten with a rifle very interesting vulnerability and uh",
        "you can see this is how we abstract the vulnerability model firstly Cadence cream for core to get",
        "the easier of the file with everyone full",
        "and the window surname Supreme 4 is called the file is redirect redirected to the system file and after the uh sending screening for execution the system files ecl will be overwritten which can lead to the privilege escalation directly",
        "based on that we can extract the vulnerability pattern is easy to understand find the km security info CMC",
        "cream for and check the second argument to see if it is file object and the final common color directly and indirectly",
        "with that we create a that queries",
        "inquiry mode to search this pattern and",
        "you can see uh the query while search function containing ganym screen for sending Supreme 4 and check the argument too and just set the trace indirect flag",
        "execution the queries we got a 32 result out of 637 elevated service binaries",
        "but we can now disclose it right now since they are still not patched actually we we have to blur several slides in this section unfortunately since we were asked to hide all details by Microsoft it's a big pity but we guarantee we'll publish all slides after they are fully patched in January next year",
        "vulnerability confirmation",
        "pattern result charge demo",
        "last words for this pattern this is very interesting uh zero this story the initial funding did not meet the Microsoft criteria but after based on that we found a new attacking vector and reported five new vulnerabilities Microsoft confirmed them Grant but bounty to us but when we request for vulnerability disclosure at blackhead the we were asked to hide all the details until January 2023 because they are fixing the design issues",
        "very interesting right nah",
        "the last pattern a pool spray pattern code patterns not work only for the",
        "vulnerability variance Discovery but also work work for the exploitation Primitives kernel pool spray is very important to the exploitation in this case we want to figure out how RDP client send what kind of pdus to the RDP server for the canopy spree here is how we abstract the kernel",
        "pool primitive model you can see the RDP client send one video continuing many",
        "fields or many many pdus with client controllable data to the RDP server RDP server receive and process our RDP pdu",
        "and allocate many kernel pools and do the data copy tool that just allocated kernel pools",
        "based on that we extract the post-free Primitive pattern and you can see there are two steps the first step is to find a data copy to do that we will firstly search kernel play location and then",
        "find the memory copy to just allocated kernel pool there are two ways for that purpose memory memory copy API and the",
        "memory right taking a loop besides we also need to figure out which pdu can lead to the data copy for this purpose we have X reference Handler to find a core path from the RDP video data processing function to the data copy function firstly we we found the MCS IC",
        "raw input as RDP video data processing function but it contains the virtual function call in a course deck which lead to the failure of the static function X reference search so we change",
        "X flow source to the mcsn data callback",
        "function as RDP pdu data processing",
        "function with that we can create a queries inquiry mode to find data copy with memory copy you can see the query search the function containing allocated pool with tag and a memory copy and we do tending we we will find",
        "it if there's a uh data flow from the",
        "return address of allocated pool is tagged to the destination address of the memory copy and we found several results",
        "in term DD and module and you can see ICA Channel input internal function is exactly what we want",
        "and then we'll connect rdpdo to data copy with memory copy uh let's like we mentioned before we have X reference Handler to find the core path between the RDP video data percentage function and the data",
        "copy function we just found and we have found two results including",
        "the cost stack of the first results you can see there's a interesting function named invalidate rect according to the",
        "function name we found we we found a specific pdu named refresh react pdu which can do the pull spray similarly",
        "from the cost deck of second results we have increasing function I say Channel imported ex and we finally found a video",
        "named uh client name request video in the virtual file system",
        "so it saves us a lot of time to Traverse stolen pages of our RDP documents",
        "we mentioned before there's another way",
        "to do the data copy memory right in Loop and you can see this expression is to search the memory right this kind of",
        "memory memory right and in a loop and we finally found two results in rdpwd module and you can see handle persistent cash list function is exactly what we want",
        "and after that we connect card video data RDP pdu or two data copy with a memory right in Loop and similarly we found",
        "the core stack and uploading to the",
        "function name handle persistent cash list we found a specific pu named persistent k-list pdu which can be used to do the Canon pool spree finally we created three different ways for the put spray with RDP video which can be used in a well-known RDP vulnerability blue cape",
        "and they are totally different with a published published methods",
        "you can refer more details in your blue hat talk",
        "last summary and the takeaways",
        "um firstly with the help of hex hex Ray apis is definitely viable to create a codependent Search tool for binaries the idea of code pattern search Primitives can also be used in other study code static analysis tools such as binja ghidra second we prove code",
        "pattern search not only work for memory corruption vulnerabilities but it can also be used to find to find logic bugs which can not easily be found by fuzzy",
        "or manually color review and also can be used to find a new less recognized attacking surface and a new exploitation Primitives",
        "um third in each case we disclose the entire process of how to use code patterns to automatically final vulnerabilities and exploitation Primitives in windows with R2 I hope you can get some Inspirations from our detailed disclosures last words we want",
        "to mention there's a no Silver Bullet for bug hunting although you have the power tool to facilitate your research deeply understanding your target is still the most important thing",
        "here is some links and references and now",
        "we take questions thank you for listening [Applause]",
        "[Music]",
        "[Music]"
    ],
    "NqCqfBCV_18": [
        "foreign",
        "UK how we doing",
        "how we doing great okay good so uh Welcome to our talk about writing your old ticket to the cloud like apt and we are here like my name is stuck my history Cinema and I work for CQ works and I'm the senior principles security researcher and I",
        "have a another talker here my name is Roberto Rodriguez I'm a principal uh security researcher at Microsoft and I'm part of the Microsoft security research organization and I collaborate a lot with this guy so now I have to see him in conferences too and talk to him yeah so let's start with the quote that kind of our presentation is based on so we think it's a Chong Lambert he's a great guy from Microsoft he said that Defenders thinks uh in lists and attackers think in graphs and as long as this is through the bad guys are going to win and this is a kind of how we build our presentation so this is based on on the talk I gave earlier this year in Troopers in Germany I think it was June or something and it was called Eight ways to compromise adfs but in this talk uh there's not gonna be like any new attack vectors or anything like that so sorry about that so it's more like defending but anyways here's what we're going to talk about so short introduction then we're gonna introduce you adfs attack and defense graphs and finally we're gonna wrap up that how you can protect protect against a cold Ensemble attacks",
        "so well we have a user right",
        "and then we have a service provider and I'm talking about identity variation Concepts so not that Federation that we covered with Keynotes so that's a little different different one but anyways um we have service provider which in this case is azure ID and user wants to access that service we have identity provider which in this case it's adfs and the adafs is trusting the user when the user provides some kind of proof of identity then the ADF is trust that and also the other lady is trusting the identity provider but how can we like prove that who the user is so here comes the technical part so we have security token in this case it's called saml or security asset multiple language token which is signed by the adfs",
        "and then when the user is accessing as a ready it is trusting that ticket and and that's how the user can prove who or who he or she is and one slide about Golden summer attack so",
        "that's how I think it is so it is using two my three techniques so first we're gonna steal certificates and then with those certificates we are going to create uh or we can afford sample tokens so in order to do this to work you need to have the token significant from that identity provider regardless what it is and in this case we are going to focus the first one so how can we steal that certificate so there are different ways to do that and now I'm going here because I want to get the numbers right so is it this important so how many of you is using adfs or any other declaration",
        "yeah",
        "and probably the rest of you are just lying or you don't know that so a legal statistic so from last year",
        "about a year ago from Fortune 500 organization 88 was using as already and from those 68 was using Federation and about six months ago from Top UCO UK 60 organizations 86 was using as ready",
        "and from those 60 has at least one or more Federated domains so this is still a thing right",
        "and here's at adfs attack list",
        "quite easy you start you export stuff and you're good to go and I think it was like four years ago when doc bienstock introduced the adfs dump that was two yes and and if you like protected your environment using that it's not enough so there's more to this",
        "so let's start with some adfs details so first of all for token sign certificates you have two options so you can have them managed with the default one and then that so a dedicated stored in configuration database and it is encrypted using a key that is stored in ad so you have like two ingredients and the second option is to use custom certificates which means that the yellow just normal certificates which are stored in certificate store of each adfs server",
        "so you have these two options and now this attack graph is going to look more like graph right so we have a couple of options and we need to cover all of those but it's it's not that easy there's more so you can store sorry you",
        "have a couple of options for storage thing that configuration and the first one is Windows internal database or WID th I think it's also known as SQL Express at some point of time but anyways in this configuration one of those adfs servers is a primary node and the others are secondary nodes right and each of those servers have their own copy of that data in that database however if you try to make like configuration senses only primary node can do that so the secondary nodes are synchronizing the data from the primary node I think it was like every once in five minutes or so so there's a service that allows you to pull the configuration okay and the second option is to use microsql servers to store that data which means that there's no primary nodes anymore or secondary nodes because every single server can connect to that you know centralized SQL Server however that service that allows you to synchronize the configuration is still there",
        "so now that we have the graph so we have different ways to you know store data",
        "there's different ways that we can use as certificates and this is the whole whole stuff and now we're going to go through each of these steps so I'm going to tell how you can compromise those and then my friend Roberto is going to tell you how you can detect that maybe even mitigate or prevent that right some of that yeah so let's see let's start with the access configuration database and that was the part of the original adfs dump and we're",
        "gonna start with local so we can see here's a local and we have a couple of different methods and by local I mean that you need to compromise that adfs server and now the exponentification database it simply means that when you have a compromised computer you're accessing the database which is usually like a that local database so how can we react that so one of the things that is very important from uh you know defense perspective is to be able to understand that there is a couple specific things that are happening under the hood and you have to be able to describe all those little things so that you can start mapping things such as data sources mitigations detections Etc and I think that that's the part where the graph comes into place because graph is not only to talk about identities how they connect to each other how they have access to certain things we can actually apply those Concepts to what we want to build you know detections in general right so in in this presentation we're going to cover the concepts of operations things that are executed by a tool right used by a thread actor artifacts are going to be things that are going to be created things that are going to be used as part of the execution and then also we're going to talk about data sources uh and also some mitigations uh you know later on so when we talk about accessing the configuration database right there is going to be two specific actions that are going to be you know repeated across some of the variations of these techniques right we have the connection to the database and then we have also the action to read the adfs configuration when we start talking about connecting to the database by default the connection happens over a name pipe and that name pipe the the format of the name pipe will change a little bit depending on the version of your server right and then if you're actually using SQL a SQL Server by default you also have name pipe connections as an option right to connect to that locally so there we also there is also a way to connect actually locally to that database and now this can happen of course via the apis and this could be done by any tool that you write right it could be Powershell c-sharp I mean you can do a lot just to get to the same kind of like artifacts right you're going to be using some apis to connect to this somehow then there is of course if there is a connection there needs to be some type of authentication a user needs to log on to that SQL Server right and then in this variation talks about that once you have a connection to the database then you can run SQL query so that you can start accessing the adfs configuration and this is one example of that basic SQL query but there is different ways to do this and thread actors are actually good at this because they they kind of monitor what is the normal way that this happens and they can probably replicate some of that right and when we start thinking about data sources from a name pipe connection perspective at that I would say step in the operational flow of this we have something such as system locks which monitors name pipe connections and then you also have application logs that will allow you to audit users logging into the SQL database and also the queries that are going to be executed to gather information from the database just to give you some more context and some of this is going to be of course in some of the resources that we're going to be sharing at the end of the presentation but this event is going to tell you more about name pipe connections you do have the context of a user of the process that did it in the name pipe and one thing that you need to consider here is that there are so many different processes that are actually doing this that you will have to based on your environment you will have to do some type of Stack counting like trying to understand what normal is but at the same time think about that thread actors do the same thing and they will try to probably be able to impersonate some of those users or you know processes or inject their own sessions into whatever is normal so think about that as well when you do this and these are just two examples of those Name by connections when we talk about logging actually logging into the database this is one example of the event this is going to be sent to the application logs and this is how you actually can enable it manually by default only the um",
        "so you have the successful logins and you also have the failed login so fail logins is usually what is enabled by default right and then if you want to um you know audit those queries you will have to actually create a surveyed audit and database audit specification and that would allow you to specifically query anyone actually reading your avfs",
        "configuration the settings in that table that exist in this database right so same thing as before I would actually try to see how this is done and this is one example of how this is accomplished and this is done by tools like aad internals created by nestoria so just kind of keep an eye on those uh you know SQL statements right there okay okay and the next one is a dotnet reflection and that attack is based on the fact that well you have the like relative command called get adfs product properties which is returning a an object that has the welcome setting of The adfs but that has also like hidden properties and methods which you can call using.net reflection so basically you ask ADF said hey give me the configuration and it will get you the configuration so you don't need to do the access to the configuration database and I think it was first introduced like a couple of years ago in adfs Mike racing tool or something like that yeah it was 2014 13.",
        "yeah so it has been there a long time ago but but we just uh you know spotted that like a year ago or something like that but a very interesting way so when it's using the dotnet reflection so you really can't see anything right because that's like a quite stealthy way because ADF is doing that or can you do something yeah so there are a couple things you can do of course but um first important to understand what's going on right so similar to our previous example in this scenario we're not creating a new connection we're actually using what's already established but we're still going to query that information and similar to when a story was saying so in order to do this we need to get the abfs settings as a net object and you can actually accomplish this by using a built-in avfs commandlet this will give you that avfs settings as a.net object but the properties available in this object are actually public objects I'm sorry properties so the goal is to access private properties in this data object so you can accomplish that actually by trying to get a specific private property called service settings data and then you can get the value of the that net settings object uh pointing to that private you know property and that's pretty much how you can get the adfs configuration from a database and",
        "of course if you're using Powershell all this can be accomplished with Powershell but if that's not available you also can explore all that information through MC right which is the anti the anti-malware scan interface",
        "and when you think about Powershell so you have to also make sure that you understand the version of Powershell that you have in your system so version 3 plus would give you something like this event the 800 this is a classic Powershell lock that does not have actually process information it lacks of user information but it could actually show you that the commandlet was executed right this is kind of one example in there 4103 it's a pipeline execution type of log available on version 5 plus and this",
        "one will give you process context so you can actually correlate that with other events it will give you user context so you'll know exactly who's executing this and then you can correlate that with something else right you also have 4104 which is script block logging but you do have to enable what is called Global Powershell script lock logging by default this actually is enabled but only to capture events that are triggering because there is suspicious strings being passed through the Powershell pipeline execution execution pipeline if you want to capture more than that then you need to enable the global Powershell script log",
        "now MC is an interface that allows applications to send data right to for example anti-malware vendors right and and that information could be file scanning or memory scanning information right content from for example Powershell execution all the way to maybe a PE file or a binary being loaded into memory for example so this is like some built-in Windows feature yes it's a built-in feature and these are some of the apps that are designed to actually send content to ANSI this is just for reference of course if we're going to focus on the Powershell one for now so now you really don't need to buy anything extra to use that nothing extra just okay just if you want to do a research this is how you actually would enable it right so you can just use logman start a trace and then execute",
        "your attack and then it stop the trace and you're gonna get events but the problem is that you won't be able to read them because the content cannot be interpreted but thanks to researchers",
        "like Matt Graver from Red Canary a company that shares a lot of content with the community he put together this Powershell script that allows you to actually parse those MC logs and you will be able to get to for example as a basic proof of concept to all the the code that was passed through for example Powershell right now as I mentioned before 4104 is a discrete block logging and this is enabled by default only for warning uh events okay and this for",
        "example trigger on this step of our dotnet reflection technique and that's because there is actually a lot of strings that are considered malicious so it would actually scan the contents of whatever is passing through the Powershell execution Pipeline and then trigger so in this case we had properties being pulled out the properties that were actually non-public so that's what this event actually executed and that's how I would approach some of that uh detection yeah thank you so quite interesting that you are actually using totally proact dot dot net reflection and you're still going to pull that amount of data so that's amazing what you can do nowadays okay but then we input something else called synchronous Json config and what this does is so this is liberating the the first option that that you are using the internet databases so this liberating the same uh synchronization like",
        "a process if you will or or a protocol that they are using so this requires that you have like credentials that have permissions to read that configuration data so that's usually it's like ready as a service user or then the local admin of that AWS server but you can do this remotely and this is using the port 80 actually so it's not uh",
        "it's not encrypted but the content of those messages are so even though that's like a port 80 like 80db the the slope messages are actually encrypted or yeah so what can we do with this one then it has a lot to do here there is so much information that I actually didn't even know about so let's just dive into that thing um so following our first example they're gonna be once again a similar operational flow we need to connect as the story set we're connecting to Port 80 and that's because there is actually a service that is going to be used on the adfs server that would allows us to then interact with the configuration by simply syncing like replicating contact back to us right and this service is called the policy store transfer it's a WCF uh service which is a Windows communication Foundation service and in here you can start actually the basics right what data what logs will give you network connections but at the same time what it is is that you can use to validate that those connections were actually performed so that you can interact with the specific service right the policy transfer service",
        "and in this scenario there is actually a mitigation that you can apply so in the previous one in the previous way to get the configuration most of those operations actually are part of the functionality of adfs so technically you can blend in you cannot block that right if you compromise the idfs service account you simply can operate as if it was regular businesses but in here if you do not have other abfs servers that are communicating with your avfs primary server to do a synchronization job then",
        "there is something you can do right network connection very simple this is just one example and here with this one and other similar Telemetry you get user context once again process context source and Target but not enough until like why am I why is this connection even even happening 5156 from security auditing something you can use as well you miss the user context but in this scenario it doesn't matter because this connection is handled by system so we're not expecting a different user right and here's when",
        "we start getting into adfs logs this log is actually a lock that can be consumed you can actually see it through abfs tracing but this is something that will also be populated in your security event log the link at the bottom is going to be a link that will show you how to actually enable all of this and in here we're actually getting information about the the service model which is going to be part of the WCF actually context so you can see that there is some authentication happening in here in regards of the WCF service",
        "501 is something that you can actually correlate with a previous one so that you can then understand who the caller was that performed this operation right and the reason why this is important is because you you might have a thread actor that might have modified maybe the rules on the adfs database to be able to access it with a different account to maintain persistence so then you can start tracking that type of activity and for 624 it's something that will have to trigger because in order to interact with this service you need to authenticate and this one was very interesting because I did not understand why in my logs I had something such as company SVC adfs when that was not the account that I used to set up my abfs servers and I didn't know what it was to be honest and I was just trying to read as many documents as possible and then and that was something that actually came from the stories uh tool yeah actually that",
        "is hard coded in ad internal so if you are using that tool it's always that same name I just wanted to make it easy for you guys too exactly so yeah but they make it hard because I had to read like four hours and figure out what's going on but um so in here this is a plain signature you can actually see that these 4624 event was a network connection network login session but it doesn't have a source like we don't know where this actually came from and if you go to a the internal source code if you get to the section where you can test how WCF is actually use the story creates its own ticket its own TGT and",
        "all he uses is a hash of the account and then he simply starts creating his own ticket and then he passes that to the service in order to communicate so that's why we do have that specific event so if you go back to your company or right now and you check for 624s for that name I would I would be a little uh concerned right probably he was doing consulting or somebody's using his tool now this is very interesting that I did not know that existed to be honest because I skipped probably probably the documentation but there is actually a way to enable additional WCF or services that are built with that framework in",
        "ibfs you have to find this configuration which is usually on the root of adfs which would be by default see Windows adfs directory once you find this configuration there is a section that allows you to modify it so that you can then enable additional telemetry",
        "in this Telemetry you can start either interacting with that through the abfs tracing debug analytic views in in Windows Event Viewer or you can actually use logman to create a a",
        "etw trace and then you can analyze it on the site offline right and as you can see when I did that then all these events started populating that were not populating when I started testing the capabilities of the service to access and synchronize information from adfs",
        "this is one of the first events that that triggered 121 gives you information about the connection this is the first time that you see a network connection mapped to the service that allows the synchronization when you are looking at system before there is not additional context that will tell you this is exactly what happened this will tell you that this actually happened right so it's something that could be consumed it's something that you can also explore other events like 998 would start giving you information about the URL used to",
        "communicate with the service you also have more 121s but they start giving you more context such as for example there was a message that was received and there is also information about for example the user agent that",
        "was used to perform this type of communication something that I had not seen in other event log and since we were using AED internals which is used with Powershell you can find user agent Powershell information in the logs as well so something really cool to dive into and see what's going on right then you start getting into understanding the negotiation process",
        "when you start interacting with avfs so this is just more information telling you how this is actually happening all the bay all the way to telling you that this completed and then you can start seeing for example that there is a message now being sent back to the user so this is definitely a lot of good information there is even more events I didn't go through all of them but these are kind of like the the main ones especially the ones that really tell you that the network connection actually was performed for that specific service so",
        "the technique can be directly be mapped to the first 121 event for example then it's also good to turn that on just for you know getting the forensic data exactly exactly so from a mitigation's perspective you can then for example use these two commands one could be to modify a a current maybe a rule that you have to restrict access to this port or you can create a rule if it's not created and you only point to your adfs servers and also your proxies right I think that you were mentioned in the adfs proxies should also be part of this uh rule and that concludes that one piece on the top right and just to go quick on this part we were actually going through a couple of different variations different operations executed depending on the way how we wanted to for example get the configuration and then we can actually start mapping multiple data sources that would tell you that something is actually happening in this um you know specific flow of operations and then how are you going to start blocking one specific path for example okay so now we covered how to get the the different ways how you can get the configuration which contains the encrypted tokens on a certificate and",
        "now we go into the key part so how can we get the key and the first one is again the dot net reflection so you need to compromise ads server and then run it there and here you just instantiate the certain dotnet object and then again call the uh hidden private parameters",
        "and sorry properties and and methods and you basically ask that adfs that hey could you give me the key please and then adfs goes there and picks that up so it is the totally same thing that adfs when it starts up it gets the key so the network traffic is all the same and all the you know access to objects on ads same so I bet you really can't find this out so this is going to be tricky but uh it kind of follows a similar pattern as the previous.net reflection and there is a lot of that net happening in here so that could also be a way if you're if you are actually collecting multiple operations like getting methods Fields",
        "properties that are private that's that's what this all takes like a lot of iterations so this is probably the graph that you were expecting so this kind of walks you through all the flow step by step and because of the time we can go through all that but the idea is to go all the way from an adfs configuration setting as a.net object and then utilize existing dlls that would expose specific like assemblies and classes that you can then use to iterate to private Fields private properties to get to a private method that would allow you to enumerate keys in the adfs server and that key is the idfs dkm key right now the interesting part once again you can use right for example Powershell Ramsey logs to capture all this there are different evrs or xdr Solutions already capturing some of this information for example so they can actually do something about that net reflection it's really tricky and in this case as I mentioned before if if you are executing this attack step by step which could actually be done interactively instead of doing a full script you can actually run each command if you have a session and then this would actually be start triggering a lot of different the default 4104 events and",
        "that's because once again it has all these suspicious um you know strings that are being executed just to get to the uh private like non-public method that will give you the keys and as I mentioned before you can use something like that script that would allow you to go through and find all these strings that were executed right now the interesting part besides the dotnet reflection piece because that's just that net that you have to find through some Telemetry is that actually there is there is always unintended consequences when a red teamer or threat actor or offensive security researcher in general right when they do something on a box there will be things that they expect that happen and that they have control over but there are three things that they don't don't have control over one of the things that they don't have control over is that when they start executing these steps where they invoke the enumeration of keys then they start actually making a lot of ldap connections because they're actually going to the domain controller retrieving the key and then giving it to you but locally it looks like you're interacting with simply.net objects locally but there is going to be connections that are going to happen right so that's an unintended consequence and you can actually start tracking this by using this event provider with log n and you will be able to get to this specific ldap query that",
        "by default adfs service under the hood is actually executing so for those that maybe want to replicate that and look similar then that's the query that happens when that regulation is used in in this scenario and that's just uh proves it that the query that is being executed is actually trying to get to that object in in active directory and that's the abfs dkm uh container that has an ad object that contains information about the ABF sdkm key yep okay thank you so we actually tried to squeeze 60 Minutes presentations 40 minutes we need to keep it up a bit okay but anyways then the remote method so actually you",
        "can remotely access also 80 and and ask find that container Roberto mentioned and then find that contact object actually it's a lot of contact and then there's a one certain property that contains the key so that was actually also the part of the original PDF stump tool so they access the configuration database and then they you know query the ID and of course you can do something at the yeah so just to go um quick on this one since we already covered with a previous example there is going to be access to an object that is going to use ldap right queries where it's going to be authentication of users against the domain controller and there is going to be data that will be triggering the access attempts to those objects right and of course data for our user authentication as well and you can use either etw tracing which a lot of EDR Solutions will use on the client side and they would also uh client and server and then also some Network packets if you're using some type of network you know data source you can actually uh you can actually enable Telemetry by adding in a entry to",
        "the cycle of the ad object that contains this key right so you can actually do it by adding the for example who's reading or who is listing this property 4662 is the event that will trigger telling you that this actually was accessed and there is going to be a property that is going to map directly to the thumbnail photo attribute of the",
        "object which is where the key is going to be stored right and then you can actually correlate this with authentication locks and you'll be able to know exactly where the client is if this is coming from an adfs server you will see the adfs server IP if not you will see another um your computer and then as mentioned before you can enable the ldap etw tracing to start collecting some of that information and then this is one example of that ldap search query",
        "okay and then",
        "the last one of this path attack part to get the key so because that's stored in ad then you can access the 80 also using a thing called DC think which is a protocol that domain controllers are using to synchronize data from from other domain controllers and that requires that you have some permissions to do that so of course the ADF is uh but service account is a good one and another one is that if you can compromise Azure ID connect server you can use that account that it is using to you know synchronous data from from on-premity to Azure ID",
        "but that's a normal traffic right so you can't do anything right I mean if this if this of course happens um from different domain from a non-domain controller host then that would be kind of easy to detect uh if it happens directly from a domain controller good luck there is not much Telemetry out there but the idea is that we want to access the object in an indirect way so there is not a cycle that will help you here because there is not a direct access to the ad object and we're gonna of course start linking this information with uh you know login information and let's go directly to the events oh and there is actually mitigation so there is now it is becoming a thing to be able to do RPC uh filtering and there are some solutions out there that are accomplishing this on your domain controller so that you can uh so so that you can actually start restricting who can access your domain controller using the director replication Services remote protocol so is it kind of a pliable for RPC I think it is yeah it is viable it it definitely works I've seen some some companies using the the one that I'm about to share 4662 will show you not an access directly to the object the key but actually the interaction to access the",
        "um the what's called The Domain DNS class object and if it uses an extender right that is related to synchronizing information from the domain controller there is when you can start saying that this could be a suspicious DCC potential attack and you can actually correlate this with authentication events so you understand where this is actually coming from and as I mentioned before there is actually RPC filtering that you can um use in order to restrict who can actually use this RPC protocol or interface um with the domain controller so really good projects J security Johnny Johnson from Specter Ops actually has some really cool cool you know ideas in his Repository and that would just take us to the last I would say part which this is what explains some of the variations of getting the abfs key and some of the data that is available to explore this and some of them to potentially build detections and also mitigate and this is important because you need to understand at what layer you are mitigating this and as you can see it is at one attack path but you cannot just mitigate the whole thing so that's what is important to build these graphs as well",
        "yeah and actually now that we have those two ingredients we have the configuration database which has the encrypted certificate and then we have the key we can decrypt that and just to speed up uh you can detect that of course because that was fast because that's like a you know make offline so uh let's try to speed up a bit so actually you can mitigate all these problems uh we have showed you by using the custom certificates because they are stored in your computer so you can access the configuration database and so on and we have two options so if that's if the the key private key is not marked as well sorry if that is marked as exportable you can just go to MMC and Export that if not then you need to use some tools like a internals or mimikats or whatever you like to use and for that the well it's a bit noisy I would say because it's using um it's using a DP API or as we call it depopy the puppy yeah",
        "so if you have a local system access a",
        "local admin access system you can be the system and then you can do the encryption by yourselves right so that's kind of a yeah so the idea here would be a couple of slides to understand that you can actually mitigate this by executing the think at the bottom and you can mitigate the thing at the bottom by using things such as HSM when you're actually using a custom certificate so there are ways to actually do this type of um you know preventions and just as an additional I would say information there is actually solutions that would provide detections across some of this from mde and MDI just think about the mde covers client side things an MDI Defender for identity will cover things at the server side so that's that's something that we have worked together for a couple years uh two years already to try to create detections around this and of course uh just remember that this is just part of an attack sequence this is not the whole sequence right so there are different opportunities and if they succeed at this they can get a token right they can get a sample token you can actually enable MFA right people might say enable MFA but they can actually add MFA to their token but then there is other things that you can do such as for example rejecting the MFA claim that came from the the IDP and that that's something that Azure ID is providing so something that you can read about and will block The Next Step yeah so that this is a slightly slide actually so how to mitigate so first of all create all adfs servers as a ts0 so you need to protect them as well as you protect your automate controllers second configure that setting that uh Roberto mentioned that you rechecked all the MFA claims coming from uh private identity providers and if you are using adfs managed certificates you need to block that Port 80 and also read SQL Server if you are using that as a tier zero and if you are using custom certificates block it already again and then use HSM or Hardware security model and that's actually the safest way to do that so please do that yes yes so there's a little bit better of management but yeah and then",
        "takeaways so there's going to be a link to GitHub page where the satellites and all the other material are and we have links for tools like Aid internals and 80 at the stump there's no link for mimic ads because if you can't find it you are on the wrong business [Laughter]",
        "sounds good hey thank you very much everyone appreciate it thank you",
        "I guess because we have no time for questions but you can you know ask ask for much cool",
        "foreign",
        "[Music]"
    ],
    "V-VZ5WbR8uE": [
        "foreign",
        "and today I'm going to present to you Json security off or how we abuse Json syntax to phone Cloud applications so a short World about myself I'm a vulnerability researcher at Clarity team82 at Cloud intimate 2 we do responsible disclosure that means that we target very interesting be it physical devices scada iot devices applications Cloud applications basically everything and we report the vulnerabilities we find to the vendors and as you can see we have a very cool lab that we get to have a lot of fun with and I personally love researching cloud and web applications because the vast scale it offers when you found when you find one vulnerability and lastly we're also participating in hacking competitions and ctfs and we are actually participating in pontoon Toronto right now and so we have a big few big week on our hands so let's talk about our agenda for today today I'm going to present to you a research I've done in the last year and where we found a few cool Cloud vulnerabilities and when we try to exploit these vulnerabilities we actually got stuck you see we were blocked by AWS security mechanism more specifically awaf and that threw us in a loop and because of this we had the need to bypass this rough and be able to exploit our vulnerabilities",
        "these we were able to do this by analyzing how oaf works and how it Flags requests as malicious as and as safe and through that we were able to actually find a generic rough bypass that invested that we tested against all of vendors and in all cases it just worked plane work nothing out of the box just send it and forget it and lastly I'm going to present some tools and open source stuff we wrote that you can use this research on your own so late last year we were returning a company named cambium networks now cambium networks does a lot of wireless communication devices be it access points long range access points antennas 4G routers basically every kind of wireless connection you can think of they do it and in this particular case we weren't looking at the physical devices themselves but instead we're looking at a platform called CN Maestro now CN Maestro is a platform that allows it administrators and a system augmented as administrators to take a look at their devices see their location status configurations and even perform some actions like push a new firmware push new configurations it basically allows them to control it when we talk about how CN Maestro is built it is built in either one of two flavors it is either an on-prem solution that the company buys and installs on their own machine and then all their wireless access points connect to this machine and are managed by it or the second in my opinion more interesting flavor is a cloud deployment and in this deployment type I sync my machine to the cloud and I can manage it through cambium's application and and of course luckily for us when we went to cambium's Cloud we noticed that it we can register we can just register freely and that put the cost of Entry to This research at a zero because we just registered and when we registered we noticed that a new instance a unique instance of CN Maestro is being set up and we were able to access it through a Nick guide through a URL",
        "now this gave us two options we could",
        "either Black Box the cloud meaning we could try and find vulnerabilities on the cloud platform itself or and in my opinion the better the better version is to research the on-prem solution because we noticed that it actually looks the same and it might have a similar code base and once again we were lucky and we were able to just download this solution out of their website and when we downloaded it we noticed that it is in an OVA and we can just plug it into our favorite virtual machine software be it VMware virtualbox whatever and and then we have the access to CN maestro inside OVA there was a very basic Linux distribution with a lot of proprietary code and a lot of proprietary services and that actually manage the physical devices themselves",
        "now most of the services were written in nodejs so that's our exploit path trying to exploit a node.js application and inside of it there are many different servlets that serve different functions be it allowing administers to connect to the to the application uh sending commands to the cloud Etc to the devices Etc and there are actually many of them around 10.",
        "pretty soon enough we're we reached a very cool SQL injection vulnerability that basically allowed us access to the database this happened because they just appended user data in a route that took Max serial number of devices into an SQL query and we were able to inject malicious SQL syntax to the up to the",
        "database",
        "what can we do with vulnerability it's very simple we can start accessory in data a lot of sensitive data is being saved in this application be it cookies tokens SSH Keys everything that's",
        "interesting to us but sadly we could not do it you see we started our process into building our payload meaning thanking the vulnerability and creating an exploit out of it and that's where we had a lot of hurdles and stuff that we had to come by first of all when it tried to expeditate Simple Text we got an exception the main route of this vulnerability only allowed us to exfiltrate device IDs meaning integers so we had to take the text that we want to explorate be it assh Keys be it cookies and converted to an integer and using some SQL magic it's pretty simple you can just take a text so split up into an array and returning rows of characters and then you need to convert it into integers and then we were getting the ability to exfiltrate some data but that wasn't enough yet you see when we accelerate data we noticed that the data comes in a scrambled order meaning we don't save the correct order of a word and once",
        "again we fixed it with pretty simple SQL magic we just took the index of each character multiplied by a thousand embed and then by doing a simple division division and calculation we can extract both the character and the index of the character lastly this endpoint was very very slow and we wanted to express a lot of data through it meaning that when we try to exfiltrate for example all of the users or of the user's password we got timed out because each each exported row was returned in different row and multiple actions were performed on it and once again we can fix it pretty easily with SQL I know it looks a little bit funny but simple SQL syntax that basically constructs one big integer out of seven characters and returns seven",
        "characters in one returned value",
        "cool now this is where I usually just send my boss my boss an ambiguous message like hey we did it and then I ghost him for the next seven days so we try to take this vulnerability to the cloud and we were blocked I kind of spoiled at the beginning but we were blocked you see our requests returned forward three and after a few minutes of complete shock and we didn't know what to do with ourselves we noticed this cute thing in the response and that this header server AWS clb is what triggered our entire research you see we were blocked by AWS",
        "awl 12 offers is a web application firewall it basically looks at the request and response that users send to an application and tries to flag them for malicious in SQL injection and shell injection oscoma injection xss attacks",
        "and our goal was to exfiltrate all the juicy data that was saved on the cloud so we had to find a bypass that's where we created a very unique set AWS setup of our own with the intent to try and analyze how it works and in the next three I said three to took more like 12 days I just sent was sending",
        "payloads and trying to see what gets blocked what doesn't get blocked and how the wife could flag request as malicious",
        "now I'm not a buff developer myself so don't take tips from me but if I was a web developer that's how I would flag request as malicious I think there are only two there are at least two approaches and most of the time you need to combine multiple approaches in order to flag a request as malicious the first approach is to look for blacklisted SQL Syntax for example we know that select we know that Union we know that like are clearly SQL directives and if we see too many of them in a request we can simply drop it the second approach which I think is allium complex is try to understand SQL syntax from the request meaning does this payload can construct an SQL syntax",
        "in some specific conditions",
        "but that's what started our research question what would happen if there was SQL syntax valid SQL syntax that the wolf did not know of what would happen if we can confuse the WAFF and make him deem as a payload as non-exploitable and",
        "non-xql even if it would",
        "that's when I'm going to introduce to you Json in SQL which kind of spoiled the whole thing but that's the answer of this syntax what is Json Json is one of the most common data format in the world we use it constantly and more specifically we",
        "use it as in web apis in requests to store data and to save it and to send it to different servers and currently all SQL databases",
        "have added native Json support for their",
        "implementation",
        "but why should we use it as developers well I'm not a developer once again so I ask my few of my friends and asked them hey why would you use a Json SQL and they told me yeah because we can just work with Json directly in SQL meaning we can increase our efficiency for example instead of doing a lot of API calls and database calls to the database itself and fetching data and trying to pre-process it in a way of Json we can just immediately return Json data from the SQL itself and because we work in SQ with Json so much it could help us a lot and that's basically the process you can take a table use some SQL query to modify this and parse it as Json and then just return the data as Json completely",
        "when we took when we look at Json support in SQL we see that all database engine or that all database engines support SQL in some cases as soon as to 2012 in the case of postgres most of them added proprietary support proprietary sparser and some and everyone added functions and operators of their own it's so we can see different SQL syntax in all database engines",
        "that's when we get to the cool stuff that's like uh the intro we are now going to construct new SQL injection payloads we all know that in SQL in at least blind scale we try to get true statements meaning does this uh does",
        "this password equal to the admin password the answer is no but we can create modify the SQL syntax and changes to do does this password equals to the admin passwords or a true statements like one equal one and that's when we created new Json new sqlite payloads using Json",
        "let's take a look at this operator as an example it basically translates to does the left Json contain is the left Json contained in the right Json and we of course can create situations where it is true and we can create a simple SQL payload that basically translates to true",
        "a similar parallel can be created in MySQL with the operator will be the function Json extract that basically extracts a key a value using a key and once again it's pretty simple to create a true statement",
        "and lastly we have this operator that is basically translates to the same thing Json extract and we ask it to extract",
        "the key the value with the key a",
        "and using combining multiple payloads we can create some enstrosities some very very confusing SQL syntax that will for sure confuse the WAFF so after we have some basic understanding of Json in SQL we can start to test our theory that maybe the WASP won't know of it and when we go back to our setup we tried a Google fashion tag or a equal a or one equal one and of course we get blocked because the rough knows this payload and can immediately flag it as malicious but when we try our new json-based",
        "syntax we can see that the request passes by and that's because the WAFF doesn't know how to parse our new syntax and it just decides yeah that's not SQL it can be SQL so I'll let the request slide by",
        "now let's get back to the case at hand what was our goal our goal was to bypass the WAFF which we just did and exploit our vulnerability",
        "we want to use our SQ injection bypass the WAFF and exfiltrate admin tokens other users tokens SSH Keys private Keys",
        "everything and to do so we've created this",
        "monstrous payload and so let's do a quick rundown of this pedal I know it looks intimidating and basically in pink we have the first part of the payload it's the WAFF confusion part as I like to call it all we do all we are doing here is we're creating an SQL syntax that the waffle that the WAFF does not know of and when it Encounters this syntax it basically gets gets confused and says yeah that's not an SQL statement because it can't be it's not as your syntax and this part basically completely bypasses the WAFF and then we",
        "get back to the fold to the three limitations we had before the first one is our vulnerability must return integers so once again we simply return integers and we cut each character into a different row and we return integers then we have the problem of the characters getting all jumbled up yeah we fix it we simply append the row number and lastly we create a bigint out of several characters and then we can reconstruct it later and using this payload it actually worked",
        "we finally had the ability to exfiltrate arbitrary data from the database and we",
        "basically Pawn them now let's say consequences when we Pawn",
        "this we were happy over the moon and we finally had the ability to control all cambium devices that are connected to the cloud using this simple very simple it's basically an SQL injection using this simple vulnerability we were able to pone all the access points that were connected to the cloud we were able to manage them and perform actions on them",
        "we reported this issue to AWS and they",
        "say yeah that's right we're not supporting Json in our SQL syntax and they added support and then we said to ourselves yeah that's cool we have an off bypass of AWS",
        "what can we do with it and we did the only logical thing and we decided to bypass all other Lofts you see we've",
        "thought to ourselves maybe we have a core concept maybe not just AWS doesn't know of Json syntax maybe we have a bigger problem so one by one we started testing against different what vendors be it AWS of course at first cloudflare F5 impervine Palo Alto and every one of",
        "them fell like a fly and not realizing that we are passing SQL syntax",
        "bypassing wafts is cool and all but we thought ourselves then after we managed to bypass Olaf yeah let's do it automatically so",
        "we reached the conclusion what can we do we can modify a very cool tool we all know of SQL map SQL map is one of the most common tools in web application and penetration testing it basically allows you to point it to a vulnerable endpoint and automatically it just starts generating payloads and exfiltrate data [Music] is vast and it supports a wide range of the databases different cases what specific flags are enabled in the database and it just works we added a new module to SQL map that basically takes the payload that it generates and modifies it in some way and this particular way is actually adding WAFF bypass and Json syntax to the payload thus being able to what to bypass wafts",
        "so in order to demonstrate how it works we did the only logical thing we created a very vulnerable web application very simple logic simply take something from the user and insert it into scale query and we placed it in between we placed Palo Alto Next Generation firewall in between us and the application and now our application was protected and when we used SQL map out of the box yeah it obviously didn't work we can see that every request got dropped and this the this was done this is because the wife recognized each request is malicious and simply dropped the request",
        "then we used our script our new module an SQL map and it actually worked now we have a vulnerable endpoint and we are able to inject arbitrary SQL payloads",
        "foreign",
        "at the same time and we can see on the right that every request gets dropped and",
        "and on the left that's our tempered version and we can see that SQL map recognizes it as vulnerable",
        "well let's talk disclosure after we managed to bypass all Waf vendors we went one by one and started disclosing our findings to them and we started with AWS and then moved to the rest of them and one by one it said to us yeah we don't have Json support we must edit and now we can say that most Waf vendors actually support Json syntax in their SQL parsing engine but let's think a little wider yeah cool Jason is cool I guess maybe we have something bigger maybe we have a core concept you see a wife cannot actually parse SQL fully because",
        "it has a little limited time it sits between you and the application and it should just work immediately it should make decisions immediately",
        "we see that WAFF The Defenders all offenders didn't let jadison support even though it is supported for more than 10 years why is that again that's exactly because they can't fully parse the SQL think about how many other SQL features that are prevalent in all SQL database engines are out there think about how many other features be it",
        "asynchronics action be it other data",
        "formats CSV XML that are out there and enabled by default just like Json and could be vulnerable to and by you'll be used to bypass arbitrary warps",
        "let's do a quick rundown of what we did we basically found a very cool vulnerability tried to exploit it and got stucked and we thought to ourselves yeah we're and we could have just said that let's leave it not vulnerable that's okay but instead we took the time and effort to try and analyze and black box how a WAFF works and we managed to bypass it and for the first time at least that I know of we have a generic craft bypass meaning I don't care what kind of wafted between me and the application I can just send it and forget it and which I think is pretty cool and also like we've shown Jason is very new ish in SQL it goes between one year 10 years it depends on the SQL database and each desk Guild engine decided to implement Json Json parser of their own each of them is proprietary and we believe there is some differences so you can wait for this research we're gonna do soon presenting the differences between different database engines and",
        "lastly give to the community if you have a New Concept do add support for it in open openly available tools because I believe it's cool so feel free to use a scale map with our new feature",
        "are there any questions if there are any questions you can go to the mic",
        "[Applause]",
        "[Music]",
        "[Music]"
    ],
    "jl-wVwk24k8": [
        "foreign",
        "thank you for being here pleasure to be on stage at black hat again one of my best conference ever so today I'm going to talk you um on CNC so for many of you CNC might be like a comment control server.net which actually is not it's actually machine used in industrial plan for manufacturing with the work I conducted try micro together with colleagues from celada is a partner we work with to get access to the machine Francesco Fabio and Leandro CC machines are Machinery that are very",
        "complex and they play a very important role in the industrial domain like visual you see on screen they Encompass a wide diversity of tooling machine so I mean you have like lattice machine milling machine press and so on and so forth so without really a lot of CNC machine out there and um given the fact that they are so prevalent like all the manufacturing plants nowadays use such a machine and",
        "they are very important we decided to take a look at those one and uh I guess we are the first to look into this domain it's something new not many people have done it so far and this is something that is really cool I mean I like to do research in which we explore a new new ground just to give you a kind of background on where we come from in this industrial domain you know this smart thing that you might be get used to like you know everything is smart nowadays like you have a smart fridge you have any smart device at home even in the industrial world have all those machine nowadays are smart this is called industry 4.0 it's a fancy",
        "buzzword but the word is full of buzzword and with this we mean machines that are not uh they need to be connected ever to other systems like for",
        "monitoring what machine is doing or a system for controlling those machine for example in automating the",
        "um the manufacturing plan and so on and so forth",
        "and all this is kind of complex there are a lot of players involved and we can model all these ecosystem as a supply chain so whatever normal is that you have a way what's called NC manufacturer which means basically the vendor that developed the controller one often happen is that such vendor sell the controller to the machine manufacturer which is basically the vendor the player of a development machine",
        "integrated into a factory floor and then get installed to the end user so this is how we can summarize it but things are a bit more complex for example what normally have pen is that you have a control manufacturer that sell the controller not to a single machine vendor but more than one so you might have for example 10 machine vendors 50 machine vendors that run with the same controller and this is an interesting point because in our research we decide to focus there at the beginning of a supply chain first because if there is a problem here at the beginning the problem get propagated down all along the supply chain right so if it is a bug in how the controller has been developed then you know all the supply chain is affected by that bag saccon because uh while there are many",
        "machine manufacturers of many Brands there are not many brands of",
        "controller manufacturer and so it's a bit easier to go out and do a research which is exhaustive so for that what we did we selected a few vendors that we think were a kind of a major player on the on the market for that and we did the research we don't want we don't wanna like to finger point against specific vendors say okay you know we found a bug in this vendor this vendor is bad so our goal for Visa search was to study this ecosystem and try to understand the security posture of CNC machines on a global scale so the vendor we selected you can see here so uh they pretty much cover virtual machine globally on a global scale we have two vendors from Japan uh Okuma and FANUC we have one vendor from us has it's the same vendor that you can see in the Formula One For Those racing we have one better from Europe either I'm which is one of the largest vendors of a CNC controllers within Europe and all those vendors have been there since I'm not saying things ever but if you take like a human heidelam from the 19th century you know so you know they're not like uh new uh players on the market and uh so what we did we took for each vendor the controllers they developed normally each vendor develop one single controller in different flavor but the the software running is pretty much the same for all the controllers of each single vendor and we did basically um experiment on both of the simulators and real machines so let me give you a kind of kind of summary of other things are here so you can see here on the left side of the screen that's a simulator it's not only the simulator is used when you develop a program for a machine and you want to test the program because before sending the common in production because this Machinery they were 24 7. so when you submit a program in production you want to make sure that the program works like in the keyword you know you have like the beta the testing environment the production environment so the simulator is a bit like the testing environment and there are software fully",
        "software based simulator that normally are like a VM okay like you know can be a virtualbox VMware VM whatever or there are like Hardware simulator like this one on screen they are pretty much the same thing and this simulator",
        "they operate exactly as a real war machine so the soft running simulator is exactly the same what change is that on the machine you have real world peripherals so like the motor and so on and so forth while for the simulator and these are these are the peripherals are virtualized but apart from that is exactly the same so that's why we start doing uh our search on simulator event we went on the real world machines so let me tell you a bit the approach we take in this journey as I said we want to add make an evaluation which was a fair with all the vendors so we try to use an approach which is the same for all the vendor we tested so first we did an initial assessment or scraping with a standard vulnerability scanning tools like nessus or many there are many those tools out there uh just to get rid of common vulnerabilities we are not really interested to so we are not you know we didn't want to do this research to to talk about non-vulnerability so we want to really to go down into technologies that are specific to the CNC domain so for that we did an exclusive investigation on domain specific Technologies so technologies that you can find only in the industrial domain and for that we came up with a table you've seen on screen um the table basically shows all the different vendor we tested and for each vendor there are technologies that are there by default So when you buy a machine you have those technology uh on the machine already and some other technologies that come on top you have to buy as a form of adines add-ons to",
        "your to your machine",
        "after that let me actually exactly let me give you this example first so this is an example of one of these Technologies we took a look at and is a is a kind of common to have technologies that are proprietary in this world as you can imagine let me give you a kind of background here yes you see all these Technologies on screen pretty much all of them except empty connector which I'm going to show later on that are they are all probability which makes things a bit more interesting from the research standpoint so this one is ethernet cue is a property protocol used by US our",
        "us-based vendor and it's a protocol that allows you to query out that information out of the machine or even to write things in the machine right so using the queue command you can for example you can see in red you can query the value of variable 10 000 okay which is a variable that is associated to a programming execution I'm going to describe later what this mean but even what is more interesting from a security standpoint if you are into a security word you will see okay you can also write a value into this variable right and here you can already think okay you know what I can write it memory addresses remotely in a controller what could Google wrong here so you can start thinking what Google run in the case so there are a lot of protocols like this I'll expose my Visa machine when there are protocols some protocols very few uh are actually standards for example empty connect is widely used in the CNC world but also uh in our ICS",
        "peripherals this protocol is used to making machine of different vendors communicating to each other just for a reason because as I said there are a lot of property protocols and Technologies so this is an F4 to standardize",
        "the the protocols no so for example if you take a Brand X brand y uh if you want to query for example for the tools installed on the machine for one vendor use a tool underscore number from the other one you would use something else and this is a standard basically to um to being able to use a single command to query information out of a of a machine so we start with this we took a look at the different protocols out there we did our uh related work or survey",
        "investigation before starting when we did the threat analogy so we put ourselves in the shoes of an attacker or with the black hat on our head and we said okay what could go wrong here right so we came up with scenarios and then we went down developing the park so I say okay let's you know see actually where are the problems and if a problem did exists so we did evaluation on simulator and real world machine we found of course problems and then we worked down with ICS server tab to communicate our",
        "findings with two affected vendors I'm going to talk about this later because it was not as easy as it could be the responsible disclosure in this in this domain",
        "all right so let me start by uh giving you a summary of the problems we have found here and this this light already might be uh pretty interesting for you so the problems are real problem right you know okay so the first is kind of obvious okay if you come from from the ICS world if you already attend some talks right it was yeah so it's Legacy software so the thing here is boost control has been around for many years and they add features on top like to make the control exposure exposed to the internet or to the network which create problems and they contain a lot of bugs this is uh kind of well understood in this domain so it's not nothing new here but what's worse caring is that almost all these Network protocol we took a look at they expose the bunch of information I mean since this machine need to be I have been fifth protocol has been designed to be connected to the internet and for a machine to be monitored you might say okay of course we expose information that's fine the thing is exposed too much of what actually we should expose I will give you some example on top of that often authentication is",
        "not present or if it's present is not offered by default and here there are reasons about that I talked with vendor and we'll discuss about that later and whenever is the lack of standard mechanisms using security for example a resource answers control even about Visa will give some examples so let me start a bit The Journey here so let's start from example from empty connect okay so this is a standard uh protocol that is supported by all the devices we took a look at and it works as an XML in XML format no so you can with an agent you can query information out of a of a controller information on for example uh the brand",
        "of a controller the version of control if the controller is operating correctly or not the position of the access so actually what the machine is doing but if you pay attention here I will give you a hint whatever is this red box there are some instructions there you may say okay cool what's that so this is a called instruction Block it's basically the instruction that is currently executing the controller to manufacture your pace and the format here is there called is on gcode so G-Code is the programming language for CNC machines you might see already okay this is not really compiled no it's not compiled the format here of G-Code is a bit like basic you know so line by line is like kind of scripting language so if you are an attacker and you can pull a service for example using a python script you can extract all the code running of the machine so you can already see that it's pretty severe because if you're an attacker and you can dump the source code of a program that the running of the machine remotely well you know there is a important problem with your production",
        "facility",
        "another example is about the fact that",
        "these vendors they are not much they are not real conscious on the security problems because one of these vendors had a way to an easy way to extract the firmware the tour that was stored on the controller for example here you can see a photo of of the board of one of his controller so this board is more produced by Seco he's",
        "an Italian brand and if you open up the manual you'd see that there is a jumper which is jumper 27 that if he's unable",
        "you can ask the controller to boot a",
        "remote peripheral no like an SD card so that point is super easy like you plug basically with SD card into your controller you turn on the controller and then you can run your your live",
        "eyes and all like whatever your live system so that point you can easily Mount the file system you can dump all the file systems so the firmware on the machine and then you can also pass with the VMware in a way that you can use you can basically enable SSH you can log in while the machine is running and you can use the machine for doing Dynamic analysis of anything so we use this as a way to get root access to the machine to be able to do uh the experiment in a easier way the problem here for the vendor is that we were able to extract all the firmware so all the software running on the controller and of course analyzing it so and after we talk with a vendor they said yeah they know what it's not much important for us if you have access to all our software and female running the controller that you're kidding me or what in such an easy way so you see just to give an idea of where we are from the security understanding in this domain",
        "another problem is the lack of resource assess control so what I mean here is that take for example us one of the one of our vendors so this is an example right to the protocol I showed you before with internet Q command protocol this protocol for query information out of the uh of the controller as well as for writing memory registers",
        "so by definition here at least this is what the website says you can write a certain so-called macro variables",
        "so this one are memory regions that are supposed to be located if you make a comparison with the operating system for desktop or normal breathing system that should be located in the user space so you have a program that execute on the machine and you have a way to influence what the program is doing by changing remotely the",
        "um the content of variable uh at user space so related to the programming in execution what you'd see from 10 000 to 1099. in the example I'm going to show you after just afterward next slide I'm going to show you how you actually an attacker can not only write those variables but also variable related to uh to the what what we could say at kernel space so related to how the machine and the controller operate so here you have on the left side of the attacker console on the right side you have a controller here I'm using VNC to connect to the uh to the controller so this is the HMI Frozen that are not expert in the domain so you have a built the engineer basically the operator of the machine so there is this nice controller with a bunch of buttons and whenever is we say HMI so this uh graphical user interface that shows on",
        "the left side it's the program that they get executed in G-Code so the code we have seen before on the bottom part we see we have information about what the machine is doing so the position of the X Y and Z axis and then we have top right Graphics it's a visual representation of what the machine is doing so you can watch the machine or you can watch the graphics of the visual representation here in this example there is an option to run the machine in debug mode the back mode here is called single step mode so the operator press one button and the Machine execute one command when I press another button machine execute another comma and so on and so forth so line by line like when you are debugging your application on your computer so what happened is that here this example you can see if execution goes line by line we have an operator in the back but push the button so what the attacker can do you can easily connect to the service",
        "right to a memory address on the machine that is responsible for this behavior and it can disable the single step mode so as soon as the attacker write on this memory region then there is this out of bound right that would result in a single step mode mean disable so you can see here the code goes up to the end",
        "basically goes to the end so you basically you skip all the breakpoint all in all the different instructions I go to the end and this is very severe because if I'm debugging a like a manufacturing process and I'm drilling things around you know and there is an operator working on the machine and you have such attack there is a problem for the safety of operator but also for what you're doing because the machine starts producing everything boom up to the end so huge impact here which is all summarized by this nice table we put together which is super impressive in my opinion so this summarize basically all the attacks we came up with and how many of those one works on on which on which vendor so overall uh something like uh",
        "what is 18 attacks I mean I would say 70 because one is generic compromise so it's not really an attack but let's say 17 attack plus we compromise possibility to remotely compromise the controller so as I said we divide the tax in different attack classes I'm going to discuss them but briefly compromise is a the way if we manage to compromise the controller using like a known vulnerability standard non-vulnerability for the operating system running the controller then we have attack related to the possibility of damaging a piece or a part that you are producing or a machine okay so you can think the impact of damaging a machine that cost over a million dollars because that's the cost of those machines the dial of service you all know what is the dial service is in the production industry that's super critical because for example in Italy uh one of our car manufacturer in Italy developed each Machinery I think seven or 17 minutes and I don't recall but around those times so if you block the production even for 10 minutes you know it's a lot of money that gets easily burned hijacking means that on the line",
        "there is taking control of the production to make the machine doing something different from what is supposed and the last class of attack is Data Theft so leaking information out like an example we've seen before where we were able to leak like the source code of a program running on the machine as you can see the situation is very bad and I believe our search just scratched the point of the icebergs in the sense that we just took a look at which kind of services are exposed and we managed to do all of this so I said okay well you know there will be problem in the next years probably for and if you guys are into security research you want to look into this domain you will for sure find a lot of issues so let me start with an example related to the compromise of one of our controller here I'm going to use Metasploit to compromise uh Okuma which is one of our vendor so the point here is not only to be able to easily compromise it I will show the video we will exploit the back of 2010 but first this machine was ready",
        "to be shipped to a customer so I said okay so I have a machine here it's going to be installed so in a factory floor how come you know it has a vulnerability to 12 years old okay second when we",
        "start when we compromise this machine we installed a malicious application",
        "running in the context of the controller this is because Okuma as a way to uh to offer a possibility to have an end user to install a an application similar to an extension for a browser like a browser Plugin or an extension for Chrome or Firefox or an application mobile application your mobile oh no what happened is that if I install my iPhone or whatever like an application mobile application I need to Grant permission to the application like kind of application or access you know my contact list can application access my camera",
        "all the architecture behind the controller does not support resources as control so when you install an application running the controller you have access to anything like all the",
        "functionality of the controller and this is super scary because at that point you can easily implant the back door and you have full control on on the controller and this is exactly what we did here so we use this vulnerability uh we scroll let's say 2010 061",
        "we exploit the vulnerability like super trigger and it's script kidding and people can do that we upload our malicious application and we develop with a framework provided by Okuma for developing a controller application the",
        "the framework is called think API if you're interested and then at that point you can easily run we I mean we install this service this service connect back to our",
        "um to ourselves basically as an attacker at that point giving us the information of the machine that has been has been targeted so the name of machine the serial number the type of controller at that point we could connect in and query information out so in this case I'm query for the",
        "value of a memory address the number one just an example of course this could be easily like that I can Bolton it right that go out basically Target a bunch of different like controllers install itself and basically they have access to to anything so let me go this is just an example how you could compromise this machine but let's now go deep into pure examples",
        "related to technologies that are domain specific so only related to domain of efficiency efficiency domain sorry",
        "here is an example on attacker could tamper with the configuration of tooling",
        "to introduce a micro defect in the production what does it mean here it means a you have a machine the machine is configuring with a set of tools okay whatever is that when the tool should be measured usually are measured automatically about the machine what I mean is that when the machine operates this tool gets wasted not get",
        "damaged because you are basically consuming and burning out the tools so there is a parameter kind of it's called compensation parameter or where in",
        "technically where you basically compensate the fact that the tooling for example a driller which is drilling the length of a point is basically reducing in length because you are constantly training holes so what you could do remotely you could basically hijack using the example I'll",
        "show you before where you can write memory addresses that actually belong to the kernel functionality of the controller you can tamper with this value so in this case here we are going basically to change this compensation uh factor of 0.25 millimeters",
        "by doing the attack remotely at that point the machine which is a you can see the photo of a machine operating so a machine is drilling basically some some holes right in a piece of metal what happens is that at the end the same program run twice introduce a mistake in the production the mistake is of 0.25 millimeter so",
        "this engraving that by code was supposed",
        "to be 5.05 millimeter depth at the end result in 4.80 so we didn't change the code the code is always the same as a an example program that we we came up with we just change this compensation factor and here the problem is massive because these machines they operate at the Precision that are easily 0.0001 millimeter so if you are an attacker and you can introduce a small errors in the production then there is a big problem because you you can have like factories that produce thousands of millions of pieces that go out on the market and they don't comply with it with a with what they should be right so they would bypass QA go out and then you need basically to record all these pieces so can you imagine like the loss in terms of the economy for the company and the laws of reputation right for having like a million of pieces like being sold online being sold and you know with wrong like basically uh specification so this is one problem we found there is a variation of this attack that we tested in practice so what we did we use a 3D printer we printed the",
        "um the drill point you see on the picture on the left in plastic okay so that's one is the drill point in plastic it is mounted on the spindle inside the machine and then we did the attack and instead of setting a compensation factor of only 0.25 we sent",
        "we set the compensation factor of 10 millimeter which is more than blank the",
        "point itself so in this case when the machine start it basically crash completely the point against the rupees and you can see there that one is a is a photo I take um from from the video so basically the point basically crashed against the drill with the piece and I'm going I broke basically the tool of a machine visual course is a plastic tool but you know these tools cost a lot of money so here an attacker could easily damage the tool could easily do damage like the row piece in production or even the machine so all of these of course has been run remotely without notice from operator very bad",
        "another issue is a kind of this is the same of what I show you before on empty connector this is actually the real demo so it's about leaking the source code so here I have this script that pull the empty agent to extract the code block so the instruction of a source code that get executed on the machine you can see here I'm able basically to dump the",
        "instruction of of a program so you can see on the left there is vehicuma simulator with a graphics on what the machine is doing and the source code which have a program that gets executed called cybercq.min",
        "and the number right I have basically programmed with remotely done the content of of the code this one brings us to the next attack which is related to hijacking a",
        "parametric program so here in the example which is the same as before you can see here there is a red box around this instruction that says",
        "drill a certain number of holes",
        "which is a k which corresponds to the value of the",
        "of a variable VC one all right so in this case vc1 is equal to 2 because this one is what the developer has basically said in his code the thing here the thing here is that remotely",
        "we were able to override the content of this value of this variable from 2 to 5. so what happens is that the machine was still operating with the same program but instead of drilling two holes the machine was starting really five holes that's also super severe because you can basically influence the logic behind",
        "what a machine is doing which is very bad another example you could potentially also rewrite entirely the program that get executed so this one is a funnel so it's different controller we have a program called o thousand",
        "here using a code that we develop we connect to the machine we download the program we open up a program with not about plus plus we change the program by adding a stupid comment and rename program or one zero zero two we upload the program and the Machine automatically pick up the new program and run our code okay",
        "well so we made basically to hijack a program while the program gets executed",
        "another problem with managed to damage parts of a piece that get produced",
        "here again we did it by hijacking What's called the tooling configuration of the machine was called the advanced management tool system the thing here is when you have a production that is continuous now so I'm producing basic one after the hour when a tool gets exhausted I take the new one when this tool gets exhausted I take a new one so there is a counter that count how many holes you've done or for how many seconds use a tool and here remotely you can reset with counter so the machine constantly keep using the same tool so even if a machine is burned out I ask the machine okay keep using this tool as more now keep using this tool we don't care if the machine keep using the same tool and basically break completely piece or even part of a machine",
        "this one is another example where we disable the feed old which is the button in red this is a bit like the break of your car so you're driving there is a curve and you break here is the same the machine runs there are problems you just break the emergence button right it's called feed hole but it's the emergency button you break and the Machine should stop there is a feature in which you could disable this button to speak like I give I sell a car whether it's a break I can use to break my car and then I give a possibility via Cloud to remotely disable the brake of a car sorry so here you can do an attack in which you disable such button the operator cam oh there is a problem try to stop the machine which is telling you know what I'm not going to stop the machine because we feed all these in yellow is suppressed if it only surprised I'm not going to stop a machine",
        "I'm almost done guys with some of example but we have also a paper with a bunch of other things but this is the tough manufacturing information so the machine is producing you can see here versus operator look at the machine business running",
        "we start monitoring the machine we can dump information like the name of the machine the serial number the type of control that runs the type of programs they run the name of a program The Source Code the line DC block by block will get executed and bottom right the number of pieces so here if you have an aggressor a Miss ground an active",
        "um a Target you can dump all the anything like what gets produced how many pieces from which code and so on and so forth few examples to conclude the build to trigger software alarms okay like in computer programs there is a way to raise software alarm or interrupts with block of execution here is the same remotely can raise interrupts of the machine get blocked and the operator needs to walk down and just restart the machine and of course you can also run some of the machine so you connect in and you can lock down the machine you can see here you can run from the machine you can also steal the information in files from the file system remotely and encrypt the file that's also something we were able to do so the discussion I have five more minutes I want to take two more of your time folks so CNC machine are very complex system and you can see the attack surface is huge",
        "so we did this work kind of my my opinion Premier one but we already found a bunch of interesting things and some interesting point are when we talk with a vendor shift over the responsibility so they you talk to the manufacturers of the controller they said you know what we provide our controls to the machine manufacturer so it's their problem then to implement some of the security",
        "features I said oh that's not the tools you have a beginner supply chain you have to do your best diligence in developing controllers that are safe",
        "secure enough and then each of you know of the players in the supply chain can add on top of what you have done another problem patch deployment is still a major issue even if this machine are supposed to be smart so connected to the internet and maybe come with out of date functionality I didn't see that at all so that's also another big problem an average problem is the lack of understanding when it comes to security so we did our due diligence effort in",
        "doing responsible disclosure with vendor with 2006 to nine months I mean all the vendor at the end understood what we are talking about but it's not like curing uh you know one of a well-established vendors that have assert and they already have people assigned to the security domain here you are talking with anyone I mean nobody's into there is no security team of in one of these uh vendors even if you're vendors that have more than a billion revenue and thousand people working for them so in our work we work with them closely with explain them the problem at the end all of them acknowledge our findings so some are being fixed some",
        "will be fixed in the future uh the documentation has been improved so that the machine manufacturer know how to add for example support to authentication because before they were not even aware",
        "of a fight with maybe a certain protocol would have possibility to add authentication on top of a default configuration",
        "meanwhile while all of these get implemented there are countermeasured so for version that have CNC machines you may want to use IDs IPS or firewall that understand OT protocols",
        "property protocols using the ICS word",
        "and if you are curious about what we did we came up with a website so if you Google for it you will find for sure there is a paper which is uh 70 or 80 pages long it's a PDF let's summarizes a bit what we have done with a bunch of more examples we also have videos so we came up with five videos one which is a kind of General video of all research and then one per attack class so one ready to adjusting one damage one in uh data Tab and so on and so forth and then if you are curious enough I'm open for questions so thanks for your time",
        "[Applause]",
        "foreign",
        "[Music]"
    ],
    "CIrwWU-VYJw": [
        "foreign",
        "so just a quick show of hands to make sure that uh we don't repeat a bunch of stuff um how many people were in the keynote this morning okay good that is very helpful thank you um and yes it was a Shameless plug I'm so glad it worked thanks for joining us um all right so we'll get started should we do introductions yeah that seems like a sensible idea do you want to go again I I sort of feel like people know who I am at this point so given that everyone knows who Jen is I'll introduce myself um my name is Irfan himani I'm a deputy director at dcms and I'm responsible for UK cyber policy",
        "yeah fantastic um I'm yes I'm not going to repeat everything that I said earlier um but I will just say as I this is a thing I said earlier but it's a really big deal that people from the government are coming to speak to you guys and the earphones here and hopefully we'll have a little bit of time and questions and and you'll actually be able to like ask him stuff so like this is a big deal uh so yes he has to be out of here by 2 30 though guys that's your limitation um all right we will get going right so I went over this a little bit this morning so I'm not going to talk about it massively the thing I didn't mention is that",
        "um in December of last year it's about a year ago um the UK published a new National cyber security strategy um I'm not going to go through in detail because everyone's going to do that um and then in January of this year there was a new government cyber security strategy and actually the cabinet office board that we mentioned is sort of tied to that government cyber security strategy and how that's being rolled out and made accessible",
        "um so there's a lot going on basically",
        "and I spent an hour this morning explaining to you why you guys should pay attention to it so I'm not going to repeat that right now",
        "um so just to kind of build on what what Jen was saying earlier in just now it is there is a lot happening in this space for government now I think um we are um we've just published a new National cyber strategy uh there are laws going into Parliament there is there are regulations there's codes of practice coming out there's a lot happening in this space and it's really important for us that we're not doing that um outside of the real world it's really important that we're doing that in a way that's sensible um speaking to people who actually know about what's going on who are responsible for this at the coal face um and and recognizing that cyber security sits within the UK government's broader agenda of you know um making sure digital Technologies are the enabler that they're they're supposed to be that we use them for things like future Technologies for Net Zero for example in kind of um working out how to be more energy efficient that we use them for um you know the UK government's focus on growth there's a whole load of things which we've said digital Technologies are important for we actually have to make sure that we are doing all the right things um in terms of managing the risk so that that can actually happen um and so there's been a huge push in the last um last few years in fact um people will be familiar with things like the development of the ncsc over the last uh six years in its current format um that that came out of the last government cyber security or the last um government cyber security tax strategy in 2016 which was really about building UK government capability in this space it was built around the um principles of deter defend and develop deterring adversaries developing capability and defend and",
        "defending against against cyber",
        "adversaries the new Cyber Strat The New National cyber strategy looks to build on that it recognizes that government can only do so much and actually the the responsibility and the action and the engagement needs to be much broader we need technology companies to play their part we need the cyber community to play its part we need individuals to do their uh to take responsibility we need um Academia to get involved uh government needs to be better at defending itself and and so we need to recognize how different parts of the economy link up so the last National cyber strategy published a year ago looked to really broaden out who was involved with government and what we were trying to do it's no longer about government is going to develop the capability to do these things it's how do we enable the economy to be more cyber resilient can I just before you move on can I just ask show of hands how many people in the room have worked with or interacted with in some way their government's cyber",
        "strategy or cyber policy division",
        "okay thank you that's helpful I'll be honest that's more than I was uh thinking but it wasn't the whole room um and so don't ever have a way to play all right baby steps um I'll very quickly run through what the five areas of the national cyber strategy were um",
        "the first the first part is the one in the middle which looks at um leading on technology security so this is really trying to understand",
        "um what are the technologies that the UK economy depend on and how do we actually reduce cyber risk at source through those Technologies so looking at",
        "um consumer connected devices or Enterprise connected devices looking at digital service providers looking at app security and and app stores and trying to understand how we through those Technologies minimize the risk that actually ends up in organizational networks or in individual on individuals devices",
        "then we look at organizational cyber resilience so what is it that government needs to do to protect or to improve cyber resilience in organizations and it's really categorized for us in three in in four ways one is improving the Cyber resilience of government improving the side resilience of critical National infrastructure improving the Cyber resilience of organizations in the broader economy and then improving the side resilience of individuals and it's in that order of because that's that's how we that's how we see risk um we need to do much more as Government to protect government security then we might need to do on the individual level we need to do a lot more around critical National infrastructure than we might do around other organizations that doesn't mean we don't do nothing but it means that our response and our activities has to be proportionate to the risk and risk sits on the light's switching off or um issues at Water distribution and that kind of thing then we move into uh the bit that sort of underpins all of it um which is the the community that that most of the people in this room come from which is the Cyber ecosystem there is very little point in us doing anything or us talking about doing anything if we don't have a strong cyber security sector and we don't have the professionals that can actually do what's needed to improve cyber resilience or um make make technology more secure so building a skills and Industrial base in the UK that can actually keep the UK secure um is is a strand in itself and is probably the centerpiece of of what we do there's a strand also on um advancing UK leadership so this is about how we interact with other countries cyber security is not confined cyber threats are not confined to UK borders and so there is a lot that we must do working with with other governments on how we um go after criminals in other countries um how we develop policy in the same way because no point having UK policy that's not connected to to what some of our um major partners are doing and then there is also the one that I think a lot of people be perhaps more familiar with which is um detecting disrupting and differ and and um deterring adversaries which is",
        "um how do we um interact with the Bad actors the the Cyber criminals in the nation states that are actually looking to um access our networks just before you move on can I just add so for those in the room who perhaps are not UK based um you know obviously we're talking about what the UK government does because that's who earphone works for um but actually the reality is lots of governments are doing this you know we talked about that this morning and if you look at things like the UN activity or the G7 or the work that's going into the treaty the counter ransomware initiative is 30 countries around the world there's a lot of international collaboration on this the EU is extremely active on Cyber policy at the moment so if you are you know if your home base is not here this stuff is still relevant to you yes we're going to be focusing more on the UK stuff but the chances are that your home government is involved in some of these initiatives and it is I highly recommend it's worth looking at what they're doing and how you can get involved with it um just out of interest is anyone here from an EU country",
        "good brilliant cyber resilience act cyber resilience act uh is is a really interesting one happy to speak uh offline about that to anyone uh but also one of the UK's main cyber security laws is an old EU law it's the niz directive um which we still have the UK in the UK we still have the niz directive that's the network and information systems directive thank you for translating governments you're from the government and you like alphabet soup the EU have just announced an update to there um to that directive and we have published our intentions a week ago on what we intend to do with the the UK version of those regulations and the EU is also updating this yeah",
        "um so I've mentioned those five",
        "um pillars of the national cyber strategy and when we started I also said I'm from the Department for digital culture media and Sport and there's probably a lot of people in the room who are thinking why is the department for digital cultural media and sport in the room we are not um cyber First Responders we are not um you know uh pretending that we do a lot and the ncsc do a little bit uh that's not this at all there is a huge cross-government effort on cyber security um I think in the last few years since I've joined uh the amount that we all talk to each other has improved dramatically and that's because we all manage um separate parts of the risk profile but also hold different levers within uh the UK government on how we actually get things done when I say levers I mean laws or awareness campaigns or programs",
        "or law enforcement for example so the department for digital cultural media and sport is responsible I've used an old logo that doesn't have the digital in there but you haven't done that I've done that it's very nice of you to fall on your sword but it was me um is responsible for UK digital policy and it's quite important that in the UK cyber security responsibility for cyber security policy Falls within the digital Department that's not the same in every country and the reason that that was done is because we recognize that there is a um a criminal side of this there is a nation-state side of this but actually cyber security is largely an economic issue it is also a national security issue but we want to make sure that as we develop policy for cyber security we're doing it with alongside our policies of data protection or",
        "um digital competition or online harms for example those things can't be separated from each other and so all of this sits within the department for for digital cultural media and Sport at the same time our colleagues at the home office are responsible for anything to do with law enforcement the foreign Commonwealth and development office is everything to do with our International engagement in bodies like the UN in our work on the council ransomware Initiative for example um and and building coalitions to call out nation states uh when we uh when we know that there are certain nation states that have been undertaking cyber activities that's a coalition that often hits 35 Plus countries now and that's a huge International effort on getting countries to actually recognize that this is an important thing to do of course underpinning all of this is the national cyber security Center they are the National Technical Authority um they are incredible at what they do I don't think there's anyone that does anything cyber that doesn't speak to the National cyber security Center um uh and and and uh they are they are everywhere and and they are you know uh The Trusted center point of UK cyber uh a cabin office is largely a coordinating body uh but also is responsible for government cyber security so the security of government and the public sector sits with the cabinet office and then you have uh every government department is responsible for the cyber security of its sector so",
        "um the cyber security of the transport Network sits with the department for transport Health sector department for health uh and sector Regulators within those um within those sectors I also have a responsibility particularly under the network and information systems regulations but also within financial services so off gem is responsible for enforcing cyber security regulations uh within the energy sector um and uh",
        "the Ico is as well within digital within",
        "Digital Services and ofcom on internet infrastructure",
        "good yeah I think so that was good great brilliant see I basically just made everything come here and he's really giving the talk and I just get to stand here and stare at him it's a little unfortunate should I move on to our security related bills environment so um so just as a as a reminder government policy",
        "entails a number of different things um you know we can look at anything from how do we improve Behavior or how do we sorry how do we change Behavior so how do we get people to be more cyber aware hence the kind of national campaigns around cyber aware on too fat you know getting people to use two-factor authentication we can look at helping Define what good looks like so codes of practice or developing standards",
        "um as an you know we can invest in certain programs um to help uh you know so for instance in our skills work we do a lot of work around getting young people more interested in the Cyber profession so that we have a larger Pipeline and uh going into the cyber cyber Workforce as a very last resort um we can use laws laws are incredibly expensive clunky difficult to maintain",
        "um we only use them if we absolutely have to I'll come on to that a bit later and so these are three laws that",
        "um have uh started in Parliament yes have started in Parliament or finished in Parliament this year um that impact on cyber security in quite a significant way um do you want to I think you're gonna do TSA first but can I just before we get into it who in the room has heard of the telecoms Security Act telecommunications security acts really okay a very small number um okay that's good to know thank you so yeah so the Telecom Security Act is um",
        "look it well it's looking to improve the security and reduce the vulnerability of telecoms Networks",
        "um and again as a kind of risk proportionate approach we look at laws for critical National infrastructure cyber security and try to keep it at that and we have the networking Information Systems regulations for five sectors Financial Services have theirs and then telecoms have this Telecom Security Act now the reason we looked at a law for this was because Telecom security is so integral to",
        "um UK life and the UK economy and also as a um potential Vector for cyber attacks",
        "across the rest of the economy the ACT looks at um a number of different principles or themes that companies have",
        "to um show that they are um doing within their company to reduce the uh available reduce access to",
        "um anyone that might try to infiltrate their Network yeah and there's an accompanying code of practice um that has a number a number higher of principles in it yeah um the product security and telecoms infrastructure bill so Dan mentioned this in his keynote yesterday so I'm hoping now when I say how many people have heard of the product security and telecoms infrastructure Bill more people will raise their hand all right um okay so uh this again I mean it it goes sort of hand in hand with TSA and it covers some of the uh infrastructure pieces of telecommunications what I want to focus on is similar to what Dan focused on yesterday one of the other things it does is it takes that iot code of practice that I showed you guys this morning and it takes the top three principles of that and it basically sort of enshrines them in law and says yes guys if you are building uh connected devices then you really need to not use",
        "universal default passwords you need to have a way for people to report vulnerabilities and you need to tell your customers how long you're going to complete continue to support the product from a security point of view so quite simple high level stuff but still a massive step forward than where we are for a lot of organizations in this space um so this is this is one we like we're big fans um the last one data protection and digital information bill so this is really sort of an update to what the UK currently has in data protection world and it looks at a number of sort of different aspects around how data is used and accessed and protected it is not at its core a cyber security bill but because I don't know if you've heard but security is quite important to how you protect data um and so there are elements in there in the same way that sort of gdpr speaks to how the things that you need to do although it speaks to in a very very vague or paid terms but the idea is that this bill will kind of build onto that and say these are then some things we're expecting in how you will uh make sure that data is being protected",
        "also worth noting that the product security and Telecom communication infrastructure bill is now an act because it was signed into law by King Charles yesterday oh half the presses so yeah look at that implementation period but in the next 18 months um any device that you buy that is available on the consumer Market will have to have those three security requirements and that is a step forward that I mean it's baby steps but that's how we do this and that's how we make sure that we're not creating overburdensome laws",
        "um or going too far right but it's it's those incremental um Evolutions that matter",
        "how bill becomes a law um so how many people in this room feel that they know the answer to this question as pertains to the UK because I will tell you when I started doing policy work in the UK I had no idea",
        "which is a little embarrassing for me to say on a stage in front of people when I work on policy Zone but also not a lot of hands went up so take it away uh yeah so I'll give the the two and a half minute version rather than the the three-year degree whatever but it's it it's not easy and um the first 10 questions or the first 10 rounds of communications we get from parliament are have you considered everything else show us that you've considered everything else how do we know that everything else doesn't work does this have to be a law as soon as you start talking about a law you're talking about funding in perpetuity for supporting that law and",
        "uh government doesn't like to make funding commitments like that uh not for something not not for laws anyway and then you have to talk about funding the rate so so the first thing that happens is we get asked is this a really a law that should be a law or can you do this another way and we get told to do that about 10 times that takes about six months",
        "um and sometimes longer because we actually have to go and try other things if we've tried to shortcut and go to the law and Parliament are very very strict on that um and then there's a bidding process that happens within government so each department puts forward its legislative priorities uh and then a group of",
        "ministers the the relevant group of ministers come together and decide which of those are actually at the top of the government's agenda um your it is very likely I think uh So within uh within dcms last year there may have been I think 11 potential bills that were put forward um only four made it into and bear in mind if that's across TCMS that will have included museums and sports and funny walks and all the other stuff that you guys cover yeah or yes that I mean it did it did it did there was a lot of that um but there's also a lot happening in the digital space so I think eight of those were digital related because digital is largely an unregulated",
        "domain",
        "um that still doesn't have a lot of laws around it so again that also doesn't mean cyber security necessarily no",
        "um no everything digital so there's a huge amount that people are trying to get into onto the statute books um I feel I've already used two minutes of my two and a half um government departments then bid ministers then decide uh and then",
        "once that decision process has happened which can take anything from uh one to three months when it once it gets to ministers and they need to negotiate and decide um it then makes it into the Queen's King's speech so The King's Speech will be at the beginning of a parliamentary session uh parliamentary session will run from May to April or spring to Spring and it is opened by that speech from uh the Monarch uh who then says my government shall and if you're in that then you are going to be introduced into Parliament maybe because once the Parliamentary session begins who knows what yeah all bets are off but if you're not in that you're definitely not going to be on the agenda unless an emergency happens that puts you on the agenda yeah so uh this year we've seen a little bit of um um",
        "what's the word change in the UK government have we and so the UK legislative program changed a little bit there were emergency bills that came in particularly around energy and energy energy pricing",
        "um and there were things that just haven't made it through uh because uh there was quite a lot of emergency quite a lot of emergency bills happening over the summer and after um political events as well but if your bill does get into um the first reading which is where they stand in Parliament and they read the name of the bill and that's it uh then you're in Parliament and they literally say the name of the bill and then they carry on and then the second reading is where the debates happen so you have a second reading it will be in the UK it's it'll be in the House of Commons and then um that then gets kicked over to uh the House of Lords where they will also have a slightly more um a very interesting technical debate around uh very specific Provisions within the policy uh within the within the law and then there's a committee stage as well where this is talked about in committee and debated and experts can come in and talk about it and committees can grow experts on what they think is happening in the bill and then that will go back to uh to the house uh who well go back to the House of Lords in in the in the um instance of the the product security Bill who then ask for amendments and then because of our very unique legislative set up the House of Commons can either say yes or no it can entertain government amendments so if the government itself or other members of the government want to make changes they might accept them if the opposition wants to make changes depending on the political scenario they may accept them they may not um in in in the case of our bill product security there were no non-government amendments that were accepted um it goes back to the House of Commons who then have a final reading and it gets rated into law and then we wait for the king's signature which was yesterday so awesome congratulations normally your bill has to pass through in one session unless it's designated as a carryover Bill not a hangover bill",
        "um perhaps more appropriate the product security bill was a carryover bill and it was in Parliament for 353 days",
        "so for other countries I would say that the system is probably similar but there'll be nuances that are different um but in a democratic Nation you'll go through this sort of review and just debate process there is something though that is um I think I've only encountered in the UK and that is the concept of primary and secondary legislation yes so now that we have a law which is the product security and Telecommunications infrastructure act we need to develop the regulations that sit under it that will actually determine how that law is enforced so what is it exactly that customers that consumers need to do what is exactly that manufacturers need to do how will the regulator enforce it what",
        "powers does the regulator have how much can they find companies uh what's the legal process for appealing and and all of that stuff so that's all in secondary yeah so the primary legislation basically set up sets of the framework and and establishes the goal the secondary enables you to then come up with this specifics and what that means is it doesn't have to go through that same long process right so the idea behind it is that you know we're dealing with technical stuff in an environment that moves really fast so what we think the expectation should be today might not be the expectations in five years a system like this means that if the requirements the specific Tweaky bits",
        "about how we're doing a thing change in five years we can move through that secondary legislation process much much faster it doesn't have to be such a heavy lift each time still with checks and balances in place but much faster and that actually means that we can keep the law updated in a much better way so it's a good thing to sort of understand the distinction there the the the way you can't do that is if the change you want to make would change what's in the primary legislation so if it would change the sort of meaning or intent um or the way that it's it's going to be um understood then then that would then be another you'd have to go through that primary process again this is the thing I had no idea about until until I started down this this route",
        "ah yeah all right enough about how we make a law",
        "um so uh we're not going to go through all of these because uh we've only got 12 minutes left um but these are the I mentioned this morning that there were six public consultations um basically a public consultation means that uh whichever government office is running it will have uh they'll make a public notification they'll normally have a set of questions they ask in a survey um and then as I said this morning you also have the option to send them additional thoughts or or explanatory thoughts um over and above that um I'm not going to talk too much about professionalization because we covered that this morning um and I am going to uh I'm going to hand off to you to talk about the niss update yeah so so there are different types of consultations that we can go through and there's a uh there's something called a call for information which is when we're at the beginning of the policy development cycle and we say here is a problem what do people think and that's a chance to say what are the issues what are potential Solutions what might we do and then there are consultations further down the line which is where we say here is what we think we're going to do about the problem and ask people to to opine on that um a couple of interesting ones uh one that is coming out very very soon the app security and privacy code of practice which we consulted on",
        "um we had a lot of really useful industry feedback we had a lot of people that were very generous with their time in actually developing uh that code of practice and that is looking to say to uh app stores and app developers here are the things this is what good looks like in terms of development this is what good looks like in terms of um how you host or or display",
        "um apps uh apps on your stores this is what you should be doing um improving software vulnerability disclosures",
        "um minimizing the amount of data you're collecting making sure that switching off um data collection doesn't affect functionality where that data is not needed for that functionality um you know reducing the Quantum of data essentially is part of it but also improving actually the way apps are developed in the first place that's a voluntary code of practice which is coming out tomorrow and will be monitored over the next 12 months and I do I want to emphasize that it's voluntary this is not regulation or legislation um how many people in this room are involved in some way in app security so here's my challenge to all of you and I said this morning I wouldn't give you homework but I'm totally going to give you homework um when it comes out which will be soon take a look at it it's going to be really soon did I mention it'll be soon um take a look at it and have an opinion we have a period of time where it's going to come into play and people will hopefully start to adopt it and you get to have an opinion on this if you think that it's missing the mark in some way actually DC must want to hear from you it's with this stuff it's never one and done it's never like we have it and therefore we're never going to touch it again they're going to be going through a review period with the product security and Telecommunications infrastructure bill which we talked about a little bit so I go sorry psti act as it is now",
        "um the initial process was that code of that code of practice that I showed you and dcms continue to monitor the situation and they said we have this code of practice and what governments are adopting it the private sector is not so how do we drive better adoption and that's how they eventually got to the point of saying we're going to have to introduce legislation so so there is a continuous review process and they will continue to seek feedback on what's out there and how it's being applied and you guys can have opinions on that and you can feed into that process so if appsec is your jam definitely pay attention to this and be prepared to participate thank you that's absolutely right we want to hear everything that's wrong with it if you want to say something nice that's great as well um no no we work for security I don't know another one I think it's worth drawing people's attention just because I think it's so important at the moment and quite Monumental uh when once we once we go through with it is their resilience um cyber resilience legislation",
        "um we published last Wednesday our intentions on that it's an update to the network and information systems regulations firstly the most important thing it does for us is it actually it's because it's an old EU legislation a bit of old ee legislation we don't have any powers to amend it anymore uh I think that no one didn't quite think about that disconnected um but we so we need we're looking to get the powers back to actually make changes to that and then we're looking to do things like bring in to scope manage service providers which are currently not um not involved and have been an attack Vector um quite considerably in the last few years um we're also looking down the supply chain so not just digital uh digital suppliers but also if your company is so reliant on a supplier and something happens to them such that you can't operate and that Target company or the company we're worried about is an operator of critical National infrastructure there will be obligations on the supplier and I think that's really important because we've seen that happen a few times we saw it happen with the NHS this year through uh Advance yeah and so if",
        "you are sitting here and you work for a security company you might want to consider that security companies might come under that description",
        "um it's fine should we move to the next one and a few areas that are coming up as well uh enterprise software security we are doing an early stage uh call for information uh in the coming months where we are going to we've looked at um we've looked at a number of different risk areas around Enterprise security we're going to talk about this in terms of um development environment security development environments we're going to talk about this in terms of transparency of um uh software Supply chains we're going to talk about this in terms of Open Source software security and we're really looking to understand how to how we need to understand those risks what the how that translates to companies and businesses and what government might be able to do in those areas or is this an area where governments should stay very very far away from or what is it the government can do to help it's not a law it could be something else so this is a really kind of what do people think about these areas Enterprise iot in the same way that we develop principle apples for Consumer connected devices",
        "we're also looking at Enterprise connected devices now and so the risk profile is slightly different within Enterprise Network so how do we need to adjust the the principles around that uh principle professional qualifications skills is cyber skills is kind of one of the most important things that I think government is doing on Cyber and we did a consultation on it uh the constation",
        "said do not regulate so not going into any regulation for the moment it did also say that there's a lot of confusion around how you identify who has what cyber qualifications companies more than",
        "individuals are unable to understand what their cyber professionals that they're hiring do and whether they are qualified or not they are finding it difficult and I'm not talking about cyber companies I'm talking about companies that hire cyber people so every company and so how we then make that market more transparent for buyers is going to be an important um part of our policy work going forward we're also looking at how cyber security gets included in",
        "um business resilience so every year companies have to file accounts public companies have to do have have to have certain other um reporting requirements and the biggest ones we are looking at how they might have to talk about cyber resilience within their um annual statements",
        "um and we're also looking at um the UK semiconductor ecosystem the EU has got",
        "uh quite a big initiative on this uh the US has got quite a big initiative on uh semiconductors uh the UK is um is going to have a slightly different approach and there will be a whole strategy around what the UK can do around improving its capability at the heart of that is improving the design of semiconductors themselves and looking at designing out floors that have been in",
        "um semiconductors for the last 40 years or so um particularly around buffer overflow but how do we get those um newly designed chips into the digital ecosystem so those will be kind of big areas that you'll hear a lot about coming out of dcms",
        "all right so we're going to Blitz through this very quickly so thank you by the way this is when any of us gets really relieved um okay so there are this is the challenge right like this is what you guys want to know is hey we're here we're interested you told us we need to pay attention we're paying attention how do we actually get involved and the reality is it's tough and I know that it's tough um having access is difficult there's no you know your friend and I were talking about this there's no way of going on to dcms's website and like just subscribing to a feed you have to just keep checking regularly and putting in cyber security and seeing what there is you could do something like you could follow their Twitter handle but it it covers everything that dcms does and and at the same time it doesn't cover everything so you'd get stuff that's not about security and you won't get everything that's security potentially but check their website like that is a that's a fundamental um if you are a a journalist and you cover this sector you can help be an amazing voice to the security community and help them stay informed on these things that would be lovely we would love that um when there are consultations and you hear about them and hey if you hear about a consultation why not spread the word tell your buddies put it on LinkedIn put it on Twitter put it on Macedon whatever your platform of choice is share the word and help other people participate so then the consultations",
        "themselves you can participate as an individual you do not have to be part of an organization and you have options you can as I said normally they are either they'll have a list of questions and you can literally just respond to those questions sometimes the questions are literally multiple choice so you're just choosing you know um or you can write an email with your thoughts and send that in if you want to kind of be able to explain it a bit more and get into it a bit more there is also a thing in any Democratic Nation where you can supposedly contact your local representative and ask them to pay attention to a cause and you can do that here and in most other countries that hopefully you are from um they may not know anything about security but they but they will write us a letter that right and that will help you get connected to the right people and so and actually you can also look for what the right offices are that are covering topics again they have to provide this information publicly so if you do a little bit of your Google searching you should be able to find it and there is normally a way of contacting them because they work for",
        "you you pay their wages so they have something on their website that says here's how you can contact us so do that if you want to talk to them they won't always follow up because it turns out there's quite a lot of people who contact them but they will try and at least it gets you further forward um again talk in the community as much as possible and then if you have access to some sort of Industry body a trade Association a professional Development Association you can talk to them and help educate them on security issues and then use the Ability that they have to amplify your message turn them into the Champions you want them to be make them work for you and that's another really good way of getting in touch with the government so some tips when you do that um these are basic things one do your research know who you're talking about know what you're talking about know who they are and what they care about um do acknowledge and and praise the things that they've got right we're all human we all like to hear when we get something right we work really hard on it they work really hard on it when you provide feedback try to make it as constructive as possible try to make it as actionable as possible give solid examples of what you mean and where possible make recommendations on how to fix it that won't always be something you can easily do but if you can if you've got an idea provide it avoid jargon we talked about this this morning",
        "be nice to people I shouldn't have to tell anyone that it's a basic it's a fundamental and you know recognize",
        "the guys who wrote policy",
        "their job is to be experts on policy how many people in this room think they're an expert on policy right",
        "oh yeah me yeah right I'm essentially there's a couple of people that put their hands up all right um how many people in the Stream think that they're relatively expert on some area of security yeah that's your job the cool thing is when you bring that to them and you get to learn from their policy expertise and they get to learn from your security expertise we have shared goals when we combine our expertise great things can happen there's some sort of you know great power thing in there but I'm going to leave it where it is um I'm already getting sued by Star Trek after all um and you know just be honest about what the what the challenges are and the last thing is we love to point out problems but we don't have to do it with a pitchfork in our hands you're just a little bit of respect to understand that people are working really hard they're actually trying to make things better for all of you guys so don't approach them like it is an angry mob Fun Run thank you very much as I said at the beginning he has to be out of here by 2 30 but we will be outside so if people want to come and ask him questions we're around thank you very much thank you",
        "foreign",
        "[Music]",
        "[Music]"
    ],
    "zQKYazIlAgM": [
        "foreign",
        "this talk is about as you can see here we have placed a lot of devices so we'll try to explain everything in a moment but in in summary we are going to talk a different approach on how to bypass the secure boat on on a specific Qualcomm stock in this case we we are going to present how can we try to achieve this goal without knowing anything about the the software is running inside the sock anything about how the secure boot has been implemented or any particular if instruction we want to to escape or something like that this is the the that the reason we name blind glitch because we are blind we don't know anything and we are trying to bypass this so I'll start talking about us so my name is Hector Marco I am the founder of cyber intelligence it's a company based in Spain and my colleague is vicent now is Hardware security researcher so we have been working in in smartphone security for a while I've been working in cyber security for more than 15 years right now and as I say we are working in both server and cyber security at the company so today we are going to talk just about Hardware but we are also doing software stuff so right now we are working in a project this project is basically named the X5 project so in this project the one of the main goals is to be able to access to data I store it in modern smartphones so as you can imagine so right now it's not an easy task because everything is encrypted we have the trusted Zone we have a lot of crypto devices so one of the main goals is be able to access to this data in in order to provide this critical evidences in criminal cases right so we want somehow to access to that evidences so the main goals is fun ways so we need to find ways but at the same time we need strong security for users but we also need to provide mechanisms to access to this to this data okay in for especially in order to to solve criminal cases so as you can imagine we have Sovereign and Hardware approaches for that so in this talk we are going to just talk about uh",
        "Hardware methods okay",
        "and basically we are going to create and develop tools to improve reverse engineering means that we are going to try to go beyond the state of the art in order to provide the last method and Technologies in order to be able to retrieve data for this encrypted smartphones so about this talk so the main goals as I say is bypass the secure boot all right in real Hardwares bfu will means before the first usage which means you have the smartphone something like that and then you just need to press the power button and this is the only thing you have you don't have the code running you don't have privileges you cannot inject anything we are assuming that we don't have any vulnerability or at least we don't know any vulnerability so we are blind so how can we approach that so the second main goal is is not only by passing the security route we need to to have the smartphone in a stable way so we want to run code with maximum privileges so it means el3 in irm",
        "and why not let's try to provide a genetic method so we are blind we can not run any code we want Maxim Privileges and on top of that we will like these method to be applied to other smartphones or other devices so why not so to start with we just pick this device under test which is the one we have in here in the in the table we have three of them one of them is already running the assembly explain a minute later on about that so this is the dragon board basically we started with a development board because we don't we didn't want to start with a super hard stuff we just started with Dragon Ball uh for DC which uses the MSM 8916 sock is the one",
        "you can see on the screen all right so as you can imagine the dragon bar is just in the Qualcomm security boot is following that that uh let's say that standard so this board comes with the security boot disabled so this could strange to you but don't worry I'll spend a minute so one thing you need to confuse is that we have two main things we have the secure Boot and we have the has verification means that if you try because I have heard about many guys working in different industry cars and so on that they are just dumping the firmware modifying us couple of bits loading the filter again and then running it and then you will get errors why because this is a cube root sometimes this is not the real reason sometimes it's because there is a hash verification so you need to at least know how this has and secure boot works at least a high level okay so this is what I'm saying here right so modifying the boots rather modifying any code in the field word will result in a fail not because the security rule but because it has at least in this board so the first thing we did was enable the secure boot right so that means that we have the keys means that we can create our own firmware and then run it in the board right but this is just for the initial steps right so the final goal is we will be blind we will have zero information about what is going there so we are not going to use anything in order to bypass the security boot later on okay",
        "so if we want to buy bicycle of this kind of devices right so first we need to know in which point because you can do it at different levels you can do in what the system is fully running you can try to glitch an application glitch the kernel gives the monitor gets whatever right so we think I will find a minute that in some cases the earlier the better so we aim to bypass during the boot process so even in that point if you are looking forward to bypass the security boot when the system is booting what your smartphone is built in and this makes sense because remember we are in the BF view before first usage mean that we have the smartphone but the smartphone is completely off so you don't know the pin you don't know the pattern you cannot attack once the kernel or the full application of the device has been unlocked so we are aim our aim is to bypass it during the boot process right so I'll explain a minute one means pbl sbl and edl maybe some of you already know but just to ensure that we are all in the same page so the primary boot rather is the first thing you will you will execute when you press the the power on in your smartphone also name or known as bootron probably you know so it is the first code to be executed in a smartphone so the second is the secondary button I'll explain that in a minute so which is in charge of what next layers next stages but there is an important mode which is edl which is emergency download mode that basically is the one that if something happens that suppose that you know you are trying to repair your smartphone and then you remove the flash or the M emmc or ufs",
        "what will happen in that case or probably you have seen a lot of people trying to reflect devices when your smartphone even doesn't bought that doesn't boot right so the idea is there is an emergency mode that in case you have your your flash or your flash partitions super damage or whatever you can always have some communication with the device this is the emergency download mode align a minute okay so this emergency download mode can be basically uh you can just connect a USB cable to your smartphone so you can just remove the flash then you you can just press the power button button and then what you will see is that the phone is on different state so from that point on you can talk via USB to that phone right even if you don't have flash so this code is inside the the pbl and this is called the emergency download mode so in that point you can actually send call same programmers and stuff to their to the smartphone and the smartphone will love this code but if this code is actually sign it so that's the challenge right so we will see in a minute this is useful when partitions are corrupted so this is what I say and the good thing is that for this board in that mode as you can expect it's running with maximum privileges means that you should be able to reflash all partitions right you should be able to do whatever you want but as you can imagine this has been only allowed to for for Qualcomm the stuff so that means that either you have an image verification you have an image with the proper signature with the proper stuff so otherwise the edl will reject that right so you can tell me whatever you want but you need to sign this kind of tab you are sending me to me so our attack I'll find a minute bypasses exactly that so let's put the the the smartphone in a strange State let's try to force an error then we'll go to the major scene download mode and then in that point we will send some code to be executed why the smartphone will try to verify that if we manage to do the glitch exactly in that point that is doing this verification then we should be able to run arbitrary code with maximum privileges right again the attack doesn't depend on flash partition so I don't care Android version I don't care about the budweather version I don't care about anything you just need to tell me which is the sock you are using your phone and this attack will be reproducible among all other devices using that so I don't care about any version about anything like that so just to to refresh you guys so we have in modern smartphone we have the secure world and we have the normal World remember in here in the normal in the in the normal worries when we are running Android and all the stuff and this is running in background let's say that so what happened is that when you press the power on button so the first thing is the the first call to be executed is the boot room you already know that we also know as a pbl primary bootloader",
        "okay so the next steps are to load the",
        "secure svl we are still in the secure world right so this code is also let's say trustworthy for us okay and from that point the next step is load the non-secure svl and also all",
        "the stuff related with trusted Sun trusted operating system trusted libraries trusted applications okay the communication the monitor all the stuff involved in the trusted Zone that you probably know so we don't care about that but just to let you know this is in the normal world and as you can see also all of this stuff is in the flash memory right and all this stuff is in the wrong so that's interesting for us because if we can manage to try to",
        "fail or produce an error or to force to enter the phone in this emergency download mode means that we are still in Rome right so that means that you will be able to somehow be in the maximum privileges in",
        "a mode that doesn't depend on the file system on the version Android on anything like that okay so that's the idea that's that's the main idea so remember when we are in edl mode so the next step is through USB you can send a programmer right but this program has to be signed by Qualcomm right and from that point this is like like a loop waiting for command so you can actually talk to this programmer you have just sent through via USB that's the main idea all right so power on for an error send a programmer wait for commands the problem is if you use a liquid Signet programming on the internet you will be very restricted about the things you can do you will not be able to down memory you will not be able to write any random memory or something like that means which that means that it's not useful for us because our main idea is let's try to run code in that place right so we can",
        "for example dump the pbl the boot room right so that will be the first step towards uh not being blind let's say that okay that's the main idea so this is exactly the point we are trying to glitch right we want to bypass this signature verification",
        "again the attack doesn't depend on the flash partitions so the first question we we did ourselves is all right so how we've worked this verification so I'll explain in a minute so this is how it looks the programmer we are sending through the USB so basically it's a regular elf with",
        "a special segment let's say that in this inspection segment you'll see that there is a hash table header a couple of hashes a signature and also a couple of certificates summarizing all these houses are to ensure that those parts aren't touched so if you change one single bit here means that this has will be different right if this is completely different this will be a mismatch or if you keep that hand the signature will fail so basically this is how the secure boot has been implemented or how the signature verification has been implemented right",
        "so if we expand this signature uh the certificate stuff we will see three certificates so the good news is that that the the bottom one is only take against the root key has there is no uh decryption plus uh let's say basically we are not verifying this root certificate as we are doing in the in those steps because here what is basically born in the in the fuses here is just a has right so basically we are getting the hash value of this certificate and then comparing it again that has that has been uh born in the fuses of the boards right so it's it looked like the similar but it is not because in that case basically uh what you want to do is you want to to decrypt and compare the hats with the verification the classical verification operation but in that case it's only just a comparison so it looks easier to try to bypass this than try to bypass the other so we have as I say multiple opportunities one is the one I just mentioned but we could also try to bypass the this step means that when uh means that you can change this and this and this try to do contain from here to to apps but at the end of the day if you do that you need to keep that or you will fail so in summarizing you will have a lot of places when you can glitch and you can bypass okay but is which one we should choose as I say it's much more or it simply simplifies the attack if you choose the first one another explain a minute why when we see the power traces okay so why this simplifies the attack why is is is is is the very is better to do that well Alex in a minute but as I said the goal is bypass the first verification so just to to refresh you about what we are talking about how we obtain the this code in order to do the reverse engineering in order to know that it's better to do this first attempt or we didn't so we don't know right so we are blind and we don't know what we are glitching right that's that's the point so and then how do you know where you should glitch if you don't have the code and you cannot expect it this is the if in here is doing the hash comparison I want to glitch in here so this is what you will find everywhere so do the glitch here we don't know we don't have the code if we have the code we don't need to do that right but we can guess a probably timing",
        "area we can guess okay more or less should be around this area so that's that's our approach also in a minute okay and how can we determine this is the area whether it's a easy trick that we find that basically we can just send two programmers",
        "one with a valid root key means that this is the original one sign it by Qualcomm which have limited capabilities is not useful for us but you can just send it right you will get a success let's say that right but if you just slightly modify the the parameter with a wrong key then this parameter will be rejected but this will leave some power traces that's the point right so in here we will see on the left a Power Trace when we are sending a valid programmer okay to the edl with a valid root key",
        "nothing happens",
        "but on the right we'll see that the same Power Trace when trying to load a programmer with a wrong key",
        "let's say that",
        "so what do we expect from here",
        "well we you can just look at this we don't know exactly where but we can say that it will be around here because otherwise we will see more Power Trace right okay we don't know where we didn't see the code we know this more or less around this area right",
        "so I'll show you this full attack overview and later on this end will give you a a more precise details about the equipment we have used and we will do a real demo about we are presenting here today so we have our computer okay we have also a USB a sniffer which is we are using the Beagle but you can use uh different stuff we have the glitch generator okay we are using this Peri Nano but this is something later on and we have a power supply we basically is powering the board okay so the first step is send a crafter programmer so it means that you get you can download the programmer from Qualcomm right you can add the code you want the one they're perfect for you with pig and pork read right whatever execute the extraction whatever you want to do and then you are going to send this programmer to the board but we'll go through the USB as nifer right until reach the board but",
        "we will detect when this program is Going Through the Wire",
        "and when we see this parameter Going Through the Wire what we're going to do is to do this glitch we will do a sort of the b d in the in the board right so basically we are going to send the programmer and trying to predict this area I showed you before and then reduce the voltage we are powering the board right if we fail we just need to try again we will cook the power and we will restore the power and we will try again okay that's the main idea so now descent is going to explain you the equipment we use and we will do the the real demo in here thank you okay so thank you very much sector um okay so as actor explained earlier uh",
        "we have the PC that's our main control uh then our fpga the one we're going to use to actually glitch the device is the cheap Whisperer Nano uh this is obviously controlled uh thanks to RPC but it's going to be triggered by our USB sniffer in this case is the the Beagle um and the way we reset the the board is",
        "thanks to relay that really is connected to the power supply of the board and with our PC what we're going to do is activate the relay cut power and then restart the the board very simple",
        "obviously our device under test is the the dragon board as we have in talking so the first step is activated security boot because it comes disabled by by default uh thankfully Qualcomm has Tools",
        "in order to to activate secure boot you can find them in the development section of their web uh it's really under the Windows 10 iot core section but there you will find a SEC tools which is the the set of tools used to activate secure boot it's in Python and there are some batch scripts so you can run it on Linux and the customization guide is the actual PDF with instructions to activate the good route in your board so with that out of the way we have to first generate our own Keys those are the keys that we are going to burn into the stock and we also have to take into account that in these devices the the",
        "serial number of them is different to",
        "that one the one that Qualcomm user expects so we have to modify several files in this case here is the the the number we have to take into account when activity is equipped because l0 are going to have some problems where while loading your own uh programmer or active Institute in general so once we have a security building activated we are going to actually touch",
        "the device why we need a way to access that uh Power rail we need a way to affect that that core and for that reason we need a clear line a career area inside that that lane for that what we're going to do is remove capacitors from that same Lane uh in order to to",
        "expose that that rail what we are going to do is remove c228 the reason why we",
        "remove this capacitor is a bit it's convoluted it's it's uh it's quite there has been a lot of research behind a lot of time but we",
        "only removing this one we managed to affect the device if you want uh if you want we can explain it later if you have any questions you can come to us and we'll explain in a little more detail later if you want so once we have that removed as you will see there in the left hand side of your screen that's more or less the the schematics of the capacitors that's with the capacitor removed and the upper part is the one connected to the APC rail",
        "as you can see that's the same capacitor we soldered a copper wire that goes straight to the cheap Whisperer and that's the one doing our glitches as we explained uh before",
        "so uh let's go to a very important step daddy that is uh trying to characterize the device try to learn uh what's the the best uh the best glitching parameters in order to affect the device properly in this case",
        "if you wins if we insert a very long pulse if we short the line uh for a very long time we will get a restart the the board is going to reboot but we do know the state of that bomb it may be it can crash or it can reboot fully uh nevertheless if we are very short with our timing uh we might not affect the device so the objective is to find a nice spot and Optimum spot in where we can affect the normal behavior of the device but do not crush it or otherwise",
        "affect the the continuity the normal activity of the board",
        "so uh we activate the security mode so we have the keys in in this in this this step is quite fairly easy we can build our our programmer we are going to see in a minute why we did to graduate this board so with the case that we activated we can load uh we can load them and we can sign sorry the programmer load that programmer in the board and we in this case we modified a function it's called funeral write firmware write is not used in the programmer well it is used but it's only invoked when you send that command via the USB so it's untouched so we can use it uh whenever we want in this case what we did was take the the normal uh programmer we put our",
        "gradation code inside one of the segments and then we resigned everything thanks to the Qualcomm provided tools",
        "this is the the actual code of the of the of the of the code that we modified there we have the modify function is firmware right in order to trigger a little bit better we had a trigger high in order to see where our Loop is happening in this case the loop is a it's a double nested Loop we want a",
        "really big area in order to try to inject glitches in there to see if we are affecting the device or not uh that big area is uh",
        "surrounded by a trigger high-end sugar low so we can see where that's happening and then we return to Strings via via",
        "USB if the value is expected we return unexpected but if something happened if the value that we are trying to compute if the value that we're expecting is not there or is different that would mean that somehow we affected the device so we are going to return a success this will be the Power Trace of the of the whole operation it's you can see it",
        "clearly here but here we will have the lowering of the trigger and here we will have the the rising of the trigger uh in this case there's the the rising Edge and there's the the other Edge so we can see clearly that this is our region so we are going to try to inject the glitch in that region taking into account these timings so what happens contribution made our lives easier in order to advance but okay okay we are going to face devices where we do not have the keys we will we will not be able to cartwrite the device because we don't have the case the the all this uh talk or all these or main objective is to approach a device uh without the keys",
        "characterization is still doable it will depend on the device and the different uh triggers and the characteristics of",
        "device but it's still doable in this case we took this approach in order to better explain what we did and how we did it and to help us know the best parameters parameters sorry in for this device but now that we know the best solution parameters and we it's time to focus on the real stuff",
        "in this case and as we explained we do not have the keys of the device we would not up against the device uh so we cannot run this gravitational step but we can um we have the we can have the best parameters and we can modify a programmer as we did in order to load and run all the attack so",
        "in this case our main goal is to glitch the edl when a sector explained when",
        "it's verifying this this root certificate so we have a couple steps first is getting timing right as we as actors playing uh we already see where the program is is Going Through the Wire so we can trigger on that but we also know more or less where the root key hash verification is happening so we have a very clear uh a very clear window on where to start applying your glitches so as we have seen we already more or less know where that's happening if we take into account that we can see what's happening through their USB wire we can set uh clearly defined glitching area",
        "uh so there we go to the next step of our of our bypassing attempts in this",
        "case we are modifying this programmer uh this is the same function that we modified earlier in this case uh we are we just want to see if we are able to run code so we are just trying to print via USB uh uh a simple string in this case server intelligence 2022 we are executing code",
        "so the main idea as we explain is to generate a new keys in this key in this case these keys are different to the ones that are burned into the device they they will make the device reject our programmer but that's why we are trying to pass in this case if we put everything together we know we thanks to the calculation step we will know the best parameter to glitch we also know the best timing window in order to apply your glitches and we have our modify programmer so it's time to to start glitching",
        "both advantages and some challenges",
        "the way the USB start works on the device we still don't know that because it's a black box so we have uh Jitter in there we don't know what what",
        "we don't know what the timings of the of that process of the of this packet so uh or time anchors are not precise and furthermore we also",
        "not every glitch injected will be a success so there's a little bit of Randomness to it so we have to try uh several times in order to first uh achieve a success",
        "but in this case we can apply a generator methodology to you to the to the devices once we know uh the these parameters and in this case we will not have uh the need to reverse engineer to",
        "try to find a code or leaks in uh for our devices because we can do this via power choices or inferring some information as we said so if you remember correctly from the first slides this will be two of our main objectives um and we are going to see if we manage them successfully",
        "here is the results of our experiments",
        "in this case we left this run uh 125 times in 15 hours and the average time that we achieved to bypass the",
        "secure boot is 7.25 minutes we have a",
        "couple of layers in fact we had some serious ones or some 90 minutes with a success some 50 something minutes without success but generally the the",
        "windows I mean window that we're expecting is between a minute and maybe 10 or 10 or 15 minutes",
        "here we have a another plot that will help you see where the average time is is is is is located so now we are going to try to see I'm here in the relay uh uh still triggering so maybe it's possible that we do not have a success which is weird because uh thankfully thankfully we have a video and you will see that in this video uh the success is achieved quite rapidly in this case we are going to check but yeah this is still running so we are going to cancel this well in fact we are going to try and keep it running and see if eventually we get something but basically the the demo of the video is the the same as we explained we run our our script our script uh keeps uh running these these this Loop it's a bit",
        "it's it's not the best quality but it it works I hope you can see this so here we see it's it's it's running the video is barely two minutes long so we are going to advance this uh it's running running running running and there sorry we get a uh one of our successes we will you will see that uh in the screen in a minute after success time 1.5 minutes it's 1.6 sorry minutes",
        "it's quite nice it's a very nice timing so we can know that the pros the program is loaded we can start sending uh other commands in this case our modify command is firmware firmware right as we mentioned and If eventually we can see how uh in here how we let me move the camera because we are executing code with that string that we mentioned earlier",
        "so actor if you want to we have to conclude uh by basically the conclusion we have one minute time so uh we're really think that both technologies have powerful technique so uh this technique",
        "that we have presented today is not the glitching itself is a combination of stuff it's like an approach a technique a methodology so in this methodology we do not require the pvl we don't need to know the ROM we just need to send a parameter with babalita root key so we will see those differences so we we will get the probably area so we don't need to know how security is implemented we need to know the design right because you I I showed you the the verification stuff but I didn't look at the code right I don't I didn't I don't know today if there is if condition I don't know maybe the first certificate is I don't know I have no idea how the implementation has been done I just need to know high level the Qualcomm documentation about okay there is an L file this is this verification super high level I don't need to to have the code right so we successfully bypassed the secure route of this Dragon board right so basically as as uh be Sensei we just modify a Qualcomm signing programmer and we just resign it with our keys and then sign it to the board and eventually we will get success uh on average 7.25 minutes which is a very nice approach we were happy when less than one hour we are happy usually so seven minutes is super nice so the important stuff as we also created a more advanced uh is not just a string we also create a software a pbl able to read and write memory so we dumped the pbl the boot ROM so this is a mechanism to basically dump boot ROMs so you can use this approach if you want to to the the boot rooms so we compared the pvl right with the previous one when the security boot was not enabled and they were exactly the same this is proving us that the the attack is not only successful but the board is stable enough to operate normally right so with the boond ROM so we are not blind anymore which was one of one of the goals so silver vulnerability is the next step so now that you have the wood room you can now apply all your technical fasting your everyday stuff you have in order to go beyond that and then probably next time you don't need to do this you don't need to exploit boot ROM with universal vulnerabilities but when you are blindfully blind this is an approach you can actually use and that's all if you have any questions we have one minute",
        "thank you",
        "[Music]"
    ],
    "y_me6tPt_xw": [
        "foreign",
        "and today I'm going to show you how I managed to turn edrs into malicious wipers using zero day vulnerabilities I named This research Aikido and I'll soon explain exactly why",
        "so as I mentioned this is me I'm a security researcher in safe bridge I'm 23 years old and I've been in the cyber security industry for around five years now I've started my way in the IDF I've done a lot of Linux and embedded research along with some Android research as well and for the last two years I've been experiencing a lot of Windows internal internals research in saybridge and I really really enjoy it so far but what are we going to talk about today so I I will start with presenting you my initial thought when I started this research my initial research goal then we'll talk a bit about wipers in general we'll see what they are how do they work and what they're used for then we'll Deep dive into the technical aspects of the research process itself and see how I managed to find zero day vulnerabilities that allowed me to create the Next Generation Aikido wiper so as I just mentioned my initial research goal was to create some sort of a Next Generation wiper but in order to do that I first needed to understand exactly how wipers work nowadays",
        "so let's talk a bit about wipers in general and the first need the first thing that I did of course when I started this is that I went to Wikipedia to see what's the actual definition of a wiper and when I looked up in Wikipedia I saw that according to Wikipedia a wiper is a device used to remove rains no ice worship fluid water or the breeze from a vehicle's front window but that is not the wiper that we're going to talk about today",
        "um and we're going to talk about the wiper malware and according to Wikipedia again in computer security a wiper is a class of malware intended to erase the hard drive of the computer it infects maliciously deleting data and programs now I'm sure that's no surprise to any of you if you came here but I just wanted to make this clear",
        "um but what are wipers why are wipers even used so there are mainly used for some kind of offensive acts um so let's say a war and a very good example for a war that we currently see is the war between Russia and Ukraine",
        "um so in detachments I added here we can see that both Russia and Ukraine were attacked by wipers recently and we can also see that both Iran and Israel were attacked by wipers and so basically everything that we hear on the news between um about rivalry between countries is also expressed in the cyber warfare but let's start talking about the technical aspects of how wipers nowaday works so I know that many of you probably want you hear the word wiper you also think about the word deletion but there is actually a crucial difference between the two",
        "um so let's take a look at the default deletion process in Windows to understand that let's say that the certain process calls the delete file API function for a certain file then this function asks the kernel to delete that file and then the kernel goes to a certain place that is called the mft which stands for the master file table in the NTFS file system and there the kernel just marks a certain entry as free now this entry is just a pointer to do to the actual file content and so the actual file content is not really being erased so that is the difference between a wipe and a deletion when we wipe something it means that we also really make it not restorable and we actually erase the file content",
        "now a deletion can be escalated to a wipe",
        "and that is because once um mft entries are marked as free then they may be reused again so when we create a new file it can potentially receive the free MFD entry",
        "and then we when we write that file then the new content that we write overrides basically the content which was left on the disk after the file was deleted",
        "but when I try to understand how do wipers nowadays overcome this gap between deletion and wipe I saw that most that a lot of them do not actually delete files instead they",
        "just go ahead and straight",
        "um override the files that they want to wipe by that they make sure that the actual file content is being erased and",
        "and replace and by that white and unrestorable and we can see that really we um we know a lot of wipers a lot of famous wipers some from the very recent years that are using this technique um and so that's something that now exists out there in the wild and of course this technique requires admin privileges because when a wiper",
        "runs it probably wants to wipe some files that an unprivileged user cannot",
        "access such as file in the default libraries of the administrator or system files and so on another technique that we see in the wild in a lot of wipers is the drive destruction technique this technique basically means that the wiper writes to the physical hard drive",
        "um and by that it can override the MBR it can override",
        "structures that belong to the NTFS file system or file contents and we can also see again that a lot of famous wipers are using this technique and again wipers from the very recent years and this um and this technique also of course requires admin privileges",
        "because no unprivileged user should be able to ruin the disk in such a way",
        "but I do want you to um to notice something something important that I noticed after I got to know these",
        "techniques or any other technique that the wiper uses and that is that each of these techniques are obviously initiated by",
        "the process of the wiper itself so that means that if for example we have a certain wiper that uses the file override technique then we can just open up proc1 and we'll see that there is a process that opens and writes to a lot of files",
        "now this um got me thinking and I thought to myself what if just what if I could create some sort of a Next Generation wiper that would be able to",
        "wipe all of these files without calling these obvious API calls and what if this very same wiper would also be able to do all that as a non-privileged user",
        "um this got me thinking about Aikido",
        "Aikido is a martial art that specializes in using the power of the opponents against them but why is that even relevant for this stock it's relevant because edrs have a very special superpower and this superpower is the ability to delete any file on the system no matter the Privileges required to delete that file and edrs must have this ability because potentially any file on the system can be malicious",
        "but before we understand how exactly we're going to aikido idios and antiviruses into deleting Target files",
        "for an unprivileged user we first must understand when do edrs even choose to",
        "delete or quarantine a certain file so on on most edrs that I researched I saw that of course it depends on the configuration but the most default configuration that I saw was that edors choose to delete surely",
        "malicious files that they detect automatically so some edrs detect these files when they are open sometimes sometimes some idiots",
        "detect on these files when they are closed after they were reading to and mostly most cdrs suggest an option for a scan whether it's a custom scan or just a general system scan",
        "so with that said we can start thinking about how we're going to aikido ddrs to delete our own Target files and a very crucial thing to understand at that point is that even as an unprivileged user we still have a certain amount of control over the EDR and that is because as an unprivileged user we are able to create a malicious file and so we are triggering the EDR to delete that file and all that we are left with at this point is that we somehow still need to trigger the deletion for the wrong file so of course the first idea that popped up in my head was that I should just maybe write some malicious content to an innocent file and then wait for the EDR to delete it but of course this is very problematic because a lot of files that I will want to delete require privileges that as an unprivileged user I don't have and using this idea also",
        "um it seems very similar to the file",
        "override technique if we look at the API calls so I needed to think of another idea and the second idea was um that I should probably just somehow Point DDR towards a different path to delete while it still thinks that it deletes the original path these vulnerabilities are usually achieved using links and in the service security industry we are familiar with a lot of Link vulnerabilities that is not something new and this category is called cwe 59",
        "and we know so much vulnerabilities of that type that Microsoft has realized that they of course need to have a special user right for creating a symbolic link and that userite is called the create symbolic links user right and the only users that get this permission by default are administrators",
        "but what was surprising for me is that",
        "if we'll think about the difference between a junction point which is another type of link that we can create on the NTFS file system then there is actually no difference at all in a high level perspective between a junction point and a local directory signaling so I realized that if I want to do something as an unprivileged user I should probably use Junctions",
        "but even knowing that I'm going to use Junction ice Junctions I still needed to understand when exactly is my window of opportunity to use them and exactly how am I going to use them and two very uh important events to understand in the process of malicious file deletion by the edrs are the time in which the file is being detected as malicious and the file in which the fa in and the time in which the file is really being deleted so if maybe I will be able to to do something with the junction between these two events I will maybe be able to point the EDR or the antivirus towards a different path this kind of vulnerabilities are usually called talk to vulnerabilities which stands for time of check and time of use or in this case something more suitable would be time of check and time of deletion",
        "and here in this example we can understand how we can potentially point a privileged program using a junction Point towards a different path to the lead so let's say that we're running as an unprivileged user and we want to delete the andis.sys file",
        "this file is a driver in the operating system and it's contained inside C Windows system 32 drivers",
        "so if we can create a specially crafted",
        "path which is very very similar to the path that we want to delete just with one main difference that is that",
        "um that temp directory that you see there and we created it as an unprivileged user so it's under our control and we just created an end this file in the deepest folder which is drivers so if we can potentially cause a privileged program in our case it's the EDR or the antivirus to try and delete this path",
        "but then just right before the deletion we can delete everything from the temp directory make it to be a junction towards the C drive then the same path that the EDR is trying to delete actually leads to the original and the status file so that is exactly what I try to do I knew that mini cats is a file that the EDR wants to delete",
        "and so I created mini cats in the path c-temp Windows system 32 drivers and distances then right after the creation I um I",
        "deleted the file with the temp directory created The Junction instead and waited for the EDR to delete my target file but that did not work and I had a few failed attempts with this um with this method and the two primary behaviors that I saw were that some edrs just had a very good grip on the file once I created it and I was not able to delete the file and so I all I was also not able to delete the temp directory and make it to be a junction and the other behavior that I saw was that some ideas just gave up on the deletion once I deleted the malicious file because they understood that there is no longer a threat so at that point I understood that it's probably somehow need to change a bit my window of opportunity or expend it somehow and what I thought about was that I maybe should force the edrs and and the antiviruses to",
        "be forced to be to do a reboot",
        "now as you probably know when we create or open a file on Windows we need to give to give the file sharing mode so all I did was just to create the miniket file without the file sharing",
        "mode Flags while still keeping the file open and then the EDR started to pop up messages that tell me that that I need to reboot my computer in order to fully remediate the thread so let's see how they do that some edrs use the default Windows API",
        "for postponing a deletion some other and a good example for a meteor that does it is Sentinel one and some other edrs just implement this feature by their own so that means that they keep a list of the paths to delete after the reboot somewhere and then after the reboot they just delete these files but if we'll um talk about the windows API for",
        "um do for postponing deletion of a file to after the next reboot which is done via calling the move file ex function with the flag move file the land till reboot and by the way this flag requires administrator privileges",
        "it will it requires these privileges because when you call this function with this flag then this function goes to a certain registry value that is called the pending file random operations",
        "in this value it just adds a certain path to delete after the reboot and then Windows automatically when it boots after the reboot it deletes all the paths that are contained inside of this registry value but the most surprising thing that I saw in this feature when I try to combine it with the previous method that we talked about is this is that pending far random operations blindly follows Junctions",
        "and so do other self-implementations of edrs and antiviruses so overall this has led me to create one complete process that I could delete almost any file that I want on the system um and this process was um was created after I combined the um the method that I talked about earlier with creating the junction between these two events and forcing a reboot so overall if we'll take a look at the previous example with the ndis.sys file in order to achieve a deletion of the original and this.sys file what we need to do is to create the path c-temp Windows system 32 drivers",
        "and distances then hold the handle to the end this.sys file that we that we created and force the EDR to postpone the deletion to after the next reboot then when the EDR gave up we can delete on the ctemp directory with the mimicus file inside and instead create the junction towards the C drive reboot the computer and the end this.s file will be gone by that we've achieved our two what-ifs in the beginning and any edge cases that you come up with um and after noticing that will be answered in the rest of the talk so overall this has led me to find four different zero days and six different vulnerable products",
        "the products are Microsoft Defender Defender for endpoint sentinel1 EDR Trend Mark Trend Micro Optics one avast antivirus and AVG Antivirus",
        "now if we'll take a look at Gardner's graph on the right for the endpoint protector protection Platforms in 2021",
        "we'll see that actually three out of the five vendors that I just listed are are high up in the leader Square so that's also huge",
        "and these are the cve so um so far I got um three cves 46 vulnerable products Microsoft said that the um Defender",
        "products are using the same engine so it's the same code which is vulnerable that is true for avas and AVG as well they have a mutual vendor which which is Gen and um Sentinel one did um send me um a fixed version to test but I was currently unable to get a response for them from them about the cve number or the fixed version",
        "and I do need to give a little disclaimer about the Windows Defender vulnerabilities and that is that",
        "um I was not able to do arbitrary file deletion against Windows Defender or Defender for endpoint but I was able to achieve arbitrary directory deletion and as we know a wiper does not really care about deleting a few extra files on the way so that was not a major issue for my wiper",
        "and now to the first ever demo presented in public with this vulnerability against the Windows Defender antivirus this demo includes an attempt",
        "of deletion of all the drivers from the drivers directory running as an unprivileged user we will not see the wiper running yet but we will have another demo with the demonstrate with the demonstration of the wiper itself so let's take a look so here we can see all the drivers in the driver's directory they just exist there",
        "now we can see there I'm running as a user called Limited",
        "and limited belongs to the regular unprivileged users group",
        "now we create we are creating this specially crafted path temp window system 32. and inside we're creating a",
        "malicious file named drivers",
        "and we we are keeping the handle to it open now we're asking from Windows Defender to scan that path just to rush the process and then remove the file Windows Defender tries to delete that file and soon it will give up you can see it gave up and now we're safe to close the handle",
        "um delete the team the temp directory and instead create the junction",
        "now we can reboot the computer and let's see what happens",
        "so we can see that most of the drivers are gone because Windows Defender iterated through all the drivers until it encountered a driver which was probably open and it could not be deleted and so it stopped at that point and on the next reboot we can see that the operating system is no longer bootable foreign",
        "[Applause]",
        "so this exploit is effective against",
        "um another scenario in which we want to bypass a ransomware protection feature which is called the controlled folder axis basically this feature prevents untrusted processes from modifying or deleting any file that is contained inside one of the protected folders",
        "but if we are causing the most trusted",
        "entity on the system whether it's Windows Defender or other EDR antiviruses products to delete these",
        "files or directories then the control folder access is not going to stop them from doing that because they are the most trusted process on the system so again this exploit is relevant to bypass this feature as well overall I tested 11 different products and six of them were vulnerable so that means that more than 50 percent of the tested products were found vulnerable and not only that",
        "I was just unable to force the other products to um to postpone the deletion to after the next reboot so if you find a way to do to do that I guess they will be Pro uh they will probably be vulnerable too so I really encourage you to try and find more vulnerabilities of that kind before real attackers do",
        "and now to the actual Aikido tool we've been waiting for so I implemented it just for um Sentinel one Defender and Defender for endpoint just because they were the most consistent with the exploit and easiest to implement all age all I needed is just a POC",
        "um the wiper is able to make the system unbootable just like we saw in the previous demo the wiper is fully undetectable because",
        "again it deletes files on the system using the most trusted entity on the system which is in our case the EDR on the antivirus and the EDR or the antivirus is not going to prevent itself from deleting any file",
        "um and in order to minimize the noise of creating of the creation of a malicious file the wiper also uses a car which is a test file which is not really malicious um in order to execute the exploit and that works the same",
        "um now um as we saw the wiper um is also able to run as an unprivileged user",
        "and the wiper of course is able to wipe important data on the computer and we'll soon see a second demo as I promised you with the wiper itself running against the Sentinel one EDR with an attempt of deleting a whole administrator directory running as an unprivileged user but if you're if you remember in the beginning of the talk I mentioned that there is actually a crucial difference between a deletion and a wipe so I still needed to overcome this Gap somehow and basically what I did is just is that I just implemented a feature in the wiper that after the exploits are exploited and the reboot occurs then the wiper fills up the disk to no space with random bytes for a few times and by that the wiper makes sure that the file contents which were left on the disk are overwritten and I also try to find two popular tools online to do file recovery in order to make sure that this feature actually works so I try to run the wiper without testing um the file recovery I try to sorry test",
        "the wiper without implementing this feature and then test the file recovery tools and they were able to recover some of the files but after implementing this feature they were not able to recover any file whatsoever",
        "and I'm sure you also asked yourself but what about the quarantine directory what if the default configuration is to move the files to the quarantine directory so in this case the wiper is also able to mark the quarantine directory for deletion and the EDR is not able to quarantine the quarantine folder so",
        "it's deleted as well",
        "um and regarding the code of the repo itself I didn't write it like a buggy script so I really want you to um download it learn from it expand it find more vulnerabilities before real attackers do so I invested a bit of time in the design and undocumented all the functions so you really have my invitation to download the repo use it",
        "and again find more vulnerabilities",
        "you can have a moment to scan the QR code or take a picture of the link the repository is currently private but it will be published today after the talk",
        "so I'll just give you another moment",
        "okay",
        "so here is this second demo that I promised you with the attempt to delete a whole administrator directory running as a non-privileged user with the wipers let's take a look",
        "so here we are logged in as admin and we can see that the administrator has a lot of files in its default libraries you can say that you can see that this is really the admin and this admin user belongs to the privileged administrator group now we're switching to a user named limited again",
        "so yeah this is limited",
        "and limited belongs again to the unprivileged users group",
        "now we are running the wiper with the mode of proxy deletion with um the request of deleting all user data of the user admin",
        "now we can see that the admin directory exists in the user's directory and after running the wiper the wiper marks the quarantine and the admin directory for deletion reboots the computer exploits the right vulnerability for the EDR that is installed and then after the reboot",
        "we can see that the admin directory is missing from the users directory",
        "and the disk is starting to fill up with random bytes and just to finish I wanted to show you in task manager that the wiper really runs after the reboot so we can see that it was started silently",
        "yep",
        "Okay so",
        "to sum it all up today we learned that a wiper can be much much more dangerous if it uses the most trusted entity on the system to do its malicious actions by proxy in our case it's the EDR or the antivirus now for these thousand times having security controls does not mean that you are secure so please keep that in mind every day when you're trying to secure your organization lastly security control might also be a",
        "very preferred Target for an attacker because they have very high Privileges and very high trust level",
        "now I do have two vendors responses in here um I won't read them um I won't read them of course because they're allowed but they are in the presentation so you can later download the presentation and see the comments if this is interesting for you overall they were very cooperative and I thank them for that there were now there were no issues",
        "these are the versions that you need to update you in order to be safe um so you can see Microsoft and Avast and AVG it's a version twin micro it's a patch and Sentinel one did send me a fixed version to test but I was still unable to get a response from them regarding the specific number of the fixed version",
        "I want to thank shmuelcoin which is a team member of mine for the assistance with testing my different exploits against um other edrs",
        "and basically this is it we can move on to the Q a session so you have two microphones you can use if somebody would like to ask questions",
        "so this is it no questions okay so we're done",
        "[Applause]",
        "[Music]",
        "[Music]"
    ],
    "4HmCPmJ4_Bk": [
        "foreign",
        "oh there's a lot of people here seeing people still I'm covered in everything but welcome everyone this is going to be my presentation on the social engineering pen testing and the aftermath of it and if we are being ethically responsible",
        "just let everyone have a seat first yeah thank you awesome so I will first start telling who I am you can call me Bridget that's the easy version of my name since I'm the region mine the rich name well it's not easy so I work as a red team Analyst at Orange cyber defense in Norway where I specialize in social engineering and Olson I've been working in it since 2007.",
        "which feels like a really long time now my main topic of course is social engineering and I started having an interest in Social Engineering when I attended a CTF assaulted neuron CTF at",
        "Temple in University in 2020.",
        "so yeah here I am today basically",
        "now you all guys had some coffee so you probably probably won't fall asleep today I'm hoping uh but this is just a short outline of what we're going through today we're going to start with a bit of a short social engineering history just to catch up and then I'm gonna go through some stories from real life experiences of social engineering pen testing and others and then we're going to talk a bit about the human psyche in relation to social engineering pen testing and then we will also look at what can happens if we don't deal with the aftermath correctly",
        "so for quick speed run into history",
        "Dawn Of Human Society we have been social engineering basically because we all want to connect with others and we all want to be part of a society and therefore we try to we try to end up",
        "sorry we try to obtain what we need for",
        "survival purposes so we'll start talking to people and we will try to get what we want and the prime example of who's good at Social Engineering is probably our children for sure at least minus um so until I don't know at the end of the last century people started to use this in relation to information technology people are starting to get these messages the I love you virus and the Melissa virus where people will learn into opening attachments and emails and ever since then it has just escalated and about a decade later in the 2010-ish people started to commercialize testing using social engineering techniques and the pen test companies using that and I guess that's why I have a job today so this is just a short short history speed run here just to keep everyone in the loop so I'm going to go right through it and the next slide is going to be a little cluttered it's going to show you a lot of Twitter messages",
        "these are messages where people have been social engineering fan testing but definitely been using the wrong bait as you can see here people react quite emotionally when you for instance try to learn them by saying hey you got a gift card if you just press this link you can obtain it now or as you can say see here it is all about how you can you get clicked on it and then you can see that oh I'm not clicking any more links people get distrustful people say that yeah I'm not going to do the mandatory training afterwards and so what so it can generate some serious emotions in people when people are being tested and everyone probably knows to go daddy down there where people were being tested by saying they got a Christmas bonus and unfortunately it was a fish so it can create a lot of emotions in people",
        "also show you that this just doesn't happen ever this happens everywhere it also happens closer to home for me this is from my job so oral cyber defense they hired someone to do internal testing and while this seemed like the perfect pretext like hey your vacation has been denied you've got to click here this person he was he had just been working on a project and he had been working day and night for a long long time and he just applied for his vacation and then he got this email seemingly from Orange cyber defense as well and he was so stressed like oh I'm not going to get my vacation I need it I so desperately need it so we clicked the link and I mean this is a this is a person working in the field of security and he still clicked this link and then he went in for a roller coaster of emotions like hey I was duped into clicking this link",
        "but it seemed real and I was supposed to have vacation so this didn't do anything for him what did he learn from getting this definitely nothing he he just got really agitated and I saw this in the internal Channel and I just had to bring this with",
        "so all I felt was that someone did something wrong to him",
        "we'll continue on telling you a lot about some stories from the big world as well because this happens everywhere the first story I'm going to tell you I'm still not used to this screen sorry the first story I'm going to tell you is actually UK based it's a story of when an Australian radio show called up the hospital that Kate Middleton was in and they're called and they tried to get information and lured away to to get to get in saying that there were family members and that they needed some information now they played this on the radio show in Australia on how they got information and it all ended up with a nurse committing suicide a week later because what happened was that they they didn't focus on the victim itself they all they focused on was their goal and how fun it was and yeah everything else the person who was deep was not in focus and of course you can say that yes she might have killed herself because her mental health was bad but they were the ones pushing her over the edge at the moment and that's also why it's so important to think of the aftermath now this just doesn't happen on radio shows it also happens in in the industry so the second story is that there was this pen tester that I've heard of who was going to test a company and he was looking for ocean information and he found this ID card",
        "of one of the employees it was together with a post of a guy who had recently lost his father and he it was like finally I landed a job of my dreams my father would have been so proud of me and he had to write this in the report because he used that ID card to create a fake one and used it in the social engineering pen test",
        "and the person got fired afterwards there was no more dream job from him for him at all so I mean we had he the princess we had the best of intentions he was doing his job and then all of a sudden he knows that this guy where this was his dream job got fired because of the report he did and also as a third story this is just to show that this happens everywhere to round it up a bit so the last one I'm going to tell you is a story that a friend of mine Tinker told me he said that during one of his pen tests he tested retail companies in a country and he tested them by going in with a co-worker saying that hey we need to update the system and three out of the four places they let him in let them into the machines and just do whatever and the first place there were there was this guy was like no we need approval we need approval from HQ you cannot go in here and do this and they couldn't get in so they were like okay they didn't fail so Tinker was like hey told him about the test because he wanted a name for the report you know to give him some kudos to say that hey he actually did the right thing and this was during the it's around this time so it was almost Christmas people were stressed out and he told him that hey this was a test we're not here to update the retail system and he was like so you were standing here lying to me I needed that update so he actually got quite mad so even though he didn't fail the test it still created some serious emotions in that guy so this is just to show that all of the things we're doing when we're in Social Engineering pen testing when we are sending out phishing emails when we're doing physical testing they can create adverse reactions in people I would never know how they will respond",
        "now to look at why it is like this you can see that the blame game is very common like everyone will be like hey it was you no it was you and that is a protective human response because in Psychology it has been heavily discussed when it comes to scamming that because being fooled like this during a social engineering test has quite a simple mental response as when a person is scammed so it's just the same as when someone is trying to get your money basically so when people are feeling duped I love that word duped it is this unpleasant feeling of being taken advantage of and how to respond to that depends on the individual how they respond I mean some people they are more prone to getting into that self-plane like oh what did I do wrong now I should have done this I should have done that and they blame themselves while others are hey this was your fault you you didn't do this and so on so people would just start pointing fingers either at themselves or others which I mean others people will be like oh this was fun whatever you never know which person you're gonna meet so if people start blaming each other you're kind of not learning anything from it so basically",
        "it is possible that if you look at all the three stories that I just presented you can probably put yourself in their shoes and think oh I will respond like that as well or I don't see why they did that that's just a weird reaction so the main thing is that we are all different and we all respond differently",
        "and when we do this thing we do the whole testing and we don't know how humans respond the testers has to write this in a report",
        "and this these reports they can still affect the individuals themselves they can reveal the victims names and intentionally this should stay Anonymous but still we can reveal them because someone recognizes them and then they still get the blame and there are also situations where the need to reveal the victims which again can be really it can be hard for the tester to do but sometimes it has to be done so the consequence of this can actually be that when you reveal like for instance that the the the the ones cleaning the cleaning the location we're holding the door all of a sudden they don't get a contractor renewal which is",
        "well I don't want that on my conscious at least as a tester there can be employees losing their jobs or you can just start a whole bunch of blame games where people are just blaming each other saying that oh this wasn't this was your fault and then no one is there is one really important thing and I really need to see this that none of these scenarios results in a good learning experience if you start blaming each other no one will",
        "have the possibility of evolving their security culture",
        "now before I dive into how to try and deal with human response to the aftermath it is important to look at the fact that someone being duped in a social engineering pen test is really high so there's always be someone you have to deal with that and ends up falling for it my former Professor Dr Franco metal he told me the story of a conference where the attendees were tested prior to the event and this mail was sent out to all the attendees of the ISA conference in 2011. where Security Experts were the main clientele so this mail was sent all the first authors of papers and it actually resulted in 66 clicking the link",
        "and this was Security Professionals so if they if 66 of those can fall for it then think about everyone else who's not educated in security meaning that everyone can fall for a",
        "social engineering attack making it even more important to know how we should actually deal with the people involved because there will always be someone that has either clicked that link or open that door or yeah just giving away something that they shouldn't",
        "so Tinky told me this during one of the shots and I thought it was so important I actually had to have a whole slide for it one individual failing assault engineering test is not an Indica indication of an individual's failure it is the indication of a systemic failure if one individual fails everyone else can fail as well and that's really important because as humans we are trusting anthropologically speaking we are meant to be together in packs and this makes all of us strive for connection we all want to have this connection with other people so everyone is prone to fail the social engineering test we really want to talk to people we want to connect and when people really want information from you they can get it but a society where we all try to mitigate social engineering fantastic by not talking to people not trusting people it's just not feasible I mean it would be a really cold world to live in if no one were to trust each other so it's definitely important to have systems surrounding the people controls that will help and avoid people",
        "falling for a soldier Union pen test because as Tinker said it is the indication of a systemic failure it is not the individual's failure that means that we need to have controls around the human element to protect them from being duped that way we need to do something to help them to not be lured into this trap",
        "because everyone can fail I can fail as well even though I do social engineering for a living I can still fail anyone that can probably come up to me and get information from me if they want do not try that please",
        "it's not a contest remember that all of a sudden I get a lot of information out there sorry",
        "yeah so it is so important to see that we need to know how we should treat the people because the people there will always be someone being duped and most of us will once once or twice in our life anyways",
        "that's why as as Joe gray has said in his book debriefing is an important aspect of the social engineering pen test as well as keeping the victims Anonymous of course to the most possible extent",
        "uh so debriefing a company",
        "on is is a part is an important part of the process because you have to yeah sorry I just need to take some water",
        "and say that hey this is how it happened you you need to see that okay this is how it happened this is how you should be doing it but some people might have different needs for information in the aftermath some people has been has been lured as a victim might need to have a more direct approach they might need to talk to the pen tester they might need to have a communication with the HR to talk about it to walk through the process so we need to cater for that you need to cater for that everyone might need either a general debriefing or even",
        "individual ones yeah so what I experienced during a physical engagement last year was that I was testing a company I went in there I was in there for about four hours and I was talking to people and it was really it was really intense I mean I was there they trusted me",
        "in the aftermath the fantasy the the company that I was pen testing they didn't they didn't have any adverse reaction to it they didn't punish anyone and they were taking care of them making them having the ability to talk to them and so on but I still didn't feel like I was done I mean this has been a person that I've been together for a long extent of my day so luckily as part of my research in the draftsmouth I got to talk to these people that have been fantastic and when I did I discovered that one of them were like oh yeah it was cool whatever you know it was I'm done with it and everything and that was nice and the second one she was she said to me that yeah I'm I'm really strong mentally so I don't blame myself for anything she felt like oh yeah it happened you know but she also said to me yeah at first I thought about it every day for the first week I thought about what I did how I did what you did and then it recurred next week and then still had happened over over the last six months it had happened on a monthly basis that she kept on going back to it thinking about it and just not getting over with it so we talked and then after we had talked she said that I feel like I finally got closer like now I'm done with it because we talked through it we talked through what I did and how I did it and what she felt and it was a really nice experience for me as well as a tester because I was also done with it after that and it's just so important that she felt like she had closure I mean she was a mentally strong person she didn't blame herself or anything and that makes me wonder about what about those people who are not what about those people who's had a really bad day and had a bad month or a year and then this happens and they start blaming themselves some people are more prone to blame themselves as well and how do we deal with that so sometimes a direct debrief with a person has been",
        "duped in a way especially directly for instance a person has been called and talked to someone or someone else met them physically that maybe they need a direct debris for the parties involved",
        "so what I was thinking about when I was talking with this person was that",
        "I might have played a bit too much of the Sims is there on the Sims players there what's on yay I'm not alone probably everyone's too afraid to raise their hand or haven't played it but yeah so basically in The Sims we have this we have this bar this friendship bar where people are talking to each other and then they get this it goes to Green when you build rapport so when a pen test to build a rapport you get a degree in like really really fast and then when you go and then figure out that hey they were being tested that bar drops like all the way down I mean you usually start at zero depending on",
        "yeah you just started zero and then you go up but then you go down and I don't know about you guys but if you ever had a friend who ended up having this good relationship with and then all of a sudden you're not friends anymore and you guys have kind of things that you made you end up on this red level like you you have unfinished business basically and you feel like you've trusted that person you have given of yourself and believe me after a couple of hours you do share a lot of things and if you then realize that that person you shared it with is not your friend it's not one you thought it was you will still feel that even a couple of years later you can still feel that I mean if you have a friend who you have you're not friends with anymore and",
        "you will still think about them you will still occur to you that oh I need to uh what happened how did this happen what can I do to change it so now this test that I did with this woman was a very direct test but I still think that when you're doing a test and you get to this level that you actually get a lot of you build rapport and you share stuff as human beings do that sometimes it is often the best to actually end up having that relationship bar reset to zero and that's what for me and this woman did after the debrief that we felt like we had closure we felt like we reset that level I was no longer just a scammer the evil one because I went back to being the acquaintance that she had originally because I had I had",
        "uh sorry her Trust was trusted me was",
        "gone because oh she was just duping me it's not good basically so I believe that it helps to actually do a debrief with people who had had a very extensive test to get the relationship power reset to zero",
        "halted",
        "horses and she said to me that conducting a social social engineering dentist for a company should not be up to the eye to Security Department only or a single individual it should involve a great Network that may consist of the HR and other Personnel that can support and watch the mental status of the employees affected and there should be measures in place that the company can take care of the emotional status and reactions of the ones who are falling victim to a test and as well as clear guidelines on how to to follow up to humans after the test and I think this is really important because HR is an asset to a company and when performing a test on the human element it is wise for the company to internally consult them so that so that they can make a follow-up plan on how to deal with them",
        "so another important aspect when it comes to meeting those falling for real-life social engineering attack attack is security culture",
        "there's been a lot of talks about security culture and the importance of building a good one within the companies so unfortunately we can see that the companies they react in the aftermath of an attack and not proactively often but so people try to to do awareness training they try to test so they test people for social",
        "engineering attacks by doing phishing exercises and so on but it has been documented that for the first 45 days",
        "people are very Vigilant they don't open anything and then after 60 days they're back to their old habits like they're forgotten it and what happens then is that oh yeah we need to do we need to do testing regularly we need to do exercises regularly and so on but if the if the tests are like the one test that I showed you from internally and or in cyber defense where you get tested and it is distressing to the humans it is just annoying and people who work at a company Who does these kind of tests will just get annoyed basically and and so therefore they can have this adverse response to the testing making it works against what its intention is",
        "so building security culture is",
        "important when it comes to not only mitigating the risk of the company falling for falling for a sources nearing attack in the I.T domain but also lessening the impact when it occurs because when a human being is being tested and they for instance get oh yeah you were tested you got this fish now we got mandatory security awareness training how many here would like having mandatory security awareness training",
        "yeah yeah of",
        "yeah yeah well not always probably but some people will feel like oh I was being punished punishment is never good for security culture because what will happen is that when you punish a person during a test saying that hey now you get to get security training because you push that link or or as I heard worst case was three strikes in your out policy for showing three times during a test and you're out that's kind of a scary I would never touch a link ever again to be honest but so when you do that and you punish them what will happen when a social engineering attack actually occurs will they tell you probably not",
        "and then the company will have an undetected one ability",
        "which in turn is not good for security culture I mean when people are afraid to report what has happened it is not good for the company so people need to be safe enough to feel like they can report when it happens and that can only happen if we actually don't respond by punishing people when they fall for a test because as I said earlier everyone can fall for it so it's just a matter of time and you need to think of the controls that you're implementing surrounding the people so ending up to blaming each individual",
        "is probably not the correct approach but",
        "that's the sound badly what happens if you start punishing them I mean if you start punishing them and they can feel bad they can feel like they are being punished what can happen I mean if you do a test it can happen like the GoDaddy test where it ends up in the media and you get really bad public response which is not good for you to the pen testing company or the company doing the test you can have a you can have employees being disgruntled you can have employees quitting so it can it can affect so much more than just just single individual it can affect the company as a whole so and as a pen system myself which I can also speak for is that if a test goes wrong if I can see that oh they handle their employees bad I would feel really really unprofessional myself because then I've done a test and it has affected another person in a bad way or I can see that they're not I mean I can only give them the data but if they use that data to punish people it doesn't feel it",
        "doesn't feel good for me and it feels like my professional credibility has taken a major blow",
        "so where does the responsibility lie for taking care of the people involved is it the ones requesting the test the pen testers the HR department",
        "I would think that it's all a collaborative effort between everyone everyone needs to come together and say hey we should do this we should make this we should ensure Good Grounds for a",
        "learning experience it shouldn't just be about the wins it should be about how do we actually use this data and how should we actually treat the people so processes should be made so that 10 testers can feel that the job they're doing is responsible and that they truly make taking on the right hat another gray hat when doing this test and the pen testing company should have a clear vision of how the people should be treated and guide and guided customer in this I mean they should guide them and say that hey you shouldn't be you shouldn't end up firing them by the way so everyone loses if the aftermath is",
        "handled badly basically so I think that this topic needs for discussion in the community because everyone can feel bad if a test goes sorry and what we don't want to end up with is a bunch of people having done a test and everyone's just mad and no one learns from it",
        "the three key takeaways I have here it was really hard figuring out what I was going to say here so the first one is the search engineering pen test planning should be a collaborative effort in the company as I was just saying that if you're doing a test everyone should be involved you should think about okay how do we deal with the people what should we do with the test results how can we create a good learning experience for everyone and as a pen testing company if you see that the that the company you're going to test will not take care of their employees in the aftermath if they're not going to use this data correctly they should actually just say no to the test because if they say yes and they put a pen test on it that pen tester also has to deal with a professional aftermath of this as well as well as the victims of the test we'll have to deal with it and the mentally",
        "so number two is that punishment does not encourage learning you will not get a good security culture if you punish people for failing a test you'll be rather make them so scared that they will not report you when it actually happens in real life and number three people can feel bad afterwards you have to treat them well I often think that when you when you have your employees you should treat your employees as you want to be treated yourself and that's hopefully with respect and that you're being met on your emotions",
        "and what I think that we can all learn from what my teeth what my six-year-old daughter's teacher said to her was that when she started school they said that oh yeah hey you failed like you you wrote something wrong you wrote the letter a backwards and whatnot he came over to her and said so good that you failed now we have the ability to learn so encouraging encourage a good and open work culture where failure is just being human is a good thing we are not robots",
        "now this was just a little overview I",
        "could probably discuss this topic for hours and probably more in the dialogue experience I just want to show you that this is my reference Wall of Fame there's probably much more because we're all standing on the shoulders of giants and I had the pleasure of talking to several people about this and so thank you to all the lovely people mentioned here and all the others I didn't so for me it's important that people just have an open discussion about this topic I'm just gonna go to the last slide here and before I start the questions I'm going to say that I'm gonna have uh the community program lead at 4 15 in business Hall theater C where I will continue the discussion further and hopefully have a dialogue with those who come there so I hope to see someone there and as I was told there is a microphone in the middle here so if people want to ask me questions they can go there and if not there's social media people can reach me on so thank you and any questions then go over there please [Applause]",
        "[Music]",
        "[Music]"
    ],
    "XHAPfJb-8zE": [
        "foreign",
        "it's great to be here thank you for invitation and thank you for stopping by",
        "our way to here was quite long it started in 2017. yeah and it was full of hard work",
        "data and screw-ups hard work again",
        "arguing with family about using my time",
        "their time and it was full of pain you",
        "know stacked stuck took a finger between the keys on the keyboard yeah and on the other hand it was full of fun and love yeah and so it's great thing yeah so our topic is strengthening cyber resiliency in the time of geopolitical Crisis applying",
        "threat intelligence and active defense to protecting critical information infrastructure and here is the first recommendation did you know that the longer and more complex name of your presentation you will use you have the better chance to get here and have a speech right so about this presentation",
        "it's all about our practical experience",
        "with reactive elements and trying to use",
        "active cyber defense elements and it's",
        "about our use and implementation",
        "another thing which is uh very important is our approach it's proactive it's about combining everything we can reactive",
        "active proactive yeah and",
        "the way we we go is use ACD elements",
        "where reactive elements fail and under reactive you can see typical alerting system yeah exposed reaction",
        "before we start I need to say something yeah everything we do and say we do with a huge respect to everybody and their",
        "intention in cyberspace and kinetic",
        "space too yeah and the same respect we expect for us we will try you the wall story from the beginning to the end not just only part and it's quite hard",
        "in 30 minutes yeah but um",
        "all there is a few information we can",
        "say you know NDA so thank you to be",
        "respectful for this",
        "let's go to the Prelude of our invitation who we are and we don't we are critical information infrastructure we built and and",
        "provisioning the cloud private Cloud for",
        "Ministry of Finance in the Czech Republic yeah and it's quite hard thing as far as",
        "Government Cloud we are prepared for offering the same services in the",
        "quality in our private cloud or with using commercial clouds for the",
        "government Cloud I mean for the critical one but we're still waiting for political decision to do it yeah and do it good we are State company but we are not army",
        "or any secret Services we would have a title to use active cyber defense yeah",
        "we just fan of actors active uh cyber",
        "defense and we like to do things",
        "different uh",
        "on the edge yeah into Gray Zone",
        "and Grayson is very important for us in to a year 2017 the George Washington",
        "University compiled the uh the document which was",
        "called in the gray Zone we take that we take that research a little bit change it a little bit enrich and as you see we can we can do the things on the left side on your left side which you can do like in uh in your organization without any problems on the",
        "right side your right side of course there are operations you should not do those are adversary takedowns around somewhere and we mean the good ransomware ransomware",
        "Rescue Mission and sanctions and other other business remedies",
        "but these",
        "this gray Zone and",
        "categories in that Gray Zone led us to our first screw-up and I have to tell that we promise to blackhead that video and use the f word that's why we have some screw-ups here yeah and it was about considering deception as the Holy Grail yeah before we started to looking at the ACD Gray Zone as a wall process",
        "and part of the process uh we told how cool we are especially when we were talking about deception and",
        "engaging the adversaries to people and they were starring at us with this disbelief I felt very very cool but it's a long time ago about week and and the",
        "by not to not to read this the new and",
        "unknown doesn't mean functional yeah we",
        "we just wanted to deploy some honey portal bigger environment and that was",
        "enough about about security for us yeah so",
        "you need a process not just this",
        "solution so",
        "the security is a broad topic yeah and",
        "as a critical information infrastructure we have implemented a lot of things based on regulation based on based on best practices you know but in this presentation we will aim to cyber threat intelligence and active cyber defense",
        "processes and elements and in addition to processes there are",
        "people and these people are we my name",
        "is Andre nickovash I am ciso and chief deception officer I have a few certificates of course especially for",
        "for swimming you know bronze swimming",
        "certificate silver yeah do you remember yes silver swimming certificate I'm",
        "white amid yeah I'm good in compliance",
        "in leading people in finishing things and I can see the world problem and solution in a sec in a second yeah I'm manager and with all its pros and my dear colleague listen up my dear colleague is Jean Paul he is a thread Hunter",
        "active cyber defense architect and",
        "practical csos advisor he is my right hand in the battlefield yeah he go deep into the technical solution and he helps me a lot yeah and there is another I'll screw up with the f word on the beginning we thought that uh we talked about the about the active cyber defense about the gray zone for a long time and we try to actually connect it with the uh with the attack framework like TTP with the counter measures from the active cyber defense we call it Matrix which was like a working name",
        "and",
        "unfortunately",
        "without that long that might try coin with the came with their own solution which then they called in 2020 they call it Shield but now it's engaged",
        "but we still believe that some of us sold it to Metro but remember the best things are free and we will show you in our presentation we're working only with the open source and free stuff yeah and how we Hustle the security Now we will open the Pandora Cube show you Miracle Magic Box",
        "anything but uh not actually yeah we go",
        "the traditional way you know Pro people processes and technology and main thing for us is the active attitude in everything we do so this presentation is",
        "about our research and its results we",
        "try to to applicate the real uh real adversary scenery to to our things we",
        "created uh we go through our Paradigm I mean our environment hypothesis",
        "our research methodologies it's about the use case close up open source Armory we use and our results and finally we will try to give you some recommendation and takeaways especially when you see a Kevin Mcallister on the screen is good recommendation not to do that this way yeah once upon a time my colleague will introduce you yeah once upon a time there was a paradigm there actually the",
        "Paradigm is our is our universe that's what we have and what we're trying to uh what we're trying to defend uh those are like Technologies like anywhere else in any other company we are not different Linux windows we have some IBM stuff too",
        "and uh it's of uh of course that's mean we are operating two data centers so it's mean also the iots but it's also the cloud views all kinds of clouds private hybrid uh public everything but also those are regulations which we are tied with and here in European Union",
        "there there in European Union you have",
        "to be tied to some regulations which is not gdpr and stuff like that",
        "and of course another another Frameworks or or directives we use a lot of Open Source some we have support for some we do like we have support and some we don't have support at all and of course we have a lot of both Magic In The Box which we don't know what does what does but we will find out one day but our most valuable thing is uh it's the mindset uh mindset of the art Defenders and that's the uh that's the proactive way to do things",
        "uh we also trying to do things in the loops like okay oh no another loop yeah it will be another loop I promise so we're trying to do the things uh again and again and again and again to go to goal of the continuous security",
        "and we do that through a validation revalidation and when the detection rules are not enough we fill the blind spots with the active cyber defense elements that is also detection engineering which is very sexy these days everybody is doing detection engineering",
        "and we are using as I said as country measure against the against the thing we cannot cover with the defense or detection and with the things we don't know much we're trying to put the countermeasure as the active cyber elements",
        "and we of course love our CTI and it's cdisr way uh we're doing like everything with CTI we're making coffee with CTI we're doing for the threat modeling threat emulation detection engineering we're observing the threat landscape of",
        "ours with the CTI and we're looking for possible external attack vectors with the with the with the CTI basically CTI become our most most important process",
        "another not screw up but problem uh was",
        "for us the prioritization what to do first what next and",
        "they actually was safe from this from",
        "the solution with the incoming conflict in Russia and against the Ukraine so",
        "that way that speed up our priority and we start to look on the east yeah as we said before we had some strategy here we had some some experience we had some processes with some some maturity and we knew that",
        "winter is coming although it was almost spring but everybody who was or who is",
        "monitoring the Russians scene knew that",
        "something really bad is on its way yeah",
        "and that's why we asked ourselves a few questions and how we can",
        "work work with our knowledge and",
        "experience how to combine it to be better to be more or I guess better prepared for what is coming so",
        "our mind hypothesis does the ACD",
        "attitude works for better resiliency and",
        "to go to better focus we created or ask",
        "ourselves other complementary questions",
        "can ACD eliminate the possibility of successful attack",
        "is it possible to anticipate or prepare for an attack due to CTI is it possible to increase the resiliency of the environments that thanks to hardening detection rules Loop and with what accuracy can attack be predicted based on the CTI analysis",
        "and now we go to research methodology",
        "russian-oriented CTI by tract actor thanks to our experience and with with",
        "the with the Russia and Its Behavior I mean Communists maybe you heard about it so we were interested in monitoring the",
        "the Russia Russian scene and we can see that there are used the same action yeah same attacks still on the satellite Network on using the DDOS and malware this",
        "distribution still the same and the",
        "cyber attacks big became uh you know",
        "before the kinetic ethics yeah we saw and believe me or not agree or disagree the Cyber welfare is a standard now part of",
        "the war there's no other only kinetic War it's a hybrid War thanks to our Ridge history we know that we must do some do",
        "something and we started",
        "but not superficially with trying to assessing maturity of each each",
        "adversary of risk of it",
        "but we had the problem how to separate the adversaries because Russia is Big Country I believe is still biggest in the world but uh how we can we can separate the important adversaries for us and those who are just like blubbering just talking",
        "so we was looking for like everywhere and they maybe because of our",
        "problems with the Google we didn't find any Matrix or any any methodology how to",
        "access or how to assess the maturity of the adversary so we just come to old",
        "analysis of competitive hypothesis which was created by however in CIA in IDs in",
        "ladies of a last century and we use that for the uh for the maturity of this or for analysis of those of those adversaries",
        "we use for hypothesis we use the we actually use the four categories which we like divided and that was like by their goal or by the intent of that of the adversary and that was like destructive disruptive Espionage or Criminal you see this is like very simple uh very simple screenshot from the ACH where you got on the top you got the our hypothesis and down we have our validations or",
        "uh and on the weighted on the weighted weighted performance of those adversaries they conclude that the",
        "destructive goal is the one who should be be scared of the most the destructive goal we",
        "I'm sorry that's daughter I have to take that uh",
        "as the destructive goal you can see the make the whole part system on unusable or just like complete destruct and we",
        "can see that on the ransomware wipers MBR rewrites Etc",
        "yeah so and there is no intelligence without without good data and",
        "information and using in in complex so our minor resources are telegram ultimate CTI tool for Russians scene four rooms different forums uh other social media like contact or Twitter and Delta leaks a lot not a lot but some information we got from the liquid database by from killnet third party CTI",
        "reports the fair for example",
        "Sentinel one Microsoft waves good one who is who in the Russian cyber Espionage in the middle you can you can see the the state actors secret Services",
        "fso FSB svr Gru yeah and we know because",
        "it was attributed in in the past that for example Gru is managing the APT",
        "group 2028 and on the other hand on the other side so there are cyber criminals and activists and there is you can see on the picture it's a tiny connection with these secret Services we do not say that they manage these cyber criminals in a hactivist group but maybe they're sharing some knowledge you know so who",
        "is who we tried to choose two different group with two refund maturity first is activist groups for example killnet and hacknet on the other hand in maturity there are apt and",
        "campaigns groups like a coming project mommy spider salty spider uh Smoky",
        "spider scale spider wizard spider and sunborn and",
        "do these two senvor and kilnet are very",
        "important for our research",
        "yeah they are",
        "is here somebody who doesn't hear about gilnet yeah it's just me okay the kill netas group as criminal group started as as provider of the this Services they sell it and in the",
        "end of January or start of February they all recently turn out and they they are now the biggest Russian Patriots on the internet they got very good PR like uh we love that except this guy",
        "on the on the edge he's always the same",
        "those attacks of killnets are low level they are very as sophisticated it's just like those just kill it and buy attack volume vary between somewhere between 40 and 100 gigabytes per second",
        "and they are operating mostly from the Russia they have they have enough connections and they have enough service to uh to do the attacks by themselves but they are using the classic tactics we saw in 2010 uh with the group with this group Adidas",
        "attacks against Sony and stuff FBI",
        "Etc gilnet hates NATO countries we don't",
        "know why but but they do",
        "most known attacks of the klnet",
        "it's uh obviously February 2022 they",
        "went down and uh knocked out some Ukranian government websites there was also some leakage and stuff for us was very important merch and Arab April of 2022 where various NATO country was attacked between them Germany United Kingdom United States Romania Poland Czech",
        "Republic of course and in April 22 they Unleashed their",
        "power on Romanian government",
        "and May in 222 was very uh very",
        "interesting attack on Eurovision which never happened but it was very nicely uh very nicely promoted on the telegram channel of killnet and 220 2022 attack on Italy carabineri",
        "was down so no fines on the roads",
        "and this is our most recent addition to the killnet this is the tarp which was hanged on the building of Ministry of inferior on Czech Republic where the Mr Putin was put in some nice bag and it was put there on the 17th November uh guess what happened on 18th",
        "yeah it was bombed",
        "by deros on the other hand there is Sun worm that's completely different group is nothing they don't have telegram Channel later on a forum so we are out of information mostly",
        "attributed to GRU which is not Gru",
        "anymore",
        "and they are operating at least since from 2009",
        "most known attacks again in 2015-16",
        "attacks on power grid in Ukraine and companies and government organizations",
        "everybody I remember not but they are we still have the stickers I survive I survived not better attack",
        "another another champion is Olympic Destroyer",
        "in the Korean Olympic Games",
        "uh 2018 attack on country Georgia there",
        "is some some similarities to the Ukraine in the five days war and we think they're sharing their resources with apt-28 which is attributed to giru asabel but also with some other secret Services as FSB",
        "actually for our uh for our use case uh",
        "we didn't we didn't pick the Gill net that's for us the point it's pointless and you will show you will see in our Loop uh that uh it doesn't make much sense this is much better better case so we choose the Hermetic wiper a smaller as attack Vector impact is an availability of device and it was used in January 2020 in Ukraine first then it went up to",
        "Latvia and Lithuania as well",
        "so before we will apply the use case I",
        "mean sunborne Behavior to to our custom Loop let's go talk General uh generally you know about Society CTI Loops it's about planning collecting processing and uh analyzing and distribution of of",
        "information you know so and our ACD Loop",
        "um did you did you see it before yeah I guess about 10 10 minutes ago yeah is based on active cyber defense uh Gray Zone and it's include activities and",
        "elements of adversary emulation threat",
        "intelligence thread hunting and",
        "deception and under reception you can include uh beacons deterrence tar pits",
        "and boxes and honey pots but it's not just about this active you know or proactive proactive activities and elements in our ACD Loop are used uh",
        "reactive Parts too like detection so",
        "what are the steps of eye our ACD Loop",
        "first step is managing new knowledge",
        "threats second is about risk analysis",
        "and Analysis outputs uh third is",
        "creating testing scheme modeling it step",
        "four is verify test execution uh 5 June",
        "it's about detection engineering",
        "covering blind spot and using ACD elements and last step is validation doing second test",
        "about tools generally we didn't create it this ACD Loop for distribution it yeah because every organization is",
        "different and has its context so you can use it if you want but consider it yeah our use case application uh through the",
        "ACD Loop we we will show inputs and",
        "outputs of each and attack Vector is",
        "Vapors and used Engineers January on",
        "critical information in Ukraine",
        "so first step CTI retrieve as many information as possible from reports",
        "from internal and external honey pots beacons and some other rulers output",
        "senworm in context owl unified CTI",
        "report very kind of Inc have Yara rules",
        "for detection malicious behavior some ioc and we can see typical TCP for force",
        "and warm uh for maybe their infrastructure some trade craft and",
        "intended goal yeah as a tool for for our",
        "CTI report we used custom created",
        "objects in misp it's for free second step is about about two things uh",
        "managing CTI CTI report you saw it before and lead the custom risk analysis",
        "methodology with use of active cyber defense as a countermeasures so let's go to analyze thread identification destruction malware we take the risk assessment likelihood is for impact is four risk value is 16. critical level",
        "was about to risk treatment our decision was to reduce by implementation of measure typical decision for risk analysis and what are the measures first measures are for detection second is straight employ deployment of ACD elements why we do it just getting into time yeah we start with implementing the or deployment of",
        "ACD elements and we can gain the time",
        "for detection engineering and hardening the rules and we can straight reduce the risk for detection we use ACD elements for covering blind spot in detection where we got the measures list former Shield by maitre now it's engaged",
        "attack mappings it's just Excel sheet",
        "where you can so the links between ttps and active countermeasures some some TTP",
        "and just use Honeypot or Beacon to to mitigate it so measures implementation detection we",
        "will cover in next steps ACD elements we",
        "we use DC for Honeypot with no vulnerability it was Exchange Server and",
        "we needed to take reassessment risk reassessment likelihood this four impact is 3 and total risk value is 12 still",
        "critical now let's model it",
        "yeah I have to speed up the model is practically graphical graphical expression of the of the steps you have to take to uh to uh to put this in the context and as you see we saw we use the monitor free tool attack flow but you can use any tool you like which is able to draw the square something like that but those uh that model is of course is including the ioc dtp's artifacts reductions so you can model your scenario for execution",
        "the first step into a verification before you uh when you execute is to uh",
        "is to verify where your standing is and how you stand in this uh in this actual status what it is uh we use of course the adversary emulation in quotes because that's very simplified",
        "and we are we are using for documentation the ads which I will talk in in like two slides from uh from now so just keep that in in the head uh how to do the adversary emulation the easy way well it's uh it's divided into three categories again and one is atomic everybody knows Atomic red team scripts apt simulator and uh and stuff there is",
        "a lot of tools on the GitHub where you can find these uh these things when you uh when you try in just one one thing with one one click you will uh you will check if you are able to detect it or not for Rapid emulation again maitre it's all over the place these days uh it's Caldera it all allows you also to create the campaigns and the flows and last is the full scale or a teaming or maybe half scale it depends how much money you get and this is basically our first result",
        "we did verify our initial status and as",
        "you see the difference success rate is about 28 something percent which is not not which is nothing to write home about but you know it's better than some other agencies",
        "and you have to go to the step five because of course you are not satisfied with the result like this so you have to tune up the things you have to go uh with the detection but to tell you about detection I have to tell you about ads I talk about like two two slides before ads is uh is short for other thing a detergent strategy it was created by palantir in year 2017 so it's pretty old but it still works",
        "and basically it's nothing else than the strategy how to document your work with the detections uh we add the sigma rule for the 10 categories they already had and the AC day element for the uh for the blind spots you can see this is just like another object in the Mis which we created for just this uh this hour loop",
        "you have to first you have to tune the detection so you can see your blind spot and where those blind spots are just stick there the Honeypot or tokens tokens Beacon whatever because document",
        "and of course document your progress yeah uh please technical guys uh screw up you can keep everything in your head document it please so let's take a step aside how to deploy ACD elements to base ad hoc it's easy to easy to use but badly managed uh systematic deployment it's a easy to manage but it's more expensive so here is our maybe managers screw up",
        "it was about to choosing the easiest way and prefer the quick win before before",
        "the long preparation yeah we took the",
        "investigation and it was a different manager and his mistake so another mistake is about ACD implementation uh it's not security solo you need the guys from the from the operation yeah you",
        "need process defined roles and you need to cooperate with them no solo",
        "and finally for this day we are in six and validate and this is the last step of our Loop and it's actual validation of the older work hard work we done uh we will measure the detection success and efficiency of our ACD elements we put in the place and as you see we came from the very bad result to partial awesomeness in 78.57 the fan success rate which may be good for someone but who wants more than that it can go to the step four and reassessment already",
        "uh well uh recommendation after the loop",
        "when you uh when you finish video Loop just go and and do your cyber security",
        "hygiene thread hunting and just",
        "externally useful sometimes red teaming externally if your organization mature enough and if you have enough money portable team it's always good idea with any friendly agency or organization",
        "and this is the end of the loop and here is our Armory",
        "you can visit this website it's uh it's actually not website it's just shortcut to the start me page where you will find all the information for this presentation uh we will also publish the publish the presentation at blackhead uh we do as the part of the Defcon group 420 we got the active cyber Defense gray Zone which you saw uh they do the custom ads like GitHub repository and we got also the custom risk analysis with the with the ACD with the ACD",
        "those will be published on January 2003. we got the uh we got hold on",
        "ha I have to thank themes we forget some few things there in adversary emulation we always uh we always use the vector Atomic red team everything is cool by Mitra including the spaceship building program",
        "and of course we love incident response tool number one Excel",
        "yeah just recap so we use send word",
        "Behavior we go through our ACD Loop",
        "which includes in CTI this selection hardening and using ACD elements for blind spot as a counter measures we used",
        "custom risk analysis with ACD elements and we try to build resiliency our",
        "results numbers false positive before and after 76 and 2029 uh introduce grew",
        "up five but it was uncontinent number yeah uh introduced new alerts 12",
        "validation on the rules in the contexts of ACD attack TTP 40 International 8",
        "blind spot identifies three",
        "percentage of rules change from 30",
        "through 3 to 95. let's go answer",
        "hypothesis can ACD eliminate the possibility of successful attack yes but nothing is black and white you know so it's possible to anticipate or prepare for an attack due to CTI yes all security agencies in the world rely on the Intel for the decision making it's possible to increase the resilience of an environment yes we just proof it I hope so we it what accuracy can attacks be predicted based on the CTI analysis with high probability and answer to main hypothesis does the ACD attitude works for better resiliency absolutely about us we are at the end of file I need to skip this joke but do you know for forget",
        "make love",
        "not worries",
        "and build resiliency and now blackhead",
        "sound bites be active meaning proactive don't rely on medicine but be your own doctor I mean I like Doctor Who the guy who can manage everything and combine something old something new something borrow something blue",
        "questions",
        "[Applause]",
        "[Music]"
    ],
    "5jeWwSrgYN4": [
        "foreign",
        "so thanks for being here it's a second time for me at Black Cat and first time as a speaker so today I'm here to discuss about machine learning and how we try to use it to enhance our detection capacity so um I'll start with a bit of context then I will explain the solution we have tested the behavioral analytics solution before I'll try to explain the basic of machine and deep learning and then I'll explain our use cases so let's start with some context so I'm part of credit agricult which is a French Bank stock team so in credit article we have like 250k users within our information systems and within the Circ team we are collecting more than 300K even per second so it's 10 terabyte of data which are collected parsed and correlated in real time so I guess that's nothing new but just to emphasize that it's a lot of data so it's almost four petabytes of data a year and a role as the suction is to detect threats so when I arrived like four or five years ago I had to make sure we are at the proper level in terms of cyber security and uh basically we had been working with the miter attack to try and understand what we were not able to detect and what we found out was It was kind of difficult to detect anything which were non-deterministic meaning that we were great to detect things which were based on thresholds but for anything else we were struggling so what came to our mind was machine learning so machine learning has been famous for lots of time it may not be really popular in our industry but still it was famous and we saw we should have a try and see whether it could help us or not so the first question we've been asking is where we could have put some machine learning within our sac so in our stock we have like raw incidents that being sent to our Sim so like that those are like databases server logs Etc and we send the row event to the Sim we also send some security solution events to the Sim and it does like the detection and they send the incident into our store so we could have put some machine learning at this stage but the security solution already embeds their own models so there is nothing for us to do there we could also have put some machine learning to help with alert triage and prioritization but our main goal was to try enhance our detection so we decided we would try to do something from the Royal event directly and try to do some detection in terms of weak signals so first we didn't want it to reinvent everything so we had been testing some solution what I call like the automagic solution and those have some advantages like they are ready and easy to use so basically what you have if you buy the solution you've been delivered with a server and you just have to plug in within your network and then you start doing whatever it needs to do and it's technology specific which means those Solutions are really well well made for what they are supposed to do so if you are willing to analyze the network traffics well it works great with pickups but on the other end like the solutions are not really flexible so this means that when you buy the solution you are being sent with a liter of prerequisite you should achieve and if you are not succeeding to achieve one of those then you won't be supported and in our big and complex information system it was kind of difficult to have everything done so yeah that was something different good for us also we were concerned about confidentiality because every time like we had to send the data to the third party vendors and most of the time they were asking us to provide our data to their cloud and we didn't want it to do that and we found it was kind of unfair because we were giving our data but they were not giving us with their model so it means yeah it was like an unfair situation so we didn't want it to do that and also the solutions were time consuming meaning it was really hard for us to qualify the detection and the incidents we were having at that time we didn't know about explainability in artificial intelligence but yeah still we we were struggling to understand why an alert would have triggered and we were giving no clue about it so we decided we would jump by ourselves into machine and deep learning so hereby raising ends or many of you guys has already implemented their own machine or deep learning models yeah okay okay quite a few okay so um I will start by explaining um quite the basis of it just here just a bit of a disclaimer to say that what I'm gonna show and discuss today is just our truth so the thing we discovered by trying to implement our own machine learning but I would be more than happy to discuss with you afterwards for from what you think so machine learning is part of artificial intelligence and basically it can help solving two types of problems so one is called the supervised problems and the other one is unsupervised problem so we supervise machine learning basically you've got a bunch of data and you've got a ground truth or a label associated with your data and this allows you to do two kind of stuff like you can predict or classify the data based on the known level on the other end like the unsupervised machine learning you have the data but you have no ground shoes associated with your data so you can still do something like with unsupervised machine learning you are able to do clustering which basically is grouping the data together based on some patterns and you can also do some anomaly detection which means you can find the out layer within the data so we worked with unsupervised machine learning because we didn't have any Grand truths associated with our logs",
        "so here just an example of one algorithm which can be used to solve unsupervised machine learning and particularly anomali detection so this one is called the isolation forest and the idea is you've got some data and you say like another layer is something which is different from the rest of the data and you assume that you have few outlayers within your data and the main idea is you start drawing random line within two thresholds and the less lines you need to isolate the points the more likely it is to be an anomaly so we can see for instance that the point on the corner would be like more easily isolated rather than the point in the Middle where there is less probability to draw some lines in there so this is machine learning nothing too fancy let's now have a look at Deep learning so with deep learning you still have your data which now is called the input data and you initialize some random weights and you start multiplying your data with those weights and you add a bias and this result is being sent to an activation function which normalized the data and here you go you got one neuron and you iterate like for um several neurons over several layers until you",
        "reach an output which is your result and basically here what you are trying to do is you are comparing your outputs with your ground truth and you are able to compute an error like which is called a loss the difference between your ground truth and what you get as a result and thanks to an optimization algorithm which is called the gradient descent you are able to try minimize this loss so you're able to reduce the error and approximate a better result",
        "so you can yeah sorry you can back propagate the error and adjust your weights until you reach a good enough result so um here you should be asking yourself like who can be who could we use this with an unsupervised problem because as we say like we have to compare our output with your branches so how could we do we if we do not have any crunchers so there are different architecture in neural networks and this one which is called the autoencoder could help us because basically at the end you are not trying to provide a prediction but rather you are trying to reconstruct your input data and you can still use the same mechanism as before but that I'm trying to reduce the loss to the error between your reconstructed data and your input data and this is helpful because with anomaly detection then you can use this kind of encoded version of your data within the layers which is called a Latin space as a representation of your data and you can start using it and see if a new data looks different from that or not",
        "so I hope you guys are still following and still awake so here what were we trying to achieve before I start those explanation well we were trying to improve our detection capacity so um the use cases we focused on with my team was the exfiltration so",
        "exfiltration is part of the miter attack Matrix and we could ask ourselves why won't we use a glp solution well it needs lots of things to be done and also we are at the stock team so our role is to detect things rather than prevent those from happening so we believe that trust does not exclude control so we are really willing to see what's going on within our Network so we decided we would still focus on trying to detect some exfiltration over the network so the motor attack technique is filtration I've got lots lots of tactics associated with it and if we have a look at the detection part like the miterate attack tell you or you can try to detect stuff well let's say you have to monitor the traffic and find something which is either like abnormal anomalous different",
        "or suspicious so we can understand that",
        "here we are trying to find non-deterministic Behavior so machine learning could be a great use case for us to help solve that so what we did is we had followed like a machine learning or data science methodology so um the first thing we need to do is collect the data so this could be tricky sometimes but we are the SEC team so we already have the data we decided we would work with the proxy logs rather than with the network traffic because it was easier for us so we start from there then we had to clean the data so the idea is to remove all the unnecessary part of the data for instance we have removed the proxy logs from the logs themselves we only kept the traffic from the company to the internet then there is What's called the feature engineering path so here we computed some interesting variables about our data and I will explain this a bit further then there is the modeling part where we do some machine learning and then we predict um like a score and anomali score based on our data",
        "so let's see the feature engineering part so here is a sample of a proxy logs so we can see we have lots of metadata associated with it in green the metadata can be used to detect like if there is a huge amount of data which are uploaded to a domain so we can with those that",
        "take like ugex filtration mainly basal thresholds but we found that that there are lots of other metadata that can be useful to detect things suspicious like",
        "the user agent the response code from the server the the proxy the action I",
        "would have taken so yeah we decided those limited attack could be useful so we worked with 15 days of data for our prototype and we use like almost 15 gigabytes of data and the first thing we had to answer was um oh we should represent our data so here I'm making a bit of interaction with you guys um how many branches can you guys see on that picture I guess it depends on perception like force three depends so yeah it depends on perception and the thing I would like to emphasize here is um the way we represent our truth or reality would impact the way we are trying to solve our problem so what we decided was one log can cannot be considered as a threats um but we we could outwork with multivariate time series and try to detect anomalies within those but this would mean we would have worked with so many times there is so what we decided was we would work with an aggregation so basically we came from the unit unitary logs and we aggregated those into daily behaviors and from that we start Computing some indicators",
        "so the first type of indicators we've been computed was some some like the total number of requests which were made by that machine the number of volumes that were uploaded to that website or to whatever website from that machine the ratio between https and HTTP requests also the number of unique user agents the machine would have the number of EP address that were requested instead of domain",
        "then we have computed more generic features like what we call the popularity basically we add contact the number of unique user which had requested a website so if all of our users were requesting a specific website well it's likely to be something normal but if just a couple of user are going to website maybe it's something which can be suspicious so we were aggregating the data daily so we were removing the domains Parts but still we were able to count the number of kind of unpopular domain a machine without request",
        "we also have done some profiling so we have used like clustering algorithms within our data and we had counted the number of time a machine would have changed from a cluster to an another also we had computed the distance from that particular point to the centroid or to the nearest clusters and also we have computed some Evolution indicators so basically the idea here is to say like if a machine is doing a lot of requests but it's it's normal behavior well there is no point to detect it as an anomaly like every day so yeah those are the features we've been computed so here um the thing is um there is strong mathematics associated with machine learning but also on the other end we have to make sure the data we are feeding it is nice so yeah I just want to emphasize that the knowledge of the data is something which is also really important in machine learning",
        "so then comes the machine learning part so here we can see like it's like 10 line of code it's we Define our model we train it whereas what we just saw was like 500 line of code so it just prove what I just say um so here what we do basically we pass our data we initialized our model which is the isolation for us we discussed a bit earlier and then we train it we are missing few regularization parts here but just this is main ID and yeah you just like predict an anomaly score based on that and here we see like the contamination ratio so in a way we reintroduced some threshold because um we say like we would like to see 0.5 percent of our data sets as an anomaly here we did that because we did not want it to send too many alerts to our analysts so we had to to reduce the efforts and once we've done that so basically what we had was um like a daily Behavior an IP address and then an anomaly score and when we came to our analyst we were like really proud of what we've done but they were like okay um so you've done some machine learning but all I can see is CSV files and there is no way we would work with CSV file I guess they are used to more fancy stuff so we had to figure out a way on how to make them use what we've done so in unsupervised machine learning there is a third type of problem we can solve which is like dimensionality reduction so there is a techniques which can project your dimensionality within lower",
        "Dimension so we had computed like 71",
        "variables and we've we projected those",
        "into three dimension just to make things a bit more Interactive",
        "so we had then developed like a tool so we can review our anomaly so here we can see there is like the daily Behavior which are plotted into three dimension and it's kind of intuitive that the the points which are different are the anomaly so you can start clicking on those and you can review The Daily Behavior associated with that point and all the behavior of that particular machine with the anomalous car and also like every thing we have computed and everything we found relevant to provide to the analyst and when we click on that particular point then we can review all the domains like all the unique requests which were made on that particular day so I've anonymized the domain because I yeah I just want to make it that like this and then we can provide us with the feedback so you can say whether like um this particular this behavior is a nanomally or not like it's it's a false positive it's a true positive it's something interesting whether we need to whitelist the domain or the machine and also we are able to generate an elasticsearch link because basically what we've done is we send those results like all those features we've been computed to our elasticsearch and together with the raw events we are collected correlating those to enhance and provide more information to the analyst",
        "so um the main idea was to make sure we provide everything we can to the analysts so we used basically statistics to provide whatever could be of an help for them but we didn't want it to automate their job and as we just saw like basically what we are detecting are more like weak signals and we really need analytics to work on those suspicious activity",
        "so um I guess you've the idea of what we've done and maybe you you should ask yourself no if it's working so let's try to see whether it works or not",
        "okay so",
        "um in order to understand whether what we've done is working or not we should understand how we are trying to evaluate things so we supervise machine learning well you've got your prediction but you also got your grand truth so it's kind of easy because you can compare your ground truths and your prediction and you can start Computing some metrics like the Precision and recall if you are working with unbalanced data sets we have to make sure we are using the proper metrics but still you have something to rely on and on the other end with Enterprise machine learning it's kind of more difficult because you cannot compare your results with ground truth so still you are able to compute some metrics like the distance between and within the Clusters you can compute What's called the silhouette score but I guess that's enough of mathematics and what we really want to say is whether we are able to detect real threats so what we've done is we had worked with empirical evaluation so we have been implementing our own simulation to make sure we would detect those",
        "so here what we can see is um some daily Behavior as what we saw before and within those data we have some simulation we have implemented so here we have a number of behavior like 30 000 Behavior more or less and the number of anomalies the total anomaly which were formed by our model was like a bit more than 2000 and within those we output 0.5 percent as a top annually which can be reviewed by the analysts and um",
        "what we can see is like um in a blue orange and green we have projected our um our simulation so we have defined like three types of um exfiltration we would like to detect so the first one is what we call the schedule data transfer size limit so basically we just chunk data and send those to our servers in an automated way so in a regular basis we also have worked with uh what we call the exfiltration over specific channels so basically just communication through a normal uh like a suspicious server and also the subdomain exfiltration so air is not like DNS propogenesic situation because we were working with the proxy log so we just like we passed the data within the sub domains but in an HTTP request and in Green in Gray three it's a unlabeled data so what we can see is that the the simulation we've made are part of the anomaly we found and we can see they are kind of different from the rest mainly so this means that we found some relevant features that allow us to like detect those behavior and yeah in Gray there is one guy which is doing random stuff like which is not part of our anomaly or simulation but may be reviewed",
        "so just to provide a couple of stats so um we've we have iterated like a couple of times um and in this example like we have done like 20 tests of each so it's like 660",
        "um simulation over our 30 000 Behavior so it's quite very few um but we can see that with the oil isolation Forest dictation we were able to detect lots of the the thing we've simulated and still with the top 0.5 percent of the anomaly we were able to detect some of those um with our Legacy detection system we were not able to detect any of those Behavior",
        "and one day I arrived at the office and I was reviewing the anomaly as part of my daily job and I found out that I was the top anomaly of my model so I just asked myself what did I do so um we had a look with my colleague and what we understand is um I was booking my tickets through the Eurostar platform to come see you guys and um the Eurostar is sending lots of message to the Sumo logic websites so basically it's a Tracker so we can see like in 20 seconds there is like more than 300 requests being made to that third-party websites so um obviously I found myself as an anomaly because yeah basically a Tracker has a similarity between the schedule data",
        "transfer we tried to detect so um we ask ourselves how to prevent those to be detected and how can we differentiate a real exfiltration from a",
        "Tracker and the only thing the only thing that we found out was based on the domain so what we did is um we used some domains features so basically we reduce the job we've done on the daily behavior on the domain parts and we had added some more features like based on the who is like since when the domain was online",
        "um and like the classification of the domain and lots of things like that and we are convinced that this correlated with what we've done before would help to reduce the false positive so yeah",
        "so let's see how then some limitation and perspective and what we did so um with our machine learning custom development we were able to leverage our detection capacity because as we saw like we were able to detect more typology of exfiltration than before",
        "also what we made was really flexible so we were able to adapt it to our context we are able to whitelist things and to build our own features and to make those available for the analysts we can explain why this would have trigger and Etc but it's still time consuming because we",
        "have to implement everything and also I'm convinced that we cannot add some detection reducing the analyst time so yeah for sure we need people to review the anomaly we have detected and we need resources we need people who develop and maintain what we've done what we've done but our main goal was to leverage our detection capacity so I guess we had succeeded in that way",
        "so just a couple of takeaways um so here we were able to enhance our detection capacity using data Sciences for sure but mainly using the knowledge we have on our data um just to keep in mind that we are dealing with weak signals which means that we can use what we've done either as a straight-ending approach uh um with like our Legacy detection like to contextualized uh the the Legacy",
        "detection like if we have an incident on a machine we can check and see whether it's something which sounds suspicious from our perspective as well so yeah I believe if we have a python face and willing to do stuff we can do great stuff using statistic and those kind of techniques in terms of perspective we would like to industrialize things so um for now things are automated but they are not industrialized in a way like we are not reviewing the inference of our model we are not monitoring it we would also like to improve the reproducibility so we are able in our own information system to make things reproductible but I would like what we've done to work with different type of proxy technology so yeah and also we",
        "would like to try to use some deep learning techniques so we are trying to work with some Auto encoders as I showed you at the beginning and those looks to provide a nice results so we would like to to Deep dive into that and maybe use",
        "it in our production and yeah for sure we'd like to implement some new use cases and correlate those with what we've done so far",
        "so just some final words to say that yeah the main idea is was not to say this is how you should do stuff but rather to say like this is the path we had followed this is what we found on our way and if you guys had any remarks or anything I'm convinced we can do great stuff but it will be even more effective if we discuss together so that concludes my talk and like to thank all those guys that were involved and if you have any question I'd be happy to try in service foreign",
        "[Applause]",
        "[Music]",
        "[Music]"
    ],
    "JWI_khgpyYM": [
        "foreign",
        "thank you for coming to this session in today's talk we are going to Deep dive into a way to search for RPC functions to create authentication in Microsoft protocols",
        "so my name is Remy gasku I'm also known as podarius in the information security scene and I'm a security researcher and speaker in France where I do mostly pen tests and vulnerability research my",
        "principal research subjects are a Windows X trajectory security and recently mainframes",
        "in this 30 minute session we are going to go through a background on what is RPC and why we are going to need it what are windows course authentications even though they are still not patched in all the of the functions in Windows we are still needing them in offensive security what is the state of research up to this point to uh course authentications that are using RPC functions and we'll see how we can parse the Microsoft open specification documentation to extract",
        "and create new functions to parse the",
        "IDL and auto generate proof of concept code that we'll use to find new course authentications after that I'll present cursor which is an all-in-one tool to course authentications for your pen tests and finally I'll leave you with defense techniques and free takeaways from this talk",
        "so when we are inside an active directory domain we have many windows machines that communicate with each other using various Network protocols one of them is called the remote procedure call or ensure RPC and basically it allows to call a remote function on a remote machine for example we can from a user PC ask for something under DC to work and it's called a remote procedure called a remote function on a remote machine of course you can call this function with parameters and you will get a return value or a return structure in case of a file descriptor for example you can have a print handle or a file descriptor in response",
        "to call a remote procedure we need three things firstly we need to know in which RPC interface this function is defined and everything interface is defined by a couple of universally unique identifier and a version and we'll need to know what is the operation number of the function the operation number of the function uniquely defined this function inside the interface because inside an interface you will have many functions and they are all listed inside kind of a list and the operation number is auto incremented to Define each function and finally we'll need the parameters just as any function in any programming language so if we take an example of a simple RPC to understand what is a course authentication imagine earn a function called rpcc by file that you can call remotely on a machine allowing to copy a file from a source to your destination file you cannot call it anonymously because anonymous calls can be a vulnerability Percy we will assume that you can just call it with a normal user in the domain so when we are calling these functions it can be even pretty useful when you are doing administration of a remote servers because you can copy backup files and you can do stuff like this but it can be leveraged by an attacker because it manipulates file paths",
        "we'll see that this summer last call can be used for example if we use it on the local file it's simple everybody here knows what head what it will happen you call remote procedure the file is compiled and use your get rich and value in return and you perform the local file copy but what if we changed inside the source file the path to a local file by your UNC buff on Windows targeting a remote server in this case srv1 to find a file that is hosted on the remote chair what will happen then is that when we will call this remote procedure on dco1 dc1 will try to copy this file from the source file but this source file does not exist the source file is hosted on another server so uh dc1 will try to access over SMB to srv01 serial one will return the file content and the file content will be stored on dco1 finally we'll have our return value or our return structure in this case it's a legitimate example so it's not a problem as per C but we'll see that as an attacker we can perform the same operation but ask dc1 to retrieve a file that is hosted on one of our SMB servers it can be on the same machine or on another machine in this case it's all on the same machine so we perform an RPC core to ask for dco1 to retrieve a file that is hosted on our server what happens then is that in the Step 2 dco1 will try to",
        "authenticate to our machine to access the SMB server firstly it will need to try to authenticate using the null session to access it anonymously and if we respond by saying that you cannot connect anonymously to this SMB server then it will try to authenticate using its current session and in this case if the program running the RPC server runs as anti-authority system you will be authenticated as dco1 dollar the machine account of the machine and we can return whatever error code we want as access denied in very credentials or what you whatever things you need because we do not need to actually give the file content to dc1 and finally we'll get a return value but in the meantime we got the actual Ash of an authentication from dco1 and depending on whether this ash is an ntlmv1 and tmv2 Weaver without SSP you can do lots of things with it it's not an attack per C at this moment but with this first step you can perform many attacks afterwards if it's ntmv1 and 10b2 with a revert SSP you can either relay this ash to connect elsewhere or you can crack it locally to retrieve the md4 password the anti-ash of the machine account or the account that authenticated",
        "this kind of attacks are not new in fact the first one uh which was widely known at the time was the printerberg which was found in 2017 and after that we've participatam in 2021 we saw around four new attacks in four different protocols",
        "um in less than a year so we can only wonder what what's next what will be the next score because if we can find four new ways to course authentication through our PC in one year it surely means that there's many others and as there are thousands of rpcs out there uh it's quite probable that we find new ways",
        "so I was wondering what can we do to automate the search of RPC functions because up until this day when course authentication through RPC was found it was found by reading semi-manually as the Microsoft open specification docs with PDFs or online and try to understand how the rpcs works and what function can be interesting to to course Authentication so there are two ways to course to to find new vectors to question indications the first one is to reverse executables and programs that are on the machine which have RPC servers in them but the main drawback of this uh of this approach is that you have to have all the services installed on the machine and you cannot do that automatically you cannot install all of the windows services on one machine because the machine will try will start to bug if you actually install everything that you want on a DC and sometimes even if the service is installed it does not mean that the remote version of this service is activated so sometimes the service is working locally but you cannot call it uh from another machine so this way is really accurate but it's very complicated to do and the other way is way more as a wide attack surface because we can see every function of every protocol by parsing the Microsoft open specification documentation but we cannot test it because we will need also to have the sources installed on the machine so we'll have to by hand install the services but we will find way more functions by parsing the docs so when I chose to parse the Microsoft open specification docs I I had three main objectives in mind the first one is to find all crpc protocols with their ideal files if present ideal stands for interface definition language I wanted to find all the interfaces interfaces which all the functions that we'll need to use and how to access them and list all the arguments of all the functions so we can see uh what they are if they are interesting and their operation number",
        "Microsoft's open specification docs looks like this you have a page inside Ms docs where you have every RPC protocol described a protocol by protocol and when you",
        "click on this protocol you will have all the documentation that you find in the PDF in online version and on the left you see multiple sections these big sections are introduction messages",
        "um security security examples protocol examples you will have a lot of things and inside it you have various sections that can be very useful to to find information for for This research so first one is the section 2.1 transport which in most of the ways most of the case sorry uh will hold all the information we need to connect to the service that runs these rpcs sometimes",
        "it's not complete because all the pages of Microsoft docs are not equal and sometimes you won't have the uid and the version of the RPC interface so if the information is here it will be in this page but sometimes it's not it's a major problem with this page is that it's written in natural language so it's quite complicated to parse even though we can use regular expression to extract the uid of the RPC interface to find the versions it's quite complicated and sometimes they are not inside these pages",
        "so one of the ways to to to find all this information is to parse the section 6 of the documentation which contains a full IDL it does not always contain the interface definition language because sometimes the ideal is not public but when it is public we have a file containing all the interface definition language which defines the interface the functions that are in it and a lot of arguments and type structure structures and types that are used in it and as you can see here on the top of the file you have the uidn version of the RPC interface that is listening",
        "and they are always here because it's the interface definition language that is used by developers to develop the interfaces so if we have this file we also have the uid under version if we scroll down a little bit we also have all the prototypes of all the functions that is used in this interface uh also we do not have the source code we have the prototypes but we only need it to to know how it works and if if it manipulates file paths so as you can see we have functions we have uh the types the return types we have properties of the of of each arguments and we have argument names but we do not have the operation number simple the operation number is basically Auto incremented in this file so we just have to parse this file and we'll need a we'll know everything we need to connect to these remote functions",
        "if we look more closely at what a function looks like we have a return type a name properties a type name for",
        "each argument and argument names argument names are really useful in rpcs because they are almost never obfuscated which means they typically describe what they are doing so server name is basically a server or an IP address root share is SMB share comment it can be a comment uh of a new share that you will create or the new DFS namespace and through these arguments we can actually know uh into",
        "um we can know if they are going to manipulate file paths and therefore if they are going to accept UNC paths to force the machine to authenticate on a SMB server",
        "what we can do is we can analyze all the RPC functions known to course authentications up to this day and we see that every function known up to this day to course notifications is using either path share file name printer name server name inside one of these arguments as the attack vector and the UNC path is always injected in one of these arguments so if we try to create a model uh to to look for all of the functions that use these arguments to",
        "correspondications we can start from",
        "this and you just pass everything in the documentation and list every function that does these names inside its arguments",
        "so what we are going to do is what we are going to parse the Microsoft open specification documentation page where every RPC protocol is listed for each RPC protocol we are going to list every section and see if section 6 is existing if section 6 is existing we are going to extract and parse the interface definition language of this function and of this interface and its functions and for each function we are going to extract all the functions with their parameters and get the RPC interface uid",
        "and version that will be defined inside the ideal file",
        "now that we're here if we Implement a model using the name that we saw just before we can extract all the functions that have names that are look alike with file name server name printer name share uh you or sometimes uncpath some some of the functions have UNC buff in their names and we can extract almost 230 350 cores",
        "and inside them we can easily find back known calls with participatam in the",
        "encrypting file system protocol an EFS we find back tree sounds on event log we find DFS scores on Dynamic",
        "distributed file system namespace protocol we find a printerback and we find every existing course authentication through this",
        "but now that we have a list of functions that are promising what we want is to automate most of the work to create proof of concept because it's one of one of the bargains of This research was to find the actual functions that we are going to use but the other part is to automatically generate proof of concept because we are not going to write a 200 profit concept by hand",
        "um firstly what we need to do is to write a program in Python using impact it's a labor Library used to connect to Windows machines for offensive attacks in Python and we are going to write a simple file in Python to correct an authentication using one of the actually known Quest methods we can use patipatam or whatever color you want we write a python code and then we are going to try to automate it to change everything that is specific to the call that we use such as the RPC interface the name of the call the arguments of the functions to create a python template using gene J2 and it will look kind of like this so it's really not python anymore and it's absolutely ugly but it will allow us to",
        "generate proof of concept code for each of the score what you see here is when you are going to connect to an airpc server using in packets you need to use two structures one for the RPC call and one for the SPCA response two bars and to create structures and this template allows to",
        "create the structures so that we can perform their physical and parse the response what it looks like since once it's generated it's way beautiful and as you can see there is the operation number that we saw in the last slide and the structure which contains all of the names of the arguments as well as the impact types that you see inside the brackets and afterwards in the comments you see what what was the type that was actually written inside the ideal files because the impact type and the ideal type are not the same so I I kept uh these these types in comments because if we need to debug at least we have it and as you can see in the response I left an empty structure because we actually don't need to pass the response so I decided to just create a numpty structure which in packets will try to burst but as it's an empty structure it will not parse the actual response from the Sab server we can parse it if we want we can implement it to have the actual response that what that was returned by this score but most of the time we don't need it so we want uh we want to bother doing it",
        "this is the next part of the genji2 template which is even uglier because gin J2 mixed with python is a is not pretty honestly but we are going to create a class which basically does everything that we need we are going to create a class that takes the uid the version the RPC function name and its arguments and this class is going to trigger this core and uh just trigger it we won't parse the response we will have a response but impact will pass nothing because we have an empty structure so this is a Jin J2 template for you can watch it more carefully in the slides afterwards because it's not really pretty to project and uh what once it's generated it's a beautiful python code and you have a class with the name of the protocol uh it's this one is DFS course it was found in June I think and you have the uid version SMB pipe to connect to and then you have a function which is called the same as the RPC functions that we are going to call to correct the authentication through the server name variable as you can see server name variable actually takes an IP an obvious name or a domain name followed by a null byte and we have root chair comment and whatever thing you want and um we just put random data random names random ASCII strings to populate them",
        "and as you can see um in the in the last lines of the codes we see cell dcu.request it's the actual line that tells in bucket to perform the the serial PC request to the remote machine",
        "as I said before we have a problem with ideal types and in packet types because they are not consistent and impact uses",
        "python structures to create these types because they are not really existing in Python so we need to keep in mind that we are we are going to need to create a translation table between the two because IDL and impact types are not the same and sometimes uh free impact free ideal types will be translated to the same impacted type as we can see here the wide chart t y Char and white shy pointers are always translated into a",
        "white string in packets",
        "the main limit of this method is that as I said before we don't necessarily know how to enable the services because this part of the Microsoft documentation only focus on the developer side of this of these rpcs therefore we need to uh know how to enable the services and sometimes it's not written inside the docs and also some protocols do not have their public IDL code as they do not have their public their ideal code there is something we can do which allows us to steal parse a bit of these functions is in the section headers of the documentation you have the name of the functions followed by parenthesis open them and the operation number so therefore if we do not have the ideal code we could parse section by section for all the functions of the protocols and extract the HTML of the markdown source of the of the documentation to understand what is the the parameters of the function",
        "so following This research I published every proof of concept with their readme files and everything of This research in open source so if you want to check it it's on GitHub and it's still being 3-h because uh as I said before we have to activate each of each of those services and sometimes it's not really clear or we cannot activate them anymore it's only on Windows Server 2008 for example so it's quite complicated to create by hand but at least we have all the read means with all the information uh RPC interfaces uids and a python proof of concept code using impact that is inside this Repository",
        "there is one folder pair protocol and each in each in each of these folders you have one folder per function containing the the proof of concept code and the readme file the redmi files contains all of the documentation all of the links to the actual documentation so you can find where the information come from and you will have the operation number the RPC interface with how you can access them for example the list of SMB pipes that that is used to access them and if you",
        "want to access and access it on GitHub there is QR code here so feel free to scan it",
        "foreign and finally inside the this repository you also have a readme file for each of this call with a short description of",
        "basically what is the course to authentication but specify for this call meaning if we are using the encrypting file system it's really easy because we perform one call using file name and a UNC path and we have already a question Authentication but in the case of a printerberg for example printerberg uses a printer",
        "handles so you need to open a printer retrieve the handle so parse is the actual RPC response and then use this under to curse an authentication so in this case it's really useful to have a description piece by piece of what is happening to course Authentication",
        "for the print testers and researchers that are doing course authentications inside The Apprentice I wrote something called coercer which takes all this research and applies it to pen tests really easily basically I use everything that is actually known as RPC calls and next RPC calls will be added once we find some in the in this slide and there is three modes the first one is the scan mode that is intended for defense purposes uh in scan mode you just have to give a user of the domain and which it will try to authenticate to every RPC function through every interface and through every SMB pipe on the remote machine and as you can see we already know inside this tool if we got an SMB authentication directly inside the tool we do not need to have other tools such as ntlm relay or responder to use it and this one is more intended to scan for a remote machine for example to see if your net filter rules to prevent RPC calls from another machine that worked",
        "the second mode is the chorus mode which is widely used in pen test when you are doing a course authentication you can curse through every possible core through this mode you can either use it with authentication with a user authentication or without authentication in case you use a an authentication it will try to authenticate for every SMB pipe in which this call is known to work and you will have uh the SMB authentication that will go to another server there is no SMB server um in the course mode of cursor so you can use a responder or NTM relay to actually perform the attacks",
        "and finally there is the first mode for the research Forks if you want to First every every call every payload through every SMB pipe on a lot of machine you can prefer you can perform it on many machines it's basically like verb Intruder but for RPC calls using various payloads on air PC calls yeah and you will have um as you see the error codes and the SMB authentications is actually what we receive from the RPC response so if you see an error code it's the error code that we received from the authentication and the SMB authentication is that we actually received an SMB request from the remote machine",
        "so to wrap up this talk I want to remind a few defense techniques because course authentications are not a vulnerability per se they are they are just a way of all windows works and they will not be patched so we're not we we need to prevent them from happening by",
        "adding external security to this so when we have a course authentication basically the machine that is attacked will connect back to the attacker using outbound SMB and or TCP or whatever",
        "connection you want and when we have this kind of connections we can prevent them through three vectors the first one is to disable all the unused Services uh it seems rather logical but should be surprised on how many domain controllers you see out there with the principle are still activated up to this day in 2022 but we need to disable all the new services and more importantly to why to to disable all the services and enable only the ones that we need secondly we need to enable the extended protection for authentication this one is really important but it will not prevent the course authentication it will only prevent the relay of credentials once the question the course authentication has taken place so an attacker will still be able to receive the authentication but it will only be able to crack it locally it will not be able to relay it on the network to authenticate elsewhere",
        "and finally if you can put on put on network sharing on your net on your network infrastructure and rules to prevent uh unauthenticated SMB to to happen for example it's not normal if the domain controller connects back through a free tiering Securities to a machine in the DMZ in the DMZ on SMB it seems weird it should not happen that cr0 connects back to tier 3 with SMB or directly on the internet it happens as well I've left here a few links if you want to access it inside the slides the slides will be up on the blackout website later today and uh the all describe all all the APA works the extended prediction for authentication and they are really interesting if you want to check out",
        "finally to conclude this talk I want to remind you of three things on offensive defensive and research perspectives",
        "from the offensive side Microcenter PCS are a really wide attack surface which is a mostly overlooked and we should not over",
        "trust it and that's why we need to disable all the services that we don't use um weekend course authentications from a research perspective we can find uh RPC",
        "calls to automatically we can automatically find uh RPS equals to Quest authentications but it's it's only a matter of time until a new call is found because we still have to try them by hand to trigger actually the authentication with a proof of concept because we need to activate the services and finally from a defense perspective we need to disable all the services uh or the new services on Windows machines activate APA and put on network rules",
        "and filters to prevent course authentications",
        "thank you for your attention I hope you enjoyed this talk and if you have any questions I think we are running short on time so we you can DM me on Twitter on Barcelona thank you [Applause]",
        "[Music]",
        "[Music]"
    ],
    "VRmrn1zO2GM": [
        "[Music]",
        "thank you [Music]",
        "[Music]",
        "welcome to the stage founder of black hat Jeff Moss",
        "[Music]",
        "hey welcome to uh black hat Europe 2022.",
        "right on",
        "sorry for the construction out front I'm told we'll have it all fixed up by next year a little bit smoother and uh anyway I'm just really excited to be here I've been living in Singapore and not a whole lot of in-person events until maybe three months ago formula one came and then it was on like everything is booked all the time and it really feels like we're making up for lost time so for those of you who are new to Black Hat what I normally do is uh talk a little bit about who's here because we get a pretty impressive array of attendees from around the world um and the idea too is while we're most of us are pretty established in our careers there's a lot of people constantly trying to come in trying to figure out what's going on and so to help the next generation of infosec we do um scholarships and ways to allow students and other people to come here for free to really just get their toe in the door and learn a little bit about what what's going on and hopefully they'll stick around we won't scare them away we'll be welcoming and uh and then next thing you know you'll be working with new colleagues so how many people are here well we have people from over 114 countries",
        "that's a lot of countries I remember when we were happy if we had 20 countries represented now we're into the triple digits um and we have 94 scholarships that we gave away and so if anybody is in the room that got one of those scholarships please raise your hand somebody some yes excellent thank you let's give them a round of applause for",
        "it can be it can be somewhat intimidating having to apply for something like that but then you made it welcome um hopefully I'll run into you and I'm looking forward to any conversations like where you came from how you discovered us uh what you're hoping to to learn okay so I have a couple of comments before we I introduce our keynote Daniel today and in the past I've spoken a little bit about uh complexity and how",
        "we're in a situation where like by show of hands who here thinks your network or your environment is going to become more complex next year show of hands who thinks you're as complexes you'll ever be and it's just going to be a steady state of complexity",
        "like zero who thinks things are going to get less complex in the future",
        "two people three people so we're kind of in this ever complex outsourced third party",
        "distributed like unknown",
        "scenario and then on the other side speed",
        "is getting time it's getting shorter and shorter how long does it take to build a network connection how long does it take to detect malware how many people here by show of hands if you if you report how many people have on your dashboard something based on time right time to detect time to remediate",
        "right time to respond",
        "um now the interesting thing about time unlike complexity complexity is just forever increasing in my estimation just",
        "look at chat GPT if that's just going to make your life more complicated",
        "um trying to determine how much confidence confidence chat GPT had in each little statement it made it'd be great to have a bias score that tells you um but time time eventually can reach zero I mean it just can't keep getting smaller forever there's theoretical limits so with that in mind you actually have a little bit of control over time you can decide um how much time is acceptable to do a backup how much time is acceptable to test a backup how much time should it take to deploy a new employee to provision a new employee right you can control that you've lost an employee how long to to off-board the employee and remove them from all your active directory de-provision their laptop and all of that stuff right you can measure that and it can be on a metric and that is within your control",
        "but then you talk to people and you ask questions like how many people here but we all agree that control over your TLS certificates your your online web identity are pretty important by a show of hands who monitors certificate transparency logs",
        "and knows within a certain number of minutes or hours that your certificate might be used somewhere else outside of your control does anybody monitor the CT logs to see that your certificates are stolen and in use somewhere",
        "I don't think anybody",
        "um okay",
        "um how many people monitor say your uh dkim records for send mail your mail to record and this is when the giant email providers will say hey we've detected people trying to send mail as your domain but we know it's not you because you have a signed dkim record so we're just giving you a heads up here's all the people trying to impersonate you and you can use it to detect phishing attacks and you get those all the time does anybody monitor those male 2 dcom records",
        "okay a couple people that's good and so the idea is you have all these ways to detect something bad is happening to your Enterprise and you can determine do I check one today do I check once a minute how often do I update my malware signatures",
        "and the other thing we can do with time is we know that people have better engagement the less time they wait for an answer so for example if you file I don't know a complaint if you file a misuse or an abuse report to a company or a bug report and you don't hear back from two weeks chances are you're not maybe gonna file another bug report with them but if you hear back the next day hey that was great thanks for the report we have these questions let's open a dialogue",
        "well now you've got somebody on your side they know you're responsive the bug finder wants to interact with you right that time decrease",
        "lent to not only them becoming your Advocate they're going to tell their friends hey they're really responsive right that increases your security by just answering your email faster you don't even have to have the answer for them you can just say hey we got your email it's in the queue here's a number contact me if you have questions what I'm getting at is we can use time in so many ways to help our Enterprises and if you think about it a lot of harm that's done online can be reduced if we only act faster disinformation misinformation Mal information these are classic cases right the longer missed this and Mal information spreads the more harm it does anything you can do to reduce the spread or the amplification or respond faster reduces the harm",
        "the sooner you can remove an abuser out of your community you reduce harm right these are things that you get multiple paybacks by acting faster",
        "so I would hope that you for your Enterprise you'd have sort of a sheet and you'd say you know what this quarter we're focusing on uh reducing this timeline we're never going to get it to uh a day to do a restore of a backup but you know what if we get ransomed and we know we can store from backup in two days and we know we can string them along on the negotiations for three days we've got some options if our backup restoration fails we can still always pay their Anthem I don't advise that but you now have options but if it takes you five days to do the restoration and they can pay off their Ransom in three days all of a sudden your leadership starts thinking maybe we should pay the bad guy some money but if you can restore faster and give them some confidence around that you can take that money out of the pocket of the bad guy and get your Enterprise back up and running faster so anyway I just want you to think about the good that you can do by thinking about time and um",
        "and this is how how much it's pervaded our uh our industry um you know the ooda loop everybody's heard of the ooda loop observe Orient decide act the faster you can observe Orient decide or acts the faster you are able to spin that cycle the faster you spin the cycle the more you could be ahead of an adversary high frequency trading All About Time",
        "but we also reward people who fail fast you want to be a fast follower you want to move fast and break things",
        "um you know there's missed opportunity costs for being slow uh you want to be first to Market we generally reward people first to Market and um it's something again you can measure so if you have to fill out something on your performance evaluation put something on a dashboard I encourage you to think about time and ultimately you can use time to evaluate how well your company is performing how what's your retention rate how long do people stick around how much vacation time do you get",
        "so again while complexity leaves me in a very depressing Place thinking about it ever expanding time has got me pretty excited because everything I do that I've spoken about that we do I bet I can shrink the time again I bet there's 25 to 30 percent I can tighten everything up that'd be great whether I just get more alerts okay so think about time",
        "now it is my privilege to introduce today's keynote Daniel Cuthbert",
        "a man that needs no real introduction if you've been paying attention to Twitter he's highly contributory uh to the industry he one of my passions is classic cars so I love watching his work on restoring his classic cars reconstructing things that were sort of unreconstructable",
        "and then in the information security space he puts a lot of time in on the black hat review board and has been recently named a member of the United Kingdom's first cyber Advisory Board government cyber Advisory Board so he's got some pretty interesting perspectives and today he's been thinking a lot about how could we go about constructing a more defensible internet so with that in mind it's my privilege to introduce Daniel Cuthbert",
        "[Music]",
        "this energy",
        "we gotta reach we gotta reach good morning um it's very cool to see a lot of people here with legs we've not seen that for a while um I'm pretty much done with teams but it's also quite cool to see the freakers the hackers The Breakers the builders the malware writers the criminals the intelligence people the military people and we are in a really cool industry let's be brutally honest right if this was an accounting conference I don't think we'd have this but when I was looking at doing this Keynotes and you go through the initial phases of pure fear when Steve told me I was at brewcon and at first I thought I was being fished and I was like what like you want me to do what no that's that's rubbish and then you go through the panic stages and then you go through the Imposter stages which is something that has consumed me but I've got three bits of advice of how to do a keynote the first was by reg drink a lot of water if it goes really bad piss yourself",
        "okay next one is Imagine everybody naked and then finally grifter yesterday said they're all your friends oh my God this is really conflicting because I don't want to imagine any of my friends naked but I've got water all right so this could go either way but I think because we're friends we need to talk about the fact that we have a slight problem in this industry and the fact is is that it's a cool industry right I I've been very privileged to be a big part of this industry for a very long time coming up to nearly 30 years of hacking but at the same time I've started to see how my industry and my friends and what we're doing have moved away from that Core group of curious kids doing stuff on the internet and eventually the World Wide Web to how external forces are now taking what we're doing and kind of causing a lot of Havoc but at the same time like our industry is still seen by others as damn near cool like we've had amazing movies made about us you know War Games sneakers we've had phenomenal TV shows like Mr Robot we've had some pretty crap ones like that Disney inspired hackers thing but we won't talk about that because that was just a weird phase of the world but at the same time we've also had agencies agencies that love to listen not necessarily in a good way but they love to listen and watch and so Jeremy Fleming who's Like Chief spook talked about it at the conference the other month where he's saying that due to the current global economic situation",
        "there needs to be a drive to make the UK the safest place to do business and technology has all of a sudden meant that it's an area for people who want to be able to manipulate and do bad things but also a Battleground for values and that message resonated with me a lot because at the moment it seems that the hacking world this information security world like a lot of people are now interested but not necessarily in the best way so this year ncsc did their annual review and interestingly enough there were 63 ransomware incidents that",
        "warranted a cobra meeting and what that means is that serious enough that government's got to get involved and go what are we going to do about it and that kind of took me on a journey as to you know where are we going so I started breaking stuff in the early parts of the internet so in 1994 we moved to South Africa um back then there was about seven million internet users and it was a great period of doing stuff and interestingly I was doing some digging about my first ever email address which was Dan at pix.za it was a group set up",
        "an ISP that but basically allowed a couple of lines and it was really basic and they had two experimental features gopher and this thing called the World Wide Web which makes me sound like a right old fart but it was cool because that was my gateway drug that was the Curiosity thing that said hey what can we do here but throughout my entire career I feel we've become obsessed and we worshiped the altar of calc.exe",
        "and that's becomes somewhat of an obsession that has become rather abused now there's nothing wrong with the offensive World indeed it's been a big part of my life breaking into stuff it's fun popping shells and you know everybody did that but the reality is there's been a Sinister move towards this obsession with cap.hc",
        "now like Jeff said I sit in the blackout review board it's an immense privilege for me I get to spend a lot of time looking at the amazing research that all the researchers do I go to a lot of talks but there was one talk that was almost my come to Jesus moment and that was in 2017 by a good friend of mine however flake where he you know",
        "notoriously good at finding bugs reverse engineering did a talk where he said we're not really building a defendable internet and that talk really rammed home and made me look about what I was doing and what we the industry were doing now just a bit about these slides I decided to do a keynote I'm going to hand sketch all my slides I'm also going to use AI so everybody looks like an 18th century portrait some of them worked out really well some of them blame me the AI um I also because everybody in the industry was using chat GPT last week I thought what the hell let's do my Keynotes and chat GPT and bloody computer made it better than I could ever do so it's going to be an interesting ride but how fast talk concentrated on one main theme the fact of the matter is we are incapable of building a secure internet",
        "and I thought like this is interesting because I want to explore why why we've got some of the most intelligent people in the world in Synergy can we not build something that's secure now my dad's a traditional engineer builds mines and all that big heavy stuff and he's always joked at me like you not call yourselves computer Engineers but you can't build anything like my machine's always breaking like seriously stop calling yourselves that it's always sat with me I'm like but we can build stuff so I thought you know what I'm going to prove hell of our role we stand on the shoulders of many Giants in this industry he's one of them I'm going to be ballsy enough to say you know what halva yeah wrong we've rubbish 2017 was a long time ago now if we use the logic like dog years um so for every year a dog year has seven years I feel the same in the internet right so five years is a very very long period of time but what however talked about was that",
        "when we look at buying products and when",
        "we look at buying software and everything else the reality is is that we have zero input to make sure that those vendors those products are secure because we just don't have that power and actually we have no meaningful influence now if we step back so the early part of the well the late 90s nearly 2000s and when we were building a lot of the stuff one of my first jobs was I was hired as a security engineer there was no pen testing industry at the time but my job was to break stuff for the financial times and we were building fd.com now we had these cool things called Web servers well actually it was Lotus Notes but they had web servers and they had this new database that was completely unbreakable they told us it was really cool um and you did what most security people did back at the time you have networks we understood the networking problem so we needed to secure these web servers so what did everybody do they went out and bought firewalls this was like job compliance checkbox right pre the CSO role sort of being there until it dawned Upon A lot of people that well with the firewall you need",
        "poor 80 open",
        "so that firewall is a hunk of junk doing absolutely nothing so do you know what popped up out of that as the ninja reaction we need a web application firewall we need a product to fix the product that we bought that was really insecure but then as everybody knew that the web application firewalls were being bypassed at an alarming rate so now you have lots of problems so you've got lots of bits of plastic and stuff where you're trying to work out how do we fix it and indeed that was a big part of how a lot of the security tools in our industry grew up knee-jerk reactions to the fact that a product that you wanted to rely on was not built securely so we had to then go and get another product to pay for the product that wasn't built securely and hope to God that that product did the job and then this offensive Community came out and tore apart that product and it was like oh Jesus what what is going on here we are in 2022 and that problem still exists today and this was one of the main arguments that have I was saying is that we as a collective hell of a hell of a lot more power than anybody realizes because we can go to certain vendors to say why aren't you building stuff securely now a big problem with a lot of the products that you see in the market today especially security products there are two main things one they're completely trivial to bypass by any attacking QA",
        "they're also highly privileged with an immense attack surface nothing's really changed from the early 2000s now you probably start to wonder well surely we can build secure stuff and indeed we can we did actually see us like glimpse of that qmail was the answer to send mail are there any old send Bell administrators here",
        "it's a bit like PTSD when you've dealt with send mail it's back that an abusive partner that smacks you around the head all the time that was send mail right but it did a job it moved mail on it was never built for security I mean God knows anybody who ran sand mill anybody who found bugs in cinema anybody who wrote exploits for send mail and Pearl so what happened 2007 Dan Bernstein",
        "decided you know I'm tired of this like we need this email thing for the internet I'm going to build qmail qmail was a radical change you had the send mail.cf which was literally like how I imagined blind people drawing cartoons when it came to configurations it was the most complex thing in the world so nobody got it right which means your mail servers were open which means you had open relays which means if you were sending out a tax you just scanned the internet for open relays and Bob's your uncle and families your aunt and everybody's good and Dan was like no this is rubbish we can do better than this and he had three main ideas when he built said Mill air cubic qml one eliminate bugs",
        "two eliminate code three eliminate trusted code",
        "bear in mind this was 2007. what he meant by that was we don't need massive overly architected code bases",
        "get rid of the code on top of that because you've got lots of code you'll have lots of bugs so if you eliminate the code your bugs are reduced down third one eliminate trusted untrusted bits and this is something we're struggling with now for me like it all concentrated on the word bug I wanted to run out here like Steve Ballmer did in the early 2000s sharing developer developer developer and sweating a little bit but developer but with bugs I love bugs bugs have made my career I'm obsessing about bugs I love bugs I love how bugs are exploited I love how the fact that a simple bug could a nation and indeed if I go back through my history we were young and dumb and full of we were doing silly thing with bugs back in the day um I helped run one of the first exploit sites hack.coza and that was us sharing exploit code to anybody who wanted it because that's what you did right you found a vulnerability you wrote exploit code you shared it more amongst your small group of friends you then shared it with other friends you know THC tiso whoever was doing it then when you're bored you put on the website and you shed it off and who knows who cares what happened right because what's the worst that could happen with a bug that was the early 2000s and indeed that was our mindset because what was the worst that could happen there was only a couple of million internet users the internet was a passing fad like problem is that bug that bug has changed",
        "now has anybody here ever watch these amazing Nick Cage's Lord of War",
        "the opening scene it's a phenomenal movie the opening scene is probably one of the best for me in that it shows the life and manufacturing of a bullet from the raw material being created put into the shell gunpowder bullet loaded inspected twice put in a cabinet shipped all around the world dropped picked up put in a cabinet finally loaded another weapon and then the final shot is that bullet being fired and it hitting somebody for me this is a good indication of how our obsession with bugs are now where they're at because the bugs that we find the bugs that we find now are no longer just being shared amongst friends visits and giggles those bugs have become big money um I live with a friend in Thailand called The gruck Who did the infamous picture of him sitting in a favorite bar with a bag full of cash and Vibram Five Finger shoes which is very weird um doing an article where he was acting as Nick Cage's Lord of War an exploit broker because what happened around 2000 2007",
        "2008 was that these bugs were now big money whereas before you were giving away bugs for free because we were terrible at business you're now talking hundreds of thousands if it's a zero click iOS o day you're looking at a million and a half two million dollars you're looking at stuff that's now life changing because people wanted access to bugs why do they want access to bugs because they wanted access to data to control to manipulate",
        "and that goes back to what sir Jeremy said it's like now our industry has the",
        "potential with what we do to drastically change an outcome of how people think how people act and how countries operate",
        "and that's quite scary so I thought right I'm going to prove how well wrong I I think we're actually doing a lot here right so I looked at you know some of the people um this is Sharon the grouper and she did an amazing tweet that I really loved she said we're in this Highly Educated industry with a lot of ego we're so smart so trained so certified but for some weird reason it's Dave in accounting who's the failure he's the reason for the breach not us Dave was my number one line of defense and it's so damn true it's like Dave in accounting you're an idiot right you clicked on a link like how dare you click on a link like what is wrong with you you're sitting on chairs right now have you notice the chairs have not Fallen I don't know if you're holding them wrong but it's not your fault if the chair fails right this is the mindset of our industry at the moment and that we become petrified of fishing",
        "now fishing is nothing new it's an incredibly old tactic you know I don't think there's many people in this route have never done it before but for me fishing is a systematic problem of where we're at in this industry and that you should be able to click on something and not have it push a reverse shell out to somebody else is it that hard to ask but the problem is rather than us saying to the manufacturers hey you know seriously Microsoft like why is this why in God's name we got macro as an office still in 2022 it's a you know what we need we need fishing training we need AI ml we need next-gen EDR we need all these products to fix the problem that Dave and accounting is going to do something that he should be doing clicking and stuff you're like oh my God what is going on and that kind of LEDs us into the problem we're at today so this is Ryan Noreen great person to follow on Twitter he tweeted um a month and a bit ago unfortunately this tactic this stats now changed is that there was another ode out in the public it was the 47th in the wild o day discovered so far in 2022",
        "and it seems like something's kind of shifted now indeed we did see a shift with covert whilst most people were baking sourdough and doing everything else we saw especially in the review board a lot of people tearing apart products and looking for bugs because what else were you doing right but we also saw criminals do that now the queen of all ode is Maddie Stone like I I love Maddie I really do she does amazing work and she started to really look at what is causing a lot of these odors so to give you some stats in 2019 32 zero day was spotted in the wild so Peak lockdown 2020 30 okay it's gone",
        "down we're doing all right 2021 over 70. you're like damn okay that's a lot of sourdough that wasn't baked problem is I feel",
        "we've become almost too fixated on odors",
        "o days are cool there's Oda protection everybody talks about oday like they've met this magical dual-headed monster before when in reality o days are not the problem because it's the lame attacks that are still getting done and indeed we've seen that because for some weird reason the last five years we made it okay for a bunch of Adidas wearing gopnicks to hold the world to Ransom with ransomware",
        "and for me that blew my mind because the reality is they turn criminality into such an amazing cash cow where even smaller groups are making 100 million container evil they were so ballsy they were dropping a million dollars as collateral on criminal forums to say come and join us we want insiders estimated a billion plus",
        "ransomware is not lead ransomware doesn't use super secret oday doesn't need to it uses phishing it uses techniques and tactics that a lot of people will talk about on YouTube channels they'll talk about with threat intelligence reports they'll talk about with tools that people release because they're very good at watching and listening and what Maddie found was that",
        "in this year alone a total of over 18 exploited bugs in the first half of 2022",
        "were there because they weren't addressed properly by the vendors fixing those bugs so now we've kind of shifted the process here right we've now got the fact that we're arming criminals in an alarming rate that Bloody Dave and accounting keeps on clicking our stuff you've got vendors not fixing stuff over here so you're like okay it says what's surely surely there was like stuff out there that maybe wonders about this and there was lf1 in 96 did an amazing",
        "paper smashing the stack for fun profit I'm sure most of you have read it it's 26 years old um but for more than a decade a big chunk of the vulnerabilities out there have been memory safety vulnerabilities",
        "to like okay that that's part of our Kryptonite we suck at doing stuff with memory right surely there's something we can do I'm sure there's a product out there that can fix it so if I look back at the last five years since have I did the talk I'm like oh okay this is not looking good so I thought fine last week everybody was using chat GPT and make no mistake I think chat gbt is amazing it's quite scary especially when you hear like police departments like San Francisco want to Armed dogs with initially guns they did clarify that to hey calm yourself down we're not going to put guns on our robot for crying out loud it's just gonna be explosives",
        "yesterday they said that might not happen thank God but imagine the time when you've got a robot with explosive guns that now makes use of AI to determine hey look at a crowd and decide if that crowd's doing bad things not that far-fetched anymore so I thought right I'm gonna ask chat gbt let's let's see if I can build a keynote so I asked a couple of questions one do you think we'll see a secure internet I swear to God it laughed at me I was like okay it was like highly inconceivable there needs to be a lot of factors that come into play it's like oh damn you so I was like okay next question do you think vendors are ever going to make secure products",
        "potentially that use the word potentially and it said but I needed vendors to invest in security invest in memory safe languages invest in training so I'm like oh Jesus we can't even get Dave in accounting to not click stuff how are we going to do this so if I had to do a little scorecard first up I'm like okay I I think I agree with however we're not building a defendable internet okay it's going to be right on this one so I thought all right I need to go and ask friends people I I love and trust and respect I'm going to ask the people out there the first one is Jeff AI sort of worked with this one now Jeff's been a big part of my career we were chatting backstage my first Defcon was Defcon five and Jeff built a home",
        "for the weirdos the Curious the the",
        "people that generally society would look down upon in a way he was laughing now huh um but he built this community and for the first time ever when I went to Defcon I was like my God I found a home I found a place that Alexis park where you could do whatever you wanted to do and indeed the early days were like that it was also a bit odd you know if you've ever been to Vegas in the summer wearing full latex by the pool is not advisable I'm just warning you I didn't do that a friend did but I said to Jeff like what are some of your concerns about where we're seeing the internet go and he feels there's a battle ahead right and it's eroding net neutrality and what he meant by this was you have all of a sudden a lot of corporates defining deciding where your data is going to go how it's going to be used right the cool things that you can do if you play in their garden and there's a lot of centralization and data silos happening and that goes against the nature of how the web was built with certain open transparent usable",
        "so I was like okay this thing like you know on the one hand we've sort of got environments that might be secure but then they're moving away from the fact that the internet is not what sir Tim wanted okay so I thought right I'm going to get somebody else somebody partner in crime who we did a lot of stuff with dinner dozovi this is the best AI one because he honestly looks like an 18th century lothario um Dino notoriously well known for a lot of exploitation methods the karma attack in 2005 was his like you know his blood ran with offensive type stuff but now dino works on the defensive side so I was like do you know like what's the best thing you think has happened in the last five years when it comes to security it was like the cloud straight up the cloud done right",
        "um he gave an example AWS came out with guard Duty guard duty is beautiful because it actually tells you when you've done something wrong when you've got a configuration problem now if you compare that to on-prem stuff such as ad or exchange any exchange administrators",
        "in the room there's like one no because they're probably all drinking and dead because like if you can't manage exchange but",
        "the reality is is that the cloud done right yeah it actually offers a lot of good security I don't know we've got these age-old jokes always just Another Man's computer I'm like move on seriously um good clouds good security",
        "but here's the problem we're now back to that data silo we're back to that Sovereign Network and Dino's feeling is like you know the average person has moved more towards a safer Zone when adopting the cloud than they would do normally I was like okay that's that's really interesting so the next person I want to speak to was Debbie ottenheimer Davey is the VP of",
        "trust and safety at intra interrupt interrupt is Sir Tim's new company that's looking at building a better web type thing and he's done a lot for trust and safety over the years so it was an amazing chat with him and his biggest concern was that if we look at CIA not the agency you know the other the other thing um we've sorted the confidentiality part to a degree crypto is good right we've nailed that sort of we've sorted the accessibility part the one bit that's really really hurting us right now is integrity you go back to Sir Jeremy's comment yeah the web has become a Battleground you know we saw a couple of years ago where fake news became part of the normal mainspray well this information has been around for a long time so psyops but that Integrity part is really really hard because a core principle of the internet was built around the idea of ships ships steam moving stuff around and we're not evolving and pushing as many new ideas as we should do his other concern ironically this was before chat gbt came out was that you know we do need to start talking about ethics of AI we do need to have something like that and that's a big concern because as these systems are being built and as we've seen with chat GPT it can do some amazing things it can build really really convincing fishing lures so one of the biggest problems with fishes which is great from a detection perspective is that English might not be their first language so we can detect the problems with the language or chat GPT just made that really miserable so from a defensive side oh God so are we building the tools that makes it easy for the criminals I then said right I want to talk and look at what Bruce Bruce and I would do Brewster was in a really interesting one and he was like the reason we're not building secure stuff is because there's no incentive to build secure stuff I was like God you're right and there isn't why would I build a secure web application firewall VPN type",
        "thing customers are not asking for it and even if they are and I have to give it to them right because so what if they get breached we always thought that getting breached might impact a company enough to change their ways unfortunately that just doesn't happen it's a blip it's a PR control message it's a keep your head low it will go away and we can go from there and he also gave me an example one that you know resonates with me is that if we look at pajamas now I've got two kids lost diabolos they're absolutely killing me um but you know they have pajamas in the UK there are acts around and regulations of how you can sell pajamas to children it's called the nightwear safety regulations Act of 1985. I read it my Friday nights are wild I tell you but it basically put about agreements and regulations that say the staff can't make your kid turn into a marshmallow on fire it's like genius",
        "but we don't seem to have that with all of our tools so Bruce is like well it's no longer a tech problem but an incentive problem and I was like okay this is giving me a lot more background so the last one is Alex Bloor um he's part of the London internet exchange down the road think of him as the core fabric I said to Alex like you know what do you think has been the biggest shift in the last five years from a security perspective and it was like CDN networks content delivery Networks why because we've moved away from the data Silo that Jeff's worried about and we've made it so that even if Netflix sort of burns tomorrow a lot of the tier one isps will still have your content you can watch I was like this is really interesting because you've now moved away from doing that and maybe that could be used to do other things like security so for example I grew up in South Africa and the African subcontinent data is really expensive what's the first thing that people do not do with their data bundle apply security updates",
        "because an iOS update is what 700 to a gig that's an expensive thing but now imagine you had a CDN at your local base station where you weren't charged to do security updates okay this is an interesting thing that's being built then he also looked at bgp now I mean who here hasn't done a bgp hijack I mean hell it's what you did when you were bored well massive problem how do you solve that rpki it's now looking at using encryption to sign bgp messages you're like okay wow so we're actually doing stuff and all these chats were really good because they gave me an idea like you know what yeah two fingers up to you however we are we're building a defendable internet sort of then I thought right I'm going to take it one step further",
        "looking at like Jeff's comment resonated with me a lot gated communities now I grew up in South Africa I left the UK went to South Africa during apartheid very very strange experience but one of the ones that stuck out the most was the incredibly wealthy people didn't like the commoners walking past their Road this was a public road so what they did was yeah somewhere we're going to put two gates on the end the one there and on there private Gates on a public road to stop people walking past their house and like when you see this for the first time you're like WTF like how do you eat wealth and for me that sums up a lot of what we're seeing with the internet today right you can have as much security as you want as long as it's now wall Garden you want secure DNS come over to cloudflare you want a secure mobile operating system come out to iOS come over to Android Google pixel maybe Samsung right you want safe browsing Google Chrome",
        "do you want to set up your own mail server because you don't trust them good luck to you out of Interest anybody here in the last year tried to set up their own mail server with a domain and have other mail servers accepted",
        "two people I bet it didn't go as well as you thought it would be because it's really hard today and for me that's hard because we did all run our mail servers right because there was no Gmail I I've got one of the very early Gmail addresses and let me tell you the spam I get from that is fascinating um but it's like before then you'd have your own domain you spin up a qmail server because ain't Nobody Got Time percent mail and you know you did the kind of stuff well you can't really easily do that today so you effectively have a safe internet for those who can afford it because lock-in means security",
        "that's great in the western world but I think a lot of people in technology forget the internet was meant to bring everybody together so we reckon there's what six billion internet users at the moment there's still a lot more out there the moment you venture outside the Western world people that cannot afford a 1400 pound iPhone 14. you realize that they don't have that chance of saying you know I want to use the latest and greatest phone from Google they have to go and buy a cheap Android device that may be running Android 8 which has been end of life for a very long time but it's 150 dollars Japanese probably thinks like that's not that much but it is a lot of money so inherently they're now using an insecure device that's not supported which means they're outside of the gate they're now the commoners that are having to walk around these special Gates that all the big players of the internet put up and I don't feel that's fair so I'm like okay so how do we get around this and this is where the younger hacker Daniel be looking at me talking about government and regulation that's a government agent by the way with a pink shirt with a camera jacket and I thought you know well actually there's been a massive shift in the last couple of years and a good shift now before everybody starts throwing stuff at me um Bitcoin I would say would be advisable but that's tanked so whatever you want to throw regulation stifles Innovation right government is not cool government people are not cool and I'm sorry with all the government people here but you're not cool right but the reality is is that for the last 20 odd years we've all been having House Parties when mum and dad are away and we thought we were cool but unfortunately we posted stuff all over the neighborhood and lots of people came and suddenly did something your dad's sock draw which is really disgusting and Mum and Dad came home now and they're like I'm sorry Like rules need to be coming down now the reality is as much as earlier Daniel would hate this we do need some form of Regulation and bills and acts to clean up our Act because we can't do it on our own anymore we tried we asked our vendors to make stuff in a secure way it didn't happen some did most of them didn't we're still reliant on Dave not clicking that Bloody email so we don't get hurt and there's actually been a lot of shift in regulation and I spent a good time on this as Jeff said one of my proudest moments for the career is for the country that persecuted me and arrested me I'm now sitting on a government security cyber board which I think is just interesting but we've also seen a big shift at how we look at government agencies so the first is Sissa for anybody pronouncing sisa like wielded no I was told Wrong by Jen Sissa sister's really cool all right because for once they're actually quite approachable they're not your typical government suits you know they're made up of us really people from the industry they're trying to fix big problems of the internet and you're like wow okay this is quite approachable maybe I could actually work with this in the UK we've got dcms the department for digital cultural media and Sport who I'm also working quite closely with doing very interesting things and as a result we're starting to see the trickle-down effect um gdpr DPR has been around for a while anybody here like gdpr",
        "three five you should love gdpr do you know why gdpr is amazing it finally made companies realize",
        "you need to understand what you're doing with that person's data because before nobody did nobody cared I am so sick to death of my data being left on the dirty internet toilet walls because that's the reality nobody cared about my data I cared about my opsec my security but why would a company care about that gdpr came in and said you're not dealing this properly you need to understand how to deal with it and there was lots of huffing and puffing but the reality was security went up",
        "because they had to because they didn't want to be fined again it's an incentive problem as Bruce said all right so it's working um you've also got a lot of other things so the US Cloud act which is questionable so the U.S cloud basically came about because law enforcement wanted access to some data that was held in different data sovereignties and you need some better way of doing it now you also have some really bad legislation and one of them it's the elephant in the room that I think has got to change is the UK's Online safety bill it's the premise is good right we want to try and make the internet more secure the reality is I don't think they spoke to anybody with a good understanding of how encryption and putting backdoors encryption could be a bad thing right and for me that's where the safety Bill fails down they expect ofcom to be able to be the regulator to look at how you are typing stuff and stop you putting malicious stuff or bad stuff on the internet anybody who's ever worked with encryption before knows that that just is never going to happen so you do have some bad regulation but for the best part you have some good ones um I think one of the cool things about some of this regulation is that we're starting to see it trickle down into normal life one of these is the Cyber resilience Act cyber resilience act basically says to a lot of Manufacturers especially iot",
        "you had your fun but it's time to make stuff a little bit more secure and it's kind of a mixture of essential cyber security and vulnerability handling requirements so little things like when you buy a washing machine sorry um there's a sticker that says this thing will not catch fire which I've always thought quite useful when you have appliances like that you know like a toaster exploding is a really bad thing we need the same thing for iot I'm on an obsession at the moment of iot at my house with sensors because I'm odd like that and I want to know that that esp32 sensor in the kids room is not going to combust and do stuff this is where the CE and the Cyber resilience act could actually start changing a lot of the the ways that we're doing stuff",
        "and part of that is I've got experience with standards so for 10 years I've been co-author of the OS asbs standard and the reason the asbs standard came about was we were so sick to death at the pen tests that were happening at the time because they were really bad like nobody knew what a pen application pen test was so like well let's build it in teach people how to build secure applications people how to test it and we started to see the results you're like okay this can actually really work",
        "and then you've also had amazing bills go through so this is David Rogers David Rogers has pushed through the product security and Telecommunications infrastructure bill it's a big name and the things that that bill is now looking for is that it's Banning default passwords great massive step",
        "it's bringing in the idea of vulnerability disclosure which for anybody who's ever tried to disclose a vulnerability in a cheap iot product knows it's almost impossible because they don't care and it's also giving transparency and software updates Now iot is really interesting again it's an incentive problem we the consumers do not want to pay a lot of money for stuff we want cheap as chips the first casualty in that is security",
        "so vendors don't put Security in because it's cheap right so we have a bit of a thing here where we need to do stuff the other big shift with government is that we somewhat saw law enforcement become badasses like this is the Dutch police logo you talk about nation state apt Cruise you ain't see nothing more than the Dutch when they get going and there's no more smoke on a pancake it's like whoa they are just doing stuff when it comes to criminality where criminals now know if the Dutch are getting involved stuff's getting ugly we're starting to see law enforcement get a lot better right and we need that last week the I SMS thing was taken down that was mostly used for smashing style attacks great because it impacted a lot of people combined law enforcement effort smack that down right we're starting to see a lot of this movement but out of that regulation we're also starting to see some changes from a lot of the big tech companies so for example Android anybody here running Android 13.",
        "a couple of people what's cool about Android 13 is the adoption of memory safe languages like rust so finally 26 years after lf1 pushed it out we're starting to see vendors go do you know what maybe memory corruption memory safety",
        "memory handling bugs aren't exactly a good thing so if we adopt a more secure language we can start eradicating big chunks of bug classes like wow",
        "wow maybe this is actually starting to happen so now if I look at all that I'm like okay you know what man however guess what two fingers up to you son we are literally we're doing this we're so close and then it brings me on to the community",
        "this is awkward um I don't know if we should be using Twitter anymore or if we should be going to Macedon so you do both and it gets a bit awkward but for me this was the community thing right the community I feel is where we can make the biggest impact like I said at the moment we're a bit obsessed with Oda we're a bit obsessed with cap.exe what we are doing wrong is that for some weird reason we are arming criminality like never before",
        "and we're doing so with the information we're sharing which on the one hand is very good we're doing massive dissemination of campaigns we're teaching people this is what a bit of malware does this is what it looks like here's it in the parity copy of Ida you know everybody's happy we're all good the reality is criminals are looking at going that's really useful because you've just given me a free QA session so I can now understand how you're detecting me and how I can bypass that now this is very much a knife story a knife can be used for good and evil in this case we needed a little bit more balance",
        "one of the bigger problems I've got is seeing the impact of such research I used to run a company called senseburst with Dominic and I like him a lot and he tweeted this last month saying listening to a heart-wrenching story from a business owner and what it was like as a business and as a person to experience a ransomware attack it makes it hard to feel comfortable in unfettered offset releases when you see the human impact of how it's used I get this is controversial my world has been offensive for a very long time in the security sense but the reality is is that there's so much money to be made now we are arming the wrong people because you never see the blue side of things you never see the detection methods I was talking earlier to two colleagues very very talented reverse engineering colleagues we're talking about Patch Tuesday Patch Tuesday is literally nerd Valentine Day for people in security research because when that comes in you're excited and you're getting it you're using bindiff and you're looking for the bugs you're looking for anything above in a score of eight and you're like yep gotta make some money Microsoft has that power to say you know what his past Tuesday we've done the same thing here's the detection strings we've put that Central so if somebody does do this we're one step ahead of them this is how you detect them when threat intelligence companies",
        "take the latest campaign and can I just say can we stop giving goddamn criminals logos and stupid mascots",
        "they are not nice let's make it so that they're on ice because by normalizing them we're normalizing criminality and I think that's a big thing so that goes back to okay where are we going with the web and I have to look at sir Tim berners-lee because the web is his thing right and you know on the 25th anniversary of the web he did a TED Talk and I urge you to look at it where he talked about the need for a Magna Carta for the web in that he needs and he wants a Bill of Rights for the next 25 years of the web where the web is open transparent",
        "and secure and I fixed that last bit and I think that's where we as the community can actually start doing stuff",
        "one of the things he's looking at is solid so solid has been around for a while now the idea behind solid is that to move away from the data sovereignty thing is that we can control our own pods we become our own data custodians and in doing so we stop having our data being put on toilet walls all over the internet because we have better control gdpr is trying to fix some of that but I think the idea behind solid is an interesting one and if you apply to the context of security we can also start seeing how that might actually benefit developing countries countries that don't necessarily have the money for security",
        "so if I look back to the community side I think how have I was right we aren't building a defendable internet because right now we're favoring the red team over the blue team and I think that needs to change and for me that's where we almost kind of now need balance we need an equilibrium we shift I really want to see everybody here do two things over the next two days and this is where I'm going to paint the big Target my back from vendors we've got a big vendor Hall I would like you to go up to every single one of those vendors and ask three very hard questions one what are you doing to make the internet more secure they're going to come back with marketing stuff I want you to tell her I say no what are you doing in your products how are you making your product secure are you using sast are you adopting s-bomb do you have a full understanding of your supply chain what tools are you using do you do threat modeling ask them these questions because we as a community should be doing more of this when it comes to purchasing when it comes to buying when you see defense offensive tools come out ask that person what are the detection mechanisms you're giving away as well the more we start normalizing this the more we make life more miserable for criminals criminals that I hate to break it to everybody are abusing all of us because with the cost of cyber crime going up that means your bills go up because companies are going to pass it on to all of us so that very simple bug right at the start that cool zero day that you found and you pushed it out to GitHub as a park so I'm just going to weaponize that so maybe release it as a pop but releases detection methods as well and that makes me come into finally a question are we insecurity in the business of solving security or we just here for the ride",
        "so I wanted to thank you very much um like I said we've got lots of cool talks over the next two days the review boards spend hundreds of hours and I'm not joking looking all these talks and we're trying to pick the best talks that excites all of us so enjoy the talks go and annoy the vendors please just don't say oh yes that Hill Daniel sent them and uh welcome to blackout and thank you very much",
        "[Applause]",
        "[Music]",
        "[Music]"
    ],
    "cQtycgYnDig": [
        "foreign",
        "everybody I'm Victor I'm a PhD",
        "researcher with varai University type Amsterdam",
        "um and I'm Fabian and we're going to be presenting to you a talk about stock unwinding so",
        "specifically we're going to be talking about control flow hijacking control",
        "flow hijacking means telling a program to execute stuff that it didn't do before or it shouldn't have done the way it was written so let's take a quick trip down memory lane where we have a stack of a function and a function calls another function the return address of where execution will continue after that call Goes On The Stack if we have a stack buffer overflow we can overwrite it and then we can make it go somewhere else so that's classical psych performance flows um another way that so this this was addressed by adding a random cookie to the stack and that cookie gets protect protects the return address so if we overflow the cookie gets changed and the program dies",
        "then another way another mitigation was",
        "added to that where every return address goes onto a separate stack so every time you have a return address on the real stack it also goes onto a shadow stack so these are Shadow stacks and other mitigation against stack by 4 flows another popular exploitation technique on Windows was exploiting structured exception handling where there is a linked list of pointers to exception handlers on the stack and if you overflow those you change them you can control them and you can hijack them that way and this was mitigated by adding a an allow list of allowed handlers and with all of these mitigations if our anode is not on the list we die so with all these mitigations stack buffers are resolved problem that's our talk thank you for listening any questions",
        "I have a question for you yeah go ahead are there any exceptions to these mitigations that's",
        "good thanks for asking that yes",
        "um so now to what we will be talking to you about this time uh we'll be talking to you about the technique that we call Chop or catch Handler oriented programming job exploits the unwinder",
        "that handles exceptions in programming languages such as C plus plus or other compiled programming languages that do exception handling and okay we confuse the unwinder so picture in a nutshell can you explain what the unwinder is So Def and why there is a piece of code so as Fabian was telling you in a low level in programs written in low-level languages when you get an exception uh this unwinder kicks in and decides which exception Handler will treat this exception and with our technique that we call Chop we can exploit and hijack the",
        "unwinder to execute a different Handler now at the beginning of the talk we thought that there are different control flow hijacking techniques but they are defenses for them unfortunately these defenses do not work on the unwinding path which makes job possible we also have a paper coming out next",
        "week on this topic so if you like the technique if you like the talk please read this paper as well it's under embargo until the 10th of January",
        "um but you can find more information about about this you're gonna see an icon you see the icon in the the right top Corner uh every time you're going to see a slide with this know that there's more on the topic uh uh in uh in the paper",
        "now let's see if the gist of what we're going to talk we're going to start discussing a little bit on how the unwinder operates to see what the problem with it is uh then based on the problem we're going to build with you the the chop technique we're going to show you how it works and how you can gain further control uh while pulling of this attack then we're gonna show you more sophisticated ways or or techniques",
        "that you can use leverage this chop attack to pull",
        "off more stronger attacks after which",
        "we're going to see the likelihood that if if indeed a series of issues by looking and analyzing popular binaries",
        "from Debian after which we're going to",
        "conclude the the stock with a real world exploit of a bug with a known TV",
        "all right so let's take a look at what the sun Winder does under the hood so looking at an exam piece of example code where we have one function which with a try catch block and that calls another function again the return address Goes On The Stack so that's where execution would resume if an exception isn't thrown however in our this case our function bar throws an exception and the unwinder is the piece of code that transfers execution from the throw statement to the corresponding catch Block in in a scope above on the stack so it does that by looking at that return address and comparing it to an exception table within this exception table we have called site ranges which roughly correspond to the current to the try blocks then there is some metadata about which types of exceptions are are handled and then finally there is a landing pad or the Handler that gets invoked for this specific call Site range the specific set of exceptions and then that's where execution continues so let's look at an example to make this clear here we have three functions are the stack for three functions uh and the last function in that call chain throws in a bad analog exception so the unwinder will consult the exception handling table it'll start out by looking at the return address of the first function the one that through the bad allocation exception in this case this return address is not in the table so the stack on Winder will say nope I don't have a Handler for this one let's continue unwinding and then from there on it'll look at the next stack frame it'll look in there it will find that there is a matching entry in there but this is so we threw a bad allocation exception but there is an entry for a Handler that handles a runtime error so exception type doesn't match we continue unwinding and then lastly we do find a matching return address and in the exception table in the corresponding call Site range in this case the unwinder says yes we found one and this is where execution will continue so that's in a few steps basically what the unwinder does okay and that brings us to how we can exploit this because it uses those return addresses",
        "okay so coming back to this example when this code will get compiled the com the compiler will generate and enter in the table for this try cache block and uh when bar will throw its return address will match the qualified range of this cache Handler so it's going to execute this app but what what happens if we",
        "overflow this return address and write something else there uh well let's take a look at the simple example here we have a simple function called the the caller will catch the exception the quality will throw the exception now in normal execution when nothing goes wrong this location will be caught by the according Handler here info now if we overflow during the execution",
        "of function rule",
        "and then we overflow the return address and then through the exception and we overflow the return address with some address within the range of the cash online in bar then we will trigly unwinder to execute this this sketch",
        "Handler um but okay so what so we redirect control but these are valid handles so these are written by programmers and programmers always write safe code right uh so you can't do anything with this",
        "without without something else so let's talk on what can we control when we redirect to",
        "to a different end and let's use the same example we have a",
        "caller that catches uh collaterals but",
        "the color now also prints in the catch Handler uh variable on the cooler stack",
        "frame which is initialized to 23. now in normal execution when this exception is caught the color will print 23. what happens if we overflow function full this is so functional here",
        "and we redirect to 100 in a different function that does the same thing prints a local variable well you might think that okay it's gonna print 42 well it's not going to print 42 it's still going to print",
        "it's still going to print 23 because",
        "even though we change the Handler we're still operating on the color stack which is function form so in other words essentially when when you're going to overflow uh the frame pass the return",
        "you can control all local variables which are used by the handle during its execution",
        "now you may see that okay then the chop technique requires you to overflow return and then go past this return to control local variables if you can't do anything when it sort of happens that for Simplicity some of these local variables are stored in quality saved",
        "register during the color execution and when the coil will call the vulnerable function it might spill some of these registers on the volume function frame",
        "so",
        "um when the unwinder kicks in it knows that",
        "some of these registers are on the qualiframe and it's going to unwind these registers as well so you might essentially have enough control just by overflowing the cauliflame and reaching the return in order to take the unwind way yeah so with that we basically saw that you can by overflowing this return pointer we can redirect to a different exception Handler and we can control the local variables of that specific exception Handler let's take a look at how we can abuse this technique to craft some more interesting exploits so again we have a stack perform flow then we reach a throw after that and then finally we execute a viable Gadget or a Handler that will that we can abuse so let's take a look at what kind of handlers that we can abuse this way so we",
        "one of the most important things that we need to realize at this point is that the handlers and the throw statements don't necessarily need to be part of the code of the program that we're execute that we're exploiting for example you could have throw a statement that's buried far in one library and you could divert execution to Handler in a different Library so it the if even if the program that we're exploiting doesn't do any exception handling it might use libraries that do and there is one library that is used a lot and we found a really really good Handler in there and this is this is part of the standard C plus Library and this is part of the code that terminates the program when no Handler is found and this ironically this part",
        "that that terminates the program when there is no exception Handler for our unhandled exception and that terminates a program on there itself does exception handling so there is a try catch Block in there not going to go into what happens in the try block the important part for us is the catch block because this catch block calls terminate with a pointer or a local variable and as Victor explained to you just before if we control right the if we control the variables of that stack frame because that's that comes from the stack we can overwrite this pointer",
        "and then it goes on and calls terminate and invokes that Handler and the other important thing about this is It's a catch-all block so this means it matches all exception types that's what the three little dots in that catch says so this is a universal Gadget that's why we call it the golden Gadget because if you can go on there GG all right so another interesting technique where we can use the chop requires us to understand how stack protectors are applied we talked a little bit about stack protectors at the beginning of the talk but let's look a little bit dive a little bit deeper so this is the the function path from lvm that apply stack protectors to functions now you may see here that before you insert the stack protector you check if you actually need the stack protector now let's see what happens in this",
        "request a protector it's a lot this function has a lot of comments so don't read it I hope you don't see it through the tldr I'm going to tell you what the function does so",
        "it checks if a function either explicit",
        "equals a local either",
        "defines two different programming constructs a buffer on the stack or has an instruction that uses the address of local variables",
        "normally known as others taken variables",
        "with if we don't have these prerequisites a function will not get a",
        "stack protector now what can we do with this information let's look at like uh like an uh an",
        "example so consider the call graph of function that applies to protectors in the epilogue you see the stack uh the canal the cookie check emitted by the compiler uh if we overflow the return address we also overflow the canary so the function will abort now consider that the function also handles exceptions we have a Handler for it and there's a throw that's been cut by designer well when the Handler finishes Vega cushion it's going to flow in the epilogue with the function so if during the execution of the Handler we want to overflow the stack even further to do a return based uh control fire jacking we cannot because the cookie compare will stop us but what if we have another Handler uh in a function that doesn't have any aloka doesn't have any buffer no address taken local variables and therefore no",
        "cookie and we use a chop technique to over to regularly control to defend where in this scenario if the Handler gives us the possibility we can further overflow the stack and do a technique that we call pivot to rope in which we require initial return based hijack to pull off the technique and here we can actually do this because we don't have a cookie compare",
        "all right so we just saw that how we can evade the the mitigation that we we showed in the beginning are there any other ways we can exploit this so let's look at a couple of functions again called chain of three different functions the first function Foo has a try catch block and called bar bar then called baz and baz throws an exception in this case as we have seen a couple of times now the unwinder will transfer control flow from the throw to the catch any code that is after buzz after the culture bars will be unreachable it will be skipped there is an exception to this though um if we have an object on the stack and if that object has some kind of destructors that need to be called so some there's some cleanup code that object's lifetime ends at the throw so it will need to be cleaned up the compiler will do this by emitting a a cleanup Handler for the cleanup code for the destructor that invokes this Destructor",
        "after that's done execution will continue and continue at the to the next point in the in the unwinding chain and it'll continue unwinding up to the catch Handler so in this case the destructor will be run on the unwinding path it's these cleanup handlers terminate not by",
        "returning they terminate by calling a function called unwind resume which then invokes the unwinder and tells it to continue unwinding",
        "so",
        "if we overflow we can't just go on to catch handlers we can also Target these cleanup handlers and that gives us a couple of interesting Primitives so cleanup handlers have the interesting property that because they are destructors they're often call cleanup code that means manipulating Heap state that means freeing variables",
        "if we can Target arbitrary freeze because the variables that get freed are local to the cleanup handlers that means that we can also call arbitrary freeze in the program that's a really powerful primitive in exploitation because it allows us to trigger use after free vulnerabilities",
        "you can also because unwinding resumes after a cleanup Handler you can chain multiple cleanup handlers together and then at the end of the cleanup handlers return into a catch Handler that",
        "terminates your chain so you have multiple unit handlers and then you return to account shutter and that's where you you resume execution so on the right here you can see the a reverse engineered cleanup Handler from a binary this is also lip standard C plus and that in this case has an arbitrary free Gadget so it calls the delete operator which is free and then it resumes unwinding and you have a lot of those as we'll see later on in the talk okay so to understand other ways that we can",
        "trick the unwinder let's look a little bit on how signal handling works so when a process receives a signal the operating system will stop this process and it's going to decide to either kill the process or execute the signal Handler now what happens",
        "if we execute the Cena Handler well before the signal handle executes the operating system will create a special frame on the the stack of the the process it's called a figure frame and it's going to point the return in this Frame to something that resembles a",
        "special fifth call call figure return",
        "now after the signal and in this Frame",
        "we have the state of the program just before doing the signal so we have all general purpose registers here after the signal",
        "finishes the fifth config return will",
        "restore all the all this register from the thing of uh from the secretary frame however when you execute a signal you can also receive an exception so because the exception happens before the Cisco is called the unwinder needs to essentially do the same thing while encountering a secret time frame and is to restore registers from this Frame however the unwinder does not know that",
        "it a signal actually happens so it",
        "checks this return for a special op code to see if this this exception happened",
        "during signal",
        "so an attacker can essentially overflow this Frame put a return that points to to a sick return function and override these registers",
        "and then throw an exception now",
        "this is essentially crafting a fake secretary now the unwinder",
        "restores registers one of the registers in the same is the RFP so the stack point so when the unwinder will unwind is registered we have the possibility to Pivot the stack to an attacker control location another register on the frame",
        "is the rip so you can essentially trick the unwinder to execute a different Handler by crafting this fake Sig return",
        "frame",
        "all right so that was a lot let's look at the techniques that we that we just saw so we started out by showing that we can divert control flow using a stack buffer overflow to a specific different Handler so this was a cleanup Handler or catch Handler diversion so",
        "invoking the wrong catch Handler for that exception the next thing we can abuse this way is so for example one example of that catch Handler would be a the golden Gadget in standard C plus plus but we can also divert to catch handlers or handlers that don't have stack cookies enabled so that allows us to to Pivot to Rob then we can chain",
        "cleanup handlers to groom the Heap into a state where we can do use after free Builder abilities and call arbitrary freeze and then finally with all of that we can also craft Sig return frames and these Sig return frames allow us to Pivot the Heap to other locations and control all registers that as we unwind",
        "so these are a couple of powerful Primitives but they they need a couple of prerequisites and with that let's take a look at how easy it is to find those out there in the wild okay um then Victor let's let's take it away so let's talk a little bit on like some statistics on popular binaries now",
        "first of all let's recap on the the technique we need we need a stack buffer overflow to overflow or return address we need the troll to trigger the unwinder and then we need the viable Handler now stack buffer overflows are out there the question is do we have uh binaries that use exception that throw enough because we if you don't have a throw we cannot do what you're taking and if we can do a job technique can we actually redirect to something that gives us like meaningful attacker wife capabilities and we essentially did a large scale",
        "analysis on Debian packages we use the Debian popularity contest to rank the",
        "top 1000 most popular uh by uh packages",
        "and we extracted all binaries from these packages this comes to roughly 3 000 K",
        "binaries and then we did some analysis to check how many of these binaries use",
        "exception handling either catch or throw and roughly 10 percent of this binaries",
        "use exceptionally which is quite a large service but that this doesn't tell us anything about our other periques prerequisites",
        "so we did another analysis to check how",
        "many of",
        "these binaries and how many functions in",
        "these binaries will eventually throw and we found out that uh half of this binaries contain at least 40 percent of",
        "functions that will eventually throw an exception now this is quite",
        "for pulling off the initial job",
        "technique but what can we do with this now if you noticed",
        "our previous four techniques that we we",
        "presented they all use more or less some primitive some code Gadget that give the attacker further capabilities to exploit",
        "the program so we kind of analyzed all",
        "these binaries to look for popular code gadgets we extracted all catch and cleanup",
        "handles from from this binaries and we searched for for this specific edges what we found out is that all almost 80",
        "percent of uh of this binaries have at least one",
        "controllable free function that you can",
        "use to to to groom the hip with",
        "um apart from that around more than 50 percent of this binary contains at least one for this control from hijacking primitive both in catch and clean up code and moreover",
        "um almost uh 50 of this binaries contain",
        "a fully controllable right primitive this means that this Primitives can be used both for control for a jacking by overwriting a function pointer or corrupting the program State and do data only attack so the attack the the attack surface is quite large popular binaries indeed contain primitive in December",
        "all right so we saw what the attack was how the attack works we saw that we have a lot of gadgets that are prevalent out there and there is a lot of code that throws can we put these things together can we build real world exploits with with this technique and we took a look at three pre-existing bugs in software that are out there we didn't find these bugs these were found by other people but we looked at are these exploitable with this technique and to the best of our knowledge they are all not exploitable when modern mitigations are enabled without our technique",
        "so there was a an overflow in power DNS which is a textbook example that is really nice to understand there's a apple smart card services and then finally there is um a an exploit in Liberal which is a nice pinata to pocat and we're going to",
        "talk about our exploit in Libra",
        "this is the vulnerable code that is in Libra when we when we exploited it we're parsing exif tags in a raw image the bra parses raw images and is used for example in image magic and We're looping over all these different tags",
        "and taking that tag from the from the file if the tag is a specific type of tag in this case a maker node then that gets handled specifically so if it's a maker note for a Raspberry Pi image from the Raspberry Pi camera and a specific type of Raspberry Pi camera then the maker note is just plain text in the in the image and Libra goes ahead and takes the length that is part of this exif tag and copies that much data into a static sized buffer on the stack so MN text here is 512 bytes large the attacker controls the length that gets copied into it so we have a really really classic stack buffer overflow in here um however after that we can't reach a throw that's a problem so we look at other because We're looping around we can then parse other make other exit tags but there's no throw there to be found except in one place if our image is not a Raspberry Pi camera image then we go into part maker node down here so we're in a bit of a pickle now we can either have a Raspberry Pi camera image where we can overflow or we can trigger a throw",
        "or can we let's take a closer look at the stack layout of these functions down here we have the stack frame for parse maker note and farther up on the stack is the make and the model of of the camera so if we overflow we can change that make a model from Raspberry Pi camera to say a poneberry pi camera and then in a subsequent uh exif tag we can then invoke a throw",
        "we'll set the return address to a gadget in Liberal that allows us to Pivot to a return oriented programming chain and we use a specific address that you could find in lib standard C plus plus or in lip standard C where or let's see um where",
        "that allows when you jump to that it just spawns a shell for you it's called the one gadgets it's a popular exploitation technique",
        "the Handler that we're using is part of liberal and it's a again a catch all Handler that just returns one and the interesting part about this function is again it doesn't have any addresses taken it doesn't have any buffers on there it just returns one and if you look at this in a reverse engineering tool it'll you'll see that there is no compare of the cookie there's no stack protector so we can just pivot directly into into romp and we have a small demo prepared for you",
        "um over here where",
        "um we'll we'll just show you what our exploit does we're using a program called raw identify which uses liberal to",
        "identify the specific camera or type that made an image so we have an image made by Raspberry Pi camera image and correctly says it's by Raspberry Pi may this have made this image if we now run a script that crafts an exploit payload it'll leak some pointers in this case we have aslr disabled we're assuming that there is another way to to circumvent SLR stands for a single leak required so in this case it only needs a single leak to find the base of the libraries and where they are in memory after doing that it builds together a payload that does the steps that we just explained on the on the stack and it creates a new raw image with those XF tags in there so there's first an exit tag for that overthrows the stack and then there's a nexif tag that then triggers an exception so when we now run raw identify",
        "on product Raw",
        "it'll spawn shell for us and we can use that shell to for example Echo some messages",
        "and yeah that's that's our our small demo similar things work in other",
        "in in in the other vulnerabilities that we only have time to show you one of those unfortunately",
        "so with that we're approaching the end of our talk so again as we saw here even though we",
        "have two different code paths that are disjunct that we can do either one of the both in the case where we can do a stack overall flow modify the stack we can actually trigger both this else this branch and this else branch",
        "and the key takeaway here is that if we control the stack we can make the program do things that aren't obviously visible just by looking at the source code and you can do you can reach throws that aren't obviously reachable as well",
        "with that we're approaching the end of our talk we looked at how unwinding works",
        "and figured out and saw how the unwinder uses return addresses to figure out where to target the exception handlers if we overflow those return addresses we can do a control cache Handler oriented programming and that's the general idea of our talk of what we're presenting today we talked about four different specific techniques that you can use to leverage job either by using the golden Gadget in lip Center C plus by pivoting to a return oriented programming and evading stack cookies",
        "signal handlers and then finally we also",
        "looked at the cleanup handlers and how you can chain them to manipulate the Heap into a state that's good for exploitation and Trigger use after freeze and then after it starts and the real world example now we're here at the end of our talk recapping what we did there's a couple of honorable mentions and people that helped us along the way um I think it wasn't just us two it was an entire research team that you saw in the beginning of the slide we also like to to thank the CTF team tasteless for organizing a CTF on this subject yeah",
        "Greg super helpful he pointed out an example that was a textbook example of the party DNS bug which is really nice at demonstrating this uh this topic uh yiska for the Cookie Monster is that we're hiding in the slides and yeah they are my team the",
        "vothic group that gave us a lot of feedback and drilled off many times for this presentation I hope you people",
        "enjoyed it it was really fun to do this and with this uh we're gonna live on",
        "this slide a couple of key takeaways from our talk I think uh given the time do we have time for questions we do we do or do we um I think maybe one one quick question anyone has any questions they should come up to the mic yeah just come up to the mic um we'll leave these up here there's also a QR code with a GitHub repository that's currently empty it'll be filled as uh as soon as the um you heard these promises before yeah it'll be it'll be filled as soon as the Embargo lifts",
        "[Music]",
        "[Music]"
    ],
    "gIbv7OqiMjw": [
        "foreign",
        "welcome to the",
        "um black hat Europe knock report I will start off real quick with introductions and we'll roll straight into it my name is Neil Weiler but everybody knows me as grifter uh by day I am the global lead of active threat assessments for IBM X4 so I run um IBM x-forces threat hunting program around the world by night I do this I help run all the technical operations for the black hat security briefings with this guy here I'm also one of the main organizers of Defcon uh doing all the contest events demo labs and",
        "um what else speak at conferences written some books stuff like that basically things that make my mom happy but in reality what it means is that I just live and breathe security I love it it's uh dope that they pay me for it so I am Bart stump I do this as well in the evening as Batman as we always sounds like uh during the day I am a seniors SE for net witness uh I've done a whole bunch of other things but it never sounds as cool as him so we just kind of skip",
        "all right I love you",
        "um we do not do this alone though this is the team that is here with us this year right so this is the knock team what are you laughing at your post there's nothing to worry about that right so um so yeah so uh this is The Crew That's there the crew for the knock team is not just um folks who are working or contracted directly with black hat it's actually um a whole host of individuals from our partners so years ago we decided that we used to roll our own on everything we did everything with open source and and scripts and a prayer but if but years back we decided that we couldn't scale like that and so we approached some vendors and said hey would you be interested in letting us use your equipment and we'll like mention that you you know let us use your equipment when we get on stage or we'll put it in the program or all that kind of things and thankfully everyone said yes everybody we approached so we just went shopping in the expo hall essentially and picked all the things that we wanted so we do have uh a few different uh folks here gigamon is our Network backbone essentially they're mirroring all the traffic that we have so that we can put them into different tools and appliances that that we're using to run the knock and to get in there and do investigations we have net witness which is full packet and uh Sim and forensics as well as our identity and access management uh provider we have ironet for Network threat visibility so ndr technology",
        "um Cisco is a lot switches access points DNS mobile device management Cisco's special shout out to Cisco as well because before the Asia show we had a previous wireless provider who said oh like a month before they were just like Hey we're not going to be able to support black hat this year it turns out we just don't have the the budget the Manpower or whatever it is to to send out and we were like cool we have four weeks to find a replacement for the entire network operations for for blackout Asia thankfully we had a relationship already with Cisco and we said help and they were like you got it so we have Meraki gear serving up packets here today Palo Alto is our core so firewall and routing and then the internet just comes from the venue I don't know what we pay for that but I'm sure it's like a dollar a packet so you got a gig this year too yeah it's a gigs worth of bandwidth",
        "so the gear we'll talk about numbers first and I'll show you an architecture kind of what it looks like logically and what we've done here so as you can see Cisco's brought us a whole lot of stuff um switches access points and then the uh MX concentrators were used for the",
        "access points and some other firewalling uh that we needed elsewhere in the venue from a remote perspective Alto excuse me has three PA 5260s two of them are in aha active passive and then one is actually out of band collecting data that we get from gigamon as well RSA has provided us Network visibility",
        "uh we have a head unit decoder concentrator uh built into a couple of Dell Isa units they're just Dell boxes basically broke up gigmon provides that hc2 that again Taps that data and provides that into all of our tools and then ironet also providing visibility with the is 1500 and I I realized I did not update the amount of terabytes we don't have 250 it's not that much we did for the US show and that's why that's there um we don't use slides um so the architecture here's what it looks like this year um from a logical perspective the internet comes in and hits a breakout switch uh comes into the uh Wan side of",
        "the two 5260s that then we tap as you can see on the south side of firewalls to all of our tools that data is fed into mainly net witness power and iron net we do occasionally have some other open source tools that we use to visualize some data you'll see some of that that we didn't necessarily have here but in the dashboard section and then that core switch stack core is a confusing term to some people apparently it's not routing it's basically just where we break that out into the different vlans that we need across the venue at that point we have a management Network a switch that was dedicated for registration because we've hosed ourselves before and another one that we use for all that wireless environment unique to our International shows as opposed to what we do in Las Vegas we do ride the infrastructure of the venue so we are going over excel's infrastructure which causes some other I wouldn't say headaches but unique ways that we have to get around that because they're vlaning we don't get into q and Q and there are some things that that causes some design issues with so from a",
        "logical perspective we definitely want to keep it as simple as possible Steve Fink our head architect helps keep a lot of that in line works with all the partners to make sure that we keep it as simple and stable as possible Steve MF I think right what's the MF stand for Mary Frank yes",
        "and then uh this is actually more of a logical flow in some of the processes that we have in place so we've talked about this a lot and if you've seen any of our talks before we have a slide that we still have and talk about a few things kind of the evolution of the knock again to grifter's point we used to do open source so Chris boxes openbsd PF scripts and no sleep and that was basically the only way that this network was up one of the biggest reasons and in some cases it wasn't up right the stability was a completely different ball game one of the big reasons that we went and talked to our partners and got those Partners in place uh and I'll talk about this a little bit here I guess is this is It's a knock it's not a sock if you've ever heard us call it that our our number one priority is stability of the network so if you're in a training room and you have Labs that are in AWS or gcp something else the trainer has done the last thing that we want to do is limit those people in those training rooms to be able to access those labs to be able to do what they need so stability is kind of the number one priority for us at this point security I certainly wouldn't say secondary but it's not our primary function so function if you will it is absolutely so as you can see here uh there's a whole bunch of things I won't go through this whole flow we have Integrations from all the partners we have net witness captures payloads we dump that into threat grid we detonate that in the sandbox see if there's a problem we have a slack bot that's integrated with Palo alto's cortex soar that basically anybody in the knock can access that put in a MAC address an IP address and get enriched data create incidents and some other things that we can all look at and work through that syslog is sent to that as well as net witness we dig and correlate and and go through all that with the threat Hunters gigamon Taps that data and obviously provides that to all of them and then securex on top of that everybody has a sword at this point so we're kind of okay with everybody doing what they can um and and kind of obviously giving us more data helping us out and keeping us more um enlightened if you will so uh what am I missing here malware analysis again from threat grid securex we're good we're good Rocky provides all kinds of MDM as well if you've noticed that we have the iPads outside of registration outside of the briefings rooms we do secure all of that as well with um Cisco's MDM tell you what that looks an awful lot like a sock I'm saying it's adorable so this is what it looks like when we're building stuff uh Jimmy one of the guys from Palo Alto uh just set up a time lapse of a an undisclosed location where all the gear has been deployed and you can just see it progressively turn into more of a show and so there's the cardboard yeah look all of a sudden cardboard boxes which are that's a rack yeah that's a rack so",
        "um and that's what it looks like on tape nice and cardboard coordinated",
        "your infrastructure ladies and gentlemen",
        "um so it gets set up in two days though so that is something to uh that we definitely brag about it's it's uh hopefully stable secure network that um you know Enterprise grade with the visibility that we have in a matter of a couple of days it's probably one of the smoothest setup shows that we've had in a long time uh it's it's it's definitely something that yeah",
        "yes thank you to our partners I was going to say that that's for the partners we watched that and it looked like a really cool video and they look all tired but uh yeah so you look like you worked hard you worked so hard um all right so that means that we have a lot of different technologies that are out there and that we're using um and of course those Technologies all come with some different dashboard I like that once the light this you guys were plunged Into Darkness I apologize you're gonna get occasionally blinded depending on what screenshots are up there but everything's got a different dashboard we use a variety of things both what comes from the Enterprise or vendor Technologies as well as open source things that just feed us information to tell us what is the temperature on the network at any given time are we seeing a particular load somewhere what is um areas that we need to focus on that kind of thing and of course just interesting data where are things flying to what are the most um you know uh utilized technologies that kind of thing and we'll get into that in a moment see blind this is the perspective I'm Pokey for a second the uh perspective that I hadn't really seen in years were sort of management it's even weird for me to say here but obviously being a guy that's usually behind the keyboard and doing the technical stuff it's it's interesting the way that you see dashboards if you're a sock analyst it's it's one thing and you need to be able to see information and it's there and the fancy executive reports are all we always make fun of that but there is a level that I've kind of grown to uh like the dashboards and try to understand that a little bit more because we're in and out of the knock so quickly and I want to be able to see exactly what's happening in two seconds or know that there's a problem or know that I can go take a nap in the corner and not be a problem so the dashboards have become a very unique piece and given me a different perspective even with the show and kind of the way that we're handling things and where we're uh at compared to a day job so it's it's certainly grown and and been unique from years past",
        "uh more pretty dashboards right pretty pretty but let's get into some actual stats all right so um so year over year we just tracked like how many DNS queries let us know how much is the network being used what are you out there looking for you can see um there is a like a gradual you know increase year over year from 2017 to 2019 obviously 2020 is not there uh we",
        "have forgotten it you should forget it let's move on 2021 we were back we were back here last year and um and it was a much smaller show right not as many folks came out physically but this year you're back so",
        "um again that that increase it looks like it just essentially kept right on going and and uh you know the trend continues right so you left those in even after you talked I did I left animations in I meant to take them out I apologize anyway um so these are the most popular of particular applications right so so apps uh FTP on jpn there's interesting stuff going on out there uh chat was WhatsApp um binance for crypto mining dating Tinder and porn xvideos so yes porn",
        "you're still disgusting year after year I don't understand you paid how much or your companies did and you're just like oh sweet let me grab some stuff like I don't at that point it's an addiction it is",
        "get help black cat um so more stats so in this uh some of these are from net witness the amount of packets and uh logs that we pulled um you can see the number of clients I can't though what is the number we had on there we had I want to say it was about 1600 clients that we peaked at uh unique apps was about 3 500 this is all just Unique Kind of stats nerd data that we like to pull every year kind of correlate that and what it looks like again we had about a gig pipe here you guys didn't really use it we did have some qosing on that and some some caps but I didn't really uh blow out the uh the entire one gig so uh 228 million packets captured uh we'll",
        "talk about this real quick we wipe all of that data at the end of this show we don't keep any of that it's not used for any marketing info but we do capture every packet that flies across the network wow that was on the log decoder on the other decoder we we had over 5 billion which is oh I messed up you're all right no your Dakota that's your log decoder packets yes you're at 5.3 billion packets don't ever question 128 million not in public not private said never questioned me until I yell at Glover love you next slide",
        "um yeah so more unique stats here the interesting one here malicious DNS requests was 21 000 but 39 of that was definitely malicious which that's interesting I didn't see a gray wear as well that was I think we did the math it was over 8 600 that was actually malicious compared to the grayware um your device is again unique devices if you see the merakis in there but Intel PC was down towards the middle only 50. so you guys are either hiding stuff or there's not many uh Windows PCS I don't fully believe that um Apple obviously the top usually is we're good there I love that again the x video stuff now just 40 percent of the traffic is malicious disgusting disgusting disgusting all right continue",
        "um so top streaming apps like obviously like Tick Tock y'all are here and you're watching Tick Tock so cool again great use of your company's money um it's probably how you can tell how good somebody's talk is is they're just like audiences wiping out you see any swipes out there we're good yeah so okay we're still good so yeah uh again so interesting stuff here as well is uh like malicious URLs things that we're going to seventeen thousand uh different URLs that that folks were hitting on the bottom there uh looking at things like uh our TLS",
        "right one point 1.2 versus 1.3 about 50 50. so it's good we're making moves your iocs iocs about half possible Cobalt strike",
        "what what class was throwing that around yeah or just one guy in the hall yeah who can say I'm not here to judge yeah and then um just the different types of behaviors the compromise that we see stuff that isn't necessarily an indicator but it's something that's like this could potentially be bad uh and and that's how we kind of jump off on hunts and things so we'll see something and we'll go ah that might be something that we want to take a look at sometimes it's something really trivial like literally going direct to IP or seeing something like base64 encoded",
        "um data in in a request and we're like well what is that and and then we go and take a look at it so even though some of the things seem trivial uh as as all of you know it doesn't require a ridiculous zero day exploit to to get into anything sometimes it's it's just the lowest hanging fruit",
        "uh uh what else malicious URLs so there's some interesting things here again which one was malware compared to phishing C2 we often see plenty of C2 again whether it's from a course or we do see many people come onto the network infected uh we try to let people know as often as possible whether it's walking into a classroom and letting them know we have in the past done some uh it's actually unique story as well we've done captive portals to let you guys know if we see traffic so if we saw unencrypted credentials or we saw C2 or we saw a machine doing crypto mining what we would normally do is let you know via captive portal and that is actually almost useless now because everything is pretty well TLS and you will never get presented that captive portal so we're actually looking into some other ways to inform Folks at the show without having to go tap people on the shoulder which we did a couple of times this year and it's been a little while so it was kind of fun to uh be the bad guys walking into somebody's training class and saying we need to speak IP address this and having them everybody's panicked seeing what their IP is and then you can usually tell that one guy wouldn't come to the back of the room he just wanted to do it in front of everybody I told it we were like okay um so we'll talk a little bit about like the evolution I'll make this quick because if you've been to this talk before in years past we always do the slide just to let you know how the network has evolved so as Bart said earlier the main uh objective is to",
        "uh have a stable Network something that you can use right that one's mine and then I know I'm bringing it you're still trying to be kind I thought you called it out um so to have a stable Network something that you can use that you can get to your Labs that you can do whatever it is that you need to do um and then after that it is security like security it does come second on this slide but not in our hearts at a certain point very early on in black hats when I took over the network uh at the time the network was flat like black Hat's early network was just um Bedlam and so",
        "classes would attack other classes right the offensive class would attack the the defense class or the like human factor class or whatever they would just go after them like crazy like I learned something new mwah and throw it at somebody else um so at that point it was just breaking everybody up to keep you from touching each other and so that it wouldn't become an issue inside training classes that everybody can still see each other and that's due to the nature of many of the labs that are in there but classroom to classroom and then out when you're out around the network in the Halls you cannot see each other so at a certain point we said all right we also um we want to do some threat hunting we want to go in there and see what's actually going on people often describe the black hat Network as one of if not the most hostile in the network in the world that is true if you consider that looking at all the traffic that we have is incredibly malicious right it the things that take place on this network are the types of things that would cause a declared incident in any organization every five minutes right but that's because somebody's doing a training class or they're showing their friends something in the hallway or they're doing a demo on stage and so we can't go in there and just block everything so what we do is we try to identify what's actually bad right what's the bad within the bad we often describe this as searching for a needle in a needle stack that is why we have so many hunters in the knock most of the folks that you see in there are doing investigations throughout all of black hat and they come from Cisco and Palo Alto and net witness and iron net like they're all in there looking to see what's actually bad sharing data working together what you see in the different Technologies and it's grown a lot in that sense too so it provides perspectives from each of those partners and those people and those hunters even are uh it's Unique yeah so we um we do that we just coordinate through slack with each other essentially we just go okay um this looks like something can anybody give me some more context on this and each of the folks just jump in there and say oh I found this in our system oh I looked at this thing let me add some more uh screenshots get added and the investigation continues and they go all right yeah it looks like that is something that we actually have to care about or nope that's totally a class that's taking place and you'll often see some of the earlier in the week stuff end with that class is this it looks like it's relevant to that you know particular course",
        "um the malware sandboxing",
        "again so we started a relationship with with Cisco with threat grid and what we were doing was anything that we could potentially consider malware where there was some type of executable or a dll or a PDF or whatever we throw it into a Sandbox open it up interact with it see what it does right we want to see if that's actually something interesting we often find interesting things sometimes brand new wow where sometimes just variants of something that we've seen in the past either way it's fun we get to see what goes in there sometimes that also Clues us into different things we see PDFs get opened up and we're like why is there a Wells Fargo logo on that right it's like oh dude uh that that can't be good that's yeah and then we go down again we go talk to people and they say I know what I'm doing I've been in security 20 years and you're like your mortgage has this much left on it and they go oh my gosh right so um nobody believes us when we come for them right they just go I know it's fine I know what I'm doing and we're like we know what you're doing too we can see it so",
        "um the identity and access management part of this was because we had a partner at the time where there was an incident where they and with the best intentions they pushed some changes to their gear at midnight one time at a U.S show and it caused like a 90-minute outage the next morning actually it was a longer outage but the impact to the classes was 90 minutes and we were like no one can ever like push a config change again without it going through Bart think or myself so endpoint isn't really endpoint anymore as well that's that we're not putting free endpoint protection on you guys for the majority obviously this was uh registration machines those have changed we don't really have one now it's a mobile device manager uh MDM so in a sense same thing it's an end point we just mobile endpoint and you already covered automation so we're good and that that's constantly evolving so there's plenty of Automation and I think a million other things that we could do with that unlike that Magikarp who never actually evolves you're burning up all the time I haven't gotten into stories oh no we didn't we're good we got plenty of time oh okay stories so this one is rather interesting in some of the lessons so I actually have started giving another talk about building socks basically on some of the things that we've learned here some stories uh and this is actually a really interesting one so uh directionality matters is kind of how I'll start so what we started seeing uh was a bunch of communication",
        "from a specific client on the network to Something in Colombia whatever nothing that abnormal but as soon as they pivoted on that Columbia IP address um collectively a few of our our hearts dropped because we had infrastructure that was speaking to this same IP address um over the course of troubleshooting and not panicking but those those duck legs under the water were definitely kicking uh",
        "what we found out was that there was a infrastructure hacking course that was spoofing a whole bunch of different IPS teaching some things reaching out what ended up happening through again some not very panicked but certainly concerned troubleshooting that they were",
        "spoofing IPS from Colombia reaching out and it was never even getting outside of our network from a public perspective obviously what we found is that the communication from our core that we thought was communicating to Colombia was dropping those packets and telling the student in that classroom that they were not going to go however that was a spoofed IP address so obviously directionality was was uh kind of the piece here we were speaking back to a classroom but in that initial pivot seeing that our infrastructure was speaking to a IP address in Columbia we were we were super concerned dug in a little bit found that out and we're uh we're clean uh this one just a favorite of ours we keep keep finding and this one is somebody who's using big fix but they have not configured it to use any type of encryption so everything is in the clear and what you're looking at on the screen is all of the applications and what versions they're on all the services running on that machine everything about it that would essentially jump you straight into being able to go in and move to exploitation versus having to do a bunch of reconnaissance on it reconnaissance Beacon get on your own onto the network it's trying to communicate back to the company server but it just does that by vomiting the information onto the network regardless of whether anybody asks for it so this could be happening in a coffee shop in an airport lounge wherever it's happening and this is and we see this show after show after show it is repeatedly People misconfiguring",
        "Big Fix where it's just like please just check the box that says to use TLS um so that one's always fun uh pre-owned",
        "um but it's in good condition so again the majority of what we see as far as uh threats and actual uh malware is",
        "generally infected before it comes onto this network so we'll see the command and control uh we'll see the other the data off of that the ioc is triggering uh what we saw here was um one of the threat Hunters found an uh interesting IP address we were communicating with uh not we a machine on the network looked it up and there was actually a Blog written a week ago on this here uh malware somebody was",
        "infected those iocs matched the IP matched uh and we got to walk into the back of the classroom and tap him on the shoulder dig through IP addresses find out who it was and at least let them know so again not necessarily trying to scare anybody but if we can let everybody know uh when they're on the network and we see those things and make you more secure when we leave obviously the security conference when we're all Security Professionals so anything that we can do to help out each each other it's kind of where that was but they came out of the network infected we saw that we let them know and it seemed to be a pretty fresh write up of this malware archetype two I I can't pronounce it it was interesting as well I think it was a few weeks old but regardless that individual like we said people often describe this as the one of the most hostile networks in the world and oh and be careful when you go on the blackout Network all that but our goal is to actually leave more people more secure when they leave uh By Us letting them know that they're beaconing out to command and control infrastructure or whatever it is uh or doing crypto mining or they have clear text credentials those types of things we tell a not insignificant number of folks about those things while they're here so if their sock isn't catching it we do and they leave more secure and that makes us feel all warm and fuzzy inside",
        "in this particular case we I mentioned you know simple things right direct IP base64 encoding that's exactly what we saw here was a bunch of a64 encoded traffic that was leaving the environment we said what is that and what it turned out to be was a a Chrome extension for like a video downloader like Facebook video downloader Chrome extension and that extension was one it didn't even work somebody in the knock was like I'm gonna go get it and see what it does right and like set it up and they were like it doesn't even work it just gives you an error message LOLs but they left it installed and what it did was just Harvest essentially every website all their every website they went to every Google search everything all whatever just went out to um a known bad command and control infrastructure once we dug into the threat intelligence uh we went to this particular classroom to find whatever student it was that was had this on it turns out it was the instructor",
        "registration situation so we",
        "um just explained a little bit I guess uh some back information here we actually migrate the registration database on site at every show when you go connect and try to register while a show is going on you'll actually be hitting a web server that sits in the knock that registration server is often tried to um be hit there were many attempts from the outside we often see scans that's on not abnormal some SQL injections this is the one place that we will tell you that there are things that are blocked they're absolutely policies in place around that that web server we are in decrypting that data we do see what those database rights are those reads we make sure that we can see all of that our information is is in that database server your information is in that database server and none of us want to end up on Twitter so there were absolutely some attacks from the outside everything was blocked but generally you try to see SQL injections and just other General scans we like like you said and I want to qualify that the only traffic that gets decrypted on this network is the traffic from the registration server to us right so we want to make sure that we can see what's going on on there um obviously we don't we don't even know we've talked about it before but our goal would be to see nothing on this network yeah",
        "sit with a drink somewhere but um but also we do see attacks at International shows um the U.S show is by far the one where we see the most aggressive and even um I know attribution is hard but even nation state attributed attacks toward",
        "um those are our crown jewels your information is our crown jewels we assume that if all of your data ends up on the internet and that is probably valuable information to somebody who are the top security researchers and let's get all of that stuff and gather it up um if if that happens we're out of a job so you're just trying to get us fired now I'm trying to get a fire I'm gonna have a drink in my hand at some point um Okay so in this particular case again simple things where we're trying to tell people hey we see this traffic there's something going on you're passing something in the clear this is one of those cases we just saw information that was coming across the network in the clear looked like it was clear text credentials started digging into things what we started seeing was clear text emails logins to things this poor individual um they like were they sent their resume over in the clear they had all kinds of stuff and they even logged into their blog to update their blog which is of course security related right so they",
        "are posting stories about how to stay secure while throwing all their stuff out there for free right so we found the credentials to set well we did",
        "we should post an update [Laughter] oh my um so anyway uh so",
        "we saw several individuals",
        "shopping for vehicles right different",
        "types of this particular vehicle",
        "different colors different years",
        "different trunk space right so they were",
        "shopping for these vehicles as early as 10 in the morning spending and again not insignificant amount of time just trying to find the right one this slide is not about cars",
        "thank you",
        "[Applause]",
        "[Music]",
        "[Music]"
    ],
    "uPM_IgTdHCk": [
        "thank you [Music]",
        "[Music]",
        "[Music]",
        "founder of black hat Jeff Moss",
        "[Applause]",
        "hey good morning everyone see we've almost least survived a few empty seats I think they're in the hospital recovering we've done uh done really well on our first day today we're kicking off with a keynote by Jen Ellis that follows some",
        "of the themes from Daniel from yesterday she'll be talking about cyber security the Next Generation and uh and I believe Jen is in a really interesting position uh to talk about this because she's highly engaged in the community she",
        "contributes a lot of her time trying to make the world a better place either through policy through coordination",
        "um so I'm going to tell you a little bit about how she spends all of her time um she's a co-host of a security Nation Podcast she's a co-chair on the ransomware task force which we've all heard of she sits on the board of the center for cyber security policy and law she's a member of the board of advisors for the Cyber peace Institute CPI the Global Science cyber Alliance",
        "um she helps organize the Defcon policy",
        "initiative that we have she is on the Aerospace Village she's on the board of",
        "I am the Cavalry she serves with me on the UK government cyber Advisory Board and it goes on and on amazing contributions but I think she",
        "said the thing she's most proud of as a Brit is flying to America and testifying in front of Congress and being the opposition Witness",
        "um and so after that it's sort of all downhill how many people get that uh opportunity so it's really is my privilege uh and honor to introduce Jen Ellis and really look forward to seeing what she has to say so let's give her a warm welcome thank you",
        "[Music]",
        "morning",
        "uh thank you to Jeff for that uh intro that made me sound um like I never have any downtime at all um and thank you to Black Cat for inviting me here and thank you more importantly to all of you who made a 9",
        "A.M presentation uh particularly to those of you who perhaps enjoyed the what do they call it networking events is that what they what they call them um so I would like to invite you to join me as we boldly go on an adventure to look into the future of security and how all of you can play a role in shaping it this is probably the moment at which I should apologize to anyone who hates Star Trek because there's going to be a bit of a theme um I hope that none of you hates doctor egg I should also explain by the way that the goal of this talk is not really to have everybody agree with me because I'm very used to that that never happens um but it's more to inspire you guys to think about what you might do to help shape the future of security and if you want to play a role in that maybe you don't but it's up to you so um we're coming to the end of 2022. and 40 years ago the RSA Corporation was",
        "founded which is sort of the first of the big security companies that kind of hung around and a couple years after that we saw the first commercial AV Solutions so",
        "sort of approximately say that the security industry is an industry is about 40 years old and we know that generally speaking a",
        "generation is considered to be 20 or 30 years so it's somewhat fair to say that we're in the second generation of the security industry",
        "um I think that it sort of matters because often Generations like to think",
        "about what went before and how they're going to do things differently how are they going to forge a brighter newer future and yesterday we had a fantastic keynote from Dan and he talked about how we're trying to build a defendable internet and one of the things he sort of mentioned is there's lots of good things happening but this community could maybe be doing a little bit more or a little bit differently so I wanted to kind of pick that thread up and look at what does that mean what does it mean to think about doing things a little bit differently and uh perhaps changing the approach to mature the industry a little bit right um so that's the goal of today so a lot of the people who are in the first generation of the cyber security profession like these gentlemen here who worked for loft heavy Industries",
        "um they're now in a position where they actually are Business Leaders some of them work in the government some of them are retiring with the hard-earned money that they have earned through a career in security these guys testified to US Congress in",
        "1998.",
        "and um the chap in the middle who is Peter zakko better known as Mudge he said that he could take the internet down in 30 minutes or less does anybody remember this from 98 some of you I think perhaps were not born in 98 I'm not going to focus on that too much um I was finishing up high school and I did not have a particular interest in security at the time and I remember seeing this on the news because it made the news globally and I thought that sounds mad and you know as a normal teenager I was quite interested in the internet um and so I went to my dad who was an I.T director at the time and I asked her about this and it probably won't shock you too much to know that as an I.T director he didn't know a huge amount about security um and so he sort of looked vaguely horrified but had no answers for me um so I remember this as a point in time in history and it I think really is the first point when I got interested in security so let's fast forward to 2018. this was the 20th anniversary and again these same people now with much fancier suits and haircuts um they went and they testified again and this time they didn't make claims about closing down the internet in 30 minutes or less but they did say that a lot of the same issues they had talked about 20 years earlier were still present",
        "um and they talked about how the complexity is only increasing this is something that Jeff mentioned yesterday complexity is only increasing the attack surface is increasing so the fact that we're still seeing the same issues is a real problem and I think this is something that Security Professionals are generally fairly familiar with you know we hear a lot in security about how we continue to see the same types of bugs over and over again we can't we still see cross-site scripting we still see SQL injection it's super annoying that we're still dealing with unsupported Legacy systems and default passwords and these things keep coming up and over again so the slide everyone was waiting for it's very easy to understand that security people can be a little jaded a little cynical maybe you know somebody that represents that um sometimes even a little depressed",
        "in fact one of the things we hear in security is that nothing ever changes I'm going to do something they did yesterday I'm going to ask for a show of hands how many people have either said this about security or have heard somebody else complain this about security",
        "well okay not as bad as I thought right well I'm here to challenge it I think that as much as we see those same annoying bugs and it is annoying I think actually quite a lot changes I think context changes and I think it matters so when I think about cyber risk I think of three main areas of behavior that help shape cyber risk that is the behavior of Technology manufacturers the behavior of large-scale Technology operators and the behavior adversaries",
        "these categories of behavior also influence each other right they also change each other and they respond to each other so let's look at what's happening with technology manufacturers first so I think it's pretty easy and obvious to say that the landscape in Tech is always changing right um in 40 years that we've had a security industry technology has changed massively one of the biggest things has been the huge explosion of adoption of iot and Mobility Technologies and uh this is really relevant to security for a couple of reasons one is obviously hugely increases both the attack surface and the compute resources available to attack us but the other reason that this is really important is traditionally when we think about cyber risk we're thinking only about the Cyber domain we're thinking about virtual harm what iot does is it creates a bridge",
        "from virtual to physical and all of a sudden now we're talking about the potential for physical harm and with that also comes massive economic impact massive societal impact so this changes the stakes it changes how we think about the impact of cyber risk and it's important from that point of view and in fact it's so important that governments have responded so uh yesterday Dan showed a",
        "picture of a guy called David Rogers and he worked with the UK government with dcms and he came up with this code of practice for consumer iot and this code which is 13 basic principles for building secure by Design",
        "was then adopted by the by Etsy the European standards agency and it was turned into what's called an En so en 303 645 for those who are standards bought nerds like me um what that means is that all of the member states of the European Union have to adopt it so this has now gone across Europe and further because now the Australian government has adopted it the Indian government government has adopted it and other governments are starting to build on top of it so this is actually a super influential piece of work but it also represents how much governments are focusing on the problem of iot because they're very concerned about the potential impact on society",
        "so the next big change is the shift to cloud and On Demand we saw this accelerate during the pandemic",
        "and from a security point of view one of the things that's interesting about this is that it creates that sort of confusion or lack of certainty around where responsibility lies for securing",
        "your stuff right who really owns that responsibility and for operators it can",
        "be a real challenge right if you are a large-scale operator and you are providing on-demand Services you now",
        "have a huge responsibility to provide availability from a client point of view what is your responsibility how do you manage this risk you have to rely much more on your provider and actually for the uh adversaries it makes for",
        "really juicy targets right we saw this play out when we uh when we've seen attackers go after um a single organization with vast customer base and so there's a huge impact there and then Dan talked about this yesterday we've seen a new era of AI and ml Dan talked about chat GPT because I think he's had some fun playing with it recently um and he talked about how when you're looking at Ai and ml Integrity becomes much much more important so let's look at that so he he referenced yesterday the classic CIA Triads that we have in security confidentiality integrity and availability of data",
        "we've had this Triad forever in a day probably for 40 years um but really in the past we focused on",
        "confidentiality of data that was really what it was all about um whether your attackers were sort of perhaps politically motivated or profit",
        "motivated really it was all about maintaining secrecy",
        "and we still see this being really really important the rise of double extortion attacks shows that keeping",
        "data confidential is still a huge priority but now availability is also a priority we saw this first with the rise of DDOS attacks and more recently with the huge explosion in ransomware attacks availability has become Paramount",
        "and it has a huge impact on the economy when we have a loss of availability so availability is a huge priority now but again as we talked about when you're looking at Ai and ml models really it's about the Integrity of data and that's the thing you have to build in from the ground up you can't kind of go back and fix it later so all of a sudden Integrity becomes a priority in a way it wasn't and so now rather than just being able to focus on one we're focusing on all three and which one matters the most to you will depend on your specific organization your specific threat profile so the level of complexity that we're dealing with as Defenders has increased the burden has increased so",
        "maybe I'm persuading that things have changed but in a really depressing way uh good morning to you all um so now let's look at operators it's a broad term it can go from being your sort of classic individual consumer using their phone through to being large-scale operators that can be infrastructure as a service providers uh mobile providers you know they're all operators right so there's a huge Spectrum in there everything in between um and there have been changes the the obvious one is that during the pandemic we saw this big adoption of remote working uh we don't know if that'll stick around but I think more flexible working probably will and much like iot what this means is that the attack surface continues to increase the complexity continues to increase in security we always say oh the parameters Dead uh but actually every individual working on their sofa and their shorts is a point on your perimeter and you have to think about how to protect them so complexity is increasing and of course they love to plug stuff in they love to go buy stuff without talking to security and how are you meant to secure things that you don't know about that you can't find so that increases the complexity and the risk and then we've got supply chain risk which we already talked about a little bit and everybody at the moment has been tasked with that thing of like oh you've got to figure out how to not just vet it for security when you're getting it but then figure out how to maintain that vetting over time what does that even look like and that leads us to this magical solution zero trust which we haven't really talked about how we make that practical over the long run and at scale so there's a lot going on for operators right now and adversaries love to take advantage of it and so yes they too no longer look how they used to",
        "um thank you I appreciate that somebody found that funny um so we used to talk about script kitties and we used to talk about disorganized opportunistic attackers",
        "and now we talk about people who will run like businesses we talk about people who send emails about HR problems and who book time off um we talk about highly complex and sophisticated organizations and their bosses who drive around in Lamborghinis",
        "it's not the attackers we used to deal with they have their own industry their own complex markets where they have specialists the same as we do arguably better organized because they're not competing in the same way we are and now they have this relationship with governments as well so one of the things we talk about when we're talking about criminal groups is we talk about Nations that are safe havens they either can't or they won't prosecute criminal groups which enables the criminals to thrive and survive and in some cases we know that a part of the reason they won't prosecute is because actually their criminal activities further the goals of the government so that's the thing that you guys now have to deal with and that's tough so I would say that actually I think quite a lot changes in security and it matters because it means that one the stakes have changed the impact has changed and",
        "that means the focus has changed all of you who do this job every day who've thought about security for a long time you're now under scrutiny of governments",
        "and of Business Leaders and of the attackers so I think that it comes to us to say",
        "what we're doing isn't working we're not winning and I'm sorry that's a so no that's not a positive message for this time in the morning um or any time in the morning really um but I think that because we have so many people that are so passionate about security people who will come to Excel for two days to learn more about security I think that we have the potential to do things differently and to do more and I'm not suggesting that you guys all have to take on a second job I know that I have a problem saying no to things clearly but you guys you're busy and I get it you already have a full-time job I'm not suggesting you have to do more what I'm asking you to do is think about whether there are small things that you could change that you do things differently and it helps to become a better advocate for security because ultimately we can't fight this battle alone anymore we've been doing that and it doesn't work so we have to break out of the vacuum and we have to figure out ways of driving buy-in with the rest of the world now I will pause I'm doing this for dramatic effect",
        "so",
        "it's a big number um in 2022 cyber crime has estimated",
        "that it will cost the global economy seven trillion dollars now I don't know maybe you're really good with your numbers I'm one of those people that I look about and I'm like I don't know what that means so to give you a little bit of context the GDP the gross domestic product of the UK which is the sixth biggest GDP in the world is about 2.64 trillion",
        "seven trillion is about equivalent to the combined gdps of the UK France and Brazil",
        "so which are six seven and eight on the list um so it's a lot of money it's a lot of money and not only is it costing the world a lot of money but also it's become a part of international diplomacy we saw this play out in the run-up to the Russia Ukraine uh conflict and we saw some pretty heavy",
        "conversations between presidents Biden and Putin um and we have had a lot of discourse around what might happen in hacking around the world and how it might impact private citizens not just governments because we now effectively are kind of Pawns in this game so all of this means the policy makers are going to pay a lot of attention to security they're going to try and figure out how can they make a difference and change the Dynamics",
        "in this year in the UK alone",
        "we have had three cyber security related laws drafted or updated we've had six government consultations on a wide range of cyber security related topics an additional two parliamentary inquiries",
        "if we look more globally this is a selection this is not exhaustive the selection of cyber security related topics that governments around the world are actively working on today",
        "if you would like more on this here is a Shameless plug there will be a session at 1 30 and I am very excited",
        "because Irfan hamani from the Department of digital culture media and sport is coming to talk to you guys which is kind of Awesome they're from the government and they want to help um I think that might be a U.S phrase but in any case they'll be here and",
        "um and Irfan will be here and it'll give you an opportunity to ask more questions but he'll go through what the UK government is looking at at the moment and the thing is whether you want to get involved with it or not and maybe you don't maybe you're super busy and you just don't want to do it but the bottom line is as a security professional you will have to live with whatever they come up with you'll be the people who are who are governed by it directed by it so it actually is really good for you guys to know what's coming",
        "so another reason that all of this matters is uh the security industry is estimated",
        "to be worth 156 billion dollars",
        "um I feel like I should do a little bit of this um again it's a big number um but what it means is that companies are spending a lot of money on security and some of your companies will be benefiting from that and that's great uh but when companies spend a lot of money on something they have an expectation they expect professionalism they expect a certain standard in how their service is provided and what they get and we've seen this we've seen the shift around understanding of who Security Professionals are we see it even in the very imperfect way that the media represent us we've gone from being sort of disaffected Youth and Shady government characters through some",
        "interesting weird distractions on the",
        "way to now and understanding that we are professionals and sure we might get represented as hoodie wearing that's fairly accurate I own quite a lot of black hoodies um and a little erratic but now there's an understanding that we're professionals and people expect us to behave like professionals and that means that all of a sudden people go well there should be a standard there should be a baseline for what I can expect when I hire a security professional and that means certifications",
        "this is not unique to security if you look at any industry where you're dealing with complex issues and you've got trusted employees and there needs to be a standard there are certifications more than that there are mandatory requirements security is not lacking in certifications we actually have a ton as you can see from the logos what we're lacking in is alignment and agreement",
        "and that's actually not unusual for us right we're an industry based on pointing out problems we are professionally cynical we have to be there's nothing wrong with that it's actually great quality what we're not so good at though is working together to find Solutions and to find alignment and that means that when you're looking at certifications We can't agree we don't agree we like to point problems and poke holes but not actually say this is what we should do about it and work together to build that what that means in the context of this conversation is that if people decide that we should have mandatory certification it will be handed to us rather than us having developed it for ourselves so in the first half of this year dcms ran a consultation on professionalization of cyber security one of the questions they asked is should certification be mandated now based on the response that they got they decided that it should not be mandated at this time",
        "it's a great phrase that if it doesn't send a shiver down your spine it damn well should honestly um now not mandated at this time one does not mean that they don't reserve the right to come back and mandate it later they absolutely do and two",
        "it doesn't mean that they're not going to push voluntary certification now government-backed certifications even if they're voluntary will carry weight because all of a sudden companies will start looking for them when they start hiring so even though it's not regulation it still will impact all of you and so you know these are conversations that you as Security Professionals need to be part of because it will shape your career it will shape your experience you're the one who will have to live with it so these are things that it's hard to stay up on I understand but it's really good to have an opportunity to hear about it and to think about how you might get involved and also think about are there certifications you particularly like that you would support are there certifications that you think could be improved how could you get involved in that what would that look like so the point of all of this really is to say that the bus is moving the question is",
        "do you want to be on the bus and helping decide where it stops and when or do you want to be assimilated by the Borg and you know have your orders handed to you now the good news is that this is an amazing Community the security Community is phenomenal and so much great stuff is already happening I've never seen a community that is so good at sort of sharing information and and",
        "um and educating each other and sharing passion and at these events we see it so much right and it's a really wonderful thing so we now have threatened Tel sharing groups some of them are kind of official and and formal like the ice acts and some of them are very much Community oriented volunteer and that's awesome",
        "it's great to have both and actually what's also awesome is to see them working with governments and saying hey we know that as governments you're going to get to do disruptive activities that we can't do as individuals let us participate in help which is really great we've also seen a lot of Security Professionals volunteering and providing assistance to those who maybe are below the security poverty line can't afford to do it themselves non-profits for example Healthcare organizations we saw",
        "a ton of this during the pandemic and it made me just crazy proud to be part of this community it's just a really really wonderful thing to see",
        "and then",
        "we also have this sort of real shift towards trying to educate and engage each other we see this at Defcon with the villages which are so fantastic and fun",
        "but today a lot of this is within this community right we do it at these events we do it at events like this that's great we should absolutely keep doing that but we're talking in Echo Chambers we're talking to each other all the time we're not breaking out of these walls and talking to the communities that aren't engaged because it's hard right who wants to go talk to people who are not engaged it's much more fun to talk to people who are interested but we have to figure out how to do that so I am the Cavalry is a Grassroots volunteer organization that aims to put people with deep security expertise with people outside of the security industry who have an ability to influence outcomes in sectors where to use their language bits and bites meet flesh and blood it's a very graphic explanation of what they do so Healthcare Transportation infrastructure",
        "giving Security Experts a Runway to go talk to Regulators or industry leaders",
        "in those sectors and to try and help create change so that they start building Security in from the ground up we need more initiatives like that that are aimed at breaking out of these these Echo chambers that we live in all the time",
        "public private partnership is another thing I think the UK is actually pretty good at this we we actually have a nice relationship with our government in this country so there are programs like ncsc's industry 100 where they focus",
        "they provide a Runway basically for uh industry to work with the government on solving real world problems",
        "um I also love the no more Ransom project a quick show of hands how many people are familiar with no more Ransom not enough see this is the problem so no more Ransom is a collaboration between law enforcement around the world and various security research entities and AV vendors and the goal is to provide free decryption tools for ransomware attacks what a great thing it's practical it solves a problem it saves people money I would love there to be more things like this this is great we also as we've heard a little bit from Jeff we're seeing more of the security security Community getting involved in policy engagement it's it's it's it's the sort of pointy end of the stick but it it's there so there are now some sort of cyber security advisory boards for the UK government and not just the UK government other governments around the world have these now which is great it's a it's a huge development uh Jeff mentioned the cabinet office has one dcms has some um these are really good and then there's also open calls for views pretty much every government pretty much every democratic government runs open calls for use and gives their people a chance to weigh in",
        "as Security Experts if they're talking about security topic they really really want to hear from you you are the people who have the knowledge to help them make sure they're doing the right thing it's hard to keep up with these it's hard to find out about them it that is a problem it's something the governments need to work on on how they do better to engage the community but you also can take the steps to try and find out about this and to try and get involved and then we're also seeing initiatives like Jeff mentioned uh policy at Defcon",
        "which are really designed to say hey we have a security community and we have a policy community and they're different communities but they share a goal so we should help bring them together so that they can get to know each other and they can figure out how to work together this is a great thing but today this largely only happens in the US which is why I'm really excited that dcms has come again to speak to you guys because we need to see more of that right",
        "and then there's a lot of non-profits so non-profits could be think tanks trade groups industry associations that have started to Advocate more around cyber security again it's great to have more voices but they're not the experts that you guys are they know how to navigate a world based on trying to build norms and standards and how to buy get buy-in but they don't have the expertise and security that you have from walking working on the front lines there are also a number of corporate pledges this is where companies basically commit they will not do a thing or they will do a things try and Advance Security mixed views on these but it's great the companies are actually standing up and making commitments around security and then there's a whole lot of stuff that's being done to try and develop new talent and that's coming both from the government and the private sector which is awesome because as we always hear there's a Workforce Development issue and we need to solve it another really really big topic that we're hearing about is around transparency of product",
        "security and this is really trying to do two things one we're trying to create a more empowered consumer base",
        "and hopefully over time if we Empower them more they'll get more engaged and more interested and they'll start asking questions rather than just having us throw information at them two we're trying to hold product vendors more",
        "accountable for what they put out there and the decisions they make whether they prioritize or do prioritize security should be something people know so some of the things that are happening in this area are software bill of materials s-bomb show of hands how many people have heard of S1 okay that's good lots of you um I bet most of you curse it uh but but the transparency aspect is good the realities of how you do it is uh it's more of a work in progress um coordinated vulnerability disclosure is another one that fits into this bucket that there's a really big push behind any CBD fans in here yes okay some of you like CBD that's good labeling",
        "labeling is something that's being looked at by another governments Around the World Singapore is running a um a process on this at the moment the UK government looked into labeling for products and you know and and got some feedback that made them go okay this is not simple this is going to be challenging so we have to go back to the drawing board and think about it more but there's generally this view that we need to have more transparency and more accountability and then of course there's press coverage",
        "um show of hands how many people think that the the mainstream press not not the not the security press that are in the room with us but the mainstream press do a good job in the way they cover security yeah I'm not entirely shocked by that response um it's good that we get coverage because it's good that we're raising awareness the way that it's covered is not so great as we all know and creates problems these front pages",
        "are from wannacry it's the fifth anniversary of wannacry this year and so you know I was getting ready to do this talk and I knew I was going to mention want to cry and so I asked a bunch of people this is a very unscientific method um I just asked a bunch of people as I encounter them people who don't work in security I was like Hey do you remember wannacry and everybody looked at me very blankly and so then I went well do you remember the big Cyber attack against the NHS that closed 80 hospitals across the country and everybody looked at me very blankly",
        "and I found that really depressing that we could have a situation where hospitals closed up and down the country and people don't remember it and the NHS got hit again this year right so there is more to do basically and I",
        "get it that you guys are not sitting around all day relaxing going oh if only some annoying British women would come and tell me what should I do with my time um you're busy you have full-time jobs I'm not asking you to take on more I'm asking you to think about whether there are small things that can be done differently what can we do to address consumer apathy",
        "it's a huge problem right consumers are still reusing passwords",
        "they don't really understand why it matters until they get hit then they really think it should be somebody else's problem to sort out for them and we",
        "judge them constantly for it",
        "we've spent 40 years telling people outside of security the security is really Technical and they won't get it and now they don't get it and we go ah what's wrong with consumers why can't they get this",
        "we did that we have to fix it and some of it will fix through technology and process we'll make it so that they don't have a choice we'll make multi-factor authentication the default for example which is not common enough today and needs to be more common but some of it much of it will be done through engagement we have to figure out how to talk to people differently we have to figure out how to stop confusing the hell out of people we rarely agree on anything and again as I said our industry is based on pointing out problems we're an industry that values accuracy and we don't want to lose that it's important but when we talk to people outside of our industry and we are so focused on that accuracy piece and being right and having the technical detail right it's incredibly alienating whether you're talking to individual consumers or Business Leaders it's incredibly alienating they have no idea what to focus on I've talked to security staff and when I say security staff sometimes they're full-time security staff sometimes they're I.T people who cover security as well because as we know not every organization can afford a dedicated security team but even in places where they do I've talked to people who've said to me we have analysis paralysis because what we hear from the industry is that everything is a priority a million things are a priority so which priority do we prioritize where do we get started consumers individual consumers won't even engage to that level they won't bother with the analysis they'll just disengage and move on that's what they've done for years",
        "and we make the problem worse with the language choices we use",
        "we use technical jargon all day amongst ourselves and that's fine I'll give you a minute to read the xycd it's fine",
        "it's fine to use jargon with each other but when we talk to other people we've got to focus on the impact we've got to focus on why it should matter to them we have to speak their language it's actually honestly it's like any good negotiation you start where the people you want to negotiate with are whether what they care about and then you work them back to where you are and if we're not using jargon we're going way the other way who wants to talk about cyber Pearl Harbor uh or cyber bullets pew pew we had a lot of that in the run-up to Russia Ukraine um and it's really alienating for people it's scary they don't know what to make of it we also really love who knows the term fud fear uncertainty and doubt we love to use that to tell people the world is on fire and you know",
        "kind of is but messages of Hope and positivity will actually make people feel that they can be part of the conversation and part of the process much more than just making them feel like they're being told off",
        "we're not always known for our empathy",
        "Dan yesterday talked about a day from accounting",
        "the truth is we're all day from accounting",
        "clicking on links is sort of what you do on the internet and as deep fakes get better phishing attacks will get so much more credible",
        "and even the people in this room who are really Savvy and really cautious",
        "will potentially fall victim to them we have to stop a dialogue where we make fun of people for falling victim to things and where we make them feel ashamed because until we destigmatize it we",
        "can't actually have a really honest conversation about it people don't want to report things today because they're worried about what will happen they're worried about getting in trouble they're worried about loss of customer confidence they're worried about getting mocked they're worried about a loss of stock value and that means we as a community are poorer for it because we lack the data on what's really happening so actually we need to figure out how to shift the Dynamics on this we have to take the recrimination out of security because otherwise we're never going to have those positive conversations and we'll never get buy-in from leadership who by the way are the people who give us our resources who give us the money to do things but today leadership we know are bombarded I mean if you're in Europe the chances are your leadership are dealing with a whole lot of questions around the economy and they're trying to not have to be in a situation of making difficult decisions about layoffs and so when they get told you know security is important too",
        "and we've made it so alien for them and scary and hard to get involved in the conversation they're going to do what they do today they're going to go you know what we're not really a Target it's fine because people don't understand what it means to be a target of cybercrime because we haven't made it easy for them to understand that so we have to get better at how we talk about this or people will always think of it as somebody else's problem",
        "that's what we've done we've told them it's not their thing to worry about it's our thing to worry about and it is because we're the experts and we also really want to have jobs and there's great job security in being the expert until people stop caring all together and that's the problem right we have to figure out how to get them involved in the conversation and we have to reach new audiences to do that",
        "talking to people in small to medium businesses super hard because they have so many messages and so little resources but small to medium businesses make up the majority of our economy in many cases they make up the organizations that provide our critical infrastructure",
        "and we don't talk to them well we talk to each other well so we have to figure out how to change that dynamic",
        "insecurity",
        "we have a little thing we like to say there's no silver bullets there's no easy wins or quick fixes right and this is true absolutely true all of the things I'm throwing at you today do not have easy wins or quick fixes the problem is that it can lead to this thing called the Lord of triviality so in 1957 a guy called C northcott",
        "Parkinson had to learn his name it's quite the name he came out with this thing around the law of triviality and he used an example to illustrate it the example he used was of a group of people building a fictional power station and rather than focusing on the very very very important necessary questions the difficult questions",
        "of how to make the power station safe instead they spent all of their time arguing over what the employee bike sheds should be made out of",
        "and maybe when you think about it you can think of situations in security where you've seen something a little bit like this where we've focused on solving problems that maybe aren't quite as critical or maybe we've focused on solving a piece of a very critical problem but the piece that we focused on hasn't been the piece that we really needed to focus on now if that happens in a security industry amongst people who actually really know what they're talking about and spend all day talking about it it's annoying but it's it's manageable right and and we can get past it what happens when it's governments",
        "who are not generally deep Security Experts they haven't worked years in security what happens then when they're trying to come up with Solutions and it devolves into an exercise of being seen to do a thing because actually it's really hard for them to solve the problem this is why we need more voices involved in policy these are pictures of uh Security Experts well Security Experts are me uh testifying to government on security issues the",
        "reason there's a picture of me included is because I could only find two pictures from the UK",
        "now it's possible that there's just not a lot of pictures out there but lots of people are testifying every day to UK Parliament I suspect that it's more likely that there's just not that many people who've done it and hey you should do it's really good fun highly recommend it they need to hear from you guys because you're the experts",
        "so to recap",
        "this is the reality of your lives right we deal with a huge amount of complexity all the time and you've constantly got messages and noise being thrown at you",
        "but we we're a point of change we're the second generation of security and we have an opportunity to decide what we want to do differently we have to do something different because the landscape is changing and and honestly we're not winning",
        "governments are engaged which means things are going to happen that will impact you and consumers are not engaged which means we're constantly rolling rocks uphill as people throw Spears at us from the top which I don't know about you but I don't enjoy that",
        "the stakes are too high and so change is definitely going to come and so the question for all of you is what do you want the future to be as the people who have experience and knowledge in security and enough passion to be here in this room you are powerful you are a gift and I'm telling you that both your industry and actually your Society needs",
        "you so my question to all of you is what kind of red shirt do you want to be",
        "thank you very much you've been an amazingly patient audience enjoy the rest of the conference",
        "foreign",
        "[Music]"
    ]
}