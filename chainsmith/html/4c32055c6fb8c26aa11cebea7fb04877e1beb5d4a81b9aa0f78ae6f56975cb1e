<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: Effusion – a new sophisticated injector for Nginx web servers</title>
<meta name="description" content="At VB2013 Evgeny Sidorov spoke about three modern approaches used by attackers to embed malicious code into HTTP responses. One such approach was the use of web-server modules for malware distribution. Here, Evgeny and his colleagues describe ‘Effusion’ – a new piece of malware that uses malicious modules for an Nginx web server, and which was used in a massive infection campaign in the third quarter of 2013." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 1655;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/remo_expand/blocks/remo_expand/templates/vbexpand/view.css" />
<script type="text/javascript" src="/packages/remo_expand/js/jquery.color.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/remo.expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<div class="titlepage" xmlns=""><div><div><h1 class="title" xmlns="http://www.w3.org/1999/xhtml"><a id="vb201401-Effusion"></a>Effusion &ndash; a new sophisticated injector for Nginx web servers</h1></div><div><p class="pubdate" xmlns="http://www.w3.org/1999/xhtml">2014-01-07</p></div><div><div class="authorgroup" xmlns="http://www.w3.org/1999/xhtml"><div class="author titlepage"><h3 class="author"><span class="firstname">Andrew</span> <span class="surname">Kovalev</span></h3><span class="orgname">Yandex</span>, <span class="orgdiv">Russia</span></div><div class="author titlepage"><h3 class="author"><span class="firstname">Konstantin</span> <span class="surname">Otrashkevich</span></h3><span class="orgname">Yandex</span>, <span class="orgdiv">Russia</span></div><div class="author titlepage"><h3 class="author"><span class="firstname">Evgeny</span> <span class="surname">Sidorov </span></h3><span class="orgname">Yandex</span>, <span class="orgdiv">Russia</span></div><div class="author titlepage"><h3 class="author"><span class="firstname">Andrew</span> <span class="surname">Rassokhin</span></h3><span class="orgname">Yandex</span>, <span class="orgdiv">Russia</span></div><b class="editedby">Editor: </b><span class="editor"><span class="firstname">Helen</span> <span class="surname">Martin</span></span></div></div><div><div class="abstract" xmlns="http://www.w3.org/1999/xhtml"><p class="title"><b>Abstract</b></p><p>At VB2013 Evgeny Sidorov spoke about three modern approaches used by attackers to embed malicious code into HTTP responses. One such approach was the use of web-server modules for malware distribution. Here, Evgeny and his colleagues describe &lsquo;Effusion&rsquo; &ndash; a new piece of malware that uses malicious modules for an <span class="emphasis"><em>Nginx</em></span> web server, and which was used in a massive infection campaign in the third quarter of 2013.</p></div></div><div><p class="copyright" xmlns="http://www.w3.org/1999/xhtml"><i>Copyright &copy; 2014 Virus Bulletin</i></p></div></div><hr /></div>
<div class="ccm-remo-expand">
<div id="ccm-remo-expand-title-2434" class="ccm-remo-expand-title ccm-remo-expand-closed" data-expander-speed="200">Table of contents</div><div id="ccm-remo-expand-content-2434" class="ccm-remo-expand-content"><div class="toc"><dl><dt><span class="sect1"><a href="#id3699408"></a></span></dt><dt><span class="sect1"><a href="#id4318797">Introduction</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id3100104">Malware representation </a></span></dt><dt><span class="sect2"><a href="#id3618333">Analysis of the initialization process</a></span></dt><dt><span class="sect2"><a href="#id4551952">Code injection</a></span></dt><dt><span class="sect2"><a href="#id4106540">Remote control functions</a></span></dt><dt><span class="sect2"><a href="#id3219245">Monitoring of the processes in the system and detection of root activity</a></span></dt><dt><span class="sect2"><a href="#id3619287">Configuration decryption algorithm</a></span></dt><dt><span class="sect2"><a href="#id4693708">Format of the configuration</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id2162724">Black market</a></span></dt><dt><span class="sect1"><a href="#id2602411">Infection campaign</a></span></dt><dt><span class="sect1"><a href="#id2602414">Conclusion</a></span></dt></dl></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3699408"></a></h2></div></div></div><p>This article is a continuation of our research into modern methods of web malware distribution, the initial results of which were presented at VB2013. In our presentation, we spoke about three modern approaches used by attackers to embed malicious code into HTTP responses [<span class="citation"><a href="#citation.1">1</a></span>]. One of those approaches was the use of web-server modules for malware distribution, and as an example of this we described malicious modules for an <span class="emphasis"><em>Apache</em></span> web server. In this article we will describe &lsquo;Effusion&rsquo; &ndash; a new piece of malware that uses a similar approach, but for an <span class="emphasis"><em>Nginx</em></span> web server, and which was used in a massive infection campaign in the third quarter of 2013. </p><p>All the data for this article has been obtained with the use of <span class="emphasis"><em>Yandex</em></span>&rsquo;s anti-virus system [<span class="citation"><a href="#citation.2">2</a></span>]. </p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4318797"></a>Introduction</h2></div></div></div><p>The methods by which malicious code is distributed in drive-by download attacks are constantly evolving. One of the first methods to be used involved adding malicious code to static content (HTML templates, JavaScript files, etc.) &ndash; however, after some time such modifications became easy for anti virus products to detect using signatures. To complicate signature analysis, attackers began to use obfuscation and encryption techniques. In response to this, anti-virus products started to employ JavaScript emulators (sandboxes), which did a better job of detecting malicious code in web pages. The next stage in the evolution of drive by downloads involved modifying the source code of content management systems (CMS) such as <span class="emphasis"><em>Joomla</em></span>, <span class="emphasis"><em>WordPress</em></span>, <span class="emphasis"><em>DLE</em></span>, etc. The malicious code began checking the referer (e.g. for referral from SERPs) and the user agent (the code is not displayed to search bots, mobile redirects, etc.), as well as the user session (to determine whether the user is an administrator) and, depending on the results, deciding whether or not to insert malicious code into the web page. However, it has become a straightforward task for the majority of webmasters to remove such an infection from their web servers &ndash; in fact, there are even special scripts that help with this task [<span class="citation"><a href="#citation.3">3</a></span>]. </p><p>The next step of the evolution involved embedding a piece of malicious code into the body of an HTTP response. This approach is heavily employed today, and is the method used by Effusion &ndash; which injects malicious code into the HTTP responses of <span class="emphasis"><em>Nginx</em></span> web servers. </p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id3100104"></a>Malware representation </h3></div></div></div><p>At the end of November 2013, we received several calls for help from webmasters who were having difficulty removing infections from their websites. During the investigation of these incidents we found (and analysed) two malicious samples. </p><p>We also discovered that the attackers had modified the /etc/init.d/nginx script in order to load a malicious shared object with the name &lsquo;/usr/lib/libnginx.so&rsquo; into the <span class="emphasis"><em>Nginx</em></span> address space. The shared object was loaded using the LD_PRELOAD technique. Part of the modified script is shown in <a href="#figure.1">Figure 1</a>. </p><div class="figure"><a id="figure.1"></a><div class="mediaobject"><img alt="Part of the modified /etc/init.d/nginx script." src="/uploads/images/figures/2014/01/1.png" /></div><p class="title"><b>Figure&nbsp;1.&nbsp;Part of the modified /etc/init.d/nginx script.</b></p></div><p>We found that the malware is represented by only a single shared object. We analysed two such shared objects with the following MD5 hashes:</p><pre class="programlisting">9f1796452a20fca0093d7a4954efad2d
f26ac64f927b0f445cd3f19d91294624
</pre><p>We checked the samples using the <span class="emphasis"><em>VirusTotal</em></span> service &ndash; the results are shown in <a href="#table.1">Table 1</a>.</p><div class="table"><a id="table.1"></a><table border="1" summary="The results of checking the samples using the VirusTotal
        service."><colgroup><col /><col /><col /></colgroup><thead><tr><th align="center">Hash</th><th align="center">Date</th><th align="center">VirusTotal results</th></tr></thead><tbody><tr><td>9f1796452a20fca0093d7a4954efad2d</td><td>2013-12-05</td><td>1/48</td></tr><tr><td>&nbsp;</td><td>2013-11-25</td><td>1/48</td></tr><tr><td>f26ac64f927b0f445cd3f19d91294624</td><td>2013-12-05</td><td>0/48</td></tr><tr><td>&nbsp;</td><td>2013-11-27</td><td>0/48</td></tr></tbody></table><p class="title"><b>Table&nbsp;1.&nbsp;The results of checking the samples using the VirusTotal service.</b></p></div><p>We found that the ELF headers in the samples were corrupted in order to complicate their analysis. The first sample was detected only by <span class="emphasis"><em>Avira</em></span>&rsquo;s <span class="emphasis"><em>AntiVir</em></span> product, which detected it as HEUR/ELF.Malformed. The second sample was not detected by any product. The samples were compiled for the x64 platform with the &lsquo;-fPIC&rsquo; key.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id3618333"></a>Analysis of the initialization process</h3></div></div></div><p>The LD_PRELOAD technique allows the shared object to be the first to be loaded and allows it to hook different functions easily. If a standard library function is reimplemented in such an object, it will be replaced by that of the shared object. The malicious sample contains its own implementation of the setsid function, so this function is invoked by <span class="emphasis"><em>Nginx</em></span> instead of the original one. </p><p>The reimplementation of the setsid function is used for the initialization of the malicious sample. First, the dlsym function is executed in order to obtain the address of the original setsid function, then the original setsid is executed. Next, the sample checks whether initialization has already been performed. If initialization is required, it will continue with the execution. The initialization process involves the following steps: </p><div class="orderedlist"><ol type="1"><li><p>The base address is obtained by searching for the ELF signature in memory. A type of ABI (application binary interface) and a file class of the shared object are obtained from the ELF header and stored in memory for future use.</p></li><li><p>The malicious configuration, stored in the data segment, is decrypted and parsed. If the configuration contains a particular filename, then this file will be opened and mapped into the process memory, and additional configuration information (an array with blacklisted IP addresses) will be loaded. If there is no such a filename, a part of memory will be allocated via the mmap function call. This memory will be used for inter process communications. </p></li><li><p>The process is cloned via a call to the fork function and the child process will be used for remote control, system process monitoring and root activity detection functions. </p></li><li><p>The addresses of the zlibVersion and inflateInit2 functions are obtained via the corresponding dlsym function calls and stored in memory. They will be used for the processing of compressed HTTP responses.</p></li></ol></div><p>An overview of the hooking of the setsid function is shown in <a href="#figure.2">Figure 2</a>. </p><div class="figure"><a id="figure.2"></a><div class="mediaobject"><img alt="Overview of the hooking of the setsid function" src="/uploads/images/figures/2014/01/2.png" /></div><p class="title"><b>Figure&nbsp;2.&nbsp;Overview of the hooking of the setsid function</b></p></div><p>During the loading of the shared object, an initialization function, _init_proc, is executed. In this function, the ngx_http_copy_filter_init function is hooked by replacing its address in the ngx_http_copy_filter_module_ctx structure; the address of the reference to this function in the structure is hard coded in the shared object and differs from sample to sample. </p><div class="figure"><a id="figure.3"></a><div class="mediaobject"><img alt="Addresses of several Nginx functions in the shared object are hard coded." src="/uploads/images/figures/2014/01/3.png" /></div><p class="title"><b>Figure&nbsp;3.&nbsp;Addresses of several Nginx functions in the shared object are hard coded.</b></p></div><p>The hooking of ngx_http_copy_filter_init in turn embeds pointers to the custom HTTP header and HTTP body filters (defined in the shared object) into <span class="emphasis"><em>Nginx</em></span>&rsquo;s filter chain. These functions will be executed during the processing of the HTTP response header and HTTP response body, respectively. The embedding is performed by replacing the values of the global variables ngx_http_top_header_filter and ngx_http_top_body_filter in <span class="emphasis"><em>Nginx</em></span>&rsquo;s memory using addresses of special functions in the shared object. The original values of these variables are stored in memory and will be used in the embedded filters. Additional information about the handlers and filters in the <span class="emphasis"><em>Nginx</em></span> web server can be found in [<span class="citation"><a href="#citation.4">4</a></span>]. <a href="#figure.4">Figure 4</a> shows a typical HTTP request processing cycle in <span class="emphasis"><em>Nginx</em></span> &ndash; the filter chain in which the functions are embedded is underlined. </p><div class="figure"><a id="figure.4"></a><div class="mediaobject"><img alt="Typical HTTP request processing cycle in an Nginx web server." src="/uploads/images/figures/2014/01/4.png" /></div><p class="title"><b>Figure&nbsp;4.&nbsp;Typical HTTP request processing cycle in an Nginx web server.</b></p></div><p>The embedded functions will be used for analysis of HTTP traffic and for injection of malicious code. The addresses for the replacements (in other words, the addresses of global references ngx_http_top_header_filter and ngx_http_top_body_filter) are also hard coded in the shared object. This completes the initialization process. An overview of the hooking of ngx_http_copy_filter_init is shown in <a href="#figure.5">Figure 5</a>. </p><div class="figure"><a id="figure.5"></a><div class="mediaobject"><img alt="Overview of the hooking of the ngx_http_copy_filter_init function." src="/uploads/images/figures/2014/01/5.png" /></div><p class="title"><b>Figure&nbsp;5.&nbsp;Overview of the hooking of the ngx_http_copy_filter_init function.</b></p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4551952"></a>Code injection</h3></div></div></div><p>The two filters embedded into <span class="emphasis"><em>Nginx</em></span>&rsquo;s filter chain are used to provide code injection and remote control functions. Let&rsquo;s start with the malicious HTTP header filter. During the execution of the filter the following steps are performed:</p><div class="orderedlist"><ol type="1"><li><p>The ctx field of the ngx_http_request_t structure (the parameter of the original function) is obtained and checked.</p></li><li><p>If the pointer to ctx is NULL, then 160 bytes of memory will be allocated and the pointer to the memory area will be assigned to ctx. A special marker, 0xDEADBEEF, will be written into the memory.</p></li><li><p>The ctx memory is checked for the presence of the 0xDEADBEEF marker. If the marker is not found, the hook will execute the original ngx_http_top_header_filter and will exit after execution.</p></li><li><p>The filter performs several checks. For example, it checks whether the request method is &lsquo;GET&rsquo;, whether the content length is a non-zero value, whether the status code is 200, etc. If any of these checks fail, the execution of the hook will be interrupted and the original function will be invoked.</p></li><li><p>If an HTTP request contains the &lsquo;Pragma&rsquo; header and remote control is allowed by the current configuration, then the filter will attempt to process it as a management request.</p></li><li><p>If it is not a management request, the filter performs more checks. It checks whether the current time value is greater than a particular value, that the client IP address isn&rsquo;t blacklisted and malicious code hasn&rsquo;t already been injected into the HTTP response for this client, that the URI doesn&rsquo;t contain certain forbidden substrings listed in the configuration, that the processed HTTP response has a Content-Type header with a proper value, that the client has a proper user-agent and referer headers, that root isn&rsquo;t logged on, and that a forbidden process isn&rsquo;t being run. If the processed HTTP header is suitable for code injection, information about it will be stored in the ctx field.</p></li><li><p>The original filter is executed.</p></li></ol></div><p>IP addresses for which a piece of malicious code has already been injected into an HTTP response are added to the hash table in order to avoid repeated infection of the same client. The hash table structure is employed to avoid performance issues. In addition, if a client requests a URI that contains a forbidden substring, then the IP address of the client will be placed on the array in the memory space that was allocated during the initialization process, and harmful code won&rsquo;t be injected into the client. </p><p>Now let&rsquo;s consider the case of an embedded HTTP body filter, which is used for the processing of the HTTP response body. The following steps are performed during the execution of this filter: </p><div class="orderedlist"><ol type="1"><li><p>The filter checks that the ctx field value is not NULL, and checks for the presence of the 0xDEADBEEF marker in the ctx memory.</p></li><li><p>The information from the ngx_http_top_header_filter is checked, and if this HTTP response has been marked as suitable for injection, the execution will be continued.</p></li><li><p>The filter checks whether the processed response is an answer to a management HTTP request. If it is, it will be processed as a management request. </p></li><li><p>The filter searches for a string in the response body before or after which the malicious code will be injected, and then the injection is performed. The string is defined in the configuration.</p></li><li><p>The original ngx_http_top_body_filter is executed.</p></li></ol></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4106540"></a>Remote control functions</h3></div></div></div><p>Effusion&rsquo;s remote control is accomplished via a specially crafted HTTP request that must contain the &lsquo;Pragma&rsquo; header. During the processing of such a request, the value of the &lsquo;Pragma&rsquo; header is decoded from BASE64, then the first eight bytes of decoded data are decrypted and the first four bytes of the eight byte block are checked for the presence of the 0xDEADBEEF marker. The last four bytes in this eight byte block denote the remote command. The available types of command are shown in <a href="#table.2">Table 2</a>.</p><div class="table"><a id="table.2"></a><table border="1" summary="The remote commands available."><colgroup><col /><col /></colgroup><thead><tr><th align="center">The last DWORD value in first eight bytes</th><th align="center">Description of remote command</th></tr></thead><tbody><tr><td>10001h</td><td>Get status of the malware</td></tr><tr><td>10002h</td><td>Update malware configuration</td></tr><tr><td>10003h</td><td>Resume code injection</td></tr><tr><td>10004h</td><td>Pause code injection</td></tr><tr><td>10005h</td><td>Backconnect to remote server</td></tr></tbody></table><p class="title"><b>Table&nbsp;2.&nbsp;The remote commands available.</b></p></div><p>The other part of data is the payload, which is encrypted only in the case of update malware configuration messages. For example, if the attacker wanted the malware to perform a backconnect and route his commands to an opened root shell, he would send an HTTP request with the &lsquo;Pragma&rsquo; header and the value of this header must be in the following form:</p><pre class="programlisting">BASE64_ENCODE(
XTEA_ECB_ENCRYPT(key, 0xDEADBEEF||0x10005)||IP address||Port
)
</pre><p>where &lsquo;key&rsquo; is the encryption key which is stored in the data segment of the sample; the backconnect is performed in the child process which appears after the call to the fork function during the initialization of the shared object. An overview of the remote control function is shown in <a href="#figure.6">Figure 6</a>.</p><div class="figure"><a id="figure.6"></a><div class="mediaobject"><img alt="Overview of the remote control function." src="/uploads/images/figures/2014/01/6.png" /></div><p class="title"><b>Figure&nbsp;6.&nbsp;Overview of the remote control function.</b></p></div><p>(To view a larger version of Figure 6 please click <a href="/uploads/images/figures/2014/01/6-large.png" target="_top">here</a>.)</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id3219245"></a>Monitoring of the processes in the system and detection of root activity</h3></div></div></div><p>The malware has functions for scanning the list of running processes and for detection of root activity in the system. Such functions are implemented in order to protect the shared object from anti-rootkit software such as <span class="emphasis"><em>rkhunter</em></span>, and from being detected by the server administrator. The functionality acts in the child process which appears after the call to the fork function during the initialization of the shared object. </p><p>While monitoring system processes, the shared object reads the content of the /proc directory. Each record is examined to determine whether it is a number or a string. After that, a path to a command line for each process is obtained in the form of &lsquo;/proc/%d/cmdline&rsquo;, then the values of the command lines are read and checked for the presence of forbidden process names. If a forbidden process is being run, the shared object stops acting. </p><p>As for the detection of root activity, the malware obtains the IDs of the processes being run, then for each process the status is read (&lsquo;/proc/%d/status&rsquo;). Next, a UID is obtained from each status and compared with zero. If there is a process whose status contains a zero UID, then for that process opened file descriptors are obtained by reading &lsquo;/proc/%d/fd&rsquo;. After that the malware searches through opened file descriptors for those that contain the &lsquo;pts&rsquo; substring, and the modification time of such descriptors is obtained via a call to the lstat function. Eventually, if the difference between the current time value and the value of the modification time is less than a constant set in the configuration, the malware decides that root is logged in and stops acting. </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id3619287"></a>Configuration decryption algorithm</h3></div></div></div><p>Every sample we analysed contained initial configuration stored in the data segment in an encrypted form. The decryption key is also stored in the data segment. The first byte of the encryption key is used as an offset inside the data segment array and is used to find a valid start address of the ciphertext.</p><div class="figure"><a id="figure.7"></a><div class="mediaobject"><img alt="to find valid encrypted data in the shared object." src="/uploads/images/figures/2014/01/7.png" /></div><p class="title"><b>Figure&nbsp;7.&nbsp;to find valid encrypted data in the shared object.</b></p></div><p>At first, only the first eight bytes are decrypted, then the malware checks whether the last four bytes are equal to 0xDEADBEEF. If they are, then the first four bytes represent the length of the encrypted data. After this the rest of the ciphertext is decrypted. <a href="#figure.8">Figure 8</a> shows pseudo code of the decryption algorithm. </p><div class="figure"><a id="figure.8"></a><div class="mediaobject"><img alt="The decryption algorithm used in Effusion." src="/uploads/images/figures/2014/01/8.png" /></div><p class="title"><b>Figure&nbsp;8.&nbsp;The decryption algorithm used in Effusion.</b></p></div><p>We analysed this code and found that this is an implementation of the XTEA encryption algorithm [<span class="citation"><a href="#citation.5">5</a></span>], [<span class="citation"><a href="#citation.6">6</a></span>] with the number of rounds equal to 11; the mode of operations is ECB [<span class="citation"><a href="#citation.7">7</a></span>], [<span class="citation"><a href="#citation.8">8</a></span>]. Different encryption keys are used in different samples. We developed a special tool for the decryption of such configurations [<span class="citation"><a href="#citation.9">9</a></span>]. </p><p>Configuration of the shared object can be updated via specially crafted HTTP requests &ndash; the XTEA algorithm in ECB mode is also used for data decryption in such requests. </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4693708"></a>Format of the configuration</h3></div></div></div><p>Examples of the initial configuration and updated configuration of the samples are presented in <a href="#figure.9">Figure 9</a> and <a href="#figure.10">Figure 10</a>. The first part of the configuration contains special flags and offsets to data in the rest of the file.</p><div class="figure"><a id="figure.9"></a><div class="mediaobject"><img alt="The initial configuration." src="/uploads/images/figures/2014/01/9.png" /></div><p class="title"><b>Figure&nbsp;9.&nbsp;The initial configuration.</b></p></div><div class="figure"><a id="figure.10"></a><div class="mediaobject"><img alt="Strings from the updated configuration of Effusion." src="/uploads/images/figures/2014/01/10.png" /></div><p class="title"><b>Figure&nbsp;10.&nbsp;Strings from the updated configuration of Effusion.</b></p></div><p>The configuration format is described in <a href="#table.3">Table 3</a>. </p><p>None of the samples we analysed contained malicious code for injection in their initial configuration &ndash; such malicious code appeared only after an update of the configuration via special management HTTP requests. </p><div class="table"><a id="table.3"></a><table border="1" summary="The format of the malware configuration."><colgroup><col /><col /><col /></colgroup><thead><tr><th align="center">Offset </th><th align="center">Size in bytes</th><th align="center">Description</th></tr></thead><tbody><tr><td>0</td><td>4</td><td>This field contains the number of eight byte blocks in the configuration &ndash; in other words, the length of the configuration in eight-byte blocks</td></tr><tr><td>4</td><td>4</td><td>Special marker 0xDEADBEEF</td></tr><tr><td>8</td><td>4</td><td>Time interval which represents an IP address lifetime in the hash table containing IP addresses of the clients </td></tr><tr><td>12</td><td>4</td><td>Offset to &lsquo;Content-Type&rsquo; values for future checks (permitted values of &lsquo;Content Type&rsquo; header)</td></tr><tr><td>16</td><td>4</td><td>If the value in this field is 1, then malicious code will be injected before particular strings which are also stored in the configuration; if the value is 2, then malicious code will be injected after the strings</td></tr><tr><td>20</td><td>4</td><td>Offset to the strings before or after which malicious code can be injected into the HTTP response</td></tr><tr><td>24</td><td>4</td><td>Offset to a piece of malicious code for injection</td></tr><tr><td>28</td><td>4</td><td>Offset to a list of strings for the &lsquo;User Agent&rsquo; header check</td></tr><tr><td>32</td><td>4</td><td>Offset to a list of strings with forbidden IP address ranges &ndash; e.g. 127.0.0.0/8</td></tr><tr><td>36</td><td>4</td><td>Offset to a list of forbidden substrings in URIs</td></tr><tr><td>40</td><td>4</td><td>Offset to the name of a special file for mapping into memory</td></tr><tr><td>44</td><td>4</td><td>Check special management header in HTTP headers flag &ndash; if this flag has a non zero value, remote control is allowed through HTTP requests with the &lsquo;Pragma&rsquo; header</td></tr><tr><td>48</td><td>4</td><td>Offset to the strings used by the malware &ndash; in other words, an offset to strings used in regular procedures in the shared object</td></tr><tr><td>52</td><td>4</td><td>Offset to the list of names of forbidden processes</td></tr><tr><td>56</td><td>4</td><td>Offset to a filename with the list of forbidden IP addresses </td></tr><tr><td>60</td><td>4</td><td>Time interval for detection of root activity in the system</td></tr><tr><td>64</td><td>4</td><td>Time for silence &ndash; malicious code won&rsquo;t be injected after this point in time</td></tr><tr><td>68</td><td>4</td><td>Offset to a list of strings for &lsquo;Referer&rsquo; header checks</td></tr></tbody></table><p class="title"><b>Table&nbsp;3.&nbsp;The format of the malware configuration.</b></p></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id2162724"></a>Black market</h2></div></div></div><p>Effusion appeared on the black market on 13 November 2013, costing $2,500 &ndash; it is sold only to a limited number of verified customers. Its author also developed &lsquo;Trololo_mod&rsquo;, a malicious module for an <span class="emphasis"><em>Apache</em></span> web server. According to a seller on one of the underground forums, the product is distributed in binary form and doesn&rsquo;t need developer packages to be installed on the target server. An attacker just needs to run the builder that will install the malware; the process takes between 60 and 180 seconds. The malware doesn&rsquo;t require a C&amp;C server for its activity.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id2602411"></a>Infection campaign</h2></div></div></div><p>As stated at the beginning of this article, Effusion was used in a massive infection campaign which started in the middle of November 2013. <a href="#figure.11">Figure 11</a> shows the number of infected hosts and their appearances in <span class="emphasis"><em>Yandex</em></span> search results (with alerts) on a day by-day basis. </p><div class="figure"><a id="figure.11"></a><div class="mediaobject"><img alt="Hosts infected by Effusion and their appearance in Yandex search results (with alerts)." src="/uploads/images/figures/2014/01/11.png" /></div><p class="title"><b>Figure&nbsp;11.&nbsp;Hosts infected by Effusion and their appearance in Yandex search results (with alerts).</b></p></div><p>The victims were servers hosting moderately popular websites. Effusion was used to embed code which loaded malicious content from web resources with URLs in the following format: </p><pre class="programlisting">hxxp://rdomn[0-9]{8,11}.hopto.me</pre><p>In order to embed harmful code, Flash objects were also used. Eventually, users were redirected to a landing page of a Nuclear exploit kit, and a piece of ransomware was installed onto their systems. </p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id2602414"></a>Conclusion</h2></div></div></div><p>Effusion is the most sophisticated injector for *nix systems that we have come across. In a nutshell, it has the following peculiarities:</p><div class="itemizedlist"><ul type="disc"><li><p>ELF headers are modified in order to complicate analysis.</p></li><li><p>Modified functions similar to strlen, inet_addr, etc. are used instead of regular ones.</p></li><li><p>The XTEA algorithm (11 rounds) in ECB mode is used for encryption/decryption.</p></li><li><p>Hash tables are used in order to avoid performance issues.</p></li><li><p>There are functions that monitor forbidden processes.</p></li><li><p>Advanced techniques are used for checking root activity.</p></li><li><p>Updated configuration is stored only in RAM and is never dumped to disk.</p></li></ul></div><p>The appearance of this malware confirms the fact that attackers are moving from the practice of infecting individual files to infecting the executable files of web servers. The old infection methods are gradually coming to nought, clearing a way for modern hi-tech methods of malicious code embedding which are hard to detect using traditional approaches. Yandex uses a traffic analysis approach to detect such types of infection: an anti-virus robot browses web pages, emulates legitimate user behaviour and analyses HTTP responses, so harmful code injected into web pages can be detected. The SafeBrowsing API [<span class="citation"><a href="#citation.10">10</a></span>] can be used to check whether a particular site is infected, and additional information about detected malicious code is available at [<span class="citation"><a href="#citation.11">11</a></span>].</p><div class="bibliography"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id2119779"></a>Bibliography</h3></div></div></div><div class="bibliomixed"><a id="citation.1"></a><p class="bibliomixed">[1] Rassokhin, A.; Sidorov, E. Embedding malware in websites using executable web server files. Proceedings of the 23rd Virus Bulletin International Conference, 2013.</p></div><div class="bibliomixed"><a id="citation.2"></a><p class="bibliomixed">[2] <span class="bibliosource"><a href="https://company.yandex.ru/technologies/antivirus/" target="_blank">http://company.yandex.ru/technologies/antivirus/</a></span>.</p></div><div class="bibliomixed"><a id="citation.3"></a><p class="bibliomixed">[3] <span class="bibliosource"><a href="https://www.revisium.com/ai/" target="_blank">http://www.revisium.com/ai/</a></span>.</p></div><div class="bibliomixed"><a id="citation.4"></a><p class="bibliomixed">[4] Emiller&rsquo;s Guide To Nginx Module Development. <span class="bibliosource"><a href="http://www.evanmiller.org/nginx-modules-guide.html" target="_blank">http://www.evanmiller.org/nginx-modules-guide.html</a></span>.</p></div><div class="bibliomixed"><a id="citation.5"></a><p class="bibliomixed">[5] Wheeler, D.; Needham, R. Correction to XTEA. <span class="bibliosource"><a href="http://www.movable-type.co.uk/scripts/xxtea.pdf" target="_blank">http://www.movable-type.co.uk/scripts/xxtea.pdf</a></span>.</p></div><div class="bibliomixed"><a id="citation.6"></a><p class="bibliomixed">[6] Wikipedia. XTEA. <span class="bibliosource"><a href="https://en.wikipedia.org/w/index.php?title=XTEA&amp;oldid=558387953" target="_blank">http://en.wikipedia.org/w/index.php?title=XTEA&amp;oldid=558387953</a></span>.</p></div><div class="bibliomixed"><a id="citation.7"></a><p class="bibliomixed">[7] Wikipedia. Block cipher mode of operation. <span class="bibliosource"><a href="https://en.wikipedia.org/w/index.php?title=Block_cipher_mode_of_operation&amp;oldid=582012907" target="_blank">http://en.wikipedia.org/w/index.php?title=Block_cipher_mode_of_operation&amp;oldid=582012907</a></span>. </p></div><div class="bibliomixed"><a id="citation.8"></a><p class="bibliomixed">[8] Schneier, B. Applied Cryptography. John Wiley &amp; Sons, 1996.</p></div><div class="bibliomixed"><a id="citation.9"></a><p class="bibliomixed">[9] GitHub. Effusion. <span class="bibliosource"><a href="https://github.com/e-sidorov/Effusion" target="_blank">https://github.com/e-sidorov/Effusion</a></span>.</p></div><div class="bibliomixed"><a id="citation.10"></a><p class="bibliomixed">[10] Yandex Safe Search. <span class="bibliosource"><a href="http://safe.yandex.com/" target="_blank">http://safe.yandex.com/</a></span>.</p></div><div class="bibliomixed"><a id="citation.11"></a><p class="bibliomixed">[11] Yandex Webmaster. <span class="bibliosource"><a href="https://webmaster.yandex.com/" target="_blank">http://webmaster.yandex.com/</a></span>.</p></div></div></div> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=Effusion – a new sophisticated injector for Nginx web servers&url=https://www.virusbulletin.com/virusbulletin/2014/01/effusion-new-sophisticated-injector-nginx-web-servers"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2014/01/effusion-new-sophisticated-injector-nginx-web-servers'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2014/01/effusion-new-sophisticated-injector-nginx-web-servers&title=Effusion – a new sophisticated injector for Nginx web servers"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2014/01/effusion-new-sophisticated-injector-nginx-web-servers&t=Effusion – a new sophisticated injector for Nginx web servers"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2014/01/effusion-new-sophisticated-injector-nginx-web-servers"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p> </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">©1989-2022 Virus Bulletin.        <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>        <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>        <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>