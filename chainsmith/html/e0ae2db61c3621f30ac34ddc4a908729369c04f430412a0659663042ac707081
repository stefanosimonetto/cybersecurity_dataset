<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: Win32/Induc.C: getting noisier in the library</title>
<meta name="description" content="The Induc virus has been spreading successfully around the world since its first appearance in 2009, but back then it didn't contain a malicious payload. However, the latest variant contains a genuinely malicious payload and additional file-infecting and propagation capabilities. Robert Lipovský has the details." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 2108;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/remo_expand/blocks/remo_expand/templates/vbexpand/view.css" />
<script type="text/javascript" src="/packages/remo_expand/js/jquery.color.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/remo.expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<div class="titlepage" xmlns=""><div><div><h1 class="title" xmlns="http://www.w3.org/1999/xhtml"><a id="vb201112-Induc"></a>Win32/Induc.C: getting noisier in the library</h1></div><div><p class="pubdate" xmlns="http://www.w3.org/1999/xhtml">2011-12-01</p></div><div><div class="authorgroup" xmlns="http://www.w3.org/1999/xhtml"><div class="author titlepage"><h3 class="author"><span class="surname">Robert Lipovsk&yacute;</span></h3><span class="orgname">ESET</span>, <span class="orgdiv">Slovakia</span></div><b class="editedby">Editor: </b><span class="editor"><span class="firstname">Helen</span> <span class="surname">Martin</span></span></div></div><div><div class="abstract" xmlns="http://www.w3.org/1999/xhtml"><p class="title"><b>Abstract</b></p><p>The Induc virus has been spreading successfully around the world since its first appearance in 2009, but back then it didn&#39;t contain a malicious payload. However, the latest variant contains a genuinely malicious payload and additional file-infecting and propagation capabilities. Robert Lipovsk&yacute; has the details.</p></div></div><div><p class="copyright" xmlns="http://www.w3.org/1999/xhtml"><i>Copyright &copy; 2011 Virus Bulletin</i></p></div></div><hr /></div>
<div class="ccm-remo-expand">
<div id="ccm-remo-expand-title-3615" class="ccm-remo-expand-title ccm-remo-expand-closed" data-expander-speed="200">Table of contents</div><div id="ccm-remo-expand-content-3615" class="ccm-remo-expand-content"><div class="toc"><dl><dt><span class="sect1"><a href="#id4361343"></a></span></dt><dt><span class="sect1"><a href="#id4898686">Analysis of Win32/Induc.C</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2952419">Delphi library infection</a></span></dt><dt><span class="sect2"><a href="#id4729755">Second file infection method</a></span></dt><dt><span class="sect2"><a href="#id3647520">Virus body analysis</a></span></dt><dt><span class="sect2"><a href="#id2605740">The downloader</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id2759126">Differences in Induc.A</a></span></dt><dt><span class="sect1"><a href="#id3072561">Differences in Induc.B</a></span></dt><dt><span class="sect1"><a href="#id2721778">Conclusion</a></span></dt></dl></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4361343"></a></h2></div></div></div><p>The Delphi infector Win32/Induc is back, this time with a genuinely malicious payload and additional file-infecting and propagation capabilities.</p><p>Classic file-infecting viruses are not as common as they were 15 years ago, but occasionally we do come across a &lsquo;modern virus&rsquo;. A good example of such a menace is the polymorphic file infector Win32/Sality [<span class="citation"><a href="#citation.1">1</a></span>].</p><p>In 2009, the virus Win32/Induc.A [<span class="citation"><a href="#citation.2">2</a></span>], which infected Delphi files at compile-time, caught our attention [<span class="citation"><a href="#citation.3">3</a></span>]. Apart from the infection process itself, this variant did not contain any other malicious payload and was considered a proof of concept, or code in development (although it did actually infect real systems). One of its interesting features [<span class="citation"><a href="#citation.4">4</a></span>] was that it appeared to have been influenced by a classic 1984 paper that describes an infection implemented by planting a &lsquo;bug&rsquo; into a C compiler [<span class="citation"><a href="#citation.5">5</a></span>].</p><p>About two years later, in July 2011, a new version appeared. Win32/Induc.B featured some minor improvements, but was actually quite similar to the first variant. However, more dramatic changes appeared in August in the latest development of the virus, Win32/Induc.C. In this variant the infecting code had been modified and extended, and more malicious functionality had been added.</p><p>In this article, we will first analyse Win32/Induc.C &ndash; the most complex variant to date. Afterwards, we will briefly describe Induc&rsquo;s evolution by outlining the differences between this and the earlier versions of the virus.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4898686"></a>Analysis of Win32/Induc.C</h2></div></div></div><p>The fundamental characteristic of the Induc virus is that it infects a standard Delphi library, resulting in the infection of every application compiled in this modified Delphi development environment. In the case of Win32/Induc.C, the virus body (which the Delphi linker includes in all programs) is 52,736 bytes. (This does not include the malicious code inside the infected Delphi library, which drops and launches the virus body.)</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id2952419"></a>Delphi library infection</h3></div></div></div><p>Before analysing the virus body, let&rsquo;s take a look at how the Delphi infection works. Delphi applications link to the file SysInit.dcu. This is a component of the Delphi/Kylix Cross-Platform Runtime Library, specifically the System Initialization Unit. As the name suggests, code from this library is included in the initialization part of every Delphi application, and this is the target of the Induc infection. SysInit.dcu contains object code (.dcu is a Delphi Compiled Unit) compiled from SysInit.pas. Induc modifies this source file and compiles it into the resulting SysInit.dcu file. (The virus actually compiles SysInit.dcu &lsquo;indirectly&rsquo; by compiling System.dcu.)</p><div class="figure"><a id="figure.1"></a><div class="mediaobject"><img alt="Malicious code is inserted into SysInit.pas." src="/uploads/images/figures/2011/12/figure1.png" /></div><p class="title"><b>Figure&nbsp;1.&nbsp;Malicious code is inserted into SysInit.pas.</b></p></div><p>Only two lines of code are added to SysInit.pas, as the rest is taken care of by the file Defines.inc, which is dropped by Induc. The malicious CreateMyFile function (implemented in Defines.inc) is called in _InitExe just before the _StartExe function call.</p><p>The method for launching the virus body is quite trivial. Defines.inc contains the virus body as a PE file as an array of 52,736 bytes and the CreateMyFile function simply drops the executable to the current directory with the name &lsquo;~.exe&rsquo; and executes it.</p><div class="figure"><a id="figure.2"></a><div class="mediaobject"><img alt="The virus body stored as an array of 52,736 bytes in Defines.inc." src="/uploads/images/figures/2011/12/figure2.png" /></div><p class="title"><b>Figure&nbsp;2.&nbsp;The virus body stored as an array of 52,736 bytes in Defines.inc.</b></p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4729755"></a>Second file infection method</h3></div></div></div><p>Win32/Induc.C features a method not present in the previous variants for infecting <span class="emphasis"><em>any</em></span> .exe file, not just those compiled with Delphi. In this case, Induc acts as a prepender virus &ndash; upon infection it attaches the original executable under its body. The string &lsquo;-=supernatural=-&rsquo; is used as a delimiter to mark the beginning of the original file, as well as a marker to signify that a file has been infected.</p><div class="figure"><a id="figure.3"></a><div class="mediaobject"><img alt="Induc&rsquo;s .exe file infection." src="/uploads/images/figures/2011/12/figure3.png" /></div><p class="title"><b>Figure&nbsp;3.&nbsp;Induc&rsquo;s .exe file infection.</b></p></div><div class="figure"><a id="figure.4"></a><div class="mediaobject"><img alt="Executable infected with Win32/Induc.C." src="/uploads/images/figures/2011/12/figure4.png" /></div><p class="title"><b>Figure&nbsp;4.&nbsp;Executable infected with Win32/Induc.C.</b></p></div><p>Induc.C also uses a simple encryption algorithm for the original executable: xor 5, add 7. Our analysis (described in the next section) revealed that this second .exe infection vector is only used for infecting executables on removable drives. This fulfils the purpose of distributing the virus to other computers.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id3647520"></a>Virus body analysis</h3></div></div></div><p>The malware code begins with a procedure containing some curious API function calls. There are a couple of multimedia functions (MCI Functions and PlaySoundA) about whose purpose we can only speculate. The virus executable tries to play a sound from its resources, called &lsquo;my_global_sound&rsquo;, and if it&rsquo;s successful, the virus terminates its execution. The execution doesn&rsquo;t take this path under normal circumstances, obviously, and the virus samples that we have analysed are fully functional. The first possible explanation that comes to mind is anti-emulation, or a way for the virus to defend itself from sandboxes. Another possibility is some residual debugging (or plain junk) code used by the author.</p><p>The main payload function is shown in <a href="#figure.5">Figure 5</a>.</p><div class="figure"><a id="figure.5"></a><div class="mediaobject"><img alt="Main payload function of Induc.C." src="/uploads/images/figures/2011/12/figure5.png" /></div><p class="title"><b>Figure&nbsp;5.&nbsp;Main payload function of Induc.C.</b></p></div><p>At the beginning of the function, there is a check as to whether the executable has been launched with the -autorun parameter, and one of two execution paths is chosen. The first execution of the virus is without the parameter. Two tasks are performed in this program branch:</p><div class="itemizedlist"><ul type="disc"><li><p>The virus &lsquo;schedules&rsquo; itself to run with the -autorun parameter after the next system restart. It does so by copying itself to the Application Data\APMV\ directory with APMV.exe as its filename. Then a shortcut (.lnk file) is crafted, pointing to this file with the -autorun parameter, and placed in the Startup folder.</p></li><li><p>Next, Induc.C checks whether there is another executable in the overlay (the original executable that has been infected, as explained in the previous section). The virus searches for the string &lsquo;-=supernatural=-&rsquo; and then decrypts (sub 7, xor 5) the original PE file if it is present, and drops it into the current directory as ~.exe. Afterwards, Induc creates a shortcut to this file (~.lnk), executes it, deletes the shortcut, and when the original executable terminates, the ~.exe file is deleted as well. (This is accomplished by calling the DeleteFile API in a cycle until it is successful.)</p></li></ul></div><p>When executed with the -autorun parameter, the main payload is delivered: infecting Delphi, infecting executables on removable drives, and downloading other malware onto the system. There is even a very simple self-defence thread. Let&rsquo;s take a closer look at these functions:</p><div class="itemizedlist"><ul type="disc"><li><p>There is one shared function for going through the directory structure that is used when infecting both Delphi and .exe files. Which task to carry out is determined by the value in the AL register. At the beginning of the function, there is a call to the GetLogicalDriveStrings API to enumerate the drives on the system and, for drives that satisfy specific conditions, Induc.C searches the directory structure for files to infect. When infecting Delphi, the drive type DRIVE_CDROM is excluded, and the System Volume Information folder must be present. For the .exe infections, the drive types must not be DRIVE_NO_ROOT_DIR, DRIVE_CDROM, or DRIVE_UNKNOWN and the System Volume Information folder must not be present. (USB sticks, for example, satisfy these conditions.) It is interesting that the author didn&rsquo;t use the DRIVE_REMOVABLE drive type for this purpose.</p></li><li><p>The directory structure is traversed recursively using the standard method of FindFirstFile and FindNextFile. In order to locate the Delphi installation folder, Induc.C searches for the following file paths:</p><pre class="programlisting">bin\dcc32.exe
lib\sysinit.dcu
rtl\sys\system.pas</pre><p>When they are found, the Defines.inc file is dropped, and the virus writes two lines to the rtl\sys\sysinit.pas source file:</p><pre class="programlisting">{$I Defines.inc}
CreateMyFile(@my_array,sizeof(my_array),&lsquo;~.exe&rsquo;);</pre><p>This is explained in the &lsquo;Delphi library infection&rsquo; section.</p><p>When the malicious modifications are made, Induc compiles the libraries using the following command:</p><pre class="programlisting">%Delphi_path%\bin\dcc32.exe &ndash;Q &ldquo;%Delphi_path%\rtl\sys\system.pas&rdquo; &ndash;M &ndash;Y &ndash;Z -$D- -0</pre><p>Afterwards the compiled .dcu files are moved to the correct directory and the SysInit.pas source file reverts to its original form.</p></li><li><p>The infection of .exe files is implemented in a separate thread and repeats in a cycle every five seconds &ndash; so that when a USB stick is inserted into the computer, it will become infected. When traversing the directory structure, files with the .exe extension are first checked to see whether they have been infected already (by searching for the &lsquo;-=supernatural=-&rsquo; string). The second condition for infection is that the file size must be between 100KB and 50MB.</p><div class="figure"><a id="figure.6"></a><div class="mediaobject"><img alt="File size condition for infection." src="/uploads/images/figures/2011/12/figure6.png" /></div><p class="title"><b>Figure&nbsp;6.&nbsp;File size condition for infection.</b></p></div><p>As described earlier, the virus appends the original executable to its body after encrypting it with xor 5, add 7. The virus also takes the icon of the executable.</p></li><li><p>Another thread is dedicated to the downloader feature &ndash; the main payload of Induc.C. We&rsquo;ll look at it more closely in the next section, as the techniques used are quite unusual.</p></li><li><p>The last of the three CreateThread calls implements a very primitive self-defence mechanism. Every 0.5 seconds, the virus checks whether the Task Manager is running, and if it is, the virus terminates itself. This way, the user will not see the malicious process in the list of running processes. The method is very simple, and the author could instead have chosen rootkit techniques to hide the virus process from process listing. However, avoiding the use of rootkit techniques allows the malware to look a lot less suspicious and since this is a virus and will probably be executed again, this trick works (almost) as well. The API functions used for the process enumeration are the standard CreateToolhelp32Snapshot, Process32First, etc.</p></li></ul></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id2605740"></a>The downloader</h3></div></div></div><p>The downloader thread contains a loop and a 15-minute sleep before it tries to download files from the Internet. The virus body contains three hard-coded URLs, which are also encrypted using the simple xor 5, add 7 &lsquo;cipher&rsquo;. The same encryption is also used for obfuscating the names of WinINet functions. Now things get really interesting. The URLs point to JPEG images &ndash; user avatars on three different discussion forums.</p><p>You might be wondering: why on earth is a virus downloading avatars? This is a trick that the virus author uses to dynamically store the URLs of other malware to download and execute. If we take a look inside the JPEG file, this is what we see:</p><div class="figure"><a id="figure.7"></a><div class="mediaobject"><img alt="Encrypted URL hidden in downloaded image." src="/uploads/images/figures/2011/12/figure7.png" /></div><p class="title"><b>Figure&nbsp;7.&nbsp;Encrypted URL hidden in downloaded image.</b></p></div><p>An encrypted URL is stored at the beginning of the JPEG file (where EXIF data is stored). The start of this field is indicated by the &lsquo;x&rsquo; character. Following that is a WORD value which contains the length of the encrypted URL, and then the URL itself. The encryption algorithm is &ndash; you guessed it &ndash; xor 5, add 7, but the string is also encoded with Base64.</p><p>The virus then downloads the executable at that address to a randomly named file in the Temp directory and executes it, deleting it after it terminates. One particular piece of malware that Induc.C downloads is a password stealer that ESET detects as Win32/PSW.Delf.NQS. This has the capability to extract passwords from various applications, including FTP clients.</p><p>A couple of additional details on the downloader procedure:</p><div class="itemizedlist"><ul type="disc"><li><p>In the main cycle with the 15-minute delay, the virus attempts to download a file from the first URL and tries the other URLs if that one fails.</p></li><li><p>Before downloading the JPEG file, Induc first checks its timestamp and compares it with the one it has recorded before. This way, the virus avoids downloading the same malware repeatedly.</p></li><li><p>Induc verifies that the downloaded avatar is really a JPEG file:</p><div class="figure"><a id="figure.8"></a><div class="mediaobject"><img alt="JPEG file type check." src="/uploads/images/figures/2011/12/figure8.png" /></div><p class="title"><b>Figure&nbsp;8.&nbsp;JPEG file type check.</b></p></div></li><li><p>When downloading the avatar, the following URL parameter string is added to the HTTP request:</p><pre class="programlisting">?uid=%id%&amp;l=%random%</pre><p>This simple feature enables the virus operator to track the infected computers &ndash; effectively creating a botnet.</p></li></ul></div><p>Induc.C uses three supporting files:</p><div class="itemizedlist"><ul type="disc"><li><p>%virus_filename%.id &ndash; stores a (random) ID of the infected computer</p></li><li><p>%virus_filename%.dat &ndash; stores an encrypted timestamp of the avatar</p></li><li><p>%virus_filename%.flag &ndash; marks that Delphi has already been infected.</p></li></ul></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id2759126"></a>Differences in Induc.A</h2></div></div></div><p>There are several major differences between the first variant of the Induc virus and its latest iteration:</p><div class="itemizedlist"><ul type="disc"><li><p>The Delphi infection didn&rsquo;t take place in the SysInit.pas library, but in SysConst.pas.</p></li><li><p>Delphi versions 4 to 7 were affected.</p></li><li><p>The Delphi installation directory was read from the Windows registry, not by searching the hard drive.</p></li><li><p>All the virus code was in plain Delphi and was written to the infected SysConst.pas, and was clearly visible for analysis (after some beautification).</p></li><li><p>There was no payload at all, apart from the Delphi infection itself. Induc.A didn&rsquo;t contain the .exe infection capability introduced by Induc.C.</p></li></ul></div><p>Even though Induc.A received a lot of attention two years ago, it is now apparent that it was only an Alpha version of the virus.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3072561"></a>Differences in Induc.B</h2></div></div></div><p>Induc.B appears to have been an improved version of Induc.A. The functionality was the same as before &ndash; there was no payload, only the infection of Delphi through SysConst.pas. However, a few anti-debugging tricks were added in this version, and the author made the code slightly harder to analyse by encrypting it. Some unused functions were also present &ndash; apparently the virus writer was experimenting.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id2721778"></a>Conclusion</h2></div></div></div><p>The Induc virus has been spreading successfully around the world since its first appearance in 2009 [<span class="citation"><a href="#citation.4">4</a></span>], even though at that time it did not contain a malicious payload. Now, however, the author appears to have passed the Alpha testing stage and the virus poses a real threat to computer users &ndash; even though it is not polymorphic and its code is rather simple. Following the trend of modern malware, it acts as a vector to download and execute more malicious code on the infected system, and incorporates botnet capabilities. I</p><p>I wonder what Induc.D will look like&hellip;</p><p>(<span class="emphasis"><em>ESET</em></span>&rsquo;s detection statistics for the Induc family can be found in [<span class="citation"><a href="#citation.6">6</a></span>] and a technical write-up of Induc.C is given in [<span class="citation"><a href="#citation.7">7</a></span>].)</p><div class="bibliography"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id3073474"></a>Bibliography</h3></div></div></div><div class="bibliomixed"><a id="citation.1"></a><p class="bibliomixed">[1] ESET. Global Threat Report August 2011. <span class="bibliosource"><a href="https://go.eset.com/us/resources/threat-trends/Global_Threat_Trends_August_2011.pdf" target="_blank">http://go.eset.com/us/resources/threat-trends/Global_Threat_Trends_August_2011.pdf</a></span>.</p></div><div class="bibliomixed"><a id="citation.2"></a><p class="bibliomixed">[2] ESET Threat Encyclopaedia: Win32/Induc.A. <span class="bibliosource"><a href="http://www.eset.eu/encyclopaedia/win32-induc-a-virus?lng=en" target="_blank">http://www.eset.eu/encyclopaedia/win32-induc-a-virus?lng=en</a></span>.</p></div><div class="bibliomixed"><a id="citation.3"></a><p class="bibliomixed">[3] Abrams, R. The Retro Virus. ESET Threat Blog August 2009. <span class="bibliosource"><a href="http://blog.eset.com/2009/08/19/the-retro-virus" target="_blank">http://blog.eset.com/2009/08/19/the-retro-virus</a></span>.</p></div><div class="bibliomixed"><a id="citation.4"></a><p class="bibliomixed">[4] Bortnik, S.; Borghello, C.; Harley, D. W32/Induc.A FAQ. ESET Threat Blog. August 2009. <span class="bibliosource"><a href="http://blog.eset.com/2009/08/23/w32induc-a-faq" target="_blank">http://blog.eset.com/2009/08/23/w32induc-a-faq</a></span>.</p></div><div class="bibliomixed"><a id="citation.5"></a><p class="bibliomixed">[5] Thompson, K. Reflections on Trusting Trust (1984). Communications of the ACM Vol. 27, No. 8.</p></div><div class="bibliomixed"><a id="citation.6"></a><p class="bibliomixed">[6] Lipovsk&yacute;, R. The Induc Virus is back! ESET Threat Blog. September 2011. <span class="bibliosource"><a href="http://blog.eset.com/2011/09/14/the-induc-virus-is-back" target="_blank">http://blog.eset.com/2011/09/14/the-induc-virus-is-back</a></span>.</p></div><div class="bibliomixed"><a id="citation.7"></a><p class="bibliomixed">[7] ESET Threat Encyclopaedia: Win32/Induc.C. <span class="bibliosource"><a href="http://www.eset.eu/encyclopaedia/win32-induc-c-virus-lg-2?lng=en" target="_blank">http://www.eset.eu/encyclopaedia/win32-induc-c-virus-lg-2?lng=en</a></span>.</p></div></div></div> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=Win32/Induc.C: getting noisier in the library&url=https://www.virusbulletin.com/virusbulletin/2011/12/win32-induc-c-getting-noisier-library"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2011/12/win32-induc-c-getting-noisier-library'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2011/12/win32-induc-c-getting-noisier-library&title=Win32/Induc.C: getting noisier in the library"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2011/12/win32-induc-c-getting-noisier-library&t=Win32/Induc.C: getting noisier in the library"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2011/12/win32-induc-c-getting-noisier-library"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p> </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">©1989-2022 Virus Bulletin.        <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>        <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>        <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>