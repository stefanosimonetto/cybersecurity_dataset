<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: VB2019 paper: Catch me if you can: detection of injection exploitation by validating query and API integrity</title>
<meta name="description" content="Injection flaws are one of the topmost risks and have ruled as such for a decade. The research community has extensively discussed exploitation details for SQL, NoSQL, OS command and LDAP injection exploits. This paper will dive into the technical details of a novel detection algorithm that can be used to detect these injection exploits." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 6656;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/blocks/expand_collapse_toc/templates/vbexpand/view.css" />
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/jquery.color.js"></script>
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<h1><a class="chapter" name="h1-vb2019-paper-catch-me-if-you-can-detection-injection-exploitation-validating-query-and-api-integrity"></a>VB2019 paper: Catch me if you can: detection of injection exploitation by validating query and API integrity</h1>
<h3><a class="chapter" name="h3-abhishek-singh-amp-ramesh-mani"></a>Abhishek Singh &amp; Ramesh Mani</h3>
<p><em>Prismo Systems, USA</em></p>
<hr />
<p> </p>
<div class="ccm-expand-collapse-toc">
<div id="ccm-expand-collapse-toc-title-14996" class="ccm-expand-collapse-toc-title ccm-expand-collapse-toc-closed" data-expander-speed="500">Table of contents</div><div id="ccm-expand-collapse-toc-content-14996" class="ccm-expand-collapse-toc-content"><p><a class="toc-level2" href="#h2-abstract">Abstract</a><br /> <a class="toc-level2" href="#h2-1-introduction">1. Introduction</a><br /> <a class="toc-level2" href="#h2-2-technical-details-os-command-injection">2. Technical Details of OS Command Injection</a><br /> <a class="toc-level3" href="#h3-21-detection-os-command-injection-exploitation">2.1 Detection of OS command injection exploitation</a><br /> <a class="toc-level2" href="#h2-3-technical-details-sql-injection-attacks">3. Technical details of SQL injection attacks</a><br /> <a class="toc-level3" href="#h3-31-detection-sql-injection-exploitation">3.1 Detection of SQL injection exploitation</a><br /> <a class="toc-level2" href="#h2-4-technical-details-nosql-injection-exploitation">4. Technical Details of NoSQL Injection Exploitation</a><br /> <a class="toc-level3" href="#h3-41-detection-nosql-exploitation">4.1 Detection of NoSQL exploitation</a><br /> <a class="toc-level2" href="#h2-5-technical-details-xpath-injection-exploitation">5. Technical details of XPath injection exploitation</a><br /> <a class="toc-level3" href="#h3-51-detection-xpath-injection-exploitation">5.1 Detection of XPath injection exploitation</a><br /> <a class="toc-level2" href="#h2-6-technical-details-ldap-injection-exploitation">6. Technical details of LDAP injection exploitation</a><br /> <a class="toc-level3" href="#h3-61-detection-ldap-exploitation">6.1 Detection of LDAP exploitation</a><br /> <a class="toc-level2" href="#h2-7-conclusion">7. Conclusion</a><br /> <a class="toc-level2" href="#h2-references">References</a></p><p>&nbsp;</p></div></div>
<h2><a class="chapter" name="h2-abstract"></a>Abstract</h2>
<p>According to OWASP’s top 10 web application security risks, injection flaws are one of the topmost risks and have ruled as such for a decade. Injection flaws include SQL, NoSQL, OS command and LDAP injection techniques. Threat actor groups such as Axiom and Magic Hound have been observed using SQL injection to gain access to systems. The research community has extensively discussed exploitation details for SQL, NoSQL, OS command and LDAP injection exploits. This paper will dive into the technical details of a novel detection algorithm that can be used to detect these injection exploits.</p>
<p>Our detection algorithm leverages code flow analysis. Injection attacks such as SQL, NoSQL, OS command and LDAP injection exploits insert additional code, which leads to a change in the legitimate code of an application. The algorithm makes use of abstract syntax trees (AST), program dependency graphs (PDG) and SQL parse trees to compute the changes in the original code caused by injection-based exploits.</p>
<p>The detection algorithm discussed in this paper provides an inherent advantage. It not only detects SQL, NoSQL, OS command and LDAP injection exploitation by a threat actor but also automatically identifies the vulnerable section of the application code, which will help application developers in patching the code, preventing further exploitation.</p>
<p> </p>
<h2><a class="chapter" name="h2-1-introduction"></a>1. Introduction</h2>
<p>Web injection exploitation has ruled as the top web application vulnerability for a decade. Injection flaws [<a href="#ref1">1</a>] include SQL, NoSQL, OS command and LDAP injection techniques. Exploitation occurs when untrusted data is sent to an interpreter as part of a command or query.</p>
<p>OS command injection is an exploitation technique in which the goal is the execution of arbitrary commands on the host operating system via a vulnerable application. OS command injection exploitation is operating system-independent, i.e. it can happen on <em>Windows</em> or <em>Linux</em>.</p>
<p>In the case of SQL injection exploitation, malicious SQL statements are inserted via the methods which accept a user’s or external inputs such as GET, POST, HTTP headers, lambda functions, etc. These malicious SQL queries are executed and perform malicious activities such as dumping the database contents, etc. to a location determined by the attacker. Threat actor groups such as Axiom [<a href="#ref2">2</a>] and Magic Hound [<a href="#ref3">3</a>] have been observed using SQL injection to gain access to systems. Injection attacks such as SQL injection exploitation can lead not only to malicious access to the database but also to the installation of malicious code such as web shells [<a href="#ref4">4</a>]. Databases such as <em>MongoDB</em> support the use of JavaScript functions for query specifications and map/reduce operations. Since <em>MongoDB</em> databases (like other NoSQL databases) do not have strictly defined database schemas, using JavaScript for query syntax allows developers to write arbitrarily complex queries against disparate document structures. If these queries accept input from HTTP methods and headers such as GET, POST, Cookies, User-Agent, etc. then these JavaScript functions can be prone to NoSQL injection exploitation [<a href="#ref5">5</a>]. Besides SQL and NoSQL databases, threat actors can also construct a malicious XPath expression or XQuery to retrieve the data from an XML database.</p>
<p>Injection attacks such as SQL, NoSQL and OS command injection exploits add additional code, which leads to a change in the legitimate code of the application. This change in the legitimate code is reflected in the abstract syntax tree (AST), program dependency graph (PDG) and SQL parse tree. In the first section of this paper we will take examples of SQL, NoSQL and OS command injection exploits and show the changes in the AST, PDG and SQL parse tree due to the exploits. These changes in the code are the fundamental principle of the detection algorithms used to detect SQL, NoSQL and OS command injection, which are discussed in the subsequent sections.</p>
<p> </p>
<h2><a class="chapter" name="h2-2-technical-details-os-command-injection"></a>2. Technical Details of OS Command Injection</h2>
<p>Figure 1 shows code that is vulnerable to OS command injection attack.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/2215/7295/4278/Figure1.0.png" alt="Figure1.0.png" width="482" height="117" /><span class="centered-caption">Figure 1: Code vulnerable to OS command injection.</span></p>
<p>The code takes the name of the file which is to be deleted from the value field of the GET method. In the subsequent line of code the PHP program execution function <span class="monospace">system()</span> takes the value of the file name from the data field of the GET method and invokes the bash command <span class="monospace">rm</span> to delete the file.</p>
<p>Let’s assume that the file shown in Figure 1 is on a server with IP address <span class="monospace">x.x.x.x</span> as <span class="monospace">test.php</span>. <span class="monospace">hxxp://x.x.x.x:8000/test.php?filename=kral.php</span> is an example of the legitimate input. It takes input as kral.php from the data field of the GET method and deletes the file <span class="monospace">kral.php</span> from the folder. The dynamic call graph which captures the execution flow, i.e. control and data dependency, is shown in Figure 2. The dynamic call graph captures the control and data flow not only when the code is executed by a PHP application but also when the OS commands are executed by the PHP application. The nodes in the graph denote the statement, predicates, OS events and system calls. The edges denote the parent-child relationship.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/3315/7295/4431/Figure2.0.png" alt="Figure2.0.png" width="484" height="424" /><span class="centered-caption">Figure 2: Dynamic call graph of the legitimate request.</span></p>
<p><span class="monospace">http://x.x.x.x:8000/test.php?filename=kral.php;ls</span> is an example of an OS command injection exploit. In the request, the threat actor has injected the OS command <span class="monospace">ls</span> with the value of the GET method <span class="monospace">kral.php</span>.</p>
<p>Figure 3 shows the dynamic call graph when the exploit is sent to the vulnerable application. As can be seen, a new node with the value <span class="monospace">/bin/ls</span> – the injected OS command – is spawned. The value of this additional node can be traced up the graph and is the same as the command <span class="monospace">ls</span> that was appended to the value field of the GET method.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/c033b3c9f755c08ce700ed692a450be4_f3962.png" alt="Figure3.0.png" width="600" height="395" /><span class="centered-caption">Figure 3: Dynamic call graph with OS command injection exploit.</span></p>
<p> </p>
<h3><a class="chapter" name="h3-21-detection-os-command-injection-exploitation"></a>2.1 Detection of OS command injection exploitation</h3>
<p>The algorithm used to detect the OS command injection attack not only makes use of application‑level hooks but also captures system calls and other OS events to generate the dynamic call graph. As part of the first step, the dynamic call graph traces the data passed to those methods that accept user or external inputs such as GET, POST, Cookies, HTTP headers, etc. The subsequent child processes (which can be OS events or invocation of the system calls spawned due to the execution of a program execution function such as <span class="monospace">eval()</span>, <span class="monospace">passthru()</span>, <span class="monospace">shell_exec()</span>, <span class="monospace">system()</span>, <span class="monospace">proc_open()</span>, e<span class="monospace">xpect_open()</span> or <span class="monospace">ssh2_exec()</span>) get captured in the dynamic call graph.</p>
<p>Once the dynamic call graph has been generated, the algorithm uses the graph to check whether the exact name of the command line argument of any of the child processes of the program execution functions that are being spawned by the OS command is same as the value or appears in the part of the value passed to the methods that accept user inputs such as GET, POST, Cookies &amp; HTTP headers. If the condition is found to be true, an alert for OS command injection vulnerability is raised. The algorithm is independent both of the application which is being executed and of the operating system on which the algorithm is running, hence it helps to identify both known and zero-day OS command injection vulnerabilities.</p>
<p> </p>
<h2><a class="chapter" name="h2-3-technical-details-sql-injection-attacks"></a>3. Technical details of SQL injection attacks</h2>
<p>Figure 4 is an example of code that is vulnerable to SQL injection attack. The code accepts the <span class="monospace">username</span> from the HTTP request in the variable <span class="monospace">user</span>. The variable <span class="monospace">user</span> then acts as an input to the SQL query <span class="monospace">sqlStmt</span>. In the subsequent part of the code, the query gets executed by the function <span class="monospace">Connection.Execute()</span>.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/2015/7295/4666/Figure4.0.png" alt="Figure4.0.png" width="517" height="113" /><span class="centered-caption">Figure 4: Code vulnerable to SQL injection.</span></p>
<p><span class="monospace">SELECT Host FROM mysql.user WHERE User ='abhi';</span> is an example of a legitimate SQL query executed by the application. The legitimate query sent to the database is defined in the application and the value of the variable <span class="monospace">user</span> as <span class="monospace">'abhi'</span> is taken from the value field of the methods which accept user input such as GET, POST, etc. Figure 5 shows the PostgreSQL parse tree [<a href="#ref6">6</a>] of the normalized query.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/5015/7295/4743/Figure_5.0.png" alt="Figure 5.0.png" width="696" height="568" /><span class="centered-caption">Figure 5: PostgreSQL parse tree of the valid normalized query.</span></p>
<p>In the case of an SQL injection exploitation, a threat actor will insert a malicious SQL query along with a value into the methods that accept user or external inputs (such as GET, POST). This malicious query will be executed by the application along with the legitimate query. Explaining it with an example, if the threat actor injects the malicious SQL query <span class="monospace">UNION SELECT username, Password FROM Users</span> by appending it to the value of the variable user <span class="monospace">'abhi'</span>, the query that gets executed by the application becomes <span class="monospace">SELECT Host FROM mysql.user WHERE user= 'abhi' UNION SELECT username, Password FROM Users ;</span>.</p>
<p>A PostgreSQL parse tree of the normalized SQL query with the injected SQL query is shown in Figure 6. As can be seen in Figure 6, an additional node is created in the PostgreSQL parse tree as a result of the inserted SQL command.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/5915/7295/4845/Figure_6.0.png" alt="Figure 6.0.png" width="749" height="974" /><span class="centered-caption">Figure 6: PostgreSQL parse tree with the injected SQL command.</span></p>
<p>SQL injection exploits will introduce an additional SQL query to the database. This injected SQL query will be reflected as an additional node in the query parse tree of the legitimate normalized SQL query.</p>
<p> </p>
<h3><a class="chapter" name="h3-31-detection-sql-injection-exploitation"></a>3.1 Detection of SQL injection exploitation</h3>
<p>The algorithm used to detect the SQL injection attack makes use of application-level hooks to construct a program dependency graph (PDG). The PDG captures the flow of data and control from methods which accept external or user input such as GET, POST, Cookies, etc. to the functions which execute the SQL query such as <span class="monospace">mysql_query()</span>, <span class="monospace">mysql_db_query()</span>, <span class="monospace">mysql_unbuffered_query()</span>, <span class="monospace">pg_execute()</span>, <span class="monospace">pg_query()</span>, <span class="monospace">pg_query_params()</span>, <span class="monospace">pg_prepare()</span>, <span class="monospace">pg_send_query()</span> and <span class="monospace">pg_send_query_params()</span>. Once the PDG is generated, it is used to identify the legitimate SQL queries which are the sink for the value from the methods which accept user or external input such as GET, POST, etc. These SQL queries are the parameters for the SQL query execution functions and are stored as the parse tree. Any injected malicious SQL query will be reflected in an additional node in the parse tree of the normalized legitimate SQL query. For every database access, the parse tree of the executing query is compared with the parse tree of the legitimate query. If there is an additional node in the parse tree of the executing SQL query, then it gets matched with the value or with the part of the value passed to the methods that accept user or external input. In the case of a match, an alert for SQL injection is raised.</p>
<p> </p>
<h2><a class="chapter" name="h2-4-technical-details-nosql-injection-exploitation"></a>4. Technical Details of NoSQL Injection Exploitation</h2>
<p>A NoSQL database provides the ability to run JavaScript in the database engine to perform complicated queries or transactions. Figure 7 shows an example of a JavaScript query. The query accepts external input in the variable <span class="monospace">search_year</span> and then searches in the database for all the publications that match the values of the search year.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/5915/7295/7804/Figure7.0.png" alt="Figure7.0.png" width="375" height="130" /> <span class="centered-caption">Figure 7: JavaScript query.</span></p>
<p>A legitimate GET request will appear in the format <span class="monospace">http://server.com/app.php?year= 2015</span>. The input ‘2015’ will act as an input value for the variable <span class="monospace">search_year</span>, and the query will return the publications which were published in the year 2015. An example of a NoSQL injection attack is <span class="monospace">http://server.com/app.php?year=2015;while(true){}</span>. The exploit injects the NoSQL code <span class="monospace">while(true){}</span>. This injected code will be executed by the database and will cause the database to enter into an infinite loop, leading to a denial of service attack. If we construct abstract syntax trees [<a href="#ref7">7</a>] for the legitimate JavaScript function and the function with injected NoSQL code and compare them, as can be seen in Figure 8, NoSQL injection leads to the addition of a new node.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/e2ff7f324935d4e2ca16adb6784ac66c_f3967.png" alt="Figure8.0.png" width="500" height="180" /></p>
<p class="centered-caption">Figure 8: Addition in the AST of the legitimate JS function.</p>
<p>Besides using JavaScript to draft queries, JSON format is also used to send queries to NoSQL databases and is prone to NoSQL injection exploitation. Figure 9 shows an example of the vulnerable code [<a href="#ref8">8</a>] which crafts a query in JSON format. The code accepts the value of the variables <span class="monospace">username</span> and <span class="monospace">password</span> from the POST method, and the query is sent to the database by invoking the <span class="monospace">findOne</span> function.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/9415/7295/8397/Figure9.0.png" alt="Figure9.0.png" width="459" height="158" /></p>
<p class="centered-caption">Figure 9: Code vulnerable to NoSQL injection exploitation.</p>
<p>If a user enters ‘<span class="monospace">admin</span>’ as the value for the variable <span class="monospace">username</span>, and ‘<span class="monospace">password</span>’ as the value for the variable <span class="monospace">password</span>, the JSON query which is sent to the database will be as shown in Figure 10.</p>
<p><span class="centered-caption"><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/3215/7295/9311/Figure_9.1.png" alt="Figure 9.1.png" width="208" height="74" /> Figure 10: JSON query sent to the database.</span></p>
<p>The AST of the legitimate JSON query, shown in Figure 11, will always have two members.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/8115/7295/9366/Figure_9.2.png" alt="Figure 9.2.png" width="397" height="160" /> <span class="centered-caption">Figure 11: AST of the legitimate JSON query.</span></p>
<p>Taking an example of a malicious query, a threat actor can enter <span class="monospace">{"$gt":" "}</span> as the value for the variables <span class="monospace">username</span> and <span class="monospace">password</span>, which will lead to the query shown in Figure 12.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/4615/7295/8544/Figure_10.0.png" alt="Figure 10.0.png" width="248" height="57" /><span class="centered-caption">Figure 12: Malicious query due to injection.</span></p>
<p><span class="monospace">$gt</span> will select the documents which are greater than “ “. This statement will always be true, and the threat actor will successfully be able to authenticate. If we construct the AST of the modified JSON query due to the NoSQL injection exploit (Figure 13), we can see that additional nodes are introduced.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/7015/7295/9479/Figure_10.1.png" alt="Figure 10.1.png" width="557" height="188" /><span class="centered-caption">Figure 13: AST of the NoSQL exploit JSON query.</span></p>
<p>NoSQL databases accept queries in the form of JSON or JavaScript functions. NoSQL injection exploits will introduce additional JavaScript code or a JSON query. This injected code or JSON query will show up as additional nodes in the abstract syntax tree of the legitimate normalized JavaScript code or JSON query.</p>
<p> </p>
<h3><a class="chapter" name="h3-41-detection-nosql-exploitation"></a>4.1 Detection of NoSQL exploitation</h3>
<p>The algorithm used to detect a NoSQL injection attack makes use of application-level hooks to monitor functions such as <span class="monospace">mapReduce()</span>, <span class="monospace">find()</span>, <span class="monospace">findOne()</span>, <span class="monospace">findID()</span> and the where operator. These functions accept queries in the form of NoSQL JavaScript functions or as JSON arguments which get executed in the NoSQL database. Once the functions are hooked in an executing application, their arguments are used to identify the JavaScript code or queries in JSON which are executed by the database. A program dependency graph is used to identify the JS functions or JSON query which accepts user or external input from methods such as GET, POST, etc. If there is a flow of data from such methods to these JavaScript functions or a JSON query, then the abstract syntax tree (AST) of the legitimate JS function or JSON query is computed. In the case of a successful NoSQL injection exploitation, the AST of the legitimate JavaScript code or JSON query will change. NoSQL exploitation will introduce additional nodes to the legitimate AST. For every database access, the AST of the executing JS function or JSON query is compared with the legitimate JS function or JSON query. If there is an additional node in the AST of the executing JS function or JSON query it is compared with the value or with the part of the value passed to the methods such as GET, POST, Cookies, User-Agent, etc. In the case of a match, an alert for NoSQL injection is raised.</p>
<p> </p>
<h2><a class="chapter" name="h2-5-technical-details-xpath-injection-exploitation"></a>5. Technical details of XPath injection exploitation</h2>
<p>XPath injection [<a href="#ref9">9</a>] exploitation is similar to SQL injection exploitation with the difference being that, in the case of SQL injection exploitation, malicious SQL queries are sent to the database and, in the case of XPath injection exploits, malicious XPath expressions are sent to the XML databases which store the data. These malicious XPath expressions can then be used to modify or delete the data stored in the XML database.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/9715/7295/9608/Figure11.png" alt="Figure11.png" width="302" height="216" /> <span class="centered-caption">Figure 14: An XML file storing login and password.</span></p>
<p>Figure 14 shows an example of an XML file storing login and password details. Figure 15 shows an example of code [9] vulnerable to the XML path injection vulnerability. The code accepts the user input username and password from the GET method and passes the variable <span class="monospace">xlogin</span> to <span class="monospace">XPathExpression</span>. The code then creates a new instance of the <span class="monospace">Document</span> which, in the subsequent code <span class="monospace">xlogin.evaluate(d)</span>, is used to validate the username and password stored in the XML file with the username and password in the variable <span class="monospace">xlogin</span>. In the case of a valid username and password, authentication succeeds.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/3315/7295/9687/Figure_12.0.png" alt="Figure 12.0.png" width="500" height="111" /> <span class="centered-caption">Figure 15: Code vulnerable to XPath injection exploitation.</span></p>
<p>If a threat actor enters<span class="monospace"> 'admin' or "="</span> for the username and <span class="monospace">" or "="</span> for the password, the XPath expression becomes</p>
<pre>//users/user[login/text()='admin' or "=" and password/text() = " or "="]/home_dir/text()</pre>
<p>The condition or <span class="monospace">"="</span> is always true and allows the threat actor to log onto the system without authentication.</p>
<p> </p>
<h3><a class="chapter" name="h3-51-detection-xpath-injection-exploitation"></a>5.1 Detection of XPath injection exploitation</h3>
<p>The algorithm used to detect an XPath injection attack makes use of application-level hooks to construct a program dependency graph (PDG). The PDG captures the flow of data and control from methods which accept external input such as GET, POST, Cookies, etc. to the functions such as <span class="monospace">xpath.compile()</span> which construct the XPath expression, and functions which execute XQuery such as <span class="monospace">xdmp:eval()</span>, <span class="monospace">xdmp:value()</span>, <span class="monospace">fn:doc()</span> and <span class="monospace">fn:collection()</span>. Once the PDG is generated, it is used to identify the legitimate XPath expression or XQuery which accepts data from the methods that take user input such as GET, POST, Cookies, etc. Any injected malicious XPath expression or XQuery will show up as a change in the abstract syntax tree of the normalized legitimate XPath expression or XQuery. For every database access, the AST of the executing XPath expression or XQuery is compared with the legitimate XPath expression or XQuery. If there is an additional node in the AST of the executing XPath expression or XQuery, then this change in the AST is matched with the value or with the part of the value passed to the methods which accept user inputs such as GET, POST, Cookies, etc. In the case of a match, an alert for XPath injection is raised.</p>
<p> </p>
<h2><a class="chapter" name="h2-6-technical-details-ldap-injection-exploitation"></a>6. Technical details of LDAP injection exploitation</h2>
<p>LDAP injection is another injection technique which has been used by threat actors to extract information from the LDAP directory. LDAP filters are defined in RFC 4515. RFC 4256 allows the use of the following standalone symbols as two special constants:</p>
<p class="monospace" style="padding-left: 30px;">- (&amp;) -&gt; Absolute TRUE</p>
<p class="monospace" style="padding-left: 30px;">- (|) -&gt; Absolute FALSE</p>
<p>In the case of LDAP injection exploitation a threat actor can inject a malicious filter. If the web application does not sanitize the query, the inserted filter will be executed by the threat actor, which can lead to providing additional information to the threat actor, or to bypassing access control.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/5015/7295/9885/Figure13.0.png" alt="Figure13.0.png" width="463" height="27" /> <span class="centered-caption">Figure 16: Legitimate LDAP query filter in an application.</span></p>
<p>Figure 16 shows an example of an LDAP filter in an application which accepts the value of the variables <span class="monospace">username</span> and <span class="monospace">password</span> from the user-supplied input methods such as GET, POST. If the value of the variable <span class="monospace">username</span> is <span class="monospace">abhi</span> and the value of the variable <span class="monospace">password</span> is <span class="monospace">pass</span>, then the parse tree of the LDAP filter is as shown in Figure 17.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/5215/7295/9972/Figure14.0.png" alt="Figure14.0.png" width="647" height="160" /><span class="centered-caption">Figure 17: Parse tree of the legitimate LDAP filter.</span></p>
<p>In an application, the LDAP filter will remain the same, only the value of the user input variables to the LDAP filter will change. In the case of an LDAP injection exploitation, a threat actor can introduce a malicious LDAP filter which will modify the legitimate LDAP filter and will be executed by an application. Explaining it with an example, for the LDAP filter shown in Figure 16, if a threat actor enters <span class="monospace">abhi)(&amp;))</span> as the value of variable <span class="monospace">username</span> and <span class="monospace">userpassword</span> is left empty, the modified LDAP filter query is as shown in Figure 18.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/3615/7296/0068/Figure15.png" alt="Figure15.png" width="259" height="22" /></p>
<p class="centered-caption">Figure 18: LDAP filter due to the injection attack.</p>
<p>In the modified filter, only the first filter is processed by the LDAP server – that is, only <span class="monospace">(&amp;(uid=abhi)(&amp;))</span> is processed. This query is always true, so the threat actor will be able to authenticate without having a valid password. This is also reflected in the parse tree of the modified query shown in Figure 19.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/1415/7296/0123/Figure16.png" alt="Figure16.png" width="611" height="39" /></p>
<p class="centered-caption">Figure 19: Parse tree of the modified query.</p>
<p>In the case of LDAP injection exploitation, if a threat actor introduces a malicious filter, then it will be reflected by a modification in the parse tree of the legitimate filter query.</p>
<p> </p>
<h3><a class="chapter" name="h3-61-detection-ldap-exploitation"></a>6.1 Detection of LDAP exploitation</h3>
<p>The algorithm used to detect LDAP injection attacks makes use of application hooks to monitor the functions which execute LDAP filter queries such as <span class="monospace">ldap_search()</span>, <span class="monospace">ldap_search_st()</span>, <span class="monospace">ldap_search_ext()</span> and <span class="monospace">ldap_search_ext_s()</span>. Hooks to these functions help to identify the legitimate LDAP filter queries which will be executed by an application. Application hooking is also used to generate a program dependency graph which captures the flow of data and control from methods which accept user inputs such as GET, POST, etc. to the functions which execute LDAP filter queries. Once the program dependency graph has been generated, it is used to identify the legitimate LDAP filter queries in an application which can accept user input from methods such as GET, POST, etc. If there is a flow of data from methods such as GET, POST, etc. to the LDAP filter queries, the parse tree of the normalized LDAP filter query is computed and stored. For every access to LDAP, the parse tree of the normalized executing LDAP filter query is compared with the parse tree of the normalized legitimate LDAP filter query. In the case of a mismatch between the parse trees, the values from methods such as GET, POST, etc. are checked to validate if the mismatch is due to the value field. If the validation is found to be true, an alert for LDAP injection exploitation is raised.</p>
<p> </p>
<h2><a class="chapter" name="h2-7-conclusion"></a>7. Conclusion</h2>
<p>The algorithm used to detect NoSQL, SQL, XPath, OS command and LDAP injection attacks makes use of application-level hooks and monitoring of systems calls. Injection attacks such as SQL, NoSQL, OS command and LDAP injection exploits add additional code which leads to a change in the legitimate code of the application. The algorithm used to detect web injection-based exploitation makes use of abstract syntax trees (AST), program dependency graphs (PDG) and query parse trees to compute the changes in the original code due to injection-based exploits. The computation of changes in the code is done for every access to the database and invocation of program execution functions. If there is any deviation from the original code which is identified by changes in the AST, PDG, SQL parse tree or LDAP parse tree, it is checked to determine whether the deviation is due to the value or part of the value passed to the methods which accept user input such as GET, POST, Cookies, User-Agent, etc. In the case of a verification, an alert for injection exploitation is raised.</p>
<p>The algorithm used to detect injection-based exploitation has the following inherent advantages:</p>
<ul>
<li>It raises an alert during exploitation and is independent of the application and operating system on which the application is executing. Hence the algorithm is capable of detecting both known and zero-day vulnerabilities in the application.</li>
<li>Once an alert is raised, the algorithm also identifies the vulnerable section of the code which has been exploited by the threat actor. The identification of the vulnerable part of the code will help developers in patching the code to prevent further exploitation.</li>
<li>It complements current detection techniques such as signature-based pattern matching of SQL commands with known SQL commands such as UNION, etc. at the network layer and source code analysis.</li>
<li>The algorithm only leverages binary instrumentation of the application to detect injection-based exploitation. Hence detection is independent of the deployment of an application and the manner in which it accepts external inputs. The application can be deployed as a backend microservice and can accept batched requests which get broken down by the middle layer and served to the rear end microservices. In this scenario the algorithm will also raise an alert for injection-based attacks.</li>
</ul>
<p>These factors make the algorithm a recommended solution to detect NoSQL, SQL, LDAP, OS command, XPath and XQuery injection exploitation.</p>
<p> </p>
<h2><a class="chapter" name="h2-references"></a>References</h2>
<p><a class=" anchor" name="ref1"></a>[1] Top 10-2017, Top 10. <a href="https://www.owasp.org/index.php/Top_10-2017_Top_10" target="_blank">https://www.owasp.org/index.php/Top_10-2017_Top_10</a>.</p>
<p><a class=" anchor" name="ref2"></a>[2] Exploit Public-Facing Application. <a href="https://attack.mitre.org/techniques/T1190/" target="_blank">https://attack.mitre.org/techniques/T1190/</a>.</p>
<p><a class=" anchor" name="ref3"></a>[3] SQL Map. <a href="https://attack.mitre.org/software/S0225/" target="_blank">https://attack.mitre.org/software/S0225/</a>.</p>
<p><a class=" anchor" name="ref4"></a>[4] Compromised Web Servers and Web Shells – Threat Awareness and Guidance. <a href="https://www.us-cert.gov/ncas/alerts/TA15-314A" target="_blank">https://www.us-cert.gov/ncas/alerts/TA15-314A</a>.</p>
<p><a class=" anchor" name="ref5"></a>[5] NoSQL Injection. <a href="https://ckarande.gitbooks.io/owasp-nodegoat-tutorial/content/tutorial/a1_-_sql_and_nosql_injection.html" target="_blank">https://ckarande.gitbooks.io/owasp-nodegoat-tutorial/content/tutorial/a1_-_sql_and_nosql_injection.html</a>.</p>
<p><a class=" anchor" name="ref6"></a>[6] libpg_query. <a href="https://github.com/lfittl/libpg_query/blob/10-latest/README.md#resources" target="_blank">https://github.com/lfittl/libpg_query/blob/10-latest/README.md#resources</a>.</p>
<p><a class=" anchor" name="ref7"></a>[7] ECMAScript parsing infrastructure for multipurpose analysis. <a href="http://esprima.org" target="_blank">http://esprima.org</a>.</p>
<p><a class=" anchor" name="ref8"></a>[8] NoSQL injection in Mongodb. <a href="https://zanon.io/posts/nosql-injection-in-mongodb" target="_blank">https://zanon.io/posts/nosql-injection-in-mongodb</a>.</p>
<p><a class=" anchor" name="ref9"></a>[9] XPath Injection. <a href="https://cwe.mitre.org/data/definitions/643.html" target="_blank">https://cwe.mitre.org/data/definitions/643.html</a>.</p>
<p><a class=" anchor" name="ref10"></a>[10] JSON -AST. <a href="https://github.com/rse/json-asty" target="_blank">https://github.com/rse/json-asty</a>.</p>
<p><a class=" anchor" name="ref11"></a>[11] LDAP Injection &amp; Blind LDAP injection in Web Application. <a href="https://www.blackhat.com/presentations/bh-europe-08/Alonso-Parada/Whitepaper/bh-eu-08-alonso-parada-WP.pdf" target="_blank">https://www.blackhat.com/presentations/bh-europe-08/Alonso-Parada/Whitepaper/bh-eu-08-alonso-parada-WP.pdf</a>.</p>
<p><a class=" anchor" name="ref12"></a>[12] LDAP Filter Parser. <a href="https://www.rubydoc.info/github/ruby-ldap/ruby-net-ldap/Net/LDAP/Filter/FilterParser" target="_blank">https://www.rubydoc.info/github/ruby-ldap/ruby-net-ldap/Net/LDAP/Filter/FilterParser</a>.</p> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<p><a href="/uploads/pdf/magazine/2019/VB2019-Singh-Mani.pdf" target="_blank"><img src="/uploads/images/buttons/pdf-download-button.jpg" alt="Download PDF" width="262" height="45" /></a></p>
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=VB2019 paper: Catch me if you can: detection of injection exploitation by validating query and API integrity&url=https://www.virusbulletin.com/virusbulletin/2020/01/vb2019-paper-catch-me-if-you-can-detection-injection-exploitation-validating-query-and-api-integrity"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2020/01/vb2019-paper-catch-me-if-you-can-detection-injection-exploitation-validating-query-and-api-integrity'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2020/01/vb2019-paper-catch-me-if-you-can-detection-injection-exploitation-validating-query-and-api-integrity&title=VB2019 paper: Catch me if you can: detection of injection exploitation by validating query and API integrity"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2020/01/vb2019-paper-catch-me-if-you-can-detection-injection-exploitation-validating-query-and-api-integrity&t=VB2019 paper: Catch me if you can: detection of injection exploitation by validating query and API integrity"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2020/01/vb2019-paper-catch-me-if-you-can-detection-injection-exploitation-validating-query-and-api-integrity"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p> </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">©1989-2022 Virus Bulletin.        <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>        <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>        <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>