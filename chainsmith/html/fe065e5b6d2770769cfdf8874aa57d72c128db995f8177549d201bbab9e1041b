<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: Throwback Thursday: We're all doomed</title>
<meta name="description" content="When a daily sports paper compares a national soccer crisis with the spread of an Internet worm, you know that the worm has had an enormous impact on everyday life. In March 2004, Gabor Szappanos tracked the rise of W32/Mydoom." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 6337;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/blocks/expand_collapse_toc/templates/vbexpand/view.css" />
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/jquery.color.js"></script>
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<h1><a class="chapter" name="h1-throwback-thursday-were-all-doomed"></a>Throwback Thursday: We're all doomed</h1>
<h3><a class="chapter" name="h3-gabor-szappanos"></a>Gabor Szappanos</h3>
<p>VirusBuster, Hungary</p>
<p><em>Copyright © 2004 Virus Bulletin</em></p>
<hr />
<p> </p>
<div class="ccm-expand-collapse-toc">
<div id="ccm-expand-collapse-toc-title-13759" class="ccm-expand-collapse-toc-title ccm-expand-collapse-toc-closed" data-expander-speed="500">Table of contents</div><div id="ccm-expand-collapse-toc-content-13759" class="ccm-expand-collapse-toc-content"><p><a class="toc-level2" href="#h2-introduction">Introduction</a><br /> <a class="toc-level2" href="#h2-overview">Overview</a><br /> <a class="toc-level2" href="#h2-mailing">Mailing</a><br /> <a class="toc-level2" href="#h2-kazaa-spreading">Kazaa spreading</a><br /> <a class="toc-level2" href="#h2-denial-service-attack">Denial of service attack</a><br /> <a class="toc-level2" href="#h2-backdoor">The backdoor</a><br /> <a class="toc-level2" href="#h2-take-two">Take two</a><br /> <a class="toc-level2" href="#h2-aftermath">Aftermath</a><br /> <a class="toc-level2" href="#h2-conclusion">Conclusion</a></p><p>&nbsp;</p></div></div>
<h2><a class="chapter" name="h2-introduction"></a>Introduction</h2>
<p>'The crisis in Hungarian soccer deepens at almost the same rate as the Mydoom worm destroys computer systems.' This quote is from a Hungarian daily sports newspaper. Nothing I have come across illustrates the impact of this virus better – and the extent to which it has infiltrated everyday life.</p>
<p>The first identified sample of Mydoom came from Russia, which is the suspected origin of this virus. According to <em>MessageLabs</em>, about 1.2 million samples were detected during the first 24 hours of the virus spread – which overtook the previous record holder, Sobig.F, by a narrow margin. During the peak, 1 in 12 emails were infected with Mydoom.A – also a new record.</p>
<p>The first alerts on Mydoom arrived on Monday 26 January 2004, at around 10pm local time. Having spent a busy weekend fighting the Dumaru.Y outbreak (see <a href="/uploads/pdf/magazine/2004/200403.pdf" target="_blank">Virus Bulletin March 2004 p.4</a>), I felt the name of this virus was completely justified.</p>
<p> </p>
<h2><a class="chapter" name="h2-overview"></a>Overview</h2>
<p>The virus usually spreads via email, but it can also spread using the <em>Kazaa</em> file exchange network. Mydoom.A is a 22,528-byte UPX compressed program. It uses a simple ROT13 algorithm to encode the most sensitive string variables in the virus code. The username and server name pool is not encrypted, but the registry locations, SMTP command and the message bodies are.</p>
<p>Upon execution the virus checks for the existence of the 'SwebSipcSmtxS0' mutex to ensure that only one instance of the virus runs at any one time. To indicate that a system is already infected, the virus creates the registry entry:</p>
<p style="padding-left: 30px;">HKLM\Software\Microsoft\Windows\CurrentVersion\0Explorer\ComDlg32\Version</p>
<p>If this key is not present the virus launches a separate thread that creates a file with the name 'Message' in the %Temp% directory. The file contains nonsensical text (using characters between 16 and 255 ASCII code) and displays in the <em>Notepad</em> text editor. The virus generates 4096 characters for the file, but the actual size of the file is larger and varies, because line breaks are inserted (CRLF) randomly within the text.</p>
<p>After the editor window has been closed, the virus deletes this file.</p>
<p>The virus drops its backdoor component SHIMGAPI.DLL into the <em>Windows</em> system folder, and loads this library immediately.</p>
<p>At this point the worm checks the system date. If it is later than 12 February 2004, 02 hours 28 minutes 57 seconds UTC, no more of the virus’s actions will be executed: it will not spread or run the DoS attack. However, it is only at this point that the date is checked, so if the worm instance was started before the drop-dead date, it will not stop working when the time passes this limit – the change will take effect only on the next startup.</p>
<p>Next the virus copies itself into the <em>Windows</em> system folder as TASKMON.EXE. The worm creates the key ‘TaskMon=%System%\taskmon.exe’ under the registry location:</p>
<p style="padding-left: 30px;">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</p>
<p>to ensure that it will execute automatically on <em>Windows</em> startup.</p>
<p>If the virus cannot create the key here (because of a lack of user privileges), it creates the key under the location</p>
<p style="padding-left: 30px;">HKEY_CURRENT_USER\Software\Microsft\Windows\CurrentVersion\Run</p>
<p> </p>
<h2><a class="chapter" name="h2-mailing"></a>Mailing</h2>
<p>In order to spread via email the virus gathers addresses from the <em>Windows</em> Address Book and from files with the extensions .htm, .sht, .php, .asp, .dbx, .tbb, .adb, .pl, .wab and .txt. The files are searched in the web browser cache and on all local hard drives. The addresses are stored in memory, rather than being saved to a local file.</p>
<p>The address gathering and the mail sender routines run in separate threads, with several memory variables synchronizing between them.</p>
<p>The subject line of the outgoing messages may be one of the following:</p>
<p class="monospace" style="padding-left: 30px;">test<br />hi<br />hello<br />Mail Delivery System<br />Server Report<br />Status<br />Mail Transaction Failed<br />Error</p>
<p>The message body is one of the following (or, depending on the value of a random variable, random characters):</p>
<ul class="monospace">
<li>Mail transaction failed. Partial message is available.</li>
<li>The message contains Unicode characters and has been sent as a binary attachment.</li>
<li>The message cannot be represented in 7-bit ASCII encoding and has been sent as a binary attachment.</li>
</ul>
<p>This is a clever twist of social engineering: the virus doesn’t even attempt to make itself look interesting. Instead, it camouflages itself as an error message, with the main content of the message attached. As the virus executable has the same icon as <em>Notepad</em> text documents, the unsuspecting recipient may think it is safe to open the attachment. In fact, the attachment is the virus with extension .bat, .exe, .pif, .cmd or .scr.</p>
<p>Occasionally it can create a ZIP package containing the virus (stored without compression) and send it as an attachment. In this case, the ZIP header contains the name of the executable in the archive, therefore the length of the header – and consequently the length of the archive – varies, despite the fact that the executable inside the archive is the same in all cases.</p>
<p>The filename of the attachment may be one of the following:</p>
<ul>
<li>document</li>
<li>readme</li>
<li>doc</li>
<li>text</li>
<li>file</li>
<li>data</li>
<li>test</li>
<li>message</li>
<li>body</li>
</ul>
<p>The worm avoids sending itself to email addresses that contain the following strings (these domains are annotated in the virus source as being friendly domains):</p>
<ul>
<li>"berkeley"</li>
<li>"unix"</li>
<li>"math"</li>
<li>"bsd"</li>
<li>"mit.e"</li>
<li>"gnu"</li>
<li>"fsf."</li>
<li>"ibm.com"</li>
<li>"google"</li>
<li>"kernel"</li>
<li>"linux"</li>
<li>"fido"</li>
<li>"usenet"</li>
<li>"iana"</li>
<li>"ietf"</li>
<li>"rfc-ed"</li>
<li>"sendmail"</li>
<li>"arin."</li>
<li>"ripe."</li>
<li>"isi.e"</li>
<li>"isc.o"</li>
<li>"secur"</li>
<li>"acketst"</li>
<li>"pgp"</li>
<li>"tanford.e"</li>
<li>"utgers.ed"</li>
<li>"mozilla"</li>
</ul>
<p>Another set of domains is also avoided, but these are not likely to be considered friendly, these are more likely to be domains that are better avoided:</p>
<ul>
<li>"avp"</li>
<li>"syma"</li>
<li>"icrosof"</li>
<li>"msn."</li>
<li>"hotmail"</li>
<li>"panda"</li>
<li>"sopho"</li>
<li>"borlan"</li>
<li>"inpris"</li>
<li>"example"</li>
<li>"mydomai"</li>
<li>"nodomai"</li>
<li>"ruslis"</li>
<li>".gov"</li>
<li>"gov."</li>
<li>".mil"</li>
<li>"foo."</li>
</ul>
<p>The worm also avoids sending itself if the username contains the following strings (thus avoiding mailboxes with owners who may be more careful than the average):</p>
<ul>
<li>www</li>
<li>secur</li>
<li>abuse</li>
<li>root</li>
<li>info</li>
<li>someone</li>
<li>your</li>
<li>you</li>
<li>me</li>
<li>bugs</li>
<li>service</li>
<li>help</li>
<li>not</li>
<li>submit</li>
<li>feste</li>
<li>ntivi</li>
<li>unix</li>
<li>bsd</li>
<li>linux</li>
<li>listserv</li>
<li>samples</li>
<li>postmaster</li>
<li>webmaster</li>
<li>noone</li>
<li>nobody</li>
<li>nothing</li>
<li>rating</li>
<li>site</li>
<li>contact</li>
<li>soft </li>
<li>no</li>
<li>somebody</li>
<li>ca</li>
<li>gold-certs</li>
<li>the.bat</li>
<li>page</li>
<li>admin</li>
<li>icrosoft</li>
<li>certific</li>
<li>google</li>
<li>accoun</li>
</ul>
<p>Despite these limitations, the virus obviously found enough targets to enable its global epidemic. This is probably because it relies on sending itself to general users who tend to click on attachments without consideration, while the addresses it avoids are likely to belong to sysadmins, who may be more careful.</p>
<p>Depending on the value of a random variable, the worm may not use the harvested email address. Instead it combines the domain part of the address with one of the usernames in the following list:</p>
<ul>
<li>sandra</li>
<li>linda</li>
<li>julie</li>
<li>jimmy</li>
<li>jerry</li>
<li>helen</li>
<li>debby</li>
<li>claudia</li>
<li>brenda</li>
<li>anna</li>
<li>alice</li>
<li>brent</li>
<li>adam</li>
<li>ted</li>
<li>fred</li>
<li>jack</li>
<li>bill</li>
<li>stan</li>
<li>smith</li>
<li>steve</li>
<li>matt</li>
<li>dave</li>
<li>dan</li>
<li>joe</li>
<li>jane</li>
<li>bob</li>
<li>robert</li>
<li>peter</li>
<li>tom</li>
<li>ray</li>
<li>mary</li>
<li>serg</li>
<li>brian</li>
<li>jim</li>
<li>maria</li>
<li>leo</li>
<li>jose</li>
<li>andrew</li>
<li>sam</li>
<li>george</li>
<li>david</li>
<li>kevin</li>
<li>mike</li>
<li>james</li>
<li>michael</li>
<li>john</li>
<li>alex</li>
</ul>
<p>Finally, the virus sends itself via SMTP, constructing messages using its own SMTP engine. The worm attempts to guess the recipient email server. First it probes the domain part of the email address then, if it fails, it prepends the following strings and issues a DNS query of that server for each:</p>
<ul>
<li>mx.</li>
<li>mail.</li>
<li>smtp.</li>
<li>mx1.</li>
<li>mxs.</li>
<li>mail1.</li>
<li>relay.</li>
<li>ns.</li>
</ul>
<p>If none of the queries is successful, or the virus fails to connect to the target SMTP server, it will use the locally defined SMTP server read from the registry.</p>
<p>The sender of the message is spoofed by the virus. One of the collected email addresses may be used for this purpose or, with a two per cent chance, the sender name will be a three- to five-character string with one of the following domain names:</p>
<ul>
<li>aol.com</li>
<li>msn.com</li>
<li>yahoo.com</li>
<li>hotmail.com</li>
</ul>
<p>This leads to all the usual problems caused by a virus outbreak. Not only did the virus generate an enormous number of infected messages, but even more were generated by misconfigured mail servers. First, many of the recipients were invalid addresses, either because they were generated randomly, or because the email address collecting routine of the worm is faulty (the routine only checks the '@' character – so, for example, the worm attempted to send itself to the address '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="433470716d392236302b2822032e2e6d392a33">[email&#160;protected]</a>' – without much success of course).</p>
<p>Some servers throw the message back to the spoofed sender, and another problem comes in the form of infection notification messages. Despite the fact that many of the most prolific mass mailers spoof the sender address, the majority of email gateways send infection notifications to the spoofed sender when an infected message is encountered.</p>
<p>Another advanced feature of email protection programs is to purge the messages that are known to be generated by mass mailers. Otherwise, if only the attachment is deleted, the message still comes through, increasing the number of useless messages; but without the attachment, it is not easy to filter them out.</p>
<p> </p>
<h2><a class="chapter" name="h2-kazaa-spreading"></a>Kazaa spreading</h2>
<p>The worm copies itself into the download directory of the Kazaa peer-to-peer file exchange program. The location is read from the value of the registry key 'HKCU\Software\Kazaa\Transfer\DlDir0'. It uses one of the following file names:</p>
<ul>
<li>winamp5</li>
<li>icq2004-final</li>
<li>activation_crack</li>
<li>rootkitXP</li>
<li>strip-girl-2.0bdcom_patches</li>
<li>office_crack</li>
<li>nuke2004</li>
</ul>
<p>The extension is .PIF, .BAT, .SCR or .EXE.</p>
<p> </p>
<h2><a class="chapter" name="h2-denial-service-attack"></a>Denial of service attack</h2>
<p>Between 1 February 2004 and 12 February 2004, Mydoom.A performs a denial-of-service (D0S) attack against the website www.sco.com.</p>
<p>Since the virus only checks the system date on startup, this action will not take place until the next startup of the infected computer within this time frame. Also, the attack will continue after the end date until the computer is rebooted (or the virus process is stopped, for that matter). The DoS attack takes place if the virus is started after 16:09:18 UTC.</p>
<p>The worm sends a GET request every millisecond to port 80 of the site being attacked. However, due to a bug in the virus code the attack will not begin on all infected computers after the start date. While checking the current date against the start date, the virus compares the two dwords separately, requiring each to be above the specified start date. Thus, even if the qword representing the current date is higher than the qword of the start date, the attack only starts if the low dword is higher as well. As the stored low dword of the attack is 0xbe9ecb00, the attack occurs on only about 25 per cent of the infected computers.</p>
<p>The same does not apply to the end-of-life date check, because if the high dword is later than the end date, the worm exits without checking the lower dword.</p>
<p> </p>
<h2><a class="chapter" name="h2-backdoor"></a>The backdoor</h2>
<p>The virus drops SHIMGAPI.DLL, which is a backdoor component listening on the first available TCP ports between 3127 and 3198.</p>
<p>The DLL itself is stored in encoded form within the virus body. It is used for two purposes:</p>
<ol>
<li>To establish a path to download and execute file to the infected computer.</li>
<li>To establish a proxy.</li>
</ol>
<p>The DLL registers itself via the registry key:</p>
<p style="padding-left: 30px;">HKEY_CLASSES_ROOT\CLSID\{E6FB5E20-DE35-11CF-9C87-00AA005127ED}\InProcServer32 "(Default)" = %SysDir%\shimgapi.dll</p>
<p>The default value of this key is 'Webcheck.dll', which is a COM interface for web monitoring. With this modification the worm makes sure that the shimgapi.dll file is loaded intothe address space of explorer.exe upon the next startup. On the first execution on an infected computer, the virus itself loads this library.</p>
<p>While searching for a free port, the backdoor starts from port 3127. If the port is not free, it waits for 400 ms and skips to the next port. If none of the ports up to 3198 are free, it waits another 800 ms and goes back to port 3127 to start the process all over again.</p>
<p>When an available port is found, the backdoor creates three threads that listen on that port. A counter increments on incoming connections. If only one free listener thread is available, the backdoor will open two more listener threads.</p>
<p>On incoming data the first byte serves as an ID. Only two values of this ID are supported in Mydoom.A. If anything else is sent, or an error occurs, an error status message is sent back.</p>
<p>If the ID is 85h, then four bytes are skipped, the next four bytes must match the magic dword 133C9EA2h. If this condition is true, the rest of the stream is saved into a temporary file and executed. An attempt was made to use this feature in Mydoom.B to update the systems infected with the original version of the worm.</p>
<p>If the ID is 4h, the rest of the stream is read, then the target IP address is extracted from the stream. If the backdoor can connect to the IP address, it acts as a proxy.</p>
<p>The first function enables an attacker to install a program of his will to the infected computer. All that needs to be done is to scan for these open ports, and then the computer is wide open for the attacker. Only a couple of days after the appearance of the virus there were already signs of port scans within this port region. Some of the scans were coming from sysadmins trying to find infected systems, but the volume of traffic seen was more than could be attributed to this source.</p>
<p>While the worm will not spread or perform the DoS attack if executed after the drop date, it will still create and execute the backdoor after its time has expired.</p>
<p> </p>
<h2><a class="chapter" name="h2-take-two"></a>Take two</h2>
<p>A couple of days after the original, a modified variant of Mydoom appeared. Its functionality was similar to that of the .A variant, with slight modifications. Mydoom.B infests itself as EXPLORER.EXE.</p>
<p>The subject lines are:</p>
<p class="monospace" style="padding-left: 30px;">Returned mail<br />Delivery Error<br />Status<br />Server Report<br />Mail Transaction Failed<br />Mail Delivery System<br />hello<br />hi</p>
<p>And the message bodies:</p>
<ul>
<li><span class="monospace">sendmail daemon reported:</span></li>
<li class="monospace">Error #804 occured during SMTP session. Partial message has been received.</li>
<li class="monospace">Mail transaction failed. Partial message is available.</li>
<li class="monospace">The message contains Unicode characters and has been sent as a binary attachment.</li>
<li class="monospace">The message contains MIME-encoded graphics and has been sent as a binary attachment.</li>
<li class="monospace">The message cannot be represented in 7-bit ASCII encoding and has been sent as a binary attachment.</li>
</ul>
<p>The filename of the attachment may be one of the following:</p>
<ul>
<li>document</li>
<li>readme</li>
<li>doc</li>
<li>text</li>
<li>data</li>
<li>test</li>
<li>message</li>
<li>body</li>
<li>file</li>
</ul>
<p>The worm copies itself into the download directory of the <em>Kazaa</em> peer-to-peer file exchange program. It uses one of the following file names:</p>
<ul>
<li>icq2004-final</li>
<li>Xsharez_scanner</li>
<li>ZapSetup_40_148</li>
<li>MS04-01_hotfix</li>
<li>BlackIce_Firewall_Enterpriseactivation_crack</li>
<li>Winamp5</li>
<li>AttackXP-1.26</li>
<li>NessusScan_pro</li>
</ul>
<p>Starting on 1 February 2004, Mydoom.B performs a denial of service attack against the website www.microsoft.com, and from 3 February 2004 against the website www.sco.com. The virus stops its activities upon the first system boot after 1 March 2004.</p>
<p>The virus modifies the hosts file to redirect the following websites to 0.0.0.0, thereby disabling access to them:</p>
<ul>
<li>ad.doubleclick.net</li>
<li>ad.fastclick.net</li>
<li>ads.fastclick.net</li>
<li>ar.atwola.com</li>
<li>atdmt.com</li>
<li>avp.ch</li>
<li>avp.com</li>
<li>avp.ru</li>
<li>awaps.net</li>
<li>banner.fastclick.net</li>
<li>banners.fastclick.net</li>
<li>ca.com</li>
<li>click.atdmt.com</li>
<li>clicks.atdmt.com</li>
<li>dispatch.mcafee.com</li>
<li>download.mcafee.com</li>
<li>download.microsoft.com</li>
<li>downloads.microsoft.com</li>
<li>engine.awaps.net</li>
<li>fastclick.net</li>
<li>f-secure.com</li>
<li>ftp.f-secure.com</li>
<li>ftp.sophos.com</li>
<li>go.microsoft.com</li>
<li>liveupdate.symantec.com</li>
<li>mast.mcafee.com</li>
<li>mcafee.com</li>
<li>media.fastclick.net</li>
<li>msdn.microsoft.com</li>
<li>my-etrust.com</li>
<li>nai.com</li>
<li>networkassociates.com</li>
<li>office.microsoft.com</li>
<li>phx.corporate-ir.net</li>
<li>secure.nai.com</li>
<li>securityresponse.symantec.com</li>
<li>service1.symantec.com</li>
<li>sophos.com</li>
<li>spd.atdmt.com</li>
<li>support.microsoft.com</li>
<li>symantec.com</li>
<li>update.symantec.com</li>
<li>updates.symantec.com</li>
<li>us.mcafee.com</li>
<li>vil.nai.com</li>
<li>viruslist.ru</li>
<li>windowsupdate.microsoft.com</li>
<li>www.avp.ch</li>
<li>www.avp.com</li>
<li>www.avp.ru</li>
<li>www.awaps.net</li>
<li>www.ca.com</li>
<li>www.fastclick.net</li>
<li>www.f-secure.com</li>
<li>www.kaspersky.ru</li>
<li>www.mcafee.com</li>
<li>www.microsoft.com</li>
<li>www.my-etrust.com</li>
<li>www.nai.com</li>
<li>www.networkassociates.com</li>
<li>www.sophos.com</li>
<li>www.symantec.com</li>
<li>www.trendmicro.com</li>
<li>www.viruslist.ru</li>
<li>www3.ca.com</li>
</ul>
<p>One particular feature of Mydoom.B is worth mentioning. Using the file upload and execute feature of the backdoor component, the virus attempted to upgrade existing Mydoom.A infections with the new version. After activation it generated random IP addresses and attempted to upload itself to port 3127 of those systems. Fortunately and surprisingly, the .B variant did not spread well. While <em>MessageLabs</em> stopped over one million samples of the first variant on the first day, only eight samples of the second variant were found – which were most likely seeding samples.</p>
<p>There was also a bug in the DoS routine of the second variant. Due to a programming error (the same comparing error, coupled with another check), the attack against www.microsoft.com never occurs.</p>
<p> </p>
<h2><a class="chapter" name="h2-aftermath"></a>Aftermath</h2>
<p>The sheer number of infected computers with the backdoor installed was too tempting an opportunity to let pass. Around 1 million computers were waiting for someone to send them just about any code to execute. The author of Mydoom.A couldn't resist this temptation, and wrote a new worm, Doomjuice.A. This had only one propagation method, the 'Mydoom backdoor' method. It attempted to connect to port 3127 of random IP addresses then sent itself for execution. On infected computers it dropped an archive containing the (almost) complete source code for Mydoom.A. This worm also had a fixed date check in the DoS procedure, for attacking www.microsoft.com.</p>
<p> </p>
<h2><a class="chapter" name="h2-conclusion"></a>Conclusion</h2>
<p>Once again, a simple email worm hit the world. Mydoom did not use clever tricks or new exploits (in fact, not even old exploits) to launch its attachment automatically. It relied on the old click-and-run routine. It has been possible to configure <em>Outlook</em> and <em>Outlook Express</em> to block access to files with executable extensions for years. However, the majority of users do not bother to install the latest patches for these email clients and the vast majority of users have not learned the lesson of not clicking on attachments. We are bound to be doomed again in the future.</p>
<p><em>[In <a href="/uploads/pdf/magazine/2004/200404.pdf" target="_blank">Virus Bulletin, April 2004 </a>p.8 (PDF) Gabor Szappanos looks at the worms that use the backdoor component of Mydoom to spread.]</em></p> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<p><a href="/uploads/pdf/magazine/2004/200403-analysis-Mydoom-Szappanos.pdf" target="_blank"><img src="/uploads/images/buttons/pdf-download-button.jpg" alt="Download PDF" width="262" height="45" /></a></p>
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=Throwback Thursday: We're all doomed&url=https://www.virusbulletin.com/virusbulletin/2019/01/throwback-thursday-were-all-doomed"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2019/01/throwback-thursday-were-all-doomed'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2019/01/throwback-thursday-were-all-doomed&title=Throwback Thursday: We're all doomed"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2019/01/throwback-thursday-were-all-doomed&t=Throwback Thursday: We're all doomed"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2019/01/throwback-thursday-were-all-doomed"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p> </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">©1989-2022 Virus Bulletin.        <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>        <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>        <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>