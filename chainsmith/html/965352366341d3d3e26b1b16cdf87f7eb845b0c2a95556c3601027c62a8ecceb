<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: Pushdo's new second generation</title>
<meta name="description" content="The Pushdo botnet has been active in the wild since January 2007, with three main generations seen to date. Neo Tan and colleagues take an in-depth look at three different variants of a new, more advanced version of Pushdo’s second generation." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 1793;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/remo_expand/blocks/remo_expand/templates/vbexpand/view.css" />
<script type="text/javascript" src="/packages/remo_expand/js/jquery.color.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/remo.expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<div class="titlepage" xmlns=""><div><div><h1 class="title" xmlns="http://www.w3.org/1999/xhtml"><a id="vb201304-Pushdo"></a>Pushdo&#39;s new second generation</h1></div><div><p class="pubdate" xmlns="http://www.w3.org/1999/xhtml">2013-04-03</p></div><div><div class="authorgroup" xmlns="http://www.w3.org/1999/xhtml"><div class="author titlepage"><h3 class="author"><span class="surname">Neo Tan</span></h3><span class="orgname">Fortinet</span>, <span class="orgdiv">Canada</span></div><div class="author titlepage"><h3 class="author"><span class="firstname">He</span> <span class="surname">Xu</span></h3><span class="orgname">Fortinet</span>, <span class="orgdiv">Canada</span></div><div class="author titlepage"><h3 class="author"><span class="firstname">Kyle</span> <span class="surname">Yang</span></h3><span class="orgname">Fortinet</span>, <span class="orgdiv">Canada</span></div><b class="editedby">Editor: </b><span class="editor"><span class="firstname">Helen</span> <span class="surname">Martin</span></span></div></div><div><div class="abstract" xmlns="http://www.w3.org/1999/xhtml"><p class="title"><b>Abstract</b></p><p>The Pushdo botnet has been active in the wild since January 2007, with three main generations seen to date. Neo Tan and colleagues take an in-depth look at three different variants of a new, more advanced version of Pushdo&rsquo;s second generation.</p></div></div><div><p class="copyright" xmlns="http://www.w3.org/1999/xhtml"><i>Copyright &copy; 2013 Virus Bulletin</i></p></div></div><hr /></div>
<div class="ccm-remo-expand">
<div id="ccm-remo-expand-title-2828" class="ccm-remo-expand-title ccm-remo-expand-closed" data-expander-speed="200">Table of contents</div><div id="ccm-remo-expand-content-2828" class="ccm-remo-expand-content"><div class="toc"><dl><dt><span class="sect1"><a href="#id4378292"></a></span></dt><dt><span class="sect1"><a href="#id3743617">Pushdo main downloader</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2309929">Installation process</a></span></dt><dt><span class="sect2"><a href="#id4031337">Extract and deploy the ad clicker module</a></span></dt><dt><span class="sect2"><a href="#id4124672">Legacy communication routine</a></span></dt><dt><span class="sect2"><a href="#id4394118">Communication protocol and encryption algorithm</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id3871070">Spam engine &ndash; Cutwail</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2637456">Load pre-configuration</a></span></dt><dt><span class="sect2"><a href="#id3694892">Communicates with Cutwail C&amp;C servers</a></span></dt><dt><span class="sect2"><a href="#id4902258">Encryption &amp; decryption algorithms</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id4182008">Other downloaded modules</a></span></dt><dt><span class="sect1"><a href="#id4007772">Conclusion</a></span></dt></dl></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4378292"></a></h2></div></div></div><p>Pushdo is a persistent botnet, having been active in the wild since January 2007. To date, there have been three main generations. The first generation of Pushdo used a clear text (with many different parameters) HTTP request to communicate with its C&amp;C servers. This was encrypted (using RC4) in the second generation. The second generation of Pushdo also generated lots of fake SSL traffic to legitimate websites, trying to hide its communication data amongst it. The third generation of Pushdo changed dramatically: a binary data structure was introduced, along with many custom encryption algorithms to secure the communication with C&amp;C servers. In this article, we will mainly focus on three different variants of a new, more advanced version of Pushdo&rsquo;s second generation.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3743617"></a>Pushdo main downloader</h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id2309929"></a>Installation process</h3></div></div></div><p>When the Pushdo bot is running on a compromised machine, it will first create the following registry entries and randomly generate 0x10 bytes as key data in binary format:</p><p> HKCU\Software\Microsoft\Windows\CurrentVersion&ldquo;AppManagement&rdquo; = [0x10 random bytes]</p><p> HKCU\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION&ldquo;XOZNACAXMEJAZAP&rdquo; = [0X10 RANDOM BYTES] </p><p>&lsquo;Xoznacaxmeja&rsquo; and &lsquo;zap&rsquo; are both hard coded strings.The &lsquo;xoznacaxmeja&rsquo; string will be used as this instance&rsquo;s mutex name and new file name. After creating the infected flag registry entries, it will copy itself to %userprofile%\xoznacaxmeja.exe and then create the following autorun registry entry:</p><p> HKCU\Software\Microsoft\Windows\CurrentVersion\Run &ldquo;xoznacaxmeja&rdquo; = &ldquo;[%userprofile%\xoznacaxmeja.exe]&rdquo; </p><p>Then, it will load additional modules and try to communicate with its C&amp;C servers. </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4031337"></a>Extract and deploy the ad clicker module</h3></div></div></div><p>The bot starts to decrypt data in a specific location of the binary into a binary template of the clicker module without the domain names, and decrypts another location of the binary into a list of domains; in both cases the data is decrypted using XORs with changing modifiers. The decrypted domains will be copied to the clicker&rsquo;s binary template at a specific location; in this case, it is marked using the string &lsquo;XNG7&rsquo;. This tag is later used by a function in Pushdo and the clicker module to update the domain list. After the binary template has been filled with the domain names, it is loaded into memory and executed as a child thread of the bot.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4124672"></a>Legacy communication routine</h3></div></div></div><p>The bot decrypts the data &ndash; which contains not only the C&amp;C server domain names, but also the names of many other legitimate domains. Obviously, the author is trying to hide the C&amp;C server domain amongst the many other legitimate domain names to make it hard to pick out during static analysis. It also tries to hide its communication data amongst other legitimate website traffic when undergoing dynamic analysis. </p><p>Next, it randomly chooses one domain from the list, appends &lsquo;https://&rsquo; to create an Internet connection and sends an &lsquo;Accept: */*&rsquo; request to it. If there is no response, or if the response size is less than 0x400 bytes, it will pick another domain randomly from the list and try that one, or else it will try to parse the response. It looks for a fake HTML tag pattern that is base64 encoded in the Pushdo binary: &lsquo;PGltZyBzcmM9ImRhdGE6aW1hZ2UvanBlZztiYXNlNjQs&rsquo;. After base64 decoding, it becomes the following: </p><pre class="programlisting">&lt;imgsrc=&rdquo;data:image/jpeg;base64,</pre><p>If it finds a match for this pattern in the response data, it will decrypt the data that comes after the comma and then inject it into a newly created svchost.exe process. This is probably one way of providing a PPI (Pay Per Install) service, since we didn&rsquo;t see its own module or update binary going through this. But, in certain conditions, there is a possibility for it to get a binary update or new module in this way. However, we believe that this routine belongs to the older version of Pushdo, where it was used as the main communication protocol. In the next part, we&rsquo;ll dissect the communication protocol and encryption algorithm for the three more recent variants of the Pushdo bot. </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4394118"></a>Communication protocol and encryption algorithm</h3></div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id3909976"></a>Find real C&amp;C server domain</h4></div></div></div><p>Previously in Pushdo&rsquo;s second generation, before the final contact with the server there was a routine involving another list of domains hiding another C&amp;C server among them. However, this has gone from the latest version (found in December 2012). This time, contact with the server is persistent, as the bot wants to keep exchanging information with or downloading updates from it. The C&amp;C server is once again hidden in a second decrypted domain list. The bot calculates each domain&rsquo;s hash and compares them to a pre-stored hashing value: 9D0B0400h (<a href="#figure.1">Figure 1</a>). The one that matches is the C&amp;C server.</p><div class="figure"><a id="figure.1"></a><div class="mediaobject"><img alt="Domain arlexdar.com matches the hashing value." src="/uploads/images/figures/2013/04/pushdo-1.jpg" /></div><p class="title"><b>Figure&nbsp;1.&nbsp;Domain arlexdar.com matches the hashing value.</b></p></div><p>(Click <a href="/uploads/images/figures/2013/04/pushdo-1-large.jpg" target="_top">here</a> to view a larger version of Figure 1.)</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id4729846"></a>Form sending data</h4></div></div></div><p>After gathering information from the victim&rsquo;s PC, the bot prepares a message for sending. The structure of the plaintext message evolved between October and December 2012. There are three different data structures.</p><pre class="programlisting">struct _PlainTextMessageV1andV2 {
   DWORD        staticDword1;   //static 01
   DWORD        staticDword2;   //may change in variants
   DWORD        staticDword3;   //static 01
   DWORD        staticDword4;   //static 00
   DWORD        staticDword5;   //static 00
   DWORD        staticDword6;   //may change in variants
   BYTE[0x10]   randGenData;   //random generated data
   BYTE[0x10]   localGenData;   //generated data using volume info and adapter info
   DWORD        installFlags;   //bit flags
   SendBlockV1  dataBlock;
}
Struct _SendBlockV1 {
   DWORD        size;
   BYTE         domainHash[size];
}
</pre><p>The first variant contains some static data with the hash value of the C&amp;C domain at the end. The size of the dataBlock is always 4 because the calculated hash value of the C&amp;C domain is a DWORD. The second variant contains a little more information than the first in the data block &ndash; the bot&rsquo;s binary hash value and the server domain string are also included:</p><pre class="programlisting">Struct _SendBlockV2 {
   DWORD   size;
   DWORD   domainHash;
   DWORD   botBinHash;
   BYTE   serverDomain[size-8];
}
</pre><p>The latest variant has undergone several changes and contains even more data:</p><pre class="programlisting">struct _PlainTextMessageV3 {
   DWORD         staticDword1;
   DWORD         staticDword2;
   DWORD         staticDword3;
   DWORD         staticDword4;
   DWORD         installFlags;   //bit flags
   QWORD         reserved;
   DWORD         staticDword5;
   DWORD         botBinHash;    //hash of the bot binary
   BYTE          serverDomain[0x28];
   SendBlockV1   mutexName;
   SendBlockV1   parentName;    //parent process
   SendBlockV1   botPath;       //current file path
   SendBlockV1   clsid;         //CLSID generated using local system info
   BYTE          garbage[0 to 0x50];
}
</pre><p>The trend is to include an increasing amount of local environment information so that the server is able to decide how to deal with the bot. For example, in <a href="#figure.2">Figure 2</a>, if the server checks the parent process, which is &lsquo;flyODBG.eXe&rsquo; (the &lsquo;legitimate&rsquo; parent process is svchost.exe), it can easily deduce that the bot sending this message is being debugged. </p><div class="figure"><a id="figure.2"></a><div class="mediaobject"><img alt="An example of the prepared message to send to the server in the latest (third) variant." src="/uploads/images/figures/2013/04/pushdo-2.jpg" /></div><p class="title"><b>Figure&nbsp;2.&nbsp;An example of the prepared message to send to the server in the latest (third) variant.</b></p></div><p>The message shown in <a href="#figure.2">Figure 2</a> contains a lot of garbage data, some of which is hard coded in the bot binary &ndash; such as the first four DWORDs and the eighth DWORD &ndash; and some of which is generated randomly, such as the 10 bytes at the end (highlighted in grey). The random garbage data can be any size between 0 and 0x50 bytes. The first meaningful part starts at the 5th DWORD at location +0x10 of this structure: 0x1D, which describes the installation log. It is in bit flags format and has not changed much between the variants. Starting from the lowest to the fifth bit, they are described as shown in <a href="#figure.3">Figure 3</a>. </p><div class="figure"><a id="figure.3"></a><div class="mediaobject"><img alt="Installation bit flags." src="/uploads/images/figures/2013/04/pushdo-3.jpg" /></div><p class="title"><b>Figure&nbsp;3.&nbsp;Installation bit flags.</b></p></div><p>Thus, 0x1D in our example tells the C&amp;C server that the autorun registry entry is set, the mutex &lsquo;xoznacaxmeja&rsquo; has been created, the AppManagement and the xoznacaxmejazap registry entries are set, that this system can access urlmon GZIP decompress APIs, and that the CRC32 hash of the current bot executable is calculated. The DWORD 0xED4e4133 at location +0x20 is the hash &ndash; this can be used to identify if the executable has been tampered with. It can also be used to check if the current bot needs an update. Starting at +0x24 is the container for the C&amp;C server domain name, the (fixed) size of which is 0x28 bytes. Starting at +0x4C are the strings/value, with the first byte describing the length of each. In order, they are: the mutex name (0xC bytes), the current bot&rsquo;s parent process (0x1C bytes), the full path of the bot (0x1A bytes), a hard-coded value (0xC bytes) and the CLSID generated using the victim&rsquo;s system volume information and adapter information (0x24 bytes). </p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id4810836"></a>Encryption routine</h4></div></div></div><p>The encryption routine is the thing that differs the most between the variants. In the first and second variants, the encryption uses RC4 and is defined as follows:</p><pre class="programlisting">struct _MessageToSend V1and2{
   DWORD   magic;
   DWORD   key;
   DWORD   hash;
   BYTE    encryptedMessage[totalContentSize - 0x8];
}
</pre><p>The first DWORD is generated using a random generating algorithm such that the remainder of dividing 0x1ECB will always be 1. The second DWORD is the RC4 key, and the third is the hash value of the message body.</p><div class="figure"><a id="figure.4"></a><div class="mediaobject"><img alt="Encrypted message in first and second variants." src="/uploads/images/figures/2013/04/pushdo-4.jpg" /></div><p class="title"><b>Figure&nbsp;4.&nbsp;Encrypted message in first and second variants.</b></p></div><p>However, it gets complicated in the third variant. The encryption process involves two steps. At first, it makes use of the <span class="emphasis"><em>Microsoft</em></span> Cryptography functions from the ADVAPI32 library. After calling CryptAcquireContext with pszContainer = &lsquo;Microsoft Enhanced Cryptographic Provider v1.0&rsquo; to acquire the new key container, it calls CryptGenKey to generate the RC4 session key. Then it calls CryptExportKey to export the RC4 session key to a PLAINTEXTKEYBLOB struct. The structures are defined as follows:</p><pre class="programlisting">struct_PLAINTEXTKEYBLOB {
   BLOBHEADER  hdr;
   DWORD       dwKeySize;
   BYTE        rgbKeyData[];
}

struct_BLOBHEADER {
   BYTE       bType;
   BYTE       bVersion;
   WORD       reserverd;
   ALG_ID     algid;
}
</pre><p><a href="#figure.5">Figure 5</a> shows an example of the exported PLAINTEXTKEYBLOB. The yellow highlighted area is the BLOBHEADER, describing the format and algorithm of the key (0x6801 means CALG_RC4), and the green highlighted area is the RC4 session key. </p><div class="figure"><a id="figure.5"></a><div class="mediaobject"><img alt="Exported PLAINTEXTKEYBLOB." src="/uploads/images/figures/2013/04/pushdo-5.jpg" /></div><p class="title"><b>Figure&nbsp;5.&nbsp;Exported PLAINTEXTKEYBLOB.</b></p></div><p>Next, it calls CryptImportKey to import a 0x94 bytes keyblob that is hard coded in the binary. This is the C&amp;C server&rsquo;s public key. Again, it calls CryptExportKey to export the RC4 session key, but this time it is exported into the SIMPLEBLOB data structure and using the imported server public key to encrypt the exporting key. The SIMPLEBLOB data structure is defined as follows: </p><pre class="programlisting">struct _SIMPLEBLOB {
   BLOBHEADER   hdr;
   ALG_ID       algid;
   BYTE         encryptedKey[0x80];
}
</pre><p><a href="#figure.6">Figure 6</a> shows an example of the exported SIMPLEBLOB. The DWORD 0xA400 (highlighted in orange) describes that this exported key is encrypted using RSA public key encryption. The encrypted session key&rsquo;s algorithm is CALG_RC4 and highlighted in green.</p><div class="figure"><a id="figure.6"></a><div class="mediaobject"><img alt="EXPORTED SIMPLEBLOB." src="/uploads/images/figures/2013/04/pushdo-6.jpg" /></div><p class="title"><b>Figure&nbsp;6.&nbsp;EXPORTED SIMPLEBLOB.</b></p></div><p>Thus, the RC4 session key has been exported twice, and on the second occasion it is encrypted by the server&rsquo;s public key so that it can be used for communication. It calls CryptAcquireContext again to create a new key container, imports the plaintext RC4 key and uses it to encrypt the message. In fact, the plaintext key exporting and importing is not necessary since it can just re-use the previously created key handle that is pointing to the session key generated by CryptGenKey. Although the exported key is encrypted using the server&rsquo;s public key with RSA, it seems the author still wanted to &lsquo;double-tap&rsquo; it to make sure the key is secure. It appends four DWORDs to the beginning of the exported SIMPLEBLOB, as shown in <a href="#figure.7">Figure 7</a>. They are, in order: magic word, key to encrypt the keyblob, reserved DWORD for hashing the value of the following data, and keyblob size. The magic DWORD value is generated randomly but using an algorithm that means the remainder of dividing 0x1ECB will always be 2.</p><div class="figure"><a id="figure.7"></a><div class="mediaobject"><img alt="Structure that will encrypt the keyblob." src="/uploads/images/figures/2013/04/pushdo-7.jpg" /></div><p class="title"><b>Figure&nbsp;7.&nbsp;Structure that will encrypt the keyblob.</b></p></div><p>Next, it encrypts the keyblob with its size using the algorithm described in the following pseudo code, XOR with modified key:</p><pre class="programlisting">i = 0;
 j = 0;
if ( data &amp;&amp;dataSize&amp;&amp; key )
 {
sKey = 0x19660D * key + 0x3C6EF35F;
totalCount = dataSize / 4;
if ( dataSize / 4 &gt; 0 )
  {
   j = 4 * totalCount;
do
   {
data[ 4 * i] ^= sKey;
sKey = 0x19660D * sKey + 0x3C6EF35F;
     ++i;
    }
while ( i&lt;totalCount );
  }
remain = dataSize % 4;
if ( dataSize % 4 )  //if the data size can&rsquo;t be divided exactly by 4
  {
temp = 0;
remainStart = (data + 4 * i);
memcopy(&amp;temp, (data + 4 * i), remain);
temp ^= sKey;
memcopy(remainStart, &amp;temp, remain);
   j += remain;
  }
 }
</pre><p>Finally, it appends the encrypted message to the end of the encrypted keyblob and calculates the hash value of the block. The calculated hash value is stored in the reserved place at +0x8 of this structure. The packet it is going to send to the C&amp;C server can be defined as follows:</p><pre class="programlisting">struct _MessageToSendV3{
  DWORD  magic;
  DWORD  key;
  DWORD  hash;
  DWORD  sessionKeyLenEncrypted;
  BYTE   encryptedSessionKey[sessionKeyLen];
  BYTE   encryptedMessage[totalContentSize-0x10-sessionKeyLen];
}
</pre><div class="figure"><a id="figure.8"></a><div class="mediaobject"><img alt="Entire packet after encryption." src="/uploads/images/figures/2013/04/pushdo-8.jpg" /></div><p class="title"><b>Figure&nbsp;8.&nbsp;Entire packet after encryption.</b></p></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id3428945"></a>Searching and parsing response data</h4></div></div></div><p>The response from the C&amp;C server tries to disguise the commands in an HTML page. The commands are surrounded by HTML comment tags and a special tag string that looks like this: </p><pre class="programlisting">&lt;!--&lt;imgsrc=&rdquo;data:image/jpeg;base64,[C&amp;C server commands] &ldquo;/&gt;--&gt;</pre><p>The server commands are encoded into base64 so they can be transported properly in the HTML page. Then the same decryption routine as used by the older version of Pushdo is called. After base64 decoding, the commands block contains a fake JPEG header, of size 0x14 bytes. After removing the fake header, the data structure is exactly the same as the encrypted sending packet. </p><p>In the first and second variants it is the same as struct _MessageToSend V1and2: the magic DWORD, RC4 key, hash value of the message and the message body. After being decrypted using the RC4 key, the plaintext response message structure is defined as: </p><pre class="programlisting">struct _ReceivedCommandsV1andV2 {
  DWORD  staticDword1;
  DWORD  staticDword2;
  DWORD  staticDword3;
  DWORD  staticDword4;   //they are the same as the sending message
  DWORD  cmdType;
  DWORD  reserved1;
  DWORD  reserved2;
  DWORD  dataSize;
  BYTE   data[dataSize];  //the downloaded file may be compressed
}
</pre><p>The first 0x10 bytes are the same as the sending message. The cmdType is also in bit flags format, and indicates what to do with the data file (which we will explain in detail in the third variant since it doesn&rsquo;t change much). </p><p>In the third variant, the encrypted responding message contains the magic DWORD, key to encrypt the keyblob, hash of the following data, encrypted session key and encrypted message. </p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id3563639"></a>Decrypting response data</h4></div></div></div><p>The decryption procedure is the reverse of the encryption we described above:</p><div class="orderedlist"><ol type="1"><li><p>Check the magic word and the hash value.</p></li><li><p>Use the XOR algorithm to decrypt the DWORD that contains the length of the session key.</p></li><li><p>Use the same algorithm to decrypt the session key.</p></li><li><p>Calculate the size of the rest of the data using the total content size minus 0x10 and the size of the session key, and import the session key to decrypt the commands.</p></li></ol></div><p>The decrypted message structures are described as follows:</p><pre class="programlisting">struct _ReceivedCommandsV3 {
  DWORD     cmdCount;
  _Command  command[cmdCount];
}
struct _Command {
  DWORD    cmdSize;
  DWORD    cmdType;
  DWORD    isUpdate;
  DWORD    cmdFlags; //bit flags
  BYTE    data[cmdSize-0x10];    //the downloaded file may be compressed
}
</pre><p>The &lsquo;cmdType&rsquo; can be either 1 or 2. 1 means this data is a download module. If it is 2, this means the following data is an update, then if &lsquo;isUpdate&rsquo; is 1, it will write the data to a temporary file and execute it. It will also uninstall the current Pushdo completely, including the registry entries. The &lsquo;cmdFlags&rsquo; are defined as shown in <a href="#figure.9">Figure 9</a>. </p><div class="figure"><a id="figure.9"></a><div class="mediaobject"><img alt="cmdFlags." src="/uploads/images/figures/2013/04/pushdo-9.jpg" /></div><p class="title"><b>Figure&nbsp;9.&nbsp;cmdFlags.</b></p></div><p>If the &lsquo;Do Injection&rsquo; flag is not set, it will create a thread to load the data file into memory then call its entry point. If the &lsquo;Is not active&rsquo; flag is set, the command will not be processed. If the &lsquo;Re-extract Clicker&rsquo; flag is set, it will re extract the clicker from the current binary, including the domain lists. This is useful when the data file can access and update the current bot&rsquo;s domain list (located after the tag &lsquo;XNG7&rsquo;) and the clicker. If the &lsquo;Inject if parent terminated&rsquo; flag is set, it will create a thread to monitor the current process. If it is terminated for any reason, the thread will create and inject svchost.exe with the data file. If the &lsquo;Is GZIP-compressed&rsquo; flag is set, this means the data file is compressed. </p><p>For example, in <a href="#figure.10">Figure 10</a>, the cmdFlags = 0x1D (which is 00011101 in binary). It will decompress the data, inject it to svchost.exe, create a monitor thread to monitor the current process, and re-extract/deploy the clicker. </p><div class="figure"><a id="figure.10"></a><div class="mediaobject"><img alt="Beginning of the decrypted received commands." src="/uploads/images/figures/2013/04/pushdo-10.jpg" /></div><p class="title"><b>Figure&nbsp;10.&nbsp;Beginning of the decrypted received commands.</b></p></div></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3871070"></a>Spam engine &ndash; Cutwail</h2></div></div></div><p>Cutwail is the spam module that Pushdo usually downloads. It can either be injected into a process or spawned as a child thread of Pushdo, depending on the cmdFlags. It creates an autorun registry entry: </p><p> HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\Regedit32 = %Windows%\system32\regedit.exe </p><p>and will drop itself to that location so it can run independently. </p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id2637456"></a>Load pre-configuration</h3></div></div></div><p>All of the configuration except for the spam template is hard coded, and most of the crucial/sensitive strings are encrypted in the binary. When Cutwail first loads the settings, it calls a routine with the index of the setting as the parameter to get the decrypted string value. For example, 0xDA is the index of the C&amp;C server of this spam module, so getValue(0xDA, *p_out) outputs a pointer to string &lsquo;46.4.98.52&rsquo; top_out. This routine is also used to decrypt strings such as SMTP commands, library names and system process paths. The decryption algorithm is byte-XOR with a 0x22 bytes string: &lsquo;rwivhuo3xAKDmVJm7NVCSEkT9MpqVypKd&rsquo; for the first 0 to 0x1CF4 byes (index 0 to 0xD9) and byte-XOR with another 0x46 bytes string: &lsquo;91GzKGXXQ6kXFHrgKKJkTIuP1AQjbrxs8l0vW2xoXK 43HahzP8JCT4FzVE0cFTm4xYGsQ&rsquo; for the rest (index 0xDA to the end). The key strings vary across different variants. <a href="#figure.11">Figure 11</a> shows part of the decrypted string records. The highlighted area is the record at index 0. Each record is 0x22 bytes long for the records from index 0 to 0xD9 and 0x46 bytes long for the records from index 0xDA to the last. After decryption, the string ends with a null byte indicator, &lsquo;00&rsquo;, and the rest of the 0x22/0x46 records are junk bytes. </p><div class="figure"><a id="figure.11"></a><div class="mediaobject"><img alt="Decrypted strings." src="/uploads/images/figures/2013/04/pushdo-11.jpg" /></div><p class="title"><b>Figure&nbsp;11.&nbsp;Decrypted strings.</b></p></div><p>The pre-configuration includes addr, port, knockdelay, checksmtpdelay, maxconn, udpsockcount, constconnect, udprecvtimeout, maxudptry, and the configid is set to 1. </p><p>It spawns some threads checking connections to legitimate SMTP servers such as mxs.mail.ru and gmail-smtp-in.l.google.com, monitoring max UDP connections, checking DNS responses from root name server querying .com, .org and .de. After spawning a thread checking if there is a spam template available to spam, it connects its C&amp;C server to get commands. </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id3694892"></a>Communicates with Cutwail C&amp;C servers</h3></div></div></div><p>The C&amp;C server is hard coded in the binary. The structure of the message being sent is defined as follows, size 0x1C bytes:</p><pre class="programlisting">struct _SendData {
  DWORD  currInstallVer;
  DWORD  localIP;
  DWORD  altPort;
  DWORD  configVer;
  DWORD  emaillistID;
  DWORD  localOSVer;
  WORD   settingFlags;
  WORD   respSMTPcount;
}
</pre><p>The currInstallVer is the Cutwail version installed in the current system. It is initially zero and will be updated by the C&amp;C response with cmdType 5, then written to the registry key: </p><p> HKEY_CURRENT_USER\SOFTWARE\Microsoft\OSVersion </p><p>The localIP is the local machine&rsquo;s IP, which can be a LAN IP. The altPort is the alternated port this module uses, which is hard-coded to 0x1AC. The configVer is the configuration version. This will be updated if the response from the C&amp;C server contains configuration settings (cmdType = 7). The emaillistID is the email list ID, which will be updated if the response from the C&amp;C server contains a new email list (cmdType = 8). The localOSVer is the return value of the API call: GetVersion. The respSMTPcount is the count of active responses from the legitimate SMTP servers in the check SMTP thread. The settingFlags is defined as shown in <a href="#figure.12">Figure 12</a>; only four bits are used. </p><div class="figure"><a id="figure.12"></a><div class="mediaobject"><img alt="settingFlags." src="/uploads/images/figures/2013/04/pushdo-12.jpg" /></div><p class="title"><b>Figure&nbsp;12.&nbsp;settingFlags.</b></p></div><p>The &lsquo;Is Preset Loaded&rsquo; bit is set if the pre-configuration is loaded successfully. The &lsquo;Restart&rsquo; bit is set if the machine is restarted. The &lsquo;ReverseDNSSuc&rsquo; bit is set if the local machine&rsquo;s external IP can be reverse-DNSed to get the domain name &ndash; if not, the &lsquo;ReversedDNSFail&rsquo; bit is set. These two bits are not set if the C&amp;C server cannot obtain the local machine&rsquo;s external IP. The receiving data structure is defined as follows: </p><pre class="programlisting">struct _RecvData {
  DWORD  cmdType;
  BYTE   data[];
}
</pre><p>The responding comdTypes are always in the order: 7, 5, 8, 6 and 1. After receiving the response from the server, it will append or modify the sending message to indicate that. Missing any one of them from the server will result in the bot falling back to send the previous request.</p><div class="orderedlist"><ol type="1"><li><p>If cmdType is 7, the data contains the new configuration. <a href="#figure.13">Figure 13</a> shows an example of the response. </p><div class="figure"><a id="figure.13"></a><div class="mediaobject"><img alt="cmdType 7 contains configuration." src="/uploads/images/figures/2013/04/pushdo-13.jpg" /></div><p class="title"><b>Figure&nbsp;13.&nbsp;cmdType 7 contains configuration.</b></p></div><p>The new configuration is saved in the memory with the new &lsquo;configver&rsquo;. This configuration update can also update the C&amp;C server IP and port. Ports 25 (SMTP) and 443 (SSL) are preferred so that the communication blends into other traffic. </p></li><li><p>If the cmdType is 5, the data[] will be 0x10 bytes long. The first DWORD in data[] is the current installed version, which will update the value under the registry HKEY_CURRENT_USER\SOFTWARE\Microsoft\OSVersion. It will also update the currInstallVer field of the next message sent to the C&amp;C server. The second DWORD is the current machine&rsquo;s external IP. This is resolved from the C&amp;C server so it is not the LAN IP if the local machine is behind a router. It will run a reverse DNS look up against this IP to get the current machine&rsquo;s domain name. This affects the lowest two bits of the settingFlags of the next sending message. The domain name is then stored and may be used in spam later. The third DWORD of the data[] is a timestamp of this message; the last DWORD is always 0.</p></li><li><p>If the cmdType is 8, the data[] contains the list of email addresses which will be used by the spam bot as senders. These email addresses appear to be dummies. The first DWORD of the data[] is probably the id of this list, so that the lists can be stored and indentified in memory. It updates the emaillistID field of the next sending message. The count of the email addresses in each list is a fixed number: 5,022. Each email record starts with a 00 byte and ends with 00 00FF FFFFFF.</p></li><li><p>If the cmdType is 6, the data[] contains the vendor ID and the template. The ID is the first DWORD of the data[]. </p><div class="figure"><a id="figure.14"></a><div class="mediaobject"><img alt="Decrypted spam template." src="/uploads/images/figures/2013/04/pushdo-14.jpg" /></div><p class="title"><b>Figure&nbsp;14.&nbsp;Decrypted spam template.</b></p></div><p>(Click <a href="/uploads/images/figures/2013/04/pushdo-14-large.jpg" target="_top">here</a> to view a larger version of Figure 14.)</p><p>The example shown in <a href="#figure.14">Figure 14</a> is a template of some kind of scam (probably pyramid selling) in Russian, the email body is in the Koi8-r character set. The template variables are enclosed in brackets. For example, {Sem_tel7} is the topic and a telephone number and {799_d} is the date. The bot appends the vendor ID to the end of the next sending message to indicate that the template has been received. </p></li><li><p>If the cmdType is 1, the data[] contains the email addresses that will be used as spam receivers. The first DWORD of the data[] is the same vendor ID, followed by the size of the email address entries in bytes.</p></li></ol></div><p><a href="#figure.15">Figure 15</a> shows an example of the beginning of cmdType 1, the domain name begins with FF FFFFFF 00 000000, and the user name begins with the symbol &lsquo;|&rsquo;. These email addresses are the victim email accounts. After receiving this command, the bot appends the domains to which the spam emails have been sent, and keeps receiving more victim email addresses.</p><div class="figure"><a id="figure.15"></a><div class="mediaobject"><img alt="Receiver emails (the domain is altered to protect the victim)." src="/uploads/images/figures/2013/04/pushdo-15.jpg" /></div><p class="title"><b>Figure&nbsp;15.&nbsp;Receiver emails (the domain is altered to protect the victim).</b></p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4902258"></a>Encryption &amp; decryption algorithms</h3></div></div></div><p>Both the encryption and decryption of the sending and receiving data use the same algorithm as described by the following pseudo code. When it is sending, it uses the key string &lsquo;turyqioikleraotsorpnehcoote&rsquo; backwards and appends a DWORD 0 in front of the encrypted message to make it a total size of 0x20 bytes. When it is receiving, the first DWORD is the total message size.</p><pre class="programlisting">total = 0;
keyLength = 0x1D;
sKey[keyLength] = &ldquo;etoochenprostoarelkioiqyrut&rdquo;;//when receiving it uses &ldquo;turyqioikleraotsorpnehcoote&rdquo;
j = 0;
while (dataSize != 0)
{
if (dataSize&lt;= keyLength)
 {
  data[ total] = ~ data[total];//not operation
  total++;
  dataSize--;
 }
else
 {
  j = 0;
  k = total;
  //xor key string backwards
  for (j = 0; j &lt;keyLength; j++)
  {
   temp[j] = sKey[keyLength-1-j]^data[total];
   total ++;
  }
total = k;
  //reverse result
for (j = 1; j &lt;= keyLength; j++)
  {
   data[ total] = temp[keyLength - j];
total ++;
  }
if((k&amp;1) != 0)//total is odd
  {
total = k;
for (j = 0; j &lt;keyLength; j++)
   {
data[total] = ~ data [total];//not operation
total++;
   }
  }
dataSize -= keyLength;
 }
}
</pre></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4182008"></a>Other downloaded modules</h2></div></div></div><p>During December 2012, Pushdo downloaded only one module other than Cutwail &ndash; a DDoS module which had its own self-updating function.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4007772"></a>Conclusion</h2></div></div></div><p>The author(s) of Pushdo are not likely to stop the development of their bot. In the future, we will probably see more modules being downloaded by new versions of Pushdo.</p></div> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=Pushdo's new second generation&url=https://www.virusbulletin.com/virusbulletin/2013/04/pushdo-s-new-second-generation"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2013/04/pushdo-s-new-second-generation'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2013/04/pushdo-s-new-second-generation&title=Pushdo's new second generation"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2013/04/pushdo-s-new-second-generation&t=Pushdo's new second generation"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2013/04/pushdo-s-new-second-generation"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p> </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">©1989-2022 Virus Bulletin.        <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>        <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>        <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>