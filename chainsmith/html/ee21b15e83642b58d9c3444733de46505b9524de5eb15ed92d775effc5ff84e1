<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/css/main.css?id=b3e7fe8a6c3736dca145" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Benjamin Vanheuverzwijn',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });
</script>
<script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>

<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Win32/Sality newest component: a router’s primary DNS changer named Win32/RBrute | WeLiveSecurity</title>
<meta name="description" content="Win32/Sality newest component: a router’s primary DNS changer named Win32/RBrute"/>
<link rel="canonical" href="https://www.welivesecurity.com/2014/04/02/win32sality-newest-component-a-routers-primary-dns-changer-named-win32rbrute/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Win32/Sality newest component: a router’s primary DNS changer named Win32/RBrute | WeLiveSecurity" />
<meta property="og:description" content="Win32/Sality newest component: a router’s primary DNS changer named Win32/RBrute" />
<meta property="og:url" content="https://www.welivesecurity.com/2014/04/02/win32sality-newest-component-a-routers-primary-dns-changer-named-win32rbrute/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:tag" content="Malware" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2014-04-02T14:31:50+00:00" />
<meta property="article:modified_time" content="2014-05-20T10:13:14+00:00" />
<meta property="og:updated_time" content="2014-05-20T10:13:14+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2014/04/dns-router.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2014/04/dns-router.jpg" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="420" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="Win32/Sality newest component: a router’s primary DNS changer named Win32/RBrute" />
<meta name="twitter:title" content="Win32/Sality newest component: a router’s primary DNS changer named Win32/RBrute | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2014/04/dns-router.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">

<script>(window.BOOMR_mq=window.BOOMR_mq||[]).push(["addVar",{"rua.upush":"false","rua.cpush":"false","rua.upre":"false","rua.cpre":"false","rua.uprl":"false","rua.cprl":"false","rua.cprf":"false","rua.trans":"","rua.cook":"false","rua.ims":"false","rua.ufprl":"false","rua.cfprl":"false","rua.isuxp":"false","rua.texp":"norulematch"}]);</script>
                              <script>!function(e){var n="https://s.go-mpulse.net/boomerang/";if("False"=="True")e.BOOMR_config=e.BOOMR_config||{},e.BOOMR_config.PageParams=e.BOOMR_config.PageParams||{},e.BOOMR_config.PageParams.pci=!0,n="https://s2.go-mpulse.net/boomerang/";if(window.BOOMR_API_key="7R9SM-QGSYF-QDLJK-UETXR-SPM6B",function(){function e(){if(!o){var e=document.createElement("script");e.id="boomr-scr-as",e.src=window.BOOMR.url,e.async=!0,i.parentNode.appendChild(e),o=!0}}function t(e){o=!0;var n,t,a,r,d=document,O=window;if(window.BOOMR.snippetMethod=e?"if":"i",t=function(e,n){var t=d.createElement("script");t.id=n||"boomr-if-as",t.src=window.BOOMR.url,BOOMR_lstart=(new Date).getTime(),e=e||d.body,e.appendChild(t)},!window.addEventListener&&window.attachEvent&&navigator.userAgent.match(/MSIE [67]\./))return window.BOOMR.snippetMethod="s",void t(i.parentNode,"boomr-async");a=document.createElement("IFRAME"),a.src="about:blank",a.title="",a.role="presentation",a.loading="eager",r=(a.frameElement||a).style,r.width=0,r.height=0,r.border=0,r.display="none",i.parentNode.appendChild(a);try{O=a.contentWindow,d=O.document.open()}catch(_){n=document.domain,a.src="javascript:var d=document.open();d.domain='"+n+"';void(0);",O=a.contentWindow,d=O.document.open()}if(n)d._boomrl=function(){this.domain=n,t()},d.write("<bo"+"dy onload='document._boomrl();'>");else if(O._boomrl=function(){t()},O.addEventListener)O.addEventListener("load",O._boomrl,!1);else if(O.attachEvent)O.attachEvent("onload",O._boomrl);d.close()}function a(e){window.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(!window.BOOMR||!window.BOOMR.version&&!window.BOOMR.snippetExecuted){window.BOOMR=window.BOOMR||{},window.BOOMR.snippetStart=(new Date).getTime(),window.BOOMR.snippetExecuted=!0,window.BOOMR.snippetVersion=12,window.BOOMR.url=n+"7R9SM-QGSYF-QDLJK-UETXR-SPM6B";var i=document.currentScript||document.getElementsByTagName("script")[0],o=!1,r=document.createElement("link");if(r.relList&&"function"==typeof r.relList.supports&&r.relList.supports("preload")&&"as"in r)window.BOOMR.snippetMethod="p",r.href=window.BOOMR.url,r.rel="preload",r.as="script",r.addEventListener("load",e),r.addEventListener("error",function(){t(!0)}),setTimeout(function(){if(!o)t(!0)},3e3),BOOMR_lstart=(new Date).getTime(),i.parentNode.appendChild(r);else t(!1);if(window.addEventListener)window.addEventListener("load",a,!1);else if(window.attachEvent)window.attachEvent("onload",a)}}(),"".length>0)if(e&&"performance"in e&&e.performance&&"function"==typeof e.performance.setResourceTimingBufferSize)e.performance.setResourceTimingBufferSize();!function(){if(BOOMR=e.BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},!BOOMR.plugins.AK){var n=""=="true"?1:0,t="",a="eaaqm7bfmqcrqkqce3yp4aaaabrouma5-f-c8962c258-clienttons-s.akamaihd.net",i="false"=="true"?2:1,o={"ak.v":"32","ak.cp":"1251022","ak.ai":parseInt("757730",10),"ak.ol":"0","ak.cr":18,"ak.ipv":6,"ak.proto":"http/1.1","ak.rid":"7c16cb0","ak.r":44866,"ak.a2":n,"ak.m":"","ak.n":"ff","ak.bpcip":"2001:67c:2564:518::","ak.cport":57246,"ak.gh":"92.122.101.52","ak.quicv":"","ak.tlsv":"tls1.3","ak.0rtt":"","ak.csrc":"-","ak.acc":"reno","ak.t":"1659514909","ak.ak":"hOBiQwZUYzCg5VSAfCLimQ==IuyI67QJZ+1RALbzjhPer6QtVLi0X+a/StiHpGM/vyr8fbIOvIsY99NPh4t9aMcydJwVtoeVKdCY44m4Cvjz1SlB6vq+qlKFOJvmdenTc9Ut9clpeDpjnUxkJFJow01iFTswTAsIhQF3VbX2muS4cFxA56WbEBu5Ore2ujy2Y1kzQwAXLa7Sk02QtdNqu+ghxJdPKXdUMsaWEFVAE0aVXN8jan7mGHA2nvMmYsfpCb5UGUaydtN4JJqo3sonNuFE7+RLM511erdAlzOv5o7/x10W5vTiuUn3eduSnXPrFJzw8u/Z/8roiMV18jw0zQbGOz3kgy9QmyTRXGYH0Q0Y2hFh6m31GU33CogA9IUHeJptJ0Newwv/Suc2OZifgUKl2RGjiiR+V84HmZdDJ5akEZkTQPsEUP6oDzG8ttPMYZo=","ak.pv":"11","ak.dpoabenc":"","ak.tf":i};if(""!==t)o["ak.ruds"]=t;var r={i:!1,av:function(n){var t="http.initiator";if(n&&(!n[t]||"spa_hard"===n[t]))o["ak.feo"]=void 0!==e.aFeoApplied?1:0,BOOMR.addVar(o)},rv:function(){var e=["ak.bpcip","ak.cport","ak.cr","ak.csrc","ak.gh","ak.ipv","ak.m","ak.n","ak.ol","ak.proto","ak.quicv","ak.tlsv","ak.0rtt","ak.r","ak.acc","ak.t","ak.tf"];BOOMR.removeVar(e)}};BOOMR.plugins.AK={akVars:o,akDNSPreFetchDomain:a,init:function(){if(!r.i){var e=BOOMR.subscribe;e("before_beacon",r.av,null,null),e("onbeacon",r.rv,null,null),r.i=!0}return this},is_complete:function(){return!0}}}}()}(window);</script></head>
<body class="no-js single noimage">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>

<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://welivesecurity.com/category/ukraine-crisis-digital-security-resource-center/">
                                            Ukraine Crisis – Digital Security Resource Center                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/we-live-progress/">
                                            We Live Progress                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong>					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-noimage">
	<div class="container promo-text">
		<div class="inner clearfix">
			<div class="col-md-11 col-sm-11 col-xs-12 no-padding">
				<h1>Win32/Sality newest component: a router’s primary DNS changer named Win32/RBrute</h1>
<div class="excerpt">DNS hijacking is still going strong and the Win32/Sality operators have added this technique to their long-lasting botnet. This blog post describes how the malware guesses router passwords as part of its campaign to misdirect users, send spam and infect new victims.</div>
<div class="post-meta">
    <div class="wls-authors">
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2014-04-02 14:31:50">2 Apr 2014 - 02:31PM</time>
		</span>
			</span>
</div>
			</div>
		</div>
	</div>
</div>	

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2014%2F04%2F02%2Fwin32sality-newest-component-a-routers-primary-dns-changer-named-win32rbrute%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2014%2F04%2F02%2Fwin32sality-newest-component-a-routers-primary-dns-changer-named-win32rbrute%2F&text=Win32/Sality newest component: a router’s primary DNS changer named Win32/RBrute%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2014%2F04%2F02%2Fwin32sality-newest-component-a-routers-primary-dns-changer-named-win32rbrute%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt noimage">
                                <p>DNS hijacking is still going strong and the Win32/Sality operators have added this technique to their long-lasting botnet. This blog post describes how the malware guesses router passwords as part of its campaign to misdirect users, send spam and infect new victims.</p>
                            </div>

                            <p id="docs-internal-guid-ad0c6d16-1db6-5a65-e37e-4ab5d76a7384" dir="ltr"><a href="http://www.virusradar.com/en/Win32_Sality/detail">Win32/Sality</a> is a family of malware that has been using a peer-to-peer <a href="http://www.virusradar.com/en/glossary/botnet">botnet</a> since at least 2003. It is a file infector and a trojan downloader, the latter of which is mainly used to send spam, although it has been used for different purposes such as faking advertising network traffic, distributed denial of service or VoIP account cracking. All commands and files exchanged through Sality&#8217;s P2P network are digitally signed, making it resilient to protocol manipulation. Its modular architecture as well as the longevity of the botnet shows good programming practice and an efficient software design.</p>
<p dir="ltr">We’ve been tracking Win32/Sality network for quite some time now and  seen more than 115 000 IP addresses reachable from the Internet using so-called “super peers,” which keep the botnet alive and propagate commands to regular peers.</p>
<p dir="ltr">We have seen the same components downloaded over the years with little change to their underlying behavior. Lately, a new component has now appeared with some novel characteristics:  the ability to change a residential broadband gateway router&#8217;s primary DNS address, which is different from the usual FTP password stealer or spambot deployed by Win32/Sality. According to our telemetry data, this component was dropped for the first time at the end of October 2013. It was first publicly discussed by Dr. Web, who has published a technical analysis of one component, the <a href="http://vms.drweb.com/virus/?i=3766637">IP address scanner</a>. They named it Win32/RBrute.</p>
<p dir="ltr">This blog will contain</p>
<ul>
<li>An overview of the infrastructure supporting the primary DNS changer component</li>
<li>A technical analysis of the two binaries that support the operation</li>
<li>A brief analysis of the spread of the operation</li>
<li>A review of the similarities between the DNS changer component and the other components dropped by Win32/Sality</li>
</ul>
<h2 dir="ltr">A new purpose: changing a router&#8217;s primary DNS</h2>
<p dir="ltr">This feature adds a new dimension to the Win32/Sality operation. The first component, detected by ESET as Win32/RBrute.A, scans the Internet for router administration pages in order to change the entry for their primary DNS server. The rogue DNS server redirects users to a fake Google Chrome installation page whenever they are trying to resolve domains containing the words “google” or “facebook”. The binary distributed through this installation page is in fact Win32/Sality itself, providing a way for the Sality botnet&#8217;s operators to increase its size further by infecting other users behind this router.</p>
<p dir="ltr">The IP address used as the primary DNS on a compromised router is part of the Win32/Sality network. In fact, another malware, detected by ESET as Win32/RBrute.B, is installed by Win32/Sality on compromised computers and can act either as a DNS or a HTTP proxy server to deliver the fake Google Chrome installer.</p>
<div style="width: 620px; height: 50px; padding: 5px; background-color: #ceecf5; color: black; border: 2px solid #BDBDBD; line-height: 20px;">
<p style="font-size: 14px; font-weight: normal; color: black; margin: 15px; padding: 0; line-height: 20px;"><strong>How can I protect my router from DNS poisoning?</strong> <a title="ESET Knowledgebase" href="http://kb.eset.sk/esetkb/index?page=content&amp;id=SOLN3530" target="_blank">Learn handy tips and tricks &gt;&gt;</a></p>
</div>
<h2 dir="ltr">The Operation</h2>
<p dir="ltr">Far from being a new technique these days , changing the primary DNS  on a router is quite in vogue  right now for everything from the <a href="http://www.cert.pl/news/8019/langswitch_lang/en">theft of bank credentials</a> to <a href="https://www.csis.dk/en/csis/blog/4159">blocking communications with security vendors</a>, especially with <a href="/2013/10/14/some-d-link-routers-contain-backdoor-which-allows-remote-access-researcher-warns/">recent</a> <a href="/2013/10/23/rotten-routers-more-brands-found-to-contain-hidden-backdoors/">reports</a> of <a href="/2013/11/12/more-d-link-routers-are-vulnerable-to-attacks-researcher-claims/">vulnerabilities</a> in <a href="/2014/01/03/linksys-and-netgear-router-models-at-risk-from-backdoor-that-offers-access-to-controls/">different</a> <a href="/2014/02/24/most-small-office-routers-have-critical-vulnerabilities-as-mysterious-moon-worm-spreads/">router</a>’s <a href="/2014/03/04/more-than-300000-wireless-routers-hijacked-by-criminals-in-global-attack/">firmware</a>.</p>
<p dir="ltr">Win32/RBrute.A tries to find the administration web pages for routers by downloading a list of IP addresses from its<a href="http://www.virusradar.com/en/glossary/command-and-control-server"> C&amp;C</a> server to scan and then reporting back its findings. At the time of our investigation, Win32/RBrute.A targeted the following routers:</p>
<ul>
<li>Cisco routers matching “level_15_” in the HTTP realm attribute</li>
<li>D-Link DSL-2520U</li>
<li>D-Link DSL-2542B</li>
<li>D-Link DSL-2600U</li>
<li>Huawei EchoLife</li>
<li>TP-LINK</li>
<li>TP-Link TD-8816</li>
<li>TP-Link TD-8817</li>
<li>TP-Link TD-8817 2.0</li>
<li>TP-Link TD-8840T</li>
<li>TP-Link TD-8840T 2.0</li>
<li>TP-Link TD-W8101G</li>
<li>TP-Link TD-W8151N</li>
<li>TP-Link TD-W8901G</li>
<li>TP-Link TD-W8901G 3.0</li>
<li>TP-Link TD-W8901GB</li>
<li>TP-Link TD-W8951ND</li>
<li>TP-Link TD-W8961ND</li>
<li>TP-Link TD-W8961ND</li>
<li>ZTE ZXDSL 831CII</li>
<li>ZTE ZXV10 W300</li>
</ul>
<p dir="ltr">If a web page is found, the C&amp;C sends a short list of about ten passwords to the bot and instructs it to perform a brute force password guess attack against the router. If the bot is able to log in to the router, it will then proceed to change the router’s primary DNS server settings. It is interesting to note that only brute force attack is used to gain access to the router’s administration portal; no exploit code is used. The authentication is done with usernames of “<em>admin</em>” and “<em>support</em>”, although previous versions also tried “<em>root</em>” and “<em>Administrator</em>”. Below is a list of passwords we have observed being transmitted from the C&amp;C:</p>
<ul>
<li><em>&lt;empty string&gt;</em></li>
<li><em>111111</em></li>
<li><em>12345</em></li>
<li><em>123456</em></li>
<li><em>12345678</em></li>
<li><em>abc123</em></li>
<li><em>admin</em></li>
<li><em>Administrator</em></li>
<li><em>consumer</em></li>
<li><em>dragon</em></li>
<li><em>gizmodo</em></li>
<li><em>iqrquksm</em></li>
<li><em>letmein</em></li>
<li><em>lifehack</em></li>
<li><em>monkey</em></li>
<li><em>password</em></li>
<li><em>qwerty</em></li>
<li><em>root</em></li>
<li><em>soporteETB2006</em></li>
<li><em>support</em></li>
<li><em>tadpassword</em></li>
<li><em>trustno1</em></li>
<li><em>we0Qilhxtx4yLGZPhokY</em></li>
</ul>
<p dir="ltr">In the event of a successful login, the malware changes the primary DNS server to a rogue one, reports a successful infection to the C&amp;C, and continues with scanning the Internet.</p>
<p dir="ltr">Once a router&#8217;s primary DNS address is compromised, all DNS queries made by users will go through the rogue DNS server, modifying them to point to the fake Chrome installer page whenever &#8220;facebook&#8221; or &#8220;google&#8221; domains are resolved.</p>
<div id="attachment_41905" style="width: 637px" class="wp-caption aligncenter"><img class="wp-image-41905 " src="/wp-content/uploads/2014/04/google_doesntexist.png" alt="google_doesntexist" width="627" height="368" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/04/google_doesntexist.png 784w, https://www.welivesecurity.com/wp-content/uploads/2014/04/google_doesntexist-300x176.png 300w" sizes="(max-width: 627px) 100vw, 627px" /><p class="wp-caption-text">This example shows a successful redirection for a domain that is not registered but contains the word “google”.</p></div>
<p id="docs-internal-guid-ad0c6d16-1db7-6a9e-9203-f371d479be66" dir="ltr">This operation is somewhat similar to <a href="/category/dnschanger-2/">DNSChanger</a>, which drove users to install fake software to further spread malware using a rogue DNS service.</p>
<p dir="ltr">Once a computer is infected by running the fake Google Chrome installer, its primary DNS server will be changed to “8.8.8.8” by updating the following registry key:</p>
<p><em>HKLM/SYSTEM/ControlSet001/Services/Tcpip/Parameters/Interfaces/{network interface UUID}/NameServer = “8.8.8.8”</em></p>
<p dir="ltr">It should be noted that the IP address &#8220;8.8.8.8&#8221; belongs to <a href="https://developers.google.com/speed/public-dns/docs/using">Google Public DNS</a>, a legitimate domain name service operated by Google, and it is not involved with Win32/RBrute.</p>
<p dir="ltr">Since infected PCs will no longer be using the router’s DNS server, they will no longer be affected by its bogus redirections. On the other hand, the router is still compromised and will nag each computer trying to resolve &#8220;facebook&#8221; or &#8220;google&#8221; domains through its DNS service until they are infected with Win32/Sality. This tactic is far from stealthy and in fact tries to annoy the user into infecting its system or simply breaking “google” and “facebook” domains for operating systems that are not targeted (e.g. Linux).</p>
<p dir="ltr">Currently, the goal of this operation appears to be solely to increase Sality’s botnet size.</p>
<h2 dir="ltr">Technical Analysis</h2>
<p dir="ltr">Win32/Sality’s DNS changer component is composed of two binaries: a router scanner and a DNS / HTTP server. Both malware are dropped by Win32/Sality.</p>
<h3 dir="ltr">Router Scanner Binary &#8211; Win32/RBrute.A</h3>
<p dir="ltr">At the beginning of the execution, the malware creates a mutex with the name “<em>19867861872901047sdf</em>” to avoid running multiple instances.</p>
<p dir="ltr">It then checks a hard-coded IP address every minute to fetch a command; that command is either a scan instruction or a request to try to log onto an IP address to change the primary DNS.</p>
<p dir="ltr">A scan instruction comes with an IP address to start and the number of addresses to try. Win32/RBrute.A will try to do a <strong>HTTP GET</strong> on <strong>TCP/80</strong>, hoping to receive a HTTP Error 401 &#8211; Unauthorized. The router model is extracted from the realm attribute of the <a href="http://tools.ietf.org/html/rfc2617">HTTP authentication schemes</a>. If a targeted router is found, the malware sends back its IP address to the C&amp;C.</p>
<div id="attachment_41914" style="width: 362px" class="wp-caption aligncenter"><img class="size-full wp-image-41914 " src="/wp-content/uploads/2014/04/win32.rbrutea_flowchart.png" alt="Win32/RBrute.A flowchart" width="352" height="624" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/04/win32.rbrutea_flowchart.png 352w, https://www.welivesecurity.com/wp-content/uploads/2014/04/win32.rbrutea_flowchart-169x300.png 169w" sizes="(max-width: 352px) 100vw, 352px" /><p class="wp-caption-text">Win32/RBrute.A flowchart</p></div>
<p>The C&amp;C will then issue a request to login to the router using a password provided by the C&amp;C. If the login is successful, the primary DNS server is changed in the router to a host running the Win32/RBrute.B malware.</p>
<h3 dir="ltr">DNS and HTTP Server Binary &#8211; Win32/RBrute.B</h3>
<p dir="ltr">This component is divided in three parts: the control thread, the DNS server thread, and the HTTP server thread.</p>
<p dir="ltr">Although both the DNS and the HTTP server thread can be used at the same time, the malware will choose, based on a random value, to be either a DNS or a HTTP server. A constant in the formula ensures that 80% of the infections will act as DNS servers, although we’ve seen this constant set to 50% at the beginning of the operation.</p>
<div id="attachment_41909" style="width: 527px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2014/04/random.png"><img class="size-full wp-image-41909 " src="/wp-content/uploads/2014/04/random.png" alt="Choosing the DNS or HTTP server thread randomly." width="517" height="303" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/04/random.png 517w, https://www.welivesecurity.com/wp-content/uploads/2014/04/random-300x175.png 300w" sizes="(max-width: 517px) 100vw, 517px" /></a><p class="wp-caption-text">Choosing the DNS or HTTP server thread randomly.</p></div>
<p class="size-full wp-image-41913">If the chosen server thread would not start, the malware will fall back to the other mode:</p>
<div id="attachment_41913" style="width: 464px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2014/04/thread_started.png"><img class="size-full wp-image-41913 " src="/wp-content/uploads/2014/04/thread_started.png" alt="Fallback to the other mode if the choosen thread could not start." width="454" height="182" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/04/thread_started.png 454w, https://www.welivesecurity.com/wp-content/uploads/2014/04/thread_started-300x120.png 300w, https://www.welivesecurity.com/wp-content/uploads/2014/04/thread_started-340x137.png 340w" sizes="(max-width: 454px) 100vw, 454px" /></a><p class="wp-caption-text">Fallback to the other mode if the choosen thread could not start.</p></div>
<p id="docs-internal-guid-d408a8ad-1dc3-93bd-62b6-a30112e6cb9c" dir="ltr">The operator can also force a thread to start by sending a specially crafted DNS or HTTP request. A mutex with the name &#8220;<em>SKK29MXAD</em>&#8221; ensures that only one instance can run on the host.</p>
<h4 dir="ltr">Control Thread</h4>
<p dir="ltr">The control thread is used to report back to the C&amp;C and to reconfigure the server instance.</p>
<p dir="ltr">Every two minutes, the malware will send a packet to a hard-coded IP address containing information about the machine on which it is running. The C&amp;C will then answer with an IP address that will be used to deliver the infected Chrome installation. If the malware is in DNS mode, the IP address served by the C&amp;C will be that of a rogue HTTP server installed on a Sality-compromised machine. In the other case, the C&amp;C will send the IP address of a server outside of Sality’s P2P network, which will be serving the fake Chrome installation page.</p>
<p dir="ltr">Listed below is the host information sent by the control thread to the C&amp;C:</p>
<ul>
<li>Computer name &#8211; <em>GetComputerName()</em></li>
<li>Local time &#8211; <em>GetLocalTime()</em></li>
<li>Country &#8211; <em>GetLocaleInfoA()</em></li>
<li>Windows directory &#8211; <em>GetWindowsDirectoryA()</em></li>
<li>Windows product name &#8211; from the registry key &#8220;<em>HKEY_LOCAL_MACHINE/SOFTWARE/Microsoft/Windows NT/CurrentVersion/Product Name</em>&#8220;</li>
<li>CPU names &#8211; from the registry keys<br />
&#8220;<em>HKEY_LOCAL_MACHINE/HARDWARE/DESCRIPTION/System/CentralProcessor/&lt;CPU #&gt;/ProcessorNameString</em>&#8220;</li>
<li>Memory stats &#8211; <em>GetMemoryStatusEx()</em></li>
<li>Result of <em>IsDebuggerPresent()</em></li>
<li>Memory usage of the malware &#8211; <em>GetProcessMemoryInfo()</em></li>
<li>Uptime of the malware &#8211; in minutes</li>
<li>Number of threads n use</li>
</ul>
<p dir="ltr">The information packet has the format:</p>
<p dir="ltr"><a href="/wp-content/uploads/2014/04/table2222.jpg"><img class="aligncenter size-full wp-image-41998" src="/wp-content/uploads/2014/04/table2222.jpg" alt="table2222" width="480" height="115" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/04/table2222.jpg 480w, https://www.welivesecurity.com/wp-content/uploads/2014/04/table2222-300x71.jpg 300w" sizes="(max-width: 480px) 100vw, 480px" /></a></p>
<p dir="ltr">The screenshot below shows an information packet sent to the C&amp;C.</p>
<div id="attachment_41904" style="width: 621px" class="wp-caption aligncenter"><img class="size-full wp-image-41904 " src="/wp-content/uploads/2014/04/example_packet.png" alt="Host information packet sent to the C&amp;C. In blue: payload checksum, in red: payload length, in black: encrypted server mode, in green: encrypted host information" width="611" height="152" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/04/example_packet.png 611w, https://www.welivesecurity.com/wp-content/uploads/2014/04/example_packet-300x74.png 300w" sizes="(max-width: 611px) 100vw, 611px" /><p class="wp-caption-text">Host information packet sent to the C&amp;C.<br />In blue: payload checksum, in red: payload length, in black: encrypted server mode, in green: encrypted host information</p></div>
<p>The host information, green in the previous example, is the following string encrypted with RC4:</p>
<p><strong>9BC13555|24.03.2014 21:56:27|United States|C:\WINDOWS|Microsoft Windows XP|proc#0 QEMU Virtual CPU version 1.0|1|358|511|1117|1246|0|2|0|0|</strong></p>
<p dir="ltr">The C&amp;C will then answer with a packet with the service IP address to use:</p>
<p style="text-align: center;"><a href="/wp-content/uploads/2014/04/chadnelley.jpg"><img class="aligncenter  wp-image-41946" src="/wp-content/uploads/2014/04/chadnelley.jpg" alt="rogue" width="620" height="150" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/04/chadnelley.jpg 775w, https://www.welivesecurity.com/wp-content/uploads/2014/04/chadnelley-300x72.jpg 300w" sizes="(max-width: 620px) 100vw, 620px" /></a></p>
<h4 id="docs-internal-guid-d408a8ad-1dc6-2371-2bb0-2b89100b48b3" dir="ltr">DNS Server Thread</h4>
<p dir="ltr">The DNS server looks for requests that contain “google” or “facebook” in the domain name. If it finds one, the DNS response it will send back will contain the IP address of a Win32/RBrute.B HTTP server on the Sality network. If the query doesn&#8217;t contain “facebook” or “google”, it will relay the query to Google’s DNS servers (“8.8.8.8” or “8.8.4.4”) and will forward the response to the client.</p>
<p dir="ltr">Sending a packet to the server on <strong>UDP/53</strong> with “0xCAFEBABE” as the payload will set the “<em>udme</em>” flag in the Windows registry key &#8220;<em>HKEY_CURRENT_USER/SOFTWARE/Fihd4</em>&#8220;. This flag ensure that the DNS server thread will start at the next reboot, overriding the random process. The server will reply “0xDEADCODE” to confirm the command.</p>
<h4 dir="ltr">HTTP Server Thread</h4>
<p dir="ltr">When receiving a browser request by a user that has been redirected, the HTTP server thread will first look at the browser User-Agent and will have a different behavior consequently.</p>
<p dir="ltr">If the User-Agent contains “linux” or “playstation”, the server will silently drop the connection (how rude!). If the User-Agent makes reference to a mobile (matching one of the following words: “android”, “tablet”, “Windows CE”, “blackberry” or “opera mini”), the server will serve Win32/Sality (!) malware 5% of the time even though these are mobile devices User-Agent; otherwise, the request is dropped.  Finally, if the User-Agent contains “opera”, “firefox”, “chrome”, “msie” or anything else, the user will be served the Win32/Sality.</p>
<p dir="ltr">The User-Agent will affect the port on which the query is made on the rogue HTTP server distributing the malware.</p>
<p><a href="/wp-content/uploads/2014/04/horse.jpg"><img class="aligncenter" src="/wp-content/uploads/2014/04/horse.jpg" alt="horse" width="655" height="165" /></a></p>
<p id="docs-internal-guid-d408a8ad-1dc6-ca7f-ff73-7e40061b3904" dir="ltr">Any <strong>HTTP GET</strong> request sent to these ports will serve the fake Chrome installation page… even if you’re browsing with Chrome!</p>
<p dir="ltr">Akin to the DNS server thread, the botmaster can affect the HTTP server behavior by sending a specially- crafted HTTP packet. Specifically, sending a GET or POST request with the User-Agent “<em>BlackBerry9000/5.0.0.93 Profile/MIDP-2.0 Configuration/CLDC-2.1 VendorID/831</em>” will set the “<em>htme</em>” flag in the  registry key &#8220;<em>HKEY_CURRENT_USER/SOFTWARE/Fihd4</em>&#8220;, effectively ensuring that malware will start the HTTP server thread upon reboot, overriding the random process. The server will send “<em>&lt;html&gt;kenji oke&lt;/html&gt;</em>” to confirm a successful execution.</p>
<p dir="ltr">The HTTP server also keeps a list of allowed files to be served. If a browser makes a HTTP query on a domain matching “google” or “facebook” to a file not in the list, the server will reply with a HTTP 200 OK, with the following payload:</p>
<p dir="ltr"><em>&lt;html&gt;&lt;meta http-equiv=&#8221;refresh&#8221; content=&#8221;0; url=/&#8221;&gt;&lt;/html&gt;</em></p>
<p dir="ltr">redirecting the browser to the front page &#8212; hence serving the fake Chrome installation page. For example, if the user browses to “<em>http://google.com/does-not-exist</em>” and “<em>does-not-exist</em>” is not in the allowed files list, the user will be redirected to “http://google.com” instead of having the usual HTTP 404 error.</p>
<p dir="ltr">We should also note that every <strong>HTTP GET</strong> query made on the HTTP server that contains the string “.exe” will be forwarded to the rogue HTTP server, regardless of the allowed files list. The rogue server will always answer with an infected binary.</p>
<h2 dir="ltr">Similarities with other Sality components</h2>
<p dir="ltr">Based on the following observations, we believe that the main file infector as well as all the components previously described are all developed by the same group of people. By looking at each of the components binaries, they all share the same technical details and coding style.</p>
<h3 dir="ltr">No persistence needed</h3>
<p dir="ltr">None of the dropped Sality components, including those discussed before, needs a way to be persistent across system reboot, although some modules might store configuration in the registry. They are always downloaded and launched by the persistent layer: the file infector.</p>
<h3 dir="ltr">Buffer Initialization</h3>
<p dir="ltr">The operators have the standard practice of initializing their buffers with the ‘0’ value. The compiler “visual-c++” doesn’t optimize the following C code when the operators compile a software:</p>
<p dir="ltr">char buf[4096] = {0};</p>
<p dir="ltr">This is compiled into the code displayed in the following screenshots.</p>
<div id="attachment_41906" style="width: 217px" class="wp-caption aligncenter"><img class="size-full wp-image-41906 " src="/wp-content/uploads/2014/04/initialize_buffer.png" alt="Un-optimized initialization of a buffer of size 4096 bytes. " width="207" height="105" /><p class="wp-caption-text">Un-optimized initialization of a buffer of size 4096 bytes.</p></div>
<p id="docs-internal-guid-d408a8ad-1dc7-73e0-87c9-4db512311fb2" dir="ltr">This assembly stub is seen in every component dropped by Win32/Sality.</p>
<h3 dir="ltr">Bypassing the Firewall</h3>
<p dir="ltr">All components that need to receive connections from the Internet share the same code to add a specific rule in the Windows Firewall authorizing incoming requests to go through. It will add the value &#8220;<em>[malware file name]:*:Enabled:ipsec</em>&#8221; to the following registry key “<em>HKEY_LOCAL_MACHINE/SYSTEM/CurrentControlSet/Services/SharedAccess/Parameters/FirewallPolicy/StandardProfile/AuthorizedApplications/List</em>&#8221; to achieve this goal. The following screenshot shows a subset of the “<em>add_to_firewall_exception()</em>” function.</p>
<div id="attachment_41902" style="width: 1141px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2014/04/add_to_firewall_exception.png"><img class="size-full wp-image-41902  " src="/wp-content/uploads/2014/04/add_to_firewall_exception.png" alt="A subset of &quot;add_to_firewall_exception()&quot; function, shared by almost all components of Win32/Sality." width="1131" height="226" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/04/add_to_firewall_exception.png 1131w, https://www.welivesecurity.com/wp-content/uploads/2014/04/add_to_firewall_exception-300x59.png 300w, https://www.welivesecurity.com/wp-content/uploads/2014/04/add_to_firewall_exception-1024x204.png 1024w" sizes="(max-width: 1131px) 100vw, 1131px" /></a><p class="wp-caption-text">A subset of &#8220;add_to_firewall_exception()&#8221; function, shared by almost all components of Win32/Sality.</p></div>
<p dir="ltr">In Win32/RBrute.B, this function is called at the beginning of the malware execution:</p>
<div id="attachment_41903" style="width: 482px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2014/04/dns_http_server_firewall_exception.png"><img class="size-full wp-image-41903   " src="/wp-content/uploads/2014/04/dns_http_server_firewall_exception.png" alt="Calling add_to_firewall_exception() before creating the mutex in the WinMain() function of Win32/RBrute.B." width="472" height="348" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/04/dns_http_server_firewall_exception.png 472w, https://www.welivesecurity.com/wp-content/uploads/2014/04/dns_http_server_firewall_exception-300x221.png 300w" sizes="(max-width: 472px) 100vw, 472px" /></a><p class="wp-caption-text">Calling add_to_firewall_exception() before creating the mutex in the WinMain() function of Win32/RBrute.B.</p></div>
<p>Same thing found in the Win32/Sality’s spambot component:</p>
<div id="attachment_41912" style="width: 415px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2014/04/spammer_firewall_exception.png"><img class="size-full wp-image-41912  " src="/wp-content/uploads/2014/04/spammer_firewall_exception.png" alt="Win32/Sality's spambot component calling the add_to_firewall_exception() function." width="405" height="198" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/04/spammer_firewall_exception.png 405w, https://www.welivesecurity.com/wp-content/uploads/2014/04/spammer_firewall_exception-300x146.png 300w" sizes="(max-width: 405px) 100vw, 405px" /></a><p class="wp-caption-text">Win32/Sality&#8217;s spambot component calling the add_to_firewall_exception() function.</p></div>
<h2 id="docs-internal-guid-d408a8ad-1dc8-d69d-17f3-8f351a4128d8" dir="ltr">Infection Statistics</h2>
<p dir="ltr">Our data show that the detection for Win32/Sality is currently decreasing or at least staying stable since 2012. We believe that the reduced number of detections is due to the reduced efficiency of the current infection vectors. This might explain why the operators are looking for new ways to spread Win32/Sality.</p>
<div id="attachment_41911" style="width: 652px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2014/04/sality_overall.png"><img class="wp-image-41911 " src="/wp-content/uploads/2014/04/sality_overall.png" alt="Win32/Sality detection worldwide" width="642" height="354" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/04/sality_overall.png 803w, https://www.welivesecurity.com/wp-content/uploads/2014/04/sality_overall-300x165.png 300w, https://www.welivesecurity.com/wp-content/uploads/2014/04/sality_overall-143x79.png 143w, https://www.welivesecurity.com/wp-content/uploads/2014/04/sality_overall-298x165.png 298w" sizes="(max-width: 642px) 100vw, 642px" /></a><p class="wp-caption-text">Win32/Sality detection worldwide</p></div>
<p dir="ltr">If we take a look at the detections for the last year, we can see a small increase, around December 2013, in Win32/Sality detections that coincides with the date where the DNS changer component was released in the wild, although those numbers should be taken with a grain of salt since other factors could contribute to variation in its spreading, like being dropped by another botnet.</p>
<div id="attachment_41910" style="width: 649px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2014/04/sality_last_year.png"><img class="wp-image-41910 " src="/wp-content/uploads/2014/04/sality_last_year.png" alt="Win32/Sality detections last year" width="639" height="351" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/04/sality_last_year.png 799w, https://www.welivesecurity.com/wp-content/uploads/2014/04/sality_last_year-300x164.png 300w, https://www.welivesecurity.com/wp-content/uploads/2014/04/sality_last_year-143x79.png 143w, https://www.welivesecurity.com/wp-content/uploads/2014/04/sality_last_year-298x165.png 298w" sizes="(max-width: 639px) 100vw, 639px" /></a><p class="wp-caption-text">Win32/Sality detections last year</p></div>
<p id="docs-internal-guid-d408a8ad-1dca-6ad1-2c72-76564a818ec0" dir="ltr">We’re not sure about the effectiveness of the Win32/Sality router DNS changer operation, since a lot of router configuration portals listen only on the private address space (e.g., 192.168.0.0/16) &#8212; making them non-accessible from the Internet. Also, the router password brute force is not very aggressive, only trying a list of about ten passwords.</p>
<h2 dir="ltr">Conclusion</h2>
<p dir="ltr">The usual infection vectors of Win32/Sality might not be sufficient enough to keep the botnet alive; hence the botnet controllers are deploying new component to grow the botnet. DNS hijacking on routers can be quite effective if done correctly. It can reach a lot of users behind a single router, especially on public access points. As routers are not commonly protected by security solutions, it provides an unrestricted environment to attackers allowing them to try several techniques to steal users’ information. An existing technology that could fix the problem is DNSSEC, since the result of a DNS request is cryptographically signed and hence not prone to tampering.  A good security practice that would reduce the scope of the problem is to change the default password on router’s web interface.</p>
<h2 dir="ltr">File Analyzed</h2>
<p dir="ltr">The following are the SHA-1 hashes of files observed during our monitoring of Win32/RBrute malware.</p>
<h3 dir="ltr">Win32/RBrute.A</h3>
<p dir="ltr"><em>8f4e43675948e806d99125e916191e04f8840b46</em><br />
<em> f8031d843626ac198a6f3c056f57098012e178e2</em><br />
<em> 21649df3044f2203403a855108c1db1d95a2ab46</em></p>
<h3 dir="ltr">Win32/RBrute.B</h3>
<p dir="ltr"><em>5d1263c1c707ce163c9b36452dcb7340a7fd8909</em><br />
<em> 73e2fe07a3f875521b5bfe8c3dd8fd6b6819c8f8</em></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                                            </div>
                                    <span class="strong">
								        <time datetime="2014-04-02 14:31:50">2 Apr 2014 - 02:31PM</time>
                                    </span>
                                </div>
                            
                                <div class="widgets row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                <h3><span class="text"><em>Sign up to receive an email update whenever a new article is published in our <a href="https://www.welivesecurity.com/category/ukraine-crisis-digital-security-resource-center/" target="_blank" rel="noopener">Ukraine Crisis – Digital Security Resource Center</a></em></span></h3>
            </div>
        </div>
        <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
            <form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
                <div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="TOPIC" value="We Live Security Ukraine Newsletter">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button class="button-flag">
                        Submit                    </button>
                </div>
            </form>
        </div>
    </div>
                                <div class="widgets row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                <h3><span class="text">Newsletter</span></h3>
            </div>
        </div>
        <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
            <form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
                <div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="NEWSLETTER" value="We Live Security">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button class="">
                        Submit                    </button>
                </div>
            </form>
        </div>
    </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2022/06/16/how-emotet-is-changing-tactics-microsoft-tightening-office-macro-security/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2022/06/emotet-malware-botnet-macros-mark-web-623x415.jpg"
                                                         alt="Win32/Sality newest component: a router’s primary DNS changer named Win32/RBrute">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2022/06/16/how-emotet-is-changing-tactics-microsoft-tightening-office-macro-security/">
                                                    How Emotet is changing tactics in response to Microsoft’s tightening of Office macro security                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/eset-research/" class="category-tag-btn">ESET Research</a>                                                <a href="https://www.welivesecurity.com/2022/01/25/watering-hole-deploys-new-macos-malware-dazzlespy-asia/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2022/01/dazzlespy-malware-macos-623x415.jpg"
                                                         alt="Win32/Sality newest component: a router’s primary DNS changer named Win32/RBrute">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2022/01/25/watering-hole-deploys-new-macos-malware-dazzlespy-asia/">
                                                    Watering hole deploys new macOS malware, DazzleSpy, in Asia                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/10/15/virus-bulletin-old-malware-never-dies-gets-more-targeted/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/10/virus-bulletin-old-malware-targeted-attacks-623x415.jpg"
                                                         alt="Win32/Sality newest component: a router’s primary DNS changer named Win32/RBrute">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/10/15/virus-bulletin-old-malware-never-dies-gets-more-targeted/">
                                                    Virus Bulletin: Old malware never dies – it just gets more targeted                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/08/06/anatomy-native-iis-malware/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/07/wls_anatomy-iis-malware-2021_1770540524_1000x667-623x432.jpg"
                                                         alt="Win32/Sality newest component: a router’s primary DNS changer named Win32/RBrute">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/08/06/anatomy-native-iis-malware/">
                                                    Anatomy of native IIS malware                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy Policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2014%2F04%2F02%2Fwin32sality-newest-component-a-routers-primary-dns-changer-named-win32rbrute%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2014%2F04%2F02%2Fwin32sality-newest-component-a-routers-primary-dns-changer-named-win32rbrute%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2014%2F04%2F02%2Fwin32sality-newest-component-a-routers-primary-dns-changer-named-win32rbrute%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/js/main.js?id=fef3139dcedd23afc232"></script>
    <!-- Version: v1.10.0.0df103.pro.azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"41890 \/?p=41890","disqusShortname":"welivesecurity","disqusTitle":"Win32\/Sality newest component: a router\u2019s primary DNS changer named Win32\/RBrute","disqusUrl":"https:\/\/www.welivesecurity.com\/2014\/04\/02\/win32sality-newest-component-a-routers-primary-dns-changer-named-win32rbrute\/","postId":"41890"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>
