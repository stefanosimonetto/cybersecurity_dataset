<!DOCTYPE html>
<html lang="en-US">
<head >
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>WordPress Malware Causes Psuedo-Darkleech Infection</title>
<meta name='robots' content='max-image-preview:large' />

<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://mashshare.net -->
<meta property="og:type" content="article" /> 
<meta property="og:title" content="WordPress Malware Causes Psuedo-Darkleech Infection" />
<meta property="og:description" content="Darkleech is a nasty malware infection that infects web servers at the root level. It use malicious Apache modules to insert hidden iframes with certain responses. It's difficult to detect because the malware is only" />
<meta property="og:image" content="https://blog.sucuri.net/wp-content/uploads/2015/03/darkleech-servers-e1554400678332.jpg" />
<meta property="og:url" content="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html" />
<meta property="og:site_name" content="Sucuri Blog" />
<meta property="article:publisher" content="https://www.facebook.com/SucuriSecurity/" />
<meta property="article:published_time" content="2015-03-26T06:00:37-07:00" />
<meta property="article:modified_time" content="2016-05-24T14:10:41-07:00" />
<meta property="og:updated_time" content="2016-05-24T14:10:41-07:00" />
<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://www.mashshare.net -->
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->
<meta property="og:image:width" content="400" />
<meta property="og:image:height" content="234" />
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="WordPress Malware Causes Psuedo-Darkleech Infection">
<meta name="twitter:description" content="Darkleech is a nasty malware infection that infects web servers at the root level. It use malicious Apache modules to insert hidden iframes with certain responses. It's difficult to detect because the malware is only">
<meta name="twitter:image" content="https://blog.sucuri.net/wp-content/uploads/2015/03/darkleech-servers-e1554400678332.jpg">
<meta name="twitter:site" content="@sucurisecurity">
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->


<!-- This site is optimized with the Yoast SEO Premium plugin v12.5 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="The Darkleech server malware is back. This infection is only active when both server and site admins are not logged in. Analysis and remediation steps here."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html" />
<!-- / Yoast SEO Premium plugin. -->

<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Feed" href="https://blog.sucuri.net/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Comments Feed" href="https://blog.sucuri.net/comments/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; WordPress Malware Causes Psuedo-Darkleech Infection Comments Feed" href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html/feed" />
<!-- This site uses the Google Analytics by MonsterInsights plugin v7.10.0 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<script type="text/javascript" data-cfasync="false">
	var mi_version         = '7.10.0';
	var mi_track_user      = true;
	var mi_no_track_reason = '';
	
	var disableStr = 'ga-disable-UA-4077922-18';

	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}
	
	if ( mi_track_user ) {
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

		__gaTracker('create', 'UA-4077922-18', 'auto');
		__gaTracker('set', 'forceSSL', true);
		__gaTracker('require', 'displayfeatures');
		__gaTracker('send','pageview');
	} else {
		console.log( "" );
		(function() {
			/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
			var noopfn = function() {
				return null;
			};
			var noopnullfn = function() {
				return null;
			};
			var Tracker = function() {
				return null;
			};
			var p = Tracker.prototype;
			p.get = noopfn;
			p.set = noopfn;
			p.send = noopfn;
			var __gaTracker = function() {
				var len = arguments.length;
				if ( len === 0 ) {
					return;
				}
				var f = arguments[len-1];
				if ( typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function' ) {
					console.log( 'Not running function __gaTracker(' + arguments[0] + " ....) because you are not being tracked. " + mi_no_track_reason );
					return;
				}
				try {
					f.hitCallback();
				} catch (ex) {

				}
			};
			__gaTracker.create = function() {
				return new Tracker();
			};
			__gaTracker.getByName = noopnullfn;
			__gaTracker.getAll = function() {
				return [];
			};
			__gaTracker.remove = noopfn;
			window['__gaTracker'] = __gaTracker;
					})();
		}
</script>
<!-- / Google Analytics by MonsterInsights -->
<link rel='stylesheet' id='sucuri-blog-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/style.css?ver=1.2.0' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://blog.sucuri.net/wp-includes/css/dist/block-library/style.min.css?ver=6.0.1' type='text/css' media='all' />
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel='stylesheet' id='select2-css'  href='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.css?ver=4.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='mashsb-styles-css'  href='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/css/mashsb.min.css?ver=3.8.1' type='text/css' media='all' />
<style id='mashsb-styles-inline-css' type='text/css'>
.mashsb-count {color:#cccccc;}[class^="mashicon-"] .text, [class*=" mashicon-"] .text{
    text-indent: -9999px !important;
    line-height: 0px;
    display: block;
    } 
    [class^="mashicon-"] .text:after, [class*=" mashicon-"] .text:after {
        content: "" !important;
        text-indent: 0;
        font-size:13px;
        display: block !important;
    }
    [class^="mashicon-"], [class*=" mashicon-"] {
        width:25%;
        text-align: center !important;
    }
    [class^="mashicon-"] .icon:before, [class*=" mashicon-"] .icon:before {
        float:none;
        margin-right: 0;
    }
    .mashsb-buttons a{
       margin-right: 3px;
       margin-bottom:3px;
       min-width: 0;
       width: 41px;
    }
    .onoffswitch, 
    .onoffswitch-inner:before, 
    .onoffswitch-inner:after 
    .onoffswitch2,
    .onoffswitch2-inner:before, 
    .onoffswitch2-inner:after  {
        margin-right: 0px;
        width: 41px;
        line-height: 41px;
    }#mashbar-header .mashsb-count { 
    display:none; 
}
</style>
<link rel='stylesheet' id='sucuriblog-google-fonts-css'  href='//fonts.googleapis.com/css?family=Open+Sans:300,400,400italic,700,600' type='text/css' media='all' />
<link rel='stylesheet' id='cookie-banner-css-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/css/cookie-banner.css?ver=20200427' type='text/css' media='all' />
<script type='text/javascript' id='monsterinsights-frontend-script-js-extra'>
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[]","home_url":"https:\/\/blog.sucuri.net","hash_tracking":"false"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/google-analytics-premium/assets/js/frontend.min.js?ver=7.10.0' id='monsterinsights-frontend-script-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.js?ver=4.0.1' id='select2-js'></script>
<script type='text/javascript' id='mashsb-js-extra'>
/* <![CDATA[ */
var mashsb = {"shares":"476","round_shares":"1","animate_shares":"1","dynamic_buttons":"0","share_url":"https:\/\/blog.sucuri.net\/2015\/03\/pseudo-darkleech-server-root-infection.html","title":"WordPress+Malware+Causes+Psuedo-Darkleech+Infection","image":"https:\/\/blog.sucuri.net\/wp-content\/uploads\/2015\/03\/darkleech-servers-e1554400678332.jpg","desc":"Darkleech is a nasty malware infection that infects web servers at the root level. It use malicious Apache modules to insert hidden iframes with certain responses. It's difficult to detect because the malware is only \u2026","hashtag":"@sucurisecurity","subscribe":"link","subscribe_url":"http:\/\/sucuri.hs-sites.com\/subscribe-to-security","activestatus":"1","singular":"1","twitter_popup":"1","refresh":"0","nonce":"c1b7e23fe8","postid":"12209","servertime":"1659523602","ajaxurl":"https:\/\/blog.sucuri.net\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/js/mashsb.min.js?ver=3.8.1' id='mashsb-js'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/html5shiv.min.js?ver=3.7.3' id='html5shiv-js'></script>
<![endif]-->
<link rel="https://api.w.org/" href="https://blog.sucuri.net/wp-json/" /><link rel="alternate" type="application/json" href="https://blog.sucuri.net/wp-json/wp/v2/posts/12209" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.sucuri.net/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.sucuri.net/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://blog.sucuri.net/?p=12209' />


<!-- This site is optimized with the Schema plugin v1.7.9.4 - https://schema.press -->
<script type="application/ld+json">{"@context":"https:\/\/schema.org\/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.sucuri.net\/2015\/03\/pseudo-darkleech-server-root-infection.html"},"url":"https:\/\/blog.sucuri.net\/2015\/03\/pseudo-darkleech-server-root-infection.html","headline":"WordPress Malware Causes Psuedo-Darkleech Infection","datePublished":"2015-03-26T06:00:37-07:00","dateModified":"2016-05-24T14:10:41-07:00","publisher":{"@type":"Organization","@id":"https:\/\/blog.sucuri.net\/#organization","name":"Sucuri Blog","logo":{"@type":"ImageObject","url":"","width":600,"height":60}},"image":{"@type":"ImageObject","url":"https:\/\/blog.sucuri.net\/wp-content\/uploads\/2015\/03\/darkleech-servers-e1554400678332.jpg","width":696,"height":234},"articleSection":"Joomla Security","keywords":"Conditional Malware, Server Security, Webserver Infections","description":"Darkleech is a nasty malware infection that infects web servers at the root level. It use malicious Apache modules to insert hidden iframes with certain responses. It's difficult to detect because the malware is only active when both the server and site admins are not logged in and the","author":{"@type":"Person","name":"Denis Sinegubko","url":"https:\/\/blog.sucuri.net\/author\/denis","description":"Denis Sinegubko is Sucuri’s Senior Malware Researcher who joined the company in 2013. Denis' main responsibilities include researching emerging threats and creating  signatures for SiteCheck. The founder of UnmaskParasites, his professional experience covers over 20 years of programming and information security. When Denis isn’t analyzing malware, you might not find him not online at all. Connect with him on Twitter.","image":{"@type":"ImageObject","url":"https:\/\/secure.gravatar.com\/avatar\/c9ef50b85bd345ea4e0d8da558816f3d?s=96&d=mm&r=g","height":96,"width":96}}}</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-4077922-18', 'auto');
  ga('require', 'linker');
  ga('linker:autoLink', ['ddecode.com', 'unmaskparasites.com', 'urlfind.org']);
  ga('send', 'pageview');
</script>

<script type="text/javascript">
(function(a,b,c,d,e,f,g){e['ire_o']=c;e[c]=e[c]||function(){(e[c].a=e[c].a||[]).push(arguments)};f=d.createElement(b);g=d.getElementsByTagName(b)[0];f.async=1;f.src=a;g.parentNode.insertBefore(f,g);})('//d.impactradius-event.com/A166802-5dda-4f98-aad8-1f58dbc8f1771.js','script','ire',document,window);
</script>
<script type='text/javascript'>/*<![CDATA[*/(function(n,d,c){d.setTime(d.getTime()+2592000000);c=(new RegExp('[?&]'+n+'=([^&#]*)','i')).exec(window.location.search);if(c=c?c[1]:null)document.cookie=n+'='+c+';expires='+d.toUTCString()+';domain=.sucuri.net;path=/';})('cjevent',new Date());/*]]>*/</script><!-- Tealium Universal Tag --><script type="text/javascript">(function(a,b,c,d){a='//tags.tiqcdn.com/utag/gpl/sucuri/prod/utag.js';b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a)})();</script><link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#menu-item-17506{ background-color: #619f42;}
#menu-item-17506:hover {background-color:#478237}
#menu-item-17506 > a { color:#fff;}
.nav-primary {
 width: 80%;
}

.genesis-nav-menu {
 display:table;
}

.genesis-nav-menu .menu-item {
 float:none;
 display:table-cell;
 text-align:center;
 vertical-align:top;
}

.text-right {
 text-align:right !important;
}

.genesis-nav-menu .languages-sub-menu a {
 margin-right:0;
}

/* Blog Background Green Color Replace*/
#menu-item-17506 { background-color: #008673!important; }
.home.archive-post-grid .archive-featured-post:first-of-type { border-top: 8px solid #008673!important; }
.button { background-color: #008673!important; }
#sidebar-cta .widget { background-color: #008673!important; }
.fwp-load-more:focus, .fwp-load-more:hover, .load-more:focus, .load-more:hover {
    background-color: #008673!important;
}
.social-icons a::before {
    background-color: #008673!important;
}
.footer-widgets .social-icons a:focus::before, .footer-widgets .social-icons a:hover::before, .footer-widgets .button:focus, .footer-widgets .button:hover {
    background-color: #008673!important;
}	
.button { background-color: #008673!important; }

.footer-widgets .button:hover { background-color: #26BA9E!important; }		</style>
		</head>
<body class="post-template-default single single-post postid-12209 single-format-standard header-full-width content-sidebar"><div class="site-container"><ul class="genesis-skip-link"><li><a href="#genesis-nav-primary" class="screen-reader-shortcut"> Skip to primary navigation</a></li><li><a href="#genesis-content" class="screen-reader-shortcut"> Skip to content</a></li><li><a href="#genesis-sidebar-primary" class="screen-reader-shortcut"> Skip to primary sidebar</a></li><li><a href="#genesis-footer-widgets" class="screen-reader-shortcut"> Skip to footer</a></li></ul><header class="site-header" itemscope itemtype="https://schema.org/WPHeader"><div class="wrap"><div class="title-area"><p class="site-title" itemprop="headline"><a href="https://blog.sucuri.net/">Sucuri Blog</a></p><p class="site-description screen-reader-text" itemprop="description">Website Security News</p></div><nav class="nav-primary" aria-label="Main" itemscope itemtype="https://schema.org/SiteNavigationElement" id="genesis-nav-primary"><ul id="menu-header-navigation-ii" class="menu genesis-nav-menu menu-primary js-superfish"><li id="menu-item-17495" class="menu-item-products menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17495"><a href="https://sucuri.net/website-antivirus/signup" itemprop="url"><span itemprop="name">Products</span></a>
<ul class="sub-menu">
	<li id="menu-item-17496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17496"><a href="https://sucuri.net/website-security-platform/signup/" itemprop="url"><span itemprop="name">Website Security Platform</span></a></li>
	<li id="menu-item-17497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17497"><a href="https://sucuri.net/website-firewall/" itemprop="url"><span itemprop="name">Website Firewall (WAF)</span></a></li>
	<li id="menu-item-20814" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20814"><a href="https://sucuri.net/custom/enterprise/" itemprop="url"><span itemprop="name">Enterprise Website Security</span></a></li>
	<li id="menu-item-20815" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20815"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Multisite Solutions</span></a></li>
</ul>
</li>
<li id="menu-item-17498" class="menu-item-industry menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17498"><a href="https://sucuri.net/website-security-platform/" itemprop="url"><span itemprop="name">Features</span></a>
<ul class="sub-menu">
	<li id="menu-item-17499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17499"><a href="https://sucuri.net/malware-detection-scanning/" itemprop="url"><span itemprop="name">Detection</span></a></li>
	<li id="menu-item-17500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17500"><a href="https://sucuri.net/website-hack-protection/" itemprop="url"><span itemprop="name">Protection</span></a></li>
	<li id="menu-item-17501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17501"><a href="https://sucuri.net/website-performance/" itemprop="url"><span itemprop="name">Performance</span></a></li>
	<li id="menu-item-19564" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19564"><a href="https://sucuri.net/website-malware-removal/" itemprop="url"><span itemprop="name">Response</span></a></li>
	<li id="menu-item-19911" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19911"><a href="https://sucuri.net/website-backups/" itemprop="url"><span itemprop="name">Backups</span></a></li>
</ul>
</li>
<li id="menu-item-19912" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-19912"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a>
<ul class="sub-menu">
	<li id="menu-item-19913" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19913"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Agency Solutions</span></a></li>
	<li id="menu-item-19915" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19915"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a></li>
	<li id="menu-item-20816" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20816"><a href="https://sucuri.net/referral/" itemprop="url"><span itemprop="name">Referral Program</span></a></li>
	<li id="menu-item-19914" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19914"><a href="https://sucuri.net/ecommerce-website-security/" itemprop="url"><span itemprop="name">Ecommerce</span></a></li>
</ul>
</li>
<li id="menu-item-20817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-20817"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Resources</span></a>
<ul class="sub-menu">
	<li id="menu-item-20818" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20818"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Guides</span></a></li>
	<li id="menu-item-20819" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20819"><a href="https://sucuri.net/webinars/" itemprop="url"><span itemprop="name">Webinars</span></a></li>
	<li id="menu-item-20820" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20820"><a href="https://sucuri.net/infographics/" itemprop="url"><span itemprop="name">Infographics</span></a></li>
	<li id="menu-item-20821" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20821"><a href="https://sitecheck.sucuri.net/" itemprop="url"><span itemprop="name">SiteCheck</span></a></li>
	<li id="menu-item-20822" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20822"><a href="https://sucuri.net/reports/" itemprop="url"><span itemprop="name">Reports</span></a></li>
	<li id="menu-item-22570" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22570"><a href="https://sucuri.net/email-courses/" itemprop="url"><span itemprop="name">Email Courses</span></a></li>
</ul>
</li>
<li id="menu-item-17506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17506"><a href="https://sucuri.net/website-security-platform/help-now" itemprop="url"><span itemprop="name">Immediate Help</span></a></li>
<li id="menu-item-17509" class="menu-item-login menu-item menu-item-type-custom menu-item-object-custom menu-item-17509"><a href="https://dashboard.sucuri.net/login/" itemprop="url"><span itemprop="name">Login</span></a></li>
</ul></nav><button id="responsive-menu" role="button" aria-controls="genesis-nav-primary" aria-pressed="false"><span class="screen-reader-text">Menu</span></button></div></header><div class="site-inner"><div class="wrap"><div class="content-sidebar-wrap"><main class="content" id="genesis-content"><article class="post-12209 post type-post status-publish format-standard has-post-thumbnail category-joomla-security category-website-malware-infections category-website-security category-wordpress-security tag-conditional-malware tag-server-security tag-webserver-infections entry"><header class="entry-header"><div class="single-featured"><img width="400" height="234" src="https://blog.sucuri.net/wp-content/uploads/2015/03/darkleech-servers-e1554400678332.jpg" class="single-featured-image wp-post-image" alt="" loading="lazy" /></div><h1 class="entry-title">WordPress Malware Causes Psuedo-Darkleech Infection</h1>
<p class="entry-meta"><time class="entry-time" datetime="2015-03-26T06:00:37-07:00">March 26, 2015</time><span class="entry-author"><a href="https://blog.sucuri.net/author/denis" class="entry-author-link" rel="author"><span class="entry-author-name">Denis Sinegubko</span></a></span></p></header><div class="entry-content"><aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2015%2F03%2Fpseudo-darkleech-server-root-infection.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=WordPress%20Malware%20Causes%20Psuedo-Darkleech%20Infection&url=https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--><p><a title="Darkleech + Bitly.com = Insightful Statistics" href="https://blog.sucuri.net/2014/02/darkleech-bitly-com-insightful-statistics.html" target="_blank">Darkleech</a> is a nasty malware infection that infects web servers at the root level. It use malicious Apache modules to insert hidden iframes with certain responses. It&#8217;s difficult to detect because the malware is only active when both the server and site admins are not logged in and the iframe is only injected once a day (or once a week in some versions) per IP address. This means that the infection symptoms are difficult to reproduce. Since it’s a server-level infection even the most thorough remote scans won’t reveal anything. Even when the culprit is identified, website owners may not be able to resolve the issue without help of a server administrator.</p>
<p>Despite the detection difficulties, it was quite easy to tell that the server was infected with Darkleech when we saw the malicious code — it has followed the same recognizable pattern since 2012: <span id="more-12209"></span></p>
<ul>
<li>Declaration of a CSS class with a random name and random negative absolute position.</li>
<li>A div of that class.</li>
<li>A malicious iframe with random dimensions inside that div.</li>
</ul>
<p>This is what it looked like back in September of 2012:</p>
<pre>&lt;style&gt;.<strong>tlqvepxi</strong> { position:absolute; left:-<strong>1648</strong>px; top:<strong>-1752</strong>px} &lt;/style&gt; &lt;div class="<strong>tlqvepxi</strong>"&gt;
&lt;iframe src="hxxp://<em>example.com</em>/21234443.html" width="<strong>581</strong>" height="<strong>476</strong>"&gt;&lt;/iframe&gt;&lt;/div&gt;</pre>
<p>This is the code from <a href="http://blog.unmaskparasites.com/2014/11/27/darkleech-update-november-2014/" target="_blank">November of 2014</a></p>
<pre>&lt;style&gt;.<strong>syxq9la69</strong> { position:absolute; left:<strong>-1666</strong>px; top:<strong>-1634</strong>px} &lt;/style&gt; &lt;div class="<strong>syxq9la69</strong>"&gt;
&lt;iframe src="hxxp://<strong>jsnrgo .ddns .net</strong>/nsiumkogckv1tv4locfzyv2eykqss9ltfb9wnmhfqz1ol2" width="<strong>285</strong>" height="<strong>554</strong>"&gt;&lt;/iframe&gt;&lt;/div&gt;</pre>
<p>Very similar, isn’t it?</p>
<p>At some point, Darkleech began to use free <a title="NoIP.com DarkLeech" href="http://www.noip.com/remote-access" target="_blank">No-IP</a> dynamic DNS hostnames (random third-level domains on <em>ddnes.net</em>, <em>myftp.org</em>, <em>servepics.com</em>, <em>hopto.org</em>, <em>serveftp.com</em>, etc. ) and this became one of its distinguishing features too.</p>
<h3>New version of Darkleech?</h3>
<p>Recently, we began to notice the following code on some WordPress websites.</p>
<pre>&lt;style&gt;.<strong>cznfvc1d54</strong> { position:absolute; left:<strong>-1447</strong>px; top:<strong>-1785</strong>px} &lt;/style&gt; &lt;div class="<strong>cznfvc1d54</strong>"&gt;
&lt;iframe src="hxxp:// dhbxnx .serveftp .com/<strong>blog/4c2H?utm_source=g86</strong>" width="<strong>593</strong>" height="<strong>405</strong>"&gt;&lt;/iframe&gt;&lt;/div&gt;</pre>
<p>That’s the same pattern, except for the trailing iframe URL part: <strong>/blog/4C2H?utm_source=g86</strong>.</p>
<p>It stayed the same on all the sites. The only varying part of the URL paths was the value of the <strong>utm_source</strong> parameter: <em>utm_source=<strong>g86</strong></em>, <em>utm_source=<strong>g112</strong></em>, <em>utm_source=<strong>g90</strong></em>,<em> utm_source=<strong>g98</strong></em>, etc.</p>
<p>Sometimes the malware was hard to reproduce, but on some sites it was reproducible on every load. What was even stranger is that we saw this on <strong>IIS</strong> servers (with PHP support) too. We had not heard of Darkleech infecting IIS web servers.</p>
<h5>Malware in nav-menu.php</h5>
<p>Then we had a chance to work with one of the infected websites and found the real source of these “Darkleech iframes”. The culprit was the infected <strong>wp-includes/nav-menu.php</strong> core WordPress file.</p>
<p>It had the following injected encrypted code in the middle of it:</p>
<figure id="attachment_12210" aria-describedby="caption-attachment-12210" style="width: 598px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2015/03/malware-nav-menu-php.gif" rel="lightbox"><img loading="lazy" class="size-full wp-image-12210" src="https://blog.sucuri.net/wp-content/uploads/2015/03/malware-nav-menu-php.gif" alt="Malware in nav-menu.php" width="598" height="503" /></a><figcaption id="caption-attachment-12210" class="wp-caption-text">Malware in nav-menu.php</figcaption></figure>
<p>In this decoded version, we see a backdoor section that allows execution of PHP code passed in the <strong>p1</strong> and <strong>p2</strong> POST parameters to any blog URL:</p>
<p><a href="https://blog.sucuri.net/wp-content/uploads/2015/03/backdoor_section.gif" rel="lightbox"><img loading="lazy" class="aligncenter size-full wp-image-12211" src="https://blog.sucuri.net/wp-content/uploads/2015/03/backdoor_section.gif" alt="Backdoor section of the code" width="468" height="202" /></a></p>
<p>&#8230; and this section downloads code from a remote<strong> dazzer .slyip .com</strong> server and injects the downloaded code into web pages:</p>
<figure id="attachment_12212" aria-describedby="caption-attachment-12212" style="width: 548px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2015/03/dazzer_slyip_com.gif" rel="lightbox"><img loading="lazy" class="size-full wp-image-12212" src="https://blog.sucuri.net/wp-content/uploads/2015/03/dazzer_slyip_com.gif" alt="Downloading malware from dazzer .slyip .com" width="548" height="351" /></a><figcaption id="caption-attachment-12212" class="wp-caption-text">Downloading malware from dazzer .slyip .com</figcaption></figure>
<h4>Two Layers of Tests</h4>
<p>Here you can see that there are two layers of tests determining whether to inject malware or not.</p>
<p>The first layer is in this script. It’s some sort of pre-screening. It makes sure that the requests are not coming from search engine bots or from Google’s network. Also note the commented out line where they used to check for Internet Explorer browsers only — for some reason they removed this condition in the current version.</p>
<p>The second layer is on the remote server. They pass the following information about every request in the parameters of the URL: <strong>hxxp: / /dazzer .slyip .com/ordpm/v2/?export=7f53f8c6c730af6aeb52e66eb74d8507&amp;url=nnnnn&amp;g=ggg </strong>:</p>
<ul>
<li>Domain of the infected site.</li>
<li>IP address of the visitor.</li>
<li>Browser of the visitor (user agent).</li>
<li>Referrer.</li>
</ul>
<p>It’s clear that this information is used to determine request eligibility. The <strong>dazzer .slyip .com</strong> can track IP addresses and return the malicious code only <strong>once in a certain period of time</strong> to requests <strong>from the same IP.</strong> The IP address also helps with geo-targeting if the attackers are only interested in traffic from certain countries. The user agent string will tell them whether the visitor uses a vulnerable version of a browser that they can attack. The referrer helps them identify visitors who came to the site after clicking on links in search results or on social networks (website owners and webmasters are more likely to use bookmarks rather than search engines).</p>
<p>If all the requirements are met, the remote server returns a base64-encoded malware to be injected into web pages (since it is in the <strong>nav-menu.php</strong> it will be at the very top of the HTML code, before the tag). If the request is considered not eligible, then <strong>dazzer .slyip .com </strong>doesn’t return anything and malware is not being injected.</p>
<h4>Verifying the Injected Payload</h4>
<p>OK, this code is definitely malicious and its behavior is quite typical for PHP malware. But is it really responsible for those Darkleech iframes? Or maybe it’s some different malware and removing it won’t be enough to fix the Darkleech problem. To figure this out, I conducted a very simple test — used the malware code to prepare a complete <strong>dazzer .slyip .com</strong> URL with all the required parameters and made a request to it from a different server — the response came back with a base64-encoded string, which after decoding looked like this:</p>
<figure id="attachment_12213" aria-describedby="caption-attachment-12213" style="width: 548px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2015/03/dazzer_slyip_com1.gif" rel="lightbox"><img loading="lazy" class="size-full wp-image-12213" src="https://blog.sucuri.net/wp-content/uploads/2015/03/dazzer_slyip_com1.gif" alt="Pseudo-darkleech code from dazzer .slyip .com" width="548" height="351" /></a><figcaption id="caption-attachment-12213" class="wp-caption-text">Pseudo-darkleech code from dazzer .slyip .com</figcaption></figure>
<p>That’s exactly the code that we originally thought belonged to Darkleech. You might have noticed that the <strong>utm_source=g112</strong> parameter in the iframe URL matches the <strong>g=112</strong> parameter in the <strong>dazzer .slyip .com</strong> URL. This test proved that the real culprit was the malware inside one of the WordPress files, not a root level web server infection.</p>
<p>What we see here is malware that uses the same iframe code generation algorithm as we originally noticed in Darkleech: hidden style, div and an iframe inside the hidden div, with all the names and parameters changing on every load. The use of <a href="http://www.noip.com/remote-access" target="_blank">No-IP</a> hostnames is also common with Darkleech. By the way, the <strong>dazzer .slyip .com</strong> domain also uses a Dynamic DNS service — this time if belongs to <a href="https://www.dtdns.com/dtsite/infodynamichosts" target="_blank">DtDNS</a> (at the time of writing it points to <strong>217.172.170.7</strong> – Germany, Hurth Plusserver Ag).</p>
<h3>Remediation</h3>
<p>Unlike a real Darkleech infection, this one is pretty easy to deal with. The malware should be detectable by any security plugin (e.g. <a href="https://wordpress.org/plugins/sucuri-scanner/">Sucuri Security plugin</a>) that checks integrity of core WP files. The easiest way to remove the malware is to replace the infected file with the clean one from the original WordPress package. You can also reinstall WordPress or upgrade it if you are still using an old version.</p>
<p><span style="line-height: 1.5;">Of course, this is only a part of the cleanup process. You will also need to find and remove all the backdoors that hackers might have placed on your server and identify the security hole that was used to break into your site in the first place. </span></p>
<p>In case of this attack, you may find backdoors that I showed in the screenshot for the backdoor section above in some random files. They may be core WordPress files or third-party plugin files. Try searching for &#8220;<strong>passssword</strong>&#8221; (4 &#8216;s&#8217; in passssword). We can also see that most compromised sites are using <a href="https://blog.sucuri.net/2014/09/slider-revolution-plugin-critical-vulnerability-being-exploited.html">old vulnerable versions of the Slider Revolution</a> (RevSlider) plugin. <a href="http://www.themepunch.com/home/plugin-update-information/">Update it</a> ASAP, even if it&#8217;s a part of a theme! Update all other themes and plugins too.</p>
<p>We can see that once hackers break into a web site they infect the <strong>nav-menu.php</strong> files in all the sites that share the same hosting account (they don&#8217;t have to have the RevSlider plugin). Moreover, not only WordPress sites can be infected this way. We also see that the attackers inject the same code into the <strong>defines.php</strong> file of <strong>Joomla</strong> websites, e.g: <em>includes/defines.php</em>, <em>administrator/includes/defines.php</em></p>
<p><span style="line-height: 1.5;">Once you remove malware and update software, make sure to change all passwords. You might also want to check if hackers created additional WordPress admin users as suggested in <a href="http://blog.0x3a.com/post/114659871819/thousands-of-compromised-wordpress-websites">this post</a>. I can&#8217;t confirm it always happens, but if a site uses old versions of a plugin that has been actively exploited for more than 6 months now, then the chances are it&#8217;s not the first time it has been hacked and it may be affected by multiple unrelated attacks.<br />
</span></p>
<p><span style="line-height: 1.5;">For additional pro-active protection we recommend using a </span><a style="line-height: 1.5;" href="http://sucuri.net/website-firewall/">website firewall</a><span style="line-height: 1.5;">. If you&#8217;re currently infected, and need help, you can learn more about our <a href="http://sucuri.net/website-antivirus/malware-removal">Website Malware Removal Services. </a></span></p>
<aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2015%2F03%2Fpseudo-darkleech-server-root-infection.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=WordPress%20Malware%20Causes%20Psuedo-Darkleech%20Infection&url=https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--></div><footer class="entry-footer"><p class="entry-meta"><span class="entry-categories">Categories: <a href="https://blog.sucuri.net/category/joomla-security" rel="category tag">Joomla Security</a>, <a href="https://blog.sucuri.net/category/website-malware-infections" rel="category tag">Website Malware Infections</a>, <a href="https://blog.sucuri.net/category/website-security" rel="category tag">Website Security</a>, <a href="https://blog.sucuri.net/category/wordpress-security" rel="category tag">WordPress Security</a></span><span class="entry-tags">Tags: <a href="https://blog.sucuri.net/tag/conditional-malware" rel="tag">Conditional Malware</a>, <a href="https://blog.sucuri.net/tag/server-security" rel="tag">Server Security</a>, <a href="https://blog.sucuri.net/tag/webserver-infections" rel="tag">Webserver Infections</a></span></p></footer></article><section class="author-box"><img alt='' src='https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=115&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=230&#038;d=mm&#038;r=g 2x' class='avatar avatar-115 photo' height='115' width='115' loading='lazy'/><h4 class="author-box-title">About <span itemprop="name">Denis Sinegubko</span></h4><div class="author-box-content" itemprop="description"><p>Denis Sinegubko is Sucuri’s Senior Malware Researcher who joined the company in 2013. Denis' main responsibilities include researching emerging threats and creating  signatures for SiteCheck. The founder of UnmaskParasites, his professional experience covers over 20 years of programming and information security. When Denis isn’t analyzing malware, you might not find him not online at all. Connect with him on <a href="https://twitter.com/unmaskparasites">Twitter</a>.</p>
</div></section><h2 class="screen-reader-text">Reader Interactions</h2><div class="entry-comments" id="comments"><h3>Comments</h3><ol class="comment-list">
	<li class="comment even thread-even depth-1" id="comment-4687">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/a56d9c936161506e5b57c01ca0991c2a?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a56d9c936161506e5b57c01ca0991c2a?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Andre</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-03-26T16:25:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-4687">March 26, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>The first paragraph mentions “malicious Apache modules”. Is a server running Nginx safe from this particular vulnerability? Thanks in advance.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-4689">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Denis Sinegubko</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-03-26T18:16:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-4689">March 26, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Apache modules are not a &#8220;vulnerability&#8221;. Root can install any modules. And if hackers get root access they can install malicious modules. With Nginx, we saw trojanized nginx binaries. There are similar server-wide infections like Linux/Cdorked that affect nginx and lighttpd (in addition to Apache).</p>
<p>There is a great write up on such attacks here <a href="http://www.welivesecurity.com/wp-content/uploads/2014/03/operation_windigo.pdf" rel="nofollow ugc">http://www.welivesecurity.com/wp-content/uploads/2014/03/operation_windigo.pdf</a></p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-4688">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/94e2c0c51b71f00ed2b3881c3e97763f?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/94e2c0c51b71f00ed2b3881c3e97763f?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">1F2Ns</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-03-26T16:52:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-4688">March 26, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thank you for this read. We were hit two days ago and Wordfence discovered the core mod today.<br />
We are implementing the &#8216;fix&#8217; in hopes of getting this under control and will be switching over to Sucuri plugin.<br />
NOTE: <a href="http://sitecheck.sucuri.net/" rel="nofollow ugc">http://sitecheck.sucuri.net/</a> was the only site check that even identified the issue.</p>
<p>Thanks again for providing a name to the face.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-4690">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/65c301cbdb3d3e6ece195371a97c8041?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/65c301cbdb3d3e6ece195371a97c8041?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Alex</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-01T00:13:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-4690">April 1, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I was caught up in this attack exact same code inserted into the exact same file. After cleaning the file, updating all passwords and updating all plugins, themes and the wordpress core. I was then reinfected just hours later. Is there another backdoor such as FilesMan and how can I find it?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-4691">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/65c301cbdb3d3e6ece195371a97c8041?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/65c301cbdb3d3e6ece195371a97c8041?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Alex</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-01T02:17:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-4691">April 1, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Sorry, I missed out the passssword search section. Found the backdoor using grep. Thanks, this article was very helpful and informative! Go Securi!</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-3" id="comment-6433">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/1f82b4d37a6a6532951446a59b13a6b2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1f82b4d37a6a6532951446a59b13a6b2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Ha Doan Ngoc</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-06-04T10:13:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-6433">June 4, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I restore original WordPress files but the malware comes back in few or less than 24 hours. Where else did you find the backdoor? (other than nav-menu.php)</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-4" id="comment-6586">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/adb84082e7ba70f028b4840d0d785c2b?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/adb84082e7ba70f028b4840d0d785c2b?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Jeff</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-07-15T00:54:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-6586">July 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I am also having this problem of it coming back within 24 hours</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-6295">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/059b607389db185d07b505103beae981?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/059b607389db185d07b505103beae981?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Christian</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-29T16:34:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-6295">April 29, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hi, thanks for this article. I have been watching this malware since March 2015, and now I could say it has developed into another form. It does not use //istart like it used to be, second it has also more than one //iend at the end of their code. Third, it does not use any hex anymore instead a PHP code is being injected on line 466 &#8211; 500 or so just before the function wp_get_nav_menus() usually find on line 462 or 466 in wp-includes/nav-menu.php file.</p>
<p>Let me know if you are interested, I will be happy to send it to you for further investigation of the malware development.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-6616">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/af1d844ffebbaa9392b954732f95e8ef?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af1d844ffebbaa9392b954732f95e8ef?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">nicmare</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-07-28T13:00:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-6616">July 28, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>i never use revolution slider. i even do not know about it. but my site was infected to! i think it may happen when your server supports the auto updates from wordpress. so try to disable that feature and the malware should not come back</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-3" id="comment-6624">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/059b607389db185d07b505103beae981?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/059b607389db185d07b505103beae981?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Christian</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-07-30T15:40:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-6624">July 30, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>hi @nicbug:disqus, so, how was it? Did you found the malware again even after disabling the feature to auto updates on wordpress? I hoped it was working but to me it wasn&#8217;t.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-4" id="comment-6633">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/af1d844ffebbaa9392b954732f95e8ef?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af1d844ffebbaa9392b954732f95e8ef?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">nicmare</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-08-01T20:51:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-6633">August 1, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>since it was the first occurence of this malware for me, i did not change anything. and since it is a shared hosting and it is a problem with an infected apache server, i can&#8217;t do that much.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt depth-2" id="comment-6621">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/11842cf777cd0133d2d059a6d27e7205?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/11842cf777cd0133d2d059a6d27e7205?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">LiquidaThemes</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-07-30T13:25:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-6621">July 30, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>helly christian!</p>
<p>Right now I&#8217;m dealing with this malware, and my VPS administradores can&#8217;t find the solution. How you did you do it? Where do you made the search for the &#8220;passssword&#8221; backdoors?</p>
<p>thanks in advance</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-3" id="comment-6623">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/059b607389db185d07b505103beae981?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/059b607389db185d07b505103beae981?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Christian</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-07-30T15:11:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-6623">July 30, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>@liquidathemes:disqus  Sorry to hear that you are experiencing it. This issue has nothing to do with your VPS Provider though, and even if they will do it for free as extra service but next time when the malware comes back you will be charged for asking them to help you to clean the files.</p>
<p>You can use linux command to search for it grep -rnw &#8216;/var/www/yoursite&#8217; -e &#8216;passssword&#8217;. If you found it just replace the infected files found with the clean files version of yours: wp core files or theme files.</p>
<p>DO NOT REINSTALL WordPress from zero then change password and blah blah blah, that suggestion is to clean up the mess, but they will always come back.</p>
<p>In order for them not to come back is to use Website Firewall. I would love to hear any thoughts or other solution not to use Website Firewall&#8230;</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-4" id="comment-6625">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/11842cf777cd0133d2d059a6d27e7205?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/11842cf777cd0133d2d059a6d27e7205?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">LiquidaThemes</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-07-30T18:44:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-6625">July 30, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>hello christian, thanks for your prompt response</p>
<p>I&#8217;m getting crazy with this attack</p>
<p>what rules have you included in the firewall ?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even depth-2" id="comment-6637">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/af1d844ffebbaa9392b954732f95e8ef?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af1d844ffebbaa9392b954732f95e8ef?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">nicmare</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-08-05T08:20:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-6637">August 5, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Today i had that problem again. But only on one site. But i have many wordpress setups. So i wonder what causes the problem on this single site again and again. The only significant difference are the used plugins. In detail: i use gravity forms. you guys too?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-6507">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f96b4876a00ef9d8720bf35fa12325ad?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f96b4876a00ef9d8720bf35fa12325ad?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://getpromotedwebdesign.com/medicald/" class="comment-author-link" rel="external nofollow" itemprop="url">Medical Dialogues</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-06-23T05:18:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-6507">June 23, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thank you so much! Keep sharing such knowledge.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-7014">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/beeeb9f008cff704266ce392d2f34d41?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/beeeb9f008cff704266ce392d2f34d41?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">whvet</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-05T19:54:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-7014">December 5, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks for the article.  My girlfriend&#8217;s church was recently hit with this.  Going through the cleanup now  :/</p>
<p>What was interesting/funny is that they almost modified the 404.php page to be the file upload page.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-7021">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/5d7f430a0b045a84e257b4c9290d421c?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5d7f430a0b045a84e257b4c9290d421c?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">DrupalDev</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-08T22:19:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-7021">December 8, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Seen this in a Drupal 7 today. The logic part was added to includes/bootstrap.php.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-7050">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/52ca5c80a696bb7ae85cc89edcc1c2b0?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/52ca5c80a696bb7ae85cc89edcc1c2b0?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">DrupalUser</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-14T21:17:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-7050">December 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Yup. Same spot.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-7162">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/50e9df98605ee97f550bba185b58c6a2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/50e9df98605ee97f550bba185b58c6a2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Michał Gorczyca</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-12-17T18:37:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/03/pseudo-darkleech-server-root-infection.html#comment-7162">December 17, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Is there any way to get rid of this? I have reinstalled every wordpress installation and updated every plugin. still, something overwrites my menu-nav.php files in wp installations 🙁</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ol></div></main><aside class="sidebar sidebar-primary widget-area" role="complementary" aria-label="Primary Sidebar" itemscope itemtype="https://schema.org/WPSideBar" id="genesis-sidebar-primary"><h2 class="genesis-sidebar-title screen-reader-text">Primary Sidebar</h2><div class="sidebar-primary-wrap"><section id="text-5" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Socialize With Sucuri</h3>
			<div class="textwidget"><p>We're actively engaged across multiple platforms. Follow us and let's connect!</p>
<ul class="social-icons">
<li><a target="_blank" href="https://www.facebook.com/SucuriSecurity" rel="noopener"><span class="screen-reader-text">Facebook</span></a></li>
<li><a target="_blank" href="https://twitter.com/sucurisecurity" rel="noopener"><span class="screen-reader-text">Twitter</span></a></li>
<li><a target="_blank" href="https://www.linkedin.com/company/sucuri-security" rel="noopener"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a target="_blank" href="https://www.youtube.com/c/sucurinet" rel="noopener"><span class="screen-reader-text">YouTube</span></a></li>
<li><a target="_blank" href="https://www.instagram.com/sucurisecurity/" rel="noopener"><span class="screen-reader-text">Instagram</span></a></li>
<li><a target="_blank" href="https://blog.sucuri.net/feed/" rel="noopener"><span class="screen-reader-text">RSS Feed</span></a></li>
</ul>
</div>
		</div></section>
<section id="search-3" class="widget widget_search"><div class="widget-wrap"><form class="search-form" method="get" action="https://blog.sucuri.net/"><label class="search-form-label screen-reader-text" for="searchform-62ea5212a7ec5">Search the blog</label><input type="search" name="s" id="searchform-62ea5212a7ec5" placeholder="Search the blog" /><input type="submit" value="Search" /></form></div></section>
<section id="text-13" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://info.sucuri.net/wordpress-security-course?utm_source=Blog&amp;utm_medium=WidgetLogic&amp;utm_campaign=Email-Course&amp;utm_term=EN&amp;utm_content=WordPress-Security" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23218 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/04/blog-sidebar_widgetlogic_emailCourse_wordpress-security.png" alt="WordPress Security Course" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-14" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/webinars/anatomy-of-website-malware?utm_source=Blog&amp;utm_medium=WidgetLogic&amp;utm_campaign=Webinar&amp;utm_term=EN&amp;utm_content=Anatomy-of-Malware" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23220 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_webinars_anatomy-of-website-malware.png" alt="The Anatomy of Website Malware Webinar" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-24" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/guides/how-to-clean-hacked-joomla?utm_source=Blog&#038;utm_medium=WidgetLogic&#038;utm_campaign=Guide&#038;utm_term=EN&#038;utm_content=Hacked-Joomla" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23342 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_guides_joomla-hack.png" alt="Joomla Security Guide" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-30" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/guides/wordpress-security?utm_source=Blog&#038;utm_medium=WidgetLogic&#038;utm_campaign=Guide&#038;utm_term=EN&#038;utm_content=WP-Security" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23353 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_guides_wordpress-security.png" alt="WordPress Security Guide" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-31" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/webinars/how-to-clean-hacked-joomla-site?utm_source=Blog&amp;utm_medium=WidgetLogic&amp;utm_campaign=Webinar&amp;utm_term=EN&amp;utm_content=Hacked-Joomla" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23481 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_webinars_hacked-joomla.png" alt="" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-37" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"></div>
		</div></section>
</div><div class="sidebar-cta-widget" id="sidebar-cta"><section id="text-6" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Join Over 20,000 Subscribers!</h3>
			<div class="textwidget"><p><a href="http://sucuri.hs-sites.com/subscribe-to-security" onClick="ga('send', 'event', 'Blog', 'Button_Click', 'Subscribe_to_Security_Newsletter');"><img src="https://blog.sucuri.net/wp-content/uploads/2017/09/17-EN-sucuri-blog-newsletter-banner.png" /></a></p>
</div>
		</div></section>
</div></aside></div></div></div><footer class="site-footer" itemscope itemtype="https://schema.org/WPFooter"><div class="footer-widgets" id="genesis-footer-widgets"><h2 class="genesis-sidebar-title screen-reader-text">Footer</h2><div class="wrap"><div class="widget-area footer-widgets-1 footer-widget-area"><section id="nav_menu-3" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Products</h3>
<div class="menu-footer-products-menu-container"><ul id="menu-footer-products-menu" class="menu"><li id="menu-item-15501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15501"><a href="https://sucuri.net/website-firewall/" itemprop="url">Website Firewall</a></li>
<li id="menu-item-15502" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15502"><a href="https://sucuri.net/website-antivirus/" itemprop="url">Website AntiVirus</a></li>
<li id="menu-item-15503" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15503"><a href="https://sucuri.net/website-backups/" itemprop="url">Website Backups</a></li>
<li id="menu-item-15504" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15504"><a href="https://sucuri.net/wordpress-security/" itemprop="url">WordPress Security</a></li>
<li id="menu-item-15505" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15505"><a href="https://sucuri.net/custom/enterprise/" itemprop="url">Enterprise Services</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-2 footer-widget-area"><section id="nav_menu-4" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Solutions</h3>
<div class="menu-footer-solutions-menu-container"><ul id="menu-footer-solutions-menu" class="menu"><li id="menu-item-15506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15506"><a href="https://sucuri.net/website-firewall/ddos-protection" itemprop="url">DDos Protection</a></li>
<li id="menu-item-15507" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15507"><a href="https://sucuri.net/website-antivirus/malware-scanning-and-detection" itemprop="url">Malware Detection</a></li>
<li id="menu-item-15508" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15508"><a href="https://sucuri.net/website-antivirus/malware-removal" itemprop="url">Malware Removal</a></li>
<li id="menu-item-15510" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15510"><a href="https://sucuri.net/website-firewall/stop-website-attacks-and-hacks" itemprop="url">Malware Prevention</a></li>
<li id="menu-item-15511" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15511"><a href="https://sucuri.net/website-antivirus/blacklist-removal-and-repair" itemprop="url">Blacklist Removal</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-3 footer-widget-area"><section id="nav_menu-6" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Support</h3>
<div class="menu-footer-support-menu-container"><ul id="menu-footer-support-menu" class="menu"><li id="menu-item-15512" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15512"><a href="https://blog.sucuri.net/" itemprop="url">Blog</a></li>
<li id="menu-item-15513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15513"><a href="https://kb.sucuri.net/" itemprop="url">Knowledge Base</a></li>
<li id="menu-item-15515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15515"><a href="https://sitecheck.sucuri.net/" itemprop="url">SiteCheck</a></li>
<li id="menu-item-15516" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15516"><a href="http://labs.sucuri.net/" itemprop="url">Research Labs</a></li>
<li id="menu-item-15517" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15517"><a href="https://sucuri.net/faq/" itemprop="url">FAQ</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-4 footer-widget-area"><section id="nav_menu-5" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Company</h3>
<div class="menu-footer-company-menu-container"><ul id="menu-footer-company-menu" class="menu"><li id="menu-item-15495" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15495"><a href="https://sucuri.net/company/" itemprop="url">About</a></li>
<li id="menu-item-15496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15496"><a href="https://sucuri.net/company/media" itemprop="url">Media</a></li>
<li id="menu-item-15497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15497"><a href="https://sucuri.net/company/events" itemprop="url">Events</a></li>
<li id="menu-item-15498" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15498"><a href="https://sucuri.net/company/employment/" itemprop="url">Employment</a></li>
<li id="menu-item-15499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15499"><a href="https://sucuri.net/company/contact-us" itemprop="url">Contact</a></li>
<li id="menu-item-15500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15500"><a href="https://sucuri.net/customers/" itemprop="url">Testimonials</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-5 footer-widget-area"><section id="text-4" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><ul class="social-icons">
<li><a href="https://www.facebook.com/SucuriSecurity"><span class="screen-reader-text">Facebook</span></a></li>
<li><a href="https://twitter.com/sucurisecurity"><span class="screen-reader-text">Twitter</span></a></li>
<li><a href="https://www.linkedin.com/company/sucuri-security"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a href="https://www.instagram.com/sucurisecurity/"><span class="screen-reader-text">Instagram</span></a></li>
</ul>
<p><a class="button" href="https://dashboard.sucuri.net/login/">Customer Login</a></p>
<p><a class="footer-logo" href="https://sucuri.net/">Sucuri Home</a></p>
</div>
		</div></section>
</div></div></div><div class="site-footer-widget"><div class="wrap"><section id="text-8" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><div class="site-footer-links">
<ul>
<li><a href="https://sucuri.net/terms">Terms of Use</a></li>
<li><a href="https://sucuri.net/privacy">Privacy Policy</a></li>
<li><a href="https://sucuri.net/faq/">Frequently Asked Questions</a></li>
</ul>
</div>
<div class="site-footer-copyright">
<p>&#x000A9;&nbsp;2022 Sucuri Inc. All rights reserved</p>
</div>
</div>
		</div></section>
</div></div></footer></div><script type="text/javascript">
ire('identify', {customerId: '​​', customerEmail: '​​'}); </script><div id="cookie-policy-banner" class="container-fluid cookie-policy-banner hide p-0">
        <div class="container">
            <button id="cookie-policy-decline-btn" class="cb-close cb-decline-anchor">X</button>
            <div class="row">
                <div class="c-lg-8">
                    <p class="mb-0 mt-0 highlight green heavy">Sucuri Cookie Policy <br> <a href="https://sucuri.net/cookies" target="_blank" class="bolder no-underline">See our policy>></a></p>
                    <p class="mb-0 mt-0">Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.</p>
                </div>
                <div class="c-lg-4 d-flex justify-items-start mt-15 align-items-center">
                    <button id="cookie-policy-btn" class="btn btn-primary ml-0">Accept</button>
                    <button class="btn cb-decline-anchor auto-track" data-gatrack="Cookie_Click, Decline">Decline</button>
                    <button id="manage-privacy-options" class="btn">Manage Options</button>
                </div>
            </div>
        </div>
    </div><script type="text/javascript">
		/* MonsterInsights Scroll Tracking */
			if ( typeof(jQuery) !== 'undefined' ) {
				jQuery( document ).ready(function(){
					function monsterinsights_scroll_tracking_load() {
						if ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) {
							(function(factory) {
								factory(jQuery);
							}(function($) {

								/* Scroll Depth */
								"use strict";
								var defaults = {
									percentage: true
								};

								var $window = $(window),
									cache = [],
									scrollEventBound = false,
									lastPixelDepth = 0;

								/*
								 * Plugin
								 */

								$.scrollDepth = function(options) {

									var startTime = +new Date();

									options = $.extend({}, defaults, options);

									/*
									 * Functions
									 */

									function sendEvent(action, label, scrollDistance, timing) {

										var fieldsArray = {
											hitType       : 'event',
											eventCategory : 'Scroll Depth',
											eventAction   : action,
											eventLabel    : label,
											eventValue    : 1,
											nonInteraction: 1
										};

										if ( 'undefined' === typeof MonsterInsightsObject || 'undefined' === typeof MonsterInsightsObject.sendEvent ) {
											return;
										}

										MonsterInsightsObject.sendEvent( fieldsArray );
										if (arguments.length > 3) {
											fieldsArray = {
												hitType        : 'timing',
												timingCategory : 'Scroll Depth',
												timingVar      : action,
												timingValue    : timing,
												timingLabel    : label,
												nonInteraction: 1
											};
											MonsterInsightsObject.sendEvent( fieldsArray );
										}
									}

									function calculateMarks(docHeight) {
										return {
											'25%' : parseInt(docHeight * 0.25, 10),
											'50%' : parseInt(docHeight * 0.50, 10),
											'75%' : parseInt(docHeight * 0.75, 10),
											/* Cushion to trigger 100% event in iOS */
											'100%': docHeight - 5
										};
									}

									function checkMarks(marks, scrollDistance, timing) {
										/* Check each active mark */
										$.each(marks, function(key, val) {
											if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
												sendEvent('Percentage', key, scrollDistance, timing);
												cache.push(key);
											}
										});
									}

									function rounded(scrollDistance) {
										/* Returns String */
										return (Math.floor(scrollDistance/250) * 250).toString();
									}

									function init() {
										bindScrollDepth();
									}

									/*
									 * Public Methods
									 */

									/* Reset Scroll Depth with the originally initialized options */
									$.scrollDepth.reset = function() {
										cache = [];
										lastPixelDepth = 0;
										$window.off('scroll.scrollDepth');
										bindScrollDepth();
									};

									/* Add DOM elements to be tracked */
									$.scrollDepth.addElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.merge(options.elements, elems);

										/* If scroll event has been unbound from window, rebind */
										if (!scrollEventBound) {
											bindScrollDepth();
										}

									};

									/* Remove DOM elements currently tracked */
									$.scrollDepth.removeElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.each(elems, function(index, elem) {

											var inElementsArray = $.inArray(elem, options.elements);
											var inCacheArray = $.inArray(elem, cache);

											if (inElementsArray != -1) {
												options.elements.splice(inElementsArray, 1);
											}

											if (inCacheArray != -1) {
												cache.splice(inCacheArray, 1);
											}

										});

									};

									/*
									 * Throttle function borrowed from:
									 * Underscore.js 1.5.2
									 * http://underscorejs.org
									 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
									 * Underscore may be freely distributed under the MIT license.
									 */

									function throttle(func, wait) {
										var context, args, result;
										var timeout = null;
										var previous = 0;
										var later = function() {
											previous = new Date;
											timeout = null;
											result = func.apply(context, args);
										};
										return function() {
											var now = new Date;
											if (!previous) previous = now;
											var remaining = wait - (now - previous);
											context = this;
											args = arguments;
											if (remaining <= 0) {
												clearTimeout(timeout);
												timeout = null;
												previous = now;
												result = func.apply(context, args);
											} else if (!timeout) {
												timeout = setTimeout(later, remaining);
											}
											return result;
										};
									}

									/*
									 * Scroll Event
									 */

									function bindScrollDepth() {

										scrollEventBound = true;

										$window.on('scroll.scrollDepth', throttle(function() {
											/*
											 * We calculate document and window height on each scroll event to
											 * account for dynamic DOM changes.
											 */

											var docHeight = $(document).height(),
												winHeight = window.innerHeight ? window.innerHeight : $window.height(),
												scrollDistance = $window.scrollTop() + winHeight,

												/* Recalculate percentage marks */
												marks = calculateMarks(docHeight),

												/* Timing */
												timing = +new Date - startTime;

											checkMarks(marks, scrollDistance, timing);
										}, 500));

									}

									init();
								};

								/* UMD export */
								return $.scrollDepth;

							}));

							jQuery.scrollDepth();
						} else {
							setTimeout(monsterinsights_scroll_tracking_load, 200);
						}
					}
					monsterinsights_scroll_tracking_load();
				});
			}
		/* End MonsterInsights Scroll Tracking */
		
</script><script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/hoverIntent.min.js?ver=1.10.2' id='hoverIntent-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.min.js?ver=1.7.5' id='superfish-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.args.min.js?ver=2.7.1' id='superfish-args-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/skip-links.min.js?ver=2.7.1' id='skip-links-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/theme.js?ver=1.1.0' id='sucuriblog-theme-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky.js?ver=1.0.4' id='sucuriblog-sticky-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky-init.js?ver=1.0.1' id='sucuriblog-sticky-js-init-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/cookie-banner.js?ver=20200914' id='cookie-banner-js-js'></script>
</body></html>
