<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: The ZeroAccess money-generating campaign</title>
<meta name="description" content="ZeroAccess has evolved steadily in recent years, taking control of millions of compromised computers around the world. Chao Chen and Kyle Yang take a look at three of the ways in which it generates income: browser redirection, click fraud and Bitcoin mining." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 1830;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/remo_expand/blocks/remo_expand/templates/vbexpand/view.css" />
<script type="text/javascript" src="/packages/remo_expand/js/jquery.color.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/remo.expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<div class="titlepage" xmlns=""><div><div><h1 class="title" xmlns="http://www.w3.org/1999/xhtml"><a id="vb201308-ZeroAccess"></a>The ZeroAccess money-generating campaign</h1></div><div><p class="pubdate" xmlns="http://www.w3.org/1999/xhtml">2013-08-01</p></div><div><div class="authorgroup" xmlns="http://www.w3.org/1999/xhtml"><div class="author titlepage"><h3 class="author"><span class="surname">Chao Chen</span></h3><span class="orgname">Fortinet</span>, <span class="orgdiv">China</span></div><div class="author titlepage"><h3 class="author"><span class="firstname">Kyle</span> <span class="surname">Yang</span></h3><span class="orgname">Fortinet</span>, <span class="orgdiv">Canada</span></div><b class="editedby">Editor: </b><span class="editor"><span class="firstname">Helen</span> <span class="surname">Martin</span></span></div></div><div><div class="abstract" xmlns="http://www.w3.org/1999/xhtml"><p class="title"><b>Abstract</b></p><p>ZeroAccess has evolved steadily in recent years, taking control of millions of compromised computers around the world. Chao Chen and Kyle Yang take a look at three of the ways in which it generates income: browser redirection, click fraud and Bitcoin mining. </p></div></div><div><p class="copyright" xmlns="http://www.w3.org/1999/xhtml"><i>Copyright &copy; 2013 Virus Bulletin</i></p></div></div><hr /></div>
<div class="ccm-remo-expand">
<div id="ccm-remo-expand-title-2926" class="ccm-remo-expand-title ccm-remo-expand-closed" data-expander-speed="200">Table of contents</div><div id="ccm-remo-expand-content-2926" class="ccm-remo-expand-content"><div class="toc"><dl><dt><span class="sect1"><a href="#id2305440"></a></span></dt><dt><span class="sect1"><a href="#id4712887">Install and load</a></span></dt><dt><span class="sect1"><a href="#id4514468">Redirection working mechanism</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2083008">Components for redirection</a></span></dt><dt><span class="sect2"><a href="#id2954015">Case study and analysis</a></span></dt><dt><span class="sect2"><a href="#id3661290">Redirection with given referrer</a></span></dt><dt><span class="sect2"><a href="#id4898650">Open random pages at random times</a></span></dt><dt><span class="sect2"><a href="#id3286566">Injecting JavaScript into pages</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id2487744">Click fraud working mechanism</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id4145839">Targeting advertising services</a></span></dt><dt><span class="sect2"><a href="#id4819452">Case study and analysis</a></span></dt><dt><span class="sect2"><a href="#id2779032">Open ad redirection URL with given referrer</a></span></dt><dt><span class="sect2"><a href="#id4791908">Click on page</a></span></dt><dt><span class="sect2"><a href="#id4346233">Handling video and audio</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id3837301">Bitcoin mining</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id3027536">Retrieve Bitcoin miner program</a></span></dt><dt><span class="sect2"><a href="#id4112207">Inject Bitcoin miner</a></span></dt><dt><span class="sect2"><a href="#id3724185">Start mining</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id3854853">Conclusion</a></span></dt></dl></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id2305440"></a></h2></div></div></div><p>ZeroAccess has evolved steadily in recent years, and today it is one of the top threats to the security of individuals and corporations. With innovative methods of injection and effective protection provided by its rootkit, ZeroAccess has taken control of millions of compromised computers around the world. Based on its large peer to peer infrastructure and a complicated mechanism consisting of servers for bot control and browser redirection, ZeroAccess has launched a campaign for gaining money through browser redirection, click fraud and Bitcoin mining [<span class="citation"><a href="#citation.1">1</a></span>]. In this article, we will focus on a module that plays the combined role of redirecting and clicking, as well as starting a Bitcoin miner on the infected machine. </p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4712887"></a>Install and load</h2></div></div></div><p>The ZeroAccess installer carries an encrypted list of IP addresses in the P2P network running on port 16471 [<span class="citation"><a href="#citation.2">2</a></span>]. The installer injects a dynamic-link library which serves as a loader for downloading and loading modules into the explorer.exe or services.exe process. All of the loaded modules are dynamic-link libraries &ndash; in this article we will focus on the one named &lsquo;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="073f373737373734352947">[email&#160;protected]</a>&rsquo;. </p><div class="figure"><a id="figure.1"></a><div class="mediaobject"><img alt="Loaded modules." src="/uploads/images/figures/2013/08/ZeroAccess-1.jpg" /></div><p class="title"><b>Figure&nbsp;1.&nbsp;Loaded modules.</b></p></div><p>This module implements three methods for gaining money. The first is to hijack web browser processes, intercepting keywords the user has searched for on major search engines, and eventually redirecting to various malicious websites. In return for bringing traffic and potential clients/victims, the owners of these malicious sites will pay referral fees to the ZeroAccess botnet herder. </p><p>The second method is to conduct click-fraud on advertising services through invisible browsers created on the compromised computers. A click-bot will simulate the behaviour of an ordinary user, opening web pages and clicking on them. By forging the referrer field of each HTTP GET command, ZeroAccess can obtain a share of the profit of the advertising service. </p><p>The third method is to run a Bitcoin miner which will make the compromised machine work hard to accumulate wealth for the botnet herder. </p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4514468"></a>Redirection working mechanism</h2></div></div></div><p>In this section we will discuss the architecture and implementation of the redirect-bot. Besides downloading plug-ins, the loader replaces the system library mswsock.dll with a dropped dynamic-link library named Desktop.ini, from which the WSPStartup API is hooked. The fake API will load the redirect-bot into the residing process and invoke the exported function with ordinal 1 &ndash; a unique ordinal number that other plug-in modules do not possess. This means that the redirect-bot can remain in all processes of running web browsers and act as a man-in-the-middle in an interactive game of redirection with the compromised user. The loading procedure of the redirect bot is shown in <a href="#figure.2">Figure 2</a>. </p><div class="figure"><a id="figure.2"></a><div class="mediaobject"><img alt="Loading the redirect-bot." src="/uploads/images/figures/2013/08/ZeroAccess-2.jpg" /></div><p class="title"><b>Figure&nbsp;2.&nbsp;Loading the redirect-bot.</b></p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id2083008"></a>Components for redirection</h3></div></div></div><p>Several components are deployed by the redirect-bot in order to redirect a user who is searching on search engines such as <span class="emphasis"><em>Google</em></span>, <span class="emphasis"><em>Bing</em></span>, <span class="emphasis"><em>Yahoo!</em></span>, <span class="emphasis"><em>Ask</em></span>, <span class="emphasis"><em>AOL</em></span> or <span class="emphasis"><em>ICQ</em></span>. The relationship among these components is illustrated in <a href="#figure.3">Figure 3</a>.</p><div class="figure"><a id="figure.3"></a><div class="mediaobject"><img alt="ZeroAccess&rsquo;s components for redirection (marked in blue)." src="/uploads/images/figures/2013/08/ZeroAccess-3.jpg" /></div><p class="title"><b>Figure&nbsp;3.&nbsp;ZeroAccess&rsquo;s components for redirection (marked in blue).</b></p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id2767972"></a>A pair of redirectors</h4></div></div></div><p>When the redirect-bot is loaded through its ordinal 1 exported function, it will check the command line of the residing process. If the residing process is a browser (<span class="emphasis"><em>Internet Explorer</em></span>, <span class="emphasis"><em>Firefox</em></span>, <span class="emphasis"><em>Google</em></span> <span class="emphasis"><em>Chrome</em></span>, <span class="emphasis"><em>Opera</em></span>, <span class="emphasis"><em>Safari</em></span>, etc.), it will get the entry of the WSPConnect API passed in as a parameter and hook it. Hooking WSPConnect gives the redirect-bot the capability to hijack every socket connection requested by the browser. For each socket on port 80 (HTTP) or port 443 (HTTPS), a pair of cooperating redirectors created by the redirect-bot will act as middlemen between the browser and the website. Redirector A is directly connected with the browser for monitoring all HTTP GET commands, while Redirector B is directly connected with the website for monitoring all HTTP responses. </p><p>Some essential components of the redirectors are described as follows: </p><div class="orderedlist"><ol type="1"><li><p>A function table which points to a group of callback functions executed at a series of important points within a redirector&rsquo;s life: the point at which a connection is established with a browser or a website, the point at which an HTTP packet is sent or received, and the point at which finalization work should be done. All of these callback functions are scheduled by an asynchronous communication mechanism that has been deployed by ZeroAccess since its early stages. </p></li><li><p>A socket used to communicate with the browser or website.</p></li><li><p>A buffer for sending and receiving data.</p></li><li><p>Pointers to each other so that Redirector A can use Redirector B&rsquo;s socket to send a packet to the website, while Redirector B can use Redirector A&rsquo;s socket to send a packet to the browser. </p></li><li><p>Redirector B, which connects directly to the website, has three buffers which are used to store HTTP packet header information: the complete URL, referrer and user-agent. A double word of Redirector B will record the CRC32 of the referrer in the header of an HTTP GET command sent from Redirector A to the website.</p></li></ol></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id2870331"></a>Communicator</h4></div></div></div><p>A kind of object, dubbed a Communicator, is used when either of the Redirectors need to send data to the C&amp;C server. </p><p>When Redirector A receives an HTTP GET command from the browser that represents a search request from a major search engine (such requests often contain the string &lsquo;&amp;p=&rsquo; or &lsquo;&amp;q=&rsquo; in the required URL), it will send information via a Communicator to tell the C&amp;C server the keyword and specific search engine used in the search request. In response, the C&amp;C server will send one or more lines back. Each line contains a redirection URL and a referrer. These redirection URL/referrer pairs will be stored by the Communicator in a local customized database table. </p><p>Redirector B also uses a Communicator to send information to the C&amp;C server, which may result in the browser opening random pages at random times, as described later. </p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id2657136"></a>Local database table</h4></div></div></div><p>As mentioned before, the redirection URL/referrer pairs received from the C&amp;C server are stored in a local database table. In fact, besides a redirection URL and a referrer, each entry in the table has another piece of data, which is a CRC32. When the compromised user searches for something on a major search engine other than Google, the CRC32 is generated by running an algorithm on the complete URL in the corresponding HTTP GET command. When the user searches using Google, the CRC32 is generated on the basis of the keyword.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id2478755"></a>Local keyword record file</h4></div></div></div><p>This file stores 10 keywords recently searched by the user.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id4045812"></a>Redirection servers</h4></div></div></div><p>The redirection URLs received from the C&amp;C server reveal the redirection servers of ZeroAccess. In most cases, several servers are involved in the process of redirecting to a malicious site. These servers enhance the flexibility of the redirection infrastructure and also make it more difficult to be traced or taken down.</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id2954015"></a>Case study and analysis</h3></div></div></div><p>Some examples of referrers and redirection URLs are shown in <a href="#table.1">Table 1</a>. </p><div class="table"><a id="table.1"></a><table border="1" summary="Example referrers and redirection URLs."><colgroup><col /><col /></colgroup><thead><tr><th align="center">Referrer</th><th align="center">Redirection URL</th></tr></thead><tbody><tr><td>http://phrasesearch.net/websearch.php?search=money&amp;BtnS=Search</td><td>http://217.23.3.223/AKy4XvnD7U3M4mo7b173f23d8811260c022f402cf1447c0a06k</td></tr><tr><td>http://searchbusinesslistings.net/websearch.php?search=bitcoin+mining&amp;BtnS=Search</td><td>http://195.3.145.109/ivl3nTiX7T4XjRc92aef0e712082736871dce2472a23dbde36A</td></tr><tr><td>http://searchbusinesslisting.com/websearch.php?search=Mining&amp;BtnS=Search</td><td>http://83.133.127.85/Lvn0w36x776xavS9cde097c02309e1b9edd50e71e6d776bf28c</td></tr><tr><td>http://businesslistingsearch.biz/websearch.php?search=money</td><td>http://217.23.3.223/5zV3fwXL5c4M1ZS516dd0a8f88396c40926c142fcd40907d26A</td></tr></tbody></table><p class="title"><b>Table&nbsp;1.&nbsp;Example referrers and redirection URLs.</b></p></div><p>Most of the referrer sites have a similar appearance (<a href="#figure.4">Figure 4</a>). Some of the links placed on the home page of these sites are fake and will not lead anywhere, while others will lead to a fake search engine which returns nothing on a search request. </p><div class="figure"><a id="figure.4"></a><div class="mediaobject"><img alt="Similar appearance of the referrer sites." src="/uploads/images/figures/2013/08/ZeroAccess-4.jpg" /></div><p class="title"><b>Figure&nbsp;4.&nbsp;Similar appearance of the referrer sites.</b></p></div><p>During our observation, most redirection URLs eventually led to malicious websites containing malware or to pornographic sites. In the event that the redirection servers fail to find a malicious or pornographic site to direct to, the browser is redirected to www.google.com/webhp. </p><p>In the latest version of this module, the data received from the C&amp;C server is RC4 encrypted. The encryption/decryption key is a string which is the length of received data. For example, if the length of data received is 123 bytes, the decryption key will be the string &lsquo;123&rsquo;. </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id3661290"></a>Redirection with given referrer</h3></div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id2978518"></a>Case 1: Redirecting for search engines other than Google </h4></div></div></div><p>When a user searches using a major search engine other than <span class="emphasis"><em>Google</em></span>, an HTTP GET command is sent to Redirector A from the browser, and Redirector A will report the keyword and search engine name to the C&amp;C server through a Communicator. The redirection URL and referrer returned by the C&amp;C server will be stored in the local database table, along with the CRC32 of the complete URL in the HTTP GET command header. </p><p>After a while, the user clicks a hyperlink from the search result page and a second GET command is sent through a new socket for which another pair of redirectors is ready to work. When Redirector B receives the HTTP response packet from the website associated with the link clicked by the user, instead of passing the packet to browser, it will check whether an entry with the CRC32 of the second GET command&rsquo;s referrer exists in the database table. Of course it will succeed because the CRC32 has been stored with a redirection URL/referrer pair when processing the first GET command. It is time for redirection now, and the procedure is as follows: </p><div class="itemizedlist"><ul type="disc"><li><p>Step 1: Redirector B forges an HTTP response, causing the browser to navigate to the URL http://{host}/_ylt=3648C868A1DB;{base64_encoded_referrer}-{base64_encoded_url}. Here, {host} is the domain name of the redirection URL, &lsquo;/_ylt=3648C868A1DB;&rsquo; is a special mark, followed by the base64-encoded referrer and redirection URL separated by a &lsquo;-&rsquo; character.</p></li><li><p>Step 2: When the browser sends a GET command for visiting the forged URL, Redirector A will recognize the special mark and send back to the browser another forged HTTP response containing HTML script:</p><pre class="programlisting">&lt;script&gt;location.replace(&lsquo;http://{referrer}&rsquo;);
&lt;/script&gt;
</pre><p>Here, {referrer} is the referrer obtained from the C&amp;C server.</p></li><li><p>Step 3: When the browser sends another GET command for visiting http://{referrer}, Redirector A will recognize the special mark in the referrer of the GET command and forge yet another HTTP response containing HTML script:</p><pre class="programlisting">&lt;script&gt;location.replace(&lsquo;http://{url}&rsquo;);&lt;/script&gt;</pre><p>Here, {url} is the redirection URL obtained from the C&amp;C server.</p></li></ul></div><p>The browser will now send the crucial HTTP GET command whose URL and referrer are set as those given by the C&amp;C server. A page that is not genuinely wanted by the user will be displayed in the browser.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id3546545"></a>Case 2: Redirecting Google Ad links</h4></div></div></div><p>When a compromised user searches on <span class="emphasis"><em>Google</em></span>, new entries will be added into the local database table. A minor difference is that the CRC32 in an entry is generated on the basis of the keyword searched, rather than the URL. When a <span class="emphasis"><em>Google Ads</em></span> link is clicked on, Redirector A will query the database table for the keyword contained in the link. If a matching entry is found, Redirector A will forge an HTTP response navigating the browser to http://{host}/_ylt=3648C868A1DB;{base64_encoded_referrer}-{base64_encoded_url} and follow the same steps as described above.</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4898650"></a>Open random pages at random times</h3></div></div></div><p>When a browser is navigating from one site to another, Redirector B will send information via a Communicator to the C&amp;C server. The information includes the URL and referrer in the HTTP GET command Redirector A received from the browser and the 10 most recently searched keywords stored in the local keyword record file. The response from the C&amp;C server, if any, should contain some redirection URL/referrer pairs. For each pair, the Communicator makes a redirection by forging a special URL: http://{host}/_ylt=3648C868A1DB;{base64_encoded_referrer}-{base64_encoded_url} and asking the browser to open it. The length of time between two redirections is set as a random value.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id3286566"></a>Injecting JavaScript into pages</h3></div></div></div><p>Besides the annoying redirection discussed above, the redirect-bot will also inject web pages with a piece of JavaScript, as shown in <a href="#figure.5">Figure 5</a>. In the earlier versions of this module, the script was encrypted and hard-coded in the module. By comparison, new versions will retrieve the script from the C&amp;C server.</p><div class="figure"><a id="figure.5"></a><div class="mediaobject"><img alt="Injected JavaScript." src="/uploads/images/figures/2013/08/ZeroAccess-5.jpg" /></div><p class="title"><b>Figure&nbsp;5.&nbsp;Injected JavaScript.</b></p></div><p>This script will download several JavaScript files which were originally deployed by the advertising and content delivery services owned by companies such as <span class="emphasis"><em>Admedia</em></span>, <span class="emphasis"><em>Akamai</em></span> and <span class="emphasis"><em>CpcHero</em></span>. When the downloaded scripts are executed, random advertisements will appear on each page and several words will be highlighted with green double underlines that link to a site called &lsquo;sonicsearchonline.biz&rsquo;, which is a search site with very limited function. The INCL_checkinternals() function in the injected JavaScript specifies some &lsquo;internal&rsquo; sites where the injected JavaScript will do nothing. Ironically, when comparing sonicsearchonline.biz with two internal sites, search.runclips.com and search.searchnowdirect.com, we find that they are all mapped to the same IP address (174.137.155.137). The crude and simple home page is shown in <a href="#figure.6">Figure 6</a>. </p><div class="figure"><a id="figure.6"></a><div class="mediaobject"><img alt="A crude search site working for ZeroAccess." src="/uploads/images/figures/2013/08/ZeroAccess-6.jpg" /></div><p class="title"><b>Figure&nbsp;6.&nbsp;A crude search site working for ZeroAccess.</b></p></div><p>Obviously the three search sites are owned by the gang behind ZeroAccess. When a user redirected to sonicsearchonline.biz searches for something on it, a results page will be displayed &ndash; however, only a few entries are shown and there is not even a &lsquo;next page&rsquo; button. It seems that only the most commonly viewed entries retrieved when searching on a major search engine are shown here. If the user clicks on a link from the disguised search result page and navigates to a page owned by an advertiser, the advertiser pays a referral fee to sonicsearchonline.biz. </p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id2487744"></a>Click fraud working mechanism</h2></div></div></div><p>In this section, we will look at how the module acts as a &lsquo;click bot&rsquo; [<span class="citation"><a href="#citation.3">3</a></span>] to conduct click-fraud using invisible home made browsers. When a module has been downloaded on a compromised computer, the loader will invoke the module&rsquo;s exported function with ordinal 2. When the exported function with ordinal 2 is called by the loader, the click-bot will inject a copy of itself into an svchost.exe process with the parameter &lsquo;-k LocalServiceDns&rsquo; in the command line and call the injected module&rsquo;s exported function with ordinal 1. The render mode of IE8 is set for svchost.exe by setting register value &lsquo;HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BROWSER_EMULATION\svchost.exe&rsquo; as 8000. In addition, a copy of <span class="emphasis"><em>Adobe Flash Player </em></span>will be downloaded from fpdownload.macromedia.com and installed if the existing version of <span class="emphasis"><em>Flash Player </em></span>on the compromised machine is too old.</p><div class="figure"><a id="figure.7"></a><div class="mediaobject"><img alt="Start up of the click-bot." src="/uploads/images/figures/2013/08/ZeroAccess-7.jpg" /></div><p class="title"><b>Figure&nbsp;7.&nbsp;Start up of the click-bot.</b></p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4145839"></a>Targeting advertising services</h3></div></div></div><p>In the injected svchost.exe process, the click-bot will get ad redirection URLs and referrers from the C&amp;C server to conduct click-fraud. The ad redirection URLs will lead to publisher sites belonging to various advertising services. The fake sites used as referrers are owned by the gang behind ZeroAccess. The click-bot will visit the publisher sites with forged referrers and click on pages automatically, navigating to the landing pages where the advertisers will pay a fee according to a pay-per-click business model. As the referrers that have led users to the publisher sites, the fake sites owned by the cybercriminals will gain a share of the advertising service profit. </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4819452"></a>Case study and analysis</h3></div></div></div><p>Some examples of referrers and ad redirection URLs are shown in <a href="#table.2">Table 2</a>:</p><div class="table"><a id="table.2"></a><table border="1" summary="Example referrers and ad redirection URLs."><colgroup><col /><col /></colgroup><thead><tr><th align="center">Referrer</th><th align="center">Ad redirection URL</th></tr></thead><tbody><tr><td>http://excellent-information.info/search</td><td>http://195.138.241.94/td?aid=6uwa7a4w&amp;said=302904</td></tr><tr><td>http://myownfind.info/search</td><td>http://76.73.80.106/td?aid=6uwa7a4w&amp;said=305006</td></tr><tr><td>http://trustsearchsite.info/search</td><td>http://31.171.128.73/td?aid=6uwa7a4w&amp;said=302904</td></tr><tr><td>http://myown-search.info/search</td><td>http://195.138.241.94/td?aid=6uwa7a4w&amp;said=305006</td></tr></tbody></table><p class="title"><b>Table&nbsp;2.&nbsp;Example referrers and ad redirection URLs.</b></p></div><p>Almost every fake website used by the click-bot as a referrer disguises itself as a search engine. But when you try to search for something, it will not redirect you to a result page. Clearly, these fake search sites are created only for serving as the referrers in the business of click fraud.</p><div class="figure"><a id="figure.8"></a><div class="mediaobject"><img alt="Fake search sites serving as referrers." src="/uploads/images/figures/2013/08/ZeroAccess-8.jpg" /></div><p class="title"><b>Figure&nbsp;8.&nbsp;Fake search sites serving as referrers.</b></p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id2779032"></a>Open ad redirection URL with given referrer</h3></div></div></div><p>Now let us have a closer look at how the click-bot loads an ad redirection URL with a given referrer in an invisible browser. <a href="#figure.9">Figure 9</a> shows the procedure.</p><div class="figure"><a id="figure.9"></a><div class="mediaobject"><img alt="Procedure of loading an ad redirection URL." src="/uploads/images/figures/2013/08/ZeroAccess-9.jpg" /></div><p class="title"><b>Figure&nbsp;9.&nbsp;Procedure of loading an ad redirection URL.</b></p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id3635082"></a>Step 1: Send 406h message</h4></div></div></div><p>In the injected svchost.exe process, the click-bot will register a Manager Window which will keep running in a loop, handling messages sent by the main thread of the click-bot. The main thread will also create a Communicator object which will communicate with the C&amp;C server to get several ad redirection URL/referrer pairs. For each ad redirection URL and referrer pair, the Communicator will send a 406h message to the Manager Window, with the ad redirection URL and referrer as parameters. </p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id4372530"></a>Step 2: Create an invisible browser object</h4></div></div></div><p>When a 406h message is received by the Manager Window, an object we call Click Controller is created for the ad redirection URL and referrer associated with the message. The Click Controller contains the following essential elements:</p><div class="orderedlist"><ol type="1"><li><p>Pointers to IWebBrowser2 and IHTMLDocument2 of an invisible browser. </p></li><li><p>Interfaces used for displaying and controlling MSHTML documents in the invisible browser:</p><div class="itemizedlist"><ul type="disc"><li><p>DWebBrowserEvents2</p></li><li><p>IServiceProvider</p></li><li><p>IOleClientSite</p></li><li><p>IOleInPlaceSite</p></li><li><p>IOleInPlaceFrame</p></li><li><p>IOleInPlaceUIWindow</p></li><li><p>IOleWindow</p></li><li><p>IDocHostUIHandler</p></li><li><p>IDocHostShowUI</p></li><li><p>IHostDialogHelper</p></li><li><p>INewWindowManager</p></li><li><p>HttpSecurity</p></li><li><p>IInternetSecurityManager</p></li><li><p>IOleCommandTarget</p></li><li></li></ul></div></li><li><p>The handle of the container window of the invisible browser.</p></li><li><p>A pointer to a buffer storing the domain name of a website.</p></li><li><p>Flink and Blink pointers that link together all Click Controller objects in a double-linked list.</p></li><li><p>The maximum number of clicks that can be made on a single page.</p></li><li><p>The time point when the object should be released.</p></li><li><p>The time point before which the next click on a single page should not be made.</p></li><li><p>The maximum number of attempts to find a qualified element on a page for the next click.</p></li><li><p>Parameters for randomizing the behaviour of the invisible browser. These parameters define the possibilities for the browser to take some actions such as scrolling on a web page, clicking on a child window of the current page window, clicking on a link to a website other than the one being viewed, etc.</p></li></ol></div><p>A browser object without a visible user interface is created by calling the CoCreateInstance API, and the DWebBrowserEvents2 interface is implemented by the Click Controller by calling the AtlAdvise API. </p><p>The IOleObject::SetClientSite method is called, setting the client site of the browser as an object implemented by the Click Controller. Through this object, the click-bot can set the frame and document window of the invisible browser to be the rectangle representing the monitor screen. </p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id2812336"></a>Step 3: Load ad redirection URL with fraud referrer</h4></div></div></div><p>A URL moniker is created with the ad redirection URL, then the IPersistMoniker::Load method is called to load the ad redirection URL into the invisible browser. Executing this method enables the browser to be guided by ad redirection servers and finally to arrive at an ad publisher site. </p><div class="figure"><a id="figure.10"></a><div class="mediaobject"><img alt="Load ad redirection URL." src="/uploads/images/figures/2013/08/ZeroAccess-10.jpg" /></div><p class="title"><b>Figure&nbsp;10.&nbsp;Load ad redirection URL.</b></p></div><p>To set the referrer field in an HTTP GET command, the string key &lsquo;__DWNBINDINFO&rsquo; of the bind context used as a parameter of IPersistMoniker::Load is associated with an object that implements the BeginningTransaction method of the IHttpNegotiate interface. In this method the referrer given by the C&amp;C server is placed in the header of an HTTP GET command. </p><div class="figure"><a id="figure.11"></a><div class="mediaobject"><img alt="Set referrer of HTTP GET command." src="/uploads/images/figures/2013/08/ZeroAccess-11.jpg" /></div><p class="title"><b>Figure&nbsp;11.&nbsp;Set referrer of HTTP GET command.</b></p></div><p>An example of the traffic generated by executing IPersistMoniker::Load is shown in <a href="#figure.12">Figure 12</a>. </p><div class="figure"><a id="figure.12"></a><div class="mediaobject"><img alt="Loading an ad redirection URL." src="/uploads/images/figures/2013/08/ZeroAccess-12.jpg" /></div><p class="title"><b>Figure&nbsp;12.&nbsp;Loading an ad redirection URL.</b></p></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id4595405"></a>Step 4: Get container window and check website domain</h4></div></div></div><p>When a publisher site is eventually arrived at, a NavigateComplete2 event fires, invoking the IOleWindow::GetWindow method where the click-bot gets the container window of the browser. Some randomly chosen links and/or child windows in this window will be clicked later.</p><div class="figure"><a id="figure.13"></a><div class="mediaobject"><img alt="Get container window." src="/uploads/images/figures/2013/08/ZeroAccess-13.jpg" /></div><p class="title"><b>Figure&nbsp;13.&nbsp;Get container window.</b></p></div><p>Then the Click Controller will check where it has arrived. If it finds that it has arrived at Facebook.com or Google.com, it will stop performing click-fraud and release the corresponding browser object along with owned resources and interfaces. </p><p>If the Click Controller finds that it has arrived at a website included in the list below, it will never scroll on the page before choosing a random element to click: </p><div class="itemizedlist"><ul type="disc"><li><p>hollyscoop.com</p></li><li><p>thirdage.com</p></li><li><p>gourmandia.com</p></li><li><p>videobash.com</p></li><li><p>egotv.com</p></li><li><p>mevio.com</p></li><li><p>eyehandy.com</p></li><li><p>dailymotion.com</p></li><li><p>37millionminutes.com</p></li><li><p>celebrityhearsay.com</p></li><li><p>clevercoinsonline.com </p></li><li><p>wellhabits.com</p></li><li><p>brilliantriches.com</p></li><li><p>sciencenewsstories.com</p></li><li><p>exerciseglobe.com</p></li><li><p>hark.com</p></li><li><p>clevershares.com</p></li><li><p>mommymixing.com</p></li><li><p>driverswhoknow.com</p></li><li><p>iamcatwalk.com</p></li><li><p>wellentertainment.com</p></li><li><p>moneyforgenius.com</p></li><li><p>modamob.com</p></li><li><p>eatstaydrink.com</p></li><li><p>stereotube.com</p></li><li><p>onlinejournal.com</p></li><li><p>filmamexarticles.com</p></li></ul></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4791908"></a>Click on page</h3></div></div></div><p>When the Manager Window is created, it creates a timer. The timer is set for every second. As response to the WM_TIMER message, every invisible browser object that has loaded an ad redirection URL with a given referrer will choose and click on an element from the page it contains. The procedure is as follows:</p><div class="figure"><a id="figure.14"></a><div class="mediaobject"><img alt="Procedure for clicking an element on the page." src="/uploads/images/figures/2013/08/ZeroAccess-14.jpg" /></div><p class="title"><b>Figure&nbsp;14.&nbsp;Procedure for clicking an element on the page.</b></p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id4431411"></a>Step 1: Send WM_TIMER</h4></div></div></div><p>A WM_TIMER message is sent to the Manager Window.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id4447808"></a>Step 2: Notify invisible browsers</h4></div></div></div><p>The Manager Window notifies each invisible browser object to make a click.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id2452528"></a>Step 3: Click an element on page</h4></div></div></div><p>Each invisible browser object will try many times until it finds an effective target to click on. At the beginning of each attempt, a hyperlink or a child window with the tag name &lsquo;object&rsquo;, &lsquo;iframe&rsquo; or &lsquo;embed&rsquo; is chosen by a randomly generated coordinate. Three kinds of hyperlinks are excluded:</p><div class="orderedlist"><ol type="1"><li><p>Any hyperlink containing a string shown in the following list:</p><div class="itemizedlist"><ul type="disc"><li><p>/register</p></li><li><p>/contact</p></li><li><p>registration</p></li><li><p>/Forgotpassword</p></li><li><p>/faq</p></li><li><p>/flagcontent</p></li><li><p>/tweet</p></li><li><p>mailto:</p></li><li><p>action=embed-flash</p></li><li><p>/login</p></li><li><p>/password</p></li><li><p>/terms</p></li></ul></div></li><li><p>Any hyperlink containing the character &lsquo;#&rsquo;, such as &lt;a href=&ldquo;#object-name&rdquo;&gt;name&lt;/a&gt;, which is a pointer to another id or name tag on the same page.</p></li><li><p>Any hyperlink pointing to a jpg image.</p></li></ol></div><p>If a matching element is found, the click-bot will click on it.</p><div class="figure"><a id="figure.15"></a><div class="mediaobject"><img alt="Click an element on the page." src="/uploads/images/figures/2013/08/ZeroAccess-15.jpg" /></div><p class="title"><b>Figure&nbsp;15.&nbsp;Click an element on the page.</b></p></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id3374132"></a>Step 4: Set referrer when opening a pop-up window</h4></div></div></div><p>In the INewWindowManager::EvaluateNewWindow method, the click-bot loads the URL corresponding with the clicked element in the same way as it loads an ad redirection URL. This time the referrer is set to the URL of the current document. Therefore the referrer given by the C&amp;C server can be spread when the browser navigates from one site to another through the fraudulent clicks.</p><div class="figure"><a id="figure.16"></a><div class="mediaobject"><img alt="Spreading of referrer (marked in yellow)." src="/uploads/images/figures/2013/08/ZeroAccess-16.jpg" /></div><p class="title"><b>Figure&nbsp;16.&nbsp;Spreading of referrer (marked in yellow).</b></p></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4346233"></a>Handling video and audio</h3></div></div></div><p>The click-bot&rsquo;s mechanism for handling the video and audio on pages is fulfilled by hooking three APIs: WSPSend, WSPRecv and WSPCloseSocket. On receipt of an HTTP packet whose Content-Type is audio, the click-bot will shut down the socket associated with it. The click-bot will allow a browser to receive a video whose size is less than a given threshold. The socket associated with the video will be shut down once the size of data received has exceeded the given threshold. It should be noted that the threshold is 512KB in ordinary cases, but 15MB for videos related to the following advertising services:</p><div class="itemizedlist"><ul type="disc"><li><p>alphabird.com</p></li><li><p>adap.tv</p></li><li><p>oggifinogi.com</p></li><li><p>/tv2n/</p></li><li><p>tidaltv.com</p></li><li><p>innovid.com</p></li><li><p>rovion.com</p></li><li><p>liverail.com</p></li><li><p>vastvpaidshim.swf</p></li><li><p>realmedia.com</p></li><li><p>audiencetv</p></li><li><p>videoegg.com</p></li><li><p>cvads.cvcdn</p></li><li><p>spotxchange.com</p></li><li><p>ads/</p></li><li><p>mixpo.com</p></li><li><p>preroll</p></li><li><p>gorillanation.com</p></li><li><p>[IMPORT]</p></li><li><p>aim4media.com</p></li><li><p>pointroll</p></li><li><p>fwmrm.net</p></li><li><p>yumenetworks.com</p></li><li><p>edgesuite.com</p></li><li><p>tremormedia.com</p></li><li><p>youtube.</p></li></ul></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3837301"></a>Bitcoin mining</h2></div></div></div><p>Mining Bitcoins involves lots of calculations for generating SHA256 hashes. In order to perform such a tough task, ZeroAccess utilizes the infected machines in a mining pool controlled by its pool server.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id3027536"></a>Retrieve Bitcoin miner program</h3></div></div></div><p>To perform the Bitcoin mining, another module named &lsquo;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="75454545454545454d5b35">[email&#160;protected]</a>&rsquo; is needed. This is a PE file containing only resources. The resource with name &lsquo;#1&rsquo; and type &lsquo;#10&rsquo; is a modified copy of <span class="emphasis"><em>Ufasoft Bitcoin Miner </em></span>[<span class="citation"><a href="#citation.4">4</a></span>].</p><div class="figure"><a id="figure.17"></a><div class="mediaobject"><img alt="Bitcoin miner in resource of 00000008.@." src="/uploads/images/figures/2013/08/ZeroAccess-17.jpg" /></div><p class="title"><b>Figure&nbsp;17.&nbsp;Bitcoin miner in resource of <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3e0e0e0e0e0e0e0e06107e10">[email&#160;protected]</a></b></p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4112207"></a>Inject Bitcoin miner</h3></div></div></div><p>The bot module will inject the miner into an svchost.exe process, with the following command line: </p><pre class="programlisting"> &ldquo;C:\WINDOWS\System32\svchost.exe&rdquo; -g no -t %u -o http://ooyohrmebh9qfof.com/ -u %s -p %s</pre><p>The meaning of the parameters is as follows:</p><div class="itemizedlist"><ul type="disc"><li><p>-g no: do not use GPU for calculating hashes of blocks used in Bitcoin transactions</p></li><li><p>-t %u: number of threads used by the Bitcoin miner</p></li><li><p>-o http://ooyohrmebh9qfof.com/: address of the pool server which controls the bots joining the same mining pool</p></li><li><p>-u %s -p %s: randomly generated user name and password of a bot joining the mining pool.</p></li></ul></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id3724185"></a>Start mining</h3></div></div></div><p>The copy of the UPX packed <span class="emphasis"><em>Ufasoft Bitcoin Miner</em></span> is modified by setting the RVA of the entry point to zero in the PE header. In fact, this RVA is just stolen and placed in an area adjacent to where it is supposed to be. </p><div class="figure"><a id="figure.18"></a><div class="mediaobject"><img alt="RVA of miner&rsquo;s entry point (marked in red)." src="/uploads/images/figures/2013/08/ZeroAccess-18.jpg" /></div><p class="title"><b>Figure&nbsp;18.&nbsp;RVA of miner&rsquo;s entry point (marked in red).</b></p></div><p>The entry point of the Bitcoin miner will be recovered by the bot module at run time.</p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3854853"></a>Conclusion</h2></div></div></div><p>ZeroAccess has established an extensive underground service not only for its own use but also for the malicious sites that pay the gang behind ZeroAccess. While the browser redirections are annoying for end-users, the click fraud causes great economic losses for the advertising services. By exploiting the infected machines for Bitcoin mining, the ZeroAccess herder can accumulate enormous wealth with ease. In light of the fast spread and continuous evolution of ZeroAccess, we must assume that the battle against it has only just begun.</p><div class="bibliography"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4549180"></a>Bibliography</h3></div></div></div><div class="bibliomixed"><a id="citation.1"></a><p class="bibliomixed">[1] Wyke, J. The ZeroAccess Botnet &ndash; Mining and Fraud for Massive Financial Gain. <span class="bibliosource"><a href="https://www.sophos.com/en-us/medialibrary/PDFs/technical papers/Sophos_ZeroAccess_Botnet.pdf" target="_blank">http://www.sophos.com/en-us/medialibrary/PDFs/technical%20papers/Sophos_ZeroAccess_Botnet.pdf</a></span>. </p></div><div class="bibliomixed"><a id="citation.2"></a><p class="bibliomixed">[2] Tan, N.; Yang, K. ZAccess detailed analysis. Virus Bulletin, August 2012, p.4. <span class="bibliosource"><a href="/virusbulletin/2012/08/zaccess-detailed-analysis
" target="_top">http://www.virusbtn.com/virusbulletin/archive/2012/08/vb201208-ZAccess</a></span>. </p></div><div class="bibliomixed"><a id="citation.3"></a><p class="bibliomixed">[3] Daswani, N.; Stoppelman, M.; and the Google Click Quality and Security Teams. The Anatomy of Click bot.A. <span class="bibliosource"><a href="http://static.usenix.org/events/hotbots07/tech/full_papers/daswani/daswani.pdf" target="_blank">http://static.usenix.org/events/hotbots07/tech/full_papers/daswani/daswani.pdf</a></span>.</p></div><div class="bibliomixed"><a id="citation.4"></a><p class="bibliomixed">[4] Ufasoft Bitcoin Miner. <span class="bibliosource"><a href="http://ufasoft.com/coin/" target="_blank">http://ufasoft.com/coin/</a></span>.</p></div></div></div> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=The ZeroAccess money-generating campaign&url=https://www.virusbulletin.com/virusbulletin/2013/08/zeroaccess-money-generating-campaign"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2013/08/zeroaccess-money-generating-campaign'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2013/08/zeroaccess-money-generating-campaign&title=The ZeroAccess money-generating campaign"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2013/08/zeroaccess-money-generating-campaign&t=The ZeroAccess money-generating campaign"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2013/08/zeroaccess-money-generating-campaign"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p></p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td></td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td></td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td></td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td></td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">1989-2022 Virus Bulletin.<a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a><a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a><a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>