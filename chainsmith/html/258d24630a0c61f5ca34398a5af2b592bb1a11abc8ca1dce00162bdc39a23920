<!DOCTYPE html>
<html lang="en-US">
<head >
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>How to Use Splunk with Sucuri Audit Trails</title>
<meta name='robots' content='max-image-preview:large' />

<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://mashshare.net -->
<meta property="og:type" content="article" /> 
<meta property="og:title" content="How to Use Splunk with Sucuri Audit Trails" />
<meta property="og:description" content="The Sucuri Firewall dashboard provides a rich set of API functions that can be used to control your firewall settings remotely. In addition, there is an API function to download your Audit Trails in JSON" />
<meta property="og:image" content="https://blog.sucuri.net/wp-content/uploads/2017/04/04252017-EN-using-free-splunk-with-sucuri-audit-tails_blog.jpg" />
<meta property="og:url" content="https://blog.sucuri.net/2017/04/using-free-splunk-with-sucuri-audit-trails.html" />
<meta property="og:site_name" content="Sucuri Blog" />
<meta property="article:publisher" content="https://www.facebook.com/SucuriSecurity/" />
<meta property="article:published_time" content="2017-04-25T10:56:43-07:00" />
<meta property="article:modified_time" content="2017-04-25T16:44:26-07:00" />
<meta property="og:updated_time" content="2017-04-25T16:44:26-07:00" />
<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://www.mashshare.net -->
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->
<meta property="og:image:width" content="745" />
<meta property="og:image:height" content="350" />
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="How to Use Splunk with Sucuri Audit Trails">
<meta name="twitter:description" content="The Sucuri Firewall dashboard provides a rich set of API functions that can be used to control your firewall settings remotely. In addition, there is an API function to download your Audit Trails in JSON">
<meta name="twitter:image" content="https://blog.sucuri.net/wp-content/uploads/2017/04/04252017-EN-using-free-splunk-with-sucuri-audit-tails_blog.jpg">
<meta name="twitter:site" content="@sucurisecurity">
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->


<!-- This site is optimized with the Yoast SEO Premium plugin v12.5 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Take your logs from the Sucuri Firewall and visualize the data with Splunk. Learn how to install Splunk and query historical data from the Sucuri Firewall."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://blog.sucuri.net/2017/04/using-free-splunk-with-sucuri-audit-trails.html" />
<!-- / Yoast SEO Premium plugin. -->

<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Feed" href="https://blog.sucuri.net/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Comments Feed" href="https://blog.sucuri.net/comments/feed" />
<!-- This site uses the Google Analytics by MonsterInsights plugin v7.10.0 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<script type="text/javascript" data-cfasync="false">
	var mi_version         = '7.10.0';
	var mi_track_user      = true;
	var mi_no_track_reason = '';
	
	var disableStr = 'ga-disable-UA-4077922-18';

	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}
	
	if ( mi_track_user ) {
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

		__gaTracker('create', 'UA-4077922-18', 'auto');
		__gaTracker('set', 'forceSSL', true);
		__gaTracker('require', 'displayfeatures');
		__gaTracker('send','pageview');
	} else {
		console.log( "" );
		(function() {
			/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
			var noopfn = function() {
				return null;
			};
			var noopnullfn = function() {
				return null;
			};
			var Tracker = function() {
				return null;
			};
			var p = Tracker.prototype;
			p.get = noopfn;
			p.set = noopfn;
			p.send = noopfn;
			var __gaTracker = function() {
				var len = arguments.length;
				if ( len === 0 ) {
					return;
				}
				var f = arguments[len-1];
				if ( typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function' ) {
					console.log( 'Not running function __gaTracker(' + arguments[0] + " ....) because you are not being tracked. " + mi_no_track_reason );
					return;
				}
				try {
					f.hitCallback();
				} catch (ex) {

				}
			};
			__gaTracker.create = function() {
				return new Tracker();
			};
			__gaTracker.getByName = noopnullfn;
			__gaTracker.getAll = function() {
				return [];
			};
			__gaTracker.remove = noopfn;
			window['__gaTracker'] = __gaTracker;
					})();
		}
</script>
<!-- / Google Analytics by MonsterInsights -->
<link rel='stylesheet' id='sucuri-blog-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/style.css?ver=1.2.0' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://blog.sucuri.net/wp-includes/css/dist/block-library/style.min.css?ver=6.0.1' type='text/css' media='all' />
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel='stylesheet' id='select2-css'  href='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.css?ver=4.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='mashsb-styles-css'  href='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/css/mashsb.min.css?ver=3.8.1' type='text/css' media='all' />
<style id='mashsb-styles-inline-css' type='text/css'>
.mashsb-count {color:#cccccc;}[class^="mashicon-"] .text, [class*=" mashicon-"] .text{
    text-indent: -9999px !important;
    line-height: 0px;
    display: block;
    } 
    [class^="mashicon-"] .text:after, [class*=" mashicon-"] .text:after {
        content: "" !important;
        text-indent: 0;
        font-size:13px;
        display: block !important;
    }
    [class^="mashicon-"], [class*=" mashicon-"] {
        width:25%;
        text-align: center !important;
    }
    [class^="mashicon-"] .icon:before, [class*=" mashicon-"] .icon:before {
        float:none;
        margin-right: 0;
    }
    .mashsb-buttons a{
       margin-right: 3px;
       margin-bottom:3px;
       min-width: 0;
       width: 41px;
    }
    .onoffswitch, 
    .onoffswitch-inner:before, 
    .onoffswitch-inner:after 
    .onoffswitch2,
    .onoffswitch2-inner:before, 
    .onoffswitch2-inner:after  {
        margin-right: 0px;
        width: 41px;
        line-height: 41px;
    }#mashbar-header .mashsb-count { 
    display:none; 
}
</style>
<link rel='stylesheet' id='sucuriblog-google-fonts-css'  href='//fonts.googleapis.com/css?family=Open+Sans:300,400,400italic,700,600' type='text/css' media='all' />
<link rel='stylesheet' id='cookie-banner-css-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/css/cookie-banner.css?ver=20200427' type='text/css' media='all' />
<script type='text/javascript' id='monsterinsights-frontend-script-js-extra'>
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[]","home_url":"https:\/\/blog.sucuri.net","hash_tracking":"false"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/google-analytics-premium/assets/js/frontend.min.js?ver=7.10.0' id='monsterinsights-frontend-script-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.js?ver=4.0.1' id='select2-js'></script>
<script type='text/javascript' id='mashsb-js-extra'>
/* <![CDATA[ */
var mashsb = {"shares":"583","round_shares":"1","animate_shares":"1","dynamic_buttons":"0","share_url":"https:\/\/blog.sucuri.net\/2017\/04\/using-free-splunk-with-sucuri-audit-trails.html","title":"How+to+Use+Splunk+with+Sucuri+Audit+Trails","image":"https:\/\/blog.sucuri.net\/wp-content\/uploads\/2017\/04\/04252017-EN-using-free-splunk-with-sucuri-audit-tails_blog.jpg","desc":"The Sucuri Firewall dashboard provides a rich set of API functions that can be used to control your firewall settings remotely. In addition, there is an API function to download your Audit Trails in JSON \u2026","hashtag":"@sucurisecurity","subscribe":"link","subscribe_url":"http:\/\/sucuri.hs-sites.com\/subscribe-to-security","activestatus":"1","singular":"1","twitter_popup":"1","refresh":"0","nonce":"c1b7e23fe8","postid":"19149","servertime":"1659523726","ajaxurl":"https:\/\/blog.sucuri.net\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/js/mashsb.min.js?ver=3.8.1' id='mashsb-js'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/html5shiv.min.js?ver=3.7.3' id='html5shiv-js'></script>
<![endif]-->
<link rel="https://api.w.org/" href="https://blog.sucuri.net/wp-json/" /><link rel="alternate" type="application/json" href="https://blog.sucuri.net/wp-json/wp/v2/posts/19149" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.sucuri.net/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.sucuri.net/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://blog.sucuri.net/?p=19149' />


<!-- This site is optimized with the Schema plugin v1.7.9.4 - https://schema.press -->
<script type="application/ld+json">{"@context":"https:\/\/schema.org\/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.sucuri.net\/2017\/04\/using-free-splunk-with-sucuri-audit-trails.html"},"url":"https:\/\/blog.sucuri.net\/2017\/04\/using-free-splunk-with-sucuri-audit-trails.html","headline":"How to Use Splunk with Sucuri Audit Trails","datePublished":"2017-04-25T10:56:43-07:00","dateModified":"2017-04-25T16:44:26-07:00","publisher":{"@type":"Organization","@id":"https:\/\/blog.sucuri.net\/#organization","name":"Sucuri Blog","logo":{"@type":"ImageObject","url":"","width":600,"height":60}},"image":{"@type":"ImageObject","url":"https:\/\/blog.sucuri.net\/wp-content\/uploads\/2017\/04\/04252017-EN-using-free-splunk-with-sucuri-audit-tails_blog.jpg","width":745,"height":350},"articleSection":"Security Education","keywords":"Best Practices, Command Line Tools, Sucuri Firewall","description":"The Sucuri Firewall dashboard provides a rich set of API functions that can be used to control your firewall settings remotely. In addition, there is an API function to download your Audit Trails in JSON format. The audit trail is a list of blocked requests that the firewall performed","author":{"@type":"Person","name":"Jon Watson","url":"https:\/\/blog.sucuri.net\/author\/jon-watson","description":"Jon Watson is a member of Sucuri's SOC Team who joined the company in 2016. Jon's main responsibilities include keeping the Sucuri WAF infrastructure running. His professional experience covers over 15 years of Linux sysadmin experience. When Jon isn't busy fighting fires or building new administration tools, you might find him writing blog posts about technology and remote work topics, or working on personal projects. Connect with Jon on Twitter","image":{"@type":"ImageObject","url":"https:\/\/secure.gravatar.com\/avatar\/7cc4039d00d3be3c3a93d8bad4e52046?s=96&d=mm&r=g","height":96,"width":96}}}</script>

<link rel="alternate" href="https://blog.sucuri.net/2017/04/using-free-splunk-with-sucuri-audit-trails.html" hreflang="en" /><link rel="alternate" href="https://blog.sucuri.net/espanol/2017/04/usando-splunk-gratuito-con-los-registros-de-auditoria-de-sucuri.html" hreflang="es" /><link rel="alternate" href="https://blog.sucuri.net/portugues/2017/04/como-usar-splunk-com-os-registros-de-auditoria-da-sucuri.html" hreflang="pt" /><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-4077922-18', 'auto');
  ga('require', 'linker');
  ga('linker:autoLink', ['ddecode.com', 'unmaskparasites.com', 'urlfind.org']);
  ga('send', 'pageview');
</script>

<script type="text/javascript">
(function(a,b,c,d,e,f,g){e['ire_o']=c;e[c]=e[c]||function(){(e[c].a=e[c].a||[]).push(arguments)};f=d.createElement(b);g=d.getElementsByTagName(b)[0];f.async=1;f.src=a;g.parentNode.insertBefore(f,g);})('//d.impactradius-event.com/A166802-5dda-4f98-aad8-1f58dbc8f1771.js','script','ire',document,window);
</script>
<script type='text/javascript'>/*<![CDATA[*/(function(n,d,c){d.setTime(d.getTime()+2592000000);c=(new RegExp('[?&]'+n+'=([^&#]*)','i')).exec(window.location.search);if(c=c?c[1]:null)document.cookie=n+'='+c+';expires='+d.toUTCString()+';domain=.sucuri.net;path=/';})('cjevent',new Date());/*]]>*/</script><!-- Tealium Universal Tag --><script type="text/javascript">(function(a,b,c,d){a='//tags.tiqcdn.com/utag/gpl/sucuri/prod/utag.js';b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a)})();</script><link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#menu-item-17506{ background-color: #619f42;}
#menu-item-17506:hover {background-color:#478237}
#menu-item-17506 > a { color:#fff;}
.nav-primary {
 width: 80%;
}

.genesis-nav-menu {
 display:table;
}

.genesis-nav-menu .menu-item {
 float:none;
 display:table-cell;
 text-align:center;
 vertical-align:top;
}

.text-right {
 text-align:right !important;
}

.genesis-nav-menu .languages-sub-menu a {
 margin-right:0;
}

/* Blog Background Green Color Replace*/
#menu-item-17506 { background-color: #008673!important; }
.home.archive-post-grid .archive-featured-post:first-of-type { border-top: 8px solid #008673!important; }
.button { background-color: #008673!important; }
#sidebar-cta .widget { background-color: #008673!important; }
.fwp-load-more:focus, .fwp-load-more:hover, .load-more:focus, .load-more:hover {
    background-color: #008673!important;
}
.social-icons a::before {
    background-color: #008673!important;
}
.footer-widgets .social-icons a:focus::before, .footer-widgets .social-icons a:hover::before, .footer-widgets .button:focus, .footer-widgets .button:hover {
    background-color: #008673!important;
}	
.button { background-color: #008673!important; }

.footer-widgets .button:hover { background-color: #26BA9E!important; }		</style>
		</head>
<body class="post-template-default single single-post postid-19149 single-format-standard header-full-width content-sidebar"><div class="site-container"><ul class="genesis-skip-link"><li><a href="#genesis-nav-primary" class="screen-reader-shortcut"> Skip to primary navigation</a></li><li><a href="#genesis-content" class="screen-reader-shortcut"> Skip to content</a></li><li><a href="#genesis-sidebar-primary" class="screen-reader-shortcut"> Skip to primary sidebar</a></li><li><a href="#genesis-footer-widgets" class="screen-reader-shortcut"> Skip to footer</a></li></ul><header class="site-header" itemscope itemtype="https://schema.org/WPHeader"><div class="wrap"><div class="title-area"><p class="site-title" itemprop="headline"><a href="https://blog.sucuri.net/">Sucuri Blog</a></p><p class="site-description screen-reader-text" itemprop="description">Website Security News</p></div><nav class="nav-primary" aria-label="Main" itemscope itemtype="https://schema.org/SiteNavigationElement" id="genesis-nav-primary"><ul id="menu-header-navigation-ii" class="menu genesis-nav-menu menu-primary js-superfish"><li id="menu-item-17495" class="menu-item-products menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17495"><a href="https://sucuri.net/website-antivirus/signup" itemprop="url"><span itemprop="name">Products</span></a>
<ul class="sub-menu">
	<li id="menu-item-17496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17496"><a href="https://sucuri.net/website-security-platform/signup/" itemprop="url"><span itemprop="name">Website Security Platform</span></a></li>
	<li id="menu-item-17497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17497"><a href="https://sucuri.net/website-firewall/" itemprop="url"><span itemprop="name">Website Firewall (WAF)</span></a></li>
	<li id="menu-item-20814" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20814"><a href="https://sucuri.net/custom/enterprise/" itemprop="url"><span itemprop="name">Enterprise Website Security</span></a></li>
	<li id="menu-item-20815" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20815"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Multisite Solutions</span></a></li>
</ul>
</li>
<li id="menu-item-17498" class="menu-item-industry menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17498"><a href="https://sucuri.net/website-security-platform/" itemprop="url"><span itemprop="name">Features</span></a>
<ul class="sub-menu">
	<li id="menu-item-17499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17499"><a href="https://sucuri.net/malware-detection-scanning/" itemprop="url"><span itemprop="name">Detection</span></a></li>
	<li id="menu-item-17500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17500"><a href="https://sucuri.net/website-hack-protection/" itemprop="url"><span itemprop="name">Protection</span></a></li>
	<li id="menu-item-17501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17501"><a href="https://sucuri.net/website-performance/" itemprop="url"><span itemprop="name">Performance</span></a></li>
	<li id="menu-item-19564" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19564"><a href="https://sucuri.net/website-malware-removal/" itemprop="url"><span itemprop="name">Response</span></a></li>
	<li id="menu-item-19911" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19911"><a href="https://sucuri.net/website-backups/" itemprop="url"><span itemprop="name">Backups</span></a></li>
</ul>
</li>
<li id="menu-item-19912" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-19912"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a>
<ul class="sub-menu">
	<li id="menu-item-19913" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19913"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Agency Solutions</span></a></li>
	<li id="menu-item-19915" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19915"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a></li>
	<li id="menu-item-20816" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20816"><a href="https://sucuri.net/referral/" itemprop="url"><span itemprop="name">Referral Program</span></a></li>
	<li id="menu-item-19914" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19914"><a href="https://sucuri.net/ecommerce-website-security/" itemprop="url"><span itemprop="name">Ecommerce</span></a></li>
</ul>
</li>
<li id="menu-item-20817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-20817"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Resources</span></a>
<ul class="sub-menu">
	<li id="menu-item-20818" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20818"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Guides</span></a></li>
	<li id="menu-item-20819" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20819"><a href="https://sucuri.net/webinars/" itemprop="url"><span itemprop="name">Webinars</span></a></li>
	<li id="menu-item-20820" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20820"><a href="https://sucuri.net/infographics/" itemprop="url"><span itemprop="name">Infographics</span></a></li>
	<li id="menu-item-20821" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20821"><a href="https://sitecheck.sucuri.net/" itemprop="url"><span itemprop="name">SiteCheck</span></a></li>
	<li id="menu-item-20822" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20822"><a href="https://sucuri.net/reports/" itemprop="url"><span itemprop="name">Reports</span></a></li>
	<li id="menu-item-22570" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22570"><a href="https://sucuri.net/email-courses/" itemprop="url"><span itemprop="name">Email Courses</span></a></li>
</ul>
</li>
<li id="menu-item-17506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17506"><a href="https://sucuri.net/website-security-platform/help-now" itemprop="url"><span itemprop="name">Immediate Help</span></a></li>
<li id="menu-item-17509" class="menu-item-login menu-item menu-item-type-custom menu-item-object-custom menu-item-17509"><a href="https://dashboard.sucuri.net/login/" itemprop="url"><span itemprop="name">Login</span></a></li>
</ul></nav><button id="responsive-menu" role="button" aria-controls="genesis-nav-primary" aria-pressed="false"><span class="screen-reader-text">Menu</span></button></div></header><div class="site-inner"><div class="wrap"><div class="content-sidebar-wrap"><main class="content" id="genesis-content"><article class="post-19149 post type-post status-publish format-standard has-post-thumbnail category-security-education category-sucuri-updates tag-best-practices tag-command-line-tools tag-sucuri-website-firewall entry"><header class="entry-header"><div class="single-featured"><img width="745" height="350" src="https://blog.sucuri.net/wp-content/uploads/2017/04/04252017-EN-using-free-splunk-with-sucuri-audit-tails_blog.jpg" class="single-featured-image wp-post-image" alt="" loading="lazy" srcset="https://blog.sucuri.net/wp-content/uploads/2017/04/04252017-EN-using-free-splunk-with-sucuri-audit-tails_blog.jpg 745w, https://blog.sucuri.net/wp-content/uploads/2017/04/04252017-EN-using-free-splunk-with-sucuri-audit-tails_blog-600x282.jpg 600w, https://blog.sucuri.net/wp-content/uploads/2017/04/04252017-EN-using-free-splunk-with-sucuri-audit-tails_blog-650x305.jpg 650w, https://blog.sucuri.net/wp-content/uploads/2017/04/04252017-EN-using-free-splunk-with-sucuri-audit-tails_blog-585x275.jpg 585w, https://blog.sucuri.net/wp-content/uploads/2017/04/04252017-EN-using-free-splunk-with-sucuri-audit-tails_blog-560x263.jpg 560w" sizes="(max-width: 745px) 100vw, 745px" /></div><h1 class="entry-title">How to Use Splunk with Sucuri Audit Trails</h1>
<p class="entry-meta"><time class="entry-time" datetime="2017-04-25T10:56:43-07:00">April 25, 2017</time><span class="entry-author"><a href="https://blog.sucuri.net/author/jon-watson" class="entry-author-link" rel="author"><span class="entry-author-name">Jon Watson</span></a></span><span class="post-language-options"><a class="spanish-post-link" href="https://blog.sucuri.net/espanol/2017/04/usando-splunk-gratuito-con-los-registros-de-auditoria-de-sucuri.html">Espanol</a><a class="portuguese-post-link" href="https://blog.sucuri.net/portugues/2017/04/como-usar-splunk-com-os-registros-de-auditoria-da-sucuri.html">Portugues</a></span></p></header><div class="entry-content"><aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2017%2F04%2Fusing-free-splunk-with-sucuri-audit-trails.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=How%20to%20Use%20Splunk%20with%20Sucuri%20Audit%20Trails&url=https://blog.sucuri.net/2017/04/using-free-splunk-with-sucuri-audit-trails.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--><p>The Sucuri Firewall dashboard provides a rich set of API functions that can be used to control your firewall settings remotely. In addition, there is an API function to download your <strong>Audit Trails</strong> in JSON format.</p>
<p>The audit trail is a<strong> list of blocked requests</strong> that the firewall performed on your behalf to keep your site safe. While it&#8217;s possible to view your audit trails in your Sucuri dashboard, you can get even more powerful analysis and comparison when you load them into Splunk.</p>
<h2>Visualizing Data with Splunk</h2>
<p><strong>Splunk</strong> is the defacto data logging tool in the IT world. It will enable you to view and query your Sucuri audit trails in different ways, such as graphs and activity trends over time. These types of insights can help shed light on current attacks, discover hidden trends and assist with capacity management going forward.</p>
<p>While the enterprise version of Splunk may be out of reach for some, a Free Splunk license exists and allows indexing of up to <strong>500MB per day</strong> &#8211; in perpetuity. While 500MB a day is not enough for busy access logs, it&#8217;s probably more than enough to index your Sucuri audit trails.</p>
<figure id="attachment_19184" aria-describedby="caption-attachment-19184" style="width: 650px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-audit-trails-sucuri-firewall-1.jpg" target="_blank"><img loading="lazy" class="wp-image-19184 size-large" src="https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-audit-trails-sucuri-firewall-1-650x368.jpg" alt="" width="650" height="368" /></a><figcaption id="caption-attachment-19184" class="wp-caption-text">Splunk showing attacks per hour across all sites</figcaption></figure>
<p>&nbsp;</p>
<figure id="attachment_19185" aria-describedby="caption-attachment-19185" style="width: 650px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-country-sucuri-firewall-audit.jpg" target="_blank"><img loading="lazy" class="wp-image-19185 size-large" src="https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-country-sucuri-firewall-audit-650x273.jpg" alt="" width="650" height="273" /></a><figcaption id="caption-attachment-19185" class="wp-caption-text">Splunk showing attack country of origin over the past week</figcaption></figure>
<p>&nbsp;</p>
<p>This article covers how to get your audit trails into Free Splunk and some basic query examples.</p>
<p>The steps are:</p>
<ol>
<li>Install Splunk.</li>
<li>Deploy the custom Sucuri audit trails as a source type.</li>
<li>Start Splunk and (optional) downgrade to the free version.</li>
<li>Get your API data from the Sucuri Firewall dashboard.</li>
<li>Download your Sucuri audit trails with a script.</li>
<li>Import the audit trails into Splunk.</li>
<li>Query away!</li>
</ol>
<h3>Step 1: Download and Install Splunk (500MB/day)</h3>
<blockquote><p><b>Note:</b>  You will need to create an account at Splunk.com.</p></blockquote>
<p>You can download the free trial of Splunk here:</p>
<p><a href="https://www.splunk.com/en_us/download/splunk-enterprise.html">https://www.splunk.com/en_us/download/splunk-enterprise.html</a></p>
<figure id="attachment_19187" aria-describedby="caption-attachment-19187" style="width: 650px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/04/free-download-splunk.jpg" target="_blank"><img loading="lazy" class="wp-image-19187 size-large" src="https://blog.sucuri.net/wp-content/uploads/2017/04/free-download-splunk-650x420.jpg" alt="" width="650" height="420" srcset="https://blog.sucuri.net/wp-content/uploads/2017/04/free-download-splunk-650x420.jpg 650w, https://blog.sucuri.net/wp-content/uploads/2017/04/free-download-splunk-600x387.jpg 600w, https://blog.sucuri.net/wp-content/uploads/2017/04/free-download-splunk-768x496.jpg 768w, https://blog.sucuri.net/wp-content/uploads/2017/04/free-download-splunk-560x361.jpg 560w, https://blog.sucuri.net/wp-content/uploads/2017/04/free-download-splunk.jpg 1134w" sizes="(max-width: 650px) 100vw, 650px" /></a><figcaption id="caption-attachment-19187" class="wp-caption-text">Free trial of Splunk Enterprise version.</figcaption></figure>
<figure id="attachment_19188" aria-describedby="caption-attachment-19188" style="width: 650px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-versions.jpg"><img loading="lazy" class="size-large wp-image-19188" src="https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-versions-650x290.jpg" alt="" width="650" height="290" srcset="https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-versions-650x290.jpg 650w, https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-versions-600x268.jpg 600w, https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-versions-768x343.jpg 768w, https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-versions-560x250.jpg 560w, https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-versions.jpg 994w" sizes="(max-width: 650px) 100vw, 650px" /></a><figcaption id="caption-attachment-19188" class="wp-caption-text">Choose your operating system</figcaption></figure>
<p>Let Splunk install, but <strong>don’t start it yet. </strong></p>
<figure id="attachment_19189" aria-describedby="caption-attachment-19189" style="width: 462px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/04/image12.jpg" target="_blank"><img loading="lazy" class="wp-image-19189 size-full" src="https://blog.sucuri.net/wp-content/uploads/2017/04/image12.jpg" alt="" width="462" height="118" /></a><figcaption id="caption-attachment-19189" class="wp-caption-text">Shutdown Splunk after install.</figcaption></figure>
<p>We want to put the custom Sucuri <strong>sourcetype</strong> in place first.</p>
<h3>Step 2: Deploy Your Custom Sucuri Source Type</h3>
<p><strong>$SPLUNK_HOME</strong> is usually set as follows:</p>
<ul>
<li><strong>Linux</strong>: /opt/splunk</li>
<li><strong>Mac:</strong> /Applications/Splunk</li>
<li><strong>Windows</strong>: C:\Program Files\Splunk</li>
</ul>
<p>Copy this <strong>props.conf</strong> into <strong>$SPLUNK_HOME/etc/system/local/props.con</strong></p>
<pre>[sucuri_audit_trails]
 NO_BINARY_CHECK = true
 category = Structured
 description = A variant of the JSON source type for Sucuri audit trails
 disabled = false
 pulldown_type = true
 MAX_TIMESTAMP_LOOKAHEAD = 10
 TIME_FORMAT = %s
 TIME_PREFIX = "request_timestamp":
 SHOULD_LINEMERGE = true
 LINE_BREAKER = (){\"is_usable</pre>
<p>If there is an existing <strong>props.conf</strong>, you probably want to just add this <strong>sourcetype</strong> to it rather than replacing the file.</p>
<h3>Step 3: Start Splunk and Verify Source Type</h3>
<p>Start Splunk now. You can do this from the command line:</p>
<pre>$SPLUNK_HOME/bin/splunk start</pre>
<p>You will need to log in for the first time using <strong>http://127.0.0.1:8000</strong> and the username <strong>admin</strong> and the password <strong>changeme</strong>.</p>
<p><a href="https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-start-screen.jpg" target="_blank"><img loading="lazy" class="wp-image-19190 size-large aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-start-screen-650x439.jpg" alt="" width="650" height="439" srcset="https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-start-screen-650x439.jpg 650w, https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-start-screen-600x405.jpg 600w, https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-start-screen-768x519.jpg 768w, https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-start-screen-560x378.jpg 560w, https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-start-screen.jpg 869w" sizes="(max-width: 650px) 100vw, 650px" /></a></p>
<p>Quickly check the source types list to ensure the new Sucuri audit trails source type shows up in the list.</p>
<p>Go to<strong> Settings &gt; Source types</strong> and then search for <strong>sucuri</strong>.</p>
<p>You don’t need to do anything &#8211; just ensure it shows up in the list prior to importing any audit trails.</p>
<figure id="attachment_19191" aria-describedby="caption-attachment-19191" style="width: 650px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/04/check-splunk-sourcetypes.jpg" target="_blank"><img loading="lazy" class="wp-image-19191 size-large" src="https://blog.sucuri.net/wp-content/uploads/2017/04/check-splunk-sourcetypes-650x265.jpg" alt="" width="650" height="265" srcset="https://blog.sucuri.net/wp-content/uploads/2017/04/check-splunk-sourcetypes-650x265.jpg 650w, https://blog.sucuri.net/wp-content/uploads/2017/04/check-splunk-sourcetypes-768x313.jpg 768w, https://blog.sucuri.net/wp-content/uploads/2017/04/check-splunk-sourcetypes-560x228.jpg 560w, https://blog.sucuri.net/wp-content/uploads/2017/04/check-splunk-sourcetypes-600x245.jpg 600w, https://blog.sucuri.net/wp-content/uploads/2017/04/check-splunk-sourcetypes.jpg 1000w" sizes="(max-width: 650px) 100vw, 650px" /></a><figcaption id="caption-attachment-19191" class="wp-caption-text">Check the sourcetypes in Splunk</figcaption></figure>
<h4>Downgrade Splunk Version (Optional)</h4>
<p>The Splunk version you download is the full Enterprise version trial. It will expire at some point and you will be downgraded to Free Splunk. You can feel free to use the Enterprise trial until it downgrades &#8211; but I prefer to downgrade immediately. This ensures that I do not inadvertently use some Enterprise function that I come to rely on and lose it when the license is downgraded to Free Splunk. You can check out the <a href="https://www.splunk.com/en_us/products/splunk-enterprise/free-vs-enterprise.html" target="_blank">differences between Splunk versions</a> to learn more.</p>
<p>If you want to downgrade your Splunk right away, use the following steps:</p>
<ul>
<li>Settings &gt; Licensing &gt; Change Licensing button</li>
<li>Select Free License</li>
<li>Restart Splunk</li>
</ul>
<h3>Step 4: Download Your Sucuri Audit Trails</h3>
<p>Follow these basic steps to import your Sucuri audit trails into Splunk.</p>
<p>First, <a href="http://login.sucuri.net/" target="_blank">log in to your Sucuri Dashboard</a> and navigate to <strong>Website Firewall &gt; Gear icon &gt; API.</strong></p>
<figure id="attachment_19192" aria-describedby="caption-attachment-19192" style="width: 510px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/04/API-sucuri.jpg" target="_blank"><img loading="lazy" class="wp-image-19192 size-large" src="https://blog.sucuri.net/wp-content/uploads/2017/04/API-sucuri-510x650.jpg" alt="" width="510" height="650" srcset="https://blog.sucuri.net/wp-content/uploads/2017/04/API-sucuri-510x650.jpg 510w, https://blog.sucuri.net/wp-content/uploads/2017/04/API-sucuri-470x600.jpg 470w, https://blog.sucuri.net/wp-content/uploads/2017/04/API-sucuri.jpg 512w" sizes="(max-width: 510px) 100vw, 510px" /></a><figcaption id="caption-attachment-19192" class="wp-caption-text">Finding the API section in your Sucuri dashboard</figcaption></figure>
<p>Copy your site&#8217;s <strong>API key</strong> and <strong>API secret</strong>.</p>
<figure id="attachment_19193" aria-describedby="caption-attachment-19193" style="width: 650px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/04/api-key-secret.jpg"><img loading="lazy" class="size-large wp-image-19193" src="https://blog.sucuri.net/wp-content/uploads/2017/04/api-key-secret-650x242.jpg" alt="" width="650" height="242" srcset="https://blog.sucuri.net/wp-content/uploads/2017/04/api-key-secret-650x242.jpg 650w, https://blog.sucuri.net/wp-content/uploads/2017/04/api-key-secret-600x224.jpg 600w, https://blog.sucuri.net/wp-content/uploads/2017/04/api-key-secret-768x286.jpg 768w, https://blog.sucuri.net/wp-content/uploads/2017/04/api-key-secret-560x209.jpg 560w, https://blog.sucuri.net/wp-content/uploads/2017/04/api-key-secret.jpg 1000w" sizes="(max-width: 650px) 100vw, 650px" /></a><figcaption id="caption-attachment-19193" class="wp-caption-text">Your Sucuri API key and API secret</figcaption></figure>
<p>You can now construct a script to grab your audit trails and inject them into Splunk.</p>
<h3>Step 5: Creating the Audit Trails Download Script</h3>
<p>The following commands are a sample Linux script that works on Linux and MacOS. There may be similar Powershell or batch commands you can use in Windows. This can be made more elegant &#8211; have fun with it!</p>
<p>This script will pull down the audit logs for the date specified as <strong>argument 1</strong>, and store it in a file specified by <strong>argument 2.</strong></p>
<blockquote><p><strong>Note</strong>: I have chosen to download audit trails for my <strong>sokd</strong> site, so I used that name in these examples. Anywhere you see <strong>sokd</strong>, you can replace that with something more meaningful for your server.</p></blockquote>
<pre>curl "https://waf.sucuri.net/api?v2&amp;k=$<strong>API_KEY</strong>&amp;s=$<strong>API_SECRET</strong>&amp;a=audit_trails&amp;date=${1}" &gt;&gt; $2</pre>
<p>I named this script <strong>sokd.api-call</strong> &#8211; you can call it in a loop for each date you are interested in. I did this on the 14th of April 2017 so my <strong>seq</strong> call is for days 1-13.</p>
<pre>for date in `seq -w 1 13`;do ./sokd.api-call 2017-04-$date sokd; done`</pre>
<blockquote><p><b>A note about audit trail limits: </b>You will only be able to pull down 1000 lines of your audit trails using this method. If you have a particularly busy site, you will need to make use of several other parameters in your API call. This advanced issue will be covered in a later post, but the basic building blocks you will need are as follows.</p></blockquote>
<p>The first record returned has a<b> total_lines</b> element.</p>
<p>This contains the total number of audit trail lines that were requested (in this case, 1534):</p>
<pre>{"status":1,"action":"audit_trails","messages":[],"request_time":1492611998,
"output":{<b>"total_lines":1534,</b>"access_logs":[{"is_usable":0}</pre>
<p>You can use that value, along with the <b>limit</b> and <b>offset </b>arguments, in the API call to iterate through as many API call loops as required to retrieve all of your audit logs. There is more information on those parameters on the API tab of your Sucuri Firewall dashboard.</p>
<h3>Step 6: Import Your Audit Trails into Splunk</h3>
<p>You can now add the data to Splunk using the <strong>oneshot</strong> command.</p>
<blockquote><p><strong>Note</strong>: You only need the <strong>-auth</strong> parameters if you&#8217;re not running in Free License mode (the Free mode does not have users).</p></blockquote>
<pre>$SPLUNK_HOME/bin/splunk add <strong>oneshot</strong> sokd -rename-source sokd -sourcetype sucuri_audit_trails -auth admin:changeme</pre>
<p>It can take a few minutes for the data to be indexed so if you do not see it in your query results right away, don’t panic. You can query your new <strong>sourcetype</strong> to see what events are now in it.</p>
<figure id="attachment_19196" aria-describedby="caption-attachment-19196" style="width: 650px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-events.jpg" target="_blank"><img loading="lazy" class="wp-image-19196 size-large" src="https://blog.sucuri.net/wp-content/uploads/2017/04/splunk-events-650x108.jpg" alt="" width="650" height="108" /></a><figcaption id="caption-attachment-19196" class="wp-caption-text">Searching for Sucuri events in Splunk</figcaption></figure>
<p>Note that the <strong>oneshot</strong> command does not check for duplicates. You will want to ensure that the audit trails you’re importing do not already exist in Splunk. If you end up with duplicate data, there are <a href="https://answers.splunk.com/answers/69924/how-to-delete-duplicate-events.html" target="_blank">ways to remove duplicate data</a> depending on your situation.</p>
<h2>How to Query Splunk Data</h2>
<p>Splunk is a very deep topic, and learning how to query data in Splunk can become complex. However, it is easy to get started with some basic knowledge.</p>
<p>Each log line is an <strong>event</strong> &#8211; all events in Splunk belong to a <strong>source</strong>, a <strong>sourcetype</strong> and an <strong>index</strong>. Using those three things, you can usually find anything you like. Splunk will even try to help you by auto-filling your query for you with some guesses of what you want.</p>
<figure id="attachment_19197" aria-describedby="caption-attachment-19197" style="width: 650px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/04/auto-filling-query.jpg" target="_blank"><img loading="lazy" class="wp-image-19197 size-large" src="https://blog.sucuri.net/wp-content/uploads/2017/04/auto-filling-query-650x409.jpg" alt="" width="650" height="409" srcset="https://blog.sucuri.net/wp-content/uploads/2017/04/auto-filling-query-650x409.jpg 650w, https://blog.sucuri.net/wp-content/uploads/2017/04/auto-filling-query-600x378.jpg 600w, https://blog.sucuri.net/wp-content/uploads/2017/04/auto-filling-query-560x353.jpg 560w, https://blog.sucuri.net/wp-content/uploads/2017/04/auto-filling-query.jpg 651w" sizes="(max-width: 650px) 100vw, 650px" /></a><figcaption id="caption-attachment-19197" class="wp-caption-text">Splunk auto-fills queries with common solutions</figcaption></figure>
<h3><b>Example Queries with Splunk<br />
</b></h3>
<p>Note that I have two systems loaded into Splunk: <strong>sokd</strong> and <strong>ph</strong>. Each is a ‘source’ in Splunk parlance.</p>
<p>To find all events across all systems:</p>
<ul>
<li><b>Query purpose: </b>Show all events from your audit trails</li>
<li><b>Query syntax:</b> sourcetype=&#8221;sucuri_audit_trails&#8221;</li>
</ul>
<p>When doing this, note that I have 159 total events.</p>
<figure id="attachment_19198" aria-describedby="caption-attachment-19198" style="width: 497px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/04/events-across-systems.jpg" target="_blank"><img loading="lazy" class="wp-image-19198 size-full" src="https://blog.sucuri.net/wp-content/uploads/2017/04/events-across-systems.jpg" alt="" width="497" height="613" srcset="https://blog.sucuri.net/wp-content/uploads/2017/04/events-across-systems.jpg 497w, https://blog.sucuri.net/wp-content/uploads/2017/04/events-across-systems-486x600.jpg 486w" sizes="(max-width: 497px) 100vw, 497px" /></a><figcaption id="caption-attachment-19198" class="wp-caption-text">Events across all systems in Splunk</figcaption></figure>
<p>I can further limit my search to only sokd by adding<strong> ‘source=sokd’</strong>.</p>
<ul>
<li><b>Query purpose:</b> Show all events belonging to the site ‘sokd’</li>
<li><b>Query syntax: </b>sourcetype=&#8221;sucuri_audit_trails&#8221; source=”sokd”</li>
</ul>
<p>Note how my matching events go from 159 to 106 because the <strong>ph</strong> events are no longer in the results:</p>
<figure id="attachment_19199" aria-describedby="caption-attachment-19199" style="width: 516px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/04/events-from-one-site.jpg" target="_blank"><img loading="lazy" class="wp-image-19199 size-full" src="https://blog.sucuri.net/wp-content/uploads/2017/04/events-from-one-site.jpg" alt="" width="516" height="521" srcset="https://blog.sucuri.net/wp-content/uploads/2017/04/events-from-one-site.jpg 516w, https://blog.sucuri.net/wp-content/uploads/2017/04/events-from-one-site-150x150.jpg 150w" sizes="(max-width: 516px) 100vw, 516px" /></a><figcaption id="caption-attachment-19199" class="wp-caption-text">Events across one system in Splunk</figcaption></figure>
<h2><b>Using the Visualization Tab</b></h2>
<p>To get some basic graphs, you can click the Visualization tab after your query has run.</p>
<figure id="attachment_19200" aria-describedby="caption-attachment-19200" style="width: 650px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/04/visualization-tab.jpg" target="_blank"><img loading="lazy" class="wp-image-19200 size-large" src="https://blog.sucuri.net/wp-content/uploads/2017/04/visualization-tab-650x324.jpg" alt="" width="650" height="324" srcset="https://blog.sucuri.net/wp-content/uploads/2017/04/visualization-tab-650x324.jpg 650w, https://blog.sucuri.net/wp-content/uploads/2017/04/visualization-tab-600x299.jpg 600w, https://blog.sucuri.net/wp-content/uploads/2017/04/visualization-tab-560x279.jpg 560w, https://blog.sucuri.net/wp-content/uploads/2017/04/visualization-tab.jpg 669w" sizes="(max-width: 650px) 100vw, 650px" /></a><figcaption id="caption-attachment-19200" class="wp-caption-text">The Visualization tab in Splunk</figcaption></figure>
<p>From there, you can select the type of graph you’d like.</p>
<figure id="attachment_19201" aria-describedby="caption-attachment-19201" style="width: 465px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/04/chart-formats-splunk.jpg"><img loading="lazy" class="size-full wp-image-19201" src="https://blog.sucuri.net/wp-content/uploads/2017/04/chart-formats-splunk.jpg" alt="" width="465" height="551" /></a><figcaption id="caption-attachment-19201" class="wp-caption-text">Visualization options for graphs and charts</figcaption></figure>
<h3>Example Visualizations with Splunk</h3>
<p>Here are a few sample queries using the Visualization tools.</p>
<ul>
<li><b>Query purpose</b>: Determine the top attacking IPs over time from all sites</li>
<li><b>Query syntax:</b> sourcetype=&#8221;sucuri_audit_trails&#8221; | timechart count by remote_addr limit=30</li>
</ul>
<figure id="attachment_19202" aria-describedby="caption-attachment-19202" style="width: 650px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/04/line-graph.jpg"><img loading="lazy" class="size-large wp-image-19202" src="https://blog.sucuri.net/wp-content/uploads/2017/04/line-graph-650x163.jpg" alt="" width="650" height="163" srcset="https://blog.sucuri.net/wp-content/uploads/2017/04/line-graph-650x163.jpg 650w, https://blog.sucuri.net/wp-content/uploads/2017/04/line-graph-600x150.jpg 600w, https://blog.sucuri.net/wp-content/uploads/2017/04/line-graph-768x192.jpg 768w, https://blog.sucuri.net/wp-content/uploads/2017/04/line-graph-560x140.jpg 560w, https://blog.sucuri.net/wp-content/uploads/2017/04/line-graph.jpg 1000w" sizes="(max-width: 650px) 100vw, 650px" /></a><figcaption id="caption-attachment-19202" class="wp-caption-text">Line graph in Splunk with Sucuri logs</figcaption></figure>
<p>We can easily see that over time, 109.237.109.135 is blocked the most, but it never spikes. The big spikes are from 45.33.76.17 and 142.54.174.130. This is interesting trend data which is not readily available from looking at individual daily audit trails.</p>
<ul>
<li><b>Query purpose:</b> Determine top firewall block reasons over time from one site</li>
<li><b>Query syntax: </b>sourcetype=&#8221;sucuri_audit_trails&#8221; source=&#8221;sokd&#8221;  | top limit=20 sucuri_block_reason</li>
</ul>
<figure id="attachment_19203" aria-describedby="caption-attachment-19203" style="width: 650px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/04/bar-chart.jpg"><img loading="lazy" class="size-large wp-image-19203" src="https://blog.sucuri.net/wp-content/uploads/2017/04/bar-chart-650x192.jpg" alt="" width="650" height="192" srcset="https://blog.sucuri.net/wp-content/uploads/2017/04/bar-chart-650x192.jpg 650w, https://blog.sucuri.net/wp-content/uploads/2017/04/bar-chart-600x178.jpg 600w, https://blog.sucuri.net/wp-content/uploads/2017/04/bar-chart-768x227.jpg 768w, https://blog.sucuri.net/wp-content/uploads/2017/04/bar-chart-560x166.jpg 560w, https://blog.sucuri.net/wp-content/uploads/2017/04/bar-chart.jpg 1220w" sizes="(max-width: 650px) 100vw, 650px" /></a><figcaption id="caption-attachment-19203" class="wp-caption-text">Firewall data in Splunk bar chart</figcaption></figure>
<blockquote><p><b>A note on indexes:</b> Splunk indexes help establish different retention periods and different user permissions for specific data. I have not specified an index in my examples which means my data is all stored in Splunk’s default index. Since Free Splunk has no concept of user permissions and I don’t want different retention levels for my various site’s audit trails, there’s no advantage in using a custom index for my use case. Arguably, if my audit trails were to grow to massive proportions over time, then perhaps putting them in separate indices would help with query speed but I don’t think that is likely given the relatively small dataset of the audit tails.</p></blockquote>
<p>Once you have a handle on the basic query syntax, you can then delve into Splunk’s rich graphical representation abilities to <a href="https://docs.splunk.com/Documentation/SplunkCloud/6.5.1612/SearchTutorial/Createnewdashboard" target="_blank">make charts and dashboards.</a></p>
<p>It&#8217;s important to know what&#8217;s going on with your website. If you use the Sucuri Firewall, our dashboards offer reporting so that you can see how effective it is at blocking threats. For data junkies who are comfortable with the command line, Splunk offers a playground of information for you to explore.</p>
<aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2017%2F04%2Fusing-free-splunk-with-sucuri-audit-trails.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=How%20to%20Use%20Splunk%20with%20Sucuri%20Audit%20Trails&url=https://blog.sucuri.net/2017/04/using-free-splunk-with-sucuri-audit-trails.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--></div><footer class="entry-footer"><p class="entry-meta"><span class="entry-categories">Categories: <a href="https://blog.sucuri.net/category/security-education" rel="category tag">Security Education</a>, <a href="https://blog.sucuri.net/category/sucuri-updates" rel="category tag">Sucuri Updates</a></span><span class="entry-tags">Tags: <a href="https://blog.sucuri.net/tag/best-practices" rel="tag">Best Practices</a>, <a href="https://blog.sucuri.net/tag/command-line-tools" rel="tag">Command Line Tools</a>, <a href="https://blog.sucuri.net/tag/sucuri-website-firewall" rel="tag">Sucuri Firewall</a></span></p></footer></article><section class="author-box"><img alt='' src='https://secure.gravatar.com/avatar/7cc4039d00d3be3c3a93d8bad4e52046?s=115&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7cc4039d00d3be3c3a93d8bad4e52046?s=230&#038;d=mm&#038;r=g 2x' class='avatar avatar-115 photo' height='115' width='115' loading='lazy'/><h4 class="author-box-title">About <span itemprop="name">Jon Watson</span></h4><div class="author-box-content" itemprop="description"><p>Jon Watson is a member of Sucuri's SOC Team who joined the company in 2016. Jon's main responsibilities include keeping the Sucuri WAF infrastructure running. His professional experience covers over 15 years of Linux sysadmin experience. When Jon isn't busy fighting fires or building new administration tools, you might find him writing blog posts about technology and remote work topics, or working on <a href="https://labs.jonw.zone">personal projects</a>. Connect with Jon on <a href="https://twitter.com/j_o_n__w">Twitter</a></p>
</div></section><h2 class="screen-reader-text">Reader Interactions</h2></main><aside class="sidebar sidebar-primary widget-area" role="complementary" aria-label="Primary Sidebar" itemscope itemtype="https://schema.org/WPSideBar" id="genesis-sidebar-primary"><h2 class="genesis-sidebar-title screen-reader-text">Primary Sidebar</h2><div class="sidebar-primary-wrap"><section id="text-5" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Socialize With Sucuri</h3>
			<div class="textwidget"><p>We're actively engaged across multiple platforms. Follow us and let's connect!</p>
<ul class="social-icons">
<li><a target="_blank" href="https://www.facebook.com/SucuriSecurity" rel="noopener"><span class="screen-reader-text">Facebook</span></a></li>
<li><a target="_blank" href="https://twitter.com/sucurisecurity" rel="noopener"><span class="screen-reader-text">Twitter</span></a></li>
<li><a target="_blank" href="https://www.linkedin.com/company/sucuri-security" rel="noopener"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a target="_blank" href="https://www.youtube.com/c/sucurinet" rel="noopener"><span class="screen-reader-text">YouTube</span></a></li>
<li><a target="_blank" href="https://www.instagram.com/sucurisecurity/" rel="noopener"><span class="screen-reader-text">Instagram</span></a></li>
<li><a target="_blank" href="https://blog.sucuri.net/feed/" rel="noopener"><span class="screen-reader-text">RSS Feed</span></a></li>
</ul>
</div>
		</div></section>
<section id="search-3" class="widget widget_search"><div class="widget-wrap"><form class="search-form" method="get" action="https://blog.sucuri.net/"><label class="search-form-label screen-reader-text" for="searchform-62ea528e30987">Search the blog</label><input type="search" name="s" id="searchform-62ea528e30987" placeholder="Search the blog" /><input type="submit" value="Search" /></form></div></section>
<section id="text-21" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/webinars/getting-started-with-sucuri?utm_source=Blog&amp;utm_medium=WidgetLogic&amp;utm_campaign=Webinar&amp;utm_term=EN&amp;utm_content=Starting-with-Sucuri" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23281 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_webinars_getting-started-with-sucuri.png" alt="Getting Started with Sucuri Webinar" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-26" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/guides/getting-started-with-sucuri?utm_source=Blog&#038;utm_medium=WidgetLogic&#038;utm_campaign=Guide&#038;utm_term=EN&#038;utm_content=Sucuri" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23340 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_guides_getting-started-with-sucuri.png" alt="Getting Started with Sucuri Guide" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-37" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"></div>
		</div></section>
</div><div class="sidebar-cta-widget" id="sidebar-cta"><section id="text-6" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Join Over 20,000 Subscribers!</h3>
			<div class="textwidget"><p><a href="http://sucuri.hs-sites.com/subscribe-to-security" onClick="ga('send', 'event', 'Blog', 'Button_Click', 'Subscribe_to_Security_Newsletter');"><img src="https://blog.sucuri.net/wp-content/uploads/2017/09/17-EN-sucuri-blog-newsletter-banner.png" /></a></p>
</div>
		</div></section>
</div></aside></div></div></div><footer class="site-footer" itemscope itemtype="https://schema.org/WPFooter"><div class="footer-widgets" id="genesis-footer-widgets"><h2 class="genesis-sidebar-title screen-reader-text">Footer</h2><div class="wrap"><div class="widget-area footer-widgets-1 footer-widget-area"><section id="nav_menu-3" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Products</h3>
<div class="menu-footer-products-menu-container"><ul id="menu-footer-products-menu" class="menu"><li id="menu-item-15501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15501"><a href="https://sucuri.net/website-firewall/" itemprop="url">Website Firewall</a></li>
<li id="menu-item-15502" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15502"><a href="https://sucuri.net/website-antivirus/" itemprop="url">Website AntiVirus</a></li>
<li id="menu-item-15503" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15503"><a href="https://sucuri.net/website-backups/" itemprop="url">Website Backups</a></li>
<li id="menu-item-15504" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15504"><a href="https://sucuri.net/wordpress-security/" itemprop="url">WordPress Security</a></li>
<li id="menu-item-15505" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15505"><a href="https://sucuri.net/custom/enterprise/" itemprop="url">Enterprise Services</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-2 footer-widget-area"><section id="nav_menu-4" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Solutions</h3>
<div class="menu-footer-solutions-menu-container"><ul id="menu-footer-solutions-menu" class="menu"><li id="menu-item-15506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15506"><a href="https://sucuri.net/website-firewall/ddos-protection" itemprop="url">DDos Protection</a></li>
<li id="menu-item-15507" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15507"><a href="https://sucuri.net/website-antivirus/malware-scanning-and-detection" itemprop="url">Malware Detection</a></li>
<li id="menu-item-15508" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15508"><a href="https://sucuri.net/website-antivirus/malware-removal" itemprop="url">Malware Removal</a></li>
<li id="menu-item-15510" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15510"><a href="https://sucuri.net/website-firewall/stop-website-attacks-and-hacks" itemprop="url">Malware Prevention</a></li>
<li id="menu-item-15511" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15511"><a href="https://sucuri.net/website-antivirus/blacklist-removal-and-repair" itemprop="url">Blacklist Removal</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-3 footer-widget-area"><section id="nav_menu-6" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Support</h3>
<div class="menu-footer-support-menu-container"><ul id="menu-footer-support-menu" class="menu"><li id="menu-item-15512" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15512"><a href="https://blog.sucuri.net/" itemprop="url">Blog</a></li>
<li id="menu-item-15513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15513"><a href="https://kb.sucuri.net/" itemprop="url">Knowledge Base</a></li>
<li id="menu-item-15515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15515"><a href="https://sitecheck.sucuri.net/" itemprop="url">SiteCheck</a></li>
<li id="menu-item-15516" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15516"><a href="http://labs.sucuri.net/" itemprop="url">Research Labs</a></li>
<li id="menu-item-15517" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15517"><a href="https://sucuri.net/faq/" itemprop="url">FAQ</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-4 footer-widget-area"><section id="nav_menu-5" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Company</h3>
<div class="menu-footer-company-menu-container"><ul id="menu-footer-company-menu" class="menu"><li id="menu-item-15495" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15495"><a href="https://sucuri.net/company/" itemprop="url">About</a></li>
<li id="menu-item-15496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15496"><a href="https://sucuri.net/company/media" itemprop="url">Media</a></li>
<li id="menu-item-15497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15497"><a href="https://sucuri.net/company/events" itemprop="url">Events</a></li>
<li id="menu-item-15498" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15498"><a href="https://sucuri.net/company/employment/" itemprop="url">Employment</a></li>
<li id="menu-item-15499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15499"><a href="https://sucuri.net/company/contact-us" itemprop="url">Contact</a></li>
<li id="menu-item-15500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15500"><a href="https://sucuri.net/customers/" itemprop="url">Testimonials</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-5 footer-widget-area"><section id="text-4" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><ul class="social-icons">
<li><a href="https://www.facebook.com/SucuriSecurity"><span class="screen-reader-text">Facebook</span></a></li>
<li><a href="https://twitter.com/sucurisecurity"><span class="screen-reader-text">Twitter</span></a></li>
<li><a href="https://www.linkedin.com/company/sucuri-security"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a href="https://www.instagram.com/sucurisecurity/"><span class="screen-reader-text">Instagram</span></a></li>
</ul>
<p><a class="button" href="https://dashboard.sucuri.net/login/">Customer Login</a></p>
<p><a class="footer-logo" href="https://sucuri.net/">Sucuri Home</a></p>
</div>
		</div></section>
</div></div></div><div class="site-footer-widget"><div class="wrap"><section id="text-8" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><div class="site-footer-links">
<ul>
<li><a href="https://sucuri.net/terms">Terms of Use</a></li>
<li><a href="https://sucuri.net/privacy">Privacy Policy</a></li>
<li><a href="https://sucuri.net/faq/">Frequently Asked Questions</a></li>
</ul>
</div>
<div class="site-footer-copyright">
<p>&#x000A9;&nbsp;2022 Sucuri Inc. All rights reserved</p>
</div>
</div>
		</div></section>
</div></div></footer></div><script type="text/javascript">
ire('identify', {customerId: '​​', customerEmail: '​​'}); </script><div id="cookie-policy-banner" class="container-fluid cookie-policy-banner hide p-0">
        <div class="container">
            <button id="cookie-policy-decline-btn" class="cb-close cb-decline-anchor">X</button>
            <div class="row">
                <div class="c-lg-8">
                    <p class="mb-0 mt-0 highlight green heavy">Sucuri Cookie Policy <br> <a href="https://sucuri.net/cookies" target="_blank" class="bolder no-underline">See our policy>></a></p>
                    <p class="mb-0 mt-0">Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.</p>
                </div>
                <div class="c-lg-4 d-flex justify-items-start mt-15 align-items-center">
                    <button id="cookie-policy-btn" class="btn btn-primary ml-0">Accept</button>
                    <button class="btn cb-decline-anchor auto-track" data-gatrack="Cookie_Click, Decline">Decline</button>
                    <button id="manage-privacy-options" class="btn">Manage Options</button>
                </div>
            </div>
        </div>
    </div><script type="text/javascript">
		/* MonsterInsights Scroll Tracking */
			if ( typeof(jQuery) !== 'undefined' ) {
				jQuery( document ).ready(function(){
					function monsterinsights_scroll_tracking_load() {
						if ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) {
							(function(factory) {
								factory(jQuery);
							}(function($) {

								/* Scroll Depth */
								"use strict";
								var defaults = {
									percentage: true
								};

								var $window = $(window),
									cache = [],
									scrollEventBound = false,
									lastPixelDepth = 0;

								/*
								 * Plugin
								 */

								$.scrollDepth = function(options) {

									var startTime = +new Date();

									options = $.extend({}, defaults, options);

									/*
									 * Functions
									 */

									function sendEvent(action, label, scrollDistance, timing) {

										var fieldsArray = {
											hitType       : 'event',
											eventCategory : 'Scroll Depth',
											eventAction   : action,
											eventLabel    : label,
											eventValue    : 1,
											nonInteraction: 1
										};

										if ( 'undefined' === typeof MonsterInsightsObject || 'undefined' === typeof MonsterInsightsObject.sendEvent ) {
											return;
										}

										MonsterInsightsObject.sendEvent( fieldsArray );
										if (arguments.length > 3) {
											fieldsArray = {
												hitType        : 'timing',
												timingCategory : 'Scroll Depth',
												timingVar      : action,
												timingValue    : timing,
												timingLabel    : label,
												nonInteraction: 1
											};
											MonsterInsightsObject.sendEvent( fieldsArray );
										}
									}

									function calculateMarks(docHeight) {
										return {
											'25%' : parseInt(docHeight * 0.25, 10),
											'50%' : parseInt(docHeight * 0.50, 10),
											'75%' : parseInt(docHeight * 0.75, 10),
											/* Cushion to trigger 100% event in iOS */
											'100%': docHeight - 5
										};
									}

									function checkMarks(marks, scrollDistance, timing) {
										/* Check each active mark */
										$.each(marks, function(key, val) {
											if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
												sendEvent('Percentage', key, scrollDistance, timing);
												cache.push(key);
											}
										});
									}

									function rounded(scrollDistance) {
										/* Returns String */
										return (Math.floor(scrollDistance/250) * 250).toString();
									}

									function init() {
										bindScrollDepth();
									}

									/*
									 * Public Methods
									 */

									/* Reset Scroll Depth with the originally initialized options */
									$.scrollDepth.reset = function() {
										cache = [];
										lastPixelDepth = 0;
										$window.off('scroll.scrollDepth');
										bindScrollDepth();
									};

									/* Add DOM elements to be tracked */
									$.scrollDepth.addElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.merge(options.elements, elems);

										/* If scroll event has been unbound from window, rebind */
										if (!scrollEventBound) {
											bindScrollDepth();
										}

									};

									/* Remove DOM elements currently tracked */
									$.scrollDepth.removeElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.each(elems, function(index, elem) {

											var inElementsArray = $.inArray(elem, options.elements);
											var inCacheArray = $.inArray(elem, cache);

											if (inElementsArray != -1) {
												options.elements.splice(inElementsArray, 1);
											}

											if (inCacheArray != -1) {
												cache.splice(inCacheArray, 1);
											}

										});

									};

									/*
									 * Throttle function borrowed from:
									 * Underscore.js 1.5.2
									 * http://underscorejs.org
									 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
									 * Underscore may be freely distributed under the MIT license.
									 */

									function throttle(func, wait) {
										var context, args, result;
										var timeout = null;
										var previous = 0;
										var later = function() {
											previous = new Date;
											timeout = null;
											result = func.apply(context, args);
										};
										return function() {
											var now = new Date;
											if (!previous) previous = now;
											var remaining = wait - (now - previous);
											context = this;
											args = arguments;
											if (remaining <= 0) {
												clearTimeout(timeout);
												timeout = null;
												previous = now;
												result = func.apply(context, args);
											} else if (!timeout) {
												timeout = setTimeout(later, remaining);
											}
											return result;
										};
									}

									/*
									 * Scroll Event
									 */

									function bindScrollDepth() {

										scrollEventBound = true;

										$window.on('scroll.scrollDepth', throttle(function() {
											/*
											 * We calculate document and window height on each scroll event to
											 * account for dynamic DOM changes.
											 */

											var docHeight = $(document).height(),
												winHeight = window.innerHeight ? window.innerHeight : $window.height(),
												scrollDistance = $window.scrollTop() + winHeight,

												/* Recalculate percentage marks */
												marks = calculateMarks(docHeight),

												/* Timing */
												timing = +new Date - startTime;

											checkMarks(marks, scrollDistance, timing);
										}, 500));

									}

									init();
								};

								/* UMD export */
								return $.scrollDepth;

							}));

							jQuery.scrollDepth();
						} else {
							setTimeout(monsterinsights_scroll_tracking_load, 200);
						}
					}
					monsterinsights_scroll_tracking_load();
				});
			}
		/* End MonsterInsights Scroll Tracking */
		
</script><script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/hoverIntent.min.js?ver=1.10.2' id='hoverIntent-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.min.js?ver=1.7.5' id='superfish-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.args.min.js?ver=2.7.1' id='superfish-args-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/skip-links.min.js?ver=2.7.1' id='skip-links-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/theme.js?ver=1.1.0' id='sucuriblog-theme-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky.js?ver=1.0.4' id='sucuriblog-sticky-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky-init.js?ver=1.0.1' id='sucuriblog-sticky-js-init-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/cookie-banner.js?ver=20200914' id='cookie-banner-js-js'></script>
</body></html>
