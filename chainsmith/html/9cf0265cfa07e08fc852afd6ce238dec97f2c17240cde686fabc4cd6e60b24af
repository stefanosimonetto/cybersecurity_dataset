<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: VB2015 paper: Economic Sanctions on Malware</title>
<meta name="description" content="Financial pressure can be a proactive and potentially very effective tool in making our computer ecosystems safer. By cleverly employing various trust metrics and technologies such as digital signing, watermarking, and public-key infrastructure in strategically selected places, we can encourage good behaviours and punish bad ones. In his VB2015 paper, Igor Muttik analyses and gives examples of technologies (certificates, credentials, etc.) to de-incentivize bad behaviours in several ecosystems (Windows, Android, iOS)." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 4837;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/remo_expand/blocks/remo_expand/templates/vbexpand/view.css" />
<script type="text/javascript" src="/packages/remo_expand/js/jquery.color.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/remo.expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<h1>Economic Sanctions on Malware</h1>
<h3>Prof. Igor Muttik</h3>
<p>Intel Security, UK</p>
<p><em>Copyright © 2016 Virus Bulletin </em></p>
<hr />
<p> </p>
<div class="ccm-remo-expand">
<div id="ccm-remo-expand-title-8002" class="ccm-remo-expand-title ccm-remo-expand-closed" data-expander-speed="500">Table of contents</div><div id="ccm-remo-expand-content-8002" class="ccm-remo-expand-content"><p><a class="toc-level2" href="#h2-abstract">Abstract</a><br /><a class="toc-level2" href="#h2-introduction">Introduction</a><br /><a class="toc-level2" href="#h2-costs-and-roi-for-defenders-and-attackers">Costs and ROI for defenders and attackers</a><br /><a class="toc-level2" href="#h2-authenticode">Authenticode</a><br /><a class="toc-level2" href="#h2-mobile-developer-ecosystem">Mobile developer ecosystem</a><br /><a class="toc-level2" href="#h2-taggant-system-version-1">Taggant system, Version 1</a><br /><a class="toc-level2" href="#h2-taggant-system-version-2">Taggant system, Version 2</a><br /><a class="toc-level2" href="#h2-conclusions">Conclusions</a><br /><a class="toc-level2" href="#h2-acknowledgements">Acknowledgements</a><br /><a class="toc-level2" href="#h2-references">References</a></p>
<p> </p></div></div><h2><a class="chapter" name="h2-abstract"></a>Abstract</h2>
<p>Anti-malware and other security products form the most visible part of any cyber defence, but the security industry often overlooks the fact that we also have several ways of exerting financial pressure on the bad guys. This pressure can be a proactive and potentially very effective tool in making our computer ecosystems safer.</p>
<p>Certain technologies are well suited to helping apply economic pressure on the players of computing ecosystems. By cleverly employing various trust metrics and technologies such as digital signing, watermarking, and public-key infrastructure in strategically selected places, we can encourage good behaviours and punish bad ones. For example, security products and services often employ blacklisting and whitelisting for software packages. Yet it is significantly more effective to apply this classification to the developers, software houses, distribution channels and players in the application monetization space (like <em>Perion</em>, <em>Iron Source</em>, etc.) and software distribution points (app markets and app stores).</p>
<p>We shall analyse and give examples of technologies (certificates, credentials, etc.) to de-incentivize bad behaviours in several ecosystems (<em>Windows</em>, <em>Android</em>, <em>iOS</em>) and slice them into subsystems that bear separate monetary tools (for example, membership fees and/or subscriptions):</p>
<ul>
<li><span style="line-height: 1.42857;">Authenticode digital signing for </span><em style="line-height: 1.42857;">Windows</em><span style="line-height: 1.42857;"> software</span></li>
<li><span style="line-height: 1.42857;">Official </span><em style="line-height: 1.42857;">Google Play </em>for<em style="line-height: 1.42857;">Android</em><span style="line-height: 1.42857;"> vs. third-party markets</span></li>
<li><span style="line-height: 1.42857;">Advertisement-supported software for mobile platforms and ad libraries</span></li>
<li><span style="line-height: 1.42857;">Software protected with obfuscating tools (a.k.a. packers), showing how the IEEE software taggant system solves the problem of obfuscated malware</span></li>
<li><span style="line-height: 1.42857;">Advertisement-supported monetization of software for </span><em style="line-height: 1.42857;">Windows</em><span style="line-height: 1.42857;"> and IEEE taggant v2.</span></li>
</ul>
<p>We'll discuss and compare the costs of building defences based on financial deterrents versus the cost for the attackers to abuse them.</p>
<h2><a class="chapter" name="h2-introduction"></a>Introduction</h2>
<p>The security industry's fight against adversaries in cyber space shares some traits with a long-lasting military conflict. These include defences, attacks and breaches, casualties and collateral damage, technological advances on both sides, and crimes and punishments.</p>
<p>As security professionals, we are engaged in technological and intellectual competition with the attackers. Virus writers in the 1990s had underground electronic magazines (like the notorious <em>29A</em>), in which they shared ideas and proofs of concept (including malicious code). That was a time when most malware was written by curious enthusiasts trying to prove themselves and by youngsters who could not get a date.</p>
<p>The 1990s may have set the tone for the anti-virus industry. In recent years the focus of our adversaries has drastically changed – it is now predominantly financial – but in AV security labs many researchers still feel that they are fighting a technological war. But are we really? And even if we are, <em>should</em> we be fighting a technological war?</p>
<p>As in any war, both sides have to balance their costs against benefits. 'Winning at all costs' is not how either side operates; the return on investment (ROI) is a major factor for both sides. Instead of focusing on perfecting our product technologies, we ought to work on embedding effective financial deterrents into cyber ecosystems. By employing economic measures (in conjunction with improvements in product technologies) we have a better chance of making the ecosystems cleaner and safer.</p>
<h2><a class="chapter" name="h2-costs-and-roi-for-defenders-and-attackers"></a>Costs and ROI for defenders and attackers</h2>
<p>Some say that current deterioration of cyber security is associated with the Internet. However, technologies often create new possibilities for financial abuse. The introduction of coined money quickly led to its theft. Gangsters used cars to get away faster after robbing banks. Phone lines were tapped to steal and often sell secrets. There are many examples of abuse of new technologies. Computers, networks and the Internet are still relatively new, and their associated technologies are constantly evolving – which makes them particularly easy to attack. The following factors have a strong influence on the ROI of cybercriminals:</p>
<ul>
<li><span style="line-height: 1.42857;">The cost of mounting an intrusion is low. (One needs only a computer and fairly limited skills to get involved.)</span></li>
<li><span style="line-height: 1.42857;">The reward can be high or very high. (Certain stolen data may be extremely valuable.)</span></li>
<li><span style="line-height: 1.42857;">The risk is low:</span>
<ul style="list-style-type: circle;">
<li>Especially if a crime is committed in another country; the Internet working across borders further reduces the risk.</li>
<li>In many countries legislation is way behind advances in technology, so apparent crimes are not universally punishable.</li>
</ul>
</li>
</ul>
<p><a href="#table1">Table 1</a> shows the spectrum of technologies in the arsenal of AV products from the perspective of how they affect the costs for attackers. (We only look at the cost element because product technologies have minimal effect on the attackers' risks and rewards.) <a class=" anchor" name="table1"></a></p>
<table class="table table-striped" border="0">
<tbody>
<tr>
<td><strong>Technology</strong></td>
<td><strong>Cost for defenders (to create)</strong></td>
<td><strong>Cost for attackers (to bypass)</strong></td>
</tr>
<tr>
<td>Hashing of programs</td>
<td style="color: green;">Low</td>
<td style="color: green;">Low</td>
</tr>
<tr>
<td>Fingerprinting</td>
<td style="color: orange;">Medium </td>
<td style="color: orange;">Medium </td>
</tr>
<tr>
<td>Behavioural fingerprinting</td>
<td style="color: orange;">Medium </td>
<td style="color: red;">High</td>
</tr>
<tr>
<td>IP/URL/domain blocking</td>
<td style="color: green;">Low</td>
<td style="color: orange;">Medium </td>
</tr>
<tr>
<td>Exploit blocking</td>
<td style="color: red;">High</td>
<td style="color: red;">High</td>
</tr>
<tr>
<td>Developer blocking </td>
<td style="color: green;">Low</td>
<td style="color: orange;">Medium </td>
</tr>
<tr>
<td>Digital signature blocking </td>
<td style="color: green;">Low</td>
<td style="color: red;">High</td>
</tr>
</tbody>
</table>
<p class="centered-caption">Table 1: AV technologies and how they affect costs for attackers. </p>
<p>We can see that blocking abused digital signatures appears to be the most effective approach for security products – our cost is minimal yet it is not easy for attackers to procure a new one. They have to purchase or steal. Neither of these actions is easy to automate.</p>
<p><em>Windows</em> has had digital signing of software (also known as authenticode) for quite some time. Let's analyse how authenticode has been attacked over the years.</p>
<h2><a class="chapter" name="h2-authenticode"></a>Authenticode</h2>
<p>Security products and services often employ blacklisting and whitelisting for software packages. Yet it is significantly more effective to apply this classification to the developers and software houses.</p>
<p>OS drivers have had to be digitally signed since <em>Windows Vista</em> was released. That measure forced OS-level malware (rootkits and APTs like Stuxnet) to procure private certificates to allow their modules to be loaded during the OS startup. This is not an easy step and possibly required physical intrusions to steal the required files.</p>
<p>During an installation of any software, <em>Windows</em> will warn users if the software is not signed. So, over the years, users have learned to more readily trust signed installation packages.</p>
<p>Moreover, AV products also block or allow software signed with, correspondingly, previously abused or trusted certificates. They employ whitelists and blacklists and compute the reputation of everything 'grey' in between. The origin of software as determined from its authenticode signature is an important factor in this determination.</p>
<p>It is very desirable for malware – as well as for potentially unwanted programs (PUPs) – to masquerade as legitimate programs, but this requires access to private public-key infrastructure (PKI) certificates. Only when these are available can attackers sign and distribute their creations and impersonate a software source with a good reputation. <a href="#figure1">Figure 1</a> shows a cumulative graph of malware and PUPs that are correctly digitally signed (authenticode). The growing trend indicates without a doubt that attackers find it beneficial to distribute their creations in a signed form. <a class=" anchor" name="figure1"></a></p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/2114/5934/3222/economic-sanctions-malware-1.jpg" alt="economic-sanctions-malware-1.jpg" width="700" height="331" /><span class="centered-caption">Figure 1: The growth of digitally signed malware and PUPs (Source: Intel Security Labs).</span></p>
<p>If we look at the 15 most commonly abused code-signing certificates in <a href="#figure2">Figure 2</a>, then the pattern becomes fairly clear. They consist of two large groups:</p>
<ul>
<li><span style="line-height: 1.42857;">Compromised certificates (revoked after they were leaked or stolen).</span></li>
<li><span style="line-height: 1.42857;">Certificates found in adware and PUPs. <a class=" anchor" name="figure2"></a></span></li>
</ul>
<p><span style="line-height: 14.2857px;"><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/8514/5934/3459/economic-sanctions-malware-2.jpg" alt="economic-sanctions-malware-2.jpg" width="780" height="508" /><span class="centered-caption">Figure 2: The 15 most common authenticode certificates in malware and PUPs (Source: Intel Security Labs).</span></span></p>
<p>For malware authors, manually hunting in order to steal a private PKI certificate is, of course, very hard. An alternative is to purchase code-signing certificates, but that carries an upfront cost before malware distribution. The cheapest code-signing certificate costs around US$75 (or $140 for two years) from <em>Comodo</em>. And after being used to sign malware, the certificate will likely soon appear on a blacklist due to its association with malware. This cost, combined with the risk of loss, should be sufficient to discourage the majority of first-time malware writers.</p>
<p>However, PKI costs are clearly not enough to discourage software companies involved in PUP distribution (adware and ad-supported software bundles). These companies cannot be involved in stealing PKI certificates – such behaviour would automatically cross the line and place them squarely in the malicious category. So adware/PUP operators have no choice but to legitimately purchase code-signing PKI certificates.</p>
<p>To avoid the upfront PKI costs, malware authors make their creations look for certificate files on infected computers and steal them. Any program that looks for PKI certificate files and sends them out is malware – there is no situation in which legitimate software would need to do this. Data presented at the VB2014 Conference in Seattle clearly shows that the malware authors have a steady, and perhaps even growing, interest in stealing private authenticode certificates [<a href="#ref1">1</a>].</p>
<p>To summarize: there is no doubt that authenticode digital signing makes it costly to misbehave. By associating software with the source, the defenders make attackers either pay real money or jump through awkward hoops to steal certificates (and with no guarantee of success).</p>
<p>Let’s now have a look at alternative ecosystems and see how digital signing affects behaviours in mobile platforms <em>iOS</em> and <em>Android</em>.</p>
<h2><a class="chapter" name="h2-mobile-developer-ecosystem"></a>Mobile developer ecosystem</h2>
<p>To register as an <em>iOS</em> developer costs US$99 (or $299 for an enterprise licence, which gives more freedom in distributing apps). However, if the app store operator (<em>Apple</em>) finds that a developer has violated the rules (and distributing malware is certainly a violation), the licence will be cancelled. Anyone who violates the rules will have to pay again. This method is even more restrictive than authenticode signing in <em>Windows</em> because all apps are signed by <em>Apple</em>, which reserves the right to instantly exclude any misbehaving apps from the app store. So in <em>iOS</em>, attackers do not even have a short time window while the revocation list reaches the endpoints. It would be equivalent to immediate revocation of an authenticode certificate in <em>Windows</em>.</p>
<p>The <em>Android</em> ecosystem is slightly more lax. The developer registration for <em>Google Play</em> is US$25 (as of June 2015). The <em>Google Play</em> ecosystem is similar to that of <em>iOS</em>: any misbehaving developer loses their money. <em>Android</em> uses self-signed developer certificates, but <em>Google Play</em> (as well as any other third-party <em>Android</em> app market) can expel a developer for misbehaviour. Thus the app market operator (<em>Google</em>, for <em>Google Play</em>) exercises a measure of control that is similar to putting bad developers onto a blacklist.</p>
<p>However, if one does not want to pay, there is the option of distributing apps via numerous third-party app stores. Many of these are quite popular in non–English-speaking countries – China, Russia, Brazil, etc. – which make up a significant portion of the market. The default configuration in most <em>Android</em> phones is only to allow apps to be downloaded from <em>Google Play</em>, but any user can open a phone to third-party app stores to get a wider choice of local apps.</p>
<p>Both mobile ecosystems – <em>iOS</em> and <em>Android</em> – require digital signatures from developers, and both <em>Apple</em> and <em>Google</em> put misbehaving developers onto a blacklist, which costs them real money (albeit about four times more for <em>iOS</em>).</p>
<p>Both <em>iOS</em> and <em>Android</em> are derived from <em>Linux</em>, and their security posture is similar. However, in comparing these ecosystems we notice that the more restrictive and costly <em>iOS</em> is nearly malware-free, while the cheaper <em>Google Play</em> has a moderate number of malware and the unregulated third-party Android markets have a very serious malware problem:</p>
<table class="table table-striped" border="0">
<tbody>
<tr>
<td><strong>Mobile OS</strong></td>
<td><strong>Cost of misbehaviour</strong></td>
<td><strong>Scale of malware problem</strong></td>
</tr>
<tr>
<td>iOS</td>
<td>US$99</td>
<td>Negligible</td>
</tr>
<tr>
<td>Android (Google Play)</td>
<td>US$25</td>
<td>Low</td>
</tr>
<tr>
<td>Android (third-party markets)</td>
<td>None</td>
<td>Serious</td>
</tr>
</tbody>
</table>
<p class="centered-caption">Table 2: Cost of misbehaviour and scale of malware problem of different mobile OSes.</p>
<p>The scale of the malware problem in mobile OSes appears to be directly influenced by the cost of misbehaviour.</p>
<p>We can speculate that the significantly more expensive <em>iOS</em> developer licence creates an incentive for malware authors to apply their skills to the <em>Android</em> OS, in which they have a choice between free but limited malware distribution, or a paid but significantly wider scope.</p>
<p>Let’s have a look at other digital signing schemes – those that were designed to reduce the malware problem by introducing financial pressure on misbehaviours where none had previously existed.</p>
<h2><a class="chapter" name="h2-taggant-system-version-1"></a>Taggant system, Version 1</h2>
<p>The IEEE taggant system was created to reduce the problem of packed malware by positively identifying the software origin [<a href="#ref2">2</a>, <a href="#ref3">3</a>]. The system is now offered as part of the IEEE Anti-Malware Support Service (AMSS [<a href="#ref4">4</a>]) by the IEEE Industry Connections Security Group (ICSG) [<a href="#ref5">5</a>].</p>
<p>Before the introduction of taggants, any malicious program could be repacked and redistributed at nearly zero cost by employing pirated and evaluation versions of packers. The taggant system attacks this via:</p>
<ul>
<li><span style="line-height: 1.42857;">Blocking individual (paid-for) installations of packers which were reported to produce malware.</span></li>
<li><span style="line-height: 1.42857;">Preventatively blocking all free/evaluation packer versions. Packer vendors place corresponding certificates into the blacklist before release; this allows developers to test the packer's compatibility with their software. However, AV products will block these objects, so a legitimate version must be purchased for production use and public distribution.</span></li>
<li><span style="line-height: 1.42857;">Encouraging packer vendors to use the system. There is no licensing fee for them – only the cost of development (plus a small sub-$1 cost for certificate creation); commercial packer vendors would also benefit due to the reduced use (piracy and abuse) of evaluation versions.</span></li>
</ul>
<p>Taggants introduce a cost for packer abuse. Malware authors will face the situation in which they have to choose among three options:</p>
<ul>
<li><span style="line-height: 1.42857;">Purchase a new packer as soon as abuse is detected and the packer licence is placed in a global blacklist consumed by all security vendors participating in the system.</span></li>
<li><span style="line-height: 1.42857;">Use free packers without a taggant, which reduces the reputation of the software and should become a less and less viable option.</span></li>
<li><span style="line-height: 1.42857;">Switch to a packer that does not support taggants, which should drive more packer companies to use the system – resulting in the rapidly falling reputation of files created with packers that do not participate.</span></li>
</ul>
<p>These measures should improve the health of the packed software ecosystem by introducing incentives for wider adoption of taggants and by creating a cost for bad behaviours.</p>
<p>We know how malware authors reacted to a wider use of authenticode. They coded certificate-stealing routines and added them to their malware. We should expect the same for packers: malware will start stealing valid taggant certificates. That was one of the reasons why the IEEE taggant working group decided to keep the certificates of packer vendors at a centralized, secure portal; this measure minimizes the risk of compromise on that level.</p>
<p>To fully analyse all the costs in the taggant ecosystem we have to look at five types of players in the system: malware authors, AV companies, packer vendors, packer users (software companies that use packers to protect a game, for example), and users (who run packed software such as a game). A detailed paper by Singh and Lakhotia has a full game-theory review of the taggant ecosystem, which specifically analyses its economics [<a href="#ref6">6</a>]. The authors draw some interesting conclusions:</p>
<ul>
<li><span style="line-height: 1.42857;">The system has to be made attractive for packer vendors; that is exactly how IEEE has designed it.</span></li>
<li><span style="line-height: 1.42857;">Packer vendors may have an incentive to sell a non-tagging packer to malware authors via another channel.</span></li>
</ul>
<p>We are delighted to see that the number of packer vendors, as well as unique observed packed files, is steadily growing, as <a href="#figure3">Figure 3</a> clearly demonstrates. It is, of course, still a drop in the ocean but the growth rate is very promising and a good indication of the taggant system attracting packer vendors. <a class=" anchor" name="figure3"></a></p>
<p><img src="/files/8614/5934/4071/economic-sanctions-malware-3.jpg" alt="economic-sanctions-malware-3.jpg" width="700" height="490" /><span class="centered-caption">Figure 3: The growth of unique packed files with taggants. (Source: Intel Security Labs.)</span></p>
<p>We are also pleased that <em>VirusTotal</em> (<a href="https://www.virustotal.com/" target="_blank">www.virustotal.com</a>) has implemented support for the reporting of details included in the taggant; <a href="#figure4">Figure 4</a> shows an example ('beta' output, not final). This free tool allows anyone to inspect the validity of the taggant, but it does not provide an automatic check against the global blacklist. Only IEEE AMSS subscribers get that. <a class=" anchor" name="figure4"></a></p>
<p><span style="line-height: 1.42857;"><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/9314/5934/4156/economic-sanctions-malware-4.jpg" alt="economic-sanctions-malware-4.jpg" width="805" height="452" /><span class="centered-caption">Figure 4: An example of a VirusTotal report about a taggant based on the ReversingLabs tool.</span></span></p>
<p><span style="line-height: 1.42857;">This is a successful starting point for taggants in packed files. Now let's turn our attention to one other burning problem – software bundling.</span></p>
<h2><a class="chapter" name="h2-taggant-system-version-2"></a>Taggant system, Version 2</h2>
<p>For any new programmer, software distribution is a major problem. Even a great program can remain unknown, with nobody willing to pay for it. At the same time, developers cannot work for free. This is a catch-22 situation for new developers who want to enter the market. There are two solutions, specific to smartphones and to desktops:</p>
<ul>
<li><span style="line-height: 1.42857;">For smartphone apps, developers may include advertisements in their apps. This creates a small stream of micropayments that could turn into real money if an app becomes really popular. Unfortunately, this often creates a conflict between the developer's incentives and a user's safety [<a href="#ref7">7</a>].</span></li>
<li><span style="line-height: 1.42857;">For </span><em style="line-height: 1.42857;">Windows</em><span style="line-height: 1.42857;">, developers may submit their software to ad-supported distribution providers (ASDPs). It may then get bundled with some other software and offered to users. (An ASDP may determine what to offer to specific users based on what software is already installed on their computers, for example.)</span></li>
</ul>
<p>Unfortunately, both types of ad-supported ecosystems are complex and they frequently intrude on users' privacy [<a href="#ref8">8</a>] or attempt to control users' searches and downloads by piggy-backing on free software [<a href="#ref9">9</a>]. These questionable behaviours are quite common, and AV companies have been trying to enforce some security rules. (Read a fascinating and horrifying case study [<a href="#ref10">10</a>].) Many ASDPs are also unhappy with this situation. There are no agreed rules – some AV vendors are stricter than others; and the OS, browser, and search engine vendors have a natural advantage over other ASDPs, which hurts their business. To summarize: the major players feel the need for defined rules and better control in this complex ecosystem. This need has resulted in the collaborative initiative called the Clean Software Alliance [<a href="#ref11">11</a>].</p>
<p>From the technology perspective, this area is difficult to regulate for the following reasons:</p>
<ul>
<li><span style="line-height: 1.42857;">The same software may be legitimate if installed from one bundle (if the bundle showed sufficient warnings and obtained proper user consent) but unacceptable within another bundle (which may silently install it or, perhaps, do so while ignoring the user's objections).</span></li>
<li><span style="line-height: 1.42857;">Developers may have a distribution agreement with multiple ASDPs. One may expire; another may still be valid. That means the same program in one bundle is OK, but in another it is not.</span></li>
<li><span style="line-height: 1.42857;">In some cases advertising code is external (separate ASDP software); in others the ad library code is included in the app. (The <em>Android</em> apps contain ad library code in addition to the code of the original. In the case of multiple ad libraries the final DEX program may have many unrelated code contributors.)</span></li>
</ul>
<p>To ensure that we can identify and distinguish all these individual cases, we need technology for tracking the code contributions on three levels: program binary, installation file, and installation bundle. We also need to track the program distribution chain not only at its origin (developers can and should sign their programs) but so that all intermediaries, bundlers and distribution sites can add their 'stamp', as well.</p>
<p>Moreover, we need to track an app's installation history. When a program is found on a device with no information about how it was installed – with or without the user's consent – we are faced with a real quandary. In many cases this puzzle will not be possible to solve if there are no hints as to what steps led to the installation. That is why the installation history (properly logged with data that can be trusted) is so important.</p>
<p>The Clean Software Alliance needed a technology to support its effort, and the taggant system has emerged as a primary candidate. However, the taggant system required certain changes to accommodate these multiple new uses, so we at the IEEE ICSG added the following:</p>
<ul>
<li><span style="line-height: 1.42857;">The ability to add a list of code contributors to a taggant.</span></li>
<li><span style="line-height: 1.42857;">The ability to add a taggant to a wide range of raw binary file types. This includes, for example, files like ELFs and APKs. (Version 1 supported only PEs and DLLs.)</span></li>
<li><span style="line-height: 1.42857;">Taggants in JS scripts and other raw text files.</span></li>
<li><span style="line-height: 1.42857;">The ability to 'stack' taggants, adding several taggant layers atop one another to reflect the software distribution chain.</span></li>
<li><span style="line-height: 1.42857;">And, of course, compatibility with the previous version and with authenticode.</span></li>
</ul>
<p>Thus far, the taggant Version 2 has passed more than 160 compatibility tests and will soon be released as open-source on <em>GitHub</em>, just like Version 1 [<a href="#ref12">12</a>]. Whether the Clean Software Alliance will employ the new taggant remains a question. At the very least, it is now a matter of negotiations and politics; the technology is ready.</p>
<h2><a class="chapter" name="h2-conclusions"></a>Conclusions</h2>
<p>Various forms of digital signing coupled with the blocking of misused certificates is very well suited to applying economic pressure on the abusers of computing ecosystems. By employing these methods we can encourage good behaviours and punish bad ones.</p>
<p>Making attackers spend real money before they can deploy malware is likely the best deterrent. Every time we find a way to apply more negative financial pressure on malware authors, we are likely to discourage many thousands of them.</p>
<p>As security industry practitioners, we must always think of ways to create new ecosystems and adjust current ones to make malware development and aggressive software costly, awkward, and risky. We can achieve this by applying PKI technologies while ensuring smooth operations for legitimate developers and users.</p>
<p>If you want to take part in such collaborative projects in the future, please feel free to contact the IEEE ICSG<br />(<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="80eaefe9eee9e3f3e7c0e9e5e5e5aeeff2e7">[email&#160;protected]</a>).</p>
<h2><a class="chapter" name="h2-acknowledgements"></a>Acknowledgements</h2>
<p>I am very grateful to all the participants in the IEEE taggant project and especially to Peter Ferrie, Mark Kennedy, Samir Mody and James Wendorf, who played major roles in bringing the taggant system to life. Thanks also to my Intel Security colleagues Patrick Knight and Craig Schmugar for providing data on adware and the level of authenticode abuse.</p>
<h2><a class="chapter" name="h2-references"></a>References</h2>
<p><a class=" anchor" name="ref1"></a>[1] Popescu, A.; Jescu, G. Can we Trust a Trustee? In-Depth Look into the Digitally Signed Malware. Proceedings of Virus Bulletin 2014 International Conference, Seattle, pp.183-188. <a href="/virusbulletin/2016/01/paper-can-we-trust-trustee-depth-look-digitally-signed-malware-industry/" target="_blank">https://www.virusbulletin.com/virusbulletin/2016/01/paper-can-we-trust-trustee-depth-look-digitally-signed-malware-industry/</a>.</p>
<p><a class=" anchor" name="ref2"></a>[2] <a href="https://en.wikipedia.org/wiki/Software_taggant" target="_blank">http://en.wikipedia.org/wiki/Software_taggant</a>.</p>
<p><a class=" anchor" name="ref3"></a>[3] <a href="http://standards.ieee.org/develop/indconn/icsg/taggant.pdf" target="_blank">http://standards.ieee.org/develop/indconn/icsg/taggant.pdf</a>.</p>
<p><a class=" anchor" name="ref4"></a>[4] <a href="http://standards.ieee.org/develop/indconn/icsg/amss.html" target="_blank">http://standards.ieee.org/develop/indconn/icsg/amss.html</a>.</p>
<p><a class=" anchor" name="ref5"></a>[5] <a href="http://standards.ieee.org/develop/indconn/icsg/" target="_blank">http://standards.ieee.org/develop/indconn/icsg/</a>.</p>
<p><a class=" anchor" name="ref6"></a>[6] <a href="http://www.cacs.louisiana.edu/~arun/papers/2011-MALWARE-game-theoretic.pdf" target="_blank">http://www.cacs.louisiana.edu/~arun/papers/2011-MALWARE-game-theoretic.pdf</a>.</p>
<p><a class=" anchor" name="ref7"></a>[7] <a href="https://blogs.mcafee.com/mcafee-labs/free-mobile-apps-compromises-user-safety" target="_blank">https://blogs.mcafee.com/mcafee-labs/free-mobile-apps-compromises-user-safety</a>.</p>
<p><a class=" anchor" name="ref8"></a>[8] <a href="https://www.mcafee.com/uk/resources/reports/rp-mobile-security-consumer-trends.pdf" target="_blank">http://www.mcafee.com/uk/resources/reports/rp-mobile-security-consumer-trends.pdf</a>.</p>
<p><a class=" anchor" name="ref9"></a>[9] <a href="http://blog.brandverity.com/2738/software-bundlers-target-browser-brands-is-this-trademark-abuse" target="_blank">http://blog.brandverity.com/2738/software-bundlers-target-browser-brands-is-this-trademark-abuse</a>.</p>
<p><a class=" anchor" name="ref10"></a>[10] <a href="https://www.howtogeek.com/198622/heres-what-happens-when-you-install-the-top-10-download.com-apps/" target="_blank">http://www.howtogeek.com/198622/heres-what-happens-when-you-install-the-top-10-download.com-apps/</a>.</p>
<p><a class=" anchor" name="ref11"></a>[11] <a href="http://uk.pcmag.com/opinion/37074/changing-the-way-we-fight-malware" target="_blank">http://uk.pcmag.com/opinion/37074/changing-the-way-we-fight-malware</a>.</p>
<p><a class=" anchor" name="ref12"></a>[12] <a href="https://github.com/IEEEICSG/IEEE_Taggant_System" target="_blank">https://github.com/IEEEICSG/IEEE_Taggant_System</a>.</p> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<p><a href="/uploads/pdf/conference/vb2015/Muttik-VB2015.pdf" target="_blank"><img src="/uploads/images/buttons/pdf-download-button.jpg" alt="Download PDF" width="262" height="45" /></a></p>
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=VB2015 paper: Economic Sanctions on Malware&url=https://www.virusbulletin.com/virusbulletin/2016/06/vb2015-paper-economic-sanctions-malware"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2016/06/vb2015-paper-economic-sanctions-malware'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2016/06/vb2015-paper-economic-sanctions-malware&title=VB2015 paper: Economic Sanctions on Malware"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2016/06/vb2015-paper-economic-sanctions-malware&t=VB2015 paper: Economic Sanctions on Malware"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2016/06/vb2015-paper-economic-sanctions-malware"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p> </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">©1989-2022 Virus Bulletin.        <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>        <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>        <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>