<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: Botception: botnet distributes script with bot capabilities</title>
<meta name="description" content="Researchers Jan Sirmer and Adolf Streda describe the branch of the Necurs botnet that they have been monitoring, the changes it has undergone in the course of a year, and present an analysis of the next stage of the attack: Flawed Ammy." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 6243;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/blocks/expand_collapse_toc/templates/vbexpand/view.css" />
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/jquery.color.js"></script>
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<h1><a class="chapter" name="h1-botception-botnet-distributes-script-bot-capabilities"></a>Botception: Botnet distributes script with bot capabilities</h1>
<h3><a class="chapter" name="h3-jan-sirmer-amp-adolf-streda"></a>Jan Sirmer &amp; Adolf Streda</h3>
<p>Avast Software, Czech Republic</p>
<p><em>Copyright © 2018 Virus Bulletin</em></p>
<hr />
<p> </p>
<div class="ccm-expand-collapse-toc">
<div id="ccm-expand-collapse-toc-title-13445" class="ccm-expand-collapse-toc-title ccm-expand-collapse-toc-closed" data-expander-speed="500">Table of contents</div><div id="ccm-expand-collapse-toc-content-13445" class="ccm-expand-collapse-toc-content"><p><a class="toc-level2" href="#h2-introduction">Introduction</a><br /> <a class="toc-level2" href="#h2-1-monitoring-necurs">1. Monitoring Necurs</a><br /> <a class="toc-level3" href="#h3-11-c2-protocol">1.1 C2 protocol</a><br /> <a class="toc-level3" href="#h3-12-p2p-protocol">1.2 P2P protocol</a><br /> <a class="toc-level3" href="#h3-13-spam-protocol">1.3 Spam protocol</a><br /> <a class="toc-level4" href="#h4-131-request">1.3.1 Request</a><br /> <a class="toc-level4" href="#h4-132-response">1.3.2 Response</a><br /> <a class="toc-level2" href="#h2-2-tracked-campaigns-overview">2. Tracked campaigns – overview</a><br /> <a class="toc-level3" href="#h3-21-vbs-control-panel">2.1 VBS control panel</a><br /> <a class="toc-level3" href="#h3-22-version-differences">2.2 Version differences</a><br /> <a class="toc-level3" href="#h3-23-vbs-control-panel-functions">2.3 VBS control panel functions</a><br /> <a class="toc-level3" href="#h3-24-flawed-ammyy">2.4 Flawed Ammyy</a><br /> <a class="toc-level2" href="#h2-references">References</a></p><p>&nbsp;</p></div></div>
<h2><a class="chapter" name="h2-introduction"></a>Introduction</h2>
<p>At the end of April 2018, while monitoring one of the branches of the Necurs botnet, we observed new scripts being distributed by the botnet. After analysing the scripts we realized that their behaviour was slightly different from the other scripts spread by Necurs. After deobfuscating the first versions of the scripts, we were left with the nice, readable source code of a bot written in Visual Basic Script. We hacked the script a bit to set up a connection with its C&amp;C server in order to get to the next stage of the attack: Flawed Ammyy. In this paper we describe the branch of Necurs we have been monitoring and the changes it underwent in a year, as well as presenting an analysis of Flawed Ammyy.</p>
<p> </p>
<h2><a class="chapter" name="h2-1-monitoring-necurs"></a>1. Monitoring Necurs</h2>
<p>We have been monitoring Necurs’ communications for more than a year by using a fake client that exploits the lack of strictness and the low security of the Necurs protocol. However, the structure of Necurs itself is rather complex. The botnet is divided into several branches that may vary in their mutual independence. For example, branches with URL path <em>/news/index.php</em> and <em>/news/soap.php</em> share the same P2P and C2 infrastructures, while <em>/locator.php</em> shares only the same C2 infrastructure with the others. These divisions are indicated by public keys, saved in the binaries, which are used to encrypt (more specifically to derive the encryption key) and authenticate data in C2 and P2P messages. Table 1 shows the branches of Necurs we have observed in the wild.</p>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td><strong>Shared secret (C2)</strong></td>
<td><strong>Shared secret (P2)</strong></td>
<td><strong>URL path</strong></td>
<td><strong>Note</strong></td>
</tr>
<tr>
<td>0x0ebf7ba7/0x0ef5bba7<br />0x6f92fd95<br />0x36bb6083<br />None<br />None<br />0x5ba4fa79<br />0x143ea3f1/0x5ba4fa79<br />0x143ea3f1/0x5ba4fa79<br />0x5ba4fa79<br />0x0d0e75e3<br />0x0ef5bba7/0x17ccf9c9</td>
<td>0x17ccf9c9<br />0xff5dd443<br />0x04aa4ae7<br />None<br />None<br />0x04aa4ae7<br />0xce9850ff<br />0xce9850ff<br />0xce9850ff<br />0x349597c5<br />0x17ccf9c9</td>
<td>/docs/index.php<br />/faq/index.php<br />/forum/db.php<br />/forum/module.php<br />/forum/userdata.php<br />/locator.php<br />/news/index.php<br />/news/soap.php<br />/news/stream.php<br />/soap/api.php<br />/index.php</td>
<td valign="top">
<p>SS-C2 updated</p>
<p>Updated to <em>/locator.php</em> over P2P<br />Spam module (old)<br />Spam module (new)</p>
<p>SS-C2 updated<br />SS-C2 updated</p>
<p> </p>
</td>
</tr>
</tbody>
</table>
<p class="centered-caption">Table 1: Branches of Necurs observed in the wild.</p>
<p>Unfortunately, we have been unable to recover C&amp;C addresses for some of the branches, and as a result we are actively tracking only a few branches of the botnet. However, we have been able to get our hands on many samples and to track campaigns right from their start.</p>
<p>We are tracking three protocols. There are more protocols which are added in modules, e.g. a proxy module’s protocol, however, these protocols are not of interest to us at the moment and thus have not been implemented in our fake client.</p>
<p> </p>
<h3><a class="chapter" name="h3-11-c2-protocol"></a>1.1 C2 protocol</h3>
<p>C2 protocol is the backbone of Necurs’ communication protocols. Although Necurs is considered to be a hybrid botnet (utilizing both P2P and centralized architecture), in reality, every message sent to a client with critical data, e.g. a peer list, has to be signed by the C&amp;C’s private key and thus P2P serves only as a backup infrastructure, keeping the client in touch with the botnet’s C&amp;C.</p>
<p>C2 protocol is initiated by the client and closed by a single response from a server. The protocol is facilitated over <em>HTTP requests/responses</em>, more specifically <em>HTTP POST requests</em> with the data as a payload to the request. The protocol uses a home-brewed XOR cipher with the C&amp;C’s public key as a shared secret, which is used to derive the password. Examples of the structures used in the communication are shown in code snippets <a href="#snippet1">1</a>, <a href="#snippet2">2</a> and <a href="#snippet3">3</a>.<a class=" anchor" name="snippet1"></a></p>
<pre class="prettyprint">struct envelope{<br />    uint32_t key_material;<br />    C2_payload payload; //encrypted<br />    uint32_t checksum; //key at the end of encryption<br />}<br />struct C2_payload{<br />    uint64_t random;<br />    uint64_t bot_ID;<br />    uint64_t millisSince1900;<br />    uint8_t command;<br />    uint8_t flags;<br />    uint8_t data[];<br />}</pre>
<p class="centered-caption">Code snippet 1: C2 envelope with a decrypted payload structure.</p>
<p>A quadword with a random number is probably used to increase the entropy of the message. The only static part is a bot_ID, which is derived from the drive serial number. A one‑byte command tells the server which response is expected (0 for a command, 1 for a file, 2 for a ping), while the flag contains information as to whether the payload is compressed (with aPLib library). Every response to a C&amp;C message also includes a signature (which is currently 128B as the public key has 1024b modulus) made by the server’s private key at the end of each message. The contents of the <em>data</em> array are determined by the <em>command</em> variable:</p>
<ul>
<li><em>command=0 (query)</em>: The data array contains various telemetry data. The server in turn responds with a similar structure containing e.g. a peer list or module update.</li>
<li><em>command=1 (retrieve file)</em>: The data contains only an SHA1 hash of the requested file. The server produces a response containing either HTTP 404 (if the hash is wrong) or the requested file. These files are mostly encrypted by aPLib, most likely due to the size of the file. The tracker retrieved four files: a mailer module, a proxy module and two drivers (32-bit and 64-bit versions).</li>
<li><em>command=2 (ping)</em>: The data contains 16 random bytes which are echoed back by the server.</li>
</ul>
<p>When the command flag is equal to zero, there are more interesting structures, which we shall call resources. Each resource is contained in an envelope, as shown in code snippet 2.<a class=" anchor" name="snippet2"></a></p>
<pre class="prettyprint">struct resourceEnvelope{<br />    uint8_t type;<br />    uint64_t ID;<br />    uint8_t data[];<br />}</pre>
<p class="centered-caption">Code snippet 2: C2 resource envelope.</p>
<p>The data contains another type of structure, in this case determined by the <em>type</em> variable, as shown in code snippet 3.<a class=" anchor" name="snippet3"></a></p>
<pre class="prettyprint">struct resource_type0{<br />    uint32_t size;<br />    uint8_t data[];<br />}<br />struct resource_type1{<br />    uint32_t data;<br />}<br />struct resource_type2{<br />    uint64_t data;<br />}<br />struct resource_type4{<br />    uint16_t size;<br />    uint8_t data[size + 1];<br />}<br />struct resource_type5{<br />    uint8_t data[20];<br />}</pre>
<p class="centered-caption">Code snippet 3: C2 resource types.</p>
<p>For the sake of completeness, [<a href="#ref1">1</a>] mentions a type 3. However, there was no trace of type 3 in the samples on which this article is based, and as it duplicates type 2, we can ignore it for the sake of brevity. As [<a href="#ref1">1</a>] suggests, type 4 seems to be intended as a C-type string carrier as the data field is longer than the given size by 1, which might suggest that a null terminator is used (collected data supports this conjecture). Disassembly suggests that type 5 is used purely as a carrier of the SHA1 hash, as after the processing resources file we found a conditional jump to a code block initiating a download request.</p>
<p>The payload, contained in the outer envelope, is also encrypted by a home-brewed cipher described by the code shown in code snippet 4.</p>
<pre class="prettyprint">uint32_t encryptC2(char* data, uint32_t length, uint32_t key)<br />{<br />    uint32_t res = key;<br />    while (length &gt; 0)<br />    {<br />        *data ^= (uint8_t)res;<br />        uint32_t rotated = (res &gt;&gt; 13 | res &lt;&lt; 19);<br />        uint32_t tmpCharacter = ((uint32_t)*data) &amp; 0xFF;<br />        tmpCharacter = (res + tmpCharacter * 4) * 2;<br />        res += (rotated ^ tmpCharacter);<br />        data++;<br />        length--;<br />    }<br />    return res;<br />}</pre>
<p class="centered-caption"> Code snippet 4: C2 encryption.</p>
<p>The key is derived from the shared secret (the first four bytes of the C&amp;C’s public key data, i.e. not the certificate header, which has 20 bytes) and the four random bytes that are in the request (variable <em>key_material</em> in <a href="#snippet1">code</a> <a href="#snippet1">snippet 1</a>), which are added together as 32-bit integers. The encryption function also returns a modified key, which is used to decrypt the response. Afterwards, the modified key is inserted into the envelope (variable <em>checksum</em> in <a href="#snippet1">code snippet 1</a>) and the entire envelope is sent over HTTP. The response is encrypted in a similar way. However, the key is defined by the request, not by the shared secret and the first four bytes of payload.</p>
<p>Decrypting the encrypted payload is rather straightforward as the encryption function requires only one slight modification: we swap XOR on <em>data</em> and the <em>tmpCharacter</em> lines. If the private key is known, it is easy to derive the key for every request made to the respective C&amp;C. However, for an easy decryption of the response, the corresponding request is required.</p>
<p>Interestingly, the C2 protocol is the only Necurs protocol capable of updating a client’s peer list. This may cause some problems in analysing old samples, as they may not contain up-to-date C&amp;C addresses or any active peer in their lists. This may be partially remedied by an internal DGA (domain generation algorithm), although many of these domains tend to be sinkholed.</p>
<p> </p>
<h3><a class="chapter" name="h3-12-p2p-protocol"></a>1.2 P2P protocol</h3>
<p>Necurs’ P2P protocol works in a similar way to its C2 protocol – fortunately, from the cryptanalytical point of view, with a slightly weaker key-derivation protocol. The main difference is a protocol: while C2 utilizes HTTP over TCP, the P2P protocol uses a home-brewed protocol over UDP. Every message in the protocol has an outer structure that is similar to that of the C2 protocol’s messages (they differ only in the key’s position):</p>
<pre class="prettyprint">struct envelope{<br />    uint32_t key_material;<br />    uint32_t checksum; //key at the end of encryption<br />    P2P_payload payload; //encrypted<br />}</pre>
<p class="centered-caption">Code snippet 5: P2P envelope.</p>
<p>Again, the<em> key_material</em> is used in the same way to create a decryption key, just with a different public key (but it is still present in the binary itself). The encryption/decryption function is almost the same – only the internal rotation rotates seven bits to the right and the multiplication by two is substituted by a multiplication by eight. In terms of <em>encryptC2</em> it means a change in the initial and subsequent assignment of <em>tmpCharacter</em>. The key derivation is symmetric and thus both the request and the response are encrypted in this way (in the case of C2 the response <em>key_material</em> was borrowed from the request). After decryption another structure is revealed, as shown in code snippet 6.</p>
<pre class="prettyprint">struct P2P_payload{<br />    uint32_t sizeNflag; //first 28 bits encode size, last 4 bits flags<br />    uint8_t data[sizeNflag &gt;&gt; 4];<br />}</pre>
<p><span class="centered-caption">Code snippet 6: P2P payload.</span></p>
<pre>{<br />   'checksum': 846509928,<br />   'payload':<br />       {'data': #Response<br />       {'resources':<br />       {<br />          'lenDecompressed': '\xfa\x00\x00\x00', #If matches size then no compression is used<br />          'resourceList':<br />               [{'data': '195.123.218.161',<br />               'id': '0x83859c0c020c1588',<br />               'name': 'Necurs C&amp;C IP 1',<br />               'size': 15},<br />               {'data': '91.228.239.202',<br />               'id': '0x83859de097b5e451',<br />               'name': 'Necurs C&amp;C IP 2',<br />               'size': 14},<br />               {'data': '185.12.94.179',<br />               'id': '0x83859fb52d5fb31a',<br />               'name': 'Necurs C&amp;C IP 3',<br />               'size': 13},<br />               {'data': '\x06\x02\x00\x00\x00\xa4\x00\x00RSA1...',<br />               'id': '0x7c7b239242b0aec2',<br />               'name': 'Public Key 2',<br />               'size': 148}],<br />          'seed': 1985624185,<br />          'size': 246},<br />       'signature': '+\xfc]\xf2\xda\xed\xaf\xd3O\xbe\xff\xf5\x0b\xb8...',<br />       'size': 270,<br />       'version': 1500908609},<br />       'flags': 1,<br />       'size': 534},<br />   'key': 2766267297L<br />}</pre>
<p class="centered-caption"> Code snippet 7: Python dictionary with a parsed P2P response. (Note that the signature and the private key have been truncated due to their size.)</p>
<p>The structure of the data section depends on the message flags. During the analysis, two types of messages were encountered. The first was a message request with flag 0 (let’s call it <em>greetings</em>) and a response with flag 1, as shown in code snippets 8 and 9.</p>
<pre class="prettyprint">struct greetings{<br />   uint64_t millisSince1900;<br />   uint64_t lastReceivedVersion;<br />   uint8_t flags;<br />}</pre>
<p><span class="centered-caption">Code snippet 8: P2P ‘greetings’ message.</span></p>
<pre class="prettyprint">struct response{<br />   uint32_t lenDecompressedLowBytes;<br />   uint8_t lenDecompressedHighByte;<br />   uint24_t size;<br />   resources rsrc; //same structure as resources bundled with binary<br />   uint8_t signature[20];<br />}</pre>
<p><span class="centered-caption">Code snippet 9: P2P response.</span></p>
<p>The resources in the response are in the same format as Necurs’ own resources (cf. [<a href="#ref1">1</a>]) and are encrypted in the same way, with the same linear congruential PRNG. The resources are compressed by aPLib – at least until the length is equal to a parameter in one of the outer layers.</p>
<p>For the most part, there were three C&amp;C IP addresses (under the IDs 0x83859c0c020c1588, 0x83859de097b5e451 and 0x83859fb52d5fb31a), an RSA public key containing a shared secret for C2 messages (with the same ID as in the bundled resources: 0x7c7b239242b0aec2) and the C2 site path (also with the same ID as the one in the bundled resources: 0x6fa46c4146c2c285).</p>
<p>Interestingly, a peer list is never sent through the P2P protocol which, as [<a href="#ref1">1</a>] speculates, is probably to mitigate risks of P2P poisoning. This property of the P2P protocol guarantees that preventing the restoration of the connection through the P2P connection would require a massive number of mock clients or the cleaning of a significant number of infected computers.</p>
<p> </p>
<h3><a class="chapter" name="h3-13-spam-protocol"></a>1.3 Spam protocol</h3>
<p>The spam protocol is handled by a separate module that is downloaded by the Necurs binary. The list of C&amp;Cs responsible for the distribution of email templates is passed as a parameter at the module’s startup. The module tries periodically to contact these servers and retrieve email templates. These templates contain variables, which we will refer to as resources, that have to be retrieved separately using the same protocol.</p>
<p>This protocol has a significantly weaker key-derivation protocol and thus it is possible to analyse every message in the protocol, separately, on-the-fly, and without any further data such as a shared secret. However, the structures of the request and response are a little different and thus we shall deal with them separately.</p>
<p>Moreover, this protocol does not contain any signatures. This makes the protocol vulnerable to hijacking. In order to carry out such an attack, an attacker would need to be able to misdirect the requests and craft the right responses.</p>
<p> </p>
<h4><a class="chapter" name="h4-131-request"></a>1.3.1 Request</h4>
<p>Requests have quite a simple envelope, as shown in code snippet 10.</p>
<pre class="prettyprint">struct mailer_request{<br />   uint8_t data;<br />   uint32_t crc32;<br />   uint32_t key;<br />}</pre>
<p><span class="centered-caption">Code snippet 10: Mailer module request envelope.</span></p>
<p>The <em>crc32</em> field is obfuscated – it needs to be rotated five bits to the right and XORed by the <em>key</em> field to yield a matching CRC32 checksum. Furthermore, the data may be compressed by QuickLZ, depending on the sixth bit of the key. The resulting data is pure JSON with obfuscated keys. Again, the data is encrypted by a simple cipher, as shown in code snippet 11.</p>
<pre class="prettyprint">uint32_t encryptSpam(char* data, uint32_t length, uint32_t key){<br />   key = (key &gt;&gt; 0xF | key &lt;&lt; 0x11);<br />   while (length &gt; 0){<br />        uint32_t rotated = (key &gt;&gt; 0xB | key &lt;&lt; 0x15);<br />        key += (0x359038a9 * key) ^ rotated;<br />        *data += key;<br />        data++;<br />        length--;<br />   }<br />}</pre>
<p class="centered-caption">Code snippet 11: Mailer module encryption.</p>
<p>Interestingly, when sending a request for an email template, the structure contained a blank dictionary where later a resource name was located in a resource request.</p>
<pre>{"vmjSIoC":421212,"WoVEf3A":"viqnn61","GDncpsW":"body","dg3XGB9":1500452112}</pre>
<p class="centered-caption">Code snippet 12: ‘Body’ resource request.</p>
<pre>{"vmjSIoC": 421212,"WoVEf3A": "zOPeFRx","GDncpsW":{"gzAfKVf": true,"Qet4BWy": "example.com","6G18OEO": 0,"tGeZADS": []},"dg3XGB9": 1500453539}</pre>
<p class="centered-caption"> Code snippet 13: Email request.</p>
<pre>{"vmjSIoC":421212,"nCZ1DIN":{"T3BtGhH":413704}}</pre>
<p class="centered-caption"> Code snippet 14: Blank response.</p>
<p>Despite the fact that not all of them were used by the script, all of the previously ‘advertised’ resources were accessible by such requests. Some of these were encoded in Base64. Some of the advertised categories were: ‘<em>body</em>’, ‘<em>domains_neutral’</em>, ‘<em>eng_Female_Names</em>’, ‘<em>eng_Names</em>’, ‘<em>eng_Surnames</em>’, ‘<em>1.doc</em>’, ‘<em>2.doc</em>’, ‘<em>3.doc</em>’, ‘<em>job</em>’, ‘<em>links</em>’, ‘<em>nasdaq</em>’, ‘<em>subj</em>’, ‘<em>top500</em>’ and ‘<em>wikibook.003</em>’. The most interesting contents were in resources labelled ‘<em>links</em>’, which contained URLs to several dating sites, and .doc files which were .zip archives containing JavaScript, Visual Basic Script (VBS) or other payloads.</p>
<pre>{"vmjSIoC":421212,"nCZ1DIN":{"4EaUhIt":"links","Ew7Rtuh":138,"R9Y2jrb":2289142366,"01GYBCt":["asfdating.ru",<br />"qwedating.ru","dtidating.ru","omgdating.ru","bgodating.ru","mlkdating.ru","rtydating.ru","fghdating.ru","dfgdating.ru","xcvdating.ru"]}}</pre>
<p class="centered-caption"> Code snippet 15: An example of a response with ‘links’.</p>
<p>Unfortunately, there are still some unknowns. While it was possible to request several unadvertised payloads, they were outdated and possibly came from an old malware campaign. However, while reversing the P2P protocol (old C&amp;C addresses ceased to respond and new ones were not recovered in time) <em>SpiderLabs</em> [<a href="#ref2">2</a>] reported another Necurs email campaign. A week later, there was a spam campaign and thus it was once again possible to recover all the resources. Nevertheless, the samples did not contain said malware. Several conjectures can be made: either the origin was misidentified, the botnet is partitioned (a conjecture supported by the varying shared secrets), or the files were reset to a previous version possibly in order to hinder malware sample retrieval.</p>
<p>Code snippet 16 shows an example of an email template. The email was sent during one of many ‘Russian lonely ladies’ spam campaigns. Note that there are some functions that give the email some randomness (e.g. <em>rndstr</em>) and there are also some resources to be inserted (<em>eng_Surnames</em>, <em>eng_Names</em>, <em>domains_neutral</em>, <em>links</em>). Also note that the template was written erroneously – instead of an email address being inserted into the email’s signature, only a ‘nonsensical’ (<em>address</em>) is used.</p>
<pre>%%var visa = {{uppercase(rndstr(7,7))}}<br />%%var bound1 = {{lowercase(rndhex(32,32))}}<br />%%var bound2 = {{rndnum(3,3)}}<br />%%var f_sname = {{[eng_Surnames]}}<br />%%var f_name = {{[eng_Names]}}<br />%%var fromname = {{f_name}} {{f_sname}}<br />%%var fromdomain = {{spf_host([domains_neutral])}}<br />%%var fromaddr = {{[links]}}</pre>
<pre>Received: from root by {{visa}}.local with local (Exim 4.84_2)<br />(envelope-from &lt;{{fromaddr}}&gt;)<br />id {{rndstr(6,6)}}-{{rndstr(6,6)}}-{{rndstr(2,2)}}<br />for {{to_addr}}; {{date}}<br />To: {{to_addr}}<br />Subject: Hello<br />Date: {{date}}<br />From: "Marie" &lt;{{fromaddr}}&gt;<br />Reply-To: {{fromaddr}}<br />Message-ID: &lt;{{rndhex(32,32)}}@{{fromdomain}}&gt;<br />MIME-Version: 1.0<br />Content-Type: text/plain; charset="UTF - 8"<br />Content-Transfer-Encoding: 8bit</pre>
<pre>Hello, Dear!<br />How is it going?<br />I'm Marie, may I ask your name?<br />I see you frequently visit this site, so I wanted to talk to you today but you had already left the chat.<br />I guess you would like to chat with me too, wouldn't you?..<br />Write me a few lines some time - believe me, you won't regret it, I guarantee.<br />I look forward to get a sweet e-mail from you.<br />My email (address)</pre>
<pre>Yours faithfully,<br />Maria</pre>
<p class="centered-caption">Code snippet 16: An email template received from Necurs C&amp;C.</p>
<p> </p>
<h4><a class="chapter" name="h4-132-response"></a>1.3.2 Response</h4>
<p>The encryption function used in the case of a response is almost the same as the one listed in the request, only the initial key rotation is missing. The key vulnerability lies in the envelope, while the key used in encryption is obtained by XORing the key from the <em>mailer_request</em> struct and the request key. This key is also used to mask CRC32 by XORing these two values. Since CRC32 is computed from the ciphertext, XORing the real CRC32 and the value in the struct gives us the encryption key.</p>
<p>If the response contains the email template, it also contains IDs to dictionaries from which the variables are drawn, and a list of recipients. Interestingly, it seems that the list of recipients is drawn pseudo-randomly from a larger database.</p>
<p> </p>
<h2><a class="chapter" name="h2-2-tracked-campaigns-overview"></a>2. Tracked campaigns – overview</h2>
<p>Necurs has gone through various interesting attack vectors and strategies during the last year. We saw a massive Locky campaign in early fall 2017. During this campaign, we were able to recover the vast majority of samples provided by the tracked Necurs branch and were therefore able to observe Locky’s development closely. In mid-January 2018, Necurs spread a pump-and-dump campaign targeting <em>SwissCoin</em>. The last big campaign we observed in the tracked branch was throughout April 2018, when Necurs surprised us by using .url attachments to retrieve malicious scripts served through the SMB protocol. As the scripts were saved on a network drive, we were able to recover them <em>en masse</em>. These campaigns were often connected to QuantLoader – nevertheless, we were in for a surprise when we observed completely different scripts. While there is no ‘serious’ campaign running at the moment, the botnet is still spreading mainly suggestive emails from ‘Russian women’.</p>
<p>At the end of April (25 April 2018) we received a script that was surprisingly nice – in that the code was readable – and it looked like a control panel intended to spread malware belonging to the Agony family. However, our deduction proved to be false, as the recovered payloads contained Flawed Ammyy only. Figure 1 shows the chain of infection.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/2015/4392/4099/relation.png" alt="relation.png" width="813" height="1144" /><span class="centered-caption">Figure 1: Chain of infection.</span></p>
<p> </p>
<h3><a class="chapter" name="h3-21-vbs-control-panel"></a>2.1 VBS control panel</h3>
<p>The first step the botnet takes to infect a user is a spam email, like the one shown in code snippet 16, with an attachment containing an ‘Internet’ shortcut file that includes a link to a malicious VBS (see Figure 2). The attackers try to trick victims into running this file by using misleading file icons.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/8415/4392/9284/link.png" alt="link.png" width="444" height="141" /><span class="centered-caption">Figure 2: Internet shortcut.</span></p>
<p>The attackers decided to use <em>file://</em> instead of <em>http://</em> or <em>https://</em>, which allows the system to download and execute the script using the SMB protocol when the victim clicks on ‘Open’ in the warning dialog that appears (see Figure 3) instead of opening the browser to dereference the link.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/8815/4392/9345/dial.png" alt="dial.png" width="471" height="307" /><span class="centered-caption">Figure 3: Script run directly from remote storage.</span></p>
<p>After decoding the malicious VBScript, we saw well structured code. There are even debug logs for each function. The script will be further examined in the following section. The analysis will be based on the first two versions of the aforementioned VBScript.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/5d2bdbd288640bbf1100fbbf16aa838f_f3205.png" alt="orig_vbs.png" width="844" height="570" /><span class="centered-caption">Figure 4: Original VBS.</span></p>
<p> </p>
<h3><a class="chapter" name="h3-22-version-differences"></a>2.2 Version differences</h3>
<p>We discovered two successive versions of the control panel. The second version shows that the script went through a refactoring process. The <em>Agony</em> function was replaced by a simple <em>Sleep</em> function call. Similarly, the authors began to obfuscate the code, as the rather descriptive function name <em>sGetAV</em> was replaced by <em>func15</em>. The installation procedure also went through simplification and now only one file is dropped into <em>%APPDATA%</em>.</p>
<p>Even the communication protocol underwent some changes and was, again, simplified. Only its abilities to update (<em>update</em>), download and execute the PE file (<em>download</em>), and uninstall (<em>uninstall</em>) were preserved. Figure 5 shows the similarities between the two versions.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/8ee2c002bfaa47dd829d6d330773da2b_f3192.png" alt="diff.png" width="840" height="332" /><span class="centered-caption">Figure 5: Similarities between v1 and v2.</span></p>
<p> </p>
<h3><a class="chapter" name="h3-23-vbs-control-panel-functions"></a>2.3 VBS control panel functions</h3>
<p>Both versions of the malicious VBS are fully functional control panels with several commands. Functions contained in these scripts are, for the most part, surprisingly self‑descriptive, which is why we will only briefly touch upon them (see also Figures 6–12). Note that these functions are not obfuscated, their names describe their purpose rather well, and they provide extensive logging. As mentioned, this was partially remedied in newer versions.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/44e3912082215c651afe7fcb98fcc378_f3191.jpg" alt="Botception-fig6.jpg" width="680" height="391" /><span class="centered-caption">Figure 6: Function to download and execute additional executable.</span></p>
<p class="centered-caption"><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/519d8b905d208070d2f3230456bc02f3_f3193.jpg" alt="Botception-fig7.jpg" width="680" height="196" /><span class="centered-caption">Figure 7: Function to download and execute additional dll.</span></p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/6152981d0e369f22c730faef29f2f406_f3194.jpg" alt="Botception-fig8.jpg" width="820" height="341" /><span class="centered-caption">Figure 8: Function to update all instances of script.</span></p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/3d599be52344db39530da136cbbcafc8_f3195.jpg" alt="Botception-fig9.jpg" width="820" height="312" /><span class="centered-caption">Figure 9: Function to write space in all instances of script and kill process.</span></p>
<p class="centered-caption"><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/b17dab542f046cd74eaa87c973487f87_f3196.jpg" alt="Botception-fig10.jpg" width="820" height="268" /><span class="centered-caption">Figure 10: Function to carry out DDoS attack on provided target.</span></p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/4375cdc7ff3038cd6955bf45602a7532_f3197.jpg" alt="Botception-fig11.jpg" width="843" height="195" /><span class="centered-caption">Figure 11: Several functions to add persistence.</span></p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/4960e72aa8f82242ea85fc03e4932bff_f3198.jpg" alt="Botception-fig12.jpg" width="843" height="177" /><span class="centered-caption">Figure 12: All commands and functions are logged.</span></p>
<p> </p>
<h3><a class="chapter" name="h3-24-flawed-ammyy"></a>2.4 Flawed Ammyy</h3>
<p>Although we recovered the scripts, links to the issued payloads were already down. Fortunately, we managed to obtain one payload, through <em>VirusTotal</em>, which we call the ‘stager’. Some basic anti-debugging and anti-emulator tricks are employed by the stager. For instance, there are two rather long loops in the binary which call external functions, but which do not cause any observable side effects. Moreover, the stager performs a case-insensitive check to see if the following processes are running on the system: <em>LSASS.EXE</em>, <em>SMSS.EXE</em>, <em>DWM.EXE</em>, <em>EXPLORER.EXE</em>, <em>SVCHOST.EXE</em>. Also, the <em>QueryPerformanceCounter</em> is called n-times and checks whether it fits in a certain bound. If these checks pass, the stager proceeds to the functional part.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/2915/4392/9686/loop.png" alt="loop.png" width="495" height="228" /><span class="centered-caption"> Figure 13: Anti-emulation loop calling QueryPerformanceCounter repeatedly.</span></p>
<p>At first, <em>AMMYY foundation</em> folders are deleted from <em>%APPDATA%</em> along with some other files, mostly containing settings or utilities for remote administration or old versions of the malware. Similarly, <em>ammyy</em> and <em>foundation</em> services are halted and deleted through<em> net.exe</em> (see Figure 14). Afterwards, the stager checks if<em> AhnLab V3 Internet Security</em>, <em>Bitdefender</em> or <em>Panda Cloud AV</em> are present – detecting the presence of one of these products could result in the stager’s termination.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/08dc070869087cf5a530dedefc74c890_f3200.jpg" alt="Botception-fig14.jpg" width="480" height="371" /><span class="centered-caption">Figure 14: Ammy-related service deletion.</span></p>
<p>Lastly, the stager discerns its purpose. It downloads an encrypted payload from <em>http://79.137.127.216/btf.dat</em> (see Figure 15). The payload is encrypted by RC4 stream cipher and the password is, to our surprise, an unobfuscated, hard‑coded string: <em>sfgdgdghfghfg35456657dsfrgdgdgxf34545</em>.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/3d8c315bdeab6730724786bd98abf145_f3201.jpg" alt="Botception-fig15.jpg" width="480" height="250" /><span class="centered-caption">Figure 15: Payload retrieval from a hard-coded address.</span></p>
<p>The encrypted file is temporarily saved to<em> %APPDATA%SettingsGUID_wsus.tmp</em>, the stager decrypts the data from the file and then saves the decrypted data to <em>%APPDATA%Settingswsus.exe</em> (Figure 16). This new file is then executed and the stager terminates.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/75a15bca5da170621a3939bb4c7d4acb_f3202.jpg" alt="Botception-fig16.jpg" width="480" height="245" /><span class="centered-caption">Figure 16: Payload decryption with a hard-coded key.</span></p>
<p>The last stage is contained in the decrypted data. Disappointingly, the last stage is an ordinary Flawed Ammyy remote administration tool (RAT). Flawed Ammyy is based on the leaked source code of <em>Ammyy Admin</em> (version 3), a legitimate form of remote desktop software. It has various capabilities such as remote desktop, file transfer, proxy or voice chat.</p>
<p>While it is possible that the RAT may be used to further prolong the infection chain, we have not been able to recover any additional data.</p>
<p> </p>
<h2><a class="chapter" name="h2-references"></a>References</h2>
<p><a class=" anchor" name="ref1"></a>[1] Krasuski, A. Necurs – hybrid spam botnet. 2016. <a href="https://www.cert.pl/en/news/single/necurs-hybrid-spam-botnet/" target="_blank">https://www.cert.pl/en/news/single/necurs-hybrid-spam-botnet/</a>.</p>
<p><a class=" anchor" name="ref2"></a>[2] Mendrez, R.; Carsula, G.; Ramos, N.; Pacag, H. Tale of the Two Payloads – TrickBot and Nitol. 2017. <a href="https://www.trustwave.com/Resources/SpiderLabs-Blog/Tale-of-the-Two-Payloads-%E2%80%93-TrickBot-and-Nitol/" target="_blank">https://www.trustwave.com/Resources/SpiderLabs-Blog/Tale-of-the-Two-Payloads-%E2%80%93-TrickBot-and-Nitol/</a>.</p> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<p><a href="/uploads/pdf/magazine/2018/201812-botception.pdf" target="_blank"><img src="/uploads/images/buttons/pdf-download-button.jpg" alt="Download PDF" width="262" height="45" /></a></p>
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=Botception: botnet distributes script with bot capabilities&url=https://www.virusbulletin.com/virusbulletin/2018/12/botception-botnet-distributes-script-bot-capabilities"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2018/12/botception-botnet-distributes-script-bot-capabilities'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2018/12/botception-botnet-distributes-script-bot-capabilities&title=Botception: botnet distributes script with bot capabilities"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2018/12/botception-botnet-distributes-script-bot-capabilities&t=Botception: botnet distributes script with bot capabilities"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2018/12/botception-botnet-distributes-script-bot-capabilities"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p> </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">©1989-2022 Virus Bulletin.        <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>        <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>        <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>