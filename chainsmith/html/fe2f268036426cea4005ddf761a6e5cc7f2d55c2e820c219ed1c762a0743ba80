<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/css/main.css?id=b3e7fe8a6c3736dca145" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Joan Calvet',
        'ArticleCategory': '',
        'ArticleSection': '(not set)',
        'cookie-bar-hq': true
    });
</script>
<script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>

<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Casper Malware: After Babar and Bunny, Another Espionage Cartoon | WeLiveSecurity</title>
<meta name="description" content="In this post, we lift the veil on Casper - another piece of software that we believe to have been created by the same organization that is behind Babar and Bunny."/>
<link rel="canonical" href="https://www.welivesecurity.com/2015/03/05/casper-malware-babar-bunny-another-espionage-cartoon/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Casper Malware: After Babar and Bunny, Another Espionage Cartoon | WeLiveSecurity" />
<meta property="og:description" content="In this post, we lift the veil on Casper - another piece of software that we believe to have been created by the same organization that is behind Babar and Bunny." />
<meta property="og:url" content="https://www.welivesecurity.com/2015/03/05/casper-malware-babar-bunny-another-espionage-cartoon/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:published_time" content="2015-03-05T13:55:35+00:00" />
<meta property="article:modified_time" content="2015-03-05T14:31:13+00:00" />
<meta property="og:updated_time" content="2015-03-05T14:31:13+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2015/03/Casper_Bunny_Babar_NBOT.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2015/03/Casper_Bunny_Babar_NBOT.jpg" />
<meta property="og:image:width" content="623" />
<meta property="og:image:height" content="410" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="In this post, we lift the veil on Casper - another piece of software that we believe to have been created by the same organization that is behind Babar and Bunny." />
<meta name="twitter:title" content="Casper Malware: After Babar and Bunny, Another Espionage Cartoon | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2015/03/Casper_Bunny_Babar_NBOT.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/2015/03/05/casper-malware-babar-bunny-another-espionage-cartoon/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2015/03/05/casper-babar-bunny-otro-dibujo-espionaje/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2015/03/05/casper-malware-neuer-spionage-cartoon-nach-babar-und-bunny/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single noimage">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>

<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2015/03/05/casper-babar-bunny-otro-dibujo-espionaje/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2015/03/05/casper-malware-neuer-spionage-cartoon-nach-babar-und-bunny/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://welivesecurity.com/category/ukraine-crisis-digital-security-resource-center/">
                                            Ukraine Crisis – Digital Security Resource Center                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/we-live-progress/">
                                            We Live Progress                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2015/03/05/casper-babar-bunny-otro-dibujo-espionaje/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2015/03/05/casper-malware-neuer-spionage-cartoon-nach-babar-und-bunny/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong>					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-noimage">
	<div class="container promo-text">
		<div class="inner clearfix">
			<div class="col-md-11 col-sm-11 col-xs-12 no-padding">
				<h1>Casper Malware: After Babar and Bunny, Another Espionage Cartoon</h1>
<div class="excerpt">In this post, we lift the veil on Casper - another piece of software that we believe to have been created by the same organization that is behind Babar and Bunny. </div>
<div class="post-meta">
    <div class="wls-authors">
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2015-03-05 13:55:35">5 Mar 2015 - 01:55PM</time>
		</span>
			</span>
</div>
			</div>
		</div>
	</div>
</div>	

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2015%2F03%2F05%2Fcasper-malware-babar-bunny-another-espionage-cartoon%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2015%2F03%2F05%2Fcasper-malware-babar-bunny-another-espionage-cartoon%2F&text=Casper Malware: After Babar and Bunny, Another Espionage Cartoon%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2015%2F03%2F05%2Fcasper-malware-babar-bunny-another-espionage-cartoon%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt noimage">
                                <p>In this post, we lift the veil on Casper &#8211; another piece of software that we believe to have been created by the same organization that is behind Babar and Bunny. </p>
                            </div>

                            <p>In March 2014, French newspaper <a href="http://www.lemonde.fr/international/article/2014/03/21/quand-les-canadiens-partent-en-chasse-de-babar_4387233_3210.html" target="_blank">Le Monde</a> revealed that France is suspected by the Communications Security Establishment Canada (CSEC) of having developed and deployed malicious software for espionage purposes. This story was based on presentation slides leaked by Edward Snowden, which were then published by Germany’s <a href="http://www.spiegel.de/media/media-35683.pdf" target="_blank">Der Spiegel</a> in January 2015.</p>
<p>According to the CSEC presentation, the malicious software in question is called “Babar” by its creators, likely after the famous French cartoon character “<a href="http://en.wikipedia.org/wiki/Babar_the_Elephant" target="_blank">Babar The Elephant</a>”. Since then, several malware researchers have begun to work on the enigma that is Babar. Marion Marschalek (Cyphort) struck first, with <a href="http://www.cyphort.com/evilbunny-malware-instrumented-lua/" target="_blank">her report on the “Bunny” malware</a>. Bunny shares some characteristics with the Babar malware described by CSEC. In mid-February, Marion published <a href="http://www.cyphort.com/babar-suspected-nation-state-spyware-spotlight/" target="_blank">another report</a>, this time on the actual Babar case, explaining in great detail its spying features. At the same time, Paul Rascagnères (G Data) published a <a href="https://blog.gdatasoftware.com/blog/article/babar-espionage-software-finally-found-and-put-under-the-microscope.html" target="_blank">blog post</a> on the similarities between Babar and Bunny, and showed that they were very probably related to the malware described in the CSEC’s slides.</p>
<p>In this blog post, we lift the veil on another piece of software that we believe to have been created by the same organization that is behind Babar and Bunny. This component is called “Casper” by its authors – presumably named after yet another famous cartoon character.</p>
<p>Casper was used against Syrian targets in April 2014, which makes it the most recent malware from this group publicly known at this time. To attack their targets, Casper’s operators used <a href="http://virusradar.com/glossary/zero-day" target="_blank">zero-day</a> exploits in Adobe <a href="/search/?s=Flash&amp;x=0&amp;y=0" target="_blank">Flash</a>, and these exploits were – surprisingly – hosted on a Syrian governmental website. Casper is a well-developed reconnaissance tool, making extensive efforts to remain unseen on targeted machines. Of particular note are the specific strategies adopted against antimalware software.</p>
<h1>Context</h1>
<p>In mid-April 2014, Vyacheslav Zakorzhevsky (Kaspersky) observed that <a href="http://securelist.com/blog/incidents/59399/new-flash-player-0-day-cve-2014-0515-used-in-watering-hole-attacks/" target="_blank">the website &#8220;jpic.gov.sy&#8221; was hosting two Flash zero-day exploits</a>, targeting the vulnerability later labeled CVE-2014-0515. This website was set up in 2011 by the Syrian Justice Ministry apparently to allow Syrian people to ask for reparation for the damage of the civil war. The website is still online and apparently currently clean, although it was <a href="http://www.zone-h.org/mirror/id/22851174?zh=2" target="_blank">defaced in September 2014</a> by some &#8220;hacktivist&#8221;.</p>
<p>At the time of the events, Zakorzhevsky could not retrieve the payloads distributed by these Flash zero-days exploits. ESET researchers were able to find two of these payloads, thanks to <a href="http://www.eset.com/int/about/technology/#livegrid" target="_blank">ESET LiveGrid</a>® threat telemetry systems. The URLs of these payloads and the dates when they were seen correspond to Zakorzhevsky’s description.</p>
<p>In a joint effort with Marion Marschalek, Paul Rascagnères, and researchers from the <a href="http://www.circl.lu/" target="_blank">Computer Incident Response Center Luxemboug</a> (CIRCL), we were recently able to determine that the payloads distributed were very likely developed by the same actors who developed the Babar and Bunny software.</p>
<h1>Casper Binary Analysis</h1>
<p>The two samples we found are the same core program but differently packaged. The first sample is an executable dropping the core program and making it persistent on the machine. The second is a Windows library that deploys the core program directly into memory, also in the form of a library. In this latter case, the name of the core program library was left visible by its creators: “<span style="font-family: 'courier new', courier;"><strong>Casper_DLL.dll</strong></span>”.</p>
<p>Throughout this blog, we will focus on the first of these two payloads, the second one being similar in terms of behavior.</p>
<h2>Dropper</h2>
<p>The dropper is named “<span style="font-family: 'courier new', courier;">domcommon.exe</span>” and its compilation date is set to the June 18<sup>th</sup>, 2010. This is very likely a forged date, as we will explain later.</p>
<p>Its execution is based on an XML configuration file decrypted at runtime with the RC4 algorithm and a hardcoded 16-byte key. Before the decryption, the program uses a checksum computation to make sure the memory area containing the decryption key has not been modified. Figure 1 shows the dropper’s decrypted configuration file.</p>
<div id="attachment_59085" style="width: 650px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2015/03/Figure-1.png"><img class="wp-image-59085" src="/wp-content/uploads/2015/03/Figure-1.png" alt="Figure 1 - Casper Dropper Configuration File" width="640" height="191" srcset="https://www.welivesecurity.com/wp-content/uploads/2015/03/Figure-1.png 1204w, https://www.welivesecurity.com/wp-content/uploads/2015/03/Figure-1-300x89.png 300w, https://www.welivesecurity.com/wp-content/uploads/2015/03/Figure-1-1024x305.png 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a><p class="wp-caption-text">Figure 1 &#8211; Casper Dropper Configuration File</p></div>
<h2>Casper Playing Chess against Antivirus</h2>
<p>Firstly, the dropper extracts the <span style="font-family: 'courier new', courier;">&lt;STRATEGY&gt;</span> tag from its configuration file. This tag defines precisely how the malware should behave, depending on which antivirus is present on the machine.</p>
<h4>Choosing the appropriate strategy</h4>
<p>First, the dropper retrieves the name of any antivirus that may be running on the machine by executing the <a href="https://msdn.microsoft.com/en-us/library/aa394582%28v=vs.85%29.aspx" target="_blank">Windows Management Instrumentation</a> (WMI) request “<span style="font-family: 'courier new', courier;">SELECT * FROM AntiVirusProduct</span>” and fetching the “<span style="font-family: 'courier new', courier;">displayName</span>” field from the result. If an <span style="font-family: 'courier new', courier;">&lt;AV&gt;</span> tag exists in the configuration file with a <span style="font-family: 'courier new', courier;">“NAME”</span> attribute matching the name of an installed antivirus product, it will be set as the execution strategy. In this case, four antivirus products have a defined strategy.</p>
<p>If no strategy is found for the running antivirus, or if no antivirus is protecting the computer, the default strategy described in the <span style="font-family: 'courier new', courier;">&lt;STRATEGY&gt;</span> tag’s attributes will be applied. Alternatively, if a file named &#8220;<span style="font-family: 'courier new', courier;">strategy.xml&#8221;</span> is present in the dropper’s folder, it will override the strategy from the configuration file.</p>
<h4>Possible Moves</h4>
<p>A strategy is a set of attributes that influences both the dropper and the payload execution. Some of these attributes define <em>how</em> to realize certain actions, whereas the others define <em>whether </em>to perform certain actions. The following array describes the various “moves” offered by these attributes.</p>

<table id="tablepress-56" class="tablepress tablepress-id-56">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong>Attribute</strong></th><th class="column-2"><strong>Attribute Purpose</strong></th><th class="column-3"><strong>Possible Value</strong></th><th class="column-4"><strong>Value Meaning</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td rowspan="4" class="column-1">RUNKEY</td><td rowspan="4" class="column-2">Defines how the dropper will interact with the Windows registry in order to be persistent on the machine</td><td class="column-3">API</td><td class="column-4">Calls to Windows API functions<br />
(RegOpenKeyEx, RegQueryValueEx…)</td>
</tr>
<tr class="row-3 odd">
	<td class="column-3">BAT</td><td class="column-4">Execution of a batch file containing <a href="https://technet.microsoft.com/en-us/library/cc732643.aspx" target="_blank">“reg” commands</a></td>
</tr>
<tr class="row-4 even">
	<td class="column-3">REG</td><td class="column-4">Execution of “reg” commands in a command prompt process</td>
</tr>
<tr class="row-5 odd">
	<td class="column-3">WMI</td><td class="column-4">Calls to methods of the <a href="https://msdn.microsoft.com/en-us/library/aa393664(v=vs.85).aspx">StdRegProv WMI class</a></td>
</tr>
<tr class="row-6 even">
	<td rowspan="3" class="column-1">AUTODEL</td><td rowspan="3" class="column-2">Defines how the dropper will remove itself from the machine after its execution</td><td class="column-3">DEL</td><td class="column-4">Execution of a command line in a command prompt process</td>
</tr>
<tr class="row-7 odd">
	<td class="column-3">API</td><td class="column-4">Call to <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa365240%28v=vs.85%29.aspx">MoveFileEx</a> API function to delete the dropper during the next restart of the system</td>
</tr>
<tr class="row-8 even">
	<td class="column-3">WMI</td><td class="column-4">Execution of a command line in a command prompt process created through the <a href="https://msdn.microsoft.com/en-us/library/aa389388(v=vs.85).aspx">Create method of the Win32_Process WMI class</a></td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">INJECTION</td><td class="column-2">Defines whether the dropper and the payload will inject their code into a new process, or execute it in the initial process</td><td class="column-3">YES/NO</td><td class="column-4">N/A</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">SAFENOTIF</td><td class="column-2">Defines whether or not the payload will contact the C&amp;C server</td><td class="column-3">YES/NO</td><td class="column-4">N/A</td>
</tr>
<tr class="row-11 odd">
	<td rowspan="2" class="column-1">SERVICE</td><td rowspan="2" class="column-2">Likely defines how to interact with Windows services, but the code managing this attribute is missing in these Casper samples</td><td class="column-3">API</td><td class="column-4">N/A</td>
</tr>
<tr class="row-12 even">
	<td class="column-3">SC</td><td class="column-4">N/A</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">ESCAPE</td><td class="column-2">Defines whether the dropper will execute normally, or simply exit</td><td class="column-3">YES/NO</td><td class="column-4">N/A</td>
</tr>
<tr class="row-14 even">
	<td class="column-1">SCHEDULER</td><td class="column-2">Unknown. The code managing this attribute is missing in these Casper samples</td><td class="column-3">CMD</td><td class="column-4">N/A</td>
</tr>
</tbody>
</table>

<p>The possibilities offered by this <span style="font-family: 'courier new', courier;">&lt;STRATEGY&gt;</span> tag show that Casper’s authors have acquired an in-depth knowledge of behavioral detections in certain antivirus products.</p>
<p>For example, process injection will only happen on machines with none of the four defined antiviruses running, since in such a case the “<span style="font-family: 'courier new', courier;">INJECTION</span>” attribute will be set to “<span style="font-family: 'courier new', courier;">NO</span>”. Interestingly, three antiviruses have the “<span style="font-family: 'courier new', courier;">ESCAPE</span>” attribute set to “<span style="font-family: 'courier new', courier;">YES</span>”, which means the dropper will simply uninstall itself in their presence <strong>without</strong> deploying Casper’s payload.</p>
<p>As the list of <span style="font-family: 'courier new', courier;">&lt;AV&gt;</span> tags is pretty short, we can speculate that these are the antiviruses Casper’s authors expect to find on their targets. For the record, the “<span style="font-family: 'courier new', courier;">VERSION</span>” attribute present in one <span style="font-family: 'courier new', courier;">&lt;AV&gt;</span> tag is actually never used in the code, but it still indicates the intention to distinguish different versions of the same antivirus product. We very rarely see this level of precision employed in malware in order to bypass antivirus.</p>
<h3>Time To Drop The Payload</h3>
<p>In the event that the <span style="font-family: 'courier new', courier;">“ESCAPE”</span> attribute is set to <span style="font-family: 'courier new', courier;">“NO”</span> in the chosen strategy – as is the case with the default strategy – the dropper will then execute the commands provided in the form of XML tags in the configuration file, as shown in Figure 2.</p>
<div id="attachment_59093" style="width: 650px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2015/03/Figure-2.png"><img class="wp-image-59093" src="/wp-content/uploads/2015/03/Figure-2.png" alt="Figure 2 – Casper Dropper’s Commands" width="640" height="101" srcset="https://www.welivesecurity.com/wp-content/uploads/2015/03/Figure-2.png 975w, https://www.welivesecurity.com/wp-content/uploads/2015/03/Figure-2-300x47.png 300w" sizes="(max-width: 640px) 100vw, 640px" /></a><p class="wp-caption-text">Figure 2 – Casper Dropper’s Commands</p></div>
<h4>Uninstalling previous versions</h4>
<p>The first command instructs the dropper to remove other Casper instances that could possibly be running on the system. The corresponding <span style="font-family: 'courier new', courier;">&lt;UNINSTALL&gt;</span> tag comes with a <span style="font-family: 'courier new', courier;">“name”</span> attribute, which will be prefixed with the BIOS constructor name retrieved from the Windows registry (Intel, NEC…) before being used as an identifier. This prefixing is likely meant to avoid drawing the user’s attention if he or she happened to notice the identifier.</p>
<p>The program is uninstalled in two steps, each step addressing different methods of persistence employed by Casper:</p>
<ul>
<li>If it exists, the scheduled task whose name matches the identifier is removed from the system</li>
<li>If it exists, the application registered with the identifier in the Windows registry is removed from the system</li>
</ul>
<h4>Payload installation</h4>
<p>The payload installation is then directed by the <span style="font-family: 'courier new', courier;">&lt;INSTALL&gt;</span> tag, which provides two versions of the payload, one for 32-bit machines (<span style="font-family: 'courier new', courier;">&lt;x86&gt;</span>) and another one for 64-bit machines (<span style="font-family: 'courier new', courier;">&lt;x64&gt;</span>).</p>
<p>The attributes of the <span style="font-family: 'courier new', courier;">&lt;INSTALL&gt;</span> tag will then be used by one of the two installation methods previously mentioned. If the operating system is Windows 7 or newer, persistence will be set through a scheduled task; otherwise it will be set through the Windows registry key</p>
<p>“<span style="font-family: 'courier new', courier;">HKLM\Software\Microsoft\Windows\CurrentVersion\Run</span>”.</p>
<p>The <span style="font-family: 'courier new', courier;">&lt;INSTALL&gt;</span> tag provides an argument to give to the payload. The exact value of the argument is critical to the “correct” execution of the payload. The actual verification in the payload is subtle: the argument is used in a custom algorithm to find library functions in memory. Unless the value is correct, the addresses of these library functions will be wrong, resulting in a random-looking crash of the payload.</p>
<h4>Dropper cleans itself</h4>
<p>Before terminating its execution, the dropper removes itself from the system, using the method defined in the <span style="font-family: 'courier new', courier;">AUTODEL</span> attribute. It should be noted that the payload is not launched at this moment: it will be run only at the next startup thanks to the previous persistence method.</p>
<h2>Payload</h2>
<p>Similarly to the dropper, Casper payload’s execution is based on an XML configuration file decrypted at run-time, and shown in Figure 3.</p>
<div id="attachment_59094" style="width: 650px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2015/03/Figure-3.png"><img class="wp-image-59094" src="/wp-content/uploads/2015/03/Figure-3.png" alt="Figure 3 - Casper's Payload Configuration File" width="640" height="196" srcset="https://www.welivesecurity.com/wp-content/uploads/2015/03/Figure-3.png 975w, https://www.welivesecurity.com/wp-content/uploads/2015/03/Figure-3-300x92.png 300w, https://www.welivesecurity.com/wp-content/uploads/2015/03/Figure-3-522x160.png 522w" sizes="(max-width: 640px) 100vw, 640px" /></a><p class="wp-caption-text">Figure 3 &#8211; Casper&#8217;s Payload Configuration File</p></div>
<p>This configuration file starts with a timestamp, which corresponds to <strong>Monday, the 7th April 2014 at 21:27:05 GMT</strong>. Therefore, the compilation timestamps – set to 2010 – have very likely been forged.</p>
<p>A series of <span style="font-family: 'courier new', courier;">&lt;PARAM&gt;</span> tags will then control the payload’s behavior, as described in the following array.</p>

<table id="tablepress-57" class="tablepress tablepress-id-57">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong><PARAM> attribute</strong></th><th class="column-2"><strong>Purpose</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">ID</td><td class="column-2">Unknown. It could be used to distinguish operations, as the value is the same in the two payloads hosted on “jpic.gov.sy”.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">REGKEY</td><td class="column-2">Path in the Windows registry that will be used as storage area</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">URL</td><td class="column-2">C&amp;C server’s URL</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">KEY</td><td class="column-2">Cryptographic key for the communications with the C&amp;C server</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">DELAYMIN <br />
DELAYMAX<br />
DELAYRETRY</td><td class="column-2">Timers to configure the frequency of the contacts with the C&amp;C server</td>
</tr>
</tbody>
</table>

<p>The payload then generates a unique identifier for the machine and inserts it at the end of the configuration in a <span style="font-family: 'courier new', courier;">&lt;UID&gt;</span> tag. Finally, the configuration is RC4-encrypted and stored in the Windows registry.</p>
<p>The code handling the configuration shows certain capabilities not exploited in these Casper samples, for example a <span style="font-family: 'courier new', courier;">TIMETOLIVE</span> attribute to plan the termination of Casper after a certain amount of time, or a <span style="font-family: 'courier new', courier;">DELAYED_START</span> attribute to wait before interacting with the system.</p>
<p>Finally, the payload’s configuration contains the exact same <span style="font-family: 'courier new', courier;">&lt;STRATEGY&gt;</span> as the dropper.</p>
<h4>Report to C&amp;C</h4>
<p>During its first execution, Casper’s payload executes the following XML file:</p>
<p><span style="font-family: 'courier new', courier;">&lt;COMMAND name=&#8217;SYSINFO&#8217;/&gt;</span></p>
<p>The handler of the “<span style="font-family: 'courier new', courier;">SYSINFO</span>” command retrieves information about the system and builds a report containing several sections, as shown in Figure 4.</p>
<div id="attachment_59099" style="width: 407px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2015/03/figure-4.png"><img class="wp-image-59099 size-full" src="/wp-content/uploads/2015/03/figure-4.png" alt="figure 4" width="397" height="643" srcset="https://www.welivesecurity.com/wp-content/uploads/2015/03/figure-4.png 397w, https://www.welivesecurity.com/wp-content/uploads/2015/03/figure-4-185x300.png 185w" sizes="(max-width: 397px) 100vw, 397px" /></a><p class="wp-caption-text">Figure 4 &#8211; SYSINFO Command&#8217;s Result</p></div>
<p>The titles of the report sections are self-explanatory. Interestingly, the version of the malware is clearly mentioned: <strong>4.4.1</strong>. This report is then base64-encoded and sent to the <a href="http://virusradar.com/en/glossary/command-and-control-server" target="_blank">C&amp;C server</a> in the body of an HTTP POST request. It will also be written into a temporary file named “<span style="font-family: 'courier new', courier;">perfaudio.dat</span>”.</p>
<p>The network request will also have a cookie named “<span style="font-family: 'courier new', courier;">PREF</span>” filled with the concatenation of the machine UID, the configuration ID, the version of Casper and the hardcoded character “<span style="font-family: 'courier new', courier;">R</span>”, all base64-encoded.</p>
<h4>C&amp;C’s possible answers</h4>
<p>Due to the C&amp;C being down at the time of the investigation we can only speculate on the rest of the execution based on Casper’s known capabilities.</p>
<p>At this point, the binary regularly contacts the C&amp;C server with a cookie similar to the one in the <span style="font-family: 'courier new', courier;">SYSINFO</span> request, but this time with “<span style="font-family: 'courier new', courier;">G</span>” as the hardcoded character instead of “<span style="font-family: 'courier new', courier;">R</span>”. Our analysis of the binary reveals that the server can then send back a PNG image – with the correct header and format for a PNG file &#8212; from which a XML command file will be decrypted and executed.</p>
<p>In addition to the “<span style="font-family: 'courier new', courier;">SYSINFO</span>” command, Casper can handle <span style="font-family: 'courier new', courier;">&lt;COMMAND&gt;</span> tags with the following values:</p>
<ul>
<li>“<span style="font-family: 'courier new', courier;">EXEC</span>” to execute a program on the machine from its local path</li>
<li>“<span style="font-family: 'courier new', courier;">SYSTEM</span>” to execute commands in a Windows command prompt</li>
</ul>
<p>Finally, Casper can also handle <span style="font-family: 'courier new', courier;">&lt;PLUGIN&gt;</span> tags, whose content is a Windows executable to deploy on the machine.</p>
<h1>How Does Casper Relate to the Other Cartoons?</h1>
<p>Our best chance of establishing that the same developers are behind Bunny, Babar and Casper is to identify unusual code or algorithms shared between these various programs. In our comparison we also take into account the so-called “NBOT” malware (also known as the “TFC” malware), whose link with Babar and Bunny was established by Marion Marschalek in <a href="http://www.cyphort.com/babar-suspected-nation-state-spyware-spotlight/" target="_blank">her Babar report</a>. Here is a <strong>non-exhaustive</strong> list of such shared features we observed:</p>
<ul>
<li>Casper hides its calls to API functions by using a hash calculated from the functions’ names, rather than the names themselves. The hashing algorithm is a combination of rotate-left (ROL) of 7 bits and exclusive-or (XOR) operations. NBOT uses the exact same algorithm for the same purpose, whereas Babar hides its API calls in a similar manner but with a different algorithm.</li>
</ul>
<ul>
<li>Casper fetches information about the running antivirus in a way similar to Bunny, Babar, and NBOT, namely through the same WMI request. Moreover, all these malwares compute the SHA-256 hash of the first word of the antivirus name, although in Casper it is actually never used.</li>
<li>Casper generates delimiters for its HTTP requests by filling a specific format string with the results of calls to the <span style="font-family: 'courier new', courier;">GetTickCount</span> API function. The same code is present in some NBOT samples, as shown in the following array.</li>
</ul>
<div id="attachment_59100" style="width: 401px" class="wp-caption alignnone"><a href="/wp-content/uploads/2015/03/Casper-code.png"><img class="wp-image-59100 size-full" style="float: left; margin-right: 5px;" src="/wp-content/uploads/2015/03/Casper-code.png" alt="Extract of Casper’s code" width="391" height="325" srcset="https://www.welivesecurity.com/wp-content/uploads/2015/03/Casper-code.png 391w, https://www.welivesecurity.com/wp-content/uploads/2015/03/Casper-code-300x249.png 300w" sizes="(max-width: 391px) 100vw, 391px" /></a><p class="wp-caption-text">Extract of Casper’s code</p></div>
<div id="attachment_59101" style="width: 425px" class="wp-caption alignnone"><a href="/wp-content/uploads/2015/03/NBot-code.png"><img class="wp-image-59101 size-full" style="float: left; margin-right: 5px;" src="/wp-content/uploads/2015/03/NBot-code.png" alt="Extract of NBOT’s code" width="415" height="304" srcset="https://www.welivesecurity.com/wp-content/uploads/2015/03/NBot-code.png 415w, https://www.welivesecurity.com/wp-content/uploads/2015/03/NBot-code-300x219.png 300w" sizes="(max-width: 415px) 100vw, 415px" /></a><p class="wp-caption-text">Extract of NBOT’s code</p></div>
<ul>
<li>Casper removes its dropper by executing a Windows command created from the following format string:</li>
</ul>
<table>
<tbody>
<tr>
<td width="475">cmd.exe /C FOR /L %%i IN (1,1,%d) DO IF EXIST &#8220;%hs&#8221; (DEL &#8220;%hs&#8221; &amp; SYSTEMINFO) ELSE EXIT</td>
</tr>
</tbody>
</table>
<p>In some NBOT samples we can find the following similar syntax:</p>
<table>
<tbody>
<tr>
<td width="475">cmd.exe /C FOR /L %%i IN (1,1,%d) DO IF EXIST &#8220;%s&#8221; (DEL &#8220;%s&#8221; &amp; PING 127.0.0.1 -n 3) ELSE EXIT</td>
</tr>
</tbody>
</table>
<ul>
<li>Casper uses an “<span style="font-family: 'courier new', courier;">ID</span>” value set to “<span style="font-family: 'courier new', courier;">13001</span>”, whereas Babar samples contain an ID of “<span style="font-family: 'courier new', courier;">12075-01</span>”. Also, the malware discovered in 2009 by the CSEC possesses an ID of “<span style="font-family: 'courier new', courier;">08184</span>” (slide 8 of the <a href="http://www.spiegel.de/media/media-35683.pdf" target="_blank">CSEC slides</a>). This similar format, and the increasing value in decimal, could indicate a familial link.</li>
</ul>
<p>None of these signs alone is enough to establish a strong link but <strong>all the shared features together make us assess with high confidence that Bunny, Babar, NBOT and Casper were all developed by the same organization.</strong></p>
<h1 style="text-align: left;">Victimology</h1>
<p style="text-align: left;">According to our telemetry data, all the people targeted during this operation were located in Syria. These targets may have been the visitors of the “jpic.gov.sy” website &#8212; Syrian citizens who want to file a complaint. In this case they could have been redirected to the exploits from a legitimate page of this website.</p>
<p style="text-align: left;">But we were actually unable to determine if this were indeed the case. In other words, it is just as likely that the targets have been redirected to the exploits from another location, for example from a hacked legitimate website or from a link in an email. What is known for sure is that the exploits, the Casper binaries and the C&amp;C component were all hosted on this website’s server.</p>
<p style="text-align: left;">This leads us to a second hypothesis: the “jpic.gov.sy” website could have been hacked to serve as a storage area. This would have at least two advantages for the attackers: firstly, hosting the files on a Syrian server can make them more easily accessible from Syria, a country whose Internet connection to the outside world has been unstable since the beginning of the civil war, as shown in <a href="http://www.google.com/transparencyreport/traffic/explorer/?r=SY&amp;l=EVERYTHING&amp;csd=1301710971931&amp;ced=1413615600000" target="_blank">Google Transparency Report</a>. Secondly, it would mislead attribution efforts by raising suspicion against the Syrian government.</p>
<h1 style="text-align: left;">Conclusion</h1>
<p style="text-align: left;">As previously explained, we are confident that the same group developed Bunny, Babar and Casper. The detailed analysis of Babar in the CSEC slides from 2009 indicates this group is not a newcomer to the espionage business. The use of zero-day exploits is another indication that Casper’s operators belong to a powerful organization. Finally, the narrow targeting of people in Syria shows a likely interest in geopolitics.</p>
<p style="text-align: left;">Nevertheless, we did not find any evidence in Casper itself to point a finger at a specific country. In particular, no signs of French origin, as suggested by CSEC for Babar, were found in the binaries.</p>
<h1 style="text-align: left;">Hashes</h1>
<p style="text-align: left;">
<table id="tablepress-58" class="tablepress tablepress-id-58">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong>SHA1</strong></th><th class="column-2"><strong>Note</strong></th><th class="column-3"><strong>ESET Detection Name</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">75BF51709B913FDB4086DF78D84C099418F0F449</td><td class="column-2">DLL Dropper</td><td class="column-3">Win32/ProxyBot.B</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">7F266A5E959BEF9798A08E791E22DF4E1DEA9ED5</td><td class="column-2">DLL Dropper</td><td class="column-3">Win32/ProxyBot.B</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">E4CC35792A48123E71A2C7B6AA904006343A157A</td><td class="column-2">Executable Dropper</td><td class="column-3">Win32/ProxyBot.B</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">F4C39EDDEF1C7D99283C7303C1835E99D8E498B0</td><td class="column-2">X86 Executable Payload</td><td class="column-3">Win32/ProxyBot.B</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">C2CE95256206E0EBC98E237FB73B68AC69843DD5</td><td class="column-2">X64 Executable Payload</td><td class="column-3">Win32/ProxyBot.A</td>
</tr>
</tbody>
</table>
</p>
<h1 style="text-align: left;">Indicators of Compromise</h1>

<table id="tablepress-59" class="tablepress tablepress-id-59">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong>Indicator</strong></th><th class="column-2"><strong>Value</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Dropper’s file name</td><td class="column-2">domcommon.exe</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Payload’s file name</td><td class="column-2">aiomgr.exe</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">C&amp;C URLs</td><td class="column-2">hXXp://jpic.gov.sy/css/images/_cgi/index.php</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">Mutex name</td><td class="column-2">{4216567A-4512-9825-7745F856}</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">Key for configuration decryption</td><td class="column-2">7B 4B 59 DE 37 4A 42 26 59 98 63 C6 2D 0F 57 40</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">Temporary file name</td><td class="column-2">perfaudio.dat</td>
</tr>
</tbody>
</table>

<p><em>Image: PAISAN HOMHUAN / Shutterstock.com</em></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                                            </div>
                                    <span class="strong">
								        <time datetime="2015-03-05 13:55:35">5 Mar 2015 - 01:55PM</time>
                                    </span>
                                </div>
                            
                                <div class="widgets row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                <h3><span class="text"><em>Sign up to receive an email update whenever a new article is published in our <a href="https://www.welivesecurity.com/category/ukraine-crisis-digital-security-resource-center/" target="_blank" rel="noopener">Ukraine Crisis – Digital Security Resource Center</a></em></span></h3>
            </div>
        </div>
        <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
            <form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
                <div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="TOPIC" value="We Live Security Ukraine Newsletter">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button class="button-flag">
                        Submit                    </button>
                </div>
            </form>
        </div>
    </div>
                                <div class="widgets row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                <h3><span class="text">Newsletter</span></h3>
            </div>
        </div>
        <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
            <form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
                <div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="NEWSLETTER" value="We Live Security">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button class="">
                        Submit                    </button>
                </div>
            </form>
        </div>
    </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybersecurity/" class="category-tag-btn">Cybersecurity</a>                                                <a href="https://www.welivesecurity.com/2022/08/02/10-steps-securing-your-new-computer/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2022/08/1200x628-square-623x432.png"
                                                         alt="Casper Malware: After Babar and Bunny, Another Espionage Cartoon">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2022/08/02/10-steps-securing-your-new-computer/">
                                                    Start as you mean to go on: the top 10 steps to securing your new computer                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybersecurity/" class="category-tag-btn">Cybersecurity</a>                                                <a href="https://www.welivesecurity.com/2022/07/29/staying-safe-online-browse-web-securely/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2022/07/Browse-Web-safely-WLS-1-623x432.png"
                                                         alt="Casper Malware: After Babar and Bunny, Another Espionage Cartoon">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2022/07/29/staying-safe-online-browse-web-securely/">
                                                    Staying safe online: How to browse the web securely                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/scams/" class="category-tag-btn">Scams</a>                                                <a href="https://www.welivesecurity.com/2022/07/27/cash-app-fraud-scams-watch-out/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2022/07/cashapp-scams-fraud-623x415.jpg"
                                                         alt="Casper Malware: After Babar and Bunny, Another Espionage Cartoon">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2022/07/27/cash-app-fraud-scams-watch-out/">
                                                    Cash App fraud: 10 common scams to watch out for                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/we-live-progress/" class="category-tag-btn">We Live Progress</a>                                                <a href="https://www.welivesecurity.com/2022/07/25/nft-new-fangled-trend-new-found-treasure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2022/07/nft-non-funglbe-tokens-auctions-scams-623x415.jpg"
                                                         alt="Casper Malware: After Babar and Bunny, Another Espionage Cartoon">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2022/07/25/nft-new-fangled-trend-new-found-treasure/">
                                                    NFT: A new-fangled trend or also a new-found treasure?                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy Policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2015%2F03%2F05%2Fcasper-malware-babar-bunny-another-espionage-cartoon%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2015%2F03%2F05%2Fcasper-malware-babar-bunny-another-espionage-cartoon%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2015%2F03%2F05%2Fcasper-malware-babar-bunny-another-espionage-cartoon%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/js/main.js?id=fef3139dcedd23afc232"></script>
    <!-- Version: v1.9.0.9dc53e.pro.awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"59084 \/?p=59084","disqusShortname":"welivesecurity","disqusTitle":"Casper Malware: After Babar and Bunny, Another Espionage Cartoon","disqusUrl":"https:\/\/www.welivesecurity.com\/2015\/03\/05\/casper-malware-babar-bunny-another-espionage-cartoon\/","postId":"59084"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>
