A few things about EICAR that you may be not aware ofâ€¦
April 10, 2016 in Incident Response, Malware Analysis, Others, Preaching, Puzzles, Security Control, Silly

Update April 2017
As per info from Vess, the programmer who was responsible responsible for writing the EICAR file was Padgett Peterson.
If you get excited about EICAR file making the news as being able to make AV deleting logs when EICAR is used as a user name, password, User agent, etc. â€“ itâ€™s old news ðŸ˜‰ Read the history of the file including first attempts to abuse it here.
Old Post
When my wife studied her MA in graphic design and branding she got a lot of interesting home work. One of them wasâ€¦ â€˜The squareâ€™. She spent a lot of time brainstorming and eventually produced a large collection of ideas that got her a good mark. Now, the simple purpose of that exercise was to play around with the idea ofâ€¦ ideas. As simple as it sounds, the moment you start exploring one â€˜simpleâ€™ subject you will soon find yourself deep in a forest.
As I am adding support for many Quarantine files now (to DeXRAY) I suddenly found myself in a world of Antivirus analysis. One thing that somehow connects all of AV products is not their functionality, or Utopian vision of full protection, butâ€¦ the EICAR file.
I decided to explore the topic of this file a bit â€“ same as my wife was exploring the square. Yup, hereâ€™s a boring story SLASH a bunch of ideas associated with EICAR SLASH and other topics like this â€¦
First of all â€“ in case you donâ€™t know â€“ EICAR is a small file that is used as a test for security products (in the past it was mainly antivirus, but nowadays it should apply to any security solution that looks at files/content of any sort really). Once you deploy/install the solution/product, you can drop the EICAR file all over the place and see if solution picks it up. Notably, some AV vendors apparently do not understand what EICARâ€™s purpose is and decided not to detect it. I wonâ€™t be pointing fingers, but upload EICAR file to VirusTotal and you will know who I am talking about.
Naming conventions in AV is a subject to many debates over many years. EICAR looks like a no-brainer though as itâ€™s an artificial file created with a single purpose and its origin and name are well-documented. It doesnâ€™t help thoughâ€¦ it would seem that vendors canâ€™t agree on one, single name. Here is a histogram of names used by AV:
EICAR_test_fileÂ Â               Â  11
EICAR-Test-FileÂ Â                 Â 7
EICAR-Test-File (not a virus)Â Â  Â  4
Eicar test fileÂ Â  Â                3
EICAR (v)Â Â  Â                      2
Eicar-Test-SignatureÂ Â  Â           2
EICAR.Test.FileÂ Â  Â                2
EICAR.TestFileÂ Â  Â                 2
EICAR Test File (NOT a Virus!)Â Â   1
EICAR.TEST.NOT-A-VIRUSÂ Â  Â         1
EICAR-Test-File (not a virus) (B) 1
EICAR Test StringÂ Â  Â              1
DOS.EiracA.TrojanÂ Â  Â              1
Marker.Dos.EICAR.dymlmxÂ Â  Â        1
EICAR.Test.File-NoVirusÂ Â         Â 1
NORMAL:EICAR-Test-File!84776 [F]Â  1
EICAR-Test-File!cÂ Â  Â              1
EICAR Test-NOT virus!!!Â Â  Â        1
Win32.Test.Eicar.aÂ Â  Â             1
Misc.Eicar-Test-FileÂ Â  Â           1
EICAR_TestÂ Â  Â                     1
NotAThreat.EICAR[TestFile]Â Â  Â     1
qex.eicar.gen.genÂ Â  Â              1
TestFile/Win32.EICARÂ Â  Â           1
Virus:DOS/EICAR_Test_FileÂ Â  Â      1
EICAR-AV-TestÂ Â                   Â 1
EICAR-AV-TEST-FILEÂ Â  Â             1
EICAR-test[h]Â Â                   Â 1
And the bonus: one of these even has a typo. Can you spot it?
EICAR is a very strange phenomenon.
It is an organization. It is a file. It has a dedicated web site. It haz a dedicated con. Its original name is inclusive of Europe, and exclusive of other continents (EICAR stands for â€˜European Institute for Computer Antivirus Researchâ€™; deprecated name, but alwaysâ€¦).
Anagrams of EICAR are ERICA, CERIA and AREIC. They serve no purpose in this article.
Properties:
File size: 68 bytes
MD5: 44D88612FEA8A8F36DE82E1278ABB02F
SHA1: 3395856CE81F2B7382DEE72602F798B642F14140
SHA256: 275A021BBFB6489E54D471899F7DB9D1663FC695EC2FE2A2C4538AABF651FD0F
CTPH: 3:a+JraNvsgzsVqSwHq9:tJuOgzsko
Entropy: 4.872327687
Eicar is a DOS file and can be executedâ€¦ but only under old versions of Windows.

The source code is using the same tricks as shellcodes:

code is obfuscated

it is a self-modifying code (patching itself)

Does your sandbox solution accept EICAR? Test it.
There exist tools that help you to generate EICAR file and its cousins (file formats embedding EICAR).
There exist a close friend of EICAR called AMTSO (Anti-Malware Testing Standards Organization) that focuses on testing antimalware methods. It produces some more test files to support the original idea introduced by EICAR f.ex. Potentially Unwanted Application equivalent of EICAR:

with the histogram of detection names as follows (VT detection rate: 43/56 â€“ mind you that the file was compiled on 2013-04-04 21:26:07 (Thursday)):
Application.Hacktool.Amtso.AÂ Â                           Â 5
Riskware ( 0040eff71 )Â Â  Â                                2
AMTSO-TestÂ Â  Â                                            2
PUA_Test_FileÂ Â                                          Â 2
RiskTool.EICAR-Test-File.r5 (Not a Virus)Â Â  Â             1
RiskWare[RiskTool:not-a-virus]/Win32.EICAR-Test-FileÂ Â   Â 1
RiskTool.Win32.AMTSOTestFile (not malicious)Â Â           Â 1
Amtso.Test.Pua.AÂ Â  Â                                      1
W32/PUAtest.BÂ Â  Â                                         1
AMTSO_PUA_TESTÂ Â  Â                                        1
RiskTool.Win32!OÂ Â  Â                                      1
Application.Win32.AmtsoTest.aÂ Â  Â                         1
Riskware.AMTSO-Test-PUAÂ Â  Â                               1
Application/AMTSOPUPTestfileÂ Â  Â                          1
Trojan.Staser.genÂ Â  Â                                     1
Application:W32/AMTSOPUATestfileÂ Â  Â                      1
W32/TestFile.LCMA-1046Â Â  Â                                1
Backdoor.CPEX.Win32.29390Â Â  Â                             1
Risktool.W32.Eicar.Test!cÂ Â  Â                             1
Hacktool.Win32.EICAR-Test-File.aaÂ Â  Â                     1
RiskTool.Win32.AMTSOTestFileÂ Â  Â                          1
not-a-virus:RiskTool.Win32.EICAR-Test-FileÂ Â  Â            1
AMTSO-PUA-TestÂ Â  Â                                        1
PE:Malware.Generic/QRS!1.9E2D [F]Â Â  Â                     1
Riskware.Win32.EICARTestFile.dmxhvkÂ Â  Â                   1
PUA.AMTSOTestÂ Â  Â                                         1
SpyCarÂ Â  Â                                                1
PUA/AMTSO-TestÂ Â  Â                                        1
Trojan/W32.Agent.33280.TIÂ Â  Â                             1
Win32/PUAtest.B potentially unwantedÂ Â  Â                  1
W32/TestFileÂ Â  Â                                          1
Win32:AmtsoTest-A [PUP]Â Â  Â                               1
AMTSO-PUA-Test (PUA)Â Â  Â                                  1
RiskTool.EICAR-Test-File.aÂ Â  Â                            1
AMTSO Test File PUA (Not a Virus!)Â Â  Â                    1
PUP/Win32.AMTSO_TestÂ Â  Â                                  1
â€¦and the cloudish EICAR file as well. Hereâ€™s the histogram of names given to the cloudish EICAR file (only 23/56 vendors detect it on VT; compilation date: Â 2010-07-08 23:02:46 (Thursday), ouch!):
AMTSO_TEST_CLOUDCARÂ Â  Â                 2
Cldcar-Test!3FB121FBBCCBÂ Â  Â            2
Trojan.Win32.Generic!BTÂ Â  Â             2
Trojan.Agent/Gen-CloudTestÂ Â           Â 1
Virus:DOS/EICAR_Test_File          Â Â  Â 1
Trojan.GenericÂ Â  Â                      1
Application.Win32.CloudTest.sÂ Â  Â       1
Win.Trojan.11584714-1Â Â  Â               1
Amtso.Test.Cloudcar.AÂ Â  Â               1
Trojan.Brodcom.Win32.366Â Â  Â            1
Trojan.Win32.DangerousObject.dlgbhnÂ Â  Â 1
AMTSO-CLOUD-TestÂ Â  Â                    1
Trojan.Win32.Z.Agent.7178[h]Â Â         Â 1
CLOUDCAR_TestÂ Â  Â                       1
UDS:DangerousObject.Multi.GenericÂ Â    Â 1
DangerousObject.Multi.Generic!cÂ Â      Â 1
W32/GenBl.3FB121FB!OlympusÂ Â  Â          1
Mal/Generic-SÂ Â  Â                       1
AMTSO Test File (NOT a Virus!)Â Â  Â      1
Trj/CI.AÂ Â  Â                            1
There also exist a close friend fo EICAR called GTUBE (Generic Test for Unsolicited Bulk Email) for testing anti-spam solutions. It is also 68 bytes long.
Last, but not least â€“ there exists a shorter version of EICAR and it is 12 bytes SHORTER than the original!
The Base64-encoded EICAR looks like this:
WDVPIVAlQEFQWzRcUFpYNTQoUF4pN0NDKTd9JDIDYOUSPOTTHISEVJQ0FSLVNUQU5EQVJELUFOVElWSVJVUy1URVNU
LUZJTEUhJEgrSCo=
You may come across it as it is being used in various tests andâ€¦ it is a method used by Esafe to save Quarantine files. Andâ€¦ maybe you canâ€™t read this post in case your security product is over protective and detected the BASE64-encoded EICAR string. Well, if it doesâ€¦ it shouldnâ€™t, as I included â€˜DIDYOUSPOTTHISâ€™ in the BASE64 encoding above. Well, did you spot that DIDYOUSPOTTHIS?
EICAR is a tool. I use it to test Quarantine filesâ€™ encryption. When I find no encryption, or trivial encryption/encoding â€“ I love EICAR. When I have to dig into some actual code to find out how they transform the original EICAR bytes into sth terrible I absolutely hate this little piece of hybrid data/code ;).

Comments Off on A few things about EICAR that you may be not aware ofâ€¦

Comments are closed.
