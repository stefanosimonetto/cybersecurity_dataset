<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: Advanced exploit framework lab set-up</title>
<meta name="description" content="Any researcher serious about regularly researching exploit frameworks needs a special lab set-up to work with the PHP, MySQL and web server components commonly found in such kits. Mark Davis documents how to create LAMP and WAMP servers and how to approach the study of such threats in a local lab." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 2194;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/remo_expand/blocks/remo_expand/templates/vbexpand/view.css" />
<script type="text/javascript" src="/packages/remo_expand/js/jquery.color.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/remo.expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<div class="titlepage" xmlns=""><div><div><h1 class="title" xmlns="http://www.w3.org/1999/xhtml"><a id="vb201008-adv-exploit-framework-lab"></a>Advanced exploit framework lab set-up</h1></div><div><p class="pubdate" xmlns="http://www.w3.org/1999/xhtml">2010-08-01</p></div><div><div class="authorgroup" xmlns="http://www.w3.org/1999/xhtml"><div class="author titlepage"><h3 class="author"><span class="firstname">Mark</span> <span class="surname">Davis</span></h3></div><b class="editedby">Editor: </b><span class="editor"><span class="firstname">Helen</span> <span class="surname">Martin</span></span></div></div><div><div class="abstract" xmlns="http://www.w3.org/1999/xhtml"><p class="title"><b>Abstract</b></p><p>Any researcher serious about regularly researching exploit frameworks needs a special lab set-up to work with the PHP, <em class="productname">MySQL</em> and web server components commonly found in such kits. Mark Davis documents how to create LAMP and WAMP servers and how to approach the study of such threats in a local lab.</p></div></div><div><p class="copyright" xmlns="http://www.w3.org/1999/xhtml"><i>Copyright &copy; 2010 Virus Bulletin</i></p></div></div><hr /></div>
<div class="ccm-remo-expand">
<div id="ccm-remo-expand-title-3818" class="ccm-remo-expand-title ccm-remo-expand-closed" data-expander-speed="200">Table of contents</div><div id="ccm-remo-expand-content-3818" class="ccm-remo-expand-content"><div class="toc"><dl><dt><span class="sect1"><a href="#id4742311"></a></span></dt><dt><span class="sect1"><a href="#id3561273">What is a LAMP/WAMP server?</a></span></dt><dt><span class="sect1"><a href="#id4494155">Why WAMP is preferred</a></span></dt><dt><span class="sect1"><a href="#id3459672">WAMP set-up</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2302590">Step 1 &ndash; Download the software</a></span></dt><dt><span class="sect2"><a href="#id4394119">Step 2 &ndash; Run the installer</a></span></dt><dt><span class="sect2"><a href="#id4014711">Step 3 &ndash; Configurations</a></span></dt><dt><span class="sect2"><a href="#id3625287">Step 4 &ndash; Run WampServer</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id3286413">WampServer usage</a></span></dt><dt><span class="sect1"><a href="#id3216075">Additional packages for WAMP</a></span></dt><dt><span class="sect1"><a href="#id3290080">LAMP server</a></span></dt><dt><span class="sect1"><a href="#id2375383">Local kit testing</a></span></dt><dt><span class="sect1"><a href="#id3590925">Concluding remarks</a></span></dt></dl></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4742311"></a></h2></div></div></div><p>A myriad of exploit frameworks (kits) exist to support drive-by attacks in the wild. Popular kits include Eleonore, Fragus, Liberty and countless others. As identified in previous articles [<span class="citation"><a href="#citation.1">1</a></span>], behavioural testing of these kits can be tricky. However, it is possible to obtain select files and/or demonstration kits, allowing for more qualified and in-depth research than remote behavioural testing alone. Any researcher serious about regularly researching such threats needs a special lab set-up to work with the PHP, <em class="productname">MySQL</em> and web server components commonly found in such kits. This article documents how to create LAMP and WAMP servers and how to approach the study of such threats in a local lab.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3561273"></a>What is a LAMP/WAMP server?</h2></div></div></div><p>(L/W)AMP is an acronym for the operating system (<em class="productname">Linux</em> or <em class="productname">Windows</em>), <em class="productname">Apache</em> (web server), <em class="productname">MySQL</em> (database) and PHP (scripting language). Most kits use these components to install on a remote server. Some do not require <em class="productname">MySQL</em>, saving data to a text file instead. However, this method is inherently flawed since the file names can be predicted or found in configuration files or images posted by bad actors, making it easy for individuals to harvest such files remotely. <em class="productname">MySQL</em> is commonly used because it is fairly simple to include in a kit. A large number of examples of such implementations can be found in demonstration kits in the wild.</p><p>LAMP/WAMP server software is entirely free for both <em class="productname">Linux</em> and <em class="productname">Windows</em>. This makes such packages widely available with many implementations, lots of online support, and at the right price for financially motivated fraudsters. It is also priced attractively for tight-budgeted security experts performing in-depth research on such threats.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4494155"></a>Why WAMP is preferred</h2></div></div></div><p>A WAMP server is preferred for the evaluation of drive-by attacks. (A WAMP server set-up that is simple to install on a <em class="productname">Windows</em> computer will be revealed in detail later in this article.) Additionally, since it is <em class="productname">Windows</em>, you can easily navigate to the local kit (once configured) to trigger an attack on the same system. This enables rapid interaction with the kit and the ability to monitor how payloads and exploits work, and how the database populates once the system is triggered. If a LAMP server is used, a separate NAT&rsquo;d <em class="productname">Windows</em> system must be implemented to perform the same actions. While this is not difficult, it is an additional step that can sometimes be troublesome in virtual environments that don&rsquo;t always work smoothly with networking protocols and configurations.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3459672"></a>WAMP set-up</h2></div></div></div><p><em class="productname">WampServer</em> [<span class="citation"><a href="#citation.2">2</a></span>] is a pre-compiled package that installs all components required for the server on a standard <em class="productname">Windows</em> computer. This is an outstanding resource since not all versions of the various components are compatible with one another. Pre-compiled packages are tested and known to work well together. Because it&rsquo;s an integrated installation package, the user simply clicks through a few screens to install the server.</p><p>If <em class="productname">WampServer</em> is not desired, a WAMP server can be configured manually by downloading packages from each respective software site for the various components of the server. Alternative servers can also be used, such as the <em class="productname">Abyss</em> web server [<span class="citation"><a href="#citation.3">3</a></span>]. Naturally, such installations require more time but also offer increased flexibility for customized lab requirements.</p><p>It is important to note that the tutorial below is based on a first-time installation of a WAMP server from WampServer.com. If an older version of a WAMP server exists on the system, data should be backed up, WAMP removed, and the upgrade then installed. WampServer also recommends that the WAMP directory be deleted prior to installation of the new package.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id2302590"></a>Step 1 &ndash; Download the software</h3></div></div></div><p>Using a normal high-speed line, <em class="productname">WampServer</em> (~16MB) can be downloaded in a couple of minutes or less. The package used in this example (<em class="productname">WampServer 2.0i </em>[07/11/09]) includes the following components:</p><div class="itemizedlist"><ul type="disc"><li><p><em class="productname">Apache 2.2.11</em></p></li><li><p><em class="productname">MySQL 5.1.36</em></p></li><li><p>PHP 5.3.0</p></li></ul></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4394119"></a>Step 2 &ndash; Run the installer</h3></div></div></div><p>Click on the opening screen, accept the agreement, go with the default directory installation (c:\wamp), select additional icon options for Quick Launch and Desktop if desired, and click install.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4014711"></a>Step 3 &ndash; Configurations</h3></div></div></div><p>After the installer has run for a while the user selects the default browser to be used with the kit. I prefer to use <em class="productname">Firefox</em> since various add-ons are available that can be used in the evaluation of exploit kits locally &ndash; these are not available in other browsers.</p><p>PHP mail parameters are also configured during installation. SMTP is set to localhost by default, with email at <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="7e07110b3e07110b0c1a11131f171050">[email&#160;protected]</a> This can be configured if desired. A mail server can be configured or scripts utilized to perform local mail honeypot operations when interacting with a kit or payload. However, I generally leave this as a default since testing of email functionality is not usually required for the testing of exploit frameworks.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id3625287"></a>Step 4 &ndash; Run WampServer</h3></div></div></div><p><em class="productname">WampServer</em> doesn&rsquo;t run automatically on its own &ndash; it must be run on demand, or configured to run with <em class="productname">Windows</em> startup or scheduled as a task. If using a virtual machine as a dedicated WAMP server, simply drop a shortcut for the <em class="productname">WampServer</em> (c:\wamp\wampmanager.exe) into the Startup folder.</p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3286413"></a>WampServer usage</h2></div></div></div><p>Now the WAMP server is installed correctly and running in memory. Congratulations, you have a web server, <em class="productname">MySQL</em> data, PHP scripting support, and the ability to install local web scripts and kits for testing in a lab!</p><p>Locate the <em class="productname">WampServer</em> icon and LEFT-click:</p><div class="figure"><a id="figure.1"></a><div class="mediaobject"><img alt="WampServer icon (circled)." src="/uploads/images/figures/2010/08/Mark-1.jpg" /></div><p class="title"><b>Figure&nbsp;1.&nbsp;WampServer icon (circled).</b></p></div><p>This reveals a complete menu of choices:</p><div class="figure"><a id="figure.2"></a><div class="mediaobject"><img alt="WampServer menu." src="/uploads/images/figures/2010/08/Mark-2.jpg" /></div><p class="title"><b>Figure&nbsp;2.&nbsp;WampServer menu.</b></p></div><p>Browse Localhost (your local web server space) and <em class="productname">phpMyAdmin</em> are the first two options in the <em class="productname">WampServer</em> set-up. Either can easily be pulled up using the default browser assigned during set-up.</p><div class="figure"><a id="figure.3"></a><div class="mediaobject"><img alt="Localhost and phpMyAdmin on a WampServer." src="/uploads/images/figures/2010/08/Mark-3.jpg" /></div><p class="title"><b>Figure&nbsp;3.&nbsp;Localhost and phpMyAdmin on a WampServer.</b></p></div><p>These first two links are very helpful in a WAMP server testing environment. Localhost points to the www directory on the local machine for the <em class="productname">Apache</em> server installed. This is normally located at c:\wamp\www\ and contains index.php. Notice that one of the menu options is for the www directory, which is most handy for a security researcher. Simply left-click on the <em class="productname">WampServer</em>, select www directory, drag and drop a kit or script to test into the www space or sub-folder and it&rsquo;s on the local server.</p><p>Once a kit is copied to the www space, installation of the kit begins. This is covered in more detail at the end of this article. It involves configuring the database and users via <em class="productname">phpMyAdmin</em>. The rest of the <em class="productname">WampServer</em> options for configuring specific components of the installation are not normally required for evaluation of an exploitation framework.</p><p>Interested parties should visit the <em class="productname">WampServer</em> website for additional support. A forum exists, as well as other resources that are of great value for users having issues with installation or customization of the server.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3216075"></a>Additional packages for WAMP</h2></div></div></div><p>A WAMP server is very powerful but additional components are often required to fully analyse an exploit kit. The following is a brief outline of suggested tools:</p><div class="itemizedlist"><ul type="disc"><li><p><em class="productname">Wireshark</em> &ndash; used to sniff local traffic when triggering the server via the local browser. This traffic can help identify obfuscation and string details within packets useful in both behavioural testing and netflow signature development.</p></li><li><p><em class="productname">Malzilla</em> &ndash; a useful tool for working with deobfuscation of scripts. A researcher can also model what a remote website might look like if it hosts an exploit kit being tested locally.</p></li><li><p>Specialized analysis tools &ndash; tools like <em class="productname">Trillix</em> for analysing <em class="productname">Flash</em> files and djdec39 for analysis of Java files.</p></li><li><p><em class="productname">Cygwin</em> &ndash; brings the best of <em class="productname">Linux</em> to <em class="productname">Windows</em>, but with the price of a large number of files and disk space required for this unique package. <em class="productname">Cygwin</em> is a slick way to get your favourite <em class="productname">Linux</em> tools on <em class="productname">Windows</em>, such as &lsquo;file&rsquo;, along with Perl and Python (which always seem to work better in <em class="productname">Linux</em> than <em class="productname">Windows</em> &ndash; let the debate begin!). Such utilities are helpful when looking at embedded payloads and file obfuscation in a kit, using scripts to analyse exploit files (like PDF files for example), plus you have the factor of a dual OS system to help you leap tall buildings and impress others.</p><div class="itemizedlist"><ul type="circle"><li><p>Didier Stevens&rsquo; PDF analysis tools [<span class="citation"><a href="#citation.4">4</a></span>], written in Python, work well within a <em class="productname">Cygwin</em> environment on <em class="productname">Windows</em>.</p></li></ul></div></li><li><p><em class="productname">OllyDbg</em> is great for debugging and some reverse engineering if a complete analysis is desired, and/or for interaction with payloads.</p></li></ul></div><p>WAMP servers are not recommended for analysis of a payload. Snapshot tools and others are very time consuming &ndash; both within the <em class="productname">WampServer</em> and also within a <em class="productname">VMware</em> environment &ndash; due to the large number of unique files created within such a system. If payload analysis is needed, extract the payload and place into an environment uniquely designed for such analysis. The goal of a WAMP server involving a payload is to capture netflow data and/or interact with a kit to monitor how it populates a database based on how exploits are triggered.</p><p>Additional vulnerable packages may also be installed on the WAMP server in order to trigger common vectors of attack if a diverse set of behavioural triggers is desired. This can be very useful when tracking exploits against default numbers often assigned to specific vectors &ndash; such as MDAC, which is sometimes referred to within an exploit URI as &lsquo;1&rsquo; or some other number. Oldapps.com contains a host of vulnerable packages of which several versions of each may be required to properly trigger specific exploits of interest. Additionally, configurations within the kit or scripts may be required to limit global infection routines to trigger a specific vector of interest. Packages to include, likely as installers on demand with a core set installed in a snapshot, are listed below:</p><div class="itemizedlist"><ul type="disc"><li><p><em class="productname">Adobe Reader</em>: http://oldapps.com/adobe_reader.php 8.x, 9.x, 9.2x (default), 10.x</p></li><li><p><em class="productname">Adobe Flash</em>: http://oldapps.com/flash_player.php 8.x, 9.x (default), 10.x</p></li><li><p>Java: http://oldapps.com/java.php 6 update 10, 6 update 16 (default), Java 5 update 18</p></li><li><p><em class="productname">Internet Explorer</em>: http://oldapps.com/internet_explorer.php 8.x, 7.x, 6.x (default)</p></li><li><p><em class="productname">Firefox</em>: http://oldapps.com/firefox.php 3.6x, 3.0x (default)</p></li><li><p><em class="productname">WinZip</em>: http://oldapps.com/winzip.php 9.x (default)</p></li></ul></div><p>(The default recommendations above are selected subjectively for common vectors of testing of current vectors in the wild.)</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3290080"></a>LAMP server</h2></div></div></div><p>Select your favourite *nix solution to install the packages needed to build a LAMP server. <em class="productname">Ubuntu</em> was used in this instance due to the popularity of the system and ease of use for compatible installations and set-up. The <em class="productname">Synaptic</em> package manager and terminal-based solutions were used to perform a LAMP server installation. While slightly more complicated than a <em class="productname">WampServer</em>, which includes compatibility checks, LAMP servers can be created in less than an hour by an experienced *nix user.</p><p><em class="productname">Synaptic</em> package manager installs:</p><div class="itemizedlist"><ul type="disc"><li><p>apache2 &ndash; <em class="productname">Apache</em> HTTP server metapackage</p></li><li><p>apache2-doc</p></li><li><p>php5 &ndash; server-side, HTML-embedded scripting language (metapackage)</p></li><li><p>php5-sqlite</p></li><li><p>php5-mysql</p></li><li><p>php5-cgi</p></li><li><p>phpmyadmin</p></li><li><p>mysql-server</p></li></ul></div><p>Sometimes <em class="productname">Synaptic</em> package manager installations don&rsquo;t go as planned. Restarting the system and reinstalling may be required to get it to work. If that fails, try to perform a complete removal, restart, and then reinstall.</p><p>Naturally, a host of additional packages may be useful in a *nix environment for testing exploit kits including Python tools like those of Didier Stevens. However, since it is based on *nix instead of <em class="productname">Windows</em>, a LAMP server is limited to the exploit files and the framework instead of behavioural testing and payloads on the same system. Thus, a hostile PDF can be analysed but the dropped file must be extracted manually or triggered on a remote <em class="productname">Windows</em> system to develop that side of research when working with a LAMP server.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id2375383"></a>Local kit testing</h2></div></div></div><p>Once a WAMP or LAMP server is set up properly, the following basic procedures are used to install a kit for testing.</p><div class="orderedlist"><ol type="1"><li><p>Configuring the kit:</p><div class="itemizedlist"><ul type="disc"><li><p>Change permissions on the kit directory if necessary to enable access/read/write. (This is not normally required but may be within a LAMP server.)</p></li><li><p>Locate the configuration file and review for database credentials/set-up required.</p><div class="itemizedlist"><ul type="circle"><li><p>Use <em class="productname">phpMyAdmin</em> to create a user with admin rights to the database.</p></li><li><p>It&rsquo;s a good idea to create a universal login for both the database and the kit control panel, then change the configuration file instead of the <em class="productname">phpMyAdmin</em> and <em class="productname">MySQL</em> configurations each time. Making changes to a configuration file is trivial using <em class="productname">Notepad</em> or <em class="productname">Gedit</em> with admin/root rights (e.g. sudo gedit &lsquo;/var/www/kit/config.php&rsquo;).</p></li></ul></div></li><li><p>Look for install.php or similar files that are used to install the kit.</p><div class="itemizedlist"><ul type="circle"><li><p>This file normally works with PHP to automatically create the database and appropriate tables used with the kit. Use <em class="productname">phpMyAdmin</em> to validate the creation of a new table once install.php is run.</p></li><li><p>Once a database is created you&rsquo;re ready to see if you can log in!</p></li></ul></div></li><li><p>Browse to the kit via pages like admin.php or statistics.php. Authentication is commonly required, so work from what you found or entered into the configuration page. Sometimes this can be a bit tricky if encoding is used, such as the SHA1 value of a password, etc.</p></li></ul></div></li><li><p>Snapshots: Use snapshots within <em class="productname">VMware</em> to save loaded kits for faster referencing and update checks. For example, if you finally get a kit working after 50 minutes of work, snapshot it and save it and back up the images on the host. This enables the researcher to quickly load a kit for later update checks or evaluations.</p></li></ol></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3590925"></a>Concluding remarks</h2></div></div></div><p>Behavioural analysis of local exploit kits is clearly complex and difficult for some to accomplish. Fortunately, the WAMP server components highlighted in this article provide security researchers with a fairly simple method for properly installing and configuring such a server. Use of the system is much more complicated since so many dynamic analysis components are then available to the researcher. When properly used, WAMP servers have proven to be an excellent environment in which advanced exploit kit framework analysis may be completed. The next part of this series will provide a walk-through of how the set-up can be used to look at an exploit.</p><div class="bibliography"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id3064730"></a>Bibliography</h3></div></div></div><div class="bibliomixed"><a id="citation.1"></a><p class="bibliomixed">[1] See <span class="bibliosource"><a href="/uploads/pdf/magazine/2010/201004.pdf" target="_blank">http://www.virusbtn.com/pdf/magazine/2010/201004.pdf</a></span> and <span class="bibliosource"><a href="/uploads/pdf/magazine/2010/201005.pdf" target="_blank">http://www.virusbtn.com/pdf/magazine/2010/201005.pdf</a>.</span></p></div><div class="bibliomixed"><a id="citation.2"></a><p class="bibliomixed">[2] <span class="bibliosource"><a href="http://www.wampserver.com/en/download.php" target="_blank">http://www.wampserver.com/en/download.php</a></span>.</p></div><div class="bibliomixed"><a id="citation.3"></a><p class="bibliomixed">[3] <span class="bibliosource"><a href="http://www.aprelium.com/abyssws/" target="_blank">http://www.aprelium.com/abyssws/</a></span>.</p></div><div class="bibliomixed"><a id="citation.4"></a><p class="bibliomixed">[4] <span class="bibliosource"><a href="https://blog.didierstevens.com/programs/pdf-tools/" target="_blank">http://blog.didierstevens.com/programs/pdf-tools/</a></span>.</p></div></div></div> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=Advanced exploit framework lab set-up&url=https://www.virusbulletin.com/virusbulletin/2010/08/advanced-exploit-framework-lab-set"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2010/08/advanced-exploit-framework-lab-set'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2010/08/advanced-exploit-framework-lab-set&title=Advanced exploit framework lab set-up"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2010/08/advanced-exploit-framework-lab-set&t=Advanced exploit framework lab set-up"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2010/08/advanced-exploit-framework-lab-set"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p> </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">©1989-2022 Virus Bulletin.        <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>        <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>        <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>