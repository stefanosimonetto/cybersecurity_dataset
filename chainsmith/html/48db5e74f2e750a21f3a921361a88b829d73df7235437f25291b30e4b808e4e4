<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: VB2012 paper: Malware taking a bit(coin) more than we bargained for</title>
<meta name="description" content="When a new system of currency gains acceptance and widespread adoption in a computer-mediated population, it is only a matter of time before malware authors attempt to exploit it. As of halfway through 2011, we started seeing another means of financial profiteering being perpetrated by the malware authors; they started targeting Bitcoin. This paper examines the various malware families that target this currency, provides an analysis of how these families target bitcoins, and details the methods they use to steal and mine this increasingly popular digital currency. The paper also gives an insight into how malware authors and cybercriminals may exploit the Bitcoin system for their own financial gain, and details what the future holds for this form of exploitation." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 5804;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/blocks/expand_collapse_toc/templates/vbexpand/view.css" />
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/jquery.color.js"></script>
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<h1><a class="chapter" name="h1-malware-taking-bitcoin-more-we-bargained"></a>VB2012 paper: Malware taking a bit(coin) more than we bargained for</h1>
<h3><a class="chapter" name="h3-amir-fouda"></a>Amir Fouda</h3>
<p>Microsoft</p>
<p><em>Copyright © 2012 Virus Bulletin</em></p>
<hr />
<p> </p>
<div class="ccm-expand-collapse-toc">
<div id="ccm-expand-collapse-toc-title-11986" class="ccm-expand-collapse-toc-title ccm-expand-collapse-toc-closed" data-expander-speed="500">Table of contents</div><div id="ccm-expand-collapse-toc-content-11986" class="ccm-expand-collapse-toc-content"><p><a class="toc-level2" href="#h2-abstract">Abstract</a><br /> <a class="toc-level2" href="#h2-introduction">Introduction</a><br /> <a class="toc-level2" href="#h2-what-bitcoin">What is Bitcoin?</a><br /> <a class="toc-level2" href="#h2-how-does-it-work">How does it work?</a><br /> <a class="toc-level3" href="#h3-transactions">Transactions</a><br /> <a class="toc-level3" href="#h3-wallet">Wallet</a><br /> <a class="toc-level3" href="#h3-mining">Mining</a><br /> <a class="toc-level3" href="#h3-controlled-currency">Controlled currency</a><br /> <a class="toc-level3" href="#h3-value">Value</a><br /> <a class="toc-level2" href="#h2-how-mining-works">How mining works</a><br /> <a class="toc-level3" href="#h3-solo-mining">Solo mining</a><br /> <a class="toc-level3" href="#h3-pooled-mining">Pooled mining</a><br /> <a class="toc-level3" href="#h3-browser-mining">Browser mining</a><br /> <a class="toc-level2" href="#h2-bitcoin-appeal">The Bitcoin appeal</a><br /> <a class="toc-level3" href="#h3-appealing-wrong-crowd">Appealing to the wrong crowd</a><br /> <a class="toc-level3" href="#h3-hacking-incidents">Hacking incidents</a><br /> <a class="toc-level3" href="#h3-criminal-appeal">Criminal appeal</a><br /> <a class="toc-level3" href="#h3-how-anonymous-bitcoin">How anonymous is Bitcoin?</a><br /> <a class="toc-level2" href="#h2-malware-writers-set-their-eyes-prize">Malware writers set their eyes on the prize</a><br /> <a class="toc-level3" href="#h3-wallet-theft">Wallet theft</a><br /> <a class="toc-level3" href="#h3-getting-some-mine-age">Getting some mine-age</a><br /> <a class="toc-level3" href="#h3-dropping-bitcoin">Dropping the (Bit)coin</a><br /> <a class="toc-level3" href="#h3-bitcoin-miner-memory-loading">Bitcoin miner memory loading</a><br /> <a class="toc-level3" href="#h3-bitcoin-miner-downloader">Bitcoin miner downloader</a><br /> <a class="toc-level3" href="#h3-bitcoin-mining-worm">Bitcoin-mining worm</a><br /> <a class="toc-level3" href="#h3-first-macosx-bitcoin-backdoor">First MacOSX Bitcoin backdoor</a><br /> <a class="toc-level3" href="#h3-monetizing-botnets-bitcoins">Monetizing botnets with bitcoins</a><br /> <a class="toc-level3" href="#h3-sirefef">Sirefef</a><br /> <a class="toc-level3" href="#h3-alureon-gang-set-their-eyes-bitcoin-prize">The Alureon gang set their eyes on the Bitcoin prize</a><br /> <a class="toc-level3" href="#h3-rorpian">Rorpian</a><br /> <a class="toc-level3" href="#h3-kelihos">Kelihos</a><br /> <a class="toc-level3" href="#h3-bafruz">Bafruz</a><br /> <a class="toc-level2" href="#h2-conclusion">Conclusion</a><br /> <a class="toc-level2" href="#h2-references">References</a></p><p>&nbsp;</p></div></div>
<h2><a class="chapter" name="h2-abstract"></a>Abstract</h2>
<p>Social and technological change often creates new opportunities for positive change. Unfortunately, it also means more opportunities for crime. So, when a new system of currency gains acceptance and widespread adoption in a computer-mediated population, it is only a matter of time before malware authors attempt to exploit it. As of halfway through 2011, we started seeing another means of financial profiteering being perpetrated by the malware authors; they started targeting <em>Bitcoin</em>.</p>
<p>Bitcoin-mining and -stealing functionality has been discovered in a number of the most notable and prevalent malware families, including Alureon, Sirefef and Kelihos. Notably, <em>Bitcoin</em> being open-source software means that <em>Windows</em> users are not the only target. Cross-platform attacks have already been seen, with <em>OS X</em> threats such as MacOS_X/DevilRobber.A emerging on the scene in October 2011.</p>
<p>The very nature of the way <em>Bitcoin</em> operates also has implications. <em>Bitcoin</em> mining is a legitimate part of the system, allowing <em>Bitcoin</em> clients to compete with other clients in performing complex calculations using the computer's processing power, aiding in the flow of transfers and thus generating bitcoins for the winning miner. The potential for botmasters is clear: the more computers and resources they can control in this distributed computing technique, the more they are likely to profit.</p>
<p>This paper examines the various malware families that target this currency, provides an analysis of how these families target bitcoins, and details the methods they use to steal and mine this increasingly popular digital currency. The paper will also give an insight into how malware authors and cybercriminals may exploit the <em>Bitcoin</em> system for their own financial gain, and details what the future holds for this form of exploitation.</p>
<p> </p>
<h2><a class="chapter" name="h2-introduction"></a>Introduction</h2>
<p>Distributed or grid computing – a term used to describe multiple autonomous computer systems working together for a common cause – is not a new concept, and is a method used to solve usually quite complex problems or tasks that require extensive processing power. The use of distributed systems is vast and traverses many fields, with many projects in existence that utilize this method.</p>
<p>Of the many projects, there are those that any computer user can partake in; simply by installing client software on their system, they willingly volunteer their computer's processing power to help contribute to a particular cause. The Great Internet Mersenne Prime Search, also known as GIMPS [<a href="#ref1">1</a>], is an example of the first voluntary distributed computing project, in which participating computers contributed towards finding Mersenne prime numbers in the field of mathematics. It was launched in 1996. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="306375647970585f5d55">[email&#160;protected]</a> [<a href="#ref2">2</a>] is another well-known project, launched in May 1999, that utilizes the collective processing power of volunteered computers to analyse radio signals and help in the search for extraterrestrial life.</p>
<p>Leaping ahead ten years from the launch of <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ffacbaabb6bf9790929a">[email&#160;protected]</a>, January 2009 saw the launch of an experimental decentralized virtual currency called <em>Bitcoin</em>, which relies on computers connected through a peer-to-peer (P2P) network to work together in the creation and transfer of this currency throughout the network. <em>Bitcoin</em> has gained popularity amongst computer users since its launch, appealing to many due to its non-reliance on a central authority to issue currency and track transactions, as well as its reward system, which encourages computer users to volunteer their computing power to aid in generating bitcoins and validating transactions.</p>
<p>And it's exactly these features that have encouraged the adoption of <em>Bitcoin</em> by the dark forces of the online world as well, with cybercriminals and malware authors taking a keen interest in this new technology. But before we delve into the agglomeration of nefarious activities surrounding <em>Bitcoin</em>, we need to have a basic overview of what bitcoins are and how the <em>Bitcoin</em> system works.</p>
<p> </p>
<h2><a class="chapter" name="h2-what-bitcoin"></a>What is Bitcoin?</h2>
<p>Founded by Satoshi Nakamoto, <em>Bitcoin</em> was launched to the public on 11 January 2009, and was described by its inventor on the cryptography mailing list where it was first announced as a 'new electronic cash system that uses a P2P network to prevent double-spending' [<a href="#ref3">3</a>]. The <em>Bitcoin</em> wiki site [<a href="#ref4">4</a>], which contains almost everything there is to know about the system, describes it as being 'designed around the idea of using cryptography to control the creation and transfer of money, rather than relying on<br />central authorities.' [<a href="#ref5">5</a>]</p>
<p>The term '<em>Bitcoin</em>' (upper case 'B') can be used to describe the system as a whole, as well as the software used by the system, while '<em>bitcoin</em>' (lower case 'b') is the virtual currency that is created by this system. A 'bitcoin' unit of currency is represented as a 'BTC' and can be traded for real-world currency through various exchanges. The <em>Bitcoin</em> client software that is run on computers in the P2P network is open source, as well as the bitcoin-mining software that exists to support the system.</p>
<p> </p>
<h2><a class="chapter" name="h2-how-does-it-work"></a>How does it work?</h2>
<h3><a class="chapter" name="h3-transactions"></a>Transactions</h3>
<p>The premise behind <em>Bitcoin</em> is that users of the system can transfer bitcoins to each other without the need of a central authority, such as a financial institution, to validate transactions and monitor double-spending. This validation is instead performed by nodes participating in the <em>Bitcoin</em> P2P network, as by design, all transactions are broadcast to the network.</p>
<p>Once a user installs a <em>Bitcoin client</em> on their machine, they can transfer bitcoins directly to another <em>Bitcoin</em> user. The <em>Bitcoin </em>client assigns an <em>address</em> to each user, which is used as their identifier on the network, allowing them to receive bitcoins. A <em>Bitcoin</em> address is 34 characters long and is newly generated by most <em>Bitcoin</em> clients each time a transaction occurs, so one user can have numerous addresses.</p>
<p><em>Bitcoin</em> uses a public key cryptography system for transactions between users. Each <em>Bitcoin</em> user has a pair of public and private keys which is stored in a special file on their system called a <em>Bitcoin wallet</em>. When User AX wants to transfer one bitcoin to User BY, for instance, the following occurs:</p>
<ul>
<li>AX initiates a transaction by sending one bitcoin to BY's <em>Bitcoin</em> address (<a href="#figure1">Figure 1</a>).</li>
<li>BY's public key is sent to AX.</li>
<li>AX adds BY's public key, along with the transfer amount, one bitcoin in this case, to a transaction message.</li>
<li>AY signs the transaction message with their private key and broadcasts the message to the network.</li>
</ul>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/423bcd673a402fd94c65c2430bae0bb6_f2504.jpg" alt="Bitcoin-malware-fig1.jpg" width="760" height="522" /></p>
<p class="centered-caption"><a class=" anchor" name="figure1"></a>Figure 1: Address of BY chosen as the destination for one BTC.</p>
<p>So, up until this point, the transfer amount, one BTC, has still not been transferred to BY as it needs to be verified and permanently recorded in the network before it can be spent. What happens next is the distributed computing aspect of the <em>Bitcoin</em> system:</p>
<ul>
<li>The broadcasted transaction message is collected into <em>blocks</em> being worked on by nodes running special mining software. A block contains, among other data:
<ul style="list-style-type: circle;">
<li>recent transactions broadcast by other nodes that have not been verified yet</li>
<li>a hash of all transactions</li>
<li>a hash of previously accepted blocks</li>
<li>a difficult-to-solve mathematical problem.</li>
</ul>
</li>
<li>The role of these <em>miner nodes</em> is to solve the difficult problem tied to the block they are working on (i.e. provide a proof of work for that block). Once successful, the node transmits the solved block to the network for all other nodes to quickly verify and add permanently to the end of a previously validated block, thus forming what is referred to in the <em>Bitcoin</em> system as a<em> block chain</em>.</li>
<li>BY can now transfer the received bitcoin using their matching private key.</li>
</ul>
<p>The block chain, which is a record of all transactions that occurred in the system since the very first one initiated by Nakamoto – called the genesis block – is downloaded to every <em>Bitcoin</em> client's machine, to the client's <em>Bitcoin</em> data directory (with the file name 'blk0001.dat', for instance). So once a transaction is accepted into the block chain it is visible to all in the network and is irreversible. Because the transaction is in the block chain, redoing it would mean all miner nodes would have to redo its associated block, as well as all blocks that follow it, since each accepted block contains a hash of the previous one. Hence, this is the <em>Bitcoin</em> system's solution to the problem of double-spending.</p>
<p>But as mentioned by Nakamoto [<a href="#ref6">6</a>], as long as honest miner nodes have the majority of CPU power in the network, 'an attacker would have to redo the proof-of-work of the block and all blocks after it and then catch up with and surpass the work of the honest nodes.' So in the unlikely case that an attacker gains more than 50% of the hashing power in the network (hashing will be discussed in the 'mining' section), while in control, they could potentially reverse their transactions and prevent other nodes from validating blocks.</p>
<p> </p>
<h3><a class="chapter" name="h3-wallet"></a>Wallet</h3>
<p>The <em>Bitcoin</em> wallet contains a public and private key pair, as mentioned previously, as well as an address created each time a transaction occurs. Because a new address is generated for each transaction, the wallet can contain many addresses and key pairs. So, a <em>Bitcoin</em> user having <em>X</em> number of bitcoins in their wallet really means they have in their wallet one or many <em>Bitcoin</em> addresses, and a corresponding private key that is needed to resend the bitcoins sent to that address. This also means that anyone can spend the bitcoins sent to the <em>Bitcoin </em>user's address if they have access to their address and its corresponding private key. This is why the <em>Bitcoin</em> wallet file is a popular target for malware.</p>
<p>By default, the original <em>Bitcoin</em> client stores this data in a file on the local system called 'wallet.dat'. The location of this file is saved in the <em>Bitcoin</em> data directory, along with other data files used by the client. Depending on the OS, the default locations for the wallet.dat file are shown in <a href="#table1">Table 1</a>.</p>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td><strong>Operating system</strong></td>
<td><strong>Wallet location</strong></td>
</tr>
<tr>
<td>WinXP</td>
<td>%APPDATA%\Bitcoin\wallet.dat</td>
</tr>
<tr>
<td>Windows Vista and 7</td>
<td>%APPDATA%\Roaming\Bitcoin\wallet.dat</td>
</tr>
<tr>
<td>Linux</td>
<td>~/.bitcoin/wallet.dat</td>
</tr>
<tr>
<td>Mac</td>
<td>~/Library/Application Support/Bitcoin/wallet.dat</td>
</tr>
</tbody>
</table>
<p><a class=" anchor" name="table1"></a><span class="centered-caption">Table 1: Default locations of the wallet.dat file.</span></p>
<p>Note that <em>Bitcoin</em> users can also store their wallet data via other means, such as through websites that store their <em>Bitcoin</em> wallet (by sending their bitcoins to a <em>Bitcoin</em> address generated by the website for instance) instead of keeping their wallet data on their machine.</p>
<p> </p>
<h3><a class="chapter" name="h3-mining"></a>Mining</h3>
<p>As previously mentioned, the role of the miner nodes connected to the <em>Bitcoin</em> network is to solve a computationally difficult problem tied with transactions before they are accepted into the block chain. This computational problem is in fact a 256-bit value, which in <em>Bitcoin</em> terminology is called the <em>target</em> for a block.</p>
<p>The miner's task is to iteratively calculate the SHA256 cryptographic hash of data in the block's header data, which includes a four-byte value called a <em>nonce</em> that is incremented every time a hash is generated by the miner. The aim of this iterative process is to generate a SHA256 hash value that is lower than the target value. Once this hash is generated by the miner, the block is broadcast to other miner nodes where they verify that the calculated SHA256 is in fact lower than the target, adding it to the block chain if it is so.</p>
<p>This process of a miner generating hashes to validate a block takes time and expends CPU effort, which comes at a cost, i.e. electricity, for those running the mining software on their computers. To provide incentive to those willing to volunteer their computers for this task, the network awards bitcoins (50 BTCs at the time of writing) to the account of the miner that generated the correct hash to validate a block. This is why they are referred to as 'miners', since this is the way in which bitcoins come into (virtual) existence.</p>
<p> </p>
<h3><a class="chapter" name="h3-controlled-currency"></a>Controlled currency</h3>
<p>Additionally, the number of bitcoins created through this mining process is in fact controlled by the system. The <em>difficulty</em> [<a href="#ref7">7</a>] of the target that is set for each block being worked on is adjusted collectively by the network every 2,016 blocks so that, on average, six blocks are solved per hour. This difficulty can increase or decrease, depending on how quickly the last 2,016 blocks were generated by the miners. If the network finds that miner nodes generated the blocks too quickly, the difficulty is increased, 'to compensate for increasing hardware speed and varying interest in running nodes over time', as Nakamoto explained in his paper.</p>
<p>Also, the reward of 50 BTC given to the successful miner node will change over time; reducing by half every four years (or approximately 210,000 blocks) to be exact, so that by approximately 2040 the <em>Bitcoin</em> system will stop generating bitcoins. After this point, transactions will still need to be verified, but a miner that solves a block will only be rewarded with bitcoins if the block contains transaction fees specified by transferors (from their own wallets). Nakamoto set it up this way to control the total currency generated in the network, so that by 2040 no more than 21 million bitcoins in total will be in circulation. At the time of writing, 183,249 [<a href="#ref8">8</a>] blocks have been solved, meaning approximately 9.1 million BTCs are in circulation.</p>
<p> </p>
<h3><a class="chapter" name="h3-value"></a>Value</h3>
<p>The real-world value of a bitcoin (BTC) has fluctuated since the system's inception, influenced by supply and demand, its increasing popularity over the years, attention from the media and criminal elements, as well as a number of security incidents. As mentioned previously, bitcoins can be exchanged for real-world currencies, and a number of <em>Bitcoin</em> exchange websites exist that facilitate these exchanges. The first one established was the<em> Bitcoin Market</em> [<a href="#ref9">9</a>] on 6 February 2010, and over the years more exchanges have surfaced, with the <em>Bitcoin </em>wiki [<a href="#ref10">10</a>] listing about 66 exchanges.</p>
<p>The value of the bitcoin currency can vary depending on the exchange used, but the most widely used exchange,<em> Mt. Gox</em> [<a href="#ref11">11</a>], provides a good indication of its value since the exchange was launched on 18 July 2010. The chart in <a href="#figure2">Figure 2</a>, obtained from the <em>Bitcoin</em> <em>charts</em> website [<a href="#ref12">12</a>], tracks the value of a BTC, in US dollars, from July 2010 to this day.</p>
<p><a class="zoom-img" title="Figure 2: Fluctuating value of BTC in $USD." href="/files/1915/1748/0258/Bitcoin-malware-fig2.jpg"><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/76a390fde0d3cbf06f5848520b91f944_f2505.jpg" alt="Bitcoin-malware-fig2.jpg" width="840" height="350" /></a><span class="centered-caption"><a class=" anchor" name="figure2"></a>Figure 2: Fluctuating value of BTC in $USD.</span></p>
<p>9 June 2011 shows the point at which the value of a BTC reached its peak, climbing to $29.58 USD, but dropping since to its current value of $5.246 USD. As we shall see later, only a week after this peak, we saw the first trojan in the wild targeting <em>Bitcoin</em> users.</p>
<p> </p>
<h2><a class="chapter" name="h2-how-mining-works"></a>How mining works</h2>
<p><em>Bitcoin</em> users that choose to mine for bitcoins must run special mining software on their systems to accomplish this task. Due to the brute force needed to generate hashes, mining software requires extensive processing power to aid in its calculations, using the system's CPU, GPU or FPGA to help increase the hash rate. The <em>Bitcoin</em> wiki lists a number of CPU, GPU and/or FPGA bitcoin miners that are capable of running on multiple platforms and are freely available on the Internet, including:</p>
<ul>
<li>CPU Miner</li>
<li>DiabloMiner</li>
<li>Phoenix Miner</li>
<li>Python/OpenGL GPUMiner</li>
<li>RPC Miner</li>
<li>Ufasoft miner.</li>
</ul>
<p>The <em>Bitcoin</em> network uses the JSON-RPC communication protocol for all its network communications. Basically, bitcoin miners communicate with a <em>Bitcoin</em> client configured as a server, which in turn interacts with the <em>Bitcoin</em> network to retrieve blocks to work on. The miner retrieves work (i.e. blocks to hash) from the configured server, using a getwork request, performs its hashing on the data, then does another getwork request, this time passing a calculated hash to the server. Upon successfully solving a block, the <em>Bitcoin</em> network would then assign a special transaction contained in each block called a <em>coinbase transaction</em>, which contains the reward, to the address of the <em>Bitcoin</em> client.</p>
<p>Using the bitcoin mining software, a <em>Bitcoin</em> user can decide to mine in two ways; through solo mining, or through pooled mining.</p>
<p> </p>
<h3><a class="chapter" name="h3-solo-mining"></a>Solo mining</h3>
<p>A <em>Bitcoin</em> user can configure their <em>Bitcoin</em> client to act as a server and listen for incoming JSON-RPC connections (usually on port 8332) from the local host. The bitcoin miner, which can run on the local machine or a remote one, is then configured to send getwork requests to the server. To throw more muscle at the hash calculations, many <em>Bitcoin</em> users also set up mining rigs with high specification systems dedicated to mining.</p>
<p> </p>
<h3><a class="chapter" name="h3-pooled-mining"></a>Pooled mining</h3>
<p>Pooled mining differs from solo mining in that bitcoin miners send getwork requests, this time to a remote server – called a <em>mining pool server</em> – configured to allocate work to many miners connected to the pool, sharing the bitcoin reward among those who contributed to solving a block. The pool server requires miners to create an account and most charge a fee (a percentage of the rewarded BTCs) for their service.</p>
<p>Due to the increase in miner nodes and thus the increase in difficulty of solving blocks, many find that, depending on their processing power, it can take anything from days to years (if ever) to solve a block while solo mining. This is why pooled mining is popular, since a pool's combined processing power means blocks are hashed and solved at a faster rate, and participants receive a steady stream of bitcoins for their contribution. There are many mining pool servers online, and as we shall see later, use of these mining pools is common among malware writers.</p>
<p> </p>
<h3><a class="chapter" name="h3-browser-mining"></a>Browser mining</h3>
<p>Installing mining software on a system is not the only way of mining for bitcoins. <em>Bitcoinplus.com</em> [<a href="#ref13">13</a>] is a site that allows visitors to generate hashes through a Java applet embedded in the browser. By creating an account with the site, the user can:</p>
<ul>
<li>Generate bitcoins via an interactive Java applet on the site (<a href="#figure3">Figure 3</a>)</li>
</ul>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/e3676ad66f2ec7fd1a25afd381a38c1f_f2506.jpg" alt="Bitcoin-malware-fig3.jpg" width="280" height="364" /><span class="centered-caption"><a class=" anchor" name="figure3"></a>Figure 3: Bitcoinplus Java applet.</span></p>
<ul>
<li>Send a link to other users so they generate hashes for the sender's account. The link directs a user's browser to the <em>Bitcoin Plus</em> generator page, with the sender's userID specified in the link: http://www.bitcoinplus.com/generate?for=&lt;userID&gt;</li>
<li>Embed JavaScript within their own website that allows visitors to the site to generate hashes for them.</li>
</ul>
<p>As we shall see in the following sections, this service has also been abused by malware writers and those with less-than-honourable intentions.</p>
<p> </p>
<h2><a class="chapter" name="h2-bitcoin-appeal"></a>The Bitcoin appeal</h2>
<p>The way in which the whole <em>Bitcoin</em> system operates has appeal to computer users and the general population. Advocates of the<br /><em>Bitcoin</em> system list numerous advantages to using it, including:</p>
<ul>
<li>No controlling authority and regulations</li>
<li>No transaction fees, even when transferring large sums (unless a fee is specified by the transferor) or internationally (no borders since it's all via the net)</li>
<li>Transfers are quick and (seemingly) anonymous.</li>
</ul>
<p>Such advantages, as well as media attention, have seen an increase in the number of <em>Bitcoin</em> users. For example, a post made on the popular <em>Slashdot</em> forum [<a href="#ref14">14</a>] on 11 July 2010 about the release of <em>Bitcoin v0.3</em> saw an influx of <em>Bitcoin</em> users, as mentioned on the <em>Bitcoin</em> wiki [<a href="#ref15">15</a>]. But the fact that many businesses, including online stores and retailers, are now accepting bitcoins also plays a factor in its increased usage. Some online retailers, providing products such as clothing, home accessories, electronics, books, music, consumables, the list goes on, see bitcoins as a legitimate payment method.</p>
<p> </p>
<h3><a class="chapter" name="h3-appealing-wrong-crowd"></a>Appealing to the wrong crowd</h3>
<p>So the rising interest from media and business, and increasing trust in the <em>Bitcoin</em> system has seen it become a legitimate currency that has a multitude of supporters behind it. These supporters, however, are not always backing the system for honest reasons. Abuse of the <em>Bitcoin</em> system can come in many different flavours, ranging from individuals over-zealous in their bitcoin-mining endeavours, to security breaches resulting in the loss of thousands of bitcoins, and criminal elements using the currency to fund their underground activities.</p>
<p>On 22 June 2011, for example, a security breach was reported on <em>Australian Broadcasting Corporation</em> (<em>ABC</em>) servers, as reported by an <em>ABC</em> insider on the independent journalism website <em>Crikey.com.au</em> [<a href="#ref16">16</a>]. The breach happened when an IT worker with privileged access 'installed a "bitcoin miner" application on ABC servers' [<a href="#ref17">17</a>] so that visitors to the ABC website would unknowingly participate in generating bitcoins for the perpetrator. Exact details of this bitcoin miner application were not revealed, but most likely it was script embedded into the site's source, such as the one provided by <em>Bitcoinplus.com</em>. The worker kept his job and was given a slap on the wrist, but his willingness to use corporate resources to mine for personal gain demonstrates how far some will go to reap the <em>Bitcoin</em> rewards.</p>
<p> </p>
<h3><a class="chapter" name="h3-hacking-incidents"></a>Hacking incidents</h3>
<p>Security breaches of a more serious nature have also occurred on a number of occasions, this time involving the transfer of a large sum of bitcoins from <em>Bitcoin</em> users and <em>Bitcoin</em> exchanges. A number of incidents made headlines in 2011 and early 2012 including:</p>
<ol>
<li>13 June 2011: First reported incident of 25,000 BTCs, worth $500,000 at the time, which were allegedly stolen from a <em>Bitcoin</em> user, as reported by the user on the <em>bitcointalk.org</em> [<a href="#ref18">18</a>] forum.</li>
<li>19 June 2011: Around 500,000 BTCs, worth about $8.75 million USD at the time, were stolen from the <em>Mt. Gox</em> exchange as a result of their database being hacked, as reported by <em>dailytech.com</em> [<a href="#ref19">19</a>].</li>
<li>1 March 2012: <em>Linode</em>, a <em>Linux</em> cloud provider, had one of its customer service portals breached by a hacker [<a href="#ref20">20</a>], who targeted eight <em>Bitcoin</em> customers and was able to transfer bitcoins out of their accounts, worth $71,000 [<a href="#ref21">21</a>].</li>
<li>11 May 2012: The <em>Bitcoinica</em> [<a href="#ref22">22</a>] exchange had its online wallet ransacked for 18,547 BTCs.</li>
</ol>
<p> </p>
<h3><a class="chapter" name="h3-criminal-appeal"></a>Criminal appeal</h3>
<p>On 9 May 2012, <em>Wired.com</em> published a post [<a href="#ref23">23</a>] about a leaked FBI internal report that voiced concerns about the difficulty of tracking the identity of anonymous <em>Bitcoin</em> users and how <em>Bitcoin</em>'s popularity will see it 'become an increasingly useful tool for various illegal activities beyond the cyber realm'. Pointing out the gambit of illegal activities already occurring through the Internet, they suspect <em>Bitcoin</em> will 'attract money launderers, human traffickers, terrorists, and other criminals who avoid traditional financial systems by using the Internet to conduct global monetary transfers.' And these concerns are not unfounded, as is evident from news events making the rounds in June 2011 concerning the hacker group LulzSec accepting bitcoin donations, and, more worryingly, as regards an online illegal drug market named Silk Road that uses bitcoins as their preferred payment method.</p>
<p>First described in a <em>Gawker</em> article [<a href="#ref24">24</a>] on 1 June 2011, Silk Road is an online drug marketplace that allows visitors to browse through a library of illegal drugs and purchase them from sellers located around the world using bitcoins exclusively. Access to Silk Road is only possible through Tor [<a href="#ref25">25</a>], a system that enables online anonymity by encrypting and routing Internet traffic through a network of relays run by volunteers. This combination of accessing the site through the Tor network and buying with bitcoins makes it difficult for authorities to track these purchases.</p>
<p> </p>
<h3><a class="chapter" name="h3-how-anonymous-bitcoin"></a>How anonymous is Bitcoin?</h3>
<p><em>Bitcoin</em> may not be as anonymous as it seems, as mentioned by a <em>Bitcoin</em> core development team member, Jeff Garzik, in the same <em>Gawker</em> article. He stated that even though transactions are anonymous, the fact that all transactions are recorded in a public ledger (block chain) means that 'law enforcement could use sophisticated network analysis techniques to parse the transaction flow and track down individual <em>Bitcoin</em> users'. And researchers from University College Dublin published an analysis [<a href="#ref26">26</a>] of anonymity in the <em>Bitcoin</em> network on 30 September 2011, showing they could 'de-anonymize considerable portions of the <em>Bitcoin</em> network' using passive analysis of publicly available data, as well as follow the flow of bitcoins using different network analysis tools.</p>
<p> </p>
<h2><a class="chapter" name="h2-malware-writers-set-their-eyes-prize"></a>Malware writers set their eyes on the prize</h2>
<p>The first malware to target <em>Bitcoin</em> was discovered in the wild on 16 June 2011, and first reported in the <em>Symantec</em> blog [<a href="#ref27">27</a>]. The trojan, TrojanSpy:Win32/Wanwacay.A (also known as Infostealer:Coinbit by <em>Symantec</em>), was spammed to <em>Bitcoin</em> users as a private message on various <em>Bitcoin</em> forums [<a href="#ref28">28</a>]. Its sole purpose was simply to search for a wallet.dat file in the file location %User%\AppData\Roaming\Bitcoin. The trojan then connects to the SMTP server 'smtp.wp.pl' and emails the wallet to the attacker's email address. It also displays a user interface (<a href="#figure4">Figure 4</a>) after it has stolen the wallet.dat file:</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/e83ae663f78a88265f27fadf4861894f_f2507.jpg" alt="Bitcoin-malware-fig4.jpg" width="720" height="331" /><span class="centered-caption"><a class=" anchor" name="figure4"></a>Figure 4: Win32/Wanwacay.A user interface.</span></p>
<p>Although lacking in sophistication, this trojan made it clear that bitcoins were now on malware writers' radars, and the wallet.dat file was the first aspect of the <em>Bitcoin</em> system they set their eyes on.</p>
<p> </p>
<h3><a class="chapter" name="h3-wallet-theft"></a>Wallet theft</h3>
<p>The factor that made the wallet.dat file an easy target for attackers is the fact that the original <em>Bitcoin</em> client, developed by <em>bitcoin.org</em>, does not encrypt this file by default, and stores it in a well-known location, as mentioned in the 'Wallet' section. The <em>Bitcoin</em> developer and user community have consistently given advice and technical know-how to all <em>Bitcoin</em> users on how to encrypt the wallet – devoting a section on the <em>Bitcoin</em> wiki, for instance, on how to properly secure the wallet [<a href="#ref29">29</a>]. Backing up the wallet and storing it on an encrypted disk image is a common recommendation given to users, and as development of the <em>Bitcoin</em> client progresses and newer versions are released, the option to encrypt the wallet has been introduced into the software, as shown in <a href="#figure5">Figure 5</a>.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/3ead91db043652e3625cbcc15d435c5c_f2508.jpg" alt="Bitcoin-malware-fig5.jpg" width="540" height="213" /><span class="centered-caption"><a class=" anchor" name="figure5"></a>Figure 5: Bitcoin client wallet encryption.</span></p>
<p>So theft of the wallet.dat file has been a well-known attack vector to all involved in the <em>Bitcoin</em> community, and implementing such guidelines and upgrades to the <em>Bitcoin </em>software would most assuredly make authors of Win32/Wanwacay.A reassess their strategy.</p>
<p>Of course, Win32/Wanwacay was the first, but not the only malware family targeting the wallet.dat file. Other families known to steal the wallet.dat file include:</p>
<ul>
<li>TrojanSpy:MSIL/Golroted.A</li>
<li>TrojanSpy:BAT/Mincostel.A</li>
<li>TrojanSpy:Win32/Aregorp.A</li>
<li>TrojanSpy:Win32/USteal.D</li>
<li>Backdoor:Win32/Kelihos.B</li>
<li>Backdoor:MacOS_X/DevilRobber</li>
</ul>
<p><strong>TrojanSpy:MSIL/Golroted.A:</strong> Written in the Common Intermediate Language, MSIL/Golroted gathers sensitive information from the computer such as usernames and passwords for various applications including <em>Runescape</em>, <em>Minecraft</em>, and <em>RSBuddy</em>, as well as logging the user's key stokes. It contains a routine, named <em>Bitcoinsub()</em>, that emails the wallet.dat file to the attacker as an attachment if it exists.</p>
<p>The email sent to the attacker contains the following subject and message body:</p>
<pre>Subject: PLogger 6.x.x Bitcoin Stealer – [%computername%]<br />Message: Steals the Wallet.DAT file that holds the users bitcoin currency</pre>
<p><strong>TrojanSpy:BAT/Mincostel.A:</strong> A batch file trojan that is dropped by a self-extracting RAR, along with a VB script that launches it. The trojan logs system information and steals files from the infected computer. It copies the wallet.dat file, as well as an addr.dat file, from the default <em>Bitcoin</em> directory to the location %computername%\Bitcoin. The addr.dat file contains a list of IPs that are used by the <em>Bitcoin</em> client to connect to other nodes in the network when it is launched.</p>
<p>TrojanSpy:BAT/Mincostel also searches for the folder 'poclbm' in the %APPDATA% directory, which is a folder created by the popular <em>PyOpenCL</em> bitcoin miner, copying its contents to %computername%\BitCoin\BitCoinMiner.<a href="#figure6"> Figure 6</a> shows the code responsible for the above routine.</p>
<p><a class="zoom-img" title="Figure 6: Mincostel copying wallet.dat and addr.dat." href="/files/9315/1748/3083/Bitcoin-malware-fig6.jpg"><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/0157b0c5208693f242fe51e44d33ed1d_f2509.jpg" alt="Bitcoin-malware-fig6.jpg" width="845" height="127" /></a><span class="centered-caption"><a class=" anchor" name="figure6"></a>Figure 6: Mincostel copying wallet.dat and addr.dat.</span></p>
<p><strong>TrojanSpy:Win32/Aregorp.A:</strong> A trojan that simply terminates the bitcoin.exe process if it is running on the compromised computer, looks for %APPDATA%\Bitcoin\wallet.dat, and uploads the file to the FTP server xier.zapto.org.</p>
<p><strong>TrojanSpy:Win32/USteal.D:</strong> A trojan spy that gathers sensitive information from an infected computer, including protected storage passwords, FAR Manager and Total Commander cached FTP passwords, gtalk account information, and the <em>Bitcoin</em> wallet.dat file, posting them to an FTP server of the attacker's choosing.</p>
<p><strong>Backdoor:Win32/Kelihos.B</strong> is another notable family that attempts to steal the wallet.dat file, as well as a backdoor targeting <em>Mac</em> users, <strong>Backdoor:MacOS_X/DevilRobber.A</strong>. Both also contain bitcoin-mining capabilities, which, as we shall see in the coming section, is a much more popular and prevalent technique than stealing the <em>Bitcoin</em> wallet.</p>
<p> </p>
<h3><a class="chapter" name="h3-getting-some-mine-age"></a>Getting some mine-age</h3>
<p>A drawback of <em>Bitcoin</em> wallet theft, from a malware author's perspective, is that it may be a fruitless task since an infected computer must have a <em>Bitcoin</em> client installed and have 'funds' in their wallet. But there is something on a computer user's system they can undoubtedly count on and use to their advantage: the system's processing power.</p>
<p>The first malicious program seen in the wild containing bitcoin-mining capabilities was discovered on 26 June 2011, only a few weeks after TrojanSpy:Win32/Wanwacay.A appeared on the scene. The trojan, detected as Trojan:Win32/Minepite.A, was spotted by <em>Kaspersky</em> analysts in the 'Russian sector of the Internet', as mentioned by Alexander Gostev in the securelist.com blog post [<a href="#ref30">30</a>] where its details were first unveiled.</p>
<p>Win32/Minepite.A is distributed as a <em>Nullsoft</em> installer that installs an executable with the fi le name bcm.exe, a popular miner developed by <em>Ufasoft</em> [<a href="#ref31">31</a>]. The malicious part of this piece of malware comes from the <em>Nullsoft</em> script that is used to install bcm.exe, shown in <a href="#figure7">Figure 7</a>.</p>
<p><a class="zoom-img" title="Figure 7: Win32/Minepite.A installer script." href="/files/7815/1748/3535/Bitcoin-malware-fig7.jpg"><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/66df5e644f7e54601496d97412739775_f2510.jpg" alt="Bitcoin-malware-fig7.jpg" width="845" height="59" /></a><span class="centered-caption"><a class=" anchor" name="figure7"></a>Figure 7: Win32/Minepite.A installer script.</span></p>
<p>The installer script passes to the miner executable a number of command line parameters. The help menu for the <em>Ufasoft</em> miner (<a href="#figure8">Figure 8</a>) details what these parameters mean.</p>
<p><a class="zoom-img" title="Figure 8: Ufasoft bitcoin miner help menu." href="/files/6115/1748/3637/Bitcoin-malware-fig8.jpg"><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/6ed3d6dd8970a009007f1e4dd7b19e1a_f2511.jpg" alt="Bitcoin-malware-fig8.jpg" width="845" height="211" /></a><span class="centered-caption"><a class=" anchor" name="figure8"></a>Figure 8: Ufasoft bitcoin miner help menu.</span></p>
<p>So, Win32/Minepite.A runs the bitcoin miner, instructing it to getwork from the mining pool server http://pit.deepbit.net:8332, perform its hashing (using the GPU for faster hashing), and post back calculated results, every five seconds, ensuring that the results are attributed to the attacker's mining pool account by including their username and password (specified by the -u and -p arguments).</p>
<p> </p>
<h3><a class="chapter" name="h3-dropping-bitcoin"></a>Dropping the (Bit)coin</h3>
<p>This method of utilizing freely available bitcoin-mining tools is in fact the more common means by which malware authors use<br />a compromised computer to mine bitcoins. Instead of reinventing the wheel, all that's required is to package a legitimate bitcoin miner with another component that invokes it with the appropriate parameters. For instance, a common way in which this is accomplished is by distributing an installer, such as a self-extracting RAR or ZIP file, which drops a bitcoin miner and a batch file that launches it.</p>
<p>TrojanDropper:Win32/MineBicoin.A is an example of this method put to work. Distributed as a self-extracting RAR, it drops another self-extractor with the filename start1.exe, which in turn drops three files, hstart.exe, x.bat (detected as Trojan:BAT/MineBoin.A), and x11811.exe, launching hstart.exe with the parameter ‘/NOCONSOLE x.bat’, as can be seen in the installer script viewed in <em>WinRAR</em> (<a href="#figure9">Figure 9</a>).</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/236dac16b9e9ab1fa2f4a34ce727c044_f2512.jpg" alt="Bitcoin-malware-fig9.jpg" width="760" height="160" /><span class="centered-caption"><a class=" anchor" name="figure9"></a>Figure 9: TrojanDropper:Win32/MineBicoin.A self-extracting RAR.</span></p>
<p>Hstart.exe is a clean utility used to launch the x.bat file without displaying a window, and X11811.exe is a <em>Ufasoft</em> bitcoin miner. Similar to the Win32/Minepite.A <em>Nullsoft</em> script, the batch file launches the <em>Ufasoft</em> miner and instructs it to getwork from the pool server http://x.miners.in every 60 seconds (<a href="#figure10">Figure 10</a>). It also attempts to terminate three processes, one with the same name as the <em>Ufasoft</em> miner, and others belonging to bitcoin miners known to be dropped by other malware.</p>
<p><a class="zoom-img" title="Figure 10: Trojan:BAT/MineBicoin.A batch fi le." href="/files/5115/1748/3975/Bitcoin-malware-fig10.jpg"><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/c0537341b0326fdd75f7fa7ee515cabc_f2513.jpg" alt="Bitcoin-malware-fig10.jpg" width="844" height="66" /></a><span class="centered-caption"><a class=" anchor" name="figure10"></a>Figure 10: Trojan:BAT/MineBicoin.A batch file.</span></p>
<p>Trojan:Win32/Bocinex.gen!A is another trojan that has been seen distributed in a self-extracting RAR and dropped onto an infected computer along with a legitimate bitcoin miner. The first sample of this malware family we received in our labs came with the file name x10.exe, and drops two executable files, one being the bitcoin miner launcher component using the filename winlogons.exe, and the other a <em>Ufasoft</em> bitcoin miner, xC.exe. Winlogons.exe simply launches xC.exe using the ShellExecuteExA() API, passing the appropriate parameters so that the miner can do its work using the computer's GPU, as shown in <a href="#figure11">Figure 11</a>.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/26852a8d1313d068a36f7cd742104a9e_f2514.jpg" alt="Bitcoin-malware-fig11.jpg" width="800" height="267" /><span class="centered-caption"><a class=" anchor" name="figure11"></a>Figure 11: Win32/Bocinex.gen!A launching a Ufasoft bitcoin miner and passing parameters.</span></p>
<p> </p>
<h3><a class="chapter" name="h3-bitcoin-miner-memory-loading"></a>Bitcoin miner memory loading</h3>
<p>Instead of dropping a freely available bitcoin miner onto a compromised computer and invoking it, another malware family, Trojan:Win32/Vicenor, does it through memory loaders. Win32/Vicenor is distributed as a PE file that contains an encrypted <em>Ufasoft</em> bitcoin miner executable within one of its sections. This executable can then be loaded directly into memory and passed parameters such as the following using the CreateProcessA() API:</p>
<pre>miner.exe -a 60 -g no -o http://pool.dload.asia:8332/<br />-u darkSons_crypt -p &lt;password&gt;</pre>
<p>Based on the samples we've received in our labs, the memory loaders used by Vicenor are varied and have been developed in either the C++ or Visual Basic languages. Many of these loaders have also been used by Worm:Win32/Dorkbot, also known as Nrgbot.</p>
<p> </p>
<h3><a class="chapter" name="h3-bitcoin-miner-downloader"></a>Bitcoin miner downloader</h3>
<p>Rather than including a bitcoin miner in a package or loading it into memory, some malware families simply download the bitcoin miner from a particular domain.</p>
<p>Trojan:MSIL/Remdobe.A is a trojan that uses this method, downloading a <em>Ufasoft</em> bitcoin miner onto the compromised computer and executing it with the appropriate parameters. However, it first checks whether the compromised system is a 32-bit or 64-bit version of <em>Windows</em>, and either downloads from the dl.dropbox.com domain a 32-bit <em>Ufasoft</em> miner named bitcoin-miner.exe, or a 64-bit version named bitcoin-miner-64.exe. It then executes the downloaded miner with the following parameters:</p>
<pre>-a 20 -t 2 -o http://&lt;username&gt;:&lt;password&gt;@pool.bitclockers.com:8332/</pre>
<p> </p>
<h3><a class="chapter" name="h3-bitcoin-mining-worm"></a>Bitcoin-mining worm</h3>
<p>Worm:Win32/Bosidome.A is a worm that spreads via removable drives and P2P networks and contains bitcoin-mining functionality. This worm, however, does not drop, inject, or download a bitcoin miner onto the system, rather it uses the <em>Bitcoin Plus</em> mining service to do the mining. We found the generator for this worm, called BitcoinPlusMiner 1.1 (<a href="#figure12">Figure 12</a>), which displays a number of input fields, including:</p>
<p style="padding-left: 30px;">'<em>Your generate bitcoin link</em>' – a link to the <em>BitcoinPlus </em>generator page (e.g. http://www.bitcoinplus.com/generate?for=012345678)</p>
<p style="padding-left: 30px;">'<em>Java url</em>' – link to Java installation</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/b12939c0a8b65843db1e63b42dd859f9_f2515.jpg" alt="Bitcoin-malware-fig12.jpg" width="280" height="386" /><a name="figure12"></a><span class="centered-caption">Figure 12: Worm:Win32/Bosidome.A generator.</span></p>
<p>The worm is programmed to launch<em> Internet Explorer</em> in the background and direct the browser to the<em> Bitcoin Plus</em> generator page, ensuring the compromised user is unaware they are generating bitcoins for the account holder through the <em>Bitcoin Plus</em> Java applet.</p>
<p> </p>
<h3><a class="chapter" name="h3-first-macosx-bitcoin-backdoor"></a>First MacOSX Bitcoin backdoor</h3>
<p>Backdoor:MacOSX/DevilRobber.A [<a href="#ref32">32</a>] made the headlines in October 2011 for being the first trojan to target <em>Mac</em> users. DevilRobber.A opens a backdoor on the infected system and steals sensitive information, as well as acting as a proxy server. It also has bitcoin-mining and wallet-stealing functionality.</p>
<p>For the wallet-stealing functionality, it uses a shell script to dump the contents of the wallet, which by default is located at '~/Library/Application Support/Bitcoin/wallet.dat', to a file named 'dump.txt', as can be seen in <a href="#figure13">Figure 13</a>.</p>
<p><a class="zoom-img" title="Figure 13: DevilRobber wallet-dumping code (note: $D_FILE = ‘dump.txt’)." href="/files/5215/1748/4628/Bitcoin-malware-fig13.jpg"><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/2699afaf359ef02873f730dc45f16337_f2516.jpg" alt="Bitcoin-malware-fig13.jpg" width="845" height="69" /></a><span class="centered-caption"><a class=" anchor" name="figure13"></a>Figure 13: DevilRobber wallet-dumping code (note: $D_FILE = 'dump.txt').</span></p>
<p>Similar to previous malware we've observed targeting bitcoins, DevilRobber uses the same technique of installing a freely available program to execute its bitcoin-mining payload. The trojan installs the OS X GPU version of the popular miner <em>DiabloMiner</em>, with file name 'DiabloMiner-OSX.sh', using a script named 'miner.sh', as well as executing a CPU miner named 'minerd'.</p>
<p> </p>
<h3><a class="chapter" name="h3-monetizing-botnets-bitcoins"></a>Monetizing botnets with bitcoins</h3>
<p>Bot herders would undoubtedly find the <em>Bitcoin</em> system's distributed computing technique a tempting prospect. Directing the power of their zombie PCs towards bitcoin mining no doubt would be an appealing proposition for a botmaster, and adding bitcoin-mining functionality to their arsenal of malicious programs is another example of the lengths they will take to monetize their botnets. A report by <em>Symantec</em> [<a href="#ref33">33</a>] on 17 June 2011 showed that in perfect conditions (mining for 24 hours a day and having extremely good luck), a botmaster could earn from a 100,000 strong botnet of CPUs hashing at one megahash per second, about $97,000 USD per month, based on the difficultly of a block target and the exchange rate at the time ($20 USD).</p>
<p>The second half of 2011 saw the addition of bitcoin-mining functionality in some of the more sophisticated, notorious and/or prevalent malware families making the rounds, including Win32/Alureon (aka TDSS), Sirefef (aka ZeroAccess/Max++), Rorpian, Kelihos, and a recently discovered family, Win32/Bafruz.</p>
<p> </p>
<h3><a class="chapter" name="h3-sirefef"></a>Sirefef</h3>
<p>Sirefef [<a href="#ref34">34</a>] is a sophisticated, multi-component malware family that uses stealth techniques to hide itself on a compromised computer and communicate with other remote peers using a P2P protocol. Sirefef has multiple parts to it, and is capable of performing a number of payloads, including modifying Internet search results, generating pay-per-click advertisements, downloading additional malware, replacing system drivers, as well as bitcoin mining.</p>
<p>It's this last point that we are interested in for this paper. As mentioned, Sirefef can communicate with remote peers by utilizing a P2P protocol, allowing it to update itself or download additional malware onto the system. Sirefef downloads files to a hidden folder it creates in the &lt;system root&gt; directory, using unique filenames for these fi les such as the ones listed below:</p>
<p style="padding-left: 30px;"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f0c0c0c0c0c0c0c0c1deb0">[email&#160;protected]</a><br /><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f7c7c7c7c7c7c7c7c5d9b7">[email&#160;protected]</a><br /><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d4e4e4e4e4e4e4e4e0fa94">[email&#160;protected]</a><br /><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b9818989898989898997f9">[email&#160;protected]</a><br /><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c7fff7f7f7f7f7f7f3e987">[email&#160;protected]</a><br /><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="91a9a1a1a1a1a1a2a3bfd1">[email&#160;protected]</a></p>
<p>Of these files, we observed malware belonging to the Win32/Alureon [<a href="#ref35">35</a>] and Win32/Conedex [<a href="#ref36">36</a>] families, as well as an <em>Ufasoft</em> bitcoin miner. These files cannot be executed on their own, as they can either be resource-only DLLs that have an executable component embedded within them, or PE files with no entry point, but an export that is loaded by the Sirefef driver component. This is probably a means by which the Sirefef authors attempt to thwart AV products that rely on emulation to detect these malware families and the bitcoin miner.</p>
<p> </p>
<h3><a class="chapter" name="h3-alureon-gang-set-their-eyes-bitcoin-prize"></a>The Alureon gang set their eyes on the Bitcoin prize</h3>
<p>Alureon is also an infamous, highly prevalent malware family that has multiple components. It has evolved over the years, and we've seen it modify users' DNS settings, intercept Internet traffic, infect system drivers, infect 32- and 64-bit system Master Boot Records, as well as download additional malware onto a compromised system.</p>
<p>Certain variants of this family, Win32/Alureon.DX for instance, are known to store a number of files in an encrypted virtual file system (VFS), including a configuration file named cfg.ini. This file contains keywords interpreted by Alureon and information such as version information, files to be injected into svchost.exe, and a list of command servers Alureon connects to. <a href="#figure14">Figure 14</a> shows an example of an Alureon configuration file:</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/23ecddd4170a85797b02b68e17d6d382_f2517.jpg" alt="Bitcoin-malware-fig14.jpg" width="300" height="128" /><span class="centered-caption"><a class=" anchor" name="figure14"></a>Figure 14: Alureon configuration file.</span></p>
<p>On 14 September 2011, <em>Kaspersky Lab</em> researchers published a blog post [<a href="#ref37">37</a>] detailing an update to the Alureon configuration file they noticed was made at the start of August 2011. As Sergey Golovanov detailed, a 'new section [tslcaloc] has appeared in the TDSS configuration files', listing underneath it an executable run with the familiar miner parameters:</p>
<pre>[tslcaloc]<br />Svchost.exe=180| -g yes –t 1 -0 http://pacrim.eclipsemc.com:8337/ -u &lt;username&gt; -p &lt;password&gt;</pre>
<p>So it's obvious that the gang behind Alureon decided that bitcoin mining was now fair game by updating their creations to include this functionality. But, it seems Trojan:Win32/Alureon wasn't the only component of this conglomeration to receive a <em>Bitcoin</em> update.</p>
<p> </p>
<h3><a class="chapter" name="h3-rorpian"></a>Rorpian</h3>
<p>Worm:Win32/Rorpian, a family of worms that spread through network shares and the LNK vulnerability MS10-046, downloads Win32/Alureon onto compromised machines and is developed by the same authors. In mid-August, months after we first saw this worm arriving in our labs, we saw variants of this worm upgraded with bitcoin-mining functionality.</p>
<p>Now, what makes this upgrade different from the Win32/Alureon component, as well as most other malware we've discussed in this paper so far, is that the authors of this worm decided to implement the bitcoin-mining code themselves, rather than rely on a freely available mining utility.</p>
<p>As mentioned in the 'How mining works' section, bitcoin miners communicate with mining pool servers using the JSON-RPC remote procedure protocol. Win32/Rorpian uses the same protocol to communicate with the server http://188.229.89.120 :8334, retrieving data from the server using a getwork request and calculating the hashes on the returned data before it posts the results to the server. This same server is used by Rorpian to download additional malware, and was registered in Romania.</p>
<p> </p>
<h3><a class="chapter" name="h3-kelihos"></a>Kelihos</h3>
<p>Backdoor:Win32/Kelihos.B, a prevalent backdoor variant of the Kelihos family that includes functionality to send spam emails, download files, communicate with other infected computers, and steal sensitive information, also has bitcoins in its sights, with new code modules included in this variant that steal the <em>Bitcoin</em> wallet and perform mining.</p>
<p>The wallet-stealing module contains code that grabs the wallet.dat file if it exists in the following file locations (default locations in <em>WinXP</em> and <em>Win 7</em> &amp; <em>Vista</em>):</p>
<pre>%APPDATA%\Bitcoin\wallet.dat<br />%APPDATA%\Roaming\Bitcoin\wallet.dat</pre>
<p>The mining module contains code that performs bitcoin mining as ordered from its controller, allowing it to perform hashing on blocks it receives from its control server (<a href="#figure15">Figure 15</a>).</p>
<p><a class="zoom-img" title="Figure 15: Kelihos bitcoin-mining module." href="/files/3415/1748/5514/Bitcoin-malware-fig15.jpg"><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/85607e2251603f0221aa10ae52c9b7ca_f2518.jpg" alt="Bitcoin-malware-fig15.jpg" width="845" height="63" /></a><span class="zoom-img centered-caption"><a class=" anchor" name="figure15"></a>Figure 15: Kelihos bitcoin-mining module.</span></p>
<p> </p>
<h3><a class="chapter" name="h3-bafruz"></a>Bafruz</h3>
<p>Backdoor:Win32/Bafruz is a backdoor trojan used in a P2P botnet, and contains multiple components that can be downloaded onto a compromised machine through communication with its peers. Components of Bafruz include functionality to:</p>
<ul>
<li>Disable anti-virus software and display fake anti-virus alerts</li>
<li>Hijack <em>Facebook</em> and <em>Vkontakte</em> accounts</li>
<li>Perform HTTP and UDP DDoS attacks</li>
<li>Download additional malware</li>
<li>Download bitcoin-mining software</li>
<li>Run a Bitcoin server and allocate tasks to mining components.</li>
</ul>
<p>When the <em>Bitcoin</em> server component is installed on a compromised machine, it listens for incoming RPC connections from the client components to allocate work for them. The client is able to download three bitcoin miners onto the compromised system, such as the <em>Ufasoft</em>, <em>RPC</em> and <em>Phoenix</em> miners, and execute them. It also checks the <em>Windows</em> version of the system it is running on and whether an ATI graphics card is installed, after which it may download a 32-bit or 64-bit version of the card driver (driver URLs are listed in <a href="#figure16">Figure 16</a>) to help in its GPU-mining efforts.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/f5b24419b6cf8899108520bcf40f8283_f2519.jpg" alt="Bitcoin-malware-fig16.jpg" width="760" height="265" /><span class="centered-caption"><a class=" anchor" name="figure16"></a>Figure 16: Bafruz list of driver URLs.</span></p>
<p> </p>
<h2><a class="chapter" name="h2-conclusion"></a>Conclusion</h2>
<p>One question that one might pose about <em>Bitcoin</em> and all the security issues we've discussed in this paper so far, is: will attacks of this nature continue in the future? We've seen a number of security breaches involving <em>Bitcoin</em> exchanges and <em>Bitcoin</em> users that resulted in the theft of millions of dollars worth of bitcoins, and as the <em>Bitcoin</em> network continues to produce more currency, it is likely these attacks will continue.</p>
<p>We also discussed illegal trade involving bitcoins, with the online drug market Silk Road being used for the sale and purchase of illicit drugs using bitcoins as its sole payment method due to its apparent anonymity. But we also saw that <em>Bitcoin</em> isn't as anonymous as it seems, with research published showing that using different network inspection techniques, it is possible to identify <em>Bitcoin</em> users. And although purchases using <em>Bitcoins</em> cannot be blocked, many in the <em>Bitcoin</em> community have expressed concerns that governments may freeze <em>Bitcoin </em>exchange accounts and ban transactions involving <em>Bitcoin </em>exchanges after a letter [<a href="#ref38">38</a>] was sent by two US senators to federal authorities asking them to crack down on Silk Road and the use of bitcoins.</p>
<p>Finally, we provided an analysis of the different malware seen in the wild that target bitcoins and look to profit from the system. Is it truly as profitable as malware authors think it is? We saw a report by <em>Symantec</em> showing that in ideal conditions, a botnet of 100,000 infected machines could earn its botmaster $97,000 USD a month. That was in June 2011, and we've seen how volatile the value of a bitcoin has been since then. The flocks of <em>Bitcoin</em> users choosing to mine for bitcoins means that solving blocks will continue to get more difficult because that's simply how the system is designed. So if we recalculate (using the <em>Bitcoin Mining Calculator</em> [<a href="#ref39">39</a>] online tool) the monthly earnings, this time using today's difficulty (1583177.847444) and bitcoin exchange rate ($5.246 USD), we find earnings of $10,000 USD. That's a considerable drop in one year, and the fact that the bitcoin reward for solving blocks will drop by a half in 2013 means less of a profit for those wanting to mine, hence malware authors' and cybercriminals' interest in bitcoins will really depend on how the system grows over the coming years.</p>
<p> </p>
<h2><a class="chapter" name="h2-references"></a>References</h2>
<p><a class=" anchor" name="ref1"></a>[1] <a href="https://www.mersenne.org/" target="_blank">http://www.mersenne.org/</a>.</p>
<p><a class=" anchor" name="ref2"></a>[2] <a href="https://setiathome.berkeley.edu/sah_about.php" target="_blank">http://setiathome.berkeley.edu/sah_about.php</a>.</p>
<p><a class=" anchor" name="ref3"></a>[3] <a href="https://www.mail-archive.com/cryptography@metzdowd.com/msg10152.html" target="_blank">http://www.mail-archive.com/<span class="__cf_email__" data-cfemail="dab9a8a3aaaeb5bda8bbaab2a39ab7bfaea0beb5adbef4b9b5b7">[email&#160;protected]</span>/msg10152.html</a>.</p>
<p><a class=" anchor" name="ref4"></a>[4] <a href="https://bitcoin.it" target="_blank">https://bitcoin.it</a>.</p>
<p><a class=" anchor" name="ref5"></a>[5] <a href="https://en.bitcoin.it/wiki/Main_Page" target="_blank">https://en.bitcoin.it/wiki/Main_Page</a>.</p>
<p><a class=" anchor" name="ref6"></a>[6] Nakamoto, S. Bitcoin: A Peer-to-Peer Electronic Cash System. <a href="https://bitcoin.org/bitcoin.pdf" target="_blank">http://bitcoin.org/bitcoin.pdf</a>.</p>
<p><a class=" anchor" name="ref7"></a>[7] <a href="https://en.bitcoin.it/wiki/Difficulty" target="_blank">https://en.bitcoin.it/wiki/Difficulty</a>.</p>
<p><a class=" anchor" name="ref8"></a>[8] Figure obtained from blockexplorer.com at 12:24 EST on June 8th, 2012: <a href="https://blockexplorer.com/q/getblockcount" target="_blank">http://blockexplorer.com/q/getblockcount</a>.</p>
<p><a class=" anchor" name="ref9"></a>[9] <a href="https://www.bitcoinmarket.com" target="_blank">https://www.bitcoinmarket.com</a>.</p>
<p><a class=" anchor" name="ref10"></a>[10] <a href="https://en.bitcoin.it/wiki/Category:Exchanges" target="_blank">https://en.bitcoin.it/wiki/Category:Exchanges</a>.</p>
<p><a class=" anchor" name="ref11"></a>[11] <a href="https://mtgox.com" target="_blank">https://mtgox.com</a>.</p>
<p><a class=" anchor" name="ref12"></a>[12] <a href="https://bitcoincharts.com/charts/mtgoxUSD#igDailyztgCzm1g10zm2g25zcv" target="_blank">http://bitcoincharts.com/charts/mtgoxUSD#igDailyztgCzm1g10zm2g25zcv</a>.</p>
<p><a class=" anchor" name="ref13"></a>[13] <a href="http://www.bitcoinplus.com/" target="_blank">http://www.bitcoinplus.com/</a>.</p>
<p><a class=" anchor" name="ref14"></a>[14] Bitcoin Releases Version 0.3, <a href="https://news.slashdot.org/story/10/07/11/1747245/Bitcoin-Releases-Version-03" target="_blank">http://news.slashdot.org/story/10/07/11/1747245/Bitcoin-Releases-Version-03</a>.</p>
<p><a class=" anchor" name="ref15"></a>[15] <a href="https://en.bitcoin.it/wiki/History" target="_blank">https://en.bitcoin.it/wiki/History</a>.</p>
<p><a class=" anchor" name="ref16"></a>[16] <a href="http://www.crikey.com.au/" target="_blank">http://www.crikey.com.au/</a>.</p>
<p><a class=" anchor" name="ref17"></a>[17] <a href="http://www.crikey.com.au/2011/06/22/tips-andrumours-481/" target="_blank">http://www.crikey.com.au/2011/06/22/tips-andrumours-481/</a>.</p>
<p><a class=" anchor" name="ref18"></a>[18] <a href="https://bitcointalk.org/index.php?topic=16457.0" target="_blank">https://bitcointalk.org/index.php?topic=16457.0</a>.</p>
<p><a class=" anchor" name="ref19"></a>[19] Mick, J. Inside the Mega-Hack of Bitcoin: the Full Story. <a href="http://www.dailytech.com/Inside+the+MegaHack+of+Bitcoin+the+Full+Story/article21942.htm" target="_blank">http://www.dailytech.com/Inside+the+MegaHack+of+Bitcoin+the+Full+Story/article21942.htm</a>.</p>
<p><a class=" anchor" name="ref20"></a>[20] linode.com, Manager Security Incident. <a href="http://status.linode.com/2012/03/manager-securityincident.html" target="_blank">http://status.linode.com/2012/03/manager-securityincident.html</a>.</p>
<p><a class=" anchor" name="ref21"></a>[21] Leyden, J. Linode hackers escape with $70K in daring bitcoin heist. The Register. <a href="https://www.theregister.co.uk/2012/03/02/linode_bitcoin_heist/" target="_blank">http://www.theregister.co.uk/2012/03/02/linode_bitcoin_heist/</a>.</p>
<p><a class=" anchor" name="ref22"></a>[22] <a href="https://bitcoinica.com/" target="_blank">https://bitcoinica.com/</a>.</p>
<p><a class=" anchor" name="ref23"></a>[23] <a href="https://www.wired.com/threatlevel/2012/05/fbi-fearsbitcoin/" target="_blank">http://www.wired.com/threatlevel/2012/05/fbi-fearsbitcoin/</a>.</p>
<p><a class=" anchor" name="ref24"></a>[24] Chen, A. The underground website where you can buy any drug imaginable. <a href="http://gawker.com/5805928/theunderground-website-where-you-can-buy-any-drugimaginable" target="_blank">http://gawker.com/5805928/theunderground-website-where-you-can-buy-any-drugimaginable</a>.</p>
<p><a class=" anchor" name="ref25"></a>[25] <a href="https://www.torproject.org/" target="_blank">https://www.torproject.org/</a>.</p>
<p><a class=" anchor" name="ref26"></a>[26] Fergal, R.; Martin, H. An Analysis of Anonymity in the Bitcoin System. <a href="https://anonymity-in-bitcoin.blogspot.com.au/2011/07/bitcoin-is-not-anonymous.html" target="_blank">http://anonymity-in-bitcoin.blogspot.com.au/2011/07/bitcoin-is-not-anonymous.html</a>.</p>
<p><a class=" anchor" name="ref27"></a>[27] <a href="https://www.symantec.com/connect/blogs/all-yourbitcoins-are-ours" target="_blank">http://www.symantec.com/connect/blogs/all-yourbitcoins-are-ours</a>.</p>
<p><a class=" anchor" name="ref28"></a>[28] <a href="https://bitcointalk.org/index.php?action=printpage;topic=17361.0" target="_blank">https://bitcointalk.org/index.php?action=printpage;topic=17361.0</a>.</p>
<p><a class=" anchor" name="ref29"></a>[29] <a href="https://en.bitcoin.it/wiki/Securing_your_wallet" target="_blank">https://en.bitcoin.it/wiki/Securing_your_wallet</a>.</p>
<p><a class=" anchor" name="ref30"></a>[30] <a href="https://www.securelist.com/en/blog/208188132/Gold_rush" target="_blank">http://www.securelist.com/en/blog/208188132/Gold_rush</a>.</p>
<p><a class=" anchor" name="ref31"></a>[31] <a href="http://ufasoft.com/open/bitcoin/" target="_blank">http://ufasoft.com/open/bitcoin/</a>.</p>
<p><a class=" anchor" name="ref32"></a>[32] Ferrer, M. Backdoor:MacOS_X/DevilRobber.A analysis. <a href="https://www.microsoft.com/security/portal/Threat/Encyclopedia/Entry.aspx?Name=Backdoor%3AMacOS_X%2FDevilRobber.A&amp;ThreatID=-2147316264" target="_blank">http://www.microsoft.com/security/portal/Threat/Encyclopedia/Entry.aspx?Name=Backdoor%3AMacOS_X%2FDevilRobber.A&amp;ThreatID=-2147316264</a>.</p>
<p><a class=" anchor" name="ref33"></a>[33] Coogan, P. Bitcoin Botnet Mining. <a href="https://www.symantec.com/connect/blogs/bitcoinbotnet-mining" target="_blank">http://www.symantec.com/connect/blogs/bitcoinbotnet-mining</a>.</p>
<p><a class=" anchor" name="ref34"></a>[34] Feng. C. Win32/Sirefef family analysis. MMPC Encyclopedia. <a href="https://www.microsoft.com/security/portal/Threat/Encyclopedia/Entry.aspx?Name=Win32%2fSirefef" target="_blank">http://www.microsoft.com/security/portal/Threat/Encyclopedia/Entry.aspx?Name=Win32%2fSirefef</a>.</p>
<p><a class=" anchor" name="ref35"></a>[35] Win32/Alureon family analysis. MMPC Encyclopedia. <a href="https://www.microsoft.com/security/portal/Threat/Encyclopedia/Entry.aspx?Name=Win32%2fAlureon" target="_blank">http://www.microsoft.com/security/portal/Threat/Encyclopedia/Entry.aspx?Name=Win32%2fAlureon</a>.</p>
<p><a class=" anchor" name="ref36"></a>[36] Diaz, E. Win32/Conedex family analysis. MMPC Encyclopedia. <a href="https://www.microsoft.com/security/portal/Threat/Encyclopedia/Entry.aspx?Name=Trojan%3aWin32%2fConedex" target="_blank">http://www.microsoft.com/security/portal/Threat/Encyclopedia/Entry.aspx?Name=Trojan%3aWin32%2fConedex</a>.</p>
<p><a class=" anchor" name="ref37"></a>[37] Golovanov, S. Kaspersky Labs. <a href="https://www.securelist.com/en/blog/559/TDSS_Bitcoin" target="_blank">http://www.securelist.com/en/blog/559/TDSS_Bitcoin</a>.</p>
<p><a class=" anchor" name="ref38"></a>[38] <a href="https://www.reuters.com/article/2011/06/08/us-fi%20nancialbitcoins-idUSTRE7573T320110608" target="_blank">http://www.reuters.com/article/2011/06/08/us-fi nancialbitcoins-idUSTRE7573T320110608</a>.</p>
<p><a class=" anchor" name="ref39"></a>[39] <a href="https://alloscomp.com/bitcoin/calculator.php" target="_blank">http://www.alloscomp.com/bitcoin/calculator.php</a>.</p>
<p> </p>
<p> </p> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<p><a href="/uploads/pdf/magazine/2018/Fouda-VB2012.pdf" target="_blank"><img src="/uploads/images/buttons/pdf-download-button.jpg" alt="Download PDF" width="262" height="45" /></a></p>
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=VB2012 paper: Malware taking a bit(coin) more than we bargained for&url=https://www.virusbulletin.com/virusbulletin/2018/02/vb2012-paper-malware-taking-bitcoin-more-we-bargained"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2018/02/vb2012-paper-malware-taking-bitcoin-more-we-bargained'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2018/02/vb2012-paper-malware-taking-bitcoin-more-we-bargained&title=VB2012 paper: Malware taking a bit(coin) more than we bargained for"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2018/02/vb2012-paper-malware-taking-bitcoin-more-we-bargained&t=VB2012 paper: Malware taking a bit(coin) more than we bargained for"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2018/02/vb2012-paper-malware-taking-bitcoin-more-we-bargained"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p> </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">©1989-2022 Virus Bulletin.        <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>        <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>        <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>