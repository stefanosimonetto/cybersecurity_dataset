<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: VB2017 paper: Beyond lexical and PDNS: using signals on graphs to uncover online threats at scale</title>
<meta name="description" content="We propose a novel method unifying the interactions between client machines, hostnames and hosting IPs by building a tripartite graph consisting of tens of millions of vertices and edges. We then represent a sequence of tripartite graphs as signals to be mined in order to detect botnet attacks and online threats in general. With these signals, we ignore the lexical and move beyond traditional degree and centrality graph metrics. By pairing client machines to hostnames we reveal that the trademark of a bot in a botnet is three things: 1) the variety of hostnames it queries, 2) the popularity of the hostnames, and 3) the frequency with which the bot repeats itself. We explore three types of subgraphs to illustrate this fact: 1) clients pivoting to domains, 2) domains pivoting to domains, 3) hosting IPs pivoting to domains. In these subgraphs we cluster the vertices based on similar multi-dimensional signals reminiscent of traditional cohort analysis involving analysis of variance techniques. Using Hadoop technologies, we show that a large sequence of graphs translated into signals is scalable (to the millions) and can distinguish Necurs, Conficker, Suppobox, PykSpa, and more. In closing, we predict the number of domains within a family of AGDs by introducing a measure involving the chattiness and repetition of client machines.
" />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 5664;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/blocks/expand_collapse_toc/templates/vbexpand/view.css" />
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/jquery.color.js"></script>
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<h1><a class="chapter" name="h1-vb2017-paper-beyond-lexical-and-pdns-using-signals-graphs-uncover-online-threats-scale"></a>VB2017 paper: Beyond lexical and PDNS: using signals on graphs to uncover online threats at scale</h1>
<h3><a class="chapter" name="h3-dhia-mahjoub-amp-david-rodriguez"></a>Dhia Mahjoub &amp; David Rodriguez</h3>
<p>Cisco Umbrella (OpenDNS), USA</p>
<p><em>Copyright © 2017 Virus Bulletin</em></p>
<hr />
<p> </p>
<div class="ccm-expand-collapse-toc">
<div id="ccm-expand-collapse-toc-title-11359" class="ccm-expand-collapse-toc-title ccm-expand-collapse-toc-closed" data-expander-speed="500">Table of contents</div><div id="ccm-expand-collapse-toc-content-11359" class="ccm-expand-collapse-toc-content"><p><a class="toc-level2" href="#h2-abstract">Abstract</a><br /> <a class="toc-level2" href="#h2-1-introduction">1. Introduction</a><br /> <a class="toc-level2" href="#h2-2-related-work">2. Related Work</a><br /> <a class="toc-level2" href="#h2-3-tripartite-graphs-bipartite">3. Tripartite graphs from bipartite</a><br /> <a class="toc-level2" href="#h2-4-graph-properties">4. Graph properties</a><br /> <a class="toc-level2" href="#h2-5-query-based-graph-properties">5. Query-based graph properties</a><br /> <a class="toc-level3" href="#h3-machines">Machines</a><br /> <a class="toc-level3" href="#h3-domains">Domains</a><br /> <a class="toc-level2" href="#h2-6-signals-graph-properties">6. Signals of graph properties</a><br /> <a class="toc-level2" href="#h2-7-hadoop-architecture">7. Hadoop Architecture</a><br /> <a class="toc-level2" href="#h2-8-client-pivoting-domains">8. Client pivoting to domains</a><br /> <a class="toc-level2" href="#h2-9-domain-pivoting-domain">9. Domain pivoting to domain</a><br /> <a class="toc-level2" href="#h2-10-hosting-ip-pivoting-domain">10. Hosting IP pivoting to domain</a><br /> <a class="toc-level2" href="#h2-11-domains-family">11. Domains per family</a><br /> <a class="toc-level2" href="#h2-conclusion">Conclusion</a><br /> <a class="toc-level2" href="#h2-references">References</a><br /> <a class="toc-level2" href="#h2-appendix">Appendix A</a><br /> <a class="toc-level2" href="#h2-appendix-b">Appendix B</a><br /> <a class="toc-level2" href="#h2-appendix-c">Appendix C</a></p><p>&nbsp;</p></div></div>
<h2><a class="chapter" name="h2-abstract"></a>Abstract</h2>
<p>We propose a novel method unifying the interactions between client machines, hostnames and hosting IPs by building a tripartite graph consisting of tens of millions of vertices and edges. We then represent a sequence of tripartite graphs as signals to be mined in order to detect botnet attacks and online threats in general. With these signals, we ignore the lexical and move beyond traditional degree and centrality graph metrics. By pairing client machines to hostnames we reveal that the trademark of a bot in a botnet is three things: 1) the variety of hostnames it queries, 2) the popularity of the hostnames, and 3) the frequency with which the bot repeats itself. We explore three types of subgraphs to illustrate this fact: 1) clients pivoting to domains, 2) domains pivoting to domains, 3) hosting IPs pivoting to domains. In these subgraphs we cluster the vertices based on similar multi-dimensional signals reminiscent of traditional cohort analysis involving analysis of variance techniques. Using Hadoop technologies, we show that a large sequence of graphs translated into signals is scalable (to the millions) and can distinguish Necurs, Conficker, Suppobox, PykSpa, and more. In closing, we predict the number of domains within a family of AGDs by introducing a measure involving the chattiness and repetition of client machines.</p>
<p> </p>
<h2><a class="chapter" name="h2-1-introduction"></a>1. Introduction</h2>
<p>A passive DNS graph (PDNS) consists of hostnames (sometimes called domains), registrants, hosting IPs, and ASNs. It has been proven that mining such a graph for subgraphs can isolate botnets [<a href="#ref1">1</a>]. However, there is currently no unified approach to incorporate time-dependent graphs that emerge when machines querying domains are modelled in the graph. In fact, the challenge of representing machines querying a domain at one time, but not another, similarly arises when a domain resolves to one hosting IP at one time, but not another. In short, the bot-like behaviour of clients is reminiscent of fast-flux behaviour in hosting IPs.</p>
<p>The classical problem of identifying botnet domains in a PDNS graph typically leverage either 1) lexical characteristics of domain names (n-gram entropy, perplexity) [<a href="#ref2">2</a>], or 2) traffic and static graph properties (measuring bursts in query volumes and similarity of inter-client traffic, respectively) [<a href="#ref3">3</a>, <a href="#ref4">4</a>]. These insights build on the characteristic of algorithmically generated domains (AGDs) but miss the temporal nature of machines surfing the Internet, i.e. graphs change from one time window to the next (e.g. vertices and edges (dis)appear).</p>
<p>In this paper we propose a novel method to overcome these challenges and unify the interactions between client machines, hostnames and hosting IPs by building a tripartite graph consisting of tens of millions of vertices and edges. We then represent a sequence of tripartite graphs as signals to be mined in order to detect botnet attacks and online threats in general.</p>
<p>To that end, we define a set of graph properties that can be derived from one or more graphs. Noticeably, these properties ignore the lexical properties of a domain and move beyond traditional degree and centrality graph metrics. Further, we explore how the tripartite graph lends itself naturally to three forms of induced subgraphs: a) clustering a set of vertices based on a cluster of signals (then gathering neighbour vertices), b) starting with hand-picked seed vertices (then gathering neighbouring vertices attainable in a path of length 2), and c) starting with hand-picked seed vertices (then gathering vertices attainable in a path of length 3. These methods are explored by performing client pivoting to domain, domain pivoting to domain, and hosting IP pivoting to domain, respectively. In these subgraphs we cluster the vertices based on similar multi-dimensional signals reminiscent of traditional cohort analysis involving analysis of variance techniques.</p>
<p>By pairing client machines to hostnames and expanding these interactions in signals, we reveal that the trademark of a bot in a botnet is three signals: 1) the variety of hostnames it queries, 2) the popularity of the hostnames, and 3) the frequency with which the bot repeats itself. In other words, botnet domains are similarly defined by the three signals: 1) how many client machines query the domain, 2) how many other domains the client machines query, and 3) the frequency with which the client machines repeat. From these signals, we show how to predict the number of domains within a family of AGDs by introducing a measure involving the chattiness and repetition of client machines to approximate the number of domains an ideal classifier should catch.</p>
<p>In summary, using Hadoop technologies, we show that a large sequence of graphs translated into signals is scalable (to the millions) and can distinguish Necurs, Conficker, Suppobox, Pushdo, and more.</p>
<p>In <a href="#h2-2-related-work">Section 2</a>, we review related work in botnet detection methods using lexical or traffic analysis. In <a href="#h2-3-tripartite-graphs-bipartite">Section 3</a> we introduce tripartite graphs. In <a href="#h2-4-graph-properties">Section 4</a> we discuss the vertex properties of one or more graphs, while <a href="#h2-5-query-based-graph-properties">Section 5</a> outlines querying machine vertex properties related to hostnames. In <a href="#h2-6-signals-graph-properties">Section 6</a> we build signals from graph properties and in <a href="#h2-7-hadoop-architecture">Section 7 </a>we break the problem down into subtasks which can be scaled using Hadoop technologies. Sections <a href="#h2-8-client-pivoting-domains">8</a>, <a href="#h2-9-domain-pivoting-domain">9</a> and <a href="#h2-10-hosting-ip-pivoting-domain">10</a> explore subgraph signals from client pivoting to domain, domain pivoting to domain, and hosting IP pivoting to domain, respectively. Finally, in <a href="#h2-11-domains-family">Section 11</a>, we introduce a measure to infer the number of domains within a family of a campaign.</p>
<p> </p>
<h2><a class="chapter" name="h2-2-related-work"></a>2. Related Work</h2>
<p>To our knowledge there is no prior work studying botnets found in signals derived from a sequence of bipartite graphs containing the client machine and hostname relationships. However, this work is influenced by the emerging field of graph signal processing [<a href="#ref5">5</a>].</p>
<p>Botnets are well studied where previous work frequently focused on parts of the tripartite graph discussed above and mainly dealt with the flux in lexical properties of domain names, or flux in hosting IPs.</p>
<ul>
<li><em>Flux lexical:</em> Antonakakis <em>et al.</em> clustered NX domains based on their lexical content [<a href="#ref6">6</a>]. Similarly, Schiavoni <em>et al.</em> successfully attributed AGD domains to botnets based on lexical content [<a href="#ref7">7</a>]. Plohmann, <em>et al.</em> further refined DGA taxonomies based on lexical features and NX DNS queries [<a href="#ref8">8</a>]. Plohman, in particular, has extensively documented malware families based on lexical similarity [<a href="#ref9">9</a>]. Yadav<em> et al.</em> have studied the domain fluxes apparent in character switching in domain names [<a href="#ref10">10</a>]. Yaddav and Reddy further refined domain fluxing with studies in entropy of domain name and NX queries [<a href="#ref11">11</a>].</li>
<li><em>Flux IP:</em> Passerini <em>et al.</em> monitored fast-flux service networks swapping lexical content of hostnames, resolving hosting IPs, and related ASNs [<a href="#ref12">12</a>].</li>
</ul>
<p> </p>
<h2><a class="chapter" name="h2-3-tripartite-graphs-bipartite"></a>3. Tripartite graphs from bipartite</h2>
<p>A k-partite graph is a graph whose vertices can be partitioned into k different independent sets where, intuitively, the edges link the sets. Naturally, the interactions of client machines querying hostnames form a 2-partite graph, also called a bipartite graph, with the two independent sets being machines and hostnames, respectively. Similarly, the hostnames (or domains) on a hosting IP form another 2-partite graph, with the two independent sets being hostnames and hosting IPs, respectively. <a href="#figure1">Figure 1</a> combines these three independent sets to form a 3-partite graph. In this paper we explore various time-dependent bipartite graphs by taking hourly bipartite snapshots of client machines, hostname, and hosting IP interactions. These interactions are captured in different graph properties.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/a0dfaa1aafee3fc26e6e554335025c98_f2142.png" alt="fig_1.png" width="550" height="419" /><span class="centered-caption"><a class=" anchor" name="figure1"></a>Figure 1: Example tripartite graph with independent sets: client machines, hostnames and hosting IPs.</span></p>
<p> </p>
<h2><a class="chapter" name="h2-4-graph-properties"></a>4. Graph properties</h2>
<p>Given a graph <em>G = (V, E)</em>, let υ<em> ∈ V</em>, we are interested in the neighbours, i.e. the number of vertices reachable by a path of length one from υ:</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/6115/0971/9176/CodeCogsEqn_1.gif" alt="CodeCogsEqn (1).gif" width="280" height="19" />We can then compute the degree of υ as | <em>N(</em>υ<em>) </em>|.</p>
<p>Further, we can compute the neighbour degrees of υ:</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/1215/0971/9216/CodeCogsEqn_2.gif" alt="CodeCogsEqn (2).gif" width="336" height="19" />Given that the elements of <em>ND</em>(υ) are counts and therefore natural numbers, we can compute summary statistics such as the mean, median, and other percentiles of <em>ND</em>(υ).</p>
<p>Further, given two graphs <em>G</em> and <em>H</em> with the same vertex υ<em><sub>G</sub></em> and υ<em><sub>H</sub></em> representing vertex υ embedded in <em>G</em> and <em>H</em>, respectively, we can compute the similarity of the neighbours of υ as:</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/4915/0971/9398/CodeCogsEqn_3.gif" alt="CodeCogsEqn (3).gif" width="210" height="44" />which is the Jaccard similarity of two sets.</p>
<p> </p>
<h2><a class="chapter" name="h2-5-query-based-graph-properties"></a>5. Query-based graph properties</h2>
<p>Let <em>G</em> be a graph of networked machines and entities on the Internet. Typically, we call this an Internet graph if the vertices are made of domains, client machine IPs, hosting IPs, ASNs and registrants. We outline metrics for the machines querying domains, and the domains queried by machines.</p>
<h3><a class="chapter" name="h3-machines"></a>Machines</h3>
<p>We start with υ<em> ∈ V</em>, a machine making queries to other domains. We will derive properties that characterize υ.</p>
<p>For the machine, υ, chattiness is defined as | <em>N</em>(υ) |. This measure defines the breadth of unique domains machine υ reaches out to directly. Further, let the degree of a domain vertex be called the popularity of a domain, i.e. the popularity depicts the breadth of unique machines querying a domain. Then we define the average popularity of domains that machine υ reaches out to as:</p>
<p style="text-align: center;">μ(<em>ND</em>(υ))</p>
<p>with μ representing the function to compute the mean. Letting <em>m</em> represent the function computing the median, we also compute the median popularity of the neighbours of υ as <em>m</em>(<em>ND</em>(υ)).</p>
<p>We can measure the spread in the popularity of the domains the machine reaches out to with the spread:</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/6715/0971/9911/CodeCogsEqn_4.gif" alt="CodeCogsEqn (4).gif" width="85" height="43" />If the ratio tends to 1, then υ reaches out to similar domains, i.e. the domains have similar popularity. If the ratio tends to be small, then υ reaches out to more dissimilar domains, i.e. the domains have wider variance in popularity.</p>
<p>The machine, υ, may also query different domains at different times. Given two graphs, <em>G<sub>i</sub></em> and <em>G<sub>i-1</sub></em>, where <em>G<sub>i</sub> </em>captures the interactions of machines on the Internet within one time window, <em>i</em>, and <em>G<sub>i-1</sub></em> captures the interactions in a previous time window, <em>i-1</em>, we can measure the replication factor of machine υ as <em>J</em>(υ). The replication factor measures how much a machine queries the same domains from one time window to another.</p>
<p>In summary, we have the following properties of a machine υ when given two graphs, <em>G</em><sub>i</sub> and <em>G</em><sub>i-1</sub>:</p>
<ul>
<li>Chattiness</li>
<li>Average popularity of domains</li>
<li>Median popularity of domains</li>
<li>Spread of domain popularity</li>
<li>Replication of domains</li>
</ul>
<h3><a class="chapter" name="h3-domains"></a>Domains</h3>
<p>Just as we characterized machines querying domains, we may also characterize the domains queried by machines.</p>
<p>Given a domain, υ, from graphs <em>G<sub>i</sub></em> and <em>G<sub>i-1</sub></em>, we compute the:</p>
<ul>
<li>Popularity</li>
<li>Average chattiness of querying machines</li>
<li>Median chattiness of querying machines</li>
<li>Spread of client chattiness</li>
<li>Replication of clients</li>
</ul>
<p>where the replication factor measures the proportion of querying machines repeating from one time window to another.</p>
<p> </p>
<h2><a class="chapter" name="h2-6-signals-graph-properties"></a>6. Signals of graph properties</h2>
<p>Given a graph <em>G<sub>i</sub></em> holding a snapshot of time, with machines querying hostnames and hosting IPs hosting hostnames, we now translate the graph properties into various signals plotted against time.</p>
<p class="centered-caption"><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/a7578c8653b52710418229c1b77c0b86_f2147.png" alt="fig_2.png" width="460" height="520" /><a class=" anchor" name="figure2"></a>Figure 2: Given a graph <em>G<sub>i</sub></em>, each vertex υ has properties that when stored for subsequent <em>G<sub>i+1</sub></em> form a time-series.</p>
<p><a href="#figure2">Figure 2</a> shows a graph translated into various signals. In particular, each vertex has properties that can be computed. These properties, once stored and plotted as a sequence, form a signal.</p>
<p><a href="#figure3">Figure 3</a> shows a sequence of graphs translated into one graph with signals maintaining the order of the vertex properties at each time step. The signals represent various topological characteristics in two respects: horizontally and vertically in time. For example, vertically refers to one time step where the signals hold all the vertex properties of one corresponding graph, and horizontally refers to a time window (viewing the signals proper) with the signals representing the change in vertex properties from the sequence of graphs.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/74cfd1f00d67823b5443f2d1b4b47917_f2148.png" alt="fig_3.png" width="460" height="307" /><span class="centered-caption"><a class=" anchor" name="figure3"></a>Figure 3: Given graphs G<sub>i</sub>, G<sub>i+1</sub>, G<sub>i+2</sub> we can represent the union of graphs in one graph with signals maintaining the order for each vertex property.</span></p>
<p>From a sequence of graphs we can now mine the graph for subgraphs. The first subgraph we mine through identifies a cluster of suspicious clients (in terms of their behaviour) where the domains visited by these clients are uniformly suspicious (also in terms of behavioural characteristics). Next, we start from a known list of malicious domains and pivot through the clients to find related domains with similar behavioural characteristics.</p>
<p> </p>
<h2><a class="chapter" name="h2-7-hadoop-architecture"></a>7. Hadoop Architecture</h2>
<p>The Hadoop technology stack described here utilizes HDFS, Pig, and Hbase. One may wish to exchange Pig for Scalding or Spark, as desired.</p>
<p><a href="#figure4">Figure 4</a> is a diagram of the extract transform layer (ETL) of ingesting logs, transforming, and making them available within the distributed key value store HBase. With this process we manage large-scale graph analytics (millions of vertices, millions of edges) by breaking the process into two steps: 1) merging of various logs for preparation and construction of various graphs, and 2) the traversal and message-passing computations over graph nodes and edges. Each phase feeds into other subroutines in other analytic-pipelines, so we monitor these processes in case the system builds back-pressure.</p>
<p><img src="/files/cache/9d4bd241889f0b62f63389434b346a84_f2149.png" alt="fig_4.png" width="845" height="329" /><span class="centered-caption"><a class=" anchor" name="figure4"></a>Figure 4: Diagram of architecture: 1) HDFS: log storage, 2) Pig: graph construction, 3) Pig: computation of graph properties, 4) HBase persist.</span></p>
<p><a href="#figure5">Figure 5</a> highlights our utilization of HBase for multiple purposes. For example, assuming we have successfully transformed our graph into a set of meaningful signals, we then require the flexibility to scan for individual and groups of signals. The reason for this is that we may want to index various signals for quick searching and clustering, while on the other hand, we may want to analyse and detect patterns within a single signal.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/370215c0e6f9db1facaa5c859d6741ae_f2150.png" alt="fig_5.png" width="580" height="326" /></p>
<p class="centered-caption"><a class=" anchor" name="figure5"></a>Figure 5: Diagram of typical design pattern interacting and utilizing signals stored in HBase. Left-leaf: bulk aggregate and correlations of signal (indexing, clustering); right-leaf: individual signal uses (R&amp;D, UI).</p>
<p> </p>
<h2><a class="chapter" name="h2-8-client-pivoting-domains"></a>8. Client pivoting to domains</h2>
<p>While the algorithmically generated domains (AGDs) of Necurs, Pykspa and Conficker are well studied, there is no comparable study in behavioural attributes. Using the signals from the bipartite graphs we are now in a position to characterize the traffic to these AGDs and from the client machines querying AGDs. In other words, for example, we can uncover how popular an AGD is and how chatty a client machine might be. In short, bot-like machines uncover botnet domains.</p>
<p>An infected client machine querying AGDs may query different domains from one time period to the next. <a href="#figure6">Figure 6 </a>is an example of one machine querying seven different domains in four different time intervals. In this figure, we notice the machine queries at least three domains per time period and queries the same domain in consecutive hours at least once (though not the same domain every hour). In other words, this is an example of a client with a chattiness signal of [3,4,3,4] and a replication signal of [<sup>1</sup>/<sub>2</sub>,<sup>2</sup>/<sub>3</sub>,<sup>1</sup>/<sub>2</sub>,<sup>2</sup>/<sub>3</sub>].</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/c01c5e82ed0186d70655381841666a27_f2152.png" alt="fig_6.png" width="440" height="487" /></p>
<p class="centered-caption"><a class=" anchor" name="figure6"></a>Figure 6: One machine querying seven domains at four different time intervals.</p>
<p>We wish to identify suspicious or infected clients, ensuring that the resulting domains they visit are possibly related to a botnet. To that end, we take a snapshot of the graph properties related to clients from one time period in a scatterplot of chattiness, replication, median popularity and average popularity. The goal is to identify clusters within the 2-D projections identifying clients with predictable behaviour.</p>
<p><a href="#figure7">Figure 7</a> is the resulting scatterplot on a sample of 10,000 clients from 1.4 million clients corresponding to a one-hour snapshot. Note that the scatterplot captures a few intuitive hypotheses about the behaviour of an infected machine. For example, if the chattiness of a machine increases by one, is there a linear relationship with replication? In other words, is a machine that queries one more domain than another likely to have a higher replication factor? Or another: does the median popularity of domains queried by a machine correlate with the average popularity? That is, if a machine queries domains resulting in a low median popularity (i.e. the machine queries low popularity domains about 50% of the time) are they just as likely to query highly popular domains, resulting in higher average popularity?</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/6615/0972/1422/fig_7.png" alt="fig_7.png" width="702" height="499" /><span class="centered-caption"><a class=" anchor" name="figure7"></a>Figure 7: Scatterplot of client statistics from a sample of 10,000 out of 3 million clients.</span></p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/1315/0972/1735/fig_8.png" alt="fig_8.png" width="800" height="600" /><span class="centered-caption"><a class=" anchor" name="figure8"></a>Figure 8: 168 hours with five-hour window boxplots of 183 clients flagged in the most recent window (far right) for having popularity greater than 100, replication greater than .50, and median and average popularity spread less than 1.1.</span></p>
<p>Following questions like those posed above, we hypothesized that clients resulting in a high replication (above .50) and a spread in median-to-average popularity of domains (within 10%) ensured clients visiting botnet domains. In other words, these clients were showing bot-like behaviour by visiting domains with basically the same popularity from hour to hour (and even the same domains at least 50% of the time). <a href="#figure8">Figure 8</a> is a sample of 183 clients flagged with having a replication factor greater than 0.30 and spread within 10%. From our experiments we have found 100+ clients (per hour). These clients appear largely consumed with querying Conficker, Pyskspa, Suppobox, and some unknown botnets.</p>
<p>In <a href="#figure9">Figure 9</a>, we visualize four families of domains flagged from bot-like clients over three days rolled into two-hour intervals (the right side the most recent, the left the earliest day). Refer to<a href="#h2-appendix"> Appendix A</a> for a sample of the domains.</p>
<p><a class="zoom-img" title="Figure 9: Four families of botnet domains found from bot-like clients. Top left: domains attributed to the Conficker botnet. Top right: domains attributed to the Suppobox botnet. Bottom left: domains attributed to an unknown botnet. Bottom right: domains attributed to the Necurs botnet." href="/files/1015/0972/1875/figure9-whole2.jpg"><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/6e6c9b5ee94e0eaa33219e5a1500dde0_f2154.jpg" alt="figure9-whole2.jpg" width="840" height="631" /></a><span class="centered-caption"><a name="figure9"></a>Figure 9: Four families of botnet domains found from bot-like clients. Top left: domains attributed to the Conficker botnet. Top right: domains attributed to the Suppobox botnet. Bottom left: domains attributed to an unknown botnet. Bottom right: domains attributed to the Necurs botnet.</span></p>
<p>The signals are the popularity and replication of the domains and median chattiness of the clients querying the domains. Note that each family is easily differentiated from the others: Conficker, Necurs, Suppobox, and one unknown botnet. The boxplots aggregate the individual signals per domain identified within a family. Conficker is made of 205 domains; Necurs 41 domains; Suppobox 81 domains; unknown botnet 139 domains.</p>
<p><em>Interpretation of<a href="#figure9"> Figure 9</a>:</em> Conficker is characterized by a uniform spike over a 12+ hour spike in popularity reaching 1,600 machines. In addition, we see the replication interquartile range tighten during the spike around 0.10.</p>
<p>Suppobox, on the other hand, appears to have spiking periodic activity with popularity ranging between 100 and 800 machines. Furthermore, as the popularity reaches the first peak in periodicity the replication tightens around 0.20 to 0.40 and in fact appears steady and not periodic (at least not as extreme as popularity). The unknown botnet appears to have the widest variance in popularity leading into the period of sustained activity from multiple bot-like machines ranging from 50 - 100 machines. At the climax of popularity, the replication trends between 0.40 and 0.60 (reaching the highest replication ranges of the four families). Lastly, Necurs is characterized by a three-day sustained popularity below 500, except for an exaggerated spike of up to 2,000 machines querying the domains, and the replication tightens after the spike of 1,000+ machines around 0.10 along with the median chattiness.</p>
<p> </p>
<h2><a class="chapter" name="h2-9-domain-pivoting-domain"></a>9. Domain pivoting to domain</h2>
<p>In the previous section we used the signals from the sequence of bipartite graphs to flag bot-like clients and identify families of domains with similar popularity, replication, and median chattiness. This approach relied on identifying suspicious clients to find botnet domains. Another approach is to start from known botnet domains and find other related domains. Related to this are techniques in belief propagation. Using the signals derived from the sequence of bipartite graphs we can identify similar domains based on machine querying behaviour.</p>
<p><a href="#figure10">Figure 10</a> shows one machine querying two domains within a time interval. One domain is known to be malicious, and we would like a technique to identify whether the other domain is also malicious. Note that we are simply asking if two vertices that co-occur (or are queried) from the same client are similar, in other words: are the signals related to each domain similar to one another? As seen in the previous section, we suspect that the signals: popularity, replication, and median chattiness, can be used to find related domains. To formalize things, the goal is to identify clusters within the 2-D projections identifying domains.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/8dae65b169d64dae90f0ab5bdc488c0a_f2155.png" alt="fig_10.png" width="380" height="533" /><span class="centered-caption"><a class=" anchor" name="figure10"></a>Figure 10: From a seed of malicious domains, pivot from querying machines to other domains queried.</span></p>
<p><a href="#figure11">Figure 11</a> is the resulting scatterplot on a sample of 10,000 domains from 6.4 million domains corresponding to a one-hour snapshot. Note that the scatterplot captures a few intuitive hypotheses about the behaviour of domains that might be similar to one another. Perhaps the easiest is to try to identify domains being queried by bot-like machines. That is, one might look for domains with (about) equal median and average chattiness of the clients. To that end, we try to identify clusters along the diagonal of the median and average chattiness scatterplot. Now, just test whether the domain has high or low replication of clients. Further, one might test the hypothesis: replication is correlated to popularity. Or more simply, suppose a domain has a replication factor of 0.20 and a popularity of 1,000. Is a domain with a replication 0.20 and a popularity of 5,000 more common?</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/9115/0972/2106/fig_11.png" alt="fig_11.png" width="702" height="499" /><span class="centered-caption"><a class=" anchor" name="figure11"></a>Figure 11: Scatterplot of domain statistics from a sample of 10,000.</span></p>
<p>Following questions like those posed above, we hypothesized that similar domains clustered based on the signals: popularity, replication, and median chattiness yield homogeneous clusters. These clusters we hoped would contain one family of botnet domains (and no false positives). We conducted this experiment using the popular Bambenek DGA feed containing 403,644 domains. In testing we found an average of 19,000 domains queried by machines, hourly.</p>
<p>In <a href="#figure12">Figure 12</a>, we visualize three families of Bambenek domains and the fourth is a family of domains found by pivoting off Bambenek domains (without a single domain flagged by Bambenek). Refer to <a href="#h2-appendix-b">Appendix B</a> for examples of the domains. The time interval is from a span of 168 hours rolled up into six-hour windows (the right side the most recent, the left the earliest day). The signals are the popularity and replication of the domains, and median chattiness of the clients querying the domains. Note that each botnet is not necessarily differentiated from the others in terms of lexical content (but the traffic patterns are): Necurs 1, Necurs 2, Pushdo, and one unknown botnet. The boxplots aggregate the individual signals per domain identified within a family. Necurs 1 is made of 82 domains; Necurs 2 107 domains; Pushdo 29 domains; unknown botnet 211 domains.</p>
<p><a class="zoom-img" title="Figure 12: Four examples of domains related to botnets. Top left: domains attributed to the Necurs botnet. Top right: domains attributed to the Necurs botnet (with a different traffic pattern). Bottom left: domains attributed to the Pushdo botnet. Bottom right: domains attributed to an unknown botnet." href="/files/4215/0972/2245/Figure-12-whole.jpg"><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/63eb4bcaf04ecf5000d7d39ac845b5d5_f2157.jpg" alt="Figure-12-whole.jpg" width="840" height="632" /></a><span class="centered-caption"><a class=" anchor" name="figure12"></a>Figure 12: Four examples of domains related to botnets. Top left: domains attributed to the Necurs botnet. Top right: domains attributed to the Necurs botnet (with a different traffic pattern). Bottom left: domains attributed to the Pushdo botnet. Bottom right: domains attributed to an unknown botnet.</span></p>
<p><em>Interpretation of<a href="#figure12"> Figure 12</a>:</em> Necurs 1 is characterized by one spike over a six-hour window with popularity reaching 700 machines. In addition, we see the replication interquartile range tighten after the spike around 0.10. Necurs 2, on the other hand, appears to have spiking periodic activity with popularity ranging between 100 and 700 machines. In addition, as the popularity reaches the first peak in periodicity, the replication tightens around 0.12 and in fact appears as steady as the median chattiness between 500 and 1000 domains. The Pushdo botnet appears to have the longest period of activity, spanning almost the entire 168 hours. In addition, the popularity ranges from 10 to 80 machines along with the replication between 0.10 and 0.40. Lastly, the unknown botnet domains are characterized by a spike in popularity trending between 100 - 140 along with an almost uniform replication around 0.60 and median chattiness of 200.</p>
<p> </p>
<h2><a class="chapter" name="h2-10-hosting-ip-pivoting-domain"></a>10. Hosting IP pivoting to domain</h2>
<p>In the previous section we used the signals from the sequence of bipartite graphs to cluster domains with similar signals from a set of known malicious domains. We provided initial clusters based on the co-occurring domains from client machines querying the malicious domains and refined those based on the families of signals. We now extend this idea by starting from a set of malicious hosting IPs.</p>
<p><a href="#figure13">Figure 13</a> is an example of a known malicious hosting IP with one domain resolving to it. With the assumption of any domain resolving to this malicious hosting IP, we can apply the methods described in the previous section. That is, traverse the graph and gather the co-occurring domains reachable through the clients querying the domain hosted on the malicious IP. Further, this hosting IP may have multiple domains resolving to it, and in a similar fashion, we gather the co-occurring domains (from clients) to those domains.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/b01a2aeea963ac5e6fac56570e7ae023_f2158.png" alt="fig_13.png" width="720" height="601" /><span class="centered-caption"><a class=" anchor" name="figure13"></a>Figure 13: One machine querying seven domains at four different time intervals.</span></p>
<p>In<a href="#figrue14"> Figure 14</a>, we visualize three Zbot domains resolving to the same hosting IP. We call Zbot domains any malware domains that are using the Zbot fast flux proxy infrastructure as described in [<a href="#ref13">13</a>, <a href="#ref14">14</a>, <a href="#ref15">15</a>], therefore these domains could belong to either one or many different malware families but in our study they share similar traffic patterns. Refer to <a href="#h2-appendix-c">Appendix C</a> for examples of the domains (including previous domains studied but not reported here). The time interval, as before, is from a span of 168 hours rolled up into six-hour windows (the right side the most recent, the left the earliest day). The signals are the popularity and replication of the domains, and median chattiness of the clients querying the domains. The boxplots aggregate the individual signals within the six-hour windows.</p>
<p><a class="zoom-img" title="Figure 14: (Left) Three Zbot domains resolving to some of the same fast-flux IPs. (Right) Three Zbot domains resolving to similar fast-flux IPs, but caught early in the campaign. These domains exhibit similar popularity, replication, and median chattiness." href="/files/1315/0972/2831/Figure-14-whole.jpg"><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/3eef0db7cfcb9ee859801cb47d5ac14a_f2159.jpg" alt="Figure-14-whole.jpg" width="840" height="312" /></a><span class="centered-caption"><a class=" anchor" name="figrue14"></a>Figure 14: (Left) Three Zbot domains resolving to some of the same fast-flux IPs. (Right) Three Zbot domains resolving to similar fast-flux IPs, but caught early in the campaign. These domains exhibit similar popularity, replication, and median chattiness.</span></p>
<p><em>Interpretation of<a href="#figrue14"> Figure 14</a>:</em> These three Zbot domains open the campaign around the same time: the ninth timestep on the x-axis. The three Zbot domains synchronize over the next 10 timesteps before beginning to diverge. In particular, these campaigns opened with around 20 client machines querying each domain with a replication factor between 0.20 and 0.30. In other words, up to six client machines queried the same domain from one hour to the next.</p>
<p>Furthermore, these client machines were simultaneously querying roughly 10 other domains for the opening portion of the campaign.</p>
<p> </p>
<h2><a class="chapter" name="h2-11-domains-family"></a>11. Domains per family</h2>
<p>In Sections <a href="#h2-8-client-pivoting-domains">8</a>, <a href="#h2-9-domain-pivoting-domain">9 </a>and <a href="#h2-10-hosting-ip-pivoting-domain">10</a>, we examined cohorts of domains which cluster together with waveforms produced in the popularity, replication, and median chattiness of the domains. There are a variety of comparisons that can be made between the signals but one stands out: the tight bound in median chattiness appearing in every family of botnet domain (at some point in the campaign) from Necurs to Zbot. <a href="#table1">Table 1</a> is a breakdown of the values of each signal during one time window per botnet.</p>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td><strong>Botnet family</strong></td>
<td><strong>Median chattiness</strong></td>
<td><strong>Replication</strong></td>
<td><strong>Popularity</strong></td>
<td><strong>Popularity / Replication</strong></td>
</tr>
<tr>
<td>Zbot</td>
<td>10</td>
<td>.20</td>
<td>40</td>
<td>40/.2 = 200</td>
</tr>
<tr>
<td>Necurs</td>
<td>1</td>
<td>.10</td>
<td>200</td>
<td>200/.1 = 2000</td>
</tr>
<tr>
<td>Pushdo</td>
<td>1000</td>
<td>.20</td>
<td>60</td>
<td>60/.2 = 300</td>
</tr>
<tr>
<td>Suppobox</td>
<td>500</td>
<td>.3</td>
<td>300</td>
<td>300/.3 = 1000</td>
</tr>
</tbody>
</table>
<p class="centered-caption"><a class=" anchor" name="table1"></a>Table 1: Approximate values within time windows from Zbot, Necurs 1, Pushdo, and Suppobox from Figures 9, 12, 14, alongside the ratio of popularity / replication.</p>
<p>In <a href="#table1">Table 1</a>, we begin by breaking down the median chattiness across four botnet families. These values were pulled from a portion of the campaign where the median chattiness boxplots appeared most uniform. In other words, 50% or more of the clients querying these botnet domains were querying about this many other domains. For example, a given Zbot domain may have had 40 client machines query it, while those machines were querying (roughly) 10 other domains. Now, suppose we make a big assumption: that all 10 domains are also Zbot domains. That's one guess for how many domains are within this campaign.</p>
<p>More generally, one might say that when a domain's median chattiness gets tight, then the numbers where the band hovers is the number of domains that might be in a botnet (for a specific campaign). Consider, on the other hand, 40 clients querying 10 other domains in one time window, then in the next window they query 10 but only repeat 20%. Further, in the next time window assume the clients (in the median) query 10 other domains. Then one would suspect 10(1.8) = 18 domains in the botnet. Therefore we suspect that the value:</p>
<p style="text-align: center;"><em>Median-chattiness * (1 + 1 - replication-of-clients)<sup>1</sup></em></p>
<p>provides an approximate number of domains within a campaign of the botnets studied herein.</p>
<p><em>(<sup>1</sup>Actually this might really be: mc ( (1-r) + (1-r) r + (1- r) r^2 +......). With r = replication of clients and mc = median chattiness.)</em></p>
<p> </p>
<h2><a class="chapter" name="h2-conclusion"></a>Conclusion</h2>
<p>In this paper we introduced the notion of a tripartite graph modelling the relationships of client machines querying hostnames along with those hostnames hosted on an IP. We described various vertex properties and formed signals from a sequence of tripartite graphs. We then induced three types of subgraphs: client-to-domains, domains-to-domains, and hosting IPs-to-domains. From each induced subgraph we studied cohorts of domains clustering together with similar signals: popularity, replication, and median chattiness of the clients. Finally, we outlined a method to predict the number of domains per campaign underway in a botnet by using the median chattiness and the replication of clients which can be found during the tightest period of median chattiness during the campaign.</p>
<p> </p>
<h2><a class="chapter" name="h2-references"></a>References</h2>
<p><a class=" anchor" name="ref1"></a>[1] Khalil, I.; Yu, T.; Guan, B. 2016. Discovering Malicious Domains through Passive DNS Data Graph Analysis. In Proceedings of the 11th ACM on Asia Conference on Computer and Communications Security (ASIA CCS '16). ACM, New York, NY, USA, 663-674. <a href="https://doi.org/10.1145/2897845.2897877" target="_blank">https://doi.org/10.1145/2897845.2897877</a>.</p>
<p><a class=" anchor" name="ref2"></a>[2] DGArchive: A deep dive into domain generating malware. Botconf 2015. <a href="https://www.botconf.eu/wp-content/uploads/2015/12/OK-P06-Plohmann-DGArchive.pdf" target="_blank">https://www.botconf.eu/wp-content/uploads/2015/12/OK-P06-Plohmann-DGArchive.pdf</a>.</p>
<p><a class=" anchor" name="ref3"></a>[3] Hong, L. DNS Traffic Analysis for Network-based Malware Detection. Technical University of Denmark Informatics and Mathematical Modelling.</p>
<p><a class=" anchor" name="ref4"></a>[4] Krmıcekm V. Inspecting DNS Flow Traffic for Purposes of Botnet Detection. GEANT3 JRA2 T4 Internal Deliverable. 2011.</p>
<p><a class=" anchor" name="ref5"></a>[5] Shuman, D. I.; Narang, S. K.; Frossard, P.; Ortega, A.; Vandergheynst, P. The emerging field of signal processing on graphs: Extending high-dimensional data analysis to networks and other irregular domains. In IEEE Signal Processing Magazine, vol. 30, no. 3, pp. 83-98, May 2013.</p>
<p><a class=" anchor" name="ref6"></a>[6] From Throw-Away Traffic to Bots: Detecting the Rise of DGA-Based Malware. Usenix 2012. <a href="https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final127.pdf" target="_blank">https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final127.pdf</a>.</p>
<p><a class=" anchor" name="ref7"></a>[7] Phoenix: DGA-Based Botnet Tracking and Intelligence. DIMVA 2014. <a href="http://www.syssec-project.eu/m/page-media/3/schiavoni-dimva14-phoenix.pdf" target="_blank">http://www.syssec-project.eu/m/page-media/3/schiavoni-dimva14-phoenix.pdf</a>.</p>
<p><a class=" anchor" name="ref8"></a>[8] A Comprehensive Measurement Study of Domain Generating Malware. Usenix 2016. <a href="https://www.usenix.org/system/files/conference/usenixsecurity16/sec16_paper_plohmann.pdf" target="_blank">https://www.usenix.org/system/files/conference/usenixsecurity16/sec16_paper_plohmann.pdf</a>.</p>
<p><a class=" anchor" name="ref9"></a>[9] Malpedia. ACSC 2017. <a href="http://pnx.tf/slides/2017-03-16-ACSC-Malpedia.pdf" target="_blank">http://pnx.tf/slides/2017-03-16-ACSC-Malpedia.pdf</a>.</p>
<p><a class=" anchor" name="ref10"></a>[10] Yadav, S.; Reddy, A. K. K.; Reddy, A. N.; Ranjan, S. Detecting algorithmically generated malicious domain names. In Proceedings of the 10th annual Conference on Internet Measurement, IMC '10, pages 48–61, New York, NY, USA, 2010. ACM. <a href="https://pdfs.semanticscholar.org/0781/d1e2c2027794393eb33cc08d60fff2940c32.pdf" target="_blank">https://pdfs.semanticscholar.org/0781/d1e2c2027794393eb33cc08d60fff2940c32.pdf</a>.</p>
<p><a class=" anchor" name="ref11"></a>[11] Yadav, S.; Reddy, A.L.N. Winning with DNS failures: Strategies for faster botnet detection. In: Rajarajan, M.; Piper, F.,;Wang, H.; Kesidis, G. (eds.) SecureComm 2011. LNICST, vol. 96, pp. 446–459. Springer, Heidelberg (2012). <a href="http://cesg.tamu.edu/wp-content/uploads/2012/04/reddy_papers/securecomm11.pdf" target="_blank">http://cesg.tamu.edu/wp-content/uploads/2012/04/reddy_papers/securecomm11.pdf</a>.</p>
<p><a class=" anchor" name="ref12"></a>[12] Passerini, E.; Paleari, R.; Martignoni, L.;Bruschi, D. fluXOR: Detecting and monitoring fast-flux service networks. In: Zamboni, D. (ed.) DIMVA 2008. LNCS, vol. 5137, pp. 186–206. Springer, Heidelberg (2008). <a href="http://roberto.greyhats.it/pubs/dimva08-fluxor.pdf" target="_blank">http://roberto.greyhats.it/pubs/dimva08-fluxor.pdf</a>.</p>
<p><a class=" anchor" name="ref13"></a>[13] Mahjoub, D.; Sakaly, M.; Mathew, T. Towards a Holistic Approach in Building Intelligence to Fight Crimeware. Black Hat 2016. <a href="https://www.youtube.com/watch?v=hBzGM3d7c1Y&amp;t=3s" target="_blank">https://www.youtube.com/watch?v=hBzGM3d7c1Y&amp;t=3s</a>.</p>
<p><a class=" anchor" name="ref14"></a>[14] Mahjoub, D. A New Look at Fast Flux Proxy Networks. BotConf 2014, <a href="https://www.youtube.com/watch?v=eC2jPNU0NZI" target="_blank">https://www.youtube.com/watch?v=eC2jPNU0NZI</a>.</p>
<p><a class=" anchor" name="ref15"></a>[15] Mahjoub, D.; Reuille, T.; Toonk, A. Catching Malware En Masse: DNS and IP Style. BlackHat 2014. <a href="https://www.youtube.com/watch?v=cHuyqnVhT4g&amp;t=4s" target="_blank">https://www.youtube.com/watch?v=cHuyqnVhT4g&amp;t=4s</a>.</p>
<p> </p>
<h2><a class="chapter" name="h2-appendix"></a>Appendix A</h2>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td><strong>Conficker</strong></td>
<td><strong>Suppobox</strong></td>
</tr>
<tr>
<td>asguyisxag.cn<br />dhkbnigbmk.cn<br />ikibb.cn<br />qofzsoukgv.cn<br />bwrxituu.cn<br />ldjeg.cn<br />lmdyzeaec.cn<br />vowncqnmrg.cn<br />awqmmbmales.cn<br />civcsuxik.cn<br />tfyiar.cn<br />pbwrgxap.cn<br />lsqccdepmsj.cn<br />kbxqlrfsejf.cn<br />ouatgvfu.cn<br />rmxyfdfqiet.cn<br />hyxvo.cn<br />mifdrrhjj.cn<br />xzkfu.cn<br />mrfalvan.cn<br />lrydsjjvenl.cn<br />tjumdjii.cn<br />vnsmvolq.cn<br />afhsyl.cn<br />itnloxsbxts.cn</td>
<td>nonelose.ru<br />silvestercharisse.ru<br />outsidetwenty.ru<br />desirealmost.ru<br />grosvenorcassarah.ru<br />callfull.ru<br />grenvilleunderhill.ru<br />celandineharrison.ru<br />eveningalmost.ru<br />pointdaily.ru<br />leadlose.ru<br />annabellaannabeth.ru<br />silvestercassarah.ru<br />doublemeeting.ru<br />fellowreason.ru<br />nosehave.ru<br />geraldineviviette.ru<br />eveningunderstood.ru<br />fiftythere.ru<br />liarocean.ru<br />thomasinaannabeth.ru<br />grenvilleannabeth.ru<br />deforrestfairbairn.ru<br />jeffersonangelica.ru<br />tableblood.ru</td>
</tr>
<tr>
<td><strong>Unknown</strong></td>
<td><strong>Necurs</strong></td>
</tr>
<tr>
<td>vpcvcixgcdlkoj9k.com<br />pbjsbaowcpzsy27.com<br />kztfyzewgqajp.com<br />mzeauuaajr2q.com<br />zrbvdesbkydudhbibu.com<br />kbzjyxayhqiediyksg.com<br />ehjsowotiimskejrrb.com<br />tsugycannnpbm4a.com<br />wnfsoaumsjad.com<br />pegzasrdqdejixsp.com<br />vtpfiacctyyzs.com<br />amelzudthrhl4.com<br />wrkecvplwobtkataii.com<br />pjuqivrgzccwma75.com<br />mdsozfmhhponvjudf8.com<br />wzadnytpuxsa7x.com<br />rzfqpzfngokjox.com<br />athapsmjpmiby.com<br />wsdojxxzkornvjs.com<br />htpvayktihpckppr.com<br />zyqzaegunhxqihv.com<br />umcnzpswuzzohaue.com<br />gzmdgbqhgxvwufr4g.com<br />t7uiefn.com<br />scqsrrykltxf.com</td>
<td>cfcuarw.sh<br />fmgfrjg.in<br />otwzgnl.ru<br />ovdeusk.ga<br />wcnsxdo.jp<br />ybeklgt.eu<br />ybrlhpe.ru<br />agrtwgch.cx<br />dixpbqbi.ru<br />fjmppybw.ru<br />fvdfneeo.mu<br />kknhqcra.mn<br />okxkyxwp.ru<br />qfhdjzru.ru<br />rjbkkxxb.ru<br />vkauhpr.biz<br />wqssublx.ru<br />wyavcujm.jp<br />yfyddgbp.ru<br />anxtygnqt.jp<br />bjzdpfnx.net<br />csdmsoesq.so<br />dqgiwjbww.ru<br />ermnuewsf.cm<br />hwcookvfx.tv</td>
</tr>
</tbody>
</table>
<p> </p>
<h2><a class="chapter" name="h2-appendix-b"></a>Appendix B</h2>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td><strong>Necurs 1</strong></td>
<td><strong>Necurs 2</strong></td>
</tr>
<tr>
<td>gnmjgxxademtgpetqt.sc<br />kvffqiryrnmmghumbjj.ac<br />tchpelfjbcvaepfqtopg.biz<br />augwnsyhfjdqrh.jp<br />ieqdtejtjyp.tv<br />bpqmwruwvpy.net<br />fdhftximvov.so<br />osmanppvqlpoflofgjss.org<br />imtraimjurxjijc.pw<br />dafgmvkqtglgcfohpiift.tv<br />cqwecshovxeowohj.ki<br />pbwbociwujrisgooja.ki<br />pqbflmdnedx.de<br />sdwryvuuokccl.tw<br />ncmhltjkxdkudgenvi.sx<br />wyyfnipawohvawibeoui.im<br />ivdvacqghsaokxx.tj<br />eojupecjddnviwkf.ms<br />ypqvsotunfjcwgmqw.eu<br />uuiyuedjcgqrkiikhv.org<br />lsqbkcvtur.ac<br />kqvjrivjesbouh.bz<br />ctsdnrjgk.xxx<br />sngdykmymoevcxvqll.jp<br />hgxgehw.xxx</td>
<td>knlvsgbbfgbf.to<br />dwfdphkcw.to<br />evmbfvndebnwggw.to<br />wbvwbxqqbjurk.to<br />yqykqrrtlyk.to<br />tvijoqfswt.to<br />yqshpwfbpvpkpvua.to<br />fxxptjsaqxcyqwbnot.to<br />joprxxwgmalu.tv<br />iexsqafpkfuihkhrnul.cm<br />ppksiqnpbkssl.jp<br />gfnvqawqmvntruwof.mu<br />rmldddayyoyacffqfavu.la<br />obntrhqbnvuysjlt.bz<br />vtiwqtky.sc<br />tvkrsyubm.pro<br />guyjfjldpla.org<br />qsqrqvukpj.us<br />srpnbdwjvyh.ug<br />npncalhipo.biz<br />cyvbkdtuqrrrpk.nf<br />tkaxmvotugtnfjkud.mu<br />yhldewlfpgpppnpmqvovx.im<br />sjawwmfddnk.us<br />bwfbswhhgi.la</td>
</tr>
<tr>
<td><strong>Pushdo</strong></td>
<td><strong>Unknown</strong></td>
</tr>
<tr>
<td>syiwesxacaft.kz<br />felfobhuw.kz<br />qovokluctuc.kz<br />mophezazqu.kz<br />lohyikesjobg.kz<br />sazcuworu.kz<br />zyijucbymdyi.kz<br />dyiluvokca.kz<br />lyodohyazesd.kz<br />fazloprago.kz<br />seskokvoce.kz<br />goklevafg.kz<br />cyogunkaffob.kz<br />heqobperxop.kz<br />jyasazxefob.kz<br />pybeguqkulyi.kz<br />tyxcerxamo.kz<br />bafkatkafr.kz<br />bazalahazqa.kz<br />qyirygkuz.kz<br />qobqathoza.kz<br />jopuqrobaft.kz<br />vesgyodeg.kz<br />felfawunc.kz<br />tymrerdyi.kz</td>
<td>vwylysndkjo0y.com<br />huujizqvufbfdohm.com<br />dgschrsnyexof0.com<br />dmuwmmmnpqsovsvx38.com<br />bcjcrojblzrdb2t.com<br />uxzhmwdytpcf.com<br />nhftqdtghebojkw5.com<br />ukntgygowex9v.com<br />zhwdijnnfgnuncwx8o.com<br />oxmxvchmwlajmejx5t.com<br />zyiisphakabfd.com<br />qfjlpbxemhkk.com<br />eboknjldedmyzgux4q.com<br />kpdzrzjkwcil15.com<br />bbnlagrdxvlyqo2p.com<br />bwoqewtpeduwc.com<br />mcpayabijhm8.com<br />oukcdqumruqna3x.com<br />zjhpdenbhkfbdc.com<br />umpkalafubo5c.com<br />vtsucwihjeravngta.com<br />msoweikrwiqdnzsnzh.com<br />raslqtgdgvrxyitv.com<br />qtbktidrtlxdbl.com<br />emvyjkkghfvupbh.com</td>
</tr>
</tbody>
</table>
<p> </p>
<h2><a class="chapter" name="h2-appendix-c"></a>Appendix C</h2>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td> </td>
<td><strong>Zbot</strong></td>
</tr>
<tr>
<td>Figure 14 (left)</td>
<td>availablethislictwarra.ru<br />contributionscoveredphp.ru<br />frfortonotanygroupname.ru</td>
</tr>
<tr>
<td>Figure 14 (right)</td>
<td>coveredcontinuecalphp.ru<br />promisnenssas.net<br />providedsuchdistribution.ru</td>
</tr>
<tr>
<td> </td>
<td>contributionscoveredphp.ru<br />point.bitsinc.org<br />promishlenniewas.net<br />bvcgos.com<br />ardshinbank.at</td>
</tr>
<tr>
<td> </td>
<td>areysoftwaretthewarra.ru<br />anddistributionineither.ru<br />ytheotherbinathefitness.ru<br />faoriginalclausemayawnon.ru<br />disclprodyousaid.ru<br />filesotherincludeother.ru<br />notwarrantiessaid.ru</td>
</tr>
</tbody>
</table> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<p><a href="/uploads/pdf/magazine/2017/VB2017-Mahjoub-Rodriguez.pdf" target="_blank"><img src="/uploads/images/buttons/pdf-download-button.jpg" alt="Download PDF" width="262" height="45" /></a></p>
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=VB2017 paper: Beyond lexical and PDNS: using signals on graphs to uncover online threats at scale&url=https://www.virusbulletin.com/virusbulletin/2017/11/vb2017-paper-beyond-lexical-and-pdns-using-signals-graphs-uncover-online-threats-scale"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2017/11/vb2017-paper-beyond-lexical-and-pdns-using-signals-graphs-uncover-online-threats-scale'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2017/11/vb2017-paper-beyond-lexical-and-pdns-using-signals-graphs-uncover-online-threats-scale&title=VB2017 paper: Beyond lexical and PDNS: using signals on graphs to uncover online threats at scale"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2017/11/vb2017-paper-beyond-lexical-and-pdns-using-signals-graphs-uncover-online-threats-scale&t=VB2017 paper: Beyond lexical and PDNS: using signals on graphs to uncover online threats at scale"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2017/11/vb2017-paper-beyond-lexical-and-pdns-using-signals-graphs-uncover-online-threats-scale"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p> </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
 <a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">©1989-2022 Virus Bulletin.        <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>        <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>        <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>