{
    "H3ax03H4I4g": [
        "hey wow the the room filled up I was uh up front uh speaking with our keynote uh David Co and when I came in the room was empty so I just stood up turned around said where did you all come from this is the uh 19th black hat being held in Singapore um it was the first location that black hat uh held outside of the United States back I think about 2002 2003 um and so I I'd like to welcome you uh to the event and if you've never been before I'll just give you a quick rundown um what we try to do here is put you in uh proximity with subject matter experts and then we want you to ask them questions and we want you to challenge them it's not we're trying not to create a a one to many um yes there might be the one to many but we also want you to feel uh safe in asking challenging questions because the speakers want to learn from you as well um and so to that end uh after we're done with the keynote there will be some Q&A uh which I'm looking forward to with our keynote um the other thing is I normally talk about where people come from for the show just to give you an idea of how broad and uh diverse attendance is um so for example",
        "81 countries people from 81 different countries are here which is amazing have",
        "at least one attendee and another thing we do is since we understand as a industry uh conference",
        "we're not the most economical and we want to bring the next generation of Information Security Professionals and students uh into the community so they can get an idea of of what it is um and so we offer scholarships and to try to get uh fresh uh people interested and so we've given away uh 30 or 83 scholarships uh to people who wouldn't nor be able to attend so if you're in the room and you are one of the 83 please raise your hand right on let's give them a round of applause",
        "so if you see them you know welcome them to the community we're we're a very welcoming Community um and because",
        "security has become so hypers specialized um no one person knows it all it's impossible and so what ends up happening is the people that are most successful are sort of like professionally curious right",
        "continuously learning is the buzzword but in security you really have to do that um I joke that I wish I was born a master woodworker because I could go to sleep for 50 years and wake up and my skills would be worth more but in security I go to sleep for 5 weeks and I wake up and my skills are worth less so you really have to kind of embrace this constant constant questioning constant learning um and so",
        "don't feel bad if you hear some smart people talking and you don't understand what they're talking about because I bet if you start talking they're not going to understand half of what you're saying either um I want to run through just a couple of the countries that are here uh these are countries that have only one one person um Afghanistan Albania",
        "Algeria Argentina well okay take it back there's more than one person from Australia",
        "uh Austria Bahrain Bangladesh Belgium",
        "Brazil brunai Cambodia Canada China I mean it goes on and on that tells you that what we're doing is important right uh",
        "the the role in which we play in protecting either not just Digital Society or make money for our companies or protect the the meme generators or whatever it is um we also are playing an important role in informing the public about what is safe and what's not safe um we have more and more governments coming to us uh or uh Regulators saying what what do I think what should I do and what's going on here is that traditionally you'd have lobbyists and you'd have industry trade groups that would come out with the position and you might have like green piece or some other and they fight and then the the representatives in the middle try to make a decision but now so much includes techn techology human rights um is mostly a lot of it is a technology issue right surveillance targeting um great power competition developers are being targeted by North Korea and Russia and so now all of a sudden it's happening to us and so now we have a relevant voice um so partially what we're doing with some of these talks is we're trying to let you know in the bigger picture what we're doing um has",
        "more meaning than just what the next you know quarter report is and so with that I have a couple opening thoughts and then I'll introduce the keynote and he'll take it away um you can probably",
        "guess um I'm a sort of a big picture guy and one of the things I like to point out is that internet problems are Global problems in the sense that you can't solve all the problems in your country in America we have a lot of giant companies internet companies but you can't solve all the problems in America right right a lot of things are manufactured in other countries China can't solve all the problems Europe can't solve all the problems so we have to work together or we're going to be forced to work together um and sometimes",
        "even when the countries might be in Conflict you're still working together because we're all using essentially the same technology um and something that's come out of this is This Dawning realization and you hear it more and more from the US government is that those closest to the problem and the problem could be anything problem could be a vulnerability in an operating system but those closest to the problem bear the most responsibility in fixing the problem it's like why do I as a security researcher two hops away from the people who can commit code why am I trying to fix the problem right the operating system vendor should fix the problem once and for all and eliminate the bug entirely instead of the endpoint with the endpoint with the endpoint provider right trying to apply three layers of Band-Aids um that might have worked and I'm sorry if that's going to hurt your business model but really those closest to the problem should fix it and I would not be surprised if future liability regimes and regulations start putting pressure on manufacturers to fix their own stuff and not wait for the market to produce a secondary product line to fix their problems um and I touched a little bit",
        "on this great power Dynamic you this is heating up right it really kicked off with Russia invading Ukraine and the realization there was um",
        "some of the infrastructure in Cloud that Ukraine had was in Microsoft and Azure and uh so the benefit of cloud is efficiency the detriment of cloud is you get everybody's risk model and in Ukraine's case the risk model was Russia",
        "right so Microsoft azour now has to deal with Russia could you imagine pitching that to your product manager right your boss let's start a business and uh potential adversaries are uh the most sophisticated in the world uh China and Russia and they're going to come after us isn't that a great business model um but that's what it's turned into right these multi-tenant systems have to be able to defend against the most sophisticated and so that leads me to think well Microsoft's getting really good at hunting yes they have problems but they're getting good at hunting because they they know people are coming after them and when you hunt you find",
        "things",
        "and when you control your environment Microsoft controls their environment um",
        "I just I'm just curious show of hands who thinks in the end long term is it",
        "you go to Microsoft's territory right in in in military terms right you're going to their terrain their domain and you're fighting Microsoft on the domain they control on their servers that they control with their employees is that a winning strategy right if you're Russia and you go to Microsoft and you fight Microsoft people do you really think long-term you're going to win or do you think Microsoft's going to get better and better and better and better and so I think it's going to have these weird second order effects where they'll get some wins But ultimately these Cloud providers are just getting more and more sophisticated and it has a weird impact in that the players below their capability are essentially squeezed out they can't keep up with the security skills of the of the hyperscalers that have the the Russian style adversaries um and so it's this great power competition is squeezing and separating I like to say it's sorting us into different buckets um",
        "unintentionally um and so this great sorting that's occurring had this really strange uned consequence I just want to point out Microsoft releases a report it's like a threat Intel report and they uh here are the indicators of compromise here are these actors we see from Russia uh on the in in the Microsoft network you know check your environment and Community is like great thanks",
        "Microsoft and then the icrc the Red",
        "Cross says wait a minute we can only do",
        "business with non-aligned",
        "parties and Russia's in conflict with",
        "Microsoft oh well we can't use Microsoft anymore because they're they're aligned they're in Conflict so who else are we using that's",
        "in Conflict 130 other it",
        "providers right are essentially been sorted into picking sides either Russia's forced you to pick sides or forced Microsoft to pick sides so now the Red Cross can't use unaligned it providers so",
        "they're going to have to build their own cloud their own satellite their own cell phone everybody's aligned at this point right this technology is political and we're being sorted and for organizations that are trying to remain neutral it's basically impossible so that's a that's an interesting side effect of of this great power competition um one final thought",
        "is that uh you notice I'm avoiding",
        "AI it took some effort but I'm avoiding AI in the keynote because you're going to get enough of that uh here is that there's another sort of debate that's been going on it's been playing out for a couple of years and it looks like I'm betting in the next year or so there's going to be a winner and the argument goes something like this um exploit",
        "comes out produce a mitigation exploit comes out you know mitigation CF I Ford Edge CFI aslr de R",
        "whatever and it goes on and on and on and the adversaries within about 6 months can get around it pretty reliably within six months it's commodity so you've got all these mitigations you're maintaining for years forever and every one of them has been circumvented except the next one you release and that's only like a a 6mon",
        "situation so do you do that forever do you you like maintain every mitigation forever even though they've all been mitigated except for the most recent one right you're up to like six seven eight% of CPU is running mitigations against stuff that's bypassed and the mindset is essentially okay that's a waste of time like we've tried mitigations for two decades three decades and we're still applying mitigation Band-Aids let's start shifting our mindset to uh elimination",
        "let's start thinking about what it would take to eliminate bug classes not mitigate an exploit and once you start thinking about elimination instead of mitigation you see the world differently",
        "and that's what's happening largely in the United States um you saw sisa come",
        "out with a secure by Design road map um we released a paper on memory safe languages the White House released a paper on memory safe languages there's a reason why governments are talking about move to memory safe languages because they're tired of mitigations they need elimination and yes a memory safe language might eliminate you know 30% of",
        "the problem but that's 30% let's then that just means we have to focus on the other 70 let's focus on 70 instead of 100% of the problem and so don't be surprised if you see more and more being written more and more tool chains more cic Pipelines everything is moving",
        "toward getting ready for rust or Swift or go because this is this is the future because would you rather have the government spend billions of dollars moving to memory safe languages or just billions of dollars never eliminating a bug and just always being applied to a patch um and they're they're starting to get tired of it um and then the final thought is um with the XZ stuff that came out um yeah just like Microsoft became the Battleground for Russia us and developers we in the fight and we might not even realize it right some government ran a long game against the XZ developer because of a dependency",
        "that the system D folks implemented",
        "right like a butterfly flaps this wing and a git repo and like a bunch of developers are targeted by Russia or China or whoever it was it's like it's crazy you can't you can't predict those scenarios you just have to assume this is the world we operate in um and that means again you can't really do it alone and you see more and more interest in governments and open- Source projects um and Foundations in",
        "trying to understand dependencies critical paths and what they can do to try to either like a co-pilot style",
        "scanning for vulnerabilities or credentials you're just going to see a lot more tooling and a AI around trying",
        "to upscale like the the open source",
        "ecosystem and I think the as bomb is just sort of the beginning of that and and we're going to see uh a lot more it's like the opening Salvo in what governments are going to ask for so so with that said um it's it's really my privilege to introduce David Co um who",
        "he's the first uh commissioner for cyber security and he is the founding chief executive for the cyber security agency of Singapore and I always enjoyed talking to David because Singapore is sort of like the opposite of America um where America's huge and slow",
        "and we have really old technology and Singapore is much smaller and a little bit more more Nimble um and so it's great to see the contrast what do they do can we fast follow them do they wait until we bake something in until they decide to buy it or act also regionally uh Singapore has to be very Nimble um in the region um",
        "unlike the United States it can kind of bumble along uh and just due to our size get stuff done Singapore has to be a lot more conscious um of the political situation and who the different players are and so I'm I'm really looking forward to seeing uh what he has to say and then at the end of his session um we'll do some Q&A okay so David is is also Beyond being the chief executive for the CSA he's also the digital uh the chief digital security and Technology um",
        "at the ministry of communications uh and information and so as the commissioner he has the legal authority to investigate cyber threats and incidents to ensure that essential services are not disrupted in the event of a Cyber attack so with that said it's my pleasure to introduce David",
        "Co thank you",
        "[Applause]",
        "good morning everyone um I've got some prepared remarks so I thought I'd hide behind this instead of uh standing in the middle uh going back to what Jeff said I guess um he's right the scope of our work is getting wider and wider no one knows all the answers so that said I guess I'm supremely qualified to do this job because I don't know most of the answers uh instead what I I guess I bring to the table is I know what questions to ask uh and because I know so little then uh I don't have preconceived ideas so I guess that qualifies me to be doing the job that I have but everyway good morning to all the people welcome to Singapore and welcome to black hat Asia it's an excellent opportunity for our community to share our thoughts our findings amalgamate our insights and then with what we've learned leave and move forward to better secure our world as what Jeff said no one knows all the answers so we do have to work together and that's a recurring theme which I will come back to in the course of my remarks technology has always been a",
        "double-edged sword the invention of the knife helped us to hunt better perform our tasks with more Precision however it also has been used as Weapons even until today so the invention of the Internet",
        "connected the world it birth new communities facilitated new economic opportunities but has also created new channels for malicious actors to cause harm Rising geopolitical tensions also",
        "encroach into cyberspace as the states",
        "and the big Powers jostle and seek ways to inflict damage on each other we've already seen such instances in the Russia Ukraine war and indeed the current conflict in Gaza",
        "cyber security is therefore an",
        "imperative whenever we rely on digital Technologies and connectivity we expose ourselves to the risks of being attacked or compromised by malicious actors from all over the world as cyber Security Professionals our jobs is getting more difficult by the day first the threats that we face in cyberspace are growing and becoming more sophisticated there is more that we have to defend against now and second the technological landscape is becoming more complex and this affects the terrain that we as Defenders must navigate let me elaborate on these two points first the going threats in cyberspace malicious actors are adapting and evolving they are increasingly becoming sophisticated and the scale of their attacks is also going up a risk of high impact cyber attacks is correspondingly",
        "on the rise in May of last year it came to light that the the it environments of multiple critical infrastructure organizations was compromised these",
        "organizations came from sectors diverse sectors like Communications energy",
        "Transportation Water waste water from",
        "Guam to the continental United States",
        "this was achieved by using living of the land techniques including stolen valid credentials and built-in admin tools",
        "native to the whole systems this allowed the threat actor to evade detection by the typical endpoint detection and response tools that and Achieve",
        "persistence fers techniques such as living off the land attacks are especially difficult to detect many",
        "organizations continue to use traditional security controls that guard against endpoint malware allowing the malicious actor who uses such techniques to go undetected for days weeks months or even years such techniques will allow Potential Threat actors to lie in weight position themselves and conduct future acts of sabotage disruption or",
        "destruction the scale of attacks has also been increasing fueled by Shadow Industries selling and sharing malicious",
        "tools vulnerabilities and exploits as a",
        "service threat actors now can purchase",
        "such resources this lowers the barriers to entry for lower skilled attackers so that they can enter the frey according to IBM ransomware as a service Affiliates can pay as little as $40 us a month for access to ransomware tools so you don't even need to buy it you can rent it pay as you go so every Defender now needs to be prepared to defend against these sophisticated attacks which are now accessible to even Petty criminals",
        "however not all Defenders small and medium Enterprises for example or individuals are equal in skill or have the resources to adequately prepare for these against these capabilities so these this leaves Defenders increasingly",
        "vulnerable it'll be remiss for us for any of us to think that the threats are only of concern to those who operate critical infrastructure or they have high value assets with with the rise of supply chain attacks malicious actors are now casting a wider net and they're going after organizations that may not have otherwise thought themselves as Targets in 2013 target uh the attackers",
        "exploited the network access provided to a third party HVAC company which had weak security controls these attackers then pivoted and entered the target system and stole financial and personal information of 110 million Target",
        "customers the rise of supply chain attacks also makes our Enterprise cyber security even more challenging every organization must",
        "rely on an ecosystem of other parties vendors suppliers your",
        "clients and for each additional third party organization that we do business with then our tax surface expands and is not linear hackers can leverage the",
        "targets uh privilege access to infiltrate the networks and the customers and then expand their reach within Verizon's 2022 data breach",
        "investigations report said that business partners accounted for 62% of system intrusion incidents that it analyzed in 2021 so you can protect your own networks but 62% of these system your breaches come from somewhere else this is a sharp increase from 39%",
        "in 2008 these examples are Stu reminders of how we can't just rest on what we've achieved we have to keep moving like what Jeff said in his opening cyber threat actors also have raised their Ambitions in the last three years we've seen more than our fair share of serious cyber security incidents many of these serious attacks have implications that are no longer contained within the digital domain but they have spillover effects into the real world in February this year change he care the largest Clearing House for insurance building and payments in the US was attacked by ransomware the attack left thousands of Doctors Hospitals and other health providers that depend on change healthcare for billing reimbursements without payment this resulted in many providers and patients um to see delays in their cash flow or Worse delays in getting prescriptions filled or even procedures being conducted one can imagine the potential life-threatening effect on Patients health outcomes that could this could potentially have given the gravity and potential impact of these attacks uh targeting these actors can become very lucrative for cyber criminals especially",
        "if they can Ransom the victims hackers claim that change Healthcare paid over $22 million Us in Ransom these are",
        "enormous Financial incentives and they continue to fuel the criminal industry looking to Leverage our cyberspace for gain Verizon's report estimates that 95%",
        "of breaches it analyz in 2023 were financially driven it's therefore no wonder that such cyber attacks will continue to increase in sophistication scale and impact because it pays the",
        "technological landscape has also become increasingly complex um with the rapid",
        "development of emerging Technologies such as cloud computing and pardon me artificial intelligence cloud computing was first commercialized I was just commenting that it's impossible to make a tech speech without having AI in it I tried cloud computing was first commercialized in 2006 and barely two decades later by many estimates 80% of",
        "all major organizations use some kind of public or private cloud in 2027 the estimated Global Cloud Market will surpass1 trillion us",
        "yet few users truly appreciate the",
        "security risks that have or have the expertise and tools to implement the complex security controls that are needed to safeguard these virtual networks and their data adversaries are",
        "aware of this and are increasingly exploiting the users Cloud environments including common vulnerabilities such as identity theft insecure apis and misconfigured containers crowd strike",
        "reported that the crowd uh Cloud environment intrusions have increased 75% from 2022 to",
        "2023 this is why last month the Singapore government introduced a new bill in Parliament this is the cyber security Amendment Bill and one of the major provisions in this amendment is that we will regulate cloud service providers for cyber security this is in recognition that cloud service providers must be accountable for the cyber security of their infrastructure their platforms and services which they provide and be transparent about cyber security incidents that cause disruptions to their many tenant um customers and the infrastructural services that they provide to many businesses and indeed individuals",
        "Enterprises that use cloud service provide uh Services must also learn how to protect and secure themselves in this regard the cyber security agency of Singapore CSA has also launched two Cloud security companion guides for organizations last year this provides advisories to Cloud customers to enable them to operate safely in the",
        "cloud we are also on the CP of an AI Revolution the possibilities offered are immense McKenzie estimates the economic",
        "potential of generative AI at about 2.6 to $4.4 trillion annually with 75% of the value",
        "falling across customer operations Marketing sales software engineering and research and development use cases include customer service call booots AI generated publicity materials promp engineered code just to name a few so it's not something that will have a specific use case but it's something that will be applied across the board and affect all our lives this is a space that's moving rapidly if you had asked me in 2022 what are the biggest Tech challenges affecting cyber security AI",
        "would not have been what I've said chat G PT was not known or understood a year after its release cat GPT has over 100 million weekly users and 2 million developers building on open AI",
        "API organizations have also taken to this trend a 2023 earns and young study found that 99% of CEOs are making or planning some in significant investments in generative AI this underscores how the potential of AI has been recognized and is going to be adopted however we should not forget that there is a dark side to the use of AI as well Microsoft and open AI found that threat actors have been using AI including llms to enhance their productivity for reconnaissance of their victims perform adaptive scripting and malware development as well as to leverage machine learning to use and refine their own social engineering attacks and disseminate false information in the face of the threats that I have spent the last few minutes talking about the important question is this then what should we do what should we The Defenders do about this Myriad",
        "complex environment that we operate in here in CSA we say that cyber security is a team sport in a digital world where we are all interconnected we are only a strong as our weakest link we're on the same side and we have to work together the government industry",
        "Academia individuals all have our part",
        "to play first let me talk about what the government can do as Government we set laws regulatory Frameworks to promote security and resilience in respect of the information infrastructure that we all depend on for our security survival",
        "our economy and our way of life this is why in Singapore like many other jurisdictions we regulate the cyber security of critical information infrastructure CIS for sure however in a country as digitalized as Singapore the security and resilience of non CIS is",
        "also important this is why we're moving to regulate other type types of digital infrastructure this includes cloud services and data centers this is on account that any compromise or disruption could lead to widespread implications for businesses and organizations and individuals who depend on their services but regulation is not the only tool that we have the Singapore government has also invested significantly in educating and equipping organizations and individuals with cyber security resources and toolkits so that they can help themselves one example is the SG cyber safe Safe program CSA has provided cyber security toolkits cyber security self assessment tools and playbooks to help organizations conduct simulated fishing exercises train their employees for example to spot and act against fishing attempts now industry also has a key role to play in the physical world the defense of every Citadel depends starts with analyzing the terrain and the advantages that it can give you it's no different in cyberspace but unlike the physical world we have the ability to shape our digital terrain therefore businesses should make sure that their offerings are secure secure by design by default and by",
        "deployment security has to be integrated into every part of the development life cycle from initiation through to",
        "deployment this is why CSA published a safe app standard earlier this year it's a set of Standards developed in consultation with industry Partners from the financial institutions Tech organizations consultancy firms firms and other agencies to guide Local app developers on how to design safe mobile",
        "apps that will inter secure the transactions that are made on them we have also set up two cyber security certification schemes the Cyber Essentials and cyber trust marks to encourage companies to take up the necessary cyber security measures and set themselves apart from their",
        "competitors in an Ideal World We envisage a cyberspace where products and their settings are designed to be safe and secure from the onset and by default when the companies and where companies consider themselves to be cyber safe and this is a differentiating value proposition against their",
        "competitors while sophisticated users can adapt based on their own needs less sophisticated users will be protected by default and will not have to worry about transacting uh in cyers",
        "space sharing timely information on vulnerabilities exploits and incidents is also an important cyber security practice this is because timely information sharing is key to disrupting threat actors who seek to use our interdependencies to move from Target to Target in recent years more and more industry players are starting to recognize the importance of information sharing and are working with and through governments to disseminate cyber security advisories last year we in Singapore signed memoranda of understandings M us with Google Microsoft entity and dragos to formalize",
        "our exchange of threat Intel and work together to improve our Collective situation awareness of cyber security threats and incidents now let me move on to developing the broader ecosystem malicious actors continue to innovate and therefore so too must Defenders this is why conferences like this black at Asia are important where cyber Security Professionals and researchers like yourselves come together to discuss the latest trends in research development Trends in the cyber world overall an ey Parton study commissioned by CSA in 2022 estimated that Singapore's cyber security Market size will more than tripled from Sing 570 million in 2015 to",
        "2 billion in 2022 to support this growth Singapore believes strongly in investing in cyber security R&D last year we unveiled SG",
        "cyber SG Talent Innovation and growth plan the TG plan this is a comprehensive approach to developing the cyber security ecosystem in Singapore and existing Innovation and talent development initiatives a key program under the tig plan is the cyber security industry call for Innovation each year we make two calls for proposals for cyber security companies for innovative solutions to address cyber security challenges of the day selected uh proposals receive funding of up to $1 million last year we also launched a new program cyber boost under the tig the pro the objective of cyber boost is to help cyber security companies develop validate and scale their solutions from Singapore participating companies receive training mentorship and networking opportunities and more to conclude whatever your role is",
        "practitioner researcher developer or government servant you have a part to play in this team sport that we call cyber security it is a complex and challenging world out there that we operate in but we are not helpless we are not without agency I believe that we together can make cyberspace safer more",
        "secure and trusted so that we can live work and play safely and securely online I wish you all fruitful discussions thank you for your contrib tions to building a safer cyers space for all of us thank",
        "[Applause]",
        "you",
        "thanks all right thank you",
        "David now I get to ask you some questions and you you get to ask me questions um and then we get questions from the audience there's going to be a microphone I think on each side so when you approach the microphone please just identify yourself and ask a question not",
        "uh this is more of a comment than a question no no we want questions not",
        "comments okay uh first up uh one of the things I've noticed is really the two speeds of of government right one is this Norms building takes forever try to create the UN gge do and the other one is you just talked about all these initiatives you've rolled out in the last year too right how do you how do you mentally shift",
        "gears uh thanks Jeff well first of all it's true um we have I was telling Jeff",
        "we have to be able to walk and chew gum at the same time Singapore is a small country we're a price taker so if we if we try to do things at the global stage to be honest it's limited uh but at the same time um as I said we're not without agency so we do have beans to do something within our own patch so we need to operate at both levels um so let me begin at the international U stage first of all it may come to a as a surprise to some of you that actually cyberspace isn't a Wawa West uh There are rules that are being discussed and actually there's a whole set of norms of responsible State behavior these have been discussed at the United Nations for the last 20 years so in 2015 they came out with a set of 11 Norms of responsible State Behavior a combination of Thou shalt not do this and thou shalt do such things um which actually has been presented to the United Nations General Assembly um and in asan um our leaders have endorsed these 11 Norms of responsible State behavior and um now we're in the process of implementing among the 10 Nations but as you said this is a um firstly is about exciting as watching grass grow and it's moving at about the same speed but nonetheless it's something that is worth doing and something that uh we need to be part of because if whatever rules that come out with respect to the internet affect all of us so that's happening and moving at a certain speed uh we need to be part of it but at the same time we're not holding our breath meanwhile in our own jurisdiction um we can't wait for the world's problems to be solved by the United Nations at least on in cyers space so we can and we should do some things so in 2018 we passed the cyber security act so that we have a law governing what's most important um providing essential Services um to Singapore and to singaporeans so this is a cyber Security Act of 2018 we've been implementing this for the last six years this looks after primarily critical infrastructure um but that we realize isn't enough because a lot of um the society businesses are non CIS so what",
        "do we do with that so we're trying to encourage people to move um towards uh uh things like um differentiation better cyber hygiene Etc so two of the examples I gave were cyber trust Mark and cyber Essentials the starting point is that a lot of businesses small and medium Enterprises know that cyber is important but then they don't know exactly what to do so my guys came out with two standards which are good enough cyber Essentials and if you want to differentiate yourself or you're operating trusted Services then you aim for a cyber trust Mark and the hypothesis is that you know this is something that can guide the Enterprise as to what is and it's catching on right I think some other countries are following suit yes right so we are't the only ones the UK has been doing their version of cyber Essentials for the last 10 years Australia has similarly come out with something like so all of us globally as uh um Jeff was saying earlier uh facing the same challenges so I think we uh to be very honest we copy each other's playbooks there's no need to reinvent the wheel yeah and so so do you find that there's certain uh certain countries or companies that are willing to move faster are there ones that are super conservative like how do you see this playing out is it like there's the fast followers the early adopters so so your I I think your comments earlier on were sharp and on on target I think one of the big advantages that we have in Singapore is that we are small and Nimble I think in the physical world in the kinetic World size um is to your disadvantage you're too small you don't have the resources Etc but in the digital domain actually all of us are facing similar challenges and it actually being small helps you can um uh",
        "firstly uh coordinate better um don't get me wrong inter departmental uh stove pipes and rivalries uh scalable we have them in Singapore as well right uh but the difference is that um we we can probably lock up most of the senior people in one room uh smaller than this and and sort it out and no yeah and lock the doors and don't allow us out until we sort it out so in many cases we' have been able to resolve uh and work for the broader uh benefit so I think it does allow Singapore to move faster um second I think uh our government's uh um mindset is that uh we are prepared to experiment to some extent with respect to policy so we don't need to work out the 100% answer before we start moving so the Cyber labeling scheme is an example my guys came to me with a proposal look people don't know what is a cyber secure product I I admit that uh it resonated with me because just before that I was trying to buy a home router for myself and since I'm in charge of cyber security I thought I should buy one that's cyber secure now I'm an engineer by training I looked at the boxes spent like half an hour at the shop looking at the boxes I gave up all right I couldn't tell which was a more cyber secure product so I gave up came back to the office and send an email to one of my guys it's like which one should I buy okay all right so I have the benefit but the average person doesn't have this benefit so my guys came with a proposal let's try to demystify this so that if a consumer does want to buy a product that's more cyber secure a home router a baby monitor whatever then there's an easy way for him or her to tell so they said let's don't need to invent a reinvent a wheel uh take a Lea from the energy uh efficiency um model you buy a fridge you buy a washing machine uh there's one tick two ticks three ticks four ticks it doesn't take uh rocket science uh that uh to figure out that four tick is better than three tick Etc so we did the same thing for U cyber security Now the",
        "senior guys were trained over the years to ask questions so we had a bunch of questions it's like are you sure this will work who's going to pay for the certification do we need to cyber security is moving once we give it four ticks four stars then tomorrow a new vulnerability comes up what will happen what about our liability so we threw them out but they kept coming back okay and uh one of my bosses taught me that um well if you you know you have two choices either lead or get out of the way I decided to get out of the way and uh then we went up and did this as a hypothesis now the key thing is that our cyber labeling scheme is not mandatory it's a purely voluntary scheme and we tried it out and after uh now it's coming to two years we've got like 400 over products coming in including some from large oems Lenovo Phillips uh Google all wanting to put the Singapore",
        "cyber labeling scheme on their products so the hypothesis is correct if you build it they will come and uh if you want to and what we see is that people are using this as an opportunity to differentiate themselves uh as a competitive Advantage so this is a key Point cyber security we view ourselves very much as a cost center it's a burden it's something to do but here my guys were able to turn it around that it becomes a value proposition if I'm more cyber secure then maybe it's uh something is worth differentiating yeah take some money out of Marketing instead of okay let's try to open it up to the audience uh otherwise I'll keep asking questions so if anybody has a question Mr Co please go to the microphone otherwise I'll ask you sort of a somewhat follow-up question to a remark I made in the opening which is this idea of sort of external forces sorting you into picking sides and and a concern I have heard uh in Singapore is that we don't want to get sorted and then have to pick a tech stack like if it's sort of China versus the west and we're all all using essentially the West Tech stack and there becomes the Chinese Tech stack now what we have to have double the developers and like nobody likes where that's going uh great question um first of all I wanted to say that you know as as you were making that comment about us being sorted I was thinking that maybe the blackhe Hat logo has to be changed next year you have the Harry Potter sorting that's right uh instead um no I I think that there is a huge challenge with respect to um Tech bacation um or I I think that uh from a Singaporean perspective is one of the biggest challenges uh if you look at it from a historical perspective Singapore has benefited from being an open uh economy the the if you look around the building that we're in the whole of the city center we have become rich because we've been open and able to trade across and a lot of it actually is because we're at the center of uh major training routs and uh we benefited from this so it is our our economic and strategic interest to continue this ability to benefit from the trade have an open economy Tech",
        "bicationic in the opposite direction now",
        "I I want to unpack this a little bit um if you think about it we are concerned about two elements one is the continued free flow of ideas education Etc but at the same time we're also concerned about security uh I believe you can have your cake and eat it to from a tech perspective how so well we are concerned about security but when you talk about security what are we actually concerned about it's the supply chain where the kit is made right so you have to secure your supply chain make sure it's from your trusted suppliers Etc but on the other hand I think it is imperative for us to maintain interoperability as tech people you can understand this I'm old enough to remember that when you went to Japan you had to use another phone because the tech stack was different um and I don't want to go back to those days all right I want my phone to be able to be used whether I'm in Tokyo in Beijing or in in New York or London um",
        "if you don't want to use the Chinese equipment for example you don't buy Huawei uh you can buy Apple but it's made in China as well but that's another issue right okay now I think",
        "interoperability is important because we want to maintain a common internet uh you can it gives huge opportunities for education for the social interaction yeah The Fosters Innovation if it's an open standard nobody has exactly so we have to maintain that interoperable but and I also want to go down a second level into what's the kind of data that we're talking about so I think broadly that's three buckets of data there data that pertains to National Security oh yes that needs to be protected it needs to be Sovereign on Prem Etc doesn't need to be interoperable my National Security standards are not my my encrypts are not interoperable with yours they're supposed to protect it from other people uh then on the other side is um stuff that's data that's for economic social",
        "educational purposes I think those can and should be openly um shared so that we can benefit from the Innovations uh the education uh all the cat videos that you want to watch Etc uh all of that should be the third bucket somewhere in between personal data I think different uh we we're still coming to grips with that because certain uh regimes like uh G gdpr in the EU they take personal data uh security to a different level um uh but I think that can be treated separately but on one hand National Security issues which can and should be protected uh but on the other hand it doesn't mean that it's one size fits all so I think it's I think we can and we should aim for interoperability in standards so that we can achieve that uh and reap the benefits of that but at the same time look after our supply chain so that we can look after security let's go to the gentleman on the left this is toas gond I'm I'm just speaking as a personal resident here not not in a corporate uh thing I liked your statement when you said like when we build it they will come and I think you you did quite a number of things in Singapore right where when you build it they will come uh being the CI enabling actually more trust in the ecosystem and therefore for more business in digitization the certifications that you mentioned there's a third one that you buil uh which is actually a digital authentic uh authentication syn pass in particular",
        "and I think it enables many things but here comes my question I think there are still some challenges in this for example how much facial verification how many uh requests can be done per month do you have a vision for driving synpath further so that also more people can come and and digitization can grow from that is there a vision from your side right thanks very much for the question if you think we've done some things right please tell my boss all right um no uh but yes I I totally agree that sing pass has been uh one of the killer apps uh in terms of Singapore's digital Journey first of all a disclaimer um sing pass doesn't come under my agency it comes under um Gtech all right they've done a wonderful job um and uh I",
        "I if I will say that just the other day my wife and I had to uh um provide some documents I I forget for exactly what reason and after dinner we went upstairs and then we went on the computer and we did it in half an hour all right we went to the bank got certain documents went to cpf got our our retirement uh information uh we didn't even have to download it uh and print it because you just had to put it at a PDF and then we sent it over everything was done in half an hour as as we were done I was telling my wife you know in the old days we would have had to take half a day's leave all right right drive to the bank get it certified uh bring it over get uh see an officer in cpf get that certified and then bring it over and uh and probably you you forgot something you know and you need something to be signed and certified all over again uh but that is the benefit um and someone my age can remember how we used to do it um and there's been my kids don't know that we",
        "used to do it this way and to them this is an expectation so this is one of the challenges with respect to the digital um as each generation comes up they just expect it to get better faster more convenient from a security perspective that demand for the speed the convenience actually is in direct tension with the need for security uh same for sing pass so the question now is as s pass rolls out for more and more things then how do we secure it and as it rolls out for more and more things it becomes a more lucrative Target the attackers know that if you can compromise sing you can unlock many other things so that becomes a more and more attractive Target so we're trying to balance that in fact we just had a discussion as to whether we should roll out Singas for more commercial entities uh and I think the concern is that if you do do this then what happens if the commercial entity is breached are there liabilities involved uh since the breach came perhaps from Sing pass Etc uh so this is a balance we're trying to strike no easy answers um on the one hand if if we leverage sing pass to do more and more things it's convenient for Singapore singaporeans Singapore residents but on the other hand it becomes a concentration risk and then the question are lock on um um concerns so long way to say that we're still working on the vision but I think we are uh very um it sounds like you're doing the same trade-off analysis that everybody else was doing on you know there's no easy one siiz yeah no so absolutely so tradeoffs to me are the key to cyber security I I think it's a tril there's no such thing as 100% cyber",
        "security if you 100% security leave the computer in the box once you take it out and you start using it uh it's useless if it's in the box once you take it out start using you take on risk so you always try to balance usability and the risk and oh by the way that's cost as well so this is a Trel you have to balance let's go over here on my right hi good morning morning my name is Kelsey ecclesiast I flew all the way from the states actually to be here I'm one of the 80 um scholarship recipients so thank you very much um also thank you for your talk I enjoyed it and while I was standing here you actually answered like three of the questions that I wrote down so I do have another one for you excuse me um so we did speak about how education is a large part of protecting the uh population hudman um but it seems seems like fishing and um scams and other kinds of uh triv trivial attacks are made possible and in fact like we can have many examples of how like oh my goodness this like uber got attacked last year and it was just because of a fishing scam that really could have been avoided um so how can we reach out to individuals businesses and vendors that don't prioritize cyber security it's a great question I I think that it's a generational issue um deep down inside I believe that it's a generational issue what do I mean I I don't speak Tech natively um my kids speak Tech natively",
        "right I I work in Tech but I'm not a native to this environment uh I'm an igree I still speak it with a bit of an accent but I think my kids will grow up in a world where they are native and they understand what do I mean I think that if you think about it um we don't have the instincts for cyber security you look at the physical world so for example this morning you left your home or hotel room you closed the door you locked it if you drove here you locked your car Etc um later on at lunch you won't leave your wallet or purse lying around these are physical security",
        "things that we naturally do we have the instincts for it uh if you are on a a street somewhere in a strange city you you're and it's dark you're a bit more concerned and you look around where do we learn all these instincts from we didn't attend a course by the Singapore police force we learned it from our parents as we were growing up they taught us what to do but when it comes to cyber security we didn't learn anything from our parents if anything we're teaching our parents what to do and what not to do so this is the the challenge now I think that and because of that when we go online we don't have the instincts to see what is safe what is a bit more sus what is um a bit dodgy Etc um I believe that over time we will build up these uh instincts and capabilities but until then we're operating in this we've been thrust into this 21st centur there's an observation that that in real life you can look around and you can see people kind of what's going on over there or slightly you get some sort of a feedback cycle but the feedback Cycle online is connected right you click on a link and you just screwed up but you might not ever know that right two months go by and something bad happens to your bank account you can't tie that bad behavior back to the thing you did two months ago so you you can't really reinforce your learning and some I remember decades ago we were joking that if if somebody put like a little vibrating mechanism in your mouse and you tied that to like your antivirus or something like you're going to the browser and you're about to click on it your mouse is like you're like oh wait hey how come it's it's it's over level 30 it's only supposed to vibrate over level 30 I'm doing something wrong you need to create these feedback cycles that that we don't really have absolutely okay last question on the left here uh thank you uh my name's Lucas from Australia so my question is a kind of a it's not a statement so we've seen um the secure bar design uh it's actually really good it's a very much a carrot approach and you're right it's a it's a differentiator we've seen it coming out in Australia and other parts of the world as well and it's kind of like a two-part question so sorry if it's the last one as well but um the first part is can you talk through behind and this is once to yourself as well Jeff uh behind the scenes when the governments are talking about secure by Design having it mandatory or not because you have the car then you sometimes you do need that stick and eventually do you see it becoming a mandatory aspect of of of any kind of design of virtual products I think the short answer answer is yes the um the question is how long are we going to take uh to get there um I was talking with Jeff uh before this um session and we were talking about u s bomb secure by Design Etc so in my keynote I said that Singapore is a small country where're a price taker what it means is that in theory intellectually we understand that we want stuff to be secure by Design but as a small country",
        "we we don't have the wherewith all uh to say know we want stuff to be secured by Design otherwise we won't buy it uh Microsoft Google are going to say fine we won't serve Singapore uh Market you know it's a blip as far as our our financials are concerned is a bit of a loss all right but that's about it so if they have to make that tradeoff they're not going to come here but when a big country like the US says that we want the as bomb we want secure by Design then we violently agree with this and we will support the efforts and uh we will lend our voice uh to that chorus um of like-minded countries um jurisdictions will say that yes we support this and these are the reasons that we want this I I think it's important to to say and speak up because then you get that feedback loop to the industry to say that this is what is desired this is why uh and and it's not just the US it's not just the White House saying this but this country that country Etc and a diverse group of countries saying that this is good I think that's the first step uh to build that um feedback loop because to be honest if you don't give the feedback then um it's hard work to want to create the necessary uh and the next thing I'll say is that uh no initiative no Direction No statement from the White House or from Singapore CSA is going to be perfect from the beginning right I I'm sorry govern uh there's a saying in government if it's 70 80% there is good enough for government work okay don't quote me but uh in some respects yes and the reason is that if you want us to develop it to the end degree until it's 100% correct it's going to take forever so we have to move and start and then evolve from there yeah there's that saying In America which is or generally is uh politics is the art of what's possible not what's perfect and it's the same in Tech all right so we're out of time um let's give David a round of applause [Applause] app and then next up the next sessions start uh at 10:20 on this floor across",
        "the way the um exhibit expo center is open now and then tonight at 4:30 in the business Hall um we have a welcome reception so if I don't see you now I'll see you this evening at 4:30 and thank you very much"
    ],
    "Z28TuWM0pbE": [
        "bright and early on day two our final day of black hat in uh Singapore I hope you got out and tried some local food if this is your first time or returning to Singapore so let's see show of hands who had some local food last night right on yeah this is a this is a fantastic City for food and we're in a pretty good location for it okay so yesterday during my keynote uh uh introduction remarks I talked a little bit um briefly about AI because I wanted to save it um all for today and so some of the topics uh that we touched on uh and some of the talks you saw yesterday right are going to be the background um for what we're we're talking about and normally what I would do is I'd have more opening remarks to introduce the topic of the keynote but since it's a conversation I don't want to use up all my questions rhetorically I want to use them up with Rin So the plan is um we're going to sit up here uh and we're going to have a conversation about Ai and we're going to start very generally and then we'll start getting uh more focused and then about maybe two-thirds through we're going to try to go for questions and answers from the audience because I think this is an area that's moving so quickly um and everybody has a different kind of preconceived notions about where we're going uh or why we're going there I think it' be really good um for us to hear uh your questions and",
        "then we'll finish up on the hour and then across the hallway 10:20 the next sessions will start and uh and then this evening don't forget the lock note session uh is at 420 starts at 4:20 and if you haven't been to a lock note it's sort of the inverse so what we do is we have all of the we have a panel of review board members who helped select the content that we're seeing here and",
        "we talk about what did they see what were they what was interesting uh and",
        "it's a chance for you to sort of listen in on a conversation of the subject matter experts talking about ourselves so you're sort of like uh oh I get to see the experts talk and then again we open up for questions and answers then you get to ask them um and it's just a nice way of of ending up the conference and trying to summarize everything and uh and here what what did the people expect to happen and what actually",
        "happened okay so let's get started uh with more two pages of AI questions at least you're going to have a lot of AI and the person that we're going to be having the AI with is Dr Ran he the government of Singapore and ran is the Singapore's Chief artificial intelligence officer where he leads a multi-stakeholder effort to achieve",
        "Singapore strategic AI goals um and included the development and implementing of Singapore's National AI strategy he's also concurrently the Singaporean government deputy chief digital technology officer and he's a member of the United Nations highlevel advisory body on AI he holds a Bachelor",
        "of Science in Electrical uh science in engineering and a PhD in economics both",
        "from the Massachusetts Institute of Technology so it's my uh privilege to introduce",
        "rman",
        "[Music]",
        "heat hey hello see I brought my coffee",
        "okay excellent I have an advantage um so I have a feeling first just give us a brief background like Singapore has a strategic goal on AI and you have a chief AI officer right what was the thinking behind creating these roles versus the existing technology roles so",
        "so it's great yeah very happy to be here um looking forward to the chat Singapore started our AI Journey a while back um we had our first version of our national AI strategy around 2018 2019 um and that",
        "really set in found in Foundation a lot of the the the the basic enablers that we are making use of today last year we felt about the start of the year that there was a need to revise the strategy really because the fumal very fast and that was about the time that cat GPT um emerged onto the scene and so last year was a amazing year of really trying to understand what should we do next how do we revise strategy how do you ref on your strengths and so at the end of last year the Deputy Prime Minister and soon to be prime minister Lawrence Wong announced our revised AI strategy um in December and so I I'll work ahead is really to implement the strategy moving forward and so so you sounds like you're an early mover right 2018 one of the earlier ones yeah but there so what led to that then like I think we are a country that always tries to look a little behind a Beyond The Curve um looking a bit ahead um we know that technology waves come regularly we started our smart Nation journey in 2014 and but that was a mark to recognize that digital digital Technologies were going to be play a very important role in our lives but that wasn't the first point where we looked at digital Technologies you look back we had the national computer ization bought in the ' 80s and '90s really to automate Enterprise um software in in Singapore had uh you had blockchain you had crypto",
        "you had nfts you had Ai and it seems like AI is the last one standing um Never Say",
        "Never I I mean I think we constantly look ahead at emergeny Technologies and I I think you want to be ready for it but you you also recognize that as with many of these Technologies it's always overhyped in the short run and probably underhyped in the long run so you want to be aware you want to repair your population but you want to be very careful and deliberate about when you make deliberate shifts yeah okay so um",
        "we're going to start with some more broad questions and the first one is maybe uh ideally it's a concern of everybody's but more so for governments around the ethics um and and maybe core principles right the principles that your Society stands for can any of these ever be reflected or coded in an a AI model and reason I bring this up a little bit is the European Union uh has their AI strategy and it focuses certain human rights more so than and then the United States has a model China has sort of an AI strategy and um the China Chinese model seems to focus more around you know reflecting correct principles of their governance model you know America is maybe more Laz Fair focused on maybe job creation or more around uh business European Union is more focused you know with the first to move on GD PR they're focused maybe more around individual identity and so that's great that the countries have these principles but does it mean anything in AI can you actually enforce or Implement any of this so I think that a great question um what I think what Jeff you described is that um countries always look at regulations and um a general bent of the society very much based on the unique cultural context that the society operates right so the Americans the Chinese the Europeans have a different context they have their own unique context we also have our own context and I think um the the the rappers and the systems around AI tend to reflect that so whether you have a certain bias and slung towards a particular orientation for your AI policies I think it comes up I think where we come from in Singapore is that we ultimately see regulations as a way to encourage Innovation right you need you need to encourage a responsible use of AI so that you can innovate right otherwise you're not going to bring a population along you're going to create a lot trust in the society and I think that's our general stuns we generally think that AI is a Force for good we think that you can shape AI so that it yields benefits for Singapore and the world um and for a population that is always going to be limited by a small land area we ultimately see AI is something that creates in uh inherently has the opportunity for multiple uh en productivity enhancements as well as new business opportunities but the regulations around that must support that endeav so then how do you train and M to have Singaporean characteristics so I think that's a different question um I I think you can certainly reflect an reflect cultural context in LM uh we have been working on the sea lion LM and that's really um sea lion stands for it's a very cute acronym it's the Southeast Asian languages in one network",
        "see and the idea behind that is to make sure that your training data sets reflect the cultural uh uh content of",
        "the region right so maybe multilanguage Indonesian Thai Vietnamese",
        "Etc but that's different from I think so that's the training data you want representative training data to reflect your community that's right but ultimately whether you can encode um values I think that's a SE separately different question I do think that ultimately it will require the human in the loop the human must express its values in how they use Ai and the kinds of questions you ask it the kinds of wrappers around it that you that that and I think that's where the values of individual Society to be manifested I think it's probably a little too much of a stretch today to encode um values and principles into it um we you talked last week about the book power and prediction I think we all very familiar with the book and I think that the central point of the book that decision making and inherent in that decision making are the values and encoded in that decision um must remain a fundamentally human endeavor I think we agree on that yeah that's the um there's a famous it was in the 1970s or maybe 8 it was a famous IBM uh presentation that basically said that um computers can't be held accountable therefore computer can never make a business decision and that was pretty pressent right and we're still CH challenged with that today so just substitute computer for AI um is that something you worry",
        "about people shortcutting it and just",
        "saying well it's it's it's creating these great predictions so why don't you just follow through the prediction why not just pick that stock why not just you know buy that gas when the price is at a certain level why do we need a human in the loop",
        "um and that that makes me worry that are we eliminating the responsible party like who's responsible then I think that's a battle that you have to constantly fight um I think it's ultimately up to the people who deploy AI systems to ensure that the human in the loop is a meaningful human in the loop um in the government when we deploy AI systems for for Cil servants to use we really have only two principles right number one do not type things that you're not supposed to type into it because of data don't tell it things it's not supposed to know you don't know where you are not alive yeah you don't know where the the the your prompts go to I mean I think there are different security classifications and therefore different questions of uh residency requirements for AI system so I think that's a very clear principle but the other more relevant principle here is ultimately you remain responsible right you cannot blame the system for any of its output the human remains responsible and oh interesting so it's actually I mean we been quite public about it two simple principles I think that has been guiding the way we use so at some point though the manufacturer does has liability too you would expect um it depends on the the the nuances of the system right so I think the use of LMS in generating emails for uh for customer service reply oh yeah it's quite different from uh the use of AI in a self-driving vehicle it's quite different from the use in the healthcare application I don't think you can get general principles the degree of humans in the loop would differ um we generally believe that because it's so sector specific because the benefits and the costs defer by use case it's not something that you can have broad-based horizontal regulations on it needs to be something that individual um Regulators",
        "Ministries look after so so we're we're touching on briefly and and I might have hinted at this yesterday was um Eugene C uh not Eugene kaspers why am I saying that Gary Kasparov um yeah famously lost",
        "to deep blue IBM by just deep blue just brute forced um quite efficiently right",
        "all the chess moves and uh and instead of being frustrated and leaving",
        "um Gary was intrigued and he continued",
        "and he became um quite an Enthusiast of working with computers in chess and he worked with other Grand Masters and other chess players and working with uh chess computers and over time what they realized was that a computer can always beat a human in chess but a human with a computer can always beat a computer in chess and so the most interesting Edge",
        "in chess was a person in a computer battling a person in a computer and that gave him hope and insight that what he figured would happen in the future with AI was that the best outcomes would be human plus computer um and so now we're down the road a little bit right are you starting to see that or or is that in part of the thinking or is it too soon no we certainly that believe so um so we've said it my Minister has said it very publicly that ultimately it is the AI human combination that is most powerful Vis either either another human or AI system by itself because there are unique um complementarities that you can",
        "get from a better prediction machine and a better decision-making machine the goal of course is to make sure that we prepare the systems and the human beings to get to that stage and that's not easy right you want to make sure that machines reach a stage that they are amable to human inputs and and with the right ux for example right with the right context in that but you also need to prepare a population to feel that they are not left behind that you can bring the population along and that extends all the way to a very disparate diverse population um and you need to do that for for all the way from your your little kids to the midcareer worker who feels a little treed and and I think that's what we need to do it's like I think Yahoo was was the group that I think it was Yahoo who invented the breadcrumbs the dot dot dot on the UI yeah you know and then I forget who invented the hamburger you know the pull down menu I'm really curious to see what other the UI hints that are going to be with AI right how does an AI data presented like work interface with a human you know um yeah so I I think know that's is important um I think there will be Norms that will be created globally and I think we all understand these dot dot dots but I think even as we test out different systems we can't wait for these Global Norms to um we we need to test different uxes to make the human feel that you can't completely rely on the system that you have agency and that you have a role to play is there a um or in in from where you're sitting the in in the early internet days there was this rule that was uh mostly for Network Engineers but it was basically as they were writing these rfc's and in protocols it was be very strict in what you send but be very liberal in what you accept and this is how we get interoperable systems are there any sort of basic rules like be strict in what you train on or liberal in what you train on and strict in what you interpret like are are there comparable Concepts that's a good question um I think we have to start looking at AI more broadly than generative Ai and a model right I I think if you look at an AI system right it needs to then Encompass both generative models and discriminative models it includes",
        "various formal verification protections around it I I think um and I suspect where the equivalent rule is um you may have to let and this is all disputed and it's not clear whether this will actually happen but my instinct my personal instinct is that while we will try our best to understand and ground a model whether show mechanical mechanical",
        "interpretability or other means to understand your trillon parameter model I think there will be an inherent limit to that right ultimately the way to ensure a safe system is to um let the AI come out with its own predictions but then wrap it around with with safety right so you treat the food system not just as the neuron network but also the the systems that protected around it that's got got the outputs of your system and then they would alert you or somehow like hey bumping into the rails too much or just say come out with your hypothesis and then we'll check it right it's in some ways and I I'm careful about using this analogy there is a left brain and a right brain in your head right there is a part of your brain that is creative but it's always checked with logic right and I think the interplay between creativity and logic um is not really left brain right brain but that interplay between an exploratory path but checked with logic I is something that you'll see more increasingly moving forward yeah so that was my question is can ai ai be safe or is what you're you get confidence levels because nothing in life is really safe right there's always mistakes but I'm just worried that these incredibly complex systems if they're non deterministic it's going to be kind of hard to understand when they're failing or what their failure modes are or how do you design around an unknown failure mode um so I mean that's going to be half the excitement yeah I think it would be interesting it depends again on use cases right for some use cases you're very happy for AI to generate interesting poems Etc but if you are using it to design a cyber safe secure system and generating code you want to find ways to check your code right right and I think and then the interplay of what you leave to the llm versus what do you do checks U logical checks around it I think that's how you ensure safety I don't think you can get safety inherently by using the so I want to ask the audience uh show of hands who here thinks that in couple couple of years it'll be essentially impossible to distinguish between a deep fake photograph and a real",
        "photograph right impossible uh possible to distinguish between generated voice and real",
        "voice right uh generated writing in real",
        "writing from someone if you yeah so what does it mean to be human like what is your identity in that situation um and I mean more of like as an identity provider right like you're trying to authenticate a human um and I'm always fascinated by these questions because you know my one of my favorite movies back in the day Blade Runner and later on Ghost in the Shell and they're all grappling with what does it mean to be human in these highly you know artificial environments and I'm just",
        "curious singpass Singapore is highly government servicers delivered here it really requires a lot there's a lot of identity uh questions rais what do you what do you do when you look at it and you go okay can't trust video can't trust audio can't trust void can't trust written like you better show up in person then right so that's a great question I mean especially we all know this is the election the year of many many elections Year of disinformation Miss yeah and I I do think that if left unchecked the the general sense of trust and information will decrease and much needs to be done about that but the solutions I think that there fortunately is a wide range of Explorations whether about the op and your your iris World coin type um efforts or whether it then presents a role for governments to be the arit of what identity is I I do think that these questions will come to the fall a lot more and we need efforts to do that precisely because you're not going to be able to otherwise distinguish between a machine and a human but I do see a good thing out of all this right and I mean try to be positive in general um and I I suspect this whole conversation around AI will force Society to Grapple with the question of what it really means to be human and I think that's a good conversation to have and",
        "yeah I think um let's talk a little bit about the promise right so here's the big framing what's the promise of AI is essentially faster better more more",
        "creative like taking the humans out of doing the repetitive tasks and the things that we don't do very well right I don't look at thousands of log files very effectively like no give me a robot like I want a robot to do that um I don't mind if I get replaced by a robot doing that or a Spam analysis like is this a fishing but I would get really bothered if I was supplanted in a in a uniquely human decision-making role um",
        "so so when you're looking at it or or your strategy and you're thinking immediate benefits right where can you apply this how is it being used um we we've heard from some talks where it's summarization it's rule creation it seems like we're at the very early stages of the lowest hanging fruit but we know it's going somewhere else we don't know where but we know it's it's going this is the beginning right we're building the building blocks do you look forward do you do you get questions from government agencies that say no I just need to I need better transcription I need better note taking I need uh I need to attract new talent and new Talent expects that I have an AI assist so we need an AI assistant or else I can't hire or retain employees",
        "like what is the big benefit that you're seeing from from a government perspective maybe not from a Microsoft perspective I mean we we don't know what the long-term future will hold yeah but I do think that it we need to approach this both with an eye on the short term and the long term right there's no point just dealing with the short term and then get getting too caught up into it but not preparing for the long term but there's no point talking theoretically about the longterm either so our general approach has been to experiment experiment so that um as uh we we know we we understand what this is about we know how to regulate it better you also then build confidence in both your population at large as well as your C civil servants in using AI right I think that there's a part about habit formation and confidence um and discernment that that doesn't come naturally if you don't play wrong with the Technologies right and playing around with it also gives you a sense of what it limitations are and what the potential is but at the same time what you are doing that you want to recognize that ultimately what you see today is just the start right and to have more longer term effects it requires systemic changes requires changes to policies it requires system redesign and I think having the initial experiments forces us to Grapple with those questions as a country we tend to be a very Divine discontent country right we we always want to do better we see something or happy with it but very soon after the question is what's next and I think that that concept iteration between testing something out at the same time figuring what are the blockers to do something even bigger um will always be there and I think that's a good what's the um you know coming from America I sort of just take it for granted data centers everywhere unlimited power from Hydro or solar but you're much more kind of space constrained here and there's there's a bit of a joke that that there's three AI companies and then there's like 3,000 AI companies trying to be bought by the three AI companies um",
        "there's also some talk about the reason why generative AI arrived five to 10 years sooner than what many people were predicting is that Microsoft put a billion dollars in compute behind it and so people knew that there may be these thresholds nobody knew where the threshold was nobody knew and then all of a sudden you had unlimited compute and then all of a sudden we started finding the thresholds for building these models so had Microsoft not poured a billion dollars behind it we might be still years behind slowly so now that we know sort of these compute thresholds um does that mean that there sort of that's the bar to entry for large models and since certain countries can't be that big or don't have those kind of resources there's going to be like the halves and Have Nots or the large model owners and the medium and small model like how does that how do you look at that do you say oh no that's a national uh concern or is it no we'll just we'll just rent time on those large models that we tend to be very pragmatic country um I think to the extent that we can use these large models I think we will continue to do so but we also very cognizant that model sizes have gone down they are increasingly decently performing models that can be operated on your laptop if not your phone we certainly looking at those um especially if you're looking at um fine-tune models for Enterprises I think um those are the kinds of models that we will be we are experimenting with and I think not just we as a government but as a society as different as different companies uh in in in the country so you think that billion dollar Advantage will fade as more efficiency comes in or as people understand it more it's hard to predict I obviously the open a of the world will continue building a big model and I think that's helpful that's good for General um innovation in in the world but while we continue to use that you also want to explore other models and I think we we'll hatch on both sides yeah um and so",
        "uh we've got uh what 20 six minutes left I'm going to ask you a couple more questions and we're going to go to the audio I have questions for you too oh yeah ask questions yeah so I mean in your wonderful position Jeff in is founder of blackhead I think I do want to hear your views of how given the developments in the field how science and Society could really collaborate with each other yeah I think so when I that collaboration that comes to mind right now is more the government I guess in the United States DARPA uh and some others funding AI research",
        "um if AI can translate from English to French maybe it can translate from an insecure language to a more secure language that seems to be where the research is right it's and then you find companies spent five six seven years writing tool chains to try to figure out where in their 10 million lines of code what are the riskiest lines of code like where do we handle identity where do we handle authentication tokens and um and",
        "so it turns out that's one or 2% of the the code okay so we can scope down to that and then Can We R AI informed models against risky code patterns or suggest re and and I think part of it is um the benefit is going to be and and I heard this from some hyperscalers which was today I would take my three most senior software security Engineers Architects and we're doing something with authentication and it's online and it's really important and they'd grind on it for a month or two to get it just right right because it can't be wrong if it's wrong it's you know business",
        "ending but with rust I can put a junior developer on it and he can be done with it in a few days because you can't screw up the things that they need those senior you know Engineers that understand memory def referencing and um",
        "it's like I don't want to put my three best most expensive people on password management like they need to be designing the next generation of product the company right but the the the code's gotten so unmanageable with you know the memory safety and so I think that's where maybe you'll see a big benefit initially and I think Society or at least governments around the world are starting to say it's untenable the the memory unsafe code and",
        "before two years ago there wasn't really a pathway to like well rewrite like you're not getting people to rewrite code AI all of a sudden offers a pathway to a large chunk of of rewrite or analysis and I think two years ago people weren't ready for that and now they they governments see that as oh we could potentially regulate because now there are tools and in a year or two from now I think it'll be much more widespread so just just to put a Cav that some of the rewrites are wrong yeah the re are right and so you'll still need a human right you'll still need unit tests you'll still need all this stuff but now the boring easy to rewrite stuff can be done in bulk and then just free up for the most interesting bits right um and once the models get trained on those rewrites yeah they'll get better they'll get better and better and better yeah but I think what you said earlier about the unit test remaining important I think that's critical and that's the broader system that that I talk about earlier right so you need to make sure that there is a way to ensure that whatever output is from the system is tested by by traditional methods by traditional methods yeah I don't think you can run away from that yeah and so so I wonder or I worry um about data sort of data tampering of models and poisoning and I know governments have been worried about their models being poisoned there studies that show 0.003% of a model is enough change is enough to change the outcome of a model how do you detect the model you know so in the adversary space there's a lot of concern about this um and there's even talk u i I've heard from people that either starting businesses or their existing businesses trying trying to freeze everything on the internet from about 2 years ago before generative models really took off cuz they want a canonical like known good Archive of the internet before everybody fed on each other um so they have good because you don't want to train your model necessarily today on Google search results but you would from you know a couple years ago be much better less SEO and so is that kind of generative cesspool",
        "is there a way out like it gets to some point and then and then you can escape you can learn okay this is why all my search results on Google start looking the same because they have all optimized to the same incentive model um but at some point we get beyond that or is it like face and voice no we'll never be able to optimize out of an AI getting top",
        "ranking we'll never be able to optimize out of you know I I don't make predictions I have no idea you're not a prediction engine I'm not a prediction engine that's not where I'm good at but I do think that we have to Grapple with these challenges I don't think you can run away from that I I do think too that um we we don't give humans enough credit for their ability to adapt I do think that if you prepare societies well enough they are more adaptable than than we give ourselves credit for yeah it's probably easier to make a human adapt than for a system to adapt just because there's so much Legacy this is the sa thing right your company uh sap does not adapt to your company your company adapts to sap right so so this is the same thing with AI right we'll learn how to live with AI it doesn't have to learn how to live with us I I mean I I do think there is agency in that I do think that societies make decisions and how you deal with AI and I do think that that we continue to make sure that there is a nice good balance between getting AI companies to conform to societal Norms versus just adapting",
        "ski and and before we go to the questions",
        "um I I want to get your your input on this idea so before AI or generative AI was so popular there was this uh a lot of talk and security over the last I don't know 20 years the UDA Loop right Orient observe decide act the it was automated reverse engineering and it was an a patch would come out for Microsoft within two days it would be an exploit right they reverse code they try to figure out what code has changed they try to understand and then it was one day then it was you know then it was hours and one of the things we would track is how long would it take for an adversary or somebody to reverse y from a patch but now it's essentially almost you know minutes yep you know um and so",
        "in that case the feedback loop is accelerated right so the model can learn faster and so in an attacking offense model if the model is get a shell when you get a shell you get that feedback signal ah I succeeded right but on the defense side there's not a good signal that says I defended I defended I defended so I always worry that the offense models have better feedback loops so they'll always adapt faster where the defense models what what is my defense signal I blocked and login attempt you know is it a memory crash but was the memory you know crash dump caused by an attack or and so I'm curious like these feedback",
        "Cycles are probably good for training but not everything produces a feedback a clear signal y so that means there's a bias toward the types of things that produce signals will be more efficient um and I haven't thought through from a societal perspective but are there certain things then that it just means this is better for um Computing questions or societal",
        "questions right it's a good question I I do think that points to two actions that we could take the first of course is I mean not just speaking about cyber security but I guess you are really anal analogizing this one is of course better monitoring right of defensive systems right I think investing in monitoring so that you can enable a feedback loop is something that I think is useful the other thing is that adversarial attacks don't have to come from True adversaries right you can simulate that you can incentivize um folks to test your systems and then generate these types of General evero networks internally before you ever you Expos it to right like your your operating system comes pre-trained with a attack model 12.4 or whatever I think that's I think that would be important moving forward that's interesting so future it's not antivirus you're you're getting updated attack models maybe you need to I think you need to protect I'd like 10% of that idea okay from anybody who starts that",
        "business all right let's move on to the audience the way it works is we have a microphone on each side if you've got a question just say Who You Are uh maybe who you work for and ask a question as opposed to maybe making many statements and we'll do our best to uh to answer that and if we don't get any questions we'll continue uh our conversation so I want to have some coffee and yeah please ask",
        "question I got this",
        "too good morning again hey good morning um so my question is we've talked about it before but but um there was a part right first who are you oh I'm Kelsey sorry Hi um we talked about it where um",
        "I think it was mentioned where uh humans are very adaptable right and I think we've seen that you know past 100 years past 50 years even heck in the past like two years right but um is there a point",
        "where you think there or I should say has it been a thought where um emerging em emerging Technologies",
        "should be put on hold in order to see the impact both negative and positive maybe in terms of like ergonomics human design identity all these things that we've talked about",
        "um just in the fact that like you know when you're a teenager you're like ooh We're Young we can do all these things and then when you get older you're like maybe some of those things weren't so good ideas right so has it ever been a conversation where you're like wait what are some of these consequences because sure some things are good shortterm but uh what about long-term sort of",
        "Technologies this is the uh can you put the toothpaste back in the tube and so I think I like this philosophical question",
        "yeah but it I think it's a practical impossibility because I think people know math and anybody can create these models it's just a question of maybe how much compute you have or resources and so if if America says oh we're pausing to explore human rights aspects and Argentina is like well no we're racing forward um I I I don't think you can hit the pause button um which worries me but it's",
        "unlike you can just we'll just ground The Airliner until we understand you know the impacts of the new material technology it's like I don't think that's possible um yeah and that's why I'm glad I don't don't have to make these decisions Chief AI",
        "officer I think it' be very difficult I agree with you Jeff but I do think that there are enough people around the world who are concerned about it um that I mean um that I think their efforts and conversations around this um so I sit on the United Nations high level advisory body I think a lot of the questions are around how do you ensure International governance framework around AI um I think that that will be something that is not going to be done by any one country definitely not by a small country like Singapore But ultimately I think there there needs to be Global consensus if you wanted to make any meaningful steps here um and that and I think that's an ongoing conversation it's a very difficult one as Jeff says because incentives may not always be align but I think that's that's a worthy effort um the other part I thought was important and um that that your question triggered was I do think that there is a important um role that we need to collectively play about encouraging humans to be adaptable is not something that is going to be given um especially in many parts of the world where access to technologies have always laed behind the people who are ahead will always benefit more than those that have not had basic access to digitization that own Ai and I do think that that conversation is important that's about International collaboration that's about capacity building and I think that's this is the question too about um when change happens too quickly it stresses a lot of people out um and so we know we're going to be entering a era really rapid change in Innovation and so I I would expect from a governmental perspective you need to prepare your population to start thinking about you know adaptability and resilience um and",
        "Singapore is also doing a lot of work around the region so we're working with the rest of asan to figure out what meaningful uh governance standards uh we recently published an Asam guide um for governance for AI I think earlier in January I think those multinational efforts are also important perfect thank you so much so I I've got a trick question for you what is AI versus ml versus statistical",
        "inference versus like you know I'm sure the experts know yeah but when you're at the UN do they know when you're talking to a minister do they know like how do you target your language to your audience to remain precise and get your meaning across but also stay true to the actual meaning of yeah so that's a good question I think I think fortunately in Singapore we have been very fortunate to have quite a technocratic country um and that extends from the political leadership all the way through Society we famously do very well in our Secondary School Math and Science comparisons around the world so I think that helps um but I I and but I do think I do take a general Point um at the UN of course there are different levels of conversations um but you want to but to be fair there are also quite technocratic people across the world I think that's important important a lot a lot of this is also education um and and I think that's part of it if you if a person has never been exposed to regression models data science it's going to be difficult right um but hey uh I think you want to be truthful but you also want to use the hype when you can to encourage action right",
        "yeah okay let's see any other questions come on okay here's a gentleman on the on my",
        "right hi I'm MRA so my question is in security there is no room for error but in AI you cannot be 100% accurate all the ways so how do we balance this like if I come and give you a model an a model with 95% accuracy say would you be would you like to uh deploy that in your cyber security space uh or how much accuracy should an AI model have to be deployed in a security space and what do you do about that rest fer",
        "5% so I don't know of any defensive",
        "technology necessarily that's 100% yeah you know and so defense and depth I hate hate saying that because I prefer to eliminate I don't like having you know uncertainty in all these layers but I think it's uh it's whether your model is 90% accurate if it's 90% accurate really",
        "really fast and it's the doorway to your network great then right I I free up the humans and my other tools to focus on the remaining 10% so I wouldn't I wouldn't make that number the determinant of whether it's good or bad um if that makes sense especially if it's solving a hard to solve problem okay yeah I mean we also have to constantly remind ourselves that humans make mistakes too humans are nowhere near 100% either and we have found a ways for important systems to to deal with human abilities there's this um who",
        "everybody knows uh capture systems um there's I forget the the popular one but there's there's H capture yeah is one I use uh we run a a mastodon server and so we were getting some spam so we turned on H capture for signups for our madon server and uh you know spam we still get spam signups we get fewer of them so then I started well what is this protecting me against and I started looking up efficiency rate of spam I mean of captas versus Humans yeah and I",
        "think H capture Bots can defeat it 99% of the time and the other ones they can defeat 100% of the time so I'm I'm getting 1% less potential spam signup uh humans can only Solve IT 77% of the time yeah so",
        "okay it's so efficient the Bots are so efficient that they've blown past the humans right and so I I worry that we're actually the antibot technology is actually keeping the humans away from signing",
        "up just one more question so AI for Content generation is like uh on top of the world now like you can create images videos whatever but AI in security like you were talking about AI to correct incorrect code uh block the vulnerabilities in the code and all that the research with in in this space at least if if you see a for natural language processing you have like 100 llms now but an llm to make your code secure like you can count on your fingers so why is this Gap like uh you",
        "you your your security should be your topmost priority but why llms or AI in",
        "general uh research about this is lacking behind the AI for Content",
        "generation do you want to do that first or all yeah I I think these are I mean AI for for cyber security is an inherently difficult question right I mean because of the expectations a lot higher I don't think it's true a month of trying uh I just read a clar banner paper from few months ago about formal verification of AI systems uh of computer systems and I and AI helping with that effort I don't think people are trying very hard to make it safe um I yeah but obviously it seems at least easier or the incentives may be there for to generate a cat image rather than to create a a a provably safe AI system",
        "there's the way it was described to me when I was asking a similar question to a to an expert and they said well it's a it's a land grab yeah and so what's happening is um the in their perspective",
        "why there's unlimited money right now in AI is because it's a Greenfield opportunity it's a land grab Winner Takes all sort of scenario if the the premise of billion dollar compute is necessary right if it gets if the barrier to entry is less then then maybe that's not so but right now it's it's perceived is a land grab and what's happening is if Google you go to Google and you say show me a picture of a you know a cool Ferrari and it ranks it and it's guessing its model is saying my best guess is number one my best guess is number two and you as the user pick number five and their AI model is like what just happened gave them my best I thought number one was the best it's number five I retrained myself right so Google is learning when you select and it's learning hundreds of millions of times a day right and then Bing comes along and let's say Bing comes along 10 years later and they're getting a hundredth of the traffic and Bing says here's my 10 best guesses of the cool car right Bing is getting trained at a",
        "millionth or billionth of the rate of the Google so a day in the life of Google is like how many years in the life of Bing right how will Bing ever catch up and that mentality is sort of infected investors who are like get all the data now right buy all the compute now because a one week delay a one- month delay could be like years and will never catch up and so I think that infection that race to seize territory",
        "right is what we're seeing right now on the business side right that's why everybody's rewriting their terms of use to say we can train on everything we can train on comments we can train on your images everybody's running from training data because they know somebody else is and if you don't train and you're a month late to training then you may as well maybe never never even show up you see this in consumer Technologies in general so you were analogizing it for search many years ago you even see it in something like R healing right getting more drivers and getting more and you're getting a better feedback so I do think that's why like a network effecta any network effects yeah so I think there's a bit of that going on behind the scene and if generative is generating the interest in the investment fine yeah do more of that until we sees more territory or um I",
        "think what's going to be a limiting function on that is all this stuff is going to get litigated in court like Disney and movie studios nobody is happy that all their data copyright trademark data is being trained on like it's commercial theft on a mass scale of intellectual property and until it gets litigated out it's a free-for-all right um and and and there's this one meme online I don't fully I don't really agree with it fully but it it's it it points to the sentiment which is sort of like if if buying isn't owning then copying isn't",
        "stealing right so if I copy one movie the movie still exist exists right P this is the piracy argument right if I if I copy the movie movie still exists right I haven't taken any value away but if I take a copy of every movie you have I train my model on it and then I sell you a subscription to access my model that was trained on their data maybe that is theft it's different it's different in nature than me copying a movie and watching it right now I have a business model based on their somebody else's data and I think that's we're in a bit of this free-for-all land grab land grab because there are no legal rules really around this yet but in a couple of years there will be I also add to in response that that these are General Technologies right so some of the developments that you get on the very consumer facing work we spill over to other applications whether it's Enterprise whether it's uh better software so yeah thank",
        "you hey we have time for one more question",
        "this microphone on this side's on fire everybody on the side yes hi good morning my name is Michael Wong I just want to ask uh in the book of 1984 slogan big brother is watching you let's say moving forward 60 years later 2084 would he be the AI is watching you so what is the point of view in AI surveillance and privacy wait that last part is so then what's the what is the point of view in AI surveillance and PR see what's the point of it a why saw point of view oh oh point of view point of view um I think so video analytics um super",
        "powerful um and it was initially deployed on things like um left object detection yeah right so um somebody's in",
        "airport they leave their bag the system will be like there's not supposed to be a bag there send the security to go check it out right or at a concert or whatever Lost Child detection crowding detection right like there's not supposed to be 50 people crowded around a door something's going on right smoke detection all these life safety features through video analytics",
        "great safer environments for all of us right but then when it gets taken to the extreme that's where I start start",
        "worrying um I think again it's used as a filtration normally when I see it it's um so I got a tour of a a casino in Vegas and I got a tour of their their uh surveillance room and this is where they look for cheats and um everybody they hire um",
        "have photographic memory for human faces and these are the people that are looking for known cheats it's backed up by AI facial recognition systems that try to identify and track everybody and movement of everybody but at the end of the day it's still people right the AI system is a filtration it's a head up it's heads up it's a warning but again it's a the tie between the machine and the person to detect cuz the the fraud schemes are pretty inherently clever um and the AI system is maybe not going to detect it um from a dystopian future I think that's the character of the country so you can have a country with no cameras that is pretty freaking dystopian right Stacey Germany um or you could have a hypermodern country with a million cameras that's not um and so I don't dwell so much on the technology I dwell on the character of of the country and the government governance and and it can go backwards right you could have a revolution in a country full of technology and they could rip out all the technology and and you know change their way so the technology doesn't necessarily guarantee the successful repression of a population either yeah it goes back to what we started the hour with and I think that's a good place to round up which is ultimately this is a neutral technology ultimately expresses the values of the countries and the cultural context that you are in and then that that that determines a lot about how technology is FAL for good or not so good yeah and so I think in the future you'll end up having technology generated from kind of both sides represented representing different cultural norms and so um I'm",
        "not running and hiding in the woods but I definitely am paying attention to seeing how this stuff is deployed",
        "um all right well we're out of time thank you very much thank you"
    ],
    "vqBC_WtDc6Q": [
        "hello everyone Welcome to our talk Ling door hidden attack service in the Android nink kernel",
        "modules uh in this talk we will discuss the nink attack service buried deep in the Android",
        "ecosystem uh first of all let me introduce ourselves we all confirm by do aot security team",
        "I'm cha I focus on the Android and Linux B hunting and exploit it and have",
        "already found more than 100 vulnerabilities in the last eight",
        "months uh you moreing n kernel C medium",
        "Tech and so on H is more interested in I",
        "iot and platform",
        "security he was a blackhead USA speaker",
        "team sh is our leader he focus on the system and the software Security Solutions and there was a pack and the HB",
        "speaker uh okay next we will first introduce the concept of n link you will learn what the net link is in this section and then we will analyze the attack surface of n link you will understand the underlying principles behind the formation of of net link",
        "vulnerabilities uh next we will show you four typical vulnerabilities scenarios",
        "you will get the vulnerability mly methologies in the real world after that the POC template and solutions to Common vulnerability verification programs will be given",
        "finally we will provider vendors with some security suggestions for",
        "customizing Network that",
        "link uh okay let's start with uh the",
        "introduction uh so what are the local attack services in the Linux kernel the possible answer may be operations such as our controller read right uh device files system files process files and so",
        "on uh but today we will introduce a commonly overlooked tag service nni",
        "the link is often described as an out control out controller replacement which",
        "meanly used for bidirectional communication between the kernel and the user space processes uh cly communication between",
        "user space processes is also applicable",
        "that link has some features that are different from our controller such as for duplex asron and the multicast just",
        "like the finger",
        "below uh we divider thenni into two",
        "categories according to its usage classic n and generic n as sh in",
        "the right finger the generic partical ID",
        "is",
        "16",
        "okay is 16 and uh uh the others are",
        "classic nink",
        "IDs classic nink socket or nink socket",
        "is spot eer since 1999 with Linux",
        "2.2 as shown in the following finger it is a socket family so it's user space programming model uses the Linux socket",
        "API due to the feature of for duplex communication n transform has two",
        "directions top down and the Buton up uh",
        "in the left finger we can see the land link kernel create function will register the input function the input function is to pass the message received from user space it receives H SKB as the",
        "input parameter uh the SKB contains the",
        "N link transform",
        "message uh in the right finger the message unic or message multic function",
        "is to send the building message to user space okay uh the programming model of",
        "classic seems to be perfect but why was",
        "generic n introduced later let's take a",
        "look at the classic n kernel registration function n kernel",
        "create uh in the right figure uh it's the second parameter is unit uh which",
        "represents the N protal ID if we want to",
        "custom customize a classic nni we need",
        "to add a new protal ID in the Linux kernel the maximum number of partical ID",
        "is 32 and the kernel has already occupied 22 so the kernel Lees only 10 for customized usage of course",
        "we can enight the max ninks but this doesn't seem a good idea in addition classic nni is more complex to use because it requires passing the net link message by ourselves the passing mro in",
        "the wrer Buton",
        "figure uh therefore the generic n come",
        "into it exence exence",
        "okay uh generic link soet is spoted",
        "since 2006 with Linux",
        "2.6.5 all the customized usage can share",
        "a single partical id16 when passing the",
        "user space messages uh we only need to focus on the payload also KNN as",
        "attributes in the left",
        "finger uh we can see that the junior register family function will register",
        "the Ops and small Ops the difference between them is that the small Ops provides few messure handling functions and is simpar uh both Ops and small Ops",
        "uh contain the do it function uh the do it function is to pass the attributes received from user space uh it receives a SKB and an infer",
        "as the input parameters uh the info contains the user payload or attributes",
        "in the right finger four functions is to send the building attributes to user",
        "space okay after introducing the Net linkers usage let's analyze that attack surface in",
        "deeps uh first of all let's take a look at the nink architecture in user space",
        "and application can directly call or indirectly use liver and a to call the",
        "Linux socket API to send the net link message to the kernel",
        "space uh after receiving the message the",
        "kernel will root it to the N Linker sub system uh the N the sub system will handle it according to its usage category next we we will focus on the messenger handling me using of the Linux",
        "sub",
        "system a classic nink Transformer May",
        "consists of multiple net link messages",
        "you can see it uh in the first line each message contains a net link message header uh use payload and the pendings",
        "uh the head size and payload size should be four byes andl the M mure header",
        "structure contains consists of five Fields message lens content type",
        "additional Flag sequence number and the process Port",
        "ID uh the message lens is the total size of a then link message the port ID is usually set to the process",
        "ID and the classic nink transform messager is sent from user space to k space by send to or send message function the SKB will contain the transform messager it is an input parameter of the input function the",
        "input function registered by n kernel",
        "create function where pass this transform message we can get the transform message from the xb's",
        "data uh the question is uh what checks do the nin kernal net link subsystem do on the transfer message the answer is",
        "chei uh what which means we need to check the land link message Header by ourselves uh it is a dangerous be Behavior to leave the checking to the",
        "developers uh so uh how should we securely pass the top down transform message not knowing the attack not knowing the defenses uh we summarize the three possible attack vectors the first is the developers don't have a create understanding of the relationship between skb's",
        "lens message lens and message head lens",
        "mro so they don't do any checks at",
        "all uh the SK SKB is transform mes total",
        "size it may consist of multiple ning",
        "messages lens",
        "uh the is messager length is one",
        "messager total size the message header",
        "header lens macro is one messageer header size it is a fixed",
        "value um a convenient way is that we can",
        "do those checks by the message okay macro the second attack Vector is the Developers start passing the payload",
        "structure without checking the payload lens and the third attack Vector is the developers don't fully check the validity of the payload",
        "content uh in contrast do uh how do we attack the building of classic nck masser ascending to user space all we think we can think of is combining it with other kernel attack surfaces such as find operations socket and so on we",
        "can reverse deduce The Source through the Classic nni Building message and",
        "then we do we can do vulnerability",
        "Ming after analyzing the attex surface",
        "of classic neic let's continue continue to analyze the generic n",
        "link the first for the message format of generic gener nni is as shown in the finger below we can see that the generic nni is created based on classic n",
        "because the uh General message format is the same you can see the first",
        "line the difference is that the payload composition uh which contains a generic n message header a family header uh attributes and the pending each attribute contains a n link attribute header and attribute payload and z",
        "pendings uh the family header is optional and customized so let's focus on the generic Ling mess header and attribute header",
        "the junior mure header structure con consists of three Fields a commander",
        "version and reserved the commander field will instruct the current to call which do it function the M attribute structure",
        "consists of two Fields then link attribute lens and the type together with the attribute payload they form the tlv structure the net link attribute",
        "length is the total size of an attribute including the size of net link attribute header the N link attribute type is the index of attributes are",
        "real uh the generic Nal transform Messer is also sent from us space to con Space by send to our send message function uh the info will contain the transfer",
        "message it is an input parameter of the do it function the do it function registered by genor reest reest Family",
        "Function where pass this transform message we can get the transform message from the inverse attributes",
        "field uh the same question is what checks does the N kernal net subsystem",
        "do on the attributes the answer is uh",
        "check by n",
        "policy the N policy namely n attribute",
        "policy is registered in the junior",
        "family structure or Junior Ops uh structure the junior Ops uh policy Tes takes",
        "precedence over the junior family's policy we can see uh the N policy",
        "contains an attribute type lens uh Union",
        "and so on the attribute type here uh is the data type of the attribute pad the length has different means depend on the attribute type for example if the the type is n string the length is the",
        "maximum L of the attribute payload the",
        "union is also used to check the validity based on validation",
        "type all checks on the attributes I down in the validator",
        "function uh so and does the top down generic land link transform maure passing have no security issues of course not uh let's take a look at some attack Victors due to developer oversight uh the first is that the developers neither don't set a policy at all or set a set an increate uh policy",
        "during the policy uh registration phase",
        "the second the second attack vctor is the developers uh don't check if the attribute is long during the attrib",
        "passing fees uh the third one is uh developers don't fully check the",
        "validate validity of the attribute P contain during the attributes passing",
        "phase uh in contrast how do we attack the building of generic ning messager",
        "send send to user space same with class classic nni we can combine it with other colal attack surfaces such as fire so",
        "and so on we can reversely deduce The Source through the generic nink building message and then do vulnerability",
        "Mary uh okay uh from the preview section we can conclude that both classic and generic nni have some possible security",
        "three uh now let's take a look at some typical Le vulnerability scenarios in the real",
        "world okay uh based on the attack service we uh",
        "investigated uh nink related Cel modules",
        "from four wellknown vendors and",
        "discovered 138 vulnerabilities and",
        "obtained 19 cvds um all the",
        "vulnerabilities have have been fixed by",
        "vendors uh in the left finger we can see that there are more vulnerabilities",
        "related related to Classic n and Zi also",
        "more several it suggests that we should",
        "consider using generic n for",
        "customization instead of classic n in",
        "the right finger we can see that both the upstream and downstream kernel may have vulnerabilities uh but the downstream kernel is more likely to generate netlink related",
        "vulnerabilities uh let's take a look at the first case the first case is attacking the passing of classic n",
        "message uh in this scenario the classic",
        "message is sent is sent to Kernel Space by sent to M sent to function uh the kernel will invoke input function to pass in this message as sh in the right finger uh mtk gaug ning Handler function",
        "is registed as the input function by net",
        "L kernel create function uh when receiving a messager it",
        "call mtk uh battery ning Handler",
        "function for further",
        "processing uh the mtk uh battery net link Handler function get get the net link header namely n from skb's data fi",
        "first then it gets the user payload",
        "namely data from the date will be passed into mtk",
        "battery demon Handler function this",
        "function will further pass the payload",
        "content namely message it will mem copy the messages",
        "and fgd date field to another variable",
        "the question is how many security",
        "vulnerabilities exist",
        "here uh based on the attack vectors we",
        "preview we previews",
        "summarized this case has at least two",
        "vulnerabilities the first one is that uh it accesses then link header without",
        "checking the the head lens the second one is that it accesses net link payload without checking the payload lens both vulnerabilities will result in out out",
        "bonds read uh for the second",
        "all all the O read data located in the receive buffer the answer is not",
        "necessar uh there are two ways that may result in O read outside the receive",
        "buffer the first method is calling set",
        "socket option a function to set or",
        "minimize the receive buer size the minim",
        "receive buer size is typically a few kilo bytes uh the second method is carefully",
        "constructing p ps that precisely fills",
        "the receive buffer this can cause the uh outon read data to be the receive buffer",
        "outside just like showing in the right botom",
        "finger the second case is taking the building of a classic n message the vulnerability minding method is transing",
        "the message s sending to user space as shown in the finger below we first locate the message sending function on message unic uh then we can describe the entire",
        "life cycle of this message uh first and",
        "user space process sending uh send uh de",
        "K encrypt dek request to colel space by",
        "our controller",
        "function after receiving the our controller request the kernel allocate a",
        "request and send the request to user Space by mure uni C function uh then it",
        "will wa for the processing result after",
        "receiving the request from the user from",
        "the kernel space the user space process will handle it and send the processing result to the kernel through classic n",
        "link uh the Kel will call input function to cancel the we then the request will be",
        "released uh now we understand the entire process flow uh let's take a look at the implementation of the input",
        "function uh we can see is that before canceling the V uh it will find this",
        "request from the global variable gpub crypto controller and uh copies the",
        "processing result to the request uh the",
        "problem is that the uh request isn't",
        "protected in any way uh which means we may still access this request even if it",
        "has already been deleted released in",
        "another thre finally and use after three",
        "vulnerabilities is",
        "triggered uh this case combines classic nni and our controller function the root cause is a protected the global",
        "variable um the third case is attacking",
        "the passing of generic n inor attributes",
        "kmbd is a Linux kernel server uh which",
        "implements uh SAR 3 partical in kernel",
        "space for sharing files over L Network",
        "in this scenario um the input is uh TCP",
        "request the request will be proceeded by kmbd IPC read function uh the K smbd IPC",
        "read function will call gen message uni C to send a request to user space and then it will with for the response the user space process receives",
        "and handers the request then it will send the response to the kernel by the generic nink uh the kernel will call to it function to cancel the weight then the member copy will be performed uh now we understand the an process flow next's take a look at the implementation of the do it",
        "function the do it function is the implemented as hander generic event",
        "function it will pass the attribute payload and the payload size from the info variable and then call hander",
        "response function the the hander response function will copy the attribute payload to the response and then caner the",
        "WID uh once the WID is considered the kmbd IPC read function will return uh",
        "the response will be passed to the IPC response payloader and is size however",
        "the size of IPC response payloader uh doesn't be checked which mean lead to an O reader occurring in memory copy function uh this case combines generic L and TCP its",
        "root cause is developers don't check the",
        "validity of the attribute payload",
        "contain uh the last case is attacking the building of generic n attributes uh",
        "similar to Classic n the vulnerability",
        "mining method is Ching the attributes sending to user space as sh in the uh fing below uh we first locate the attributes sending function jior message",
        "unit Cur then we can describe the entire life cycle of those attributes as sh in",
        "the left finger firstly um and US space process we send a right request to con Space by right",
        "function then the receiving uh function FP right will be uh handle the writer",
        "request and send the result to user",
        "Space by jior message unest function as",
        "sh in the right",
        "finger uh let's take a look at the request processing function FP",
        "WR uh the header parameter is copied",
        "from the user space the um get date from",
        "MCU function doesn't check the validity",
        "of the lens from the header which may lead to an O read to the haer during memory copy this case",
        "combines generic n and right function as",
        "root CA is developers don't check the validity of the writing",
        "payload okay uh now we have understand",
        "understood the four vulnerability scenario in the real world the question is how do we verify and exploit uh those",
        "vulnerabilities the first thing is verification when we want to trigger a risk condition we often encount The Source part occupation problem uh the",
        "solution is simple neither use the process ID as put in multiprocess or try",
        "uh avable port to bend in multi stre uh the P template of classic n is",
        "sh on the right finger um we need to fill in a message header and payload by",
        "ourselves uh for generic nink in order to verify the vulnerability the first",
        "thing is solve the family ID acquisition",
        "problem because all customer uh customer generic n lers",
        "shares a partical ID 16 they are",
        "distinguished by the family name we can get uh family ID by sending the message on the left finger uh we need to fill in message header Junior message header",
        "and attribute by ourselves the right",
        "finger is the PC template of generic",
        "anic we need to pay attention to three",
        "functions uh jius uh send message function is used to build and send generic net link message uh the junior get family ID function is to get family",
        "ID by calling Junior send send message function the junor receive message",
        "function is used to receive generic ning message",
        "uh how we use and um how we use and um",
        "arbitary read vulnerability and right",
        "worldw vulnerability to obtain privilege",
        "escalation the exploitation is very",
        "simple firstly we use the arbitrary rate",
        "vulnerability to obtain the address of",
        "credential then we can um modify the uh",
        "credential by using the WR whatw",
        "vulnerability last but not least how are",
        "net link related vulnerabilities",
        "mitigated for the androider system we can set the target class net link soet permission by SE Linux",
        "rulers for the Linux platform we can check the capet admin permission by then",
        "iner B",
        "function uh through the ab an analysis",
        "we can can uh conclude that nink is a",
        "hidden attack surface",
        "um buried deep in the Android ecosystem",
        "uh when C customizing classic n the Kel",
        "will do no checks on then messages uh",
        "when we uh customize generic nni the colel will do checks by attribute policy uh generic nni doesn't",
        "uh does more than does more than classic",
        "n but it also introduce uh new secur",
        "secur",
        "reads uh we have also prepared some",
        "suggestions for vendors uh the first one is trying to customization using generic",
        "instead of classic nni uh the second one",
        "is understanding understander um n",
        "mechanism and ipis before using them uh",
        "that's all uh thank you for your listening any question please tell me or you can also contact with me on SP card thank you very much [Applause]"
    ],
    "o_-a-_oqCgU": [
        "okay Welcome to our session so my name is Sandra Pinto I'm associate research professor at the University of minu today with me I have Cristiano uh which is currently doing his PhD under my supervision so this is my third time at black at Asia always a pleasure to be here and the second time for Christian so the title of the talk today is what the Trust on M doesn't see the MCU does grieve over Lessons Learned From assess a microcontroller te so the formal act",
        "this is the agenda for today I will start with a brief introduction just for the motivation and a set of observations then I will hand over to to Cristiano which will discuss the E part of of the work and I will get back uh near the end just to provide some advice and lessons learning and to conclude with uh the final thoughts and the blackhe uh sound bite okay so we are currently living in",
        "this Internet of Things era where the overall idea is to connect every single device to the internet I mean in the past we used to have like these embedded embedded systems which Were Somehow disconnected from the internet but nowadays the trend in many Industries is to connect every device to the internet and for example one one uh one very application at the moment is this AI enable Edge device where you currently are shifting the AI from the cloud to the edge and you we want to protect the IP and from the external hackers and the",
        "attackers well these are just numbers I I I mean this graph here is the first on the left is uh was from arm I do remember when I was at arm techon in 2017 that they released the projections of the cumulative number or anal Productions of iotv device that is expected to reach one trillion by 2035",
        "and uh yeah we this basically states that this trend is going to increase and accelerate the problem is that what we are witnessing is this by connecting uh iot device or device to the internet uh",
        "we have SE or witnessing more and more acts and and attacks we are currently",
        "leaving the age of the Cyber wifire and with that I mean mcus or microcontroller",
        "units which are different from the application uh processors that you use on your mobile device harm is the main designer of these mcus I'm talking about cortech m0 m0 plus M3 M4 and M7 and arm",
        "feel the need of implementing like security mechanism on these MCU uh to basically provide security at scale and that's why arm decide to shift Throne technology that has been around for more than two decades to protect your mobile device from like mobile to this embedded and iot device well as I said arm trone has",
        "been around for more than two decades mostly to protect mobile device I mean you may not be aware but every day if you are using an Android device you are using Android Key Master you are using your fingerprint so you are using TruStone technology and this technology",
        "also been used in tablets and also on on on smart TVs TruStone is centered around the concept of two protection or Mains or or worlds where you have the secure state where you place your security critical applications and then you have your non secure world or the normal world where you put your main operating system I mean if you refer to your mobile device typically you have like your Android which is the rich operating system and then you have uh a te uh that may be in several forms shapes and flavors depends on on on the vendor uh which embeded security critical",
        "applications well and as I said arm shift Tron technology from this mobile device to these MCU uh and the new generation of Cortex M which are the r v8m corex M23 m33 already embeded this",
        "technology in its core so for those who are familiar with these rv6 rv7 architector I mean cortex m0 M3 and M4 you typically have two processors mot Tre and TR and Handler you have two privilege levels and privileg and privilege which means that at the end of the day you have three based privilege levels unprivileged thread privilege thread and privilege Handler well",
        "basically with trone what I'm did was to create this orthogonal world where you basically replicate by two and at the end of the day you have this completely replica of of the privileged State on the non-secure side on an unsecure State and also on the secure State and basically what arm did comparing to the cortex implementation of thrust on was to optimize like the contest switch",
        "basically for this res resource constraint device for example you don't have any more the secure monitor which has been used to basically interface between non-secure State and secure State well in terms of memory Access",
        "Control while in th on a you typically add like the thust on dpace controller or a memory controller at the platform level on on rv8 M you have controllers",
        "which are called secure attribution unit and implementation defined attribution unit but at the core level that work as a first layer of firewall that is then",
        "uh we then have a second layer which is the traditional mpu which is then replicated on both the secure State and on the non-secure state okay so well the CPU protection",
        "from Tron is at the CPU level I mean the the system level protection you have these memory controllers which mean that for example if you set the access policies of the SI the SAU and the mpu and you for example if you want to access the address 0x 100 from a secure",
        "and privilege since you have Define the policies of SAU and and ncq mpu to be secure and privileged you will not be able to access that address well but",
        "because these controllers are just at the CPU level if you basically have a dma capable device on your platform which is very likely on this sort of microcontrollers you have tons of peripherals and a lot of DME device well you can use a secure un privilege application to basically uh be assigned with a dma device and on behalf of instead of going through the normal flow of the CPU it basically defers the access to memory through the dma and because dma access are not checked by the same memory controllers as as as the core so it is possible to access so what what what TruStone or or arm States is that these system level controllers instead of being specified by the TruStone itself are specified are left to the implementer of of of thec or the MCU to to to to embed those and to implement those and yeah in case you",
        "have this memory protection controls at the system level you can you can also enforce policies and if those policies are enforced you cannot anymore have the dma device to access the memory on behalf of the secure application well this leads to the conclusion that thrust zone is focused on CPU only protections and not as a systemwide protection view which we will see maybe a problem at the same time arm decide to to put stop this platform security architector movement is a joint initiative between arm and other other partners that basically defines a set of thread models then Architects a set of protection levels to to to to be linked with these Trad models and provide a reference implementation of a CQ fos code well per the PSA uh definition",
        "there are basically three PSA levels that enforce protections with the different capabilities let's put in this way in PSA level one you just have the normal division between non secq world and secq world but then the software on the secq world typically consists of the trust kernel some trust service that belong to the Kel but also applications developed by uh third parties that want to to develop security critical applications in the PSA lingo you have like this arot which stands for application Root of thrust and the P rods that stand stands for PSA root of thrust and then the Kel itself so based on these they Define a second level which not only provides separation between normal world and secure world but also compartmentalize the code inside the secure world is this principle of micr kernal where the more you compartmentalize the more you reduce your TCB which means for the better for security well and we still have a a third level of uh in in the PSA which not only uh splits like uh arot from the P rods and the Kel but you also isolate the different R rods from the different uh parties of O which mean basically you can have multiple and those cannot assess each other well our main major observations was that okay Trust on M just has a CPU Centric View and per the spec you only defines protection control uh which are the sa and",
        "mpu systemwide protections are proprietary which mean it is left to the vendors to decide and Define what they should embed and there is a kind of mismatch between the thrust on M and the PSA levels because the thrust on M doesn't enforce like system level protections but part the PSA level you may need like this system level protections well so we poti that based on this dicty uh which",
        "together with the lack of understanding of the different PSA isolation levels it could be a major Catalyst for the existing of unknown security HS in modern TruStone M system so and we tried to find evidence about about these hypothesis so now I hand it over to Christiano and I will get back near the end thank you SRO so now I will show you the evidence of uh that support this this hypothesis and show you a bumpy but revealing journey I will went I will guide you from what you find to be a weak Hardware protection and then we go to um assess one te that is specific",
        "Target for microcontrollers and I will show at the end what was our responsible disclosure Journey so in 2018 microchip",
        "partnered with Tron to release a secure solution for iot devices these make",
        "waves on the several news outlets and",
        "create a lot of hype for this iot community because it was bringing security for this uh resource constraint devices microsip on this partnership released Sam l11 that is a microcontroller based on TruStone and that is specifically Target",
        "for resource constraint iot devices and",
        "St released km that is a thion environment that specifically runs on this uh platform so here we want to dive",
        "a little bit deep and try to asset what was the secure guarantees and the struts of these guarantees in each site and we start by looking at the micros ship some l11 and this is a board that has a",
        "cortex m33 and is marked by mhip as a",
        "robust secur solution and has a lot of security features like arm Throne secure boot crypto acceleration SEC Cas sord and ship level T protection but we find here at first something missing at the the memory protection so we went a little bit deep and we went searching at the schematic from data sheet from the microcontroller and here you can see that is's a moment protection Unity there is a thone controller s and but we don't any M prote controller we find first a little bit strange but then we we thought okay maybe this is just a a misrepresentation of on the schematic and we scem through the data sheet and find a bunch of find a bunch of security features and there is one that they call the peripheral assess controller that is like a basic PPC that can assign a peripheral either to SEC world or non SEC world and here we we find something",
        "me missing too because they say that we can assign a PR to secure and unsecure but what about the privilege and unprivileged and what about the memory uh protection at the system level so we are here more confused because this is a",
        "AIC control that is sell as a specific solution for um security and it devices",
        "and they don't Implement a critical uh Implement critical piece of memory protection at the system level and what this means on exatic is there is no MPC",
        "and there is a pack that lets uh the prev be assigned either to non secure or secure world and when a secure un pre application wants to access uh privileg uh memory you already know what happens at the C Level it may be uh blocked but it can bypass that using a dma this per se is not uh a problem",
        "uh and it's just justifiable because some L1 is uh certified for PESA level",
        "one which means they can uh separate",
        "non-secure from secure world and the",
        "hardware can enforce this the problem here starts when we want to join km to",
        "this solution and here the they they",
        "claim that there is a p p certification level two watch uh tries to separate application",
        "Root of thrust from the privilege",
        "software and with this kind of board we",
        "find this a little bit difficult to to enforce because there is no no MPC so we argue that the lack of an NPC may open a non-security h spe",
        "particularly when you want to implement P level two and three and we for this to microchip to trying to raise the awareness for this problem but microchip just points us to thruston so let's see the the second puzzle piece of the puzzle so truston km is a trust discution environment that is specifically tailored for resource constraint devices and they official",
        "claim that they can have PES level to so",
        "let's try to map this to our understanding of what is a PES level two so they they have a non-secure software that runs untrusted software and and inside the secure World they have the kernel that's called Kos they have secure service that is on the PSI lingo the PS route of thrust and they have third party application from om uh that is on uh similar to the AR rods on PSA level but they they say that the secure mode can run on or every secure mode runs on on mode so this means that the PES hoot of uh service run side by side",
        "the application Root of thrust and we now start to find a little bit difficult to map this to a p level too and furthermore they also say that they use a memory protection unity and that skq model cannot read other SK models code or Ram so this looks more like a PCI level three so kbm uh seems more than PS",
        "level three because they put the secure services at the same level of the application hood of trust and try to slate uh all of them and when we add up this with the fact that the microchip some L1 just as support for PES level one and no PPC we think have here a time bomb ready to explode so this leads us to one first observation that an application hop trust or a secure mod that has been granted Mia device canle bypass",
        "albm uh enforcement policies and a sh adary read right or execution capabilities we report this to tronic",
        "and now I want to show you what was our responsible scholar uh journey and we",
        "start by reporting and at January 10th then uh at January 12",
        "received the first acknowledge of our report and the first feedback was coming",
        "on January 30 at which we respond the next day then we have another uh um step",
        "on on this responsibility closure between February 9 and February 14 and a last uh iteration with ronic on February 16 and we end up wrapping up all of this respons disclos on March EV 10 so now I want to focus on each iteration and lay down some of the most important topics there is a lot of conversation going on but I think this is the the main ones so first tronic says to us okay you are using only the km uh evaluation uh",
        "version because the production version has a lot of uh security feature that you don't have access so we want have here a big disclaimer that how our conclusions are derived from this evaluation SDK uh but we respond to Chic",
        "that we still think that a commercial version may suffer from the same problem because the underlying Hardware is the same they implement the production SDC cape on the same M controller that has not the M protection control unit there",
        "is also a topic about the ad station because they okay you are they say to us okay you are using the the evaluation STI and you can play around with the mod modules but on the production XK you need to be thrust party and you need to be signed to be to have their um code running so I want to do a second disclaimer that is kind of related to the first one that the evoltion up that you did use does not support at station but we still think that this is a orthogonal problem so you can still have effects on these kind of uh uh third party applications even if they are signed and validated and and unless there is formal verification on that you cannot you should expect bugs so there is another topic about t peration the tronic said to us that and agree with with our our our take that a skew mode with assx to a Dem can fatig Will bypass all memory protection and have access to the full system but but they don't seem that as a open door what we find a little bit contradictory because you give assess to all memory and you don't see the open door so we found that a little bit strange then there is another iteration that they say okay you should Grant assess to demia but that demia is lock down on the the produ xdk and we argue that you should not Grant but you should mediate so all the responsibility in our perspective should be on a part of KM to have some kind of module that enforces that on software and we propose also to share uh a mechanism to implement that",
        "mediation so here one in the first iteration I want to l two takeaways first that there is we argue that is a na Trust on om developers uh that even if they don't have any intention to in insert um malicious code they could have",
        "do do that by introducing bugs that",
        "other people can exploit and there is also a lack of understanding of the limitations of the hardware and what we",
        "can uh or not or cannot do at the software level and what we should do to enforce that policies in the second iteration uh there was a lot of of things going on but I want just FOC on this one uh on the nonnative D sport because kin tone say that kin does not ship with a secure World Dem model and that is left up to the OM developers and om developers should provide uh the the mediation and",
        "we don't think this a good security prati practice because typically om",
        "don't trust each other so when you have multiple OMS on the same uh um",
        "device they should be isolated and",
        "protected and not accessed to a core device as demia so here I want to play two takeaways too there is a lack of understanding of the multi threat model because they don't trust each other they should be uh not granted permission toia",
        "or to deploy themia by by per them and",
        "we areu that there is also lack of understanding of the criticality of the such a service as ademia and there is also a third iteration that was the last one and it was more most of uh in aspect of clarification and when we reach a a common ground about what we are discussing and first Tron clarifies to",
        "us that kiban predates rpsa and in some",
        "points they do more than PSA in other ones they do less than PSA so there is no uh oneone connection between the PSA levels and what km does and one one clarification also about who should provide mm Med mediation Tron said to us that",
        "thism environment uh is tailored for",
        "resource constraint devices and that most of the customers don't don't uh use a demia scre mode but with the the ones that use may have problems",
        "so they they they also say that the demia assess should be mediated by a system model but that should be provided by om and we strong believe that this is not the right way to do the and is not a good security practice and that that not providing the mediation in one side we are hindering the capability of the system and another side letting uh hope and threat uh Vector hope uh on the Wild",
        "and then the last uh thing that I want to highlight is some request that we to to trust on just to is a SCH advisor to clarify all of this protection Gap that",
        "there is and clarify the the difference between uh evaluation and a production SDK and provide us access to the commercial SDK for inter interal assessment tronic in how all our responsible discloser were very willing to talk with us and sometimes we have different points of view but we reach a common ground but on these specific three questions we didn't receive any um response and I let you the the audience take the conclusion about that to suing up and if you take something about this responsible disclosure I want to be this slide first we could only validate on evolation SDK uh but we we don't be was",
        "granted with the the permissions to the",
        "the other one the SC mods are only signed and validate on the commercial version but we think that the attestation is orthogonal to the problem that we present here and official km",
        "claims that it has P level too but each cator seems that it wants to offer more than that when there is no Hardware uh enforcing that and there is no DMM mediator uh that is delivered by kbm and",
        "is left for the OM now I will present you one uh way that you can uh do to",
        "mitigate this problem that is use a DM mediation that we think is relative simply to implement and basically you can use uh privilege U application from",
        "the the the as a skure service that as a demia mediator that has a white list and we can put in the white list the application that can access the theia",
        "and when that application in this case R1 wants to access they just request the",
        "the that access to the mm theator and if that access is granted the the mm mediator will do the access on behalf of the application in the same way if the application toess 2 that is not on the white list wants to assess it will be blocked so in this way you can simply um Implement and and emulate uh memory protection control on software and prevent this this kind of Gap so now you",
        "we show evidence of the problem but you are maybe asking but what what can have",
        "uh be wrong with this so what is the consequence so when we want to have probably more than P level three and the MC MCU has no MPC and the firware has no the mediation yep you are you are screwed we Implement three uh exploits",
        "uh one that we want to demonstrate that",
        "we can have secure privilege",
        "execution um and temper with KM then",
        "another one that you want to steal code from other SC partition and remember they should be separated and one SC parti should not be assessed to another one and the last one we still to have keys accessing um data memory that we should not have permission to uh I will focus just the last one they are very similar in the way that they they run uh but here we are limited on time so if you understand this one the other one will be very similar",
        "and here there is two parts where there is one application M application that has a front end and a back end the back end is a third part party uh application h of thrust that has access to a dma and there is other U application h of thrust",
        "that do some cryptographic uh uh",
        "computation that is from other party and here we just change this application and hardwire the key de dead beef to be easily mounted a proof of concept attack to steal the keys and basically the the steps of this attack is the aod 2 request a scool storage to store dead beef then the emition application wants",
        "to steal this dead beef and kinan",
        "specific says that um uh SK mold cannot",
        "read other mods memory so we just try to do that using the gap of protection that we show you and we use the demia and we could bypass all M and S protections and",
        "retrieve the the sco degree so here it's a quick live demo here we are dumping our secure memory from a secure unlo application that we should not have uh access and on this uh dump is also the",
        "security key the the cryptographical key that is here on top you can see that beef and you basically bypass all the protection now I will hand the presentation back to sandre he will do some final uh thoughts",
        "okay thank you Cristiano so well with this overall Journey we we have some lessons to share with different players",
        "so uh we have lessons for Hardware providers about TruStone CPUs we have",
        "lessons for firmware providers ranging from T to operating systems to even bare metal code that is intended to be used on on on for security and we have also a few license for um system designers AR dat or or users so the first one is that for Hardware providers they they should Implement protections at the system level and they should Implement these memory controllers not only enforcing permissions between the Trust on secure and unsecure but also to take into account this privilege and unprivileged",
        "mode so one very good example is this",
        "nxpl LPC 5500 cortex m33 which has a",
        "bunch of NPCs and ppcs that you can in fact enforce not only secure versus non-secure but also privilege versus non privilege and of course one not so good example is this microchip some L1 that",
        "we have discussed so far because yeah of the limitations that we point out well for firmware providers I think the main takeaway is that from one side they need to try to keep the language of the PSA standard and also uh to try to to enforce like the the isolation that that is required by provide the means and facilitate the life of of of the different parties involved on building a system and by that for example uh multis is a the intended for resource constraint device that already provide buil-in this dma mediator",
        "capability uh and yeah kinbe left or",
        "tronic says that it is left to the o or to the customer to decide or not if you have this dma mediator which may end up if history repeats itself by opening uh security dos in different products well",
        "for system designers and architector you should really understand which platform",
        "you are using and which software you are using and the combination of both should have a very uh system level view in the way that you should be careful about the how Access Control policy is is set up",
        "and one last one is about like these PSA levels as we have seen like kinm use this micro Kel like architector which not only uh splits like or or isolates the Kel uh from uh from the application route of thrust but also it moves like these extra trusted service the privilege them to un privilege secure un privilege and then Force isolation between them so this is we believe uh this is the way to go and um yeah have an architector like this and have a PSA level like this of course micro caral archers have a little bit of performance degradation but if done well it can it can be not so so bad um yeah in the meantime last week arm added this PSA level four which is not about what we do we did but basically they designed a model where they have a secure element per se secure element is an extra component that you typically embeded in Hardware wallets for example for crypto",
        "and tokens whatever uh so I we will say that uh PSA level three plus is something that we are proposing uh in between the three and the the new one the four so just to conclude I just want to to summarize like what was this responsible disclosure process so reported to microchip basically to raise awareness about the potential problems okay immediately microchip say okay it's not an Hardware problem speak to the software people always like that then okay we spoke with we said okay but it's a good security practice to have these NPCs then we went to to speak with tronic and tronic said okay you use just the evaluation SG but at the end of the day is left to do o to decide if they have this model or not but we said okay but it would be a good security practice to to provide this dma mediation and they say no but we have attestation and we said okay but attestation is an orthogonal problem and they say okay but you are using the valuation SDK and we said okay can we have access to the commercial SDK and yeah we never get a reply back uh I by no means want to diminish the dronic because I want to say okay during the this responsible disclosure that was like three months they were somehow uh interacting with us and they also we we let them the chance to review the presentation to make sure that we were not providing a super non-biased View and they have reviewed and and say okay this is the non-biased view of what you have done but yeah regarding this access to the commercial SDK we we asked but they didn't",
        "reply okay just to complete these are",
        "the last Sun right uh we basically shared our journey on fully accessing this uh MCU based te in particular the kbm for this very specific platform the Su L1 well uh we demonstrate what are the problems of not having a SE level View and uh we explained okay what kind of uh",
        "software solution you can Implement when you don't have the hardware capabilities but we stress out that it's better to have the hardware capabilities because facilitates a lot the software built at top and yeah just to create awareness we shared some potential attacks that can be mounted uh if you don't have this",
        "sort of mechanism into into place and you can basically bypass uh the full isolation boundaries of the system with that I thank you very much for your time and for your interest and yeah we are here to to answer some questions that you may have",
        "[Music]",
        "okay I think we have one",
        "question sorry I think the mic is not working because can you try again hello",
        "yeah uh my name is AES I'm research fellow at Singapore University of Technology and design uh my question is",
        "uh if you want to protect the microprocessor and the platform you need to put extra Hardware in it for example my protection units and some thing but but when we introduce more Hardware it",
        "takes resources and due to addition of new resources maybe we introduce latency",
        "in the computation so maybe the developers of microprocessors are afraid of putting mode Hardware because it degrades their performance but at the other end we need security so what do you think yeah thank you I I mean when you build a product intended really for security uh is a trade-off that you that you as you said there a tradeoff that you do I mean performance on one side area in another side because you need to put the hardware on on the ship itself and security on the other side but I mean if you take into consideration that you are not inviting an Hardware p that at the end of the day makes your product that you designer and developed intendance for security to be not secure at all I think it's better to have of course if you you have the option as we showed to to implement in software the problem in software is that the latency which translate like which translates then in performance overhead and then in this sort of device in more power consumption is even worse so if I have to say like between the different thread off thread off option I would say it is better to embed it on on the hardware itself but I think the the question is is very nice because yeah at the end of the day full system designers are all trading off different different metrics let's put in this way thank",
        "you don't be shy I I I need to have Cristiano reply basically answering one",
        "question who hard one",
        "okay so if you don't have more question thank you very much again and uh yeah I hope to see you around and if you want we can have a shot on on the coffee break thank you"
    ],
    "6S86MskqywE": [
        "good afternoon everyone I'm Arun koperti I'm with Intel Corporation in USA I'm here to talk to you guys today about the hack at Dak story our learnings from organizing the world's largest Hardware hacking competition uh I have uh our co- co-authors or collaborators in this work Harish katri and Jason fun also from Intel and Professor JV rajendran from Texas A&M University and uh Professor Ahmed sadegi from from uh T damart in Germany a little bit about our team uh Harish and I are principal engineers and offensive security researchers uh at Intel in USA and Jason is a senior director in the same offensive security research group uh together we have over 50 years of uh combined offensive security research experience working on various Intel products such as CPUs uh servers clients uh cellular products networking products uh storage uh Intel",
        "security Technologies and so on together uh the three of us have identified over 500 vulnerabilities in Intel products spanning uh Hardware firmware software",
        "and uh in addition to vulnerability identification we also specialize in vulnerability root causing and categorization the three of us serve on miters Hardware common weakness enumeration or cwe special interest group Jason additionally serves as a board member on the same we have collaborated with uh two eminent professors Professor JV rajendran from Texas A&M University in in in USA and Professor Ahmed sadegi uh from T damst so both have a combined security research experience of over 35 years in areas spanning circuit security system security network security cryptography microarchitecture and so on their body of work has an impressive 44,000 citations and they really know what they're doing",
        "we would also like to an acknowledge uh the student collaborators uh from our broader team uh the students from both the universities as well as our partners from synopsis uh who are collaborating with us as the cloud partner so synopsis as most of you know is one of the largest uh Eda tool",
        "vendors in this talk I will introduce by talking about hack at D and also I will identify what kind of led to creation of this contest we then proceed to talk about the value of organizing Hardware ctfs in general right and what's in it for different stakeholders for Academia for industry and so on and we then talk about how hacker da is unique there are lots of Hardware security uh ctfs and competitions out there uh and trainings how hacker is uniquely positioned uh versus all these other ctfs that we have next we uh proceed to talk about how we organize hacker what were some of the challenges and what are some of the key learnings uh finally I conclude by highlighting some of the impact that the competition has had on the industry and what are the key takeaways for various stakeholders Academia security researchers and Chip design companies as well as uh tool vendors and I",
        "conclude so hack at D is a competition is a hardware hacking competition specifically focusing on pre-silicon right before the chip gets manufactured we started this competition about uh 7 or 8 years ago and uh our the reason for starting this were like basically three main challenges that we have uh observed and seen over the course of our security Assurance careers at Intel right so I'll start off by talking about these three challenges and how they kind of motivated us to organize hacked deck so before we go there let's get a quick refresher of what the Computing stack looks like right so if we have the application algorithm programming languages and operating system all of these are broadly acknowledged as software right below that you have firmware and then there is Hardware right so if we unwrap Hardware",
        "we have four more levels within that we have Micro architecture register transfer level or RTL we have gate level and we have the transistors below that so microarchitecture is what captures Your Design intent what is your design supposed to do it describes all the detail structures and so on then we have the register transfer level which is a language which is uh which is the behavioral description of the of the intent of the microarchitecture that is captured in or designed in languages or Hardware design Hardware design languages such as uh verilog system verog vhdl and so on once you have the RTL designed and verified you then proceed to uh that gets translated into",
        "an interconnection of logic gates so these logic gates uh are further built using transistors right so this is what uh the four different levels of Hardware are as you all know there have been lots of attacks that were published over the several past several years on all of the levels of software and firmware right so and recently attackers have started breaching into the hardware domain with the emergence of microarchitectural attacks right so the race is clearly on to the bottom of the stack right and we have published a paper in 2019 at usnick security called hard fails what this paper talks about is that bugs in Hardware can actually be exploited by software right and when when we published this paper the amount of response the kind of response we got through the number of emails and pings and so on was massive right so people said hey this is great we had no idea that such uh such issues in Hardware depr rooted in Hardware could be exploited by by software right and that's when we realize that this is number one challenge that there is limited awareness as far as Hardware security weaknesses are concerned right so that's challenge number one next let's look at the state-of-the-art as far as security tooling is concerned for hardware and software there are lots of tools that we can think of uh when I ask you to name some tools for software or firmware security these can be code scanners binary scanners right reverse engineering tools protocol Checkers configuration check what not right I may have missed some here but there's lots of tools and lots of categories of tools what about Hardware right Hardware you you can really count on your fingers the number of uh tools that are there at a register transfer level uh for implementation right for checking of Hardware so what do we need what kind of tools do we need right so we we for for that we need to kind of have an appreciation for the kind of security properties that we typically see in Hardware here is one such property right so as assume that you have a key that is stored in some",
        "internal register inside the inside the chip right so one typical Hardware security property is that this secret key should not leak out to any attacker",
        "observable interface right maybe it's a software observable software visible micro software visible architectural register or through any uh debug port or anything else it could be anything but this key should not leak over to to an attacker observable interface that's one kind of security property the next kind of security property is for certain for certain scenarios such as fips compliance right you need these secret keys in the chip to be cleared or zeroed under certain conditions right and how do you know that the key has been cleared not just from its primary storage area but also from all the intermediate structures through which it passed to finally get to its location right how do you ensure that so right now there are very limited number of tools that can actually do these kind of tests and for certain scenarios that I described there are no tools right so there is a clear clearly a need for security aware design automation tools and that is our Challenge number two let's talk about the cost of fixing bugs right software bugs are relatively",
        "easier to fix right you get a patch you download the patch and then you're kind of ready to go with Hardware it's a little complicated the reason being Hardware bugs are it's not they're not easy to fix in the sense they're time consuming they are expensive and they have the potential to cause brand damage to all the parties involved right the chip designers the oems everybody so to",
        "understand why we let's take a look at the hardware design process right so once you have the microarchitecture logged in you proceed to to start coding up the chip using RTL right that's what we call the RTL design phase once you verify the RTL you proceed to what is known as physical design that's where your RTL gets translated into Gates and later into layout and so on once your physical design is kind of ready you start verifying it for timing uh and all all other functional correctness and so on and this whole phase is what constitutes the pre-silicon phase once the pre-silicon phase is done you send the design over to the factory or a Foundry as is known in chip parans and you there you actually manufacture the chip once you manufacture the chip you proceed to what is known as the post silicon phase where you start again running a whole bunch of tests on top of it once all these tests pass you then uh ship it to the customer now the chip is in the field right so bugs can occur can or can be identified in any of these phases right any guesses on where it is cheaper to fix the bug R RTL yeah of",
        "course right so it's it's cheapest to fix it at the RTL design phase right and and you'll be you'll not be surprised to know that the cost of fixing a bug in later stages exponentially increases",
        "right and if if you end up finding a bug in the customer phase that's when you have maximum brand damage right you do not want that so the challenge number three is we need to kind of develop a shift left mindset where we want to encourage everyone to kind of detect and mitigate as many bugs as possible at the RTL design design level itself right and yeah fix bugs here long story short right and that's Challenge number three so with these three challenges right raising awareness for Hardware security Assurance more security design automation tools and shift left to detect and fix bugs early at the RTL design phase these are the three challenges that we observed uh over our over the duration of our careers so when we work with within Intel from product security Assurance perspective we do lots of uh like the security design life cycle and so on right as part of that we also do hackathons with with with various products and we find lots of vulnerabilities we work with product teams to fix those vulnerabilities and as a retrospective we then kind of analyze what is the root cause that is leading to these uh vulnerabilities then we train offer trainings to the product teams yeah we offer trainings to the product teams and make sure that these bugs or occurrence of these bugs does not happen in the next generation of products that's uh that's what we what's what we learned these are really good and over the duration of time we have seen how these design teams which had limited to no security mindset have developed a security mindset over the period of time and have started building more secure products right we really loved that approach and we wanted to share it broadly with the general audience outside Intel as well how do we do that we obviously cannot give out Intel designs uh uh to and and say here's our source code let's find bugs in this so we went out looking for an open",
        "source's oh we went out looking for an Open Source Hardware uh that we can use as a Target right so again for open source Target there were not many uh designs out there that had lots of security features so we thought hey we can add these security features and we can give out these uh science how do we teach them how do we teach the participants and what better way than to teach a man how to fish than a CTF and that's how we ended up with a hardware CTF idea right so all the concepts of new weakness types or Hardware how Hardware weaknesses look like uh we can also raise the awareness for Uh custom tools and maybe even repurposing existing design verification tools or design automation tools for the from from for security and also develop best practices for shift left and identifying the bugs as early as we can so all of these three culminated in uh what became hack at dck so that's our motivation",
        "right so let's talk about the value of",
        "organizing such Hardware ctfs ctfs in general are a fantastic community building exercise right we all know that ctfs bring passionate people together and the and the team makeup uh typically comprising a members from different Oran organizations and uh sometimes uh they come with different experiences or different expertise some folks come from a design expertise some from come from a verification background someone comes with a security background all these three or experiences from different streams results in cross pollination of ideas and sometimes you have some excellent output coming out of these ctfs right and they're Al obviously a fun way to learn share all the kind of best practices and uh hacking techniques and so on with one another",
        "we uh ctfs also in general can be used uh to raise or Foster awareness for Hardware security Assurance in general right so uh we have seen previously how there is this continuous race between attackers and defenders in trying to get to the bottom of the stack right attackers are looking to get more out of the bottom of the stack and Defenders are trying to secure it right from the attackers and as we are seeing the attackers seem to be winning right now and it's the that why that's because attackers have unlimited time and Defenders have to work with within the constraints of uh their product uh time timeline right so they can do only so much but they need to do more or better within that limited time budget so Hardware ctfs are a great way to kind of foster this awareness about common weakness types and also what are the by while working within the constraints that chip design teams uh usually have so what's in it for Academia and for the industry right why why should Academia participate in such Hardware ctfs why should industry care so the we as at Intel we fund or sponsor lots of academic research and uh especially insecurity right and we get the common request that we get is hey uh can we get uh some access to Intel designs so that's not always possible right so they want something that's closest or closest to a commercial chip design available so what if uh the industry gets a a a a buggy system on chip framework that has realistic security features realistic threat modeling and security objectives that can be found in commercial chip designs right what if this buggy s so does not have like toy bugs but really has bugs inspired by real world cves product security advisories and so on right what if this also comes with open source tool support as well as commercial tool support that uh that people in chip design industry use and that is what we offer right we offer a buggy system on chip and this system system on chip can be used for furthering innovation in Hardware security Assurance this B this uh framework or this system on chip design can also be used as a benchmark for developing and testing new hardware tools right so this is the closest that is available to commercial chip designs there are lot of existing benchmarks for for testing security uh tools and so on uh in the within the trust Hub framework but these are really small benchmarks right so you have like one AES IP that has a bug somewhere or you have like a hard we Ren or things like that but this is no the benchmarks here in trust Hub are nowhere close to what you see in commercial chip designs the next one is people you need participants to gain Hardware security Assurance experience right you need to develop that hacker mindset lots of companies do not have budget to hire uh many security researchers right so the best way to do it is to train people who are already doing some sort of verification these are like folks doing the functional uh verification right to train them to step up and start doing more security Assurance work right and also there may be lots of uh researchers from adjacent areas such as firmware to they want to do more about Hardware why do they care well firmware had to for firmware to work properly there are lots of guarantees that Hardware needs to provide right and they don't know how Hardware does this and they want to know what it looks like Hardware is closed right so what what if you have you get an opportunity to look deeper into how these security features that you are depending on look like in RTL right that is what is in it for adjacent research areas it may it may not also be very accessible or easily available for adjacent areas to start firmware uh start doing more Hardware research work and that is where uh a a hardware CTF can serve as an easy Launchpad for uh for folks from adjacent areas so when I talk about realistic security Fe features threat models and security objectives what do I mean right so let's take a look at that with uh with this hypothetical system on chip",
        "right this is what the security features that I'm going to talk about here are realistic right when this is what you see in any commercial chip that's out in the market and you have sec security objectives like data confidentiality um where you have to protect secrets from unauthorized access you have data Integrity where you have to again Pro protect these assets from modification by untrusted agents that are not in your trusted Computing base or TCB then you also have to protect against availability right you want to make sure that attackers cannot damage your system by uh burning it up or causing it to accelerate uh run at an accelerated aging chip fails earlier than uh than anticipated and so on so to achieve these security objectives lots of security features are implemented in these system on chips right some examples include execution core and debug privileges privilege checks so you have you have your core and the core is running at different levels you have ring Zer ring three and so on right there's so many different privilege levels within that and also debug privilege levels so who is debugging this chip is it the manufacturer is it your OEM who who actually selling you the laptop or is it an end user who is actually using the laptop each has their own different assets and one should not be able to see another's assets right so there that's why there need to be lot of debug privilege checks inside the chip there are lots of peripherals here right you see uh hard IPS soft IPS and you have like uh memory networking interfaces uh storage devices debug modules Ram third party IPS and so on a lot of these peripherals all of them are connected through through an interconnect or a fabric like a bus right and you want the assets that are stored in these uh devices to be accessible only to certain agents not everybody right there needs to be some sort of Access Control implemented here then you have memory encryption and integrity features such as that then you have data arrays from non-volatile memories uh and you have uh term trip protections for voltage and frequency uh limitations and and so on so this is what I'm talking about when I'm saying realistic security features realistic security objectives and so on so where do you get this uh this kind of uh level of detail in an open source design nowhere right so that's where hacked D is unique so let's talk about how uh we kind of position ourselves versus other uh ctfs and Hardware trainings that are out there there are lots of popular Hardware ctfs which we call closed box",
        "what we mean by closed box is these are hacker Centric ctfs which means they do not have they do not provide insights into how the chip is implemented but they actually give you the final chip and say here you go hack it right I want you to extract the secret key there is some data going over this bus that is encrypted can you sniff it and extract the key that's so you do this by probing and prodding the chips and and like input input output ports and you do stuff like desoldering the chip reverse engineering delayering all these kinds of physical attacks right you start doing physical side Channel attacks like power uh differential power attacks electromagnetic attacks fault injection attacks and so on so all of these provide no insights into the RTL of the of the chip right they just want you to break it and that is where uh what we call uh it does not address the shiftless challenge because you are actually looking at the final chip right do not make a mistake that do not this is very important area of research this needs to be done this is absolutely relevant but what we are really trying to address here is to be able to find bugs early and that is where hacker de comes in it serves as an open box CTF it comes as a open box CTF where the participants are given a buggy system on chip design with all these fancy security features that we talked about and offers them a much finer grain scope to look at how these security features are actually implemented in RTL the participants then get to uh break these security features through existing design verification techniques such as RTL simulation emulation formal verification static analysis and God forbid even manual code reviews if time permits right all of these techniques and this is what we call a designer Centric approach right so if you have like a red team blue team kind of approach the blue team is designing the chip they have a very good understanding of what the chip is supposed to do how it is implemented and so on and then the red team with a similar background starts looking at the source code and tries to identify weaknesses or vulnerabilities within that right that is how uh we are unique and we try to position",
        "ourselves so let let's quickly take a look at how we organize the competition right so we divide ourselves into two teams this is the design team and the judging team the design team starts off with an open source system on chip we pick one open source design and then we start adding security features to it and then we Define threat model we look through different cves security advisories and we create a bug list a list of bugs that we want to insert into this design and we come up with the buggy RTL right and we are we update the specification and we also update the tool set with open source tools as well as commercial tools to work with this chip design once this is ready we start advertising the participants start registering and that's when the phase one of the competition happens right so phase one is when we have so everybody registered we typically have about 50 to 60 teams uh in phase one they register they'll get the design they start looking for bugs and submit the bugs once they submit the bugs we start scoring them and evaluating the bugs and we put a live scoreboard on the website and uh we that concludes phase one right uh we that goes on for about two months and the top 10 participants from phase one are invited to participate at phase two which is the finals live at the conference for phase two since we have uh fewer participants there is more control and we can also offer better features uh and better experience to the to the finalists so what we do for that is we add fpga based support we add uh we provide support for popular fpgas on how the on with the buggy design and we that's where also our Cloud partner comes up synopsis synopsis uh puts all their fancy uh tool Suite on the cloud and we Port the buggy design onto the cloud make sure everything works and we offer trainings to the participants and then uh then again we go back to bug submission bug evaluation and finally the scoreboard once the competition or phase two concludes the finalists are announced they get some cash prizes and they also get to uh present their work at the conference in a special session and uh they also get uh they have also been approached winning participants have been approached by hiring managers from CH top chip design companies uh with job opportunities so that's like the whole uh process the hack and deck process so now we'll go into details of each of these uh different stages the first one is the selection of the Target right we need to pick some open Source design what we do here is we survey various open- Source designs and we pick one that offers a full system on chip that is functionally working that has no inherent bugs and uh we obviously give a priority to designs that come with uh ready with some kind of simulation or uh some kind of uh open source tool support then we obviously again give priority to DS Tool uh to designs that have some sort of stability that do not break while running which results in a bad experience for everybody involved uh for all the versions of the all the editions of the competition we have picked open- Source risk architecture and risk architecture based s so's uh these include palpo palpo open python",
        "which comes from Princeton and open Titan which is Google's Hardware security module the open source one",
        "right so here is what uh a PPC mode design looks like this is what we uh used in one of the earlyer editions of hacker deck so it as you can see it consists of a risk five core uh with a debug interface a boot ROM a bus interface connecting all of these Fab all of these inter all of these peripherals so once we kind of download this uh open source design we go about adding security features into it right some of the security features that you saw are adding cryptographic modules we add the hmax Sha AES and so on and we add a fuse module to store some secrets that can be used uh things like keys and so on and and we add a DM module to copy stuff over from memory into various IPS we added a password based checking for instance to uh to ensure that the correct entity is unlocking the chip for for debug and around the core we added a proxy kernel to be able to do lots of other fancy things such as enabling virtual memory uh to physical memory translation and uh as well as self test of all the crypto engines and so on right so once we add all of these security features we proceed to add uh or Define threat modeling and and call out list of security objectives for this chip right so here are some sample uh threat models and uh I have only listed two security objectives here one being code running unprivileged code running on the core should not do some kind of privilege escalation and get to like super user mode or machine mode or something like that and another sample security objective that's listed here is that the internal registers of the cryptographic blocks should not be accessible by a physical attacker who is trying to attack or extract secrets from the chip through the debug interface right this is this is just a list of sample objectives but the full list of can uh security objectives can be obtained from the website right once we Define all of these security features the next step is to ins uh to insert the vulnerabilities right so as I mentioned before we look through cves we look through product security advisories and we also dig in from our own experience of having looked at so many classes of Intel products and uh we start inserting vulnerabilities uh throughout the chip right and once this is done the buggy RTL is ready we call out we call we uh start advertising uh the call for participation people start registering phase one begins so phase one as I mentioned earlier is offline right you uh you have over two months participants have over two months to start analyzing various entry points for attacks uh identifying the different assets in the system uh and also developing security test cases uh and breaking to to kind of break the security features right so they also get to develop custom tools to detect these bugs and finally they submit all the bugs uh through a web interface uh to for evaluation by the judges so let's look at an anatomy of a of a bug submission right so this is what it typically looks like right so the participants specify what security feature they think they have bypassed and they add a little bit of a description on it and uh they point to the exact location or in the in the RTL like which line which code and so on what is the buggy piece of code once they do that they describe what methodology was used to bypass this security feature right was it simulation RTL verific uh simulation formal whatever means did they happen to create a custom tool so on once that's done they also talk about what is the security impact of bypassing this feature right does it give you total confidentiality control or total Integrity bypass and everything things like that we also ask them to uh describe a mitigation what would a correct code look like if this were instead indeed a bug then they describe like how to fix the issue and they also talk about the CVSs details right this how do you score this how do you score this how do you uh rate the severity and so on then we come in we start evaluating the issues and we give points based on various factors the first one is the validity of the issue is it really a bug right we look at that then we look at the novelty of the methodology used most likely we are only offering support for simulation but maybe the teams went one step ahead and started doing stuff like formal verification or they created their own tools or maybe they did something fancy right for all of those we get uh we look at we consider that uh we consider the correctness of the security impact the scoring and also the mitigation that was proposed we offer a conference theme based bonus score right so for a design automation conference where the focus is on design Automation and tooling uh if you have created a custom tool to detect classes of bugs you get a bonus right for the first kind of first few bugs that you find if it's at a if we are doing this at a security conference such as usni or usni or chess we offer bonus for exploits or bypassing cryptographic protocols and so on right sometimes we offer uh uh we give give out a special award for cool finds so what are these cool finds so we have seen several instances where participants uh submit bugs that we have not inserted right and it's a challenge for us to start looking at that and say okay is this really a bug and we go looking at it and sometimes the participants submit some really cool bugs and we uh they may not be on the winning team but we really want to honor them for their uh for looking in areas that we have not considered and that's how they get all these honorable mention Awards as you can see here we are using Google Sheets for uh this bug submission which is very manual and uh timec consuming process uh we have also used an automated approach using CTF Damon for uh where participants can submit the bugs but if if they cannot kind of submit a flag they they use this uh automated they use this manual scoring approach to submit the bugs so once all of this ends the the scores are out phase one is done participants from the top 10 teams are invited to participate in the finals which is live at the conference and again I talked about the partnership with synopsis how they uh put the the tool on the cloud and how the design is on the cloud they also offer trainings on how to use these commercial tools and we offer uh demos of how to catch one or two bugs using these tools once that is done uh oh and we also offer travel grants to the us-based students to attend uh this in the finals uh the competition runs for 33 hours non-stop starting from uh 8:00 a.m. today to 6 p.m. tomorrow and once the competition concludes uh we honor uh the aies right so every hour we have a live scoreboard that keeps ticking and you see some of the students uh participants working hard here and it's also a great opportunity for us to meet with our uh our collaborators who come from different parts of the world uh once the competition concludes the winners are honored on stage at the conference uh award ceremony and they also get to present their research at a special session in the same conference right they also get an opportunity to publish their research in an it uh it special edition in this case we uh we we worked with it design and test which is one of the Premier uh it journals out there and uh they had dat did a special issue on on hack at d right so the winning teams from hack at D presented their published their work in this it Journal so far uh we have extended we started off with hack at D we ran it for over 7 years uh we extended this to uh other security conferences such as Yik security as well as chess for few years in between and uh so far we have over 300 teams participating from all over the world right we have seen participation uh strong participation coming from Asia uh Australia uh Africa",
        "north South America and Europe pretty much every continent has been covered and uh we have seen industry participants too coming in to uh learn more about Hardware security assurance and what we have seen is the past winner ERS are now working at top Hardware design companies in security Hardware security",
        "roles so let me come to the final uh final part where I'll talk about the impact that the competition has had and what are some of the key takea for various stakeholders so let's recap these three top challenges right so we set out with hacker D to kind of address these three challenges right raising awareness for Hardware security weakness uh we need more security uh aware design automation tools and we also need to kind of develop that mindset where we catch more bugs with the shift left uh with the shift left ideology for the first",
        "challenge",
        "um this is the miter Hardware cwe right for raising awareness of Hardware uh weakness types we approached miter in around 2019 and said hey we have this huge database of Hardware weaknesses and",
        "and we have done some initial categorization but none of these seem to kind of fit with your existing software cwe that you that you have right miter said hey that's great let's do rather than Force fitting this into the existing software view let's do something absolutely new for hardware and we uh it it worked great we formed this we formed a miter uh miter started this Hardware cwe uh special interest group and with with the initial view for Hardware cwe this was actually uh done in collaboration with in right after now you have lots of weakness types in various areas spanning core and compute memory and storage peripherals onchip fabrics and so on weaknesses of these you can you can go to cw. miter.org to learn more about this and as you can see each entry is very similar to what you see in the software uh cwe right there is a description of the issue an extended description and what is not shown here is this large Corpus of uh",
        "database has vulnerability vulnerable",
        "code examples as well as the correct or mitigated uh bug examp mitigated examples as well RTL code Snippets this is a great step forward as far as raising awareness for Hardware security weakness because chip design companies are typically very very secretive about any kind of security issue in their in their products especially Hardware issue right so there's Hardware is already very secretive and if it's a security issue it's even more secretive there's no way you can find you can ever come across like a a root an issue that was root caused in RTL you you will never see a code saying hey this is how it was done so from that point of view you now have like over 100 different 110 different entries 110 different ways in which things can go wrong in hardware and out of these 75 of them have come from Intel and uh a large number of these entries are now kind of populated with vulnerable code examples coming from the hacker D framework so that's how we kind of addressed uh the awareness problem next uh both",
        "challenges two and three combined security aware tooling and bug detection the framework that we provided to the students or the participants over the last seven or eight years has been used to kind of develop so many tools flows and methodologies over the last few years right so what we see here is a list of several Publications that appeared in top uh top venues right so these include security test case generation automatic test case generation using large language models automatic bug fixing in the RTL level Itself by going through various cwes formal verification uh we have static analysis tools that code your that scan your code look for known cwe types within your code then there is concolic testing as well as Hardware information flow tracking which makes sure that if that which makes sure that a key does not propagate from an asset to an attacker observable interface and so on there are many more papers I have obviously not lifted listed them all but a good uh some of the most recent work has been called out here and the great part is all of these work on RTL right you don't really have to wait until the chip is manufactured to kind of test this and if your existing tools don't work out of the box you can kind of Leverage these tools to start doing more",
        "work so that with that's the impact so what were the key take what are the key takeaways for Academia right the framework itself uh has been used as we talked about has been used as a frame has been used as a vehicle for uh for furthering security research in uh especially Hardware security assurance and since it's the closest available to commercial chip designs uh it it has also been used for creation of new tools right lots of teams are using this to uncover new classes of uh vulnerabilities and that are not already there in miter CW database and they have already approached miter to add new classes of Hardware weaknesses uh also the student participant they gain invaluable Hardware security Assurance skills because essentially they're mimicking a security uh design team at a chip design company right and they also get to develop the hacker mindset in the process the takeaways for industry right they get to improve in-house security Assurance best practices right they get by getting exposure to all these new kinds of weaknesses how they look like and so on and they also get to plan for survivability features so what do I mean by survivability features earlier teams did not have a methodology to patch a hardware bug right if a bug was identified in the hardware it was game over but now teams have developing this mindset like hey I need to kind of reserve some patch space uh so that I can kind of put the patch there and start uh reworking my Hardware around it right so that's the kind of mindset we are seeing uh in in chip design companies today it's also as a it's also easier for a functional verific if ation teams at chip design companies to attend training such as hacker D or CTF such as hacker D learn more about security assurance and then step up at their company to start doing more Hardware security Assurance work we have seen new tools uh that companies creating new tools uh to identify weakness classes in fact some companies have also published guides on how their security tools can",
        "detect several classes of Hardware SEC Hardware cwes right that has uh that is again pretty amazing and for tools that are there today which are used in functional uh verification or design verification they can be augmented with certain features or plugins to do more security uh security work and we are seeing that uh coming more and more uh in in come of some of the newer generation of tools overall uh hacker de has received lot of love and uh coverage from the media and press right uh some popular uh media here and this has largely been due to the participation of lots of enthusiastic uh students and uh researchers from all across the world so with that I would like to conclude with the black hat sound bites right so we have seen the key three key takeaways right so we have increased Hardware security Assurance we have seen that coming through the miter Hardware cwe we have seen this large Corpus of weaknesses as well as code examples uh through the through the establishment of the hardware cwe we have released this open-source buggy framework that is being used by research is all all over spanning Academia industry and so on uh with this this again framework has realistic security features CV inspired vulnerabilities and a complexity that matches commercial chip designs and this has kind of spurred Innovations in Hardware security tooling uh at the RTL level and overall we are so glad that so many participants have developed a hacker mindset specifically working on Hardware with that I shamelessly invite you uh to join hackerd 2024 register click uh kind of take a picture for that QR code you can uh get more instructions on how to register and if you want to learn more about the competition visit the website uh questions about the competition again you can email us over here thank [Applause]",
        "you hi so I was just wondering do you have do you post the designs from previous competitions",
        "online cool thanks",
        "okay awesome thanks",
        "[Applause]"
    ],
    "Krvi3bCXlCA": [
        "good afternoon everyone uh thanks the blackhead for invitation and thank you all for attending and also thanks Lucas for teach us T our presentation and today we are going to introduce our new research uh privacy detective it's a dynamic privacy analysis tool based on Freeda so considering our company's main business this tool is designed only for Android devices uh but this Innovation algorithm could be common applied to multiple platforms and uh we hope our insights will inspire you some new and productive ideas let's",
        "begin okay let me talk about ourselves for a little bit uh I believe the development of this tool and he specialized in reverse nuk and so security uh he has a longstanding interest in Mobile security and privacy and he enjoys car raising and CS goo during his free time so I'm I'm Maggie uh a security researcher at opal and I specialized in security certifications and oversee security compliance I've played a role in this tool and am currently got an interested in AI security and we can talk offline if you are interested too so I also enjoy sports when I'm stressed out and I especially like hiking and City Walk um beside us uh we also have three very great contributors one one she's a master student from school of cyber security at hon University of Science and Technology and shaning Wu a cyber security expert uh he he's a cve contributor to qal mediatech and Android and we got Daniel Chen he has more than 10 years experience in security",
        "okay now that you have a better understanding of us let's exploring why we doing this and what we are going to",
        "achieve by designing and developing this tool",
        "so for our company we are facing the trails from gdpr gdpr imposes stringent",
        "requirements for data protection uh",
        "complying with gdpr regulation is crucial for not only protecting the privacy of individuals but also maintaining trust among our organizations uh there are increasing amounts of regions have published the gdpr like regulations after",
        "2018 and about 83% countries have",
        "enacted data privacy laws by March 2023 uh they very greatly in content but many continue to show the strong influence of eu's gdpr so at least 20 other countries we saw the data privacy laws uh currently have bills for such new law so here are some laws and regulations that you may be",
        "familiar and it's also important to recognize the series consequences of non-c compilance uh gdpr violation can result in Healy fines which have severe impact of company's finances uh the maximum fines of gdpr violation is 20 million or 4% of company's Global annual revenue whichever is higher so they can have longl lasting effect on a company's bottom line uh from the cumulative graph on the left on the bottom left uh you can see that by December 2023 though the number of fines are stably increasing the s of fines have been growing dramatically so I won't speculate here but you can do the mess and beside this uh we also see that the inspections are not only enforced in telecoms but also",
        "all areas companies even a closed Factory who violated the data protection have been fined more than3 million euro therefore it's essential that we take gdpr compilance seriously and prioritize",
        "the privacy and security of personal data in everything we do so the consequences of non-c compilance are simply too great to ignore okay so",
        "here's the end of our company's challenges and my company have already dived deep into the regulations for year and here are the main requirements that our tool can guarantee so uh by using this tool that we are going to introduce any non-comp compellence Behavior like using TLS 1.1 and transport priv data",
        "with all double encryption should be detected and reported",
        "clearly moreover as a user imagine scenario when you talk to your friend like share something and your some 3p e-commerce apps can sometimes pop up the exact items that you may require like personally I've once talked to my friend that I'm heading to Singapore and my flight app just to push the notifications about Singapore's tickets on sale so it's kind of creepy for me and I see seems there is an eye on me uh so we did curious about how does these apps get my demand at the very first place so I have already turned since I have already turned off all the unnecessary",
        "permissions and also it turns out not",
        "only my concer I did a little background research uh according to Global consumer Insight survey June 2023 from PWC nearly",
        "half of C customers said that they're extremely are very concerned when engaging with social media considering about the privacy and the concern is also High regarding the retailers okay so in conclusion the",
        "motivation of This research comes from the company's Global strategy and part of our curiosity of how these push notifications accomplishment uh in order to solve our questions we aimed to capture all the transportation data and detect anying",
        "violations",
        "okay so before we explain our research you may need the following preparations that I show on the slid quite easy right and the most expensive and important one is we highly recommend you to have a emotional stable security researcher",
        "okay uh in this part I will introduce the functions and architecture of the Privacy detective then we will explain why we build each functions and how it works uh for your understanding we will explain the order of data collection data processing and data analysis here are the function that PR detective supported uh the simple architecture diagram is on the right you can see in diagram data flows from Android system to our tool and we divided our tool into three parts in orange blue and pink blocks respectively",
        "uh it follows the order of our explanation that I just mentioned the collection processing and Analysis the main point lies on data processing so",
        "you can see that our supported functions in the middle three comes from data processing section is decrete decrypt",
        "TLS decrypt nested encryption and decode",
        "H2 header so generally uh we tried to",
        "hook TCP TRS and Cipher data by Freeda",
        "from Android R time and Native libraries in the data collection layer okay after that it goes to the data processing layer for decryption and finally the tool will scan and generate the output files so first uh data collection uh in order to get a whole TCP traffic data we H we hook the socet output and input stream at java.net in Android around",
        "time then we invoke the following method",
        "to get the TCP information like IPS and ports shown here uh as we show on the right you can see how the data flows from Android R time indicating Yellow Block to our Tool uh which are showing orange great please note that we get S ID from Android OS here right",
        "okay after we do these things here shows one of our captured TCP package uh you can notice in the last line tag St Str string its value is some encrypted data right so which is obviously a TS data so the next step is to get the TLs data by hook SSL read and write and we invoked",
        "some other functions to get more SSL info as we done in TCP hook we obtain the SSL sequence number throughout ID and TLS version in this part uh if you remember carefully in the background section I just read in order to comply with gdpr we need to detect all transmissions whose TLS version is lower than",
        "1.2 so same here on the left you can see in purple block we get SSL info from Li SSL and the data flows from native library to our tool note again we get R",
        "ID from lip C in this",
        "part and here is our captured assal data",
        "in the last line tag St Str you can see that not like the uh the last TCP package its value is plan test so and ab",
        "will un viw The Secret of thread ID in the next section but we can keep on data collection here uh let's assume that we have captured all the T T CP streams and decry the TRS Connections in them so we will get the TCP data which is totally PL test right but do you remember that gdps requirement we mentioned apps are suggested to double encrypted personal data during Transportation so which means we may find a lot of nested encryption within",
        "TOS in addition to obtain plan test for double encryption we hook the cipher class add update and do final functions",
        "in case other demands we also hook the choose provider to get CER parameters update is the function that used to encrypt the chunked block while do final applies the requested pending to the last block and one small tip",
        "here uh however speaking we can hook those two functions then get the plan test and the Cipher from its input and output hook point however there is one tricky problem that I want to emphasize here the cipher class May invoke bad",
        "buffer the bad buffer inherence from java class buffer it has three essential properties and we would focus on",
        "position sorry buffers buffers position",
        "is the index of the next element to be read as shown just now in the animation in original workflow it starts from the position and read the requested lens move position return an array when it's doing reading so what's the hook Point hook flow should be so once we hooked it right and in order to get a return array we will invoke bat buffer to read the cipher",
        "block then issue occurred here after",
        "hook the original code will deal with the wrong position and get the wrong Cipher therefore small but important",
        "please always remember to reset the position to its original workflow",
        "okay so after we obtained all blocks we split them together to get a cipher and the plan test and here is one of our",
        "results you can find the plan Hax with its matched crypto also we added the decoded string in the middle other text",
        "shows the encryption parameters such as algorithm in the first line it's a and the AY in the last line so guess what if you notice carefully you may find that there is a nested encryption withing a nested encryption it's a trial encryption so don't panic you actually can find the plan test of this weather location in the same report under another bracket and here is the end of our data collection let's collect our sorts so what did we get so far we got the TCP string with IP ports and thread ID and",
        "we also got the T stream with sequence number SSL version and thread ID lastly",
        "we get the split the cipher block and it's match the plan test I'll pause here move to micro to Abby and he will introduce our core Innovation about how to decrypt the",
        "TCP okay thanks Maggie on the last section we have captured all data what we need then it's time to discuss how we use this data to UNL the encrypted Treasures obviously the most glittering",
        "treasure is to and here is the time based TCP and TOS data sequence in a single connection nevertheless how do TCP and to relate to each other let's dive into TCP and to",
        "workflow so in a single TCP ands",
        "connection imagine that I'm the client and I want I want to send something to the server by TOS then what happens in this process firstly I need to prepare the L text and then UT it into SSO right",
        "after completing at least one blocking encryption I will obtain the cipher text finally I will invoke TCP send to send the cipher to the server then the server receiv my packet it will send back a response and as I get as I get the response by TCP receipt I need to inut the CER into SSO read to decryption",
        "then I obtain the pl text for response after I explain what is in a single TS connection we can find that there are four different types of packet two of the TCP types TCP receive and TCP send and the other two are s types SS R",
        "and SS right in conjunction with what I briefly described on my previous slide",
        "in the context of TCP sequence one TCP reive will follow one or multiple ACC array and one or multiple assess right",
        "must follows a tcpc thus based on this conclusion we",
        "can list four possible combinations that will will occur like I highlight on highlighted on the right so when we get a Time based data sequence we can use the combinations to PA two and TCP data for recption in a single",
        "connection just like the animation shows I think we have open the treasure of to maybe but it's true no it's too and too simple and sometimes naive when you use the KY to open the open the treasure confidently we will get a Time based data sequence on the right and you should notice that it's disorganized so what happened",
        "why because in a real world one app or service may have multiple TP connections therefore we get a disordered sequence which is combine all data of different connections and if we want to decrypt the TOs data as the method on last slide we should divide a sequence of different connections into single",
        "connections so as far as We Know TCP is a stateful connection one TCP connection just has a only group of ips and ports",
        "thus we can uniquely ident identify one TCP connection us this go for syns but",
        "does our devation problem gets",
        "solved the theoretically we can match",
        "the IP and port in TOs and TCP however setting know bro when you",
        "want some red wi you find just rough green in practice we get IP and Port easily in layer but we can't obtain the IP and port in Android op cell and then we try to get socet FD to pass the ipn port nevertheless the socet FD always returns now and we also try to use a more fundamental information blocking IO but it can't pass IPM yet after experiments about above we",
        "found that for some reason Android doesn't give any information about IP and port to op so it's a time to give up the treasure in front",
        "us don't give up man you are emotional stable researcher why don't we go in another direction for forget the ipn",
        "port and think about",
        "why we need them yes sure we use them to divide the TCP connections and if there is another thing could connect the TCP and TOS data should we suppose that TCP layer will invoke open C in same St let's move to thread ID and take an experiment as what you can see of the result on the right the thre ID does divide the TP connections into connection segments",
        "so we can imagine that in one thread only one TCP connection happens TCP and TOS are seually",
        "involved as the animation",
        "shows but please be careful one one TCP",
        "connection is not necessarily happened wasting a thre please be careful",
        "yes uh using the TS decryption algorithm with a connections divided by thread ID we have open the treasure of to we have got all the pl text from",
        "TCP however some Str data are in our",
        "output file does there is any other",
        "encryption ignored by us then we analyzed the context of this connection we confirmed that it's H2 connection and the stret data is a header compressed by H2 which is a major feature of",
        "it so for more convenient experience for the researchers we decide to provide a decompress function in R2 but we don't suggest you to implement the algorithm to decompress the H2 header as RFC 7540",
        "defined why do I say that as I were a emotional stable security researcher I try to impl implement it and I think you can guess the rest of the",
        "story so let's use the existing libraries the H2 Library it's designed for forward communication actually we've got the data in Reverse therefore we need to divide one connection into two part one is client and the other server to simulate a real communication process",
        "for more convenient oh",
        "sorry then we get a decompressed header like the picture shows you can see that at the tag of string it's decompressed H2",
        "header and let's move",
        "on let's review the result we have go and so far a PL text of TCP data which has been decrypted the TOs and and the nested encryption and decompressed the H2 heer so it's time for some analysis",
        "because this data is too massive we use the self-developed rxed script to scan",
        "the pl text it included the panters of",
        "ID GPS URL IP keys and so on but we",
        "highly recommend researchers to have their own scan rules for more customized scanning experience",
        "and now it's time to share our findings by the way we have hided a few sensitive information in the PX we display so as you can see some application transmitted a list of apps in double encryption when you have installed the given apps it will perform different",
        "actions in this list you you will find that there are so many apps relating to secure and analysis and privacy protecting like xpriv",
        "xprivacy it can prevent you from privacy data leaking and the application seems to seems are applying anti-analysis",
        "technical this bad app May detect its",
        "environment compare it with the list and the and hide the malicious code to evade the anal analysis but we can refuse",
        "permission of access package list",
        "yet in addition we found that some absend circle command directly their developers",
        "May believe that the transmission of nested inced Circle command is secure and reduce the risk of attack however",
        "allowing direct execute execution of circle command still rises the risk of circle injection so personally I",
        "recommend developers to use parameterized quo",
        "instead and in this app as we show the",
        "big brother is watching you bro it's try to get it try to get a huge number of IDs such as Android ID BSS ID",
        "Mac ime and so on although the privacy policy on Android 14 has reject some exess of the tracking tax but the app is working really hard and it still gets some usable Texs however SE Heaven man",
        "do DOD ballet that the tanks were double en crafted before",
        "sending there are too many negative examples let's say a sample which is not",
        "bad from host name and pass we can presume that is a weather app as a weather app it used the K exchange algorithm to implement to imple imp",
        "implement the nest encryption and instead of collection",
        "other Texs that could be used for tracking it simply collect the information about",
        "localization sure as I said that R2 can",
        "decrypt the nested encryption you can find our GPS coordinates which should highlight on the",
        "screen wait one more",
        "thing as we will open source tool letter we have prepared a auto deploy scripts for researchers one click to install one click to push and one click to roll the scripts will Auto will also automatically disable usap features for",
        "stability reason",
        "next those are all the things we have done and we are going to do the following firstly add the UDP support to",
        "that we just supported TP now secondly",
        "add the Chrome and Firefox core support meanwhile we need to add a PAB format file output for its powerful analysis",
        "capability finally just for me I want the exposed version for its stability",
        "reason then please take a quick look at the detailed AR architecture of all",
        "twool you can get this diagram on blackhead website in our slides and uh I give you one minute to watch this diagram",
        "on the left is the Android system and uh on the right is our tool we hook the Android R time and the native libraries to get information from",
        "cyer uh TCP and to and the thread",
        "ID uh after we get this data we have a data processing and uh then",
        "we will Analyze This",
        "informations so let's move",
        "on our speech is almost over there are three main takeways of our",
        "presentation firstly with the TOs decryption problem we can use thread ID and the package sequence number as a feature to divide trtic TCP data into a single connection and then we use algorithm to decrypt the to traffic on Android without IP and",
        "Port furthermore for decryption of n",
        "encryption we hooked most implementations of Cipher class to get all data about the cipher then we restored the double",
        "encrypted content by the way please be",
        "careful with the B buffer for its feature of rating position in some cases you need to reset the position after",
        "rating okay the last but not least to",
        "prevent privacy",
        "tracking as sh on the past slides for",
        "Android User we highly suggest you to use the latest version to obtain the newest security and privacy strategy because almost every major release has a enhance of privacy protection and recom and I recommend you",
        "to practice the principle of least privilege for example you should always use wrong time permissions as you can and closer permissions like nearby devices body sensors atast and provide the rough",
        "location if possible",
        "so this is end of our presentation we are open to any valuable comments and uh any",
        "question any question okay",
        "[Music]",
        "please uh yes in some cases the app use self developed uh so to do the",
        "encryption",
        "uh oh you need",
        "to to customize for a single F but",
        "it's",
        "yes and uh other",
        "questions",
        "okay uh so no question okay due to time",
        "limits this is the end of our speech thank you for all and wish you have a good day"
    ],
    "ZE2OGQLwq-A": [
        "hello everybody we're very very very excited to be here today also because I almost didn't make it I was stuck in Dubai for like 32 hours on the way over um we're going to talk about the firmware modification attack and remote debugger we developed for the Simmons S7 plc's and before we begin I just want to say thank you to Professor Ellie bam Dr SAR ban and alone dner for the joint work and also a very special thank you to Dr Marina croil and Dr Ali Abasi for the dedic ated",
        "mentorship so I'm Ron seml I'm Al seml",
        "and as you can see we're brothers we' been collaborating for almost 25 years together um I'm a software I'm a software engineer at Microsoft and also a security researcher at Theon and I'm a security researcher at",
        "Theon so we're not the first to research Simmons plc's many people have done it before us so our first topic will focus on previous research so we can build a strong foundation for the rest of our talk we're going to talk about the runtime manipulation of Simmons S7 PLC firmware and how we leveraged it to develop a remote debugger for the Simmons S7 plc's and finally a video demonstration and",
        "conclusions so can anybody here imagine life without water transportation food",
        "or even our Amazon shipments so today our lives Necessities",
        "are made accessible via highly automated industrial control systems and these systems include wastewater treatment plants that purify our drinking water our traffic is managed using complex signaling systems even our food is grown using Automatic Irrigation Systems and our online purchases are managed in automated",
        "warehouses and these Smart Control Systems include Mass integration of iot devices extensive Cloud communication and smart automation but all these cool features come with a lot of risks and cyber attacks on critical infrastructure can be devastating for",
        "example the Triton malware was specifically designed to disable safety systems which can prevent industrial accidents it was first discovered in a Saudi petrochemical plant just think how deadly this kind of attack can be and due to these consequences we have a great responsibility in securing these",
        "systems now a PLC is a very rugged computer used in Industrial Automation and it's the core component of an industrial control system it reads input data from field devices such as sensors and then it triggers outputs based on pre-programmed code so you can kind of think of it as a bridge between the virtual and the physical",
        "world now a little off topic here we're from Israel it's very very hot over there kind of like here and you can just imagine yourselves like walking down the streets in the summer 100% humidity everybody's always sweating it's sticky so we love ice cream but the problem is they all here would always finish my ice cream going up so at a very early age we understood that ice cream factories are critical infrastructure that must be protected and here's an example of how an industrial control system would work in an ice cream factory so the factory has these industrial tubs which the ice cream is prepared in and each tub is connected to a PLC and the PLC gathers data from the top during runtime such as its temperature and then based on that data it can change the tub's behavior for example it can tell it the stop Additionally the statuses of the tubs can be viewed remotely in an engineering workstation and the plc's custom control logic can be updated remotely from",
        "it and here's some very important and relevant previous research regarding Simmons plcs the doors of Curr team discovered a special access feature to the Simmons s7200 plc's boot loader which was exposed via the UR interface and using this special access feature they were able to upload firmware directly to the firmware Flash and thus bypass all the Integrity checks the Rogue 7 team discovered that all the Simmons S7 plcs of the same model share a single hardcoded private Keys used for communication and this motivated team 82 at Clarity to actually discover these keys and once they did Simmons updated their communication protocol TLS and Colin think and Tom Dorman show that even a decade after stocket and all the security improvements that came with it that the Simmons S7 plcs are still an attackers heaven and we'll show you",
        "why and because plcs are the main target of attacks on critical infrastructure we focused on the largest PLC vendue which is Simmons and also because they invest the most in securing their products more specifically we focused on the Simmons et200sp open controller which is a Next Generation PLC it was specifically designed to match the growing needs of Industry 4.0 and it serves as a platform for modern software applications it overw some serious design changes which open it up to new attack vectors and methods and it also runs on standard Hardware uh in this case it runs on Intel atom CPU with four cores and it's one of the leading plcs in the market it also includes a built-in software P which is called the s 1500 software controller and basically",
        "it's a software application that simulates the functionality of a traditional Hardware pills and just to be concise throughout the talk we'll call it the S SW CPU now for years Simmons has kept the firmware of their S7 plc's a secret and",
        "they also invested a lot a lot of resources in protecting their intellectual property for example the",
        "Simmons s7200 PLC self-destructs if a",
        "watchdog discovers that one of the cores was halted via the JTAG interface and this was first discovered by Thomas Weber in 2019 and reproduced by Ali Abasi in 2020 Additionally the software PLC we talked about earlier is encrypted on the open controller and this was discovered by the soft 17 in",
        "2022 now we introduced a revolution in the research of these Simmons S7 plcs and for the first time an S7 PLC history we remove from these plcs their many layers of obscurity we introduce a powerful remote tool to dynamically analyze their firmware and we can easily expose secrets that have been kept secret for years and as a byproduct of all this we manag to install persistent malware on the PLC which can communicate with the remote command and control",
        "server so at the lowest level of this PLC we have a bare hypervisor and it launches two guest operating systems the first operating system is the software PLC and its main responsibility is to communicate with the field devices like the industrial tub in our example the second operating system is the windows embedded operating system and its main responsibility is to communicate with engineering workstation and Cloud platform and naturally these two operating systems communicate between each other using inter OS communication and the isolation between",
        "these two operating systems provided by the virtualization is a very important security layer and this is because if the Windows operating system is compromised we still want the field devices controlled by the software PLC to remain",
        "safe the boot process is fairly simple of this open control we have a bios which loads the BR boot loader which loads vmm first stage and it's the first part of the hypervisor it's mainly responsible for setting different configurations vmm first stage loads vmm second stage which acts as the brains of the hypervisor it loads the windows embedded operating system and also decrypts the encrypted software PLC and loads it into memory now our research continues where the soft 7 research ended and that's black hat USA 22 remember that in the previous slide we showed you that the hypervisor encrypts the encrypted software PLC and loads it into memory the soft 7 team managed to extract the pl text software PLC file so now we could start studying its assembly code and additionally but also very very",
        "surprisingly they discovered that the hypervisor and software PLC firmware files can be easily accessed from the Windows File system which means that these two operating systems aren't that isolated if the files of one can be accessed from the other and by simply dragging and dropping we can easily replace these files as a side note replacing the hypervisor is easier than the software PC but we'll touch up on that later for now just a video demonstration of how we replace the",
        "hyper so here on the left we can see the original sorry the modified soft",
        "hypervisor and on the right we can see the original one and as you could see by simply dragging and dropping and giving admin privileg is we can easily replace the original hypervisor and when the PLC reboots the the modified hypervisor will be the one that's",
        "loaded and they leverage this new capability to crash debug the hypervisor and what do I mean by this so for example how could they know who calls this function they started by overriding an instruction in the hypervisor with the N3 command so in our case they overr the first instruction of the function within3 they then replaced the original hypervisor with the modified version using the drag and drop method we showed you in the previous slide and finally when in3 executes a crash dump will be produced and this is kind of a hidden feature of this PS if we look at the top we see the PLC and on the bottom we see the crash dump and if we zoom into the crash dump we can see the hypervisors registers and stack if we look at the top of the stack we can see the functions return address and that's how they discovered who calls this",
        "function now before we continue to the rest of the talk just a quick recap the soft 7 research enabled us to study the software plc's assembly code easily modify the hypervisor via the Windows File system and crash debug the hypervisor and going forward we'll be presenting our",
        "contributions and what will we show you so we'll show you how a bad actor or Nation St could persistently install malware on the PLC how to set up communication with a remote C2 server how to remotely and dynamically inject commands to the software PLC how to exfiltrate data from it and if you're a researcher like us we'll show you how to read runtime information from the software PC how to get a better understanding of the code fluid and finally this will all expedite your research process",
        "exponentially now our research process was kind of like robbing a bank because it had kind of many steps and challenges so took a gaming approach into doing it and that's why we developed a game called bank heist and we'll be playing it throughout the talk so I hope you enjoy it and now we can actually start to talk about the runtime manipulation of the software PLC which leads us to the first level of our game which is to gather intelligence about the bank or in our case research the",
        "firmware but we encountered a slight bump in in the road so remember that earlier we showed you that the soft 17 was able to easily modify the hypervisor and run it we wanted to do the same to the software PC but the problem was that the software PLC is encrypted on the open controller and the soft 7 team didn't discover the decryption method or key so after we would modify the pl tech software PLC we didn't know how to re-encrypt it to Max the hypervisor decryptor and if we were to just replace the encrypted software PLC with the pl text version it should just crash right so what we did is we started by reverse engineering the code in the hypervisor that loads the software PLC and we discovered that the hypervisor can load any elf any arbitrary L file as a software PLC which is crazy it shouldn't be this way and it kind of looks like a back door on the code let's take a look here on the bottom we can see the if clause which loads the encrypted software PLC file it just checks for a specific magic number at the beginning of the file magic string but here on the top we can see the vulnerable if clause which enables any L file to be loaded just checks for the Elf Magic stream at the beginning this if Clause shouldn't be here and let's take a visual look at this any admin user on the Windows operating system can easily replace the original software PLC file with the modifi version using the drag and drop method we showed you at the beginning and when the pl C reboots the hypervisor will load the modified version without checking for authenticity and this undermines one of the key advantages of virtualization",
        "which is isolation this can be done remotely if an attacker gains admin privileges to the Windows operating system and the changes are persistent so it will withstand a power outage now as a side note we own the PLC that we researching so obviously we had an admin user we could which we could use to run all the experiments we needed that required admin",
        "privileges and that's how we gained the first point of our game which is very exciting it was the first V vulnerability we found and we were ready to continue and now that we could exploit this uh vulnerability we can modify the software PLC to our liking what should we make it do so I like money I wanted to make it mind Bitcoin they all's a little more ethical than me he wanted to modify so he can better understand internal logic unfortunately want with this approach and to better understand how the software PLC works during runtime we needed basic runtime information like its registers and step but how could we do it so what we did is we began with a very very naive and simple approach and we continue to improve and build on top of it throughout our research process so remember that earlier we showed you that the soft 17 was able to easily generate a crash d by injecting an in3 command into the hypervisor what if we could do the same to the software PLC what if by simply injecting an in3 command into its code we could generate a crash that way we'll see its registers instead but obviously this didn't work it was just too easy always has to be hard but it was a good starting point to build on top of and we looked for ways to improve this",
        "approach as a reminder the hypervisor launches the software PLC and during runtime control is shifted back and forth between them there are many context switches and we started to ask ourselves what does an M3 command actually do when it executes in the software PLC the previous slide we thought it generates a crash T but obviously that was wrong but after a lot of research we actually discovered that it shifts control back to the hypervisor and that's when we asked ourselves the following fundamental question can we leak software PLC",
        "runtime information to the hyperv is CFT",
        "and here's a visual explanation while running within the software PLC will shift control back to the hypervisor using an in3 command and",
        "after the context switch the hypervisor registers will be identical to the software plc's registers and this is because the hypervisor is a bare metal hypervisor which means that it shares its physical registers with all of its guest operating systems afterwards will",
        "crack the hypervisor using another in3 command and the registers in the crash Dum will be identical to the software plc's registers that's how we found a cool way to actually leak runtime information from the software PLC to the hypervisor",
        "craft and let's actually take a deep dive into the code we injected to make this happen so let's begin by looking at a snippet of code of the software PS when looking at this code we asked ourselves what function is called here which basically means what's the value of Rax nobody here knows what it is because it's only determined during runtime so we couldn't really follow the flow of the code what we could do is inject these",
        "commands dead beef is a magic number we chose to tell the hypervisor that it's actually time to crash and in3 shifts control back to the hypervisor like we explained earlier and after in3 executes",
        "and control is shifted back to the hypervisor we end up on this line of code and this is the code that we injected basically what we do is we first check if edx is equal to dead beef the same dead beef we placed in it earlier and if so we'll crash the hypervisor using another N3 command but otherwise we'll just resume the normal flow and that's how we actually discover the value of Rax in the crash as we can see here on the left now this was a tremendous",
        "tremendous breakthrough for us because For the First Time in our research process process and probably all the research process of this software PLC you could actually see what goes on inside during runtime and up until this point we could all we could do was statically reverse engineer the assembly code but it was very very frustrating because for some reason stopped working at some parts of the code like it work here work there in random places it stopped working so we tried to actually pinpoint the point of failure see where this stopped working and using binary search attempted to crash the software PLC until we actually found the point of failure and the point of failure turned out to be this LT command which modifies the IDT the interrupt descriptor table what is this IDT anyways it's a",
        "kernel structure pointed to by the idtr register and each entry points to a different interrupt handle so in our case when N3 is executed the in3 Handler",
        "shifts control from the software PLC back to the hypervisor but if the IDT is changed and the Handler is changed it can prevent control from shifting back so we overcame this by replacing the N3 instruction with the VM call instruction basically VM call does the same it shifts control back to the hypervisor without going through the ID te so before our break point used to look like this like in the example we showed you well we changed it to use VM call instead of",
        "N3 and that's how we gained another point in our game and actually leveled up and we were ready to continue to the next part of our research but just before we continue let's do a quick recap of what we managed to do up until this point so first via a vulnerability in the hypervisor that we found we were able to easily modify the software PLC using the drag and drop method we showed you in the beginning and by modifying the hypervisor software PLC we were able to leak runtime information",
        "from the software PLC and this expedited the next part of our research a lot now I'll be handing the mic over to explain how we leverage this thank you so you might be wondering",
        "how did this runtime information actually expedite our research so during our research we found out that static analysis can't always be enough for instance at one point we wanted to see which files were open during runtime so",
        "we did use static analysis in order to find the offis skated cisal table and map out several of its functions but it was still hard to see which files were always opened only through the assembly code so what we did is Hook the open CIS call such that the file name will be copied to the registers and then a crash dump will be initiated so as you can see in the example here this file name is aski encoded and saved in the registers in the picture and that's how we could extract back the file name that was opened so for future researchers here's the offis skated CIS call table that we found with several of the functions that we mapped",
        "out now these were really tough times because each of these crashes took about 5 to six minutes to reproduce they were extremely aone and very tedious but they were crucial for allowing us to debug our debugger as we built it so now we'll get into the actual implementation of our debugger now in order to build a debugger we need a couple of things first of all we need to be able to send debug commands to the software PLC and then we also need to be able to get debug information from the software PLC",
        "now a lot of you might be thinking this sounds a lot like a C2 server and you'd be right that's exactly what we're going to do we're going to build a C2 server so that leads us to level two of our game which is breaching The Vault or injecting data to the software",
        "PLC so like most people we do our best to avoid hard work but developing a C2 server is extremely hard it would require a lot more research and development like re like finding more CIS calls in the CIS call table but what if I told you that the PLC comes with a C2 server pre-installed that would save us a lot of development time and it even comes with a nice goey so let me introduce you to the plc's web",
        "server now the PLC exposes a web server via the software PLC and this makes a lot of sense and has legitimate purposes for instance a technician can connect to it via his cell phone during maintenance but how can we use this into in order to inject data to the software PLC so we'll show you here on the top we have our web client and on the bottom we have the plc now the web client can request any file from the web server including non-existing Pages for instance dbg 7 hello which obviously isn't a real file but when that request gets sent to the web server the web server will attempt to open this socalled file and when that happens that will hit our open hook so our open hook will check if the so-called file name starts with a DB G7 prefix and if so will we will save it in the memory for later use and otherwise we'll just continue with the normal open Flow and retain its original functionality so this might have seemed easy but we just gained a point and leveled up and for the first time ever we could now inject data to the software PLC and we're basically halfway through implementing our C2 server which leads us to level three escaping the bank without getting caught or exfiltrating data from the software our PLC so once again we have our web client on the top and the PLC on the bottom now the web client in this case will request the homepage which is the legitimate page and when this happens several CSS files will be read as well and that's where our hook on the read CIS call will come into action our hook will check if the file that's being read is the Mini web CSS file and if so instead of returning its original contents we'll return the data that we saved earlier into the memory and then after that happens this modified CSS file will be sent to the web client and just like before if it isn't the minu web CSS file will just return will just return its original contents in order to retain the original functionality so here are the results on the left we can see that the Min web CSS file is open in the browser and on the right we can see its contents which is dbg 7 hello which obviously is isn't its original",
        "contents so we just leveled up and we got an extra point and we just built a C2 server for the PLC but we're not done yet because we need to finish the final level of the game which is defeating the boss we need to build our debugger so now we'll get into the implementation so first of all in order to build a debugger we need to be able to add our own code and data without interrupting the normal flow so here is the basic layout of any L file or most L files including the software plc's L file and what we did is add a whole new malicious section to it we called that section Hooks and we gave it read write and execute privileges so now we could add our own code and data and manage our own memory during runtime we also wanted to give right privileges to the tech SE so that we could add a break point during runtime but lucky for us the text section was already writable which obviously is a huge security",
        "flow so now we'll get into the implementation and the architecture of the debugger so once again we have the web client on the top and the PLC on the bottom now this time the web client will request this funky looking file name which obviously isn't a real file it's a debug command and when this debug command getss sent to the PLC it will hit our open hook and our open hook will take this debug command and send it over to our Command parer the command personer will identify that this is a debug string that this is a debug command thanks to the DB G7 prefix who identify the type of the command thanks to the type's character which in this case is a capital R indicating a read string command now the read string command has only one parameter the address from which to read the string so now thanks to the thanks to the type the appropriate handle will be invoked with the parameters and in this case the read Handler will read the string from that address and save it into the new section that we added for later use and then after this happens the web client will request the homepage and just like earlier we will leak that information through the CSS file to the web client so that's basically how our debugger works the right Handler operates in a very similar fashion to the read Handler and the breakpoint Handler simply copies all the registers and any other information that you'd want to the CSS file sends it to the web client and then continues with a normal flow so now we we'll show you a video demonstration of our debugger so here is the plc's web server on the left we can see that the Min web CSS file is selected and on the right we can see its contents right now it's empty because we didn't write anything to our memory yet now we'll go to our second tab where we'll enter our commands we will start with the read string command that we can see in the URL we can see that the type is R indicating a read string command this command has one parameter the address from which to read the string now we will go back to the web server refresh the page check the contents of minu web CSS and see that test ring appears just like it does in the software PLC back to our commands tab we'll run a right string command this time we're going to overwrite the previous string with phoned after this we will reread the previous string and go back to the homepage now after we refresh the homepage we can see that it's pwned now we will enter a breakpoint command we can see that the type is indicated by the letter b and that we entered the breakpoints",
        "address now we will run the software PLC so that the breako will be hit",
        "we will refh the homepage and we can see of all the registers and that the PLC continued with",
        "flow so the audio got cut out a bit in the end but we just refreshed the homepage and we can see that all the data in the registers appear in the Min web CSS F",
        "to so finally after a lot of work and a lot of effort and as you can see a little bit of shooting we finally defeated the boss and we won our little game here and we finally developed our",
        "debugger but this little game has real implications on the real world and this must be mitigated so what can be done in order to mitigate what we showed you here today so first of all just some common good practice security mitigations should be instated such as using an aslr in not allowing the text section to be writable Additionally the hypervisor should be an ironclad wall between the two guest operating systems yes Simmons gave us an elegant back door that allowed us to modify the software PLC via the Windows operating system this so-called feature must be removed and as a matter of fact Simmons did attempt to remove it what they did is release a new version of the hypervisor that doesn't allow any unencrypted L file to run as the software PLC but rather only encrypted ones but the only problem is that we can use the same Dragon drop method we showed you earlier to perform a downgrade attack on the hypervisor and use the hypervisor that we used in the in the example here which means that effectively this doesn't really stop any attacker which leads us to our next point there must be a secure boot chain because a secure boot chain is the only real way to prevent from a firmer modification attack on the",
        "PLC so what is the impact for future researchers so you may not have noticed but we just entered a whole new age of PLC research and for the first time ever the software PLC can be dynamically debugged and researchers can thoroughly examine and investigate the software plc's firmware but that's not all",
        "because all of sim sematic S7 product line share most of their code which means that all of Simmons's latest and newest plc's are now much more",
        "vulnerable and what is the security impact of what we showed you here so we showed you how a persistent Trojan Horse could be developed for one of the leading plcs in the market this meler is persistent it can withstand a reboot and it can't easily be detected and we know for a fact that bad actors such as the actors in The Triton attack have been seeking these kinds of capabilities and we now know that it's possible the longer the industry fails to properly secure plc's the greater the risk there are already many plcs out in the wild that are vulnerable to what we showed you here today but they can't be updated since they operate critical infrastructure and they can't afford any downtime so you might want to ask yourselves how safe do you really",
        "feel you shouldn't feel safe what you should do is demand secure products and ensure that our modern world stays safe and secure thank you all for your time and if you have any further questions please feel free to contact us or step right up to the microphone [Applause]",
        "um thank you thank you for the information um so so critical as you said 7 PLC being worldwide and so much critical plants PL being used uh one question here this when you mentioned this secure boot chain is it a formare Integrity check if it have done in the beginning this should have this uh have made difficult for you to uh extract that content uh I'm not sure if I understood it fully the formare Integrity check during boot time so now there isn't a there isn't a secure boild yeah the secure boot is there now no there is there isn't a secure boot okay okay because usually when this kind of plcs or intelligent devices during in the Boating the for at least if not a secur secure secure boat at least they will former Integrity check they will do the code signing and the formare code signing and then check the code sign before booting um maybe it's not there",
        "now um uh that's why you were able to crack that you were able to put that dummy code in the malware the second thing is have you got any c for this you published this thing and got",
        "cve so we did contact Simmons and they did patch the hypervisor like we said like they all also said it didn't doesn't really fix it I'm still not sure if there's a cve we're waiting for them to get back to us on that okay now usually the responsibility of the the like researchers like you to publicly apply for an CVS and get CVS from it then then then uh tell to the vendor saying that okay this we are publish the CV it would help the industry like they will get to know because once the CVS are there it's publish nvds at least the the customers will get to know okay there are new CVS are come in the PLC that that create awareness in the the public world we did uh go through a responsible disclosure process yeah I'm just not sure yet if a CV has been thank you yeah",
        "published uh hi thank you interesting very interesting work uh frightening work um so what's the current State of Affair and what is your policy with respect to the tool you have done so is it now available to external researchers and how long do you think seans would reasonably take in order to do anything to secure their S7 um so we won't be publishing our tool because we think that it may be dangerous right now to send it out to the world okay and uh regarding uh Simmons I think you should uh ask your questions directly to them they'll probably know better than us no but but you said in your last slide that you have we have opened a new era where it's going to be available to all the researchers to blah blah blah but if the tool is not available that there is no new era right so the tool isn't available but we believe that people can develop it we don't want to give it just like out to everyone we want to show like we want to make PLC safer so we did publish our research um but we still don't want to give the tool right write out to everyone cuz that would still be dangerous right um you could still probably develop it we showed you you have just shown to those who have the right resources that it's possible just do it this way in particular the people behind Triton right yeah but we also showed it Simmons and TR oh it's fine I mean I'm it's it's uh I'm not taking position here I'm just asking what what what is [Laughter] yours as as a policy of our research lab it really depends but as a general policy we don't release code um yes like you said we know that it can be easily reproduced so I think it's kind of like a balance of actually displaying This research so action can be taken because if nobody knows about this it won't be fixed because it's really hard to fix it's really hard to patch this kind of uh bug even if a secure boot chain is initiated and developed for future plc's I don't really see how this can be updated in current plcs in the wild because it requires physical access to the plcs and like installing you know the keys and everything um but still yeah we should I Believe In This research so at least people know what they're are because maybe some of this attacks already exist in the wild and it's better to to know it I know okay thank",
        "you okay thank you everybody"
    ],
    "Px3uzzQxdag": [
        "all right hello again blackhead our today's talk is the final asterisk chapter unlimited ways to bypass your Mac privacy",
        "mechanisms my name is vua and I am a head of mobile security at securing I'm an author of certified iOS application security engineer course and I'm mostly",
        "focused on iOS and maos application security and somebody of you may also know me from my blog that I run in my spare time which is vo. blog where you can of course read can read about Apple",
        "security uh my name is cha fitzell I currently work at country as a principal MEC security and uh researcher um before that I um created a training for MEC pentesting and exploitation even before that I worked as a blue and uh red teamer I do bug",
        "Bounty uh as as a hobby currently I have like 80 plus CVS from Apple and I also run a Blog on Apple",
        "security so this presentation is",
        "research continuation uh that we are doing for last four years or something last four years that time passed fast um and we presented our first uh TCC talk on blackhead us 2021",
        "uh that was 20 plus ways to bypass your ma privacy mechanisms and after this talk uh we found again 20 more TCC vulnerabilities",
        "and that resulted in our second blackhead talk which was uh knockout win against TCC AKA 20 plus new ways to bypass your Mar privacy mechanisms so we wanted to uh create the third presentation because we found another 20 vulnerabilities in the at ECC uh and you know just not to be uh the same this title is different so it's not a 20 new new ways to uh bypass your marketp",
        "mechanisms and the plan for this talk um is that because this is the third edition of this TCC um talk I'm just quickly remind you on how this all TCC and privacy fundamentals work uh then we will go through TCC bypasses uh quick spoiler we did again uh some TCC bypasses with simple grabing so stay tuned at the end Chaba will uh talk about dead and dying techniques and uh we will cover also the TCC and Security in general improvements in Mac OS Sonoma so to quickly introduce you to uh",
        "privacy fundamentals that will be just a quick recap quick reminder so on Ma the",
        "uh most crucial let's say mechanism is system Integrity protection is turned on by default and on Mac OS whenever uh you",
        "are root you are not a gut you cannot do everything with your Mac if the system Integrity protection is turned on because system inte Integrity protection which is based on sunbox kernel extension so it's a really lowlevel uh mechanism it restricts many uh is it",
        "restricts access to many director to files uh it will also deny a debugger where you would like to um debug or inject code to Apple signed processes so as the name says it protects the system integrity and the very important thing to understand is that even if you have root you cannot do like inject to Apple processes uh to bypass TCC this is all",
        "protected by System Integrity protection",
        "and when sip is turned on the TCC comes into play so that's why it's also really important to have the Sip enabled for all the time and the TCC stands for transparency Conant and control and the main um the main thing that TCC does is it protects users privacy and and because uh sip will",
        "protect the TCC databases where all the permissions are stored not even roote should uh be able to approve TCC permissions uh whenever your application",
        "uh wants to get access to privacy sens sensitive resources you will see such a prompt and apple in here wanted to make sure that there is a clear user consent when wherever the user clicks the allow button so even if you are root you should not be able to access privacy sensitive resources without getting the user clear leing alow if you find you know a way not to spawn this problem and get access to Pro private sensitive resources you probably find a zero day and the the interesting thing is from Mar Ventura the TCC protects also containers of sandboxed apps and this is a new feature introduced uh",
        "recently and that TCC uh protects a lot",
        "of privacy resources now as you can see",
        "every picture uh shows another resource",
        "and the number is still growing and TCC",
        "uh in general became really really big uh if",
        "you go in on your mic to settings and privacy and security you will see a plenty of resources that are now protected and even if you go to automation you will see that now you you can specify which which particular app",
        "can control another particular app so it's really granular and because the TCC mechanism itself grew uh that much the",
        "attack surface of course is is Big also so there is a lot of um ways you can you know play with TCC and probably find some more vulnerabilities so let's now talk about the TCC bypasses yeah so let's start with some uh easy one with some info leaks uh so it's all started with me reading a block post back in 2020 about uh Mac database which contain basically a whole lot of private data now you would expect like your contacts information which is which is considered private data is inside the address book directory and it's protected by TCC but turns out that your contact details are also like five other places on theice system and apple didn't think about this uh so I started to grab for private information on the file system and it just was all over uh as of today I think I submitted like 30 uh leak info leaks um Apple does a minimum payout 5K",
        "US dollar for vulnerability and TCC TCC",
        "leak is considered vulnerability uh you can do the M uh how much a grap worse uh fire system leaks are going away because I think found most of them nowadays but logs are the new place to search for so some notable uh leaks the key",
        "value service database uh on the file system contained uh email addresses known with hotspots uh the game center uh cach database was really nice because when you start game center it basically made a copy of all of your contacts and all of your all of their details uh so you could just access the database and you get full contact information uh the Pard this was a fun one so this demon created a very shortlived cach files so I think grappling this was a bit of luck like they live for a few minutes and they actually logged your go location uh so you could find the actual user location and it also did a keystroke logging in Safari so what where I typed in in Safari it was key logged in a cach file that was like a system provided key logger uh pretty nice uh screen time core these logged phone numbers in the logs Maps uh this",
        "was also really fun because if you started uh Apple Maps with a GPS coordinate or a location of your choice",
        "it logged the distance to that location from your current uh location so with",
        "opening a couple of coordinates you could do either triangulation or some other calculation and basically you could uh precisely locate uh the user",
        "based on the",
        "locks uh but logs in general so Apple",
        "tries to filter out private data from the system logs so they mark it as as private uh in the logs and most of them are reducted uh you can enable it back with a user profile but the problem with with user profiles is that it requires a lot of uh user interaction to install a profile so as an attacker you you cannot really do that but it turned out that if you install this profile at the background the system the only thing it will do is enable a setting in the loging preferences and basically it will enable all the private logs so you just restart logd after setting the preference and you get all of the private data in the locks um as we see or so it it can",
        "include a lot of um data yeah and grapping is the hobby that we share with chabba and and this vulnerability was also found in in logs but to to to be more clear uh it was in uh syis loock so",
        "the we application to create a forecast for you it it must know where are you located right so it it sends your location to the Apple server and the forecast is returned from the server but the problem was that whenever the internet connection was broken the full error was locked and the full error included your location because that it was locked what was locked was the full HTTP request so we could just you know break the internet connection and get your location without access without getting you know consent for for the um location permission uh the second leak uh also in the in the locks was uh in iMessage so whenever you opened iMessage uh all the emails of contacts you charted with are just locked so it was that",
        "simple um so that's about leaks let's get into some real stuff because we are here for like generically bypass uh TCC so in the past uh it was a common technique to change the users's home directory with a custom TCC database so one of the TCC databases sits in the home directory in a specific folder and by changing the home directory we could drop basically a new TCC database with new um permissions now this was pretty",
        "well closed down down by Apple uh but there was one thing missed uh we could still create a new user uh on Mac OS with a custom uh home folder",
        "and basically we could drop a custom TCC database uh so the problem was that back",
        "in Macos Ventura uh a",
        "TCC uh entry even in the user TCC database was still kind of global so if you allowed terminal to access your documents it allowed it to access every",
        "other users documents as well assuming",
        "uh you were root as well at the same time it was changing Sonoma uh so in my experience in Sonoma if you grant terminal access to your documents terminal still cannot access other people documents so to the steps to actually exploit this uh we create a new custom TCC database we either create a",
        "new user or we enable the root user which is disabled by default uh with the database uh login as the new user um we",
        "steal whatever information we want and",
        "we reboot now this can be entirely automated uh the way uh I will show it in the video but it the first few steps will be very quick uh so essentially I enable the root user with the custom TCC database I install some autorun scripts",
        "uh uh which will steal the other user uh documents I also enable auto login um so I don't need to interact with the GUI the root user will login steal the data remove auto login reboot and basically",
        "we are back to the",
        "user so this is what we actually see here we have a secret document at at uh",
        "my user and of course to create a new user uh I need to run as root um that that was the exploit now the system reboots uh and because Auto Lin is enabled we will not see um a prompt for the",
        "user so it St now with just a blank screen uh basically in the background there is a process which is grabbing that uh secret txt it's done it removes outo and now it's rebooting again [Music] and once it's back we can uh log in with the user [Music]",
        "and by log in as uh back as root just to verify that I got the",
        "document so the next generic uh bypass",
        "was used by the Safari sandbox broker uh process Safari sandbox broker is the process which is responsible for",
        "unzipping um zip files when you download them with uh Safari now there is a feature on Mac OS or in Safari that it will auto open save files like unzip zip",
        "files this is the first feature I think you want to disable on Mac for for your own uh",
        "security uh and this process has full disk access permissions so basically it means that it can access all of your private uh data I don't know why it needs that but it has it so the way the unzipping process",
        "happens is uh this process will create a directory inside the downloads for ER named F name. zip. download uh download the zip file there then it will create another directory with six character random name and extract the contents uh into this directory now how we can exploit this process to drop our custom TCC database",
        "to the user because this is our goal uh again with full disk access permissions we can override the TCC database so we",
        "create a large zip file like like a",
        "really large one um to actually slow down the decompression uh process and we",
        "add our custom TCC database into this file then whenever user downloads a zip file we quickly overwrite it uh although Safar will continue to write to this file because after the zip trailer everything will be considered a chunk it's not a problem and whenever software creates this six cor long uh directory we replace the",
        "directory with a symbolic link pointing to the TCC database folder and so this",
        "the third step is a raise condition but by having a large zip file with large files it will be slow enough to that we can trivially win it uh every time and once the extraction is done our TCC database will be over written so this is demo so we can see that terminal has access to the downloads folder this is a prerequisite because we need to operate on on the downloads folder uh we start our",
        "exploit it will start",
        "creating uh like one and half gig random",
        "content file uh it's actually pretty slow so I will uh speed the up so it it's done it",
        "uh I think it's still creating",
        "it",
        "and whenever it's done yeah it's done uh I will start downloading a zip file uh",
        "and the exploit Feld detect uh the zip file it will overwrite it uh",
        "and now we are waiting for the extraction to uh",
        "start uh yeah I also downloaded a large zip file so it was SL uh the extraction is uh happening so we replaced uh the folder with a symbolic link and we can see that all of our files are being extracted into the TCC database uh location as well as the new TCC database uh so it was dropped uh that's done and now if we refresh uh the permissions we can see",
        "that now terminal has all sorts of new",
        "access and the third generic One is using an installer install assistant is the",
        "uh it's the Mac OS installer you can download from Apple now the good thing about uh me Apple sign installers that they will be run uh with the system install process",
        "and that process has sip bypass permission so it can write to se protected locations it also has the heritable um part of this right which",
        "means that any of the child process will inherit uh that permissions so these uh",
        "these packages has often uh install a scripts inside uh which means that all of those scripts we run with SIP bypass permissions so if those scripts have issues uh we can potentially bypass zp now it turned out that all of these packages had this link shared support bash script inside this is like a 15 line script containing three different",
        "vulnerabilities uh I highlight did two of them uh the first one is the Len command which creates a hard link so what it did it took the package name the package pass which is under our control because we installed the package uh and linked it uh to Shared support now what the way we can exploit this is we can replace the package with a symbolic link pointing to a c protected file and in that case a hard link will be created uh to the C protected file and because C protection is based on file Parts uh we will be able to overwrite or modify this file through the new hard link now interestingly the last line uh",
        "was also an issue because what it also did is removed the restrict flag from",
        "the file which means it removes sep protection at all so even if we wouldn't have the hardlink SE protection was REM remov from the file so we can just operate on it and overwrite so we could either Target the TCC database or I choice I choose the loo application pist",
        "file which is considered as an other TCC",
        "database in a pist format uh so just here's a quick uh demo of this uh I try to list the",
        "desktop order with a terminal and I",
        "don't have access to it then I try to I log in as rot um to access other locations as well and I try to access the main uh TCC database now this database is uh protected by sip as",
        "well and we cannot even read it if we don't have permissions so now we run our exploit uh",
        "this is lucky pretty fast uh we place the symbolic link and now we wait wait for the installation to finish and that's done we updated the loo application list pist and now uh we can",
        "access all the other files because I granted full disk access rights to",
        "terminal okay my turn uh so I spoted a",
        "command line tool uh CPL diagnose uh which diagnoses mostly iCloud related services and as you can see at the screenshot it is heavily entitled with uh private",
        "apple apple um permissions even there's",
        "a come Apple private TCC allo entitlement which looks like a sweet spot to to reverse engineer but without reverse engineering um that tool requires root",
        "permissions to be executed but please keep in mind that when system Integrity production is turned on and TCC is also on uh even with root you should not be able to access user sensitive data right so",
        "now let's read it together the output of this command line tool because you will see that even Apple Engineers knew that this tool can be potentially",
        "harmful the photos Diagnostics may contain some of your personal information that's good uh including",
        "your location IP address crash Lo iCloud account information and photo meta data such as file names the names of your shared photo streams the names of people and related information including addresses emails and phone numbers framew contact data database locations object and scenes uh in your photos and calendar events associated with your photos and memories statistics about your photo library such as",
        "um accounts and titles of photos moments and the of your photos information related to each of your memories information about your recent and or past Apple music listening activity so on so so many sensitive data right and",
        "there is a protection that you need to press enter to continue and what is funny with this tool is that when you provide",
        "dashh you will see that oh so there is a flag output file where you can specify all this diagnostic sensitive information will be saved right",
        "so just by using this sophisticated",
        "exploit I was able to get all those data so hm but we have the enter protection right but you know just to bypass it just eho pipe and run the tool right and that's that's it and the uh proof of concept you can",
        "see at the screen uh it was just like that you open this you execute this bash script you can see the locations The Dumping uh color the",
        "the dumped iMessage color IDs and of course full photo librar so that was fun it was really good tool and it was like not even hidden",
        "especially okay so now let's talk about uh quart score framework which is a standard lowlevel framework work built into Mac for processing and rendering graphical data and uh generally it will",
        "be loaded by all your maos applications with graphical user interface it doesn't mean it doesn't depend on programming language every application with user interface it doesn't matter if it's Apple's application or a third-party application will probably rely on on this on this framework and even if you use dilip Tree on appkit which is the stand standard framework used by applications you will see that in the tree of uh loaded libraries there is quad score indeed loaded so this is a sweet spot to um to",
        "hunt and the quartzcore framework",
        "because this is the whole DD drawing engine uh it has a lot of functionalities and a lot of environment variables that can control the behavior of the framework so there is really a lot of Nars but I spoted two or actually three interesting",
        "Nars the first one is quart score loog file or x loog file because in the end those two nvar do the same and the second one is xlog file open so let's start some reverse engineering to see what they do so the quartz uh quartz cor loog file or xlog file when Set uh to a file",
        "name it will make your your graphical user interface application start logging the quart score events that were you know happening during the rendering of",
        "Windows and whenever you set the xlog file open to one after you close your",
        "application the log file will be automatically opened by the uh default",
        "text editor Can you spot it back here",
        "I will give you like five seconds because we don't have much",
        "time any",
        "idea okay so there is a string concatenation passed to the system Command right so that means that we have command injection in all graphical",
        "applications on Mac OS with graphical user interface this is really huge",
        "right so what happens next so the system",
        "uh function will spawn a child process uh that will execute our Command because we have the co command injection and the TCC is based on responsible processes",
        "and because the child will be spawn by the parent who is TCC entitled the TCC will grant also the permissions of the main app to the application we executed and you can confirm it with with such a command so I just open find my I pass the quartzcore loog file with the command injection in here and I and",
        "I set also xlock file open to one to make the operating system launch the or open the the file that was um the loog file that was created and as you can see in red Conor ma monitor uh the find M eventually opens the say command I injected in here so let's take a look at the",
        "demo there is no TMP desktop LS file so now I'm running my exploit I will be using Garage Band to inject my",
        "command has been launched now the application it closes the garage band and the command injection is triggered so as you can see on the TCC prompt there was information that garage band wants to access the Privacy data right because we inherited its permissions and now we can see uh the TMP desktop LS file is filled with the ls of the desktop which should not be possible so yeah this proves that TCC",
        "Bypass Great so now let's talk about uh cor Foundation network uh which respects a variable uh CF Network Diagnostics",
        "when which set will uh we will make the process log every HTTP and https request",
        "and you know what it was in the Apple's documentation I haven't reverse engineered it I just read the documentation uh so cor Foundation network is a framework that is used widely in the in the Macos even if you uh use a diip tree on Foundation you will say that in the end you will see that in the end there there's CF Network framework linked and whenever your application uses the standard Mac networking",
        "API the CF Network functions will be used under the hood so most of the Apple",
        "uh internal apps were were vulnerable to build into to the Mac OS so let's take a look at the",
        "demo I'm launching Safari if this set",
        "and everything by cor Foundation network is being locked so what I was able to get of course like in here session ID of my company jira was locked but it was of course the injection in Safari I also do the same injection in in maps which of course needs your need to know your location in order to you know show you where you are so I was able to leak the location uh also I uh used on find my",
        "which includes the iCloud",
        "token which can be used later uh to get",
        "your uh iCloud synchronized data and as",
        "I proved in my talk what happens on your mark stays on Apple's iCloud when you have this token it's possible to D the TCC protected sensitive entries that are synchronized with iclouds and they consist the data of find my um contacts",
        "uh calendars reminders notes photos iMessage and more just to show you the demo if that it actually works I coded a",
        "tool which takes the location I pass the iCloud token under the hood the the tool",
        "um refreshes the M find my location and then it dumps your location directly from the iCloud now where you can see in the that huge Json there is your location so yeah accessing this this tokens is is really is really bad for for for the TCC and your privacy and the next slide is is a bit hard because I want to be fair both with you and with apple",
        "um I want to I don't want to disclose any zero days and and you know because that that could harm you me and all Apple's customers but in the very same time I uh with chabba we've made a submission to blackhead where when I where I promise that I will show you one more bu but unfortunately this B is not yet fixed I reported a severe a major TCC",
        "vulnerability back in January 2023 and unfortunately still",
        "unfixed and I told Apple that I won't uh disclose this vulnerability in November 2023 so I think they have sufficient time to fix a major privacy vulnerability on Mar but unfortunately they didn't so maybe on the next talk I will present it I will disclose",
        "it so let's quickly talk about uh how",
        "TCC is improved over the past four years um so some of the techniques we used in the past are actually dead or or dying going away um mounting over directories",
        "uh was a common technique uh Apple protected uh many files from being overwritten read whatever but you could easily Mount over the directory and either get the system to the to uh write the file uh in there again or drop a new config file uh whatever this is mostly gun after learned the lesson uh many of the CIS admin tools which had uh very strong entitlements they are either",
        "hardened or have been removed uh from the system uh the plug-in techniques like injecting plugins to garage bands uh",
        "image and app all sorts of application uh on Mac OS to gain access to their entitlements that's mostly gone",
        "uh due to the launch constraint um feature that was introduced in Mac OS Ventura all the other apps are signed with hard and runtime um",
        "and in instead of demons loading external plugins now it's basically",
        "moved into an external uh xpc service",
        "which doesn't have any rights anymore and that will load the plugin so these are mostly gone um all grapping or the infol leaks I think file system wise they are almost gone uh really hard to",
        "find any new ones nowadays and and I think the log leaks are also going away um also the application data",
        "protection um makes it harder because you don't necessarily have access to their uh container where there might be some private data also the installer",
        "script box um are mostly going away due",
        "to the new installer script action and mutation uh",
        "protection uh also one of some of the",
        "improvements um launch constraints uh",
        "this was not a TCC specific uh",
        "mitigation uh basically it will control",
        "who can launch an application how can it",
        "launch and from where can you launch an application so for example uh it was a common technique to take an application copy to the temp folder maybe put in a plugin into this uh application and then launch it from there this no longer works so you cannot take um an",
        "application copy it out and launch it uh from there also you cannot launch demons from the command line only launch them as a demon and and so on this was a really really good um Improvement and",
        "and I think it's a really great engineering effort from Apple it makes our life harder uh also the application",
        "bundle and and data protection probably that's the most impactful TCC protection uh",
        "since Monteray it protects the application dat data and the application itself uh at this stage so it's it's nice but it's trivial to bypass uh at this stage which many of our bypasses are still being fixed uh and again overall there are like 16 new TCC categories in",
        "montere so as a closure",
        "uh tcc's app attempt to protect private",
        "data uh which is not unseen in Linux or",
        "or Windows environment and in the past five years it it evolved a lot uh really and it's",
        "getting harder and harder to find uh vulnerabilities so like three years ago it was easy to find the generic bypass nowadays you need to be creative and really tricky uh to find them",
        "uh still only two of us we could feel like three conference talk with just DCC box and there are other people finding these as well uh so that's not even included um so we say said in the title it's final chapter uh yes uh it's been a nice Trilogy um good research",
        "um and trilogies don't get the fourth chapter chapter but what do trilogies",
        "get a sequel so we happy to introduce return to TCC land uh it's under heavy",
        "development and hopefully we can present it uh next year",
        "and we will bypass again everything I think we already have enough content just for that talk so uh yeah hopefully",
        "next year thank you",
        "are there any",
        "questions oh there's one question",
        "okay you have a microphone in",
        "there so I'm sh and just do TCC research",
        "and find some of our buties uh we we just in two years ago we reported Sim Sim similar abilities uh but I find that it's very hard to use in iPhone or iPad because iPad store just a big problem uh do you have any idea about uh this this this one question to you or me uh just just tcd tcd bypass can be used in micro eyes and uh by is hardly to use",
        "iPhone well yeah that's good okay so I I think on on iPhone you don't have many of the features or applications you have on Mac OS which allows you to bypass uh we specifically targeted Mac OS but I know some of our reports showed up in the iOS advisory as well so I guess they were applicable for iOS um I think iOS in general is much more lock down uh than mac so probably there it's it's harder to find uh these issues yeah and on please keep in mind",
        "that on iPhone or or on iPad or generally on iOS you cannot that freely Spa processes like you can do on uh on M so the attack surface is a bit a bit lower right it's a bit Tire yeah that it's hard yeah",
        "are there any other questions yes",
        "okay u h Raymond here I'm just wondering in terms of I saw some of the things like geolocations uh being s of licking the question I have is if you set your location to be off right so you're you're supposed to not have all this data whether it's in logs or whatever right yes uh do you see any of this just like even if you set it to off it is still on I mean it is still sending just you know no I I didn't notice such such um examples like if you turn off location services uh your location should not be sent to uh to Apple server so theoretically such vulnerabilities should not exist what I'm saying is it's not uh in the locks that the this data is residing once you switch it off am I right to say that yeah you haven't seen any of this of course if you if you bypass the if you have compromised the TCC that what you guys have done then of course you know whether you you set it to off or on doesn't matter but if you set it to off by right those those locks and those data should not appear at all right that me this works I'm saying yeah yeah that's",
        "good I think we out of time if you have any other questions you can find us yeah here and stay tuned for the sequel thank you"
    ],
    "aXGV2qSgPP8": [
        "hello everyone yeah Welcome to our talk so today we'll talk about our paper faults in our bus so this talk is regarding fault attacks more specifically bus fault attack where we use this bus fault attack to break the security of armed trust zones so before we start there's a very brief introduction of ourselves so I am Anan his nsh so we are pH students from the Indian Institute of Technology kakur India and this work was done in collaboration with professor de mukad from I kakur so here is a brief outline of our talks so first we'll start with uh a brief history of faults and literature survey on Falls then we talk about the traditional fault points on EMB systems and S so's and then we uh present our uh uh proposal there a uh new fault point on S so's then we discuss about Opti and uh why uh it is relevant with respect to our talk and then finally we talk about our end to end attack where we demonstrate a complete hijack of the system through fault attacks finally we'll end our talk with the impact of our research work and also the takeaway from this so what are faults faults are basically uh system errors where the adversary actively perturbs either the data or the control flow of the system in order to gain access or information uh about uh the through the faulty responses so uh why are faults so catastrophic you know so actually in in digital systems faults do occur although they are rare and mostly they occur through accidents but they if if they",
        "can be controlled and if they are uh induced uh purposefully then this faults can cause errors and these errors can be exploited to hijack the system or leak uh secret information from the system now fault also along with that fault attack some sometimes if combined with other kinds of attack Primitives like for example side Channel Side Channel information as we'll uh show in in this U talk that can lead to much stronger attack so the uh the literature on fault attack is pretty uh uh vast and uh for the last around 25 years there have been lot of research on fault fault attacks but broadly classifying fault attacks can be actually uh classified into two subclasses where the fault injection techniques actually concerns it's with on the actual Hardware the way you want to induce the faults in the hardware and fault exploitation or the fault analysis which actually after it comes after you actually injected your fault it actually depends on the type of uh uh type of uh Target that you are trying to uh attack maybe it this could be RSA or AES but then the analysis technique will depend on the type of Target in this talk we'll mostly focus on fault injection technique so how do we all the attackers actually do the fults so we gener there are multiple ways of inducing Falls but in this talk we'll mainly focus on electromagnetic fault injections so we use the special kind of probes that uh when a current flows along this probe it",
        "creates a magnetic field around itself and if if we uh go back to our elementary physics class from the maxw left hand rule if there is a magnetic field going on it creates an induced current right and that induced current if you place this probe uh next to uh next to an S so or an embered system where the uh some computation is going on it actually uh interferes with the circuit or the current flowing through the circuit that and that can actually create faults for example uh if you see that uh for some computation if if there is no electromagnetic pulse it it creates a non-faulty execution but on uh introduction of this electromagnetic pulse it might behave Rand it might behave weirdly and it might create bit flips in it so there are different types of fault models depending on how you want want to look at it for example if if you look at from the grity that could be single bit fall there could be multiple fi bit Falls or there could be multiple buys or even the world itself but in the literation also in the fall Community it was considered that for the entire",
        "register 64-bit register it's difficult to actually have the faults in the to control the entire 64bit registor but in this work we have achieved that entire 64-bit uh register can be actually",
        "faulted and then it also depends on how uh the what type of fault you are inducing uh it could be stuck at zero where a particular bit is either stuck at zero stuck at one it could be uh some uh random uh bit flips zero goes to one",
        "or or it could be totally random and then it also depends on how that is is able to control it it could be precise for example if you are using a laser fault laser injection to induce a fault it uh it is more precise and if you're using something like em probe em em radiation that that does not give that much precise control over it and then it also depends on the duration of the fault whether the fault stays uh uh whether the fault refreshes for every session or actually it stays for the entire uh lifetime of of of the device so what are the traditional fault points uh that we have in literature and that is commonly considered in the community so if we actually look at s so's and uh look think about the the all the literature that has been uh available to us there are mainly two fault attack points one is the processor itself and the other one is the Ram from the processor perspective uh it uh you can induce faults through external interfaces for example uh uh you can",
        "change the voltage you you can introduce clock glitches which are mostly through the hardware and also from the software perspective you can actually change the dynamic frequency voltage scaling or the dvfs where you can change the frequency and the voltage that will lead to race condition inside uh the processor which might lead to uh fals and when you look at Rams there is a row Hammer where you access the memory very fast that can induce uh bit flips because of losing charges and then also there are em and uh laser bit Falls which can actually uh induced flips in the",
        "memory however if we look from theoc perspective you cannot have external interfaces in anoc and also the dvfs itself is a privilege and if you go into the ram the ram itself uh sometimes protected through multiple checks May some Er correcting checks and also uh there are uh casings on on top of it which actually requires invasive depackaging and also sometimes uh uh that depackaging process might actually destroy uh the chip itself so we asked this question are there any architectural aspects which can be used for fults where there are no known counter measures already uh employed to answer this question we say yes and we find out a new fault point on s's which is a system bus so if we look at a very commercially available uh s so which is Raspberry Pi model 3 so we can see that the system bus is itself is uh totally uncased and it's exposed basically it is printed in in a PCB and uh and you you can totally observe it from top of the PCB and why it's important because it is involved in all load and store kinds of instruction where the both the memory and both the memory address and also the data flows between the processor and the memory all the time so for so the this is a real life view of our setup where the probe is attached to the next to the Raspberry Pi board so now let's let us take an example of a load instruction where you we are loading something from the memory address into the destination register so how does it work basically so first the processor will send the memory address to the to the dam to the system bu and then the D sends the data in that particular place into the uh processor itself however if you induce a fault in the system bus at that point so the original memory original data that is in the memory that uh has got no effect however the data is faulted in transit so basically you actually induce a fault but there is no trace of the fault but the computation with that faulty data that itself is",
        "affected so uh in this case since we are uh targeting the system bus there could be two types of faults one is on the data bus where you actually it results in incorrect data and then there are address bus faults which actually lead to se fall because uh I me because of uh bit flip changes you uh access some I",
        "mean maybe non-existent or maybe unprivileged locations memory and you get set FS however the important thing to note here is that for 35% of the time",
        "we actually get all zeros in the register for the data fault this is something which was uh not reported in literature earlier and this was also considered that it is not possible to do it so we call this as a register sweeping fault model where it cleans the entire value for the load register now the point is it it seems like a very I mean uh Integrity issue right I mean the the data is not there but how does that integ Integrity issue lead to a security uh event so this we show in this case that the register sweeping event actually can lead to an endtoend attack on an open portable trusted execution environment which in short is called Opti on a arm uh trust zone now to talk about opt and also move you forward to the the rest of the presentation and the details of the attack so Nish will take it over from",
        "you um thanks Arin man so uh so so far",
        "we have established that uh apart from processors and memory where is most of the previous fault attacks focus on you can still find a new architectural aspect on embedded systems which is the system bus Which is also vulnerable to external def fault attacks and let's talk about uh one of the most uh interesting implications of the same so op so it's a trusted execution environment for embedded systems uh that",
        "closely follows the global platform API spec and is being maintained by trust and firmware with a lot of stakeholders including Google arm lenaro nxp and the rest and just like any trusted execution environment it splits",
        "uh the applications you have into two worlds the the normal world where most of the applications the kernel recites and the secure world where the most security critical applications for example uh cryptography uh apis and the rest would decide so uh the te uh or The Trusted execution environment would be would have certain features like the memory storage would be encrypted the peripherals would be securely isolated the Contex switch would be secure just to make sure that even if the re or the rich execution environment which is the one to the left to your right uh marked in red even if the re is compromised by some adversary uh by which I mean even if the adversary gains complete control over the re kernel anything that runs in the te is still isolated and secure so in some sense the entire idea of trusted EX execution environments is to give you Security even if the kernel on the re is",
        "compromised and I must mention that anything that runs inside the te uh is is coded and loaded into the te by",
        "the original equipment manufacturer and there are Integrity checks for the same which make sure that you and I cannot run our own code into the te the te uh will expose its own apis and the most weaken do is write applications in the re which will which will interface with those apis and uh perform whatever tasks are needed so from an adversarial",
        "perspective if we are able to load our own code into the trusted execution environment that amounts in some sense to code execution in the te and breaks the security guarantees that come along uh uh from the uh trust Zone that we are working with so let's cont cont ual these goals a little bit more we want the entire attack to be online which means that we do not want the device to be offline at any point in time the reason being that in modern um iot networks and the sorts there are SCA systems and other uh mechanisms in place which make sure the availability of the devices the embedded systems in place so this has certain",
        "implications like for instance we cannot attack the secure boot feature because doing so would take the device offline and it's a bit harder to do uh in the sense that prior uh Works have actually uh targeted secure Boot and now uh it's been like patched against these kind of attacks so instead of going for secure boot we go for the loading of trusted applications in the te and the second is so when we talk about fault attacks we need to make certain changes in the physical environment of the embedded device at a certain point in ex execution so we need to know when that execution is uh coming up so usually what people do is they use some code based triggers that inform when to inject The Fault in our case this cannot be done because uh the vulnerabil or the vulnerable position that we want to inject the fault at is deep inside the trusted execution environment and we cannot inject our own code to trigger the fault injection at that point so we come up with a combined adversary that I'll talk about in a bit that combines certain passive information with active uh adversary and",
        "then construct a completely non-invasive",
        "way of in injecting fults and yeah as I mentioned the attack must be non-invasive which means that we should not be doing any irreversible damage to the device like depackaging uh the upper layers of over the processor uh",
        "that uh mainly to evade detection later on and also to uh make sure that the device is not damaged without uh like Beyond repair and this means that trivial attacks like skipping uh instructions will not work in our case so that's where the the new fault model uh which we just spoke about a while back where you can zero out the entire uh value of a register while the system bus is operational that's where we can use that so this is the abstraction of the U",
        "trusted EX ution environment we are dealing with so execution begins on the",
        "uh exception level zero in the normal world that would be the upper right corner and through a series of system calls we go down to the very bottom which the secure monitor layer that's the highest privileged layer which performs a secure context switch to the left side and then through a series of calls we go back again up on the upper left corner which is where the trusted applications are loaded now in case these trusted applications require some more uh help from the exception level one on the left for instance some crypto Library invocation of the sort that's uh denoted by a key here I believe so it can again uh use those API endpoints to get its operations done and once uh the tasks uh that the TA needs to do they are over we can follow the same path in reverse and send back data to the normal World site so that's how the communication between the two worlds work",
        "and this is where we are focusing this is where the attack uh shall be mounted so when a TA is loaded as I mentioned only the original equipment manufacturer can run its code in The Trusted execution environment so as an Integrity",
        "check uh is done which is just a signature verification if the binary uh",
        "succeeds the verification in that case uh zero exit code is returned otherwise some uh error is raised and uh execution is Abed so let's say if we want to uh like load our own trusted application into the trusted execution environment in that case we we need to somehow do something with this uh signature verification and just like we mentioned",
        "some of the other fault attacks like which could help us by skipping this uh verification or uh like polluting the results of the execution mainly are not available in the context of s so's like Raspberry Pi and the sort and uh one thing I want to mention is that the signing key is not stored on the device by the manufacturer so there's no question of stealing those keys and signing our own applications however uh we want to mention that if the signature verification fails in that case the fault model that we just discussed where we F the system bus it itself it could actually be used to convert a nonzero value to zero and",
        "thereby bypass uh the Integrity check",
        "completely note that this is not an instruction skip we are not skipping the check we are changing a nonzero exit code to zero and by standard Linux convention zero means a success so this is how it looks like we have a aspher RSA verify function that's",
        "stores and follow uh following it is a store instruction that stores the exit code to somewhere on the stack and later on this same address is being loaded back into w0 and a compare with Z with an immediate value of zero occurs and if that works fine then uh if if that works fine then the execution proceeds just normal otherwise it",
        "abots so we mounted the attack on this",
        "particular point in execution and sometimes no effect happens sometimes there's a partial success which means the value did change but not zero but sometimes we did observe the register value w0 to be completely zero or to completely changed to zero and this allows us to mount an end to end attack so basically load the adversarial ta into the trusted execution environment through false and then redirect communication that is meant for other t to the uh to the maliciously low TI that we have and then decrypt that so basically this means that any other TA in the system its communication is it's encrypted communication is now available to the adversary so the first",
        "phase as I mentioned that uh we need to understand when exactly to inject the fault and we cannot use any explicit code uh triggers in the optic k to inform fault injection so what we do is we attach a separate uh set of",
        "instruments that allow us to observe the power consumption of the embedded system under question and this helps us identify when exactly in execution the RSA signature verification is happening here's a oscilloscope output of the same and this allows us to inform fault injection which is on the right here so to unpack the first signal on the top and the second peak of the first signal is where the instruction execution is happening and the last instruction the",
        "sorry the last signal the third signal is the Fault injection basically so you can see the second peak of the first signal is more or less aligned with the last signal that we have and the last signal is the set of pulse strains which",
        "actually amount to The Fault injection so what we propose is that if we we use uh par side Channel as on the left then we can use that to inform and align our fault injection with the move instructions or the store or the load instructions in place and this is a schematic of the same so with fault injection we change a non-zero value to zero which is later loaded and compared uh uh for the",
        "signature verification to succeed and uh",
        "as as evident this fails and loads the malicious ta into the trust Zone as we have and this is the entire combined adversary that we talk of so we use both the par s side Channel analysis plus fault injection to load the TA into the system and this leads to code execution",
        "in The Trusted execution environment that we have and amounts in some sense to privilege escalation so uh now we have code",
        "execution in The Trusted execution environment we like to use that to compromise the communication that is meant for other T in the system so how do we do that so A Brief on how communication or how execution happens in The Trusted execution environment the insecure world if it wants some help from the secure world for uh like operations like cryptography or the sort it invokes a certain ta which is uniquely identified by a uuid a unique identifier and that ta is loaded into the uh trusted execution environment and performs its task now the API spec uh on which opt",
        "and many other uh trusted execution environments for embedded systems are constructed they give the responsibility",
        "of choosing The UU IDs or the unique identifiers of the TS to the equipment manufacturer now here is a very important assumption that is in play so recall that in the T in The Trusted execution environment only the OEM or",
        "the equipment manufacturer can load their own code so it makes sense that the OEM will choose the identifiers that will not collide with each other or will be unique and as a result the behavior of the system when two t they share their unique identifiers or when the unique identifiers are same that's undefined and in our experiments we found that if this situation indeed arise then a non-persistent trusted",
        "application is preferred for execution over a persistent trusted application where persistence is just like a a server client scenario whether uh you shut down or whether you like uh remove the resources that the server has uh after the client closes the session so the persistence is defined in the same sense and this is where we uh chain the two attack vectors so from the the first attack Vector we load a TA into the system make it non-persistent and make its identifier collide with another",
        "identifier uh in the system and redirect communication meant for some other ta to our own te but I must remind that this communication even though we have been able to redirect it this communication is still encrypted so now comes the question of decrypting it so there exist third party extensions which do Key Management uh symmetric Key Management which is used to protect this communication um these extensions they",
        "do not allow uh adding debuggers or just reading out the key uh they do not allow unauthorized reads to data pages that hold the key and they look something like uh this on the left so whenever uh keys are needed a key transfer request goes to the extension uh the keys are transferred and after the operations a key surrender happens and post that the application can proceed with sending the encrypted and the signed communication to wherever they want to however our observation here is that this does not extend to segmentation",
        "fults and uh recall that the attacks that we discussed that sometimes through bus Falls when the address of the memory being accessed is incorrect ly faulted we were able to um handle U 6f signals",
        "so it turns out that if this situation does arise before key surrender then in",
        "the codoms file that follow we have the entire key uh readout and uh again since",
        "uh the communication channel was protected by symmetric Key Management doing this on the normal World side where the adversary has control over the Kel also compromises the keys on the secure World side so a bir eye view of how the entire uh three uh attacks are chained together so assume you have a tier uh machine learning maybe uh that you want to compromise the first step is on the very",
        "left where you use the faults to load your own ta into the trusted execution environment and get and gain code execution there the second step in the middle is to make sure that the identifiers for the TA that you have loaded it collides with the identifier of the victim ta that allows redirection of communication and",
        "the third step is to induce this uh segmentation faults before key surrender to get the signing keys and the encryption and the decryption keys and from there you can uh simply uh just decrypt communication and if needed resign it also and forward it if needed so that's how the entire uh three attacks chain together and they break the uh security guarantees of Opti uh which transitively follows the global platform API spec so we we found that any any uh applic any trust execution",
        "environment that follows the spec is also vulnerable to the same attack so a very quick note on the impact we reached out to lenaro which which maintains Opti right now uh we have a CV here and we also work with them to deploy a countermeasure for the same in the Opti kernel so this is a snap of the counter measure that we jointly developed and I like to draw attention to the last function call here so in some sense it's a fault mitigation set check result not zero so this is uh in response to the fault model that we introduced and the idea is to to maintain some stateful information and check when the error code or the result of some operation is not zero when it shouldn't be zero so that's the exact thing that we were trying to do and a very quick um idea about some other implications of System bus faults specifically in the context of embedded systems we were also able to reenable attacks on AES uh that follow table",
        "implementations uh they were in some sense prevented ever since defenses came out against fault attacks on processors and memory and uh we were also able to use the address bus faults uh which was the segmentation fault attack uh the third attack that I just discussed the same attack can also be used to uh break M pqc implementations like kyber and the same so uh pqc implementations like kyber they are the standards as we move to the Post quom world that nist has already standardized and it seems like that although algorithmically everything is fine but when we go to implement the same we Implement all the shares of the secret key in one C++ like structure so one fault will be able to leak all the members of the c or C++ structure and you get all the shares and if you get all the shares you can combine them and leak the key directly so takeaways",
        "when designing the system it's not just the system but also the execution environment that comes along with it this is specifically important in the context of embedded systems which are supposed to be secure even without human supervision so that's where physical adversaries come up uh side channels faults and these kind of attack vectors are also there secondly the new fault model that we came up with on System bus so prior to this only uh faults on processors and memories were considered but System bus is also something that we show can be faulted so that's also something that needs to be kept in mind as I mentioned we did it on Opti which is just one implementation of a trusted execution environment spec but what are the implications for other systems that also run on similar embedded devices and",
        "thirdly API spec should be or rather we",
        "propose to be rethought uh in light of uh adversaries that can do SCA and fi the reason being as I mentioned uh the the reason we could do the second attack was because the API spec was assuming",
        "that only the OEM or the equipment manufacturer can load their own code into the trusted execution environment and they left the responsibility of identifier uh Collision onto the O",
        "basically but if that assumption is voided because of some attack like this then uh any security that is derived from the assumptions that stands void and I'll end with the uh so this is the setup that we used for this entire work and um the capabilities of this setup they have like side Channel analysis power and both electromagnetic side channels fault attacks fault analysis and to some extent also microarchitectural attack analysis so thank you and um if there are any questions then we can have them and thanks a lot for for listening yeah thank you"
    ],
    "wAmGU2YUa9Y": [
        "welcome to my talk you shall not pass analyzing an NSO spy",
        "sample um it's a pleasure it's and it's an honor for me to be able to stand here on the stage at black hat my name is Matias freeling and I'm the VP of research at the company I verify my main research uh directories are iOS maver and mobile device Security in General on September 7th in 2023 Apple",
        "released a kind of emergency patch for iOS 16.6 do1 closing two specific vulnerabilities",
        "which have both been exploited in the world one of those vulnerabilities the first one got pretty famous just a couple of days later and it was called the webp vulnerability on the same day citizen lab published the latest research about the Pegasus blast pass export chain on this specific sample NSO used a pasket",
        "attachment which was delivered over iMessage to INF fact iPhones with a zero click export chain the specific Target here was a person working for a Washington DC based Civil Society organization and the exploit was found during a routine forensic analysis that has been done on the specific device the attribution was made to NSO there is a couple of other blast press reports which are available um our own blog which is featuring a preview for this specific specific talk and then once again there is also another report which has been done by Amnesty International about the",
        "sample",
        "today I'm not going to reveal any more zero days and I'm also not going to leak any weaponized sample of this export chain but we're going to go on a journey on how we've discovered and analyzed the latest sample of nso's pigasus exploit",
        "chain what I want you to remember about today is that detecting iOS M with forensic analysis is possible and I'm going to show you the step which are necessary to unveil the final payload of the sample and we're going discuss some more specific indicators of compromise for the specific sample which haven't been discussed in public before so this means we're starting right now here on this little map and the only thing that we have is our knowledge about this Blas sample last year in October customer reached out to us and they told us that they found a potentially compromised device so if a customer reaches out we're usually trying to do a forensic analysis on the specific devices so that means the customer gave us some data sources in this particular case we got access to crash locks an iTunes backup and some Telemetry data then you're using normally a couple of tools um for crash logs you have manual scripts that you can do there is not a wellknown tool already available but for an iTunes backup you can Resort back to mvt which is your mobile verification toolkit which is developed by amnesty and the defa facto standard for analyzing iTunes backups for compromises and for toet data you will run back to scripts but what are we trying to do with this data sources so in the essence we're looking for examples of suspicious activities this could be a process which is starting from private temp it could be a process that is Doing Network calls or a process that is running with elevated PR privileges such as root um additional indicators of compromise of files that have been Wroten to disk or if a process is crashes repeatedly and the first Glimpse that I'm normally doing is I just scroll through the list of available crash locks and then in this particular case there was one pattern which was pretty obvious so we had a couple of Home de crashes which were about 25 times then",
        "there was a little break and then afterwards we had 35 messages blasor service crashes and messages blasor is in particular interest here because the S the citizen app report was named blast pass and messages blast door is the service which is responsible for unpacking IMS attachments and to make sure that those are rendered safely so this is suspicious so and that means we should take a a little bit deeper look so if we're looking at the first home de crash what we can see is um of course the name of the process we can see this particular device is running IO 16.6 and 16.6 was still vulnerable for blast pass um and then we could see also that this process is just crashing with a with a normal s board at this time I was believing that this particular crash was actually not um part of this exploit chain but it resolved to another exploit chain which is called Pia home which was valid until iOS",
        "16.12 so it looked to me pretty obvious that the attacker might have been just tried to use an old exploit this failed at first and then they change to the new exploits so not burning any new chains if we're looking into the messages blast or service crashes we can see that the Exum type is already much more severe because this is a bad access and it's a protection failure at a specific memory address so something was clearly going wrong if we're looking into the threat that actually crashed what we can see here is um that on line 67 we started to see that there's an an archo which was decoding a couple of objects and if we're scrolling down on this one we can see that this goes up to line 510 so this has to be a very very large key ariver which has been unived",
        "um or maybe something is clearly wrong with the sample for me that's suspicious as well",
        "so I had a couple of crashes which were all going on on specific time frames this is a perfect starting point if you want to look into an iTunes backup for further analysis and if you're quickly checking the backup at this specific point in time we also saw that there is a couple of that there is a process I am transfer agent which did a couple of network calls this process is responsible for downloading iMessage attachments so this makes sense if we have a messages blast or crash and we have a process which is downloading an attachment before but the question is can we also see that specific attachment in the data and yes we can we can see that there is a sample. PK pass file which has been downloaded eight times it could be all the same sample it could be different samples that have been downloaded we don't know that yet but we do know we have this specific mention in three times this is very suspicious as",
        "well but the golden question are those files actually in the backup and yes they",
        "are so at this point we're mostly done",
        "with a certain state of forensic analysis because we've already found a specific sample that is interesting for us so what we're doing next is now trying to figure out what is a PK pass sample first um and there's an expert that we since probably last year can always ask which is always a good choice We just asked gen GPT and the the actual response that we get here is not that all that that off or wrong so it tells us at the the second paragraph at the bottom that a PK pass file is actually or essentially a zip archive uh and it contains a couple of Json files well of course we always should validate so let's check it with file and what we can see here yes indeed it's a zip archive and the zip archive is roughly 175 kiloby",
        "large so let's uncov it and see what's inside of this if we look inside we find a couple of Json files as predicted but we also find file which is a logo. PNG that's directly stands out and that's not only because it has like 5.8 megabytes of a size which is quite a lot so that logo is definitely",
        "huge um if we file again then we can see that this logo is actually not a PNG file it's a vbp file and this is where it gets really interesting because this ties us back to the vbp vulnerability that we've talked in the very beginning um this particular vulnerability is not really solved yet",
        "and there's already a lot of talks that have been going on here and I'm not going to add any more details to the specific vulnerability today but I I do want to make at least a little bit of note that there is an upcoming talk by Ian be who is probably going to talk a lot about the specific vulnerability and it's uncovering a couple of the like unknown questions at the",
        "moment now let's take a closer look at the sample and what is usually the best tool for V analysis this is very obvious of course it's strings so if we run strings on this um what we only get is a couple of A's so that's not really helping but maybe we should have started to look at the very beginning of this file and if we look at the strings here there's a there's two things that directly stood out to me the one is there's a binary P list which is embedded in this file and the other one is there's a couple of function function functions in the bottom and of course there has a couple of different strings like an NS call stke array like DL open M Copy so on and so forth that you would never expect to see in a PNG file or even in a webp file okay so we definitely need to investigate further it's this stage I could have gone multiple ways so I could have decided to look more into the vbp vulnerability how it was constructed off but I was more interested in in getting to that stage where the NS expression is and um working on this binary pist file so let's extract this B pist",
        "file um it took me a little bit of try and error to get this actually fully extracted and it was not fully clear if the binary P list is actually just starting somewhere in the file and it goes to the to to the complete end or there's um some some other part at the end which is not belonging to that but at the end if you do it with DD it works pretty well and you get to a BP list now what's a BP list and how can we read it and once again Chad GPT is a very good help here we have two two tools which are very good for that let's start with",
        "PLU um if we start here directly at the beginning of the file um what we can see is once again another like a lot of a um and then if we go to the bottom we can see that this specific BP list has like 113,000",
        "entries this is not really helpful for analysis so let's see if pis body itself does any better",
        "uh here we can already see that there's a couple of dictionaries and NS Aries which are contained in the specific pist file um but there's a lot of unprintable data as well and at the very bottom of the file we can see there's even more of that this is not going to help us here we need to understand this a little bit better so binary pists are very often",
        "something which is called an nsq dyo and this is a concept which has been used in iOS and Macos very frequently and this is essentially a method of serialization and deserialization of data um an NSP",
        "archiverse they will always start at a root object and at this root object you have a couple of objects which are lying like basically uh in line below it those",
        "objects can be an array a dictionary an integer a string or any other kind of complex object structure and those",
        "objects itself can then include other arrays other dictionaries or other objects but all of those objects are essentially back reference back to those first object that we have in line so this makes it actually very easy for us in this particular ular analysis because the only thing that we need to care about is all those top level",
        "objects and that means it's time for some python magic so what we essentially want to do is import your favorite NSK ke arival lip read and understand security a little bit sa to on break points and essentially just replace array objects and dictionaries with their top level keys and do not recursively go through the file and at the end you print the result and it should be all so if we do this what we're getting back is essentially a structure which looks like that so we can see a couple of the objects and if we go to the end we already see that we're down to passing objects which is like at the end of reference 263 so are we better off here yes we are",
        "because we're down to 264 individual objects that we need to analyze and then afterwards we can figure out the structure so so let's look at a couple of those uh and one of the first ones which is in particular interest is object reference eight and this one starts with a reference to nine then you have a lot of references to 10 which are repeated then you have 15 times object reference 11 10 again um 11 10 11 and",
        "then at the end go Z so 11 seems to be important so let's give this a closer look and inside of 11 we can actually see that we once again see our NS expression the function function function function okay this is good um",
        "that's our payload essentially at the end if we're looking at some of the other interesting ones we can already see here that we have another object reference to a lot of A's and then we have another one for a little bit less a still quite a lot um what makes it a little bit interesting here is that because you have all those A's um and this is something which has been used in every single basic exploitation class if you're trying to exploit a buffer overflow you fill it up with Ace until you know that you can essentially compromise the stack pointer um or the return pointer and then you know where you are on memories so this is whatever you people tell you at first always put this Ace on um so it seems to be that the people who are roing this export for nsos are still sticking to this primitive they could have used some whatever random string they didn't have to use Ace but apparently this is still the same so essentially you could have detected the samples if you would have unpacked it and just looked for 15 20 25 or even 250 a in common and probably this is not the last time we're going to see this even in weaponized exploits um object reference 259 then contained another time the payload so if we sum this up our payload 11 um was used Two Times by objects uh 8 and 259 259 was referenced by 242 and",
        "then it gets back to the top level so this is great so we only know that the only object reference that we need to take care of is essentially object 11 so",
        "let's inspect that payload the payload itself is structured and I'm making this very easy here is",
        "you have some binary data at the very beginning which is a couple of bytes then you have a couple of bites and then you have the embedded strings that we've already seen this is followed by the NS expression",
        "um some bytes later and some strings again and then at the end it closes with a lot of null bytes and then everything else just repeats exactly like the first half but of course the remaining questions are what do all these sections actually do and what I focused on here is once again the NS",
        "expression so we've uncovered the payload right now until the specific Z and once again of course we can go into different branches and I took the branch of just looking at the NS expression but what is an NS expression itself and if we're looking at Apple's documentation we can see that apple is designing this essentially as a function this is allows you to to filter arrays",
        "or searches or sorts um the overall or like the larger category of that is called an NS a predicate and those NS predicate can have those NS Expressions which allow you to execute certain logic operations so essentially you have this function call then you have a receiver a selector name and an argument and let's look at an example so you can have a string which is developer tools o test and then you have the selector which should which is named last pass component and this should resolve then into o test which is the last pass component of the string and that's in a very essential how those nness expressions are built up",
        "um if we're looking at the structure of this payload and I'm a bit sorry because this is so small but it's going to get better what we can see here is we have a couple of casts casts to NS thre and the NS thread. class um then we have a couple of references to um an dictionary",
        "where different parts of payloads are going to be stored and I'm calling those payload CS payload C and pilot X because they are stored in the keys for the dictionaries x c and CS and at the very bottom we have a a larger payload which is the one that is executed first but there's a first question that we need to answer why is this still possible and I honestly don't know in iOS 15.1 Apple introduced a mitigation that should",
        "prevent any of those specific casts for for classes like NS Fred to still be able to execute um IB already introduced in a talk about NS expression um that those mitigations are only implemented by a specific flag which is had like to Falls in memory so that means if NSO found a way to set this flag back in memory with a memory corruption back to one they can execute those classes again um but I haven't found any specific evidence on this export chample sample yet but I like I said I didn't go in much detail about the specific corruption that has been going on um if you're looking at the slide deck when you're downloading it later on you will find a lot more references to NS expressions and how they have been abused in certain exploits before because it's not the first time we've seen that in for entry there was another NSO exploit who which used already NS expression then there is a great talk by andb at last year's obts um about a Sandbox escape and webkit which used this as well and there is a great talk um by Austin EMT at last year's blackhead about how you can use NS expression for exploitation and I don't think this is going to get away so it's a perfect time if you're interested in that just looking some of this up okay so let's get back to it and let's talk about this first executed payload and let's look at it in a little bit more detail so the structure that we can see here is that this is essentially a large base 64 encoded string and so",
        "why don't we be naive and just try to do this and this is not working and",
        "why because I've overlooked that this",
        "specific sample is still using a little bit of compression methods um so we need to do this decom first and we need to understand how this works until we can actually decode it and let's not be naive too so we already used our expert for a couple of things and why don't we try to do this once again with an NS expression and here's the interesting thing because large language models are very great at at taking languages and translating it into other structured languages this is a good opportunity to just try this out if they can actually turn an NS expression and turn it back into Objective C code so I just basically cut out the payload I put the all NS expression in and I put it into tgpt and ask it if it could transform it and yeah it did a pretty pretty good First Response it wasn't perfect but the only question that remains is does it work and yes it does so if we're looking at the and decompressed string what we're getting back to is essentially a l another very very large n expression and this was so large that it was just not easy readable if you just tried to go through it so it's time again for some more python magic and if we do this we result to a nicely formatted NS expression that we can start to go through um this one had actually 2,5 13 line lines of formatt NS",
        "expression this is going to be",
        "fun okay let's look at a couple of the first lines that we're seeing here um what's the first one of the first thing that this NS expression did is actually load another uh framework and they're loading a framework which is called the office import framework and this office import framework contains a very specific object which is called an OC mapper and this OC mapper has a very nice functionality because it has always a mapper for the current thread so that means this object is always going to be the same if you're still executing this in the the same threat and this is perfect if you want to store something and use variables and NS Expressions NS Expressions itself doesn't allow you to do any kind of variables to do Computing but if you have a dictionary that you can always refer to you can store something in this dictionary with a key and then you can get it back and you can do computations on it and we're going to see that in in every part of the specific NS expression um you can see the store value at the very bottom um and you can see that this is used again um on the next lines for computations um to be able to add or substract something they're going to use something which is called NS predicate utilities which allow you to do some very very basic calculations and then directly in the next lines what we can already see is that they're starting to decoding some of those other payloads that we have seen on the first slide um so this one seems to be once again A B 64 encoded string and then they're storing this one in in another variable in the dictionary and then afterwards they using pist deserialization to get to the um to get to the unpacked part okay so that also means that payload CS is a pist that's interesting so let's try to decode it once",
        "again and that didn't",
        "work we forgot something and if you look back again at the overall structure um",
        "of the payload CS in the very first slide what we can see here is that this payload is basic4 decoded but it also has something which is called a cut de compression and then once again it uses some a um Bas 64 decoding",
        "I have no clue what this is so what's a to Bas 64 decoded data and this time I didn't rever to chat GPT but I just wanted to find out if Google knows anything about this and they don't so second try what about cut",
        "decompressed data Maybe we're a little bit more lucky here and we are so we can already see that we have one specific head which is on GitHub in the core Foundation framework okay that's good",
        "why don't we just try this and once again and let's search on GitHub all the 4 AF to basic4 decoded",
        "data and if we do this um we get a couple more hits and which once again refers to to another framework that is used I could have made my life so much easier at this specific point because think about it the specific NS expression is executing in a process so that means that this specific NS expression is only able to execute",
        "functions which are available in this process so that means if I would have just taken the a messages blast sample U blast service process and I would have looked at all the libraries which are potentially loaded into it I could have very easily just found one of the potential libraries where this is it and just inspect those okay but why go the easy way if you can do it hard okay now let's import this Frameworks and let's try again and and then we're getting to the binary P list we can already see there's a couple of text inside of that which is very nice and then we can have a very closer look at the specific pist file and if we we also do the property list the serialization we're getting to a very nicely structured dictionary where we can actually see that there is like an iPhone model there's a couple of references and on those references then you have a couple of variables with some integer vales to it okay so this integer values look like some kind of help for computation or some potential memory offsets um and some of the interesting things here is what we could see is there's no reference to any kind of iPads so either this exploit is not valid for iPads at all or they have a completely different exploit and it's also only valid between iOS 16.4.1 and 16.6 so anything uh later",
        "is actually not in this conflict file this is great now we have two of those payloads already done and we have two to go so let's look for payload C and we can see that payload C is mentioning in our um first initial payload in in lines 99 uh 119 sorry in lines 99 to",
        "115 it's using a slightly different compression MTH format and it's also once again uses property list serialization",
        "so this should be pretty easy um to decode that and we can also see in the overall structure at the very beginning that it's using the same kind of AF and cut decompressed and once again AF compression method that the previous sample pilot has used so if we're decoding this um then we get once again a property list and this contains another NS expression and this another NS expression has another payload which is inside the payload",
        "C okay so we have a compressed payload which is inside compressed payload C if we decompress this compressed payload inside compressed payload C we're getting into compressed payload inside compressed payload inside compressed payload C and if we do this once again we're getting into compressed payload inside compressed payload inside compressed payload inside compressed payload C but then actually it stops so",
        "after we have decompressed the last one we actually down to a very very end where we only have like one remaining NS expression right three are down one to",
        "go but there is no mentioning of payload X in neither payload or in any of the payload C's and the subsequent payloads in it we probably forgot something and what we forgot is that there is another payload which is inside our initial payload at the very very bottom of this file um the the compression for it is something that we we already know about so we just have more payloads to do but hopefully this one gets a little bit easier and yes indeed um if we decompress this we just get one very nicely structured NS expression and what we can see here is there's a mentioning of payload X at the very very bottom of it right this is",
        "perfect unfortunately not at all because",
        "this specific spefic payload is AES encrypted and even though there is the variable which is in the key which has a specific entry in our dictionary if we trying to follow this variable through the whole NS expression we don't have any specific mentioning of the key so there's no key in clear site probably the key is somewhere else in this whole payload or maybe the key is downloaded from the internet I don't know this yet this leaves to a part where we did some part of the payload analysis already but we reached a point where",
        "we're not able to progress any further so NSO just hit Ro block for us is this the end maybe because there's a lot more to discover in this specific sample we still have the home de crashes where my initial assumption was that this has been another export chain but amnesty also found and their forensic investigation of this specific sample um",
        "that there was also a call and invitation so maybe this is a first part of the chain and we also have a couple of the other things not really accounted for so where is the nest expression",
        "bypass if there's another sandbox Escape",
        "is there's a pack bypass in all of those um is our encrypted structure really the implant or is there any other mentioning of a command and control structure that we haven't figured out yet so what I can already tell you is the story for this sample is not over and it's going to be to",
        "continued all right let's summarize what we did today we started with a couple of messages blast or service crashes and those led us to investigate the backup and in the backup we found that at this particular point in time there was an IM transfer agent process which was downloading a couple of IM attachments which were our sample. PK pass",
        "files if we investigated the sample. PK pass files we found the logo.png was which was actually a vbp file and it was not a PNG file this contained a binary pist and this binary pist is if we de archived it contained an object at reference 11 which contained an NS expression which then once again had a couple of different payloads on the first payload we had a reference to those payload CS",
        "which contained a config file and another reference to payload C which then contained another of payloads subsequently which we all decompressed and then it contained another payload and this other payload did have the reference finally to Pilot X which is our encrypted sample",
        "now this is already it's a good starting point of course the analysis is not done but the great thing about this is we have a we now have a couple of very interesting sample points where we can already have a couple of ioc's based on that so the repeating messages blast or service crashes are definitely an interesting sign and they're definitely suspicious it's not a clear ioc for the specific sample but it's always worth investigating the specific sample. PK pass file it's definitely I ioc that you can easily check within mvt and automatically alert on then for a couple of times now we have seen that attackers are using file extensions but the actual file type is not matching those extension so once again this is not a perfect indicator but it's a good starting point for in investigation then if you look inside the P list you will see all those A's and this is also a very very clear clear indicator so even even just taking those a is probably a good starting point to just investigate this particular file a little bit further um and what I can tell you is if you ever find an iMessage attachment which should be a picture which contains a couple of strings which are just called function function function function function this is most likely malicious I haven't seen a single case um where this is not true so just taking those particular samples like the A and the function and if Apple would have just imp imped a function of looking into any iMessage attachment just trying to search for this and alerting on that they probably could have found a lot of exploits already um just by doing this and probably not so much of a performance cost and then of course we have seen the specific payload which are also very visible and clear text uh even just by running strings on the sample and those are very very clear",
        "iocs all right a is this slide a one of you will ever get into the situation that you're receiving an specific Apple thread notification or if you believe your iPhone is compromised and you want help in doing the analysis or even protecting you further please contact us at info@ ay. reach out to a couple of other sources like Amnesty International citizen lab access now or feel free to contact me directly on Twitter or on",
        "LinkedIn okay what I want you to remember from this talk is Iowa forensic investigation works but",
        "we need much much more scale we are doing way to less forensic investigations on particular sample which is an advantage for attackers and then also if we're looking at IA vulnerability mitigation such as the mitigation iOS 15.1 those mitigations",
        "are just bypassed with even more vulnerabilities so I'm not completely sure if this approach is always going to be the best in trying to tackle the specific problem of mercenary spyware and what we could also see here is that spyware vendors tend to reuse very very complex exploitation Frameworks so there's a very high upfront cost in developing those but if you can just reuse those over time this makes the whole exploitation process a lot easier for them but it also makes it a lot better for us as Defenders because then if we can find the same pattern of behavior again and now if we just search for every NS expression inside of an iMessage attachment we have a very very good starting .4",
        "inis thank you very much for listening to me today and now we have a couple of minutes left if you have any",
        "questions yes please",
        "uh yes so the question was if we know if the sample executed correctly um I honestly can't tell you I tried executing the sample on my own and I observed that there was at least a couple of those crashes which were resulting as well but I also observed that there was a couple of behavior on my phone but I couldn't really tell you if this sample executed correctly or not because we probably missed the first stage of the exploit that set up the stage correctly for this NS expression",
        "yes yes um so the question was how how much time did it take me to do the work of decompressing those NS Expressions uh one of the first Ro blacks of course was this cut decompression which took me a couple of days to figure this out um and then I probably spent two or three weeks like in full of trying to to get a very first understanding of this one and then I unfortunately had to stop but the investigation is still",
        "continuing yeah so the question was because uh we haven't seen it for the first time that attackers use NS expressions and people are trying to do the tedious work of decompressing it um and if it would be good to develop a framework or a tool to do this um yeah absolutely I started doing this a very little bit on myself and maybe it's time to release some of that and try to do it in a more General approach but I also know that I think I be already did that so maybe we just try to reach out if we can like disclose a tool for that or like make it open source",
        "uh the question was if I know the mechanism that triggered the execution of the NS expression in this particular case um no this is still an open question to me but I very much have hope that Ian is going to disclose more about this in his talks that is upcoming does this work okay thank you for the excellent talk I really enjoyed a quick question about like you show like multiple really multiple layers of uh compression and encoding what's the logical explanation why do they need so many layers are those different components glued together or what's the purpose or just to complicate your life I have no clue about this",
        "one um so if you look at it you will see that there's a couple of of ternary operators which essentially are like if Clauses and you can see that um the example is trying to calculate also how long it took to calculate certain things and if if some of the parts before that are ready or not um maybe it's because they chained together certain elements and build that in in like an exploitation framework or maybe they just wanted to make the the work of export researchers harder I don't really know for at the moment so if they change together that means they probably on the every level they have multiple other components to to be chained alternatively so that just gives a bit of scale of their um other",
        "capabilities is is that what you're saying yeah so what it looks like um that this is pretty much very modular in state so you have a phase where you have this config file which is used then you have another phase where you check if the config is actually existing and if it doesn't exist then you're just um you're exiting and you're not executing anymore and you're also having a phase where you're then loading like the additional encrypted um payload and I've also seen that they're doing xbc communication to other processes even though we haven't fully figured this out yet so it's definitely a very very modular approach all right thank you very much all right I think we're at the end once again thank you very much to listen to me and I do hope you will have a wonderful black hats"
    ],
    "QDHimyzoSuY": [
        "today we are going to talk about some voice Vision groups and focus more on the malicious app used by the groups called secret",
        "calls my name is Soju and this is y who is speaking with me we are from SW a cyber security startup in South Korea although young is within different company now we have been tracking both fishing groups together for the past two years this session can be seen as an extension of the presentation when voice fishing met malicious and app at black Asia 2019 voice fishing crimes have been identified in sou Cora since 2006 and they are still occurring today their goal is to extort money and they'll do anything to get it as it is money-making business more people are doing it more South Korean are performing these attacks and move abroad and operations there run operations there here are statistics for voice fing with iation as you can see the number of victims and the amount damage picked in 2019 and then dropped significantly this is likely due to the nature of these attacks where the group members work together in physical offices and the impact of covid-19 of course there was a lot of credit to the active investigation from LW enforcement",
        "agencies however despite these effort",
        "the damage increased again last year after the pandemic ended the increase in the amount of money despite the decrease in the number of victims means that the damage per victim has",
        "increased this means that voice fishing groups extort the maximum amount of money from their victim through various methods such as taking out additional loan what about bio attch type in Korea",
        "we usually divide them into three main categories messenger fishing fake runes for repayment and institutional",
        "impersonation if you look at this uh you'll see an increasing number of attacks that involve runs for repayment and impersonation in institutions",
        "because impersonating LW enforcement gives the give the attacker complete comfor complete control over the victim Cycles it is on the rights so how exactly voice are voice fishing groups organized and how do they carry out their attacks the structure of a voice fishing group is more complex than you might think the reader is usually based overseas and the separate body under him Opera in South",
        "Korea the this is the structure of the so-called menance group arrested in",
        "2022 the C Center is first Frontline making C and conducting voice fishing attacks on large number of people with personal",
        "information the administration department is responsible for recruiting and managing people there are rules for withdrawing the exted money from the Target exchanging money and managing",
        "bank account and laundering the exted money by converting it into gift card luxury items and gaming tokens",
        "Etc with fishing groups can collaborate with teams responsible for each Ro without directly operating on it department they can work together with a sybox operator who converts international number to Korean number with or and with teams uh that Acquire personal information databases develop malicious apps and build internet funds let's take a look at the actual content of the submission for law enforcement impersonation cases there send fors disguise as an official document about the case along with a message saying that the registration has been has been returned and request contact them with a specified number once pep C the C Center start their teex scenario in this case the scam SMS disguises an uh Korean internet bank and used keywords such as last minute specialer first conver served in the tax with intention of tracking targets un lastly when I first received the SMS I seriously considered calling them the interest rate on my loan at the time was",
        "6% here are some teex scenarios including runes for repayment and impersonation of institution all of which start with a smishing or direct call in runes for repayment the groups try to convince the target to take out the government back loan then they demand the fee full the loan if the target respond in other cases the other member of the post as an employee of an existing lender and extort money by telling them it's a breach of contract and you need to pay a fine in this in the case of impersonation with institutions the groups often impersonate law enforcement and Regulatory Agencies they then threaten the targets",
        "account has been involved in a crime and there will be consequences if they don't cooperate with the investigation to improve their credibility they utilize fite that resemble law enforcement and display pages that look like real official letter to pressure targets then they extort cash for the investigation purposes were to protect their funds in case one they trick the targeting to downloading a malicious APK through a Messenger account posing as law enforcement they then perate the target to make the C themselves which is fored to another member of the group using forwarding feature supported by the",
        "APK case to use a combination of both of the previous two method they first scaled and with fake document and second they encourage them to call institutions after the installing the APK each stage in this diagram is progressively darker in color from top to bottom indicating that the target will be more and more psychologically controlly by the attacker we'll cover the Cor foring in more",
        "later this demo shows two similar impersonation cases the attack flow is shown Below in this video they originally spoken in but I use AI to D it into English uh yes are you Mr XX yes",
        "yes thank you I'm calling from the detective division of Gango police station and I am inspector hunjan yes yes I am contacting you regarding a witness inquiry related to the financial transaction act violation I am wondering if you'd mind speaking with me for a moment oh yes tell me about it recently we arrested a woman in her 40s named Lee gon who is the main suspect in prostitution and financial violations charges at a studio located in seong G Nam soul and I was wondering if you knew her investigation I will visually show you any official documents issued in your name or transactions from the bank account that have been used are you able to view these on your phone through neighbor right now yes yes you know the address bar not the search bar on neor right yes please delete all of that including the WW do have you ever heard of the term embargo like a publication B yes yes it's a term used by media Outlets to mean a publication ban until a certain point in time right within the prosecutor's office we commonly refer to ongoing investigations as embargoed this case is also under investigation due to concerns about accomplishes fleeing or concealing criminal funds therefore I will inform you using the internal IP of the prosecutor's office I will read it out to you number 61227 then 70. next 33 yeah well U or",
        "someone you know recognize at a glance that this is a scam it would be hard for noral people to tell the is getting more",
        "sophisticated now let's look at the infrastructure used by The Voice fish attacks the malicious infrastructure is available as s from providers A operator groups pay the provider to get the fishing site and they are given an admin panel to control the devices infected by the",
        "APK providers are building Marv infrastructure and fishing site we identified only three providers using the Supreme Pro secur ofice theme ex as an example they have built pages that identical to the mate site the purpose of of this site is to trick the target into accessing their site and redirect them to a fake case inquiry page to convince them that is a them the real investigation is underway all of this site is for under case two of the attack scenario and each provider distribute their own malicious app with a COR foring feature among them provider a impersonate Supreme prosecut and thir",
        "District procedures office and the Kiza the IPS used for their fishing used for their fishing site all belong to as 3462 the site shows fake official letters and search warrant to trick targets these sites are not directly Distributing AP Cas but are assessed to be Distributing the secret gr family from same",
        "infrastructure next provider B impersonate the S District procures office they their infrastructure mostly belong to as 3462 and use four document they distribute the synch family on the same",
        "infrastructure provider C differs from other providers with most of each infrastructure falling under as133 199",
        "they use the Supreme Pro secures of theme and use three document this distribute the micro family from same",
        "site after the Target enters their personal information on the fishing site they are presented with this fake",
        "document it it is enough to scare the Target because it mentions the case number the target name and seity of the instant even or even though older version of the C is used this fake won't cause panic because the words are very unfamiliar and scary to the aage person provider B and C use bank statement this statement contain randomized transaction that the target doesn't",
        "recognize provider B also shows an N document this prevent the target from disclosing the situation to their",
        "acquaintance all of these providers have a history of Distributing malicious app disguised disguised as voice fishing detection app called for",
        "antispy connecting to the IP provided by Theo will lead the target to a fake Play Store as fake Play Store page as",
        "follows this app called police cyber Cup and the site looks very similar to the real Play Store page with the same title description ratings and excluding the capture",
        "area this app is called fishing eyes some of the content is outdated but it's made to look real enough to deceive the person I ironically both of these apps are distri uh from police for detecting",
        "voice fishing attacks however Snak attackers are using these themes in rivers and exploiting them in attack scenarios that's the overall approach of voice fishing groups operating in South Korea and Yong will give you a detailed analysis of the secret group family thank you",
        "now I will talk about secret Co",
        "family according to stat statistics from 2019 campaign using for APK in financial",
        "fra it damage 10 times higher than those without and this highlight the inclination of voice Bo fishing growths using",
        "APK there's some reason to using APK in BO fishing campaigns take control a phone on and allow them to send photos and personal information stored inside and manage victims by monitoring and redirect the call to their call center to gain full psychological",
        "status however secret call has more advanced features than typical voice fishing application here are notable features of secret calls they employ various method to threaten user or defend their app from being analyzed",
        "and now I will introduce these features one by",
        "one when we met the secret calls there are some problem to handle it typically the APK file format is similar to a z file secret modifi the specific header in the zip format into two obstructor being analyzed firstly it use a bip compression manipulating the compression method to beyond the typical value eight secondly in man Cate the time stamp if the time stamp ex a feable range it becomes impossible with analysis or some compression",
        "program we can handle this problem by modifying the value manually or using open source",
        "tool the secret C comprise two F structure external and internal and we call them as loer and SEC C respectably SEC C is located within within the loader and all of them have increased class file for performing malicious activities",
        "as well as Fishing Resource is dis",
        "user let me show you how secret call has various F structure for each type for the first the secret C has extension of APK and pent resource is compress the requiring password with the the SD extension and the password Here is a Korean profanity",
        "second when the pishing resource are is row data and the APK is separating into being compressed the password is the",
        "same third both of them are row data",
        "secal is in the form of APK when patient resources are in the resource",
        "area I showed you the structure of secret calls one of key components of secret call is encrypt class file the increase classifier is for both loader and secret call it decrypt and load into memory before code execution and their name is changed throughout our tracking specifically secret kill and bulk for sure bulk is",
        "not my",
        "typo until after 2023 secr was used for",
        "class file until October they allop the kill and from October on Words both of ban secret were used for class",
        "file and each name of class file is different for saving their key and Native Library we can compare the full features of whole history into change of for their class",
        "file we have also observed a change decryption key for class file the interesting is for the past three years the only as algorithm has been used to encrypt it and the only key value and initial VOR is Chang it is also",
        "remarkable in the networking tial use two web protocol web soet and HTTP when communicating with C",
        "server the request body contains the",
        "infect device status including F ID field it indicate the request type and",
        "data relies on the value of app ID it is hard code in the source code and might be version of secret CA or some Target",
        "which they",
        "disguises when Secco send the data to the CNC there's a unique pre prefix in front of transmit data currently the prefix with a plus time samp ACC company user database encryption whereas in the past it used keyword of",
        "postable and the end point of tic server is decided by request type there are up to 13 possible paths and each path consist of Maximum five characters mixing letters and",
        "numbers for the result of request the CNC respond with config for Mal activities such as Cod",
        "foring because receiving config from the server SEC could collect various information for Mal's activities for example a list of font numbers to curve red direction or blocking a Ser address only for uploading images and ready profile to get extra s server and",
        "Etc when User make a legimate code using their infect device the call will be cancelled and new code created soon to attacker is fing user into thinking",
        "they're making a legiate call when they're actually connecting with voicey fishing groups call center",
        "the new call screen resembl to the original and the user is actually looking at the fake screen but the call to their call center is running in the",
        "background if SEC call can communicate with s server does it hold",
        "execution actually the secret C tries to retrieve backup CNC from a certain R profile",
        "when the CN server is not available if the extra changes or go offline it is updated or ACC accordingly on the",
        "site and secal typically use Firebase to receive command from the CNC when the adversary send the sum commands from this Firebase events for malys activities are triggered in secret calls initiating another data extortion or determinating and some CS end point or whatever they want to",
        "do the secret code monitor user by using commercial service called as Jun Jun is a service for streaming video and audio to connect to some others who want to talk with you it's like a software for making a phone call the infin device by secret call can stream camera and audio in real time using the authentication of adversary so user has infected by can be exposed their privacy and whatever they",
        "do and you find out the customiz application utilizing duun when",
        "adversary type user ID into this application it is ready for watching this monitoring program could make device run camera and microphone for monitoring and we discovered this custom made application when the adversary uploaded their pitching site in",
        "certainly as I to say we are tracking secret C for two years and now I will talk about how we can analyze it such a long time and some slide is only for attendee in this Podium let me show",
        "you we have collect over the 64,000 secret calls I me character into over the",
        "15 the characters include the law enfor ment e-commerce and career service and Banks and video players and among others over the 50% of SEC call must as law enforcement while over the 20% imp person financial institute like",
        "Banks if you analyze the for each the number of secret code is about 60 to analyze for a day due to the sheer volume of secret calls the Manion analysis become imprac practical we have to find and neate the efficient",
        "way we analy the secret C Behavior based on the some criteria and we find some parnal for each type of secret calls binary patterns or R profile in Native library and CNC server and their PLL number and how to decrypt the class file we can consist two stage of a process to analyze it the thing is extractor for static information is in secret call when we extract the information from Secret call we can request the Mal config to CNC sub and this process called as",
        "Communicator this Ms a complete automated process to analyze it obtaining a new information about adversary like CNC server R profile and",
        "pawn numbers and some ioc's and Etc",
        "finally we have analyzed over the 99% of secret",
        "automatically we find out more than 130 of CNC server we discovered the most of origin were in Hong Kong and Japan and most of another is in",
        "Asia and we get the over the 25 red profile and it allowed us continuously discover new CNC",
        "we got some Pawn numbers used by Boy fishing group most of number is used in Korean but some of number stand for China it is using China",
        "unicorn it might be means that adversary might be Chinese or based on China",
        "without and this is our key takeaways this is what I want to say for this we presume the attackers are proficient in Korean and have their roots in East Asia throughout research",
        "we aim to eradicate the paent campaigns and Rise awareness through the ioc and track their infrastructure continuously by our automation",
        "process here's a list of IP for fishing site operated by each Bo fishing",
        "group and this is the hash and CNC of secret call with different rate profile for each",
        "other we didn't say everything we want to say you can check rest of them in our white paper later I would appreciate if you have any question and thank you for listening our presentation",
        "[Applause]",
        "is there any",
        "question okay thank you for listening yeah yeah here is one question oh yeah",
        "and one more you sorry I just have one question I noticed that you saying that the number of uh victims has gone down but the value has gone up I just curious whether you did a correlation on the age of the victim that means in the old days the the spread of the victims is okay so I'm trying to drive that is um perhaps the number of victims R down because the population as a whole has Sol age and usually the bad guys usually Target the old guy all right so I don't know whether you do this kind of correlation and it could be because the or guys are also perhaps more resource you got more a little bit more resource so they target the the older people with higher resource and therefore when the victims suffer damages they will be higher so just",
        "curious you you understand my question that means do you have a you have a slide right that says that number of you have 50,000 over victims last time then you say that uh yeah uh uh the the per victim uh how much they suffer in terms of damage we service recently the per",
        "victim losses or the amount of money lost is higher per victim so do you manage to do a correlationship in terms of victim",
        "age uh the a the number of APK we collected uh means uh it's not or this",
        "distinct it's not organized by h Huh H H how old are you ah young and old",
        "um no uh I think uh AG is not important",
        "want the data points yeah yeah so that's that's where I'm driving it I mean if you if you perhaps do that maybe it will occur that the number of victims actually were more older ah yeah uh we",
        "didn't put the slide in this presentation the uh according to the article the younger 20 generation is uh",
        "and the 50s or there are their The Voice fishing voice fishing groups major Target because they don't have enough",
        "Society experience ah yeah because and",
        "as we said they impersonate law enforcement so they are very uh s uh very unfamiliar their uh low lower wording so yeah it's especially the 20s",
        "uh girls ah womens are major Target as well yeah thank you good presentation thank",
        "you so everyone can hear question as well um how did you guys build your Automation in order to analyze the apks um and feed it into your database did you use python or AI or how yeah we we",
        "written the Crypt with uh in Python and",
        "we extract the characteristics and",
        "encryption key with manually analysis",
        "using python code so we uh emulated the",
        "behavior of the secr family uh in the code and we secured the uh phone number",
        "and S server and ready URL yeah from thanks to the script yeah"
    ],
    "5zUhrhkubhI": [
        "hello everyone I'm Lance today my colleague Dennis and I will give a presentation on urb excal the new wiw 4",
        "platform virtual machine escapable first who are we we are security research at an group last year security lab and we escaped from viral machine many times what's more we won the pony award last year this is the road map for our talk first I will share a introduction to v m escape and wiw",
        "hypervisor in the second part we will share a journey of wiw hypervisor vulnerability Discovery the last part is about our efforts in the explorate development of wiw VM Escape where we",
        "will share a new set of exploitation Primitives and how we use",
        "some to develop explorers for all wiw",
        "hypervisors what is VM excape and what are its dangers VM Escape refers to an Tech launch a tech from inside virtual machine using vulnerabilities in the",
        "hypervisor to escape and cure the host a c is cloud platform may run a large number of viral machines and",
        "device",
        "on on one host which can cause significant harm it can be said that VM",
        "Escape is one of the most",
        "cic threats to the",
        "cloud this diagram is taken from a paper",
        "V published many years ago we can see v as hypervisor consist of three parts vmx",
        "vmm driver and the vmm As for the virtual devices we are",
        "most concerned about that code exist in",
        "VM and and vmx most part is in",
        "vmx so what are the attack surface of V",
        "VW hypervisor I have a list a table and almost all of them modules on it have",
        "had vulnerabilities in the past even leading to VM Escape except for the vmm I believe that",
        "vmm may also have vulnerabilities just",
        "like KVM but the difficulty of finding vulnerabilities in vmm may be too high",
        "compared to the ones",
        "above on the right side I have listed all the public disclosed the VM escape",
        "from 2021 to the present not including",
        "the Escape completed at Pon this year it",
        "can be seen that in recent",
        "year security research have mainly focus on researching USB attack",
        "surface now let me share how we start the Journey of vulnerability Discovery",
        "in VW hypervisor",
        "having already analyzed V architecture",
        "attack surface and history vulnerabilities which was an interesting and potentially risk attack surface on",
        "uh to focus on EHC",
        "controller to beginning Reserve",
        "engineering V hyper we needed an ENT",
        "point resing for specifical Strings is a",
        "simple and E effective way by",
        "researching for EHC in Ida we can quickly locate the code for ehci",
        "implmentation from there there is a matter of understanding the ehci",
        "specification and the qem use code will",
        "reverse engineering VM",
        "code first I need to take a few slides to introduce the EHC and the usb2",
        "controller the diagr on this slide is",
        "taken from the EHC specification from this diagram we can see that the EHC specification is",
        "responsible for the communication",
        "protocol between the system software and the USB controller the USB controller",
        "then conver the data into",
        "usb2 package to communicate with the",
        "USB device can can con connect to it",
        "therefore during the reverse engineering",
        "process we focus on understanding how",
        "EHC commands and data packet are handled by VW code and uh convered into USB data",
        "package to be sent to the US B",
        "device the slide introduces the basic",
        "data structure of EHC package and the",
        "state machine of the ehi controller we can say that ehi consist of Q and qtd along with Z",
        "structure like itd but today we will",
        "focus on only qtd qh is stands for Q head which for",
        "was a singular linked list each Q",
        "carries a linked list of qtdds and the qtd is a smallest structure in ehci data",
        "transfer the qdd has a buff poter array",
        "where buff Point Stones physical memory",
        "address from the diagram on the right we",
        "can see that USB controller first pass",
        "the Q then process and transfers the qds",
        "within the Q when the transfer is complete it",
        "checks if there are any qtd that need to be written back afterwards it moves on to the next Q and The Continuous",
        "roup finally there is one more slide we need to know what EHC data transfer looks like a USB device will have",
        "multiple endpoints for transmission and",
        "each endpoint will have a unial pipe the",
        "control pipe is user to configure the USB device this and it is",
        "present on every USB device then there",
        "are three tokens for qtd set up in and out among them the setup qdd is",
        "responsible for describing the entire",
        "trans for que ultimat a trans for que will looks",
        "like the diagram on the right with a set of qdd Follow by many in qds and out",
        "qds here I show the execution flow of",
        " and VW we can see the difference in",
        "how they handle EHC data transfers qm mu processes each qtd as a",
        "single unit treating each qtd as a",
        "packet depending on the token type setup",
        "package will execute du token setup",
        "where in package or exq the do token",
        "in on the other hand wi treats an entire",
        "eh transform c as a whole",
        "in uh it considers the entire c as a",
        "single",
        "urb and then submits the urb to the USB",
        "device by urb submit",
        "function data transfer and processings",
        "are likely to have",
        "vulnerabilities for example the welln cve 2020 143 64 inq emu occurs in the hand",
        "handling the handling of each packet",
        "type so could there be box in VW",
        "function function ehci control transfer",
        "which also process",
        "date the answer is",
        "yes we discovered a critical vulnerability here and uh accomplished a",
        "series of interesting things through",
        "it so vulnerability we dis discovered is",
        "cve 2022",
        "31705 which is a hip outbounds",
        "right that affects wiw esxi workstation",
        "and fing affects all of wiw",
        "hypervisors we will assign this",
        "vulnerability a score of",
        "9.3 the code on the right is the eh Control transer Function I need to note that since wiw",
        "hyper is a closed S",
        "software there are symbols including function name uh are named by ourselves",
        "in each side control transer that is a loop that pass all qds in the Q and process them based on the qtd token",
        "type first for the setup qdd which is",
        "the beginning of transer",
        "Q we will allock a new",
        "urb the size of urb depends on the set",
        "setup L fil in setup qtd",
        "which represents the total length of data to be transferred in the",
        "queue next are the out qdd and in qdd we",
        "can say that when processing the out qdd there is a check to say if the TB is a illegal value TB is a member of qtd used",
        "in indicate the length of the data car",
        "carried by the qdd set of lens here represents the",
        "remaining lens set",
        "so current urb can",
        "transfer if T Bice is greater than setup",
        "length meanwhile we only transfer the length of set up length we can say that finally the EHC read TD buffer data is read from the physical address carried by the qdd and return the PB data cursor point of the",
        "urb the process then",
        "continue subtracting tbes from setup",
        "lens to update the remaining",
        "transer lens after processing it",
        "will enter the next qdd process and the",
        "pass the next qtd the in qtd is similar but since the direction of the in qtd is from the USB",
        "device to the system software at this",
        "stage the USB device has not received and processed this package so they won't have any data for us to transform in EHC control transfer it",
        "will directly execute the next",
        "operation so now the question",
        "is where is The",
        "Bu we can see that in the processing of",
        "out qdd there is a tricker for",
        "TB which ensures that there will be no",
        "issue when set L is subtracted by T Byes",
        "however when processing inqd there are",
        "no checks at all the code directory",
        "subract tbes from setup lens which means",
        "that if setup light is smaller than TB",
        "setup light will become a negative number after processing this",
        "QD it cause a integer overflow",
        "now that we know there is a integ b when processing includ in this code let's say",
        "how to upgrade this",
        "ability when setup lens is",
        "negative it it can't pass the check",
        "during out qdd",
        "processing we need a set up lens to be a positive number which is easy we just need to set a large number of",
        "inqs each with a TB view value of 0 x 7",
        "F FF the blue part below shows the value of set up lens at each stage finally we",
        "can subtract setup lens to a larg",
        "integer at this point set set up length",
        "will be much larger than size of urb we can p Alt qdd with a size larger than the urb's data size at an end which can pass the",
        "code check thus leading to a hip out of bond right this is a vulnerability we",
        "discovered in addition to cve",
        "2022",
        "31705 we discovered a new other",
        "such as out of bonds read information disclosure which",
        "have uh which have all been fixed we will give two example here first there is an aut of B read vulnerability caused by pipe pipe type confusion we can",
        "choose a control pip in the process and",
        "should hand a ISO as a coronos pip although their",
        "data structure are the same they are used differently which Le",
        "which leads to problem we can say the image in the right",
        "swing so during the transfer process",
        "of isoc Chronos and point so urb will",
        "have multi multiple packs and the the PB",
        "cursor will be",
        "increased however a c p urb will not",
        "have multi multiple",
        "packets so the current package have actually",
        "already point to the data when the urb's",
        "number package is zero this won't directly cause a problem",
        "but the issue is that so number packets of Contra types urb is always",
        "one which means this code blocker will be always entered automatically causing PB data",
        "Cur to be increased beyond the range of",
        "urb without out of B",
        "read another one is information",
        "disclosure vulnerability that exist in",
        "multi viral USB devices such as USB",
        "audio USB video USB",
        "RNG the cost of vulnerability is that",
        "when creating a new urb beware didn't use klock or perform the or performance",
        "the memory set function on the urb data",
        "uh data array this lead to the data array",
        "carrying memory",
        "information many visal devices will set",
        "right back lens to data lens by default which allow all this information to be",
        "disclosed the next part is how to developers exploit I will leave the following time to my colleague",
        "Dennis thanks Lance uh I'm Dennis and I will share the remaining part of our our",
        "talk first when we have a new Z day vulnerability what difficulties do we still face the VM hypervisor are close source which create many difficulties for both vulnerability Discovery and explosion moreover this is no there is no publicly available exploit code and very few public exploit flows what even more challenging is that the VMware plays great importance on the security of its software almost all public exploit Primitives are being patched making it difficult to continue using historical exploit flows finally due to the nature of VMware soft VMware uh virtual machine software only a small number of code paths can be fully controlled by who is in the gasos which greatly reduced the number of modules where exploit PR atives may exist despite these challenges we conduct further research and discovered a new set of generic exploit Primitives that helps us achieving VM escapes",
        "before sharing this this new exposion approach let me first share some of the past exploit Primitives and how wew P",
        "them this slides list multiple historical public uh exploit Primitives and how VW fix them uh but due to the time constraints I will not go into detail after searching and analyzing this historical expor flows we found that there was no exploit primitive that could be used directly so we had to look for it ourselves fortunately we find finally find a new exploit object this powerful Exel we",
        "find is U the object we mentioned earlier uh when analyzing the vulnerability the urb USB request block",
        "is um an Universal object for transferring USB package in VMware and is used by all virtual USB controllers",
        "since almost all virtual machine configurations include USB devices this also means that the Primitives built around it are very generic the diagram on the right shows the data structures of the urb and its related objects um",
        "after our previous introduction to the vulnerability I think there's no need to explain each member here in detail however there's are two new objects that we haven't mentioned before one is V USD V USB device which VMware creates when",
        "each USB device is connected it includes the pipe array of it this device so another object is Dev device uh this object is located in the program data segment and contains related function pointers therefore we can see that urb is a very ideal explo object firstly it can be arbitrary allocated and freed and its size can also be arbit controlled by us it member include a variable lens data",
        "array a member of control the lens to read the right back lens a pointer to data and a pointer to a a pipe through the pipe pointer we can index the device object and obtain the program space",
        "address next I will explain in detail how we can use the U and related objects to construct exploit Primitives and build our exposion approach step by step",
        "first we need to convert the outof bounds right vulnerability to an outof bounds read we can arrange the memory according to the diagram on the right I will introduce the memory grooming method at the end first allocate urb1 and U2 and ensure they won't be fully processed and freed this step requires the right back lens of this urb to have a value and we don't use inqd to read it back so it will be reserved on the memory uh the second step is to create an ehci control transfer and allocate the uabb in front of U1 then use the out of Bounce right to override the right back lens of urb1 once right once the right back lens of urb1 is overwritten we can use urb1 to read more content including the pipe address and buffer address in U2 the next part is arbitr address read so it is very easy because we already have the Hep address we can just override the U 1's P data cursor to any",
        "location the next step is arbitary address right initially I encountered difficulties here although we can modify the p pb data cursor of the urb to an arbitr address but once the urb is created and sent to the USB device it cannot be written Again by the system software if we send a new transfer queue it would naturally create a new urb instead of obtaining the original one so",
        "how can we a arbitr uh address right I S of pipes uh we can modify the pipe pointer of the urb through an autobound ride is there any ride operation that can be performed through a pipe I found this primitive in the uhci check and right by function the check and right by function is execute once before and after the transfer function to check the transfer status and write the return data from the USB device to the physical address in the guest I found this primitive in uhci which is the usb1 controller since a device is connected to the usci controller by default config by default configuration this can be trigger by default the pipe parameter of the usci check and R back function comes from the U pointer we can see that the frame in the function comes from the pipe more interestingly the function writes the content of the four bytes pointed by the one pointer in the frame to another P pointer in the frame since both frame and the pipe are fed by us this allows us to perform a 4 by arbitr address right",
        "this image uh the image in the button uh right corner shows the assembly code for this uh line of C",
        "code after achieving arbitr address read and right the next step is to find Primitives to control the IP what kind of targets do we generally look for um a d dynamically allocated",
        "object with a function pointer where we can invoke the core of the function pointer the object closely related to urb is the pipe fit this ceration",
        "creran uh in the pipe release function cancel pipe the very first instruction is to call a function pointer from the V USB device in pipe and we can also control the first and second parameters uh that is very great uh if we can forge our pipe and Trigger cancel pipe we can achieve arbitary code execution",
        "in this regard I found two approaches to utilize uh part one is to as we can see from the image in the ehci check and right back function the pipes comes from the urb then under certain condition",
        "when ehci check modified setup returns an error it will execute cancel pipe",
        "when we Forge the pipes through an autof bonds right we can achieve arbitr address core sometimes we may not be able to to use pass one for example the in case of VMware Fusion the default configuration uses uh USB video device in my attempts",
        "I found it difficult to retain the ehdi urb so I had to see other ways however",
        "since we can achieve arbitary dress right we can do more interesting things uh for instance we can directly write a forge pipe object into the pipe array pipe array of USB device then by triggering a Port reset through the ehci resistors it will call destroy all pipe and eventually release all pipes in V USB device including our for",
        "pipe finally let's talk about The Primitives required uh for Heap grooming this part is not our own finding but comes from the content of the black high Europe talk uh using the Shader object in the svj model can help us compete Hep spraying and Grooming it can be specified to any size and can be arbitrary allocated and freed by us the below are the commands requiring to allocate and freeze the Shader object for the more details about SVGA I have also attached the link to the Wi paper of this talk with sufficient Primitives our",
        "explosion becomes feasible here I share my actual exposion plan which may seem complex because we chose the pass two method to control rip uh which also requires us to leak more information the good news is that after each asci control transfer is completed the urb will be freed and the next allocation will still be in the in this freed position so there is no need to message the hip again however the actual exposion does not stop here we still face a big",
        "problem the problem comes from Macos itself the Macos SL maloc uses magazines",
        "to manage hip blocks which uh with each CPU core having a unique corresponding magazine when a program execute Malo the MEO finds the corresponding magazine to complete the Hep trunk allocation based on the current CPU core of the process this means that every time we allocate a hep trunk the corresponding Maxine and memory area are random this cause a very big problem for us and the diagram in the lower left shows the hip management of Li",
        "malog therefore we can find that the memory areas of the magazines corresponding to each CPU core are different and the allocated hip trunks are not together at all and the the diagram on the right shows a simple experiment I did I kept running Malo in the program and then counted the which magazine the hip trunk trunks were in we can find certain patterns such as most Heap trunks being allocated in magazines with even numbered indexes which implies that CPU scheduling priorities even numbered CPU",
        "course but the important point is that almost all Maxine will be",
        "covered we did some research on Le Malo and then come up with a way to deal with it first we can ensure that when we are using Shader to spray the Hep the CPU core will not switch because they can be in a simple while loop as long as we put the commment into the command port at once however once there's a threat switch such as from svj to EHC controller it is impossible to guarantee that it is still in the same CPU core therefore if we cannot ensure that the EC control urb and the Shader we arranged in advance are in the same magazines the out of Bounce right will cause the program to crash but what if we do a heap layout in all of the magazines yes this is the count measure we came up with first repeat the basic Heap layout and try to have at least one complete layout in each magazine then for each subsequent step of the operation try a large number of times to ensure that our out over bonds right and the inform information that needs to be laked happen to be in the same magazine it doesn't matter if they are not in the same magazine because we have layouts in each magazine which were not in C cause crash we just need to keep trying at this point we are left with the most important question how to ensure that all magazines are laid out we thought of many ways such as uh adding a sleep between each round of allocation we experiment experimented with various sleep times from small to large but unfortunately none of them worked when the sleep time uh reached more than 1",
        "second it actually ensured fewer magazines for hip spraying this is understandable because from the previous slides we can find that magazines with even numbered indexes are more likely to be scheduled then we tried to increase cpu's uh occupancy to in increase CP CPU core switching hoping to switch each CPU core more evly evenly unfortunately this",
        "didn't work either we speculate that it may be C what we can do is only increase CPU cost in the gas system uh of the hyper hypervisor which has too little impact uh on the host operating system finally we explore two ways to increase the POS probability of success",
        "the first is to remove s de and speed up the uh exposion CPU scheduling should be",
        "at ment intervals and the fast exposion can reduce other interference interferences the second is to use a huge number of hip spray RS the dozens or even hundreds of rounds are too few we used more than therex 1,000 RS of hip sprain to ensure more comprehensive maxing coverage we can directly use the basic Hep layout to spray Hep without allocating many useless stages before the layout because if it is an odd-numbered index magazine there are actually fewer Hep trunks on it and it doesn't need much Heap spraying directly uh direct uh Heap layout can Su",
        "succeed eventually after a long time of debugging we increase the success rate",
        "on our MacBook Pro 13 to over 18% this",
        "may still not be perfect but due to the randomness of magazines we are quite satisfied with this result and we also complete the escape on the first attempt at gon",
        "2022 next let me play a v demo uh which records our VW Fusion R machine Escape",
        "attack so this is this is a fusion and",
        "uh first we check the version of the back and the version of the fusion the guest is uh then want to",
        "uh and this is our exploit we just run the exploit and it",
        "will it will pop up the calculator yeah that's",
        "it uh thank you uh",
        "okay then let's briefly share the exploit of vmw workstation it should be noted that under this default configuration there will be no devices connect to the ehci controller therefore to trigger the vulnerability we need to manually connected uh USB device to the ehci controller the exposion on Windows",
        "will also face some troubles such as lfh the lower frag Heap the existence of lfh increase the",
        "difficulty of exposion because it randomly allocates Heap trunks",
        "fortunately the parameters we use including urb and Shader can exceed uh ZX 4000 which is the maximum size of lfh this makes Heap Arrangement",
        "much easier for the object that cannot be larger than one 0x 4000 we can choose a size that has not been uh has not yet been enabled by lfh such as z x 330 S70 uh the image in the lower",
        "left reveals how we complete a of bonds reading under the windows the final exposion idea we have as shown in the lower right",
        "corner and this is a demo of uh escaping",
        "um workstation and we just do the record the same thing uh and run the",
        "exploit and how about the",
        "calculator the last exposion case is on",
        "VMI like workstation no default devic is on the esci controller um for the essi it is a system uh similar to Cent os7 using a very old gdbc version 2.17 however in the new esxi",
        "802 it has been updated to version",
        "2.28 uh the same as Cent os8 so the exposion idea on esxi will be similar to that of fusion and we don't need to face the randomness problem caused by the magazines so at this point it will be",
        "easier another difference is uh is that since 3 Graphics uh acceleration is not being enabled by default in esxi uh we cannot use the Shader object we can use gmr instead although it cannot be allocated in large quantities like shaders it still has a high degree of",
        "flexibility due to the Lans of this talk I will not go in details about the related exposion here uh we complete uh VMware esxi VN Escape at the 2023 te for cup and eventually gain the highest privileges uh of esxi I hope we will",
        "have opportunity to share more in the",
        "future and the last part is the takeways uh first is where buxs have",
        "Arison with similar software there may be new buxs the second is when looking for export Primitives try to look for objects related to the vulnerability as the first time uh I",
        "first uh do reverse engineering in lots",
        "of other modules but I can't find the",
        "good object but but when I look back to",
        "the vulnerability I found the U is really powerful the last is the virtual devices especially USB related devices uh now a popular Tex service so this is our talk uh is there any questions here uh you can uh ask uh ask us after the",
        "presentation okay so this is our talk thanks for listening and hope you like it"
    ],
    "gzFUtG-n65A": [
        "uh hello everyone my nickname is Wick V and I'm excited to share my research finding with you all uh let's dive into our topic un building the cracks in virtualization mastering the host system",
        "Das whenw workstation",
        "Escape first let me introduce myself uh",
        "here is my Twitter account I'm from cyber kunun a company with several worldclass security researchers I mainly F I mainly focus on binary security research I completed whenw workstation Escape three times in the competition of T cup I ranked in top",
        "three of msrc leader board for Q3 Q4 last year and also I'm the second top two of this year q1 uh I also shared my security research at zerom and hit B in 2021 one I",
        "completed a hyperv",
        "Escape uh in addition of security uh",
        "work work station security research I also found several well-known products in uh I also found several critical or important Security boxs in several well-known",
        "products now let's Briefly summarize the topics we will cover first I will introduce some basic information about virtual ization to help those who haven't encountered virtualization Escape before next I will",
        "discuss historic box in",
        "uhci and both discovered by others and by me after that I will use two vulnerabilities I used at 10th cup 2023",
        "as a case study to explain how to exploit virtualization",
        "Escape finally I will summarize my content to reinforce your understanding",
        "let's get started part one virtualization basic",
        "info when it comes to virtualization Escape there are three key questions uh we need to understand first",
        "how is the virtual machine constructed next how is data transmitted",
        "between the guest system and the virtual device then what is rization escape to",
        "address these questions one by one uh let's start with the first question how is virtual machine constructed a virtual machine typically consists of a hypervisor and uh many virtual Hardware",
        "devices uh for whenw workstation a part of of its hypervisor is run in the kernel and some parts are wrong in the user mode process most of its virtual Hardware devices are implemented in the same user mode process so this diagram illustrates the",
        "software architecture of when we're workstation we can see a hypervisor with",
        "a multiple of virtual Hardware devices here the focus of our discussion today is the USB",
        "controller next let's address the second question how is data transmitted between the GU system and the virtual Hardware",
        "devices one there are two methods one is",
        "by directly reading and writing guest's physical memory the other is through I",
        "operations here let's n the first",
        "method the entire guest physical memory",
        "is mapped as a segment of virtual memory space of WX process",
        "guest virtual address short for gva is the address needed by programs in the guest virtual guest virtual machine in",
        "guest programs use gva assess its",
        "physical memory before being passed to",
        "vmx process we need to get the guess",
        "physical address of",
        "GV in the vmx",
        "process it use host a process virtual address short for HV or GPA to assess",
        "guest guest with physical",
        "memory the process of converting GPA to",
        "hva is complemented in the wmx",
        "process and guest guest system and wex",
        "process can assess the same memory at the same time this is really",
        "important our operation is the second",
        "method basically almost all virtual Hardware devices are implemented in the user mode process so the interaction between the guest system and the virtual Hardware devices is an interaction with the wmx",
        "process they can directly transfer data through I ports and I memory for I ports",
        "these CPU instructions are used for I",
        "memory it can be mapped to guest the virtual address for directly read and write in guest",
        "system our operations are fast but transfer less data so for large data the address converion operation from the previous page is generally",
        "used next let's tangle the last question what is virtualization scape let's make a comparison with remote code execution",
        "virtualization escape and remote code execution have many similarities in the exploitation of remote code execution attacker sends",
        "data to the server and crack a structure of server process then get leak data",
        "from receiving messages over",
        "Network then it sends another data to server and control server process IP",
        "then run R to get code execution so for virtualization escape",
        "the the most difference is our transmission is uh our transmission of messages is facilitated through the",
        "guest physical memory and I",
        "operation so to complete a",
        "virtualization Escape arbitr address",
        "read and write are often",
        "required after addressing the key questions let's begin to explore USB controller so far whenw has implemented three USB controller USB one series",
        "known as UHC USB 2.0 known as ehci usb3",
        "series known as xhci perhaps in the future we can see the implementation of ucp4",
        "series uh these are some public known",
        "numbers for whenw that can be escaped so",
        "interested parties can look into them",
        "later this slide shows the device information of xhci and uhci in a Linux",
        "virtual machine as you can see xhci use",
        "IO memory for data transmitting while",
        "iort while uhci use iort 20c",
        "Z this is the device relationship diagram of the uhci controller the uhci",
        "controller has two default ports when a device is connected to one port a hub is needed to expand for new USB",
        "devices this is a USB architecture",
        "diagram in uh when we workstation installed Windows 10 GU system",
        "by default a virtual Bluetooth and a virtual USB hub are mounted under your HCI a virtual bluetoo a virtual USB mouse is mounted under",
        "xhci so uh and there is no device mounted under ehci and uh specifically virtual",
        "Bluetooth required host enable",
        "Bluetooth so if you are doing research on a desktop you may may not find my box",
        "in the further",
        "presentation and if we reject xhci in",
        "the guas system the USB mouse will be mounted under USB",
        "hub here is the relationship diagram of",
        "message structure transmitted to the uhci controller the device driver passes",
        "the guest physical address of frame list",
        "to the virtual device through ey operations",
        "the uh the device uh the frame list is",
        "the area each member stores the guess physical address of first Q structure",
        "the Q structure has two G GPA addresses uh pointing to the next q structure or TD structure the last two",
        "bits indicates whether GPA points to a",
        "qh or",
        "TD if the GPA is zero and the last bit is one it means this is the end of the list the TD structure first four bytes",
        "is a gpa2 in points to the next TD structure and the rest of TD structure are data here is a simple example of a TD structure DML log is a function to allocate continuous physical",
        "memory that returns gva to TD and",
        "assigns gets the physical address to the second parameter the frame list array stores the GPA of TD structure and sets the last bit to one",
        "here is the TD structure the TD structure first integer is set to one it means this is the last TD structure and here it sets divice ID end",
        "point ID lens of extra buffer and the TD structures type through bit shifting",
        "operation and it sets the last uh integer with buffer of GPA a",
        "GPA of",
        "buffer so when we start to explore a",
        "Target we usually Begin by understanding its architecture and its implementation now that we have already understood its architecture I will take everyone near historic bu inspired by",
        "this historic bu I find a way to bypass some restriction and uh create a new",
        "bug after further exploration I find",
        "more",
        "bus here let me introduce a historic bu",
        "CV 2019 5519 it's a time of check time",
        "of use bu it was found byat and Richard Drew they used they us it at p",
        "on the purple area is a d map structure in vmx process",
        "it stores the hvv of TD",
        "structure in the uhcs thread it reads",
        "the lens field of TD structure by H and",
        "calculates the total length of TT of TD structures then it allocates urb",
        "structure by count lens and uh read the",
        "lens field of ttic structure by hva",
        "again so",
        "the SG thread is the implementation of virtual graphics card in wex process it can assess gu physical memory at the same time if we use SG threat to modify",
        "the lens field of TD structure at the same time then after the uhci thread has",
        "finished counting",
        "lens it uh when the UHS thread assess",
        "the TD structure structure second time it will read the modified lens so we cuse a heap",
        "overflow so after analyzing their buxs I start to reproduce their box and do more review of",
        "uhci inspired by them I realized I could",
        "bypass a restriction and create a new one bit let's see how I did",
        "line one to three is a while loop line two is a while loop two if this function return returns non z r it will increase variable I and continue the loop here is",
        "the implementation of that function first the it gets frame index",
        "by frame star field and the parameter index then it reads the first Q",
        "structures GPA by reading get physical",
        "memory then it sets the return value R",
        "by frame index value here is the while loop it gets the DMM map structure by",
        "GPA if the GPA has been converted before",
        "this condition will hold so it will skip the further",
        "operations here it gets the the endpoint structure by device ID and endpoint ID of TD structure if endpoint structure",
        "type is one it will allocate an ARA to store each TD structures data and it use",
        "parameter index as are",
        "index here if index is smaller than 4 Z or 4 z z it will set red to one so it's obviously when the index is",
        "smaller than 4 this while loop will not",
        "stop when the index reach to four 4 z z",
        "if we set frame start to 3",
        "FF the frame index will be 3 FF",
        "again this condition will hold so the rate will be",
        "one however because frame index start",
        "repeat so the frame list the GPA of frame list will start repeat and this condition will hold it will skip further operations so we can't overflow map",
        "area so if we compete to modify the",
        "value of frame",
        "list then it will get different value at a second time so we can overflow map",
        "area now because this restrict will not",
        "hold so in the f one ability research we discovered an information leak in",
        "2021 where we're going to use it at 10 Cup 2022 however uh the competition was postponed",
        "and cancelled and at p on 2023 star laabs use it so it was patched",
        "what a Pity all right let's see what the bu is here is the urb structure the C",
        "field in uh indicates that the size of",
        "data the guest can read from urb's",
        "buffer and the this field is pointing to",
        "the buffer with some",
        "ofet the urp",
        "structure is allocated through this function and the buffer size is decided",
        "by this parameter the U structure is allocated by Malo so the information of",
        "U buffer is not",
        "initialized here is the",
        "function TD structure is is being get",
        "out from the map area if TD structures type is set up and U has not been allocated it will allocate a u structure with controllable size and set size to the count L count size field the count size field is a field here if TD",
        "structure type is output it will copy data from extra buffer of TD structure CH the urb's buffer if TD structures type is input it",
        "will do nothing so if all TD structures type is",
        "input except for the first",
        "one then TD structures buffer will not",
        "be initialized at all in the first",
        "operation the virtual Bluetooth device",
        "process the U structure and it assigns the value of a field to the C field directly and it won't change it in the further operations so the guest can read and",
        "initialize the memory from U's",
        "buffer and here is a patch they add codes Under This operations they set",
        "number eight to see field for spe specific the",
        "conditions and it's obviously they don't understand",
        "what is wrong this should reset the memory of yourb",
        "buffer so we can trick this B in the virtual Mouse device and I use it at T cup",
        "2023 so after discovering so many bugs I filled certain that there must be more bugs in this module and uh uping that it was possible",
        "to remove xhci withing the guest I found this",
        "bug it's a UF",
        "bu in this function itth takes out the",
        "next pointer from uhci main structures",
        "link if it's not the beginning of the link it gets the endpoint structure by substracting variable next then it",
        "obtains the next member of the link later it handles the control type",
        "end point in the further operations in the implementation of virtual Hub it can reset the devices",
        "mounted under it the reset operation",
        "will free all endpoint structures of",
        "mounted devices and reapply a new",
        "control endpoint structure to",
        "it uh remember the basic UHC",
        "architecture we mentioned before when we remove",
        "xhci a virtual Mouse is mounted under USB",
        "hub so if the endpoint here is the control endpoint of virtual Hub and the next is the ENT point of virtual Mouse if we reset the mounted devices of",
        "virtual Hub in the further operation the end point of mouse will be",
        "fre so the Reel NEX will become a dangling pointer thus we we caus an uaf",
        "bu so after finding us for",
        "bugs how should we exploit it through this practical example you must be able to exploit bugs more",
        "smoothly in white paper what stri out when where the mention the component for exploiting vulnerabilities in the SJ device there's a surface structure a surface combind to",
        "a mob structure and the mob structure saves",
        "the hway of",
        "GPA in addition the surface can bind to a backend structor too and the backend structure can apply a backend",
        "Hep if we let the back Heap and backend structure into a same lfh",
        "segment if the back hip can overflow",
        "right if we are lucky we can overflow the backend structure and change the pointer of backend hip so through SJ",
        "commment it's possible to copy data between two surface so we have the ability to read and write arbitary of wmx process",
        "heap if we want to use this component we just need to find a bug that can construct an auto bounds",
        "right the bad news that this method is",
        "no long no longer effective because the official saw their report so they put",
        "the backend structure into another process named MKS s box so this method",
        "is not valid",
        "again in my speech break out script of West world we propos a new",
        "method if the converging size of mob is",
        "1,000 when the mobile tries to convert GPA to HV if the converion fails it will",
        "apply a hep with size 1,000 as",
        "H through SJ commments it's possible to",
        "copy data between two mobs",
        "so we have the same ability",
        "again if we exploit the one bit to overflow the lens field of surface then we can out the BNS read and write this",
        "Hep with some memory",
        "arrangement we can overflow more of structure and CH change the hva value so",
        "we can achieve arit address read and write",
        "again and of course we can overflow mob structure directly because we don't know",
        "we don't know and address a wmx process",
        "related unless you have a information",
        "leak however this method also be blocked in when were workstation 17 they no longer apply for oneone Hep for the mob structure and the mob structure was also put into a large Vector making making it",
        "more hard to",
        "modify for",
        "I finally find a way to achieve arbitr address writing which is in the function of uhci for reading data from urb I cut down unimportant codes A2 is the endpoint",
        "structure the first gets the urb",
        "structure then gets the endpoint structure again from the urb structure later it gets a pointer from",
        "the endpoint structure and gets a value from V8 if this condition is okay a four",
        "byte assignment will follow so if we can control an endpoint",
        "structure or urb structure we can fake",
        "V8 then we can achieve arrate address",
        "right the drawback is we must know the",
        "value of Target address because of this",
        "condition",
        "the good news is that I have one information leak and through uaf I can",
        "control endpoint structure so with the idea and the vulnerability let's start the",
        "exploitation in this picture we use SJ Shader structure to do Heap spray and we",
        "leave a gap for normal urb structure and put a gap in front of the normal urb then we fre normal urb and the Gap",
        "structure so they will",
        "merge after that we apply for Mouse urb",
        "again making it just right to apply to",
        "the merg memory so with the leaking back we can",
        "leak the UN initialized memory of mouse you B so we can leak the normal urb",
        "structures data then we can get a urb",
        "hep related address by this field and the wmx process related address by this",
        "field because endpoint structure is a dangling pointer and belongs to the lfh Hep I compete to modify the value of end point The Illustrated method first",
        "extend the size of lfh segment to the",
        "maximum which is 41",
        "ff0 then prepare as many virtual Hub control comments as",
        "possible each command resetting the",
        "endpoint structure of virtual",
        "Mouse we use this way to expand the competition time Gap",
        "at the same time we use SVG thread to submit commments to allocate and release",
        "the same size Hep in this way when the uhcs",
        "thread assess the dangling pointer it's",
        "likely to point to the endpoint structure that we",
        "control thus we can achieve up",
        "right the failure possibility of this step is one in 40 because the lfh",
        "feature so with arbitr writing we modify",
        "the current buff field of urb structure",
        "let it point to the Mob table the mob the mob Table stores the mob structures",
        "pointer and once again we use UF buug",
        "modify the mob table",
        "uh here why we we let it point to mob table because the arit writing need to know the value of Target address uh then here uh we once again we",
        "use UF vity modify the mob table to point to SG Global",
        "buffer M table is that uh now we can modify the content of SJ Global buffers",
        "so SJ commments to fake a mob",
        "structure then once again we leveraging",
        "the power of mob structure to achieve arbitr arbitr address read and",
        "write then you can find a function pointer of wex process and leak wi ex EC",
        "function address and you can use wi ex EA to bypass CFG so you can execute any",
        "comments you want here is the",
        "demo first I check the vering in the guess system and the verion of when work station is",
        "17.5 then I run a program in the guest here is a process tree in the host",
        "of wex",
        "process as you can see a c program popped out under wex process tree so we",
        "can run anything in host",
        "now finally let's summarize the knowledge points the knowledge points mentioned",
        "earlier first vulnerability mining time",
        "of check and time of use the data of hvv can compete you should pay attention on this when you do virtualization security",
        "research next uaf notice reset",
        "operations you can check a similar bu CV 2020 for Z",
        "4 second exploitation techniques first",
        "use urb structure to leak information you want even if you don't have an information leak bu you can overflow U structures first field and get a hip get",
        "a information leak",
        "back next use endpoint structure to",
        "achieve arbitrary right with the power of mob structure you can achieve arit read and write",
        "again and uh finally how to defend against virtualization scape first",
        "remove unnecessary devices such as USB controller sound cards CD",
        "room and disable unnecessary features",
        "such as SJ 3D the component I use for Mob structure",
        "may need SJ",
        "3D and last keep your software",
        "newest this way it's likely to avoid virtualization Escape you may think oh I",
        "use that old version so they can't attack me actually the old R has more",
        "Escape box so don't use older",
        "version and uh thank you for your listening welcome to your questions",
        "[Applause]",
        "okay uh hello uh thank you for our presentation and I would like to hear more about uh I see that",
        "uh two people are working on finding buck in your case you and your colleague right and I would like to know the strategy like how you approach uh to find the bux uh to to escape the",
        "virtualization uh fun PX um like my",
        "question are you fuzzing a lot or it's more about code review",
        "or when you two people working on the uh to find the bu",
        "uh yes they found back in uh the main part of here",
        "is do research in different environment",
        "it's very very important we lost the",
        "bugs I mentioned here the the first history bug because we do research in desktop PC they don't H it don't have it",
        "doesn't have uh Bluetooth so that uh",
        "preed function we can't go in so we ignore it so we lost the two",
        "bux and",
        "try try do anything unnormal for example",
        "I remove xhci in guest it's really",
        "unnormal if I didn't do this I don't know USB mouse can mounted on their virtual Hub so the UF bu won't be",
        "triggered in default",
        "environment and uh to review as much as you can uh first n historic box then",
        "understand uh Hardware architecture by",
        "manual uhci Intel Intel has a manual so",
        "you can read how the they handle data from guest driver and uh how uh how they",
        "should do in the first operation so we you and uh you can learn this by guest",
        "driver in Linux system",
        "too uh they will implement the uh manual",
        "in the guest driver so you can Nar from it too uh you you should n the guest driver first before be before digging boxs in hard",
        "virtual Hardware uh I think is that solve your problem yeah yeah of course okay thank",
        "you and",
        "question okay that's all thank you"
    ],
    "ueXlsoc7LUs": [
        "hello uh everyone uh we are researchers",
        "from B security lab today we are pro uh presenting on the topic the key to remote vehicle control uh aous driving",
        "domain controller first let's look at the evolution of cast here you see a traditionation c which links uh",
        "electronic equipment although this image",
        "may look future re it actually uh",
        "represents many of our current smart casts uh which are uh equipped with",
        "intensive autonomous driving",
        "features in the future cast will adaptly",
        "be fully autous uh not requiring human",
        "drivers at all this SL shows the evolution uh of bmw3 series electronic",
        "system you can see that the screen are getting larger and the system more",
        "intelligent modern smart cars have increasing more screens most screens May more embedded operating system which could lead to a increase in security vulnerabilities we have previously studies large number of I system say yes uh we are adapt at researching various controllers in cast acrossing across",
        "multiple Brands we believe that Bader res search allows us to become more familiar with the structure and functions uh D deeper and identify common security issues and we also researched a uh",
        "considerable amount of tbx devices and a",
        "lot of foreign models we have shared this topic at blackhe hat before so today we will dive into the anous driving domain controller this type of",
        "has many names ADC ADM a asdm and so on",
        "for simple uh cly we refer to it as Adas",
        "a common use",
        "BR uh here you can see the installation",
        "position and actually picture of",
        "Adas this is online introd uh",
        "introduction to the structure of Adas it met not be easy to understand at first glass however through our presentation",
        "today you will gain the deeper understanding of these",
        "devices uh so why do we study Adas",
        "because it's a companies uh users uh use various new technologies and uh offers a great learning process and the challenge if ads as devices are not sec uh they could",
        "lead to scenarious uh scaros like those",
        "in the fact and the theorious eight as show in the right image with a fleet of zombie cast addition is a excellent",
        "research direction for security",
        "researchers to the right is the PCB diagram of the N Center uh computer class we can see it h f oper system and",
        "has over 1,000 tops of computing power",
        "it's more interesting than router smart speakers and the lack if we can crack it we could even run stable diffusion on",
        "it so this is the electri uh electrical",
        "diagram or ad device we can see it has many interfaces and connects to a lot of controllers making it appear very",
        "complex uh in terms of structure uh early cast can use can bu to connect uh various EO devices now smart cars and",
        "are divided into uh multiple domains and",
        "the domain controllers are interconnected with uh the",
        "ethernet we can see that modern smart C connect several key domain control",
        "EET and for this diagram we can see that Adas device are connected to the power",
        "power TR can and the CHC can so Adas can",
        "naturally control",
        "vehicles now let's look at what a ads as controller is uh similar to preious research uh",
        "this time of various channels we have obtained a large number of ads devices",
        "uh the research is ongoing and we are here to share some of the issues we have already",
        "discovered so this is one of the earliest front C driving cameras it",
        "typically only has ACC and lka features",
        "uh it's using fpga for processing",
        "later such uh devices begin to use Arm processor with AI influence Calles such as the mobile Q 4M and the Horizon Journey",
        "2 for instance the T4 VM chip which was used by many car",
        "manufacturers in the past two years ofers small computer power and supports",
        "more",
        "cameras this is ads device using one hor",
        "G3 or use three uh hor G3 V three uh for",
        "inance one might handle parking function",
        "and well the other to manager the FSD uh the full s driving uh this is an interesting mix solution uh One processor handles uh",
        "packing and another assess driving",
        "this device use the 2 T4 VM",
        "chips and this is the more powerful T the TD a 4 VH with uh 32 tops of",
        "computing power the the the advantage is",
        "local uh ISM that this ad device cost no",
        "more than $300 this manufacturer has deployed a b",
        "model on this 32 tops computer power",
        "Chief uh so Chip and uh uh computer",
        "power is high uh the previously me",
        "mentioned solution have a low computing power The Horizon G5",
        "offers 128 tops of computing",
        "power so uh because immediate solution",
        "is Val used let's focus on that",
        "Ina there were wasa's early out Tous",
        "driving chip first used in the shun p7",
        "which uh with with the 32 tops of computer power uh and or X is currently the most",
        "mainstream solution with",
        "254 uh tops of computer power yes we can see many of are using thex solution it off offers sufficient conter computer power and it",
        "easier to De developer with if more computer power is needed uh two or chips can be used for example the popular xiaomi su7 also use this configuration if even more power is needed we continue sing CPUs uh was the",
        "first to use for or X chips",
        "uh however RX is quite impressive in that uh recently introduced the or n series which has not yet hit the market but we have already obtained several EDS controllers with this new Chief we can see that the two pcbs you different CPUs but the interface are the same this uh two con uh com dat different",
        "configuration for the same vehicle model",
        "this is the mobile s solution in recent",
        "recent years mobile s solution have been used less and less so we have not to much research on it this is the interesting approach from coom which",
        "launched a new ads chap solution to stay",
        "competitive with other chap",
        "manufacturers uh so now let's add the hardware structure of ads devices we can see that the structure is very complex with many chip and the interface among the most important documents are uh components are ufs MCU switch K and",
        "EET this is the internal structure diagram or ads device uh the M function",
        "is to recognize the environment using AI chips based on various sensor uh signals",
        "and the issue vehicle control signals some key feature include perception is",
        "and the most computation task and the center on the left use the V EET and uh lvds bu Technologies Al the ads uh",
        "device connect to the can bux the so need to send can signal through the",
        "MCU just now we talk about internal structure of ads now let's look at how ads fits into to the overall structure of a c uh we can see that there are many controllers in a c including some domain controllers with many functions like the ads autonomous driving domain controllers and the body domain controllers among others there are also some EOS with signal uh with single",
        "functions the more complex controller are uh interconnected through the ethernet the Gateway acts as a ethernet",
        "switch also all the controllers are connected are connected to different",
        "campuses this is overall software AR",
        "culture of ads devices the top layer is the application layer for various perception task the middle layers include the operating system and some autonomous driving Frameworks and the button layer con consists of various",
        "Hardware uh device the r section are",
        "circuit uh area to FOC on such as the",
        "perception model uh control model operating system and MCU uh",
        "controllers so how to research ads uh we",
        "can just un it as iot device uh the",
        "system interfaces and",
        "signals uh to study ads we first need to obtain the devices we acquired a sign uh",
        "significant number around 30 uh through",
        "the cage Vehicles water damage vehicles",
        "and T",
        "Vehicles some vendors also sell the SP",
        "to the left you can see many ADM uh",
        "controllers yes those with 1,000 tops of",
        "processing",
        "power after opening the device we need to power them out this can be done by referencing the circuit diagram or alizing the circuits uh some devices",
        "also required a signal like can or FD to",
        "wake them up uh what fils are in the stories is also very important for example or X devices typically have a emsa and ufi",
        "strage reading the EMS storage had uh",
        "has become very uh mature it can be done uh it can be done using a em programmer or by direct sing it onto a circuit B",
        "just as",
        "AA compared to EMS U UF devices are",
        "newer and typically used in smartphone but now also in ads currently we can only compare dump uh complete dumpers",
        "and the rest but we cannot be modified or uh deleted like emsa",
        "storage uh the ufs chips usually uh use",
        "the Medusa programmer however we have",
        "tested the many chips and the FES are only five uh amp per second dumping uh",
        "ads device took us a whole day uh which is too",
        "slow after uh start with smartphone",
        "repair techniqu uh they recommend this programmer which is 50 times faster the new to uh can help us quickly dump a",
        "chip after we complete a dum of the storage we need to mon it for reading If part for media devices all have a",
        "standard partition uh table with which",
        "can be directly",
        "mounted if there is a paration table uh tools can Rec as",
        "ERX uh",
        "paration for deves without a paration",
        "table like those with or Ps we can use to to WR uh to reconstruct the pation table we can use the test disc or other dis",
        "software with QX paration is trouble for",
        "example with immedia at uh sa we need to",
        "research uh to search using the Q xut header magic number and",
        "exract participation you the DD",
        "program then tools like QX Mount can be used to mount the extracted paration",
        "making the disc contents visible uh",
        "currently QX paration can only be read not written to so we M read uh uh so M read from the",
        "storage uh it allows us to obtain the complete fa setem includ some sensitive",
        "files we can reading files like Etc Shadow to correct access password or extract mod file MC from and so",
        "on uh we have just discussed how to obtain the fil setem now let's look at how to get shell access having shell access makes it easier to an the system we found that many ads devices have sshh",
        "service enabled uh or we can get sh ass set the the theory parts for example the",
        "orang",
        "DSs has H enabl but not with the default",
        "password using hash C we can't correct the password so we dumped the ufs uh",
        "storage and then modify the shadow file and set R to by pass the boot password modification process fin we got the r shell",
        "ESS uh perhaps you might think that looking in through a seral part should not be a issue on ads devices this a very old security issue however the",
        "reality is that many devices have us interface and most don't require authentication or can easily bypass the",
        "authentication so we also need to obtain networker permission for ads device and",
        "like conion uh is notet all on both devices",
        "use vle iset which use two Co cable uh",
        "below a three common",
        "interface so we need to use the vehicle ethernet adapter to connect vehicle ethernet request setting master slay mod",
        "uh it's best to uh use adapter with Auto",
        "uh in Auto ination",
        "capability of course we also need to know the devices IP address we need to capture package in",
        "priscu K mode to determine the stock IP",
        "address uh us requiring setting the whe ID Mac address",
        "bending uh now let's look at uh the interface security issues both often",
        "have many interfaces especially U and GX",
        "some auto makers clear label",
        "them uh here are some more uh uh",
        "interesting PS for example some ads devices have HDMI PS allowing us to",
        "operate them like a computer U many also",
        "have or dap PS for reading and the Flash the",
        "MCU now let's look at the can trans the can interface pins can be identified from the can transer point out if the ads device isn't working try sending",
        "some can message to the TGA",
        "1043 to wake it",
        "up uh this about hacking the Lether devices",
        "uh and if you are interested in Aon driving simulation uh please consider",
        "method like camera simulation",
        "injections let's renew the security RIS",
        "risks of ads devices for this image you can see there are link or firmware uh deploy image and",
        "the development documents for example the Deo image contains all the programs running in the system so we can an the we can analyze this for",
        "vulnerabilities this has some centive files and the deployment files there is also an issue with leakage or autonomous",
        "driving Frameworks uh every car manufacturer use different technology and Frameworks every day there are various new techn for autonomous driving in papers but car",
        "manufacturer will use the best technology available the best",
        "choice uh especially the problem the",
        "problem of model file leakage we found that almost all devices allow dump the uh model files the image show the model leakage situation for other four a",
        "Solutions",
        "besid the leakage or contest model lack",
        "uhj and trt we also discovered the",
        "leakage over Z Model models uh this leak",
        "leaks help us more conveniently use the models especially the QX files for",
        "training and",
        "optimization let's take take a look at home model f are deployed and used firstly the car manufacturer needs to try the technique road map for example the most popular one currently is OC net then after intensive training the DT",
        "model is obtained and deployed in the car during this process the car manufacturer spend a lot of time and",
        "money let's look at the M from modile leakage after it",
        "testing the car manufacturer use the most stable and accurate mode so the model structure is very important we can now trying to obtain the model structure from the model",
        "files reverse engineer in as do ptrt",
        "files it defines multiple TXS decoded",
        "with hiding code we need to Paras each tag using frea to reverse engineer the lab in INF",
        "so uh the left image shows the structure of the AR net model uh the right is our",
        "reversed and analyzed structure of trt",
        "model compared to",
        "the model the structure is similar but",
        "some layers are merged",
        "let's look at another a model uh we",
        "reversed the development to chain uh am",
        "uh amation program uh through this",
        "program we can clearly see how the model is loaded and",
        "computed uh we use Freeda for reverse engineer we found the op code and uh the",
        "corresponding computer operators for",
        "example orang part is the S V",
        "computation uh we also found found that some a CHS uh a models can be directly",
        "aned with the",
        "neutron since we obtained a uh let's see",
        "a video since we obtained a lot of modern fils we can uh what can we do with them uh we B A to car with the m",
        "process and then depart the vehicle grid uh vehicle grid model on it uh although",
        "the to car is cheap it now use a very expensive technology and we also don't need to train the model the",
        "to now let's look at MCU we found that almost all controllers contain the TC3",
        "97 and the TC 399 for example in ads",
        "since the so count send can signal directly the MC is responsible for",
        "sending and receiving can signals as well as some f",
        "handling we found that many system contain MCL from rare FS uh like",
        "or. ex uh currently uh drra can perform",
        "reverse uh analysis but IDE Pro count uh",
        "we discovered that uh even every ads",
        "circuit B has DP read pins we also",
        "designed MCU reader",
        "B from the image uh g g can recognize H",
        "HX from rare uh of the ti Co family uh",
        "the R image shows that we reverse engineer the UDP receive uh functions and found out of Bron uh reading VAB T",
        "since it's used variably in Cass is a very good research",
        "Direction so how should we control",
        "cast control vles is automate go retion",
        "ads controllers we will not demonstrate vehicle controller in this talk uh this presentation per aims to",
        "educate about ads Dom controllers their",
        "related knowledge and security",
        "risks first let's see H cars are uh",
        "controlled by electric signals here we",
        "use where control the chest technology for example both ads and the drivers can control the wheel uh by electric",
        "signals electric",
        "signals uh this electric signals mainly",
        "the can signals so if we want to control a vehicle it can do it through controlling the EO the Gateway or ads",
        "controller the red controller is the",
        "key this is the Gateway controll on",
        "autonomous vehicle it has has a full linear system and several Network PS",
        "such Advan Advanced gateways are rare",
        "and an analyzing the controller signals",
        "is complex and not",
        "inversal this is the set D model a model",
        "similar to early ads devices it can control a vehicle but it leaks a network port and the a full uh L operating system making it hard to control the vehicle through the V abilities through the one we can see that uh ads has a full L",
        "Opera system it also has the network interface and MCL controller connect to",
        "the power train C allowing us to control the vehicle through ads",
        "devices uh uh remember this structure",
        "diagram uh which include important controllers in smart cast now we focus only on vehicle",
        "controls once we remove remove unnecessary devices there are two very effect effective uh attack pass tbox is",
        "the common and effect effective entry point for attor attacks similar to a home model uh attacks can assess the tbox directly but not the device behind",
        "it if we can G network access through tbx one then controlling the ads device",
        "and the finding the vehicle is easy and",
        "Universal uh here is a complete example",
        "of how to control a vehicle uh the key is to find one in the T box and ads ass to get rout access if this part goes",
        "smoothly the r is easy uh the medium image show uh VAB we prly found in a 4 G",
        "model on a vehicle which allow remote command",
        "extion uh extion at that time the",
        "vehicle didn't have uh at this time that",
        "time the vehicle didn't have uh ads controller so it could only uh open the C door and the windows uh the red image so shows a similar command injection found on ad Dev uh this type",
        "of issue is",
        "common uh so if we find one how do we implo it to timately control the vehicle",
        "uh using uh 4G f bation is a very effective method because no matter the 4G or 5G model they all support the 2D GMS n network of course we have also",
        "listed a few other methods especially",
        "the IPv6 method which we",
        "intoduced at last year blackhead uh with",
        "IPv6 we might not need the tbox one or a",
        "fake base station and can directly access the ads devices",
        "now uh now let's make a summary the",
        "summary uh ads controllers can control",
        "vehicles but their security is often",
        "overlooked uh therefore their their security needs to be enhanced uh to Auto makas we recognize the enhancing the overall security or ads devices for",
        "example BYU uh autonomous vehicle Rob",
        "use secur boot fully uh full disc uh",
        "inceptions",
        "uh and the high level uh s",
        "authentication we hope other automakers will consider adopting similar approach",
        "to increase the cost and the differ",
        "difficultly of authorized uh research to",
        "security research we have introduced",
        "many Neal tools and analy methods such",
        "as dumping the ufs storage and debuging",
        "mcus learning new things uh always help",
        "us to uh grow and stay",
        "engaged uh although we have not uh d uh",
        "D the the deeply into the security of smart vehicle particularly ads controllers we hope to inspire further",
        "exploration in this",
        "field okay uh it's uh our uh talk uh",
        "because our Eng is not very well uh if any question please send email to us thank you very much",
        "[Applause]"
    ],
    "ktMNplx1eG4": [
        "hello everyone Welcome to our talk the whole in s box is mod VI AP sandbox from set isolation perspective and Balo this is my partner Hab we are all security researchers at tensent security sh level I mainly engaged in browser security and also a Google Chrome B Hunter I've been focused on Android security more so this is a talk combining browser security and Android",
        "security uh let's start this talk from the part background and",
        "knowledge as shown in the picture the Chrome is a m multiprise browser we can see that the page is opened each process has different work to do and gently render the uh the page for example the browser process can chose the interactive Parts visible to the user such as address bar back and forward button and also invisible Parts such as uh Network requests and fail assise the render process can chose anything inside the tab where a website is displayed any code related to the page rendered here including JavaScript HTML CSS and so",
        "on as we can see our code about website was loaded in render page so if any back here attacker can get all permissions of render process therefore Chrome uses a",
        "Sandbox to limit render functions so attackers can't do much things the first main idea is do not revent the view therefore the sandbox reuse reuses the system restrictions to Grant low power permissions to the render procise for example the integrated lels",
        "was used on vs set comp BPF on Linux and S Linux on Android this Mak sandbox meet the principle of list PR privileg and",
        "the uh rendom procise only can assise limited resource and IPC or kernel interaction so what can hacker do after getting the render uh the render RC first they can assess the limited system call for example calling and protect to unlock uh memory with any permissions but they can't do really dangerous things like downloading and fils creating prise in this situation hackers",
        "May evalate their permissions where system bugs uh in the liit uh limited",
        "system call second they can send IPC",
        "calls with evil parameters if there are any bugs in browser procise and when handling IPC attacker will element element with their permissions by getting RC in browser process the above",
        "uh popular ways to send box is Escape at present of course they all required another bug another capability is patching all code and data in rendom prise there is a special sampo Escape case from blackhead Euro uh USA 2022 a tiger can call any native njs",
        "apis by modifying some data related to the I where this apis ATT tiger can",
        "escape some box of electron applications",
        "what is the greatest capability of Rand the RC itself can it only be used as the",
        "precondition for S escape this this is",
        "all also the original intention of this talk we hope to explore how to push the rarc itself to its",
        "limits uh according to the Chrome",
        "vulnerability World program rules there are some other high-risk bugs between sandbox escape and run RC here so can we",
        "increase our the risal level of rarc itself step by step and finally achieve sandbox Escape they made two ways to choose here first is GPU or network procise RC which is a process with medium permissions but those precise RC also requires a prevaled escap bug so can we",
        "Universal set cross-site scripting first",
        "so let's come to the part two with this problem I think everyone here may be very familiar with cross site scripting also known as SSS but what is universal xss this is a",
        "simple uh simple picture to show the differences between them when there is a bug in the server server code of victim.com here the tiger tricks the user to load a link cont contining uh Evo parameters after that the access pad is injected into the page on the S side when the page is loaded in the browser any JavaScript code will be executed in victim.com and the tiger can steal the user's cookies as for Universal accesss",
        "the box is in browser when Universal SS pad is loaded in the victim's browser attacker will use the bug to inject JavaScript code into a victim.com even if the sub side has no bug the cookies can still be stolen after analyzing the historical data this T type of vulnerability began to exist as early as 2006 from the figure below we can see that from 2010 and 2024 I.E Safari Fair",
        "Fox and chrome all had such viles in particular 63 viability uh",
        "universal access box appeared in chromal between 2014 and",
        "2016 so Universal SSS is a kind of",
        "highrisk vulnerabilities that has existed for a long time and affected many browsers so what stopped us injecting",
        "code from other domains we can do a",
        "small we can do a small experiment",
        "we know that the Dom tree contains all the code of a page we can visit it by the object document first we create a",
        "new F and set is a different domain from the parent page such as X do xl. t.com",
        "when trying to read and write a sto tree from the parent page we found it was blocked by theop of browser",
        "the same origin policy also know sop is a critical security mechanism that restricts how document can interact with a cross or region resource it checks whether the triples of parent page and child page are the same the tries are appal the name and part in our case the domain of a is different from the parent page so the assess is blocked now the questions is how to bypass sop here is a casee was learning telling us how to use a run RC to bypass the SOP in Safari it comes from a topic of blue hat 2020 the tiger can use a aame to load",
        "google.com in the actor uh tier.com and",
        "then exploor a run RC buug in parent page to inject a B3 uh JavaScript code into google.com",
        "there are three conditions of this attack pass the first is the attackers page and the victim IIM are in the same render precise and second is that sop check is in render precise rather than in browser precise the third is that domain structure used by this check is also in rendom prise so a attacker can modify data in rendom precise to bypass sop specifically",
        "the attacker can write M Universal aze of domain to bypass check of cross domain data aze so the tiger can inject any ja script code into aame page of course X frame options will block set to",
        "be uh loaded in aame however this check is also in the random process so a tiger can buy by pass this this check again using the same method and make any site loaded in Fame so comparing those po two point AER",
        "implied Universal accss in Safari it",
        "sounds like good news since Chrome and Safari used to share the same render engine that was web kit so this attack method is Safari may affect Chrome as well however Chrome designed a series of",
        "universal accesses Harden to defend against them first Chrome introduces out",
        "of prise f frames it allowed a CH a frame of a page to be rendered by a different prise rather than it's a parent process so it CED a condition one",
        "second Chrome introduced the plz",
        "navigate it moves cross uh cross origion Security checks to browser process so it CES condition two and three what more",
        "Chrome introduces set isolation on 2000",
        "18 it limits each render procise to load a single site it is called the most promising uh can counter measure against Universal exis",
        "attacks set isolation seems a problem we have to face so let's come to the set isolation now its principle is treating each website at a spirit a security principle requiring a dedicated render procise there are mainly five new features added in set isolation according to the paper among them set principles and dedicated processes are Concepts you uh used to uh Define the implementation method of set isolation",
        "well cross precise navigation and out of prise a frames are the scenarios in which that isolation is added in out of precise aame scenario when the parent page contain a cross or region aame or page that loaded in a new procise in Cross procise navigation",
        "scenario when the Navigation target is cross origin it will be loaded in a new precise tool now we understand the",
        "principle of set isolation let's take a look at its implementation we can find it in a start navigation method we know that a render frame host represents a render in the uh browser procise so during navigation the render which the new page is loaded will be determined based on the associated R FH type marked",
        "in right here it's determined by use current rfh",
        "in getri host from negation and this is determine the whether the current site",
        "instance and is constant with",
        "destination site instance",
        "finally we found that the generation procise of destination set instance will be will try to reuse the origin set instance if possible it will be loaded in the old run frame host otherwise it will be loaded in a new one which means a new process created the key to uh design whether to reuse procise is use dedicated procise",
        "for all sets me for example when the strect isolation uh set",
        "isolation mode is not meet the new page will be loaded in a the original process with navigation so what is strict",
        "mode we can know it from the dock the strict mode is only for desktop platforms so the process will be reused in the uh partial mode such as Chrome for Android and this sat relation will also occur in all Android platform such as webie this it to see we can reuse the same process after navigation in",
        "Android now hackers has the ability to patch all code and data based on the r RC and the following page can be in the same prise uh attacker controlled the",
        "next type is to find a way to inject JavaScript code into another page there are many time to choose from the perspective of a page Runing I chose the JavaScript compilation fast the JavaScript code here is a stram at this time point so what we need to do is finding and modifying them I found compile SCP",
        "internal meod the compilation function Chrome first it takes out the JavaScript",
        "code and generat generates a V8 dream",
        "object here and then call compile method",
        "of script compiler this is good point to hook so I hook this point Co Point into a Evo V8 streen this looks like a children host when certain condition are meet even stream modifies the jav script code into our pad like alert Pond",
        "otherwise it compels normally to avoiding Strange Behaviors",
        "so the whole attack process is like this first victim open the attackers website",
        "and then AER patches the code where run RC it injects TR house into compel scity internal and then Nate to the victim Side by reciting the location.",
        "hrf when comparing this JavaScript of",
        "victim the page the CH host triggered and modified JavaScript as any controlled by the attacker causing the universal",
        "accss okay we take a step forward we",
        "transfer the Rend RC into a universal xss I make a demo on Chrome for Android 9 on this version we can inject any uh coding into some important uh important sites such as a con. google.com uh let me play the video",
        "okay we can is Chrome",
        "IP okay we can the pond was shown on",
        "account.",
        "google.com after I talk about this meod with go on t he said he is similar to his another bug used on pfest 2008 16 uh",
        "this is very coincidence so I also list his M here after I submit this uh issue to Google however Google set it won't fix since they can't do anything um they can't do much thing until they enable stre set isolation on Android but as user they us users they are still be safe since uh Google us Heros stics to isolate the sites that need isolation most from chrome 92 this means we can't",
        "inject JavaScript code into sites that like account. google.com after that so uh what are the",
        "sets that need isolation most according to the Google do it mainly provide protects prev data related to the user login such as the sites that you users",
        "login by entering the password or set with the industry standard or O Part particle since that uh what other",
        "unprotected but equally dangerous setes are there from the perspective of",
        "Android chome uh developers just Pro",
        "protecting those uh sites is enough but there is a category of ifs called web based AP implied by a browser components using Chrome usually web based AP has",
        "more complex functions could this AP survived uh this uh under this uh this attack using similar protection okay",
        "this is another question so let me give the lifetime to hin he will introduce how we escape the sandbox of web AP using this method okay welcome h",
        "uh hello I'm H I'm going to show you how we escape the sand box in real world software first let's analyze the web based app from site isolation",
        "perspective uh web B app use a web view or other similar component like CF to",
        "show web content the component are of",
        "based Chrome such powerful component",
        "may cause more problem than native",
        "application sometimes developers not",
        "only want web content display but also interactive with their local resource uh",
        "therefore web component also come with JavaScript interface which can give jav",
        "uh JavaScript ability to count native",
        "code some JavaScript interface actually",
        "implment very powerful function such as",
        "install and open application if we can",
        "call this interface it's possible to achieve effect or sbox Escape but developers also come up with this and limit use a privileged application interface to only website they trust the following is a code",
        "example uh like",
        "this uh before call privilege application interface there is a domain check it seems very",
        "secure is it possible to break security",
        "exception uh in a perfect s isolation",
        "there is in need no way to do",
        "that however after our research we found that due to the implementation of s isolation there are secure issue in many web based app many apps don't Implement",
        "full sight isolation we may use Universal accesss solution to call any",
        "privileged application interface to",
        "achieve effect o sendbox",
        "Escape now let's show how to escape mod than web based app s box from s isolation",
        "perspective uh here are some software we care for example PC application based CF",
        "default mobile browser application store",
        "uh and so on",
        "the first the first type is a PC application based",
        "CF uh this is the web based app architecture with the following two feature first privileged application",
        "interface mainly implement the common function of the client second many impl",
        "uh impl deep link are registed in privileged domain resolution",
        "for developers the most important is the running speed of the software so there will be many optim",
        "optimization uh especially regarding the",
        "process of loading page a case is random process created when the app open and reused when website closed it close uh",
        "it kills the site isolation when only one tab used haer can get Universal",
        "accesss in privileged domain using a rendom",
        "bu and then we find the bus in privilege application interface first we found two boxs in crypto application",
        "interface we use we use Windows UNC to",
        "control the input file as remote fail we can also get past traverser when writing fails so we can write any value to any fil and we found another",
        "interface which can start a process with",
        "hard code name uh chm we got",
        "rce there is the exploit demo radio",
        "uh what we are going to introduce next is mobile",
        "browser uh default browser or mobile phone is pre-installed so it is a tech",
        "entry point for p own's mobile project",
        "which may imply one click R see uh it's a attractive Target for",
        "security",
        "researcher each brand the mobile phone will pre-install their customer browser only Google pixel 4 carry Android Chrome",
        "mobile Wonder customer browser open secondary development based Android Chrome which are potential set isolation tool so we can achieve Universal accesss",
        "in this target to then we need to found some univer uh",
        "with then we need to find some useful JavaScript interface",
        "there is the case there are some advertising function in Target app which enable silent app",
        "install and open and after after analyze",
        "we found that such powerful function are implemented by JavaScript",
        "interface but the highrisk function can",
        "only be called from privilege",
        "domain the following is Target",
        "interface the first is browser. open app",
        "app can be opened based the app name streen another is Brer do install app",
        "app can be installed based based on the app name stream and a callback for install app can be set we can use this callback to open app after",
        "inst but uh this is not not not good enough we found that all apps in the App Store can be installed that means we need to upload self-developed app with",
        "the back door to App Store just like most of the PTO players in recent years",
        "however this method take more time and uh carry the risk of being de be",
        "discovered by Auditors but we have to rush to participate into to T",
        "cup uh and there are other ways to",
        "exploit after analyze we find a possible",
        "solution we should control the devic through app already in app store and the Target app need to be able to inter interactive with us to Achi effect or execute attribute command then we found the following",
        "application uh terminal application or",
        "script language",
        "interruptor we found that there is a search app that can execute the parameter passed by Deep link as a command uh like",
        "this we get a reest share by download and wrong B box as net netcat by start",
        "terminal with this this dip",
        "Link in order to start app with DP link we need a more powerful privileged application interface and we found a interface like this browser. start activity with deep",
        "link compared with the",
        "interface open app this m can uh can pass the parameter and uh",
        "more flexible we can use it to launch terminal app and transfer data to reverse",
        "shell uh let's what we do",
        "you for",
        "finally a case about web based Android",
        "app most of all Android based web view",
        "can be launched from",
        "browser uh uh but there are also some difference the browser can load the content or any website but web based app can generally display some vend related content when",
        "the app receiv some untrusted content it",
        "may even jump out to browser to open",
        "it the case is the default app store or mobile phone the Target app is a w building App Store application similar",
        "to the Google Play application apps can be install and open the silent from Target app and Target app can be launched from browser which means",
        "browsable in summary the target application is a good Target for p to all or tful",
        "cup let's look at the first activity we",
        "found it is export bable and regist for",
        "reach develop uh reach de link it head intent and distribute to different web based",
        "activities uh the code is like",
        "this activity one uh divide links to",
        "following three types",
        "uh untrusted website uh it will jump to browser to open it and uh when the related site it",
        "will open activity with web view with no privilege application",
        "interface and finally website related to",
        "App Store business it will opening activity or website or web View with privileged application",
        "interface and then activity two we here",
        "uh it is an activity of web view with privileged application interface but uh",
        "no way to load to untrusted domain the",
        "code is like",
        "this and then we analyze the useful privileged application interface one is",
        "Market do open app apps can be opened based on the app name stream another is",
        "market. install app app can be opened based on the app nry and the a callback for Insel app can be set we can use this callback to open app after install",
        "but uh we didn't find a way to load our own website in Activity 2 we have to find a way to load our HP first after some research we found the",
        "target uh activities",
        "three uh this is a activity with web view with no privileged application interface but vulnerability can be can",
        "inject attribute build page",
        "content like uh like",
        "this uh what we have now uh first is",
        "Activity one it receive the intent set",
        "by browser and start activity one or activity two and the activity2 have",
        "privileged the application interface to open and install app and the Activity three can load the",
        "arbitr",
        "website is it possible to attack web view in Activity 2 through web view in Activity",
        "3 after our test web view between different app have com complete site",
        "isolation but there is only only one",
        "website uh only one web render process in the same app that means there is no site isolation between different R VI in an",
        "app so we complete the",
        "attack that is the BR to Activity one then to activity two then return to Activity one finally jump to Activity three and a sandbox Escape",
        "uh let's watch our video",
        "uh that's all demos there are other suggestion for app",
        "developers uh first uh make setle isolation configurable to protect a",
        "privilege domain then perform same AR",
        "judgment first and then decide whether to reuse the",
        "process and uh restrict privilege on",
        "JavaScript interface to prevent excuse priv uh",
        "privileg and use immutable code whenever",
        "possible to implement highrisk",
        "operation and uh finally time timely fix",
        "supply chain V uh vulnerability",
        "introduced by Chrome",
        "uh and there is a acknowledge",
        "acknowledgement I would like to express way our gratitude to the following people we have been uh have been helpful to the",
        "topic and uh thank you for hearing",
        "[Applause]"
    ],
    "vbfW1NIudhY": [
        "hey y'all thanks so much for coming to my talk I've worked in detection and response for the last decade and I've made a lot of mistakes especially when it comes to metrics this is the talk I wish I had seen today you'll get three things a new maturity model to help you describe and measure your detection and response capabilities a framework to help you build better metrics and lots of examples and my story with metric starts on a Monday morning I'm only a few months into a new job and I get a message from my boss and he says the board of directors meeting is coming up and he's looking for updated program",
        "metrics so I send a message to my new team and I ask them hey what have we presented in the past and what's the response",
        "oh no bad news last guy just made those up",
        "and good news I'm going to do so much better how many of you have had this happen to you where you inherit someone else's metrics mess this is often our starting Place",
        "metrics that haven't been well thought out and maybe even worse fudge to avoid questions or more work and so I did what you probably did I Googled it and then I ended up just copying the metrics I used at my last job and that's led me to using a lot of bad metrics but so what why should we care about metrics well one reason might be that metrics help Drive improvements uh Carl Pearson he's a late 1800s 1900s guy he's",
        "widely viewed as the founder of modern statistics and he's got this quote he's famous for that which is measured",
        "improves which at first sounds like a great plug for metrics but there's an implied warning in that message what if we measured the wrong thing there's this paper that's written by these two guys out of MIT Hower and cats called metrics you are what you measure and they talk about how as you pay closer attention to metrics you start to make decisions and take actions to improve those metrics the metrics you choose are improving and over time",
        "you'll become what you measure metrics also help us communicate what we do and why people should care Edward tufty who by the way teaches one of the best courses on presenting data he says that metrics reveal data",
        "metrics are a tool that enable us to present the greatest number of ideas in the shortest time with the least ink in the smallest space and why well if we're being honest",
        "because we need a budget we need headcount and metrics are usually the tool we use to communicate that but why are security metrics so",
        "hard I've heard people say well because we're trying to prove a negative but in my own personal experience metrics are hard because I'm a security person and I don't care that much about metrics here's a much less famous quote metrics are an annoying PowerPoint I need to update every month and that one's for me and a bit about me I'm a senior staff engineer at Airbnb I work on fun things like Enterprise security threat detection and incident response and I really love my job and I live in Austin Texas with my wife and three-year-old son Liam and I really love being a dad and a husband and there's one thing I'm really good at as both a dad a husband and a security engineer I'm really good at making mistakes and this is the point of the talk where I'm supposed to gain some credibility with all of you tell you about my accolades my 15 years of experience but really I've just been making mistakes let me tell you about five of them and the first terrible mistake I've made is losing sight of the goal how many of you work or in the past have worked the alert queue so you do some sort of operational your triaging alerts yes the tired",
        "people and this year marks my 10year anniversary of being on call and for those of us that spend our days triaging alerts and responding to fires it can be really easy to lose sight of the goal and so we end up describing that Frontline operational work with metrics",
        "like this one and here's a metric that shows the number of security alerts per month you've probably seen this metric you might have this metric today and if you take a closer look at it we see that in the past year uh March and April they had the most alerts my boss will ask me a question about that and if we keep looking at it the alerts are generally trending down did we do that did we stop logging",
        "something in February did I get mad at the IPS and the new signatures and just turn those off uh in February alert count has become the heartbeat metric for security",
        "operations instead of rooting back to our goal of detecting threats and responding quickly we've reduced ourselves to cries for",
        "help I've come to call this metric the operational burden we've inflicted on",
        "ourselves another title might be we're doing things it's crazy out there maybe it's fear-driven scare leadership with a bunch of alerts and sometimes we try to make it a bit better we break it down by true and false positives I've been proud of doing this but if I'm honest I'm not sure what I was trying to say with this metric that we have a lot of false positives so what's a good true to false positive ratio and is it the same for every type of alert would reducing my false positives mean potentially",
        "decreasing my visibility into threats or is having too many false positives causing me to miss true positives and so the first problem I'm running into is I don't know where to start with metrics detection and response has significantly matured as a field but I'm stuck here making metrics about alert volume so I need a starting point and so to give you a starting point I thought about what in detection and response could we measure to help us make decisions and see if we're improving and you can remember these by the acronym saver it's not the best but it's what we have and we want to show that we're streamlining our operations by improving",
        "our efficiency and accuracy through automation better tooling and processes",
        "we want to raise awareness about what we're learning from our threat Intel share things like our threats and trends that we should be preparing for we want to measure our vigilance how prepared are we for those top threats can we detect them and as we learn about new threats and Trends how is that guiding our threat hunts as we explore our networks what are we finding and when our detections fire or threat hunts turn into incidents those are the best what's our Readiness how quickly are we able to organize and respond to incidents and how complete are our playbooks so when you're thinking about your own met metcs think about which category the metric would fall under and then this can help you tie it back to an outcome and to help you figure out what category a metric should fall under you can ask what questions does this metric",
        "answer so what question were we trying to answer with this metric I think it was are false positives taking up too much of our time do do I have enough time to investigate my true positives and then another question you can ask is how do I control this metric",
        "how do we reduce false",
        "positives alert",
        "tuning so how's that going for",
        "everybody and if I map this to the saver categories this is a streamlined metric and streamlined metrics usually answer questions about efficiency accuracy and",
        "Automation and I have two big problems with this metric first this metric",
        "doesn't tell me where I'm spending most of my time and second the only control",
        "we have is tuning or turning alerts off",
        "so let's make it better and here's a graph of time spent on false positives and I've completely removed true positives for now because for now I'm saying it's okay to spend as much time as we need on the true positives but instead of tracking how many false positives there are I'm tracking how much time is being spent on them now how much time you spend working on them manually could be as simple as measuring the time that it was assigned and the time you marked it as a false positive but if your team is anything like mine we have this amazing bad habit where when we're working the alert queue whoever's the on call will go in there select all the alerts and just assign them to themselves regardless of whether they're going to actually start working on them and why why do we do that what metric is making us do",
        "that yeah that's right meantime to",
        "assign so hear me out stop measuring it",
        "at least temporarily and then this metric here",
        "will get a lot more accurate so how do I control this metric what can I do to improve this",
        "metric well how about Automation and as we get more automation tools the number of events May not equate to how much time we're spending on the false positives and then as you automate carry the time that you spent manually over to automated and this let you do something really cool it lets you speak to the amount of human hours your automation efforts are saving and now you might actually prioritize",
        "Automation and now you're incentivized",
        "to not just tune the alerts but you're incentivized to find where's the most manual time being spent so we can move that over to",
        "automated all right second mistake second mistake is using quantities that lack controls or more simply said",
        "measuring the things you can't change mean time to recover classic",
        "incident response metric it'll be in your Google search in this example we can see that recovery was lower in September and October and then it grew in November and December but then the team pulled together they worked really hard and we brought recovery time down or maybe it was the Christmas holidays I don't know it's funny I have spent the last year measuring met researching metrics for detection and response and I've learned something we are obsessed with",
        "speed the vast majority of results when I search detection and response metrics are about Mean Time mean time to detect time to respond time to contain time to recover and I'm not going to argue that speed isn't important but it shouldn't be our sole measurement of success across all the incident phases it completely ignores quality and",
        "Effectiveness but my big problem with this metric is that security incidents",
        "are all really different especially the further Downstream you get in the response process a lot of dependencies occur her everywhere from the event start to recovery and not all of those things can be controlled at least not by your teams and a graph like this doesn't help me make decisions because I don't know what's controllable",
        "here and if you and your team don't know what's controllable you don't know what to change you'll stop caring about it because you can't affect it instead let's break out the response time across the different phases and here I've filtered out any built-in time",
        "that I need for Quality I like to do this because every response in your playbook has some expected built-in time",
        "yes as you mature your capabilities that time will come down but that's a different metric that's not the focus of this graph here we're just looking at what we can control today right now",
        "Eric brandwine has this great talk it's called the tension between absolutes and ambiguity in security and in it he says when you look at a metric it should immediately answer what do you want from",
        "me and one of the easiest things to do to do that is make the answer zero if there's nothing to do so here I've filtered out all the time we can't reduce right now so if there's nothing for me to do we've made the answer zero so now I can look at these metrics and I know exactly what it wants for me go look at whatever those incidents were from December and figure out what happened in the remediation",
        "phase mistake number three thinking",
        "proxy metrics are bad or more simply",
        "choosing amazing metrics that are",
        "insanely expensive to create when all we",
        "really needed was a correlating metric that was good enough and here's a great example eight years ago my team and I decided that we wanted to know what our miter attack coverage was this was before miter attack was the cool thing to do so we determined that we needed to write tests across the entire framework and then once we got going we figured oh no one test per technique that doesn't make any sense so we need a lot and then also we have Windows Mac and Linux and all the different environments and so after years of developing tests investing in",
        "tooling we finally had the data we needed to visualize truly like we felt confident with it are attack detection",
        "coverage side note I saw a great tweet the other day and it said we need to do a better job at mocking vendors that claim 100% miter attack coverage for",
        "many reasons but most importantly I've",
        "seen the Carnage of 100% coverage and",
        "it's alert fatigue like you wouldn't believe anyway we spent years building this data and it is cool but at the end of the day all we all we really wanted to know was where do we prioritize our detection building so do this instead rather than trying to measure your detection coverage across the entire attack Matrix",
        "start by finding the top five threats you care about the most don't overthink it look at your external thread Intel look at what's impacting the industry you're working in and then what type of environment you have and then look at your incident Trends what kind of incidents are reoccurring and then link those back to your organization's risks",
        "what would be a really bad day for your company if data was exfiltrated from your company what would make your Chief privacy officer cry the",
        "most and then once you have your top five prioritize your detection development from there I like the workshop these as a team where everyone takes one of the top five threats and then we use attack to derive all the different techniques and sub techniques from those and as you write your tests and your detections you'll slowly end up building yourself a prioritized miter attack coverage map but without all the alert fatigue and the super costly metric and plus now you might be friends with your Chief privacy officer mistake number four not adjusting to the altitude and as someone who has floated back and forth between management and individual contributor",
        "I'm really guilty of this one have you ever tried to explain the differ phases of the miter attack framework to a board of directors I have sure why not let's do it detection coverage is actually one of the better metrics we've come up with but wow we've done a bad job at explaining at the leadership level I've actually seen one of those generated mitor attack heat Maps just slapped into a director's board uh as if it meant anything to them",
        "so we need metrics at every altitude and the higher the altitude the less it becomes about detection and response and the more it becomes about how its impact is to the business it's helpful for me to think about it like a pyramid for the business the impact we make is reducing the cost of an incident or breach or making it super costly for the attacker to cause an incident and so our metrics at the top of the pyramid are Northstar metrics are our time to detect and alert the organization of a threat and the time to respond and get things back to business as usual and then under that top layer is our coverage and Effectiveness can we detect the top threats to the business do we have playbooks for the attacks most likely to happen do we have the visibility we need and then under that layer how well are our tools performing how much time do we spend trying to figure out what logs we need to search and how long does it take to search them and so if you organize your metrics into a pyramid it can help you it can help you when you're lower down the layers to connect it back up to the top to your North Stars and also speak at the altitude that's appropriate to your audience organizing your metrics in a pyramid can also help you connect your metrics with the rest of your security organization because it turns out detection and response isn't always the best strategy if your metrics show that mean",
        "time to respond is trending up because of repeating type of incident Sometimes the best way to reduce the cost isn't by improving or streamline up or improving your streamlined or your Readiness metrics it's putting a new control in place to prevent that type of incident from even occurring so now you have a way to funnel those back into your security organization so they can make those type of decisions and then mistake number five asking why instead of",
        "how and my natural inclination is to ask",
        "why why didn't we detect the malware sooner why are we missing the firewall",
        "logs and as a dad I have a lot of why questions",
        "why did we bring the car seat when all we did was one taxi ride the entire trip why do we need four suitcases why didn't we bring the stroller why can't leam walk by himself but in all of these examples why is not helping so instead I've learned",
        "to move straight to the how and start figuring out what needs to be done and often and in how allows you to",
        "identify the underlying problem much faster and much with a much more positive perspective especially from your spouse I mean cooworker how can I carry Liam a car seat and two suitcases through the airport how can I detect this type of threat faster how can we respond faster when I interviewed with my current VP she asked me how do we build a modern detection and response program how do we get there great question uh not a simple answer um and how do we describe today where we are now and where we're",
        "going and it made me think about maturity models and my first exposure to",
        "maturity models was the hunting maturity model hmm and the hunting maturity model",
        "was really helpful in describing the maturity of our threat hunting and then what we needed to do to get to that next level of maturity maturity models help us as security practitioners to have a common language to answer where are we now what tools and processes do we have today what's the current situation and what are the challenges and where are we going where do we want to be by next year and how are we going to get there what's our objectives how are we going to achieve them and so I created the threat detection and response maturity model",
        "and this maturity model builds off of the hunting maturity model and then expands it across all the different areas of detection and response and there is a lot to it so at the end I'll provide a link and so you can use the full maturity model in your own organization and the first pillar I thought about when measuring maturity was obser",
        "observability or having the tool tools and logs that give us visibility into our entities and user activity and enriching it so we can contextualize the data and search it quickly and then proactive threat detection where we focus on collecting threat Intel so we can prioritize the detections we build and buy and the Hunts we perform and then finally rapid response where we prepare with playbooks and automations so we can move from triage to analysis and respond with all the forensic capabilities we need and we can use these pillars and these 14 capabilities to describe and measure where we are today and where we want to go next and for each of the 14 capabilities in the framework you'll score them in four different areas process tools",
        "documentation and testing and then you'll rate those from initial all the way up to Leading maturity and I provided some general guidance on how to rate these with in the slide deck but in the framework itself there's even more specific direction for each capability so for example if we rate our detection engine capability we can think about what kind of processes do we have do I have a process when I'm creating a detection that for example looks at firsttime occurrences do I have a process that defines what's the best way for me to determine the thresholds for that and then radar tools are our detections managed from a central location and then documentation or what's been the case for most of my career the lack of documentation and then finally testing how do you validate that our logic to determine firsttime occurrences is",
        "working and as you go through each of the capabilities and rate them I like to rate them individually and then afterward rate them together as a team because as you get everyone talking about all the different capabilities you'll hear things you didn't think about and they may change your mind and change your own thought about your maturity level and then once you've rated all of the capabilities you can visualize it",
        "and here's an example of how you can take those ratings and show at a high level where you are today across the three pillars and where you plan to be by say the end of the year based on the projects you've planned and the initiatives and I like to use this tool the leadership level because it's a simple message but there's a lot of underlying detail that backs it up but I also like using it because it shows whether the work you're doing and plan to do is having an impact on your maturity if you've planned all your projects and the bar did not move maybe question are we doing the right thing and as you do that work you'll need metrics to show that you're getting better and so that's that's where the saber framework can come in again and for each metric you create you'll put it into this structure here avoid my",
        "mistake number one losing sight of the goal and ask what questions does this metric answer what's the outcome we're looking to achieve and then use the saver categories to help you tie back your outcomes to your North Stars and then avoid my mistake number two using quantities that lack controls",
        "make sure that it's a metric that you can actually control and don't forget to make it zero and filter out what you can't control so that when you look at a metric you know exactly what it's telling you to do and then if you can control a metric",
        "what risks could this measurement reward",
        "I was talking to a buddy of mine and he runs one of those really big socks like the kind in the huge room and the monitor on the wall and the pew pew Maps does everyone know what the pew pew maps are yes we love the pew pew maps and we were talking about metrics and he was talking about the time to analyze metric and it was a really big pain point in this suck analysis was taking a lot longer than they expected and so they brought the metric up to the team hey time to analyze we have to figure out how do we bring this down and so guess what you you won't believe it they brought it down and then guess what else went down the quality of analysis so then",
        "guess what went up true positives",
        "missed so when you introduce a new metric think about what potentially risky Behavior could this be rewarding and it might not be a bad metric but you might want to create some companion metrics to it to balance it out remember you are what you",
        "measure and then there's metric expiration when is this metric not needed anymore when our only lever was alert tuning it might have made more sense to track alert volume but now as we automate maybe it's time to expire",
        "our alert count metrics or at least remove them from your leadership decks and then data requirements how much data will this metric require and and then how much new effort are we going to need to improve this metric because it turns out even when you create a new metric you don't magically get people to help you improve that metric and then how much does it cost to create this metric don't come away from this talk telling people that Allan said everybody should be spending all their time on metrics because first of all no one will like you and I don't want that coming back to me but remember my mistake number three where when I tested 100% across the miter attack framework it was cool right but you might not need to because you might be creating a really costly metric and anytime I talk",
        "about metrics I always get asked how do",
        "I change the bad metrics that I'm already presenting today how do I make that",
        "change and I get it because change is really hard and leadership does not like surprises and they often have expectations that you'll be updating last month's slide deck but I have one tip that's worked really well for me here I've convinced my friend Dexter still my friend to get into near freezing water and Dexter's first reaction was",
        "shock his heart rate spiked when his body hit the water he gasped Liam thought it was great you had to work to not hyperventilate but then suddenly Clarity and it's the same when you change your metrics it's not going to be fun immediately some people are going to go into a State of Shock especially if those bad metrics have been around for a while they've gotten used to them but my tip is embrace it push through the change because you soon will have Clarity around how you actually are improving and how you're performing so let's bring it all together an upfront and Center is our maturity using the TDR maturity model",
        "and then we can use the saver categories to tell the program the story of our program we're streamlining our operations by looking at what's taking the most time and automating it we're looking at our thread Intel at incident Trends and we're raising awareness about these top five threats to the company we're focusing our time this quarter to build detections for these threats here's where we're tracking and we've been exploring gaps in our security controls relevant to those top five threats we found three new gaps we want to raise and from a Readiness perspective we have one type of reoccurring incident that with a really long recovery time and so we're working with our Enterprise security team to implement new controls that'll prevent these incidents from ever occurring so",
        "now instead of making wild guesses about whether you're improving and if tools that you're buying are making a difference you have the TDR maturity model to measure your capabilities instead of using volume counts fear tactics and tired emojis you",
        "can use saver to get to the core of a metric ask better questions and map that to something you can control instead of focusing on a 100% miter attack coverage you're focusing on the threat that matter the most found those top five and are working on having detection coverage with real",
        "impact hopefully this talk is your wakeup call take the cold plunge it's time to rethink your detection and response metrics thank you very",
        "much and we do have time for questions so if you have a question please start heading over to the mic phone and this is my link tree it's got my contact info a copy of the slide deck and the TDR maturity model I also write a very infrequent",
        "newsletter remember I have a toddler so not much time uh it's called meard it has an adorable cat that people love and the security info is decent um so yeah",
        "let's get to some of the questions hi thank you thank you very much for your talk um I'll the very beginning you said your first error was to lose sight of the goal and then later on you had this picture with your North start and the top you said cost of breach or incident but if I take a metaphor and I look at a building which is on fire and the fire department comes nobody is going to come and ask them how much did the Fire cost but actually how much did you manage to to spare to save from the building and I think this is the main problem we have in security we remain a cost Center and we def desperately try to justify how much we cost as opposed to how much we have managed to spare and to save so have you any idea on how to because as part of your detection if you can categorize and qualify the kind of stuff you have stopped you could also say you know if this is a script Kitty you know if I had taken two hours to stop him it would not have created any major damage if it was a state sponsored you know the the the consequences would have much better much much greater right so yeah I haven't seen anyone trying to measure that M did I miss it no it's a good question um first I'll say that the",
        "cost of the breach is one way to think about it but and then the other the other side of that though is the cost that we make on the attacker about how difficult it is I think that there's um you know a thought when you're thinking about the cost of doing it the cost of that you're putting into it to make it and so you're curring a certain level of attacker so there's that piece to it first of all um but then more directly to your question around um I'm a cost center it's costing a whole bunch of money I'm still having incidents but how",
        "have I reduced the cost of those incidents like what is the actual um the cost of that I think from your incidents you have a way to calculate that and I think it's important to pull that data out of there um throughout the entire life cycle of an incident through all of your different phases there's a increased cost to each of those the less prepared you are and the longer it took you to detect it right and so if you're saying hey you know what we did not attack we did not detect this threat when it happened but because we've invested in threat hunting we discovered it in 30 days instead of a year two years and here is what we know from the type of these attackers and this is how much we know in our industry these type of uh incidents cost and then you can do a diff how much did it cost this company how much downtime did it cost and pulling those out from your incidents and using those as metrics of the cost of breach the cost of your incident to compare to what the cost could be I think is a valuable metric as far as detection and response good question we should talk after too I have lots to say about that thank you any other",
        "questions yes please otherwise I have to repeat the question I'll get it wrong I was rather curious so you spent all this time trying to make it seems like your metrics more I suppose strategic in the way that it's feeding back to both the board but also through your team did you find that it encouraged um like more structured Improvement through your sock and through your detections as well",
        "uh yeah definitely um even just from the standpoint of you know how you're prioritizing your threats and by making the scope a lot more straightforward and also like in writing I think one of the challenges of you know having miter attack as sort of our framework for these the different type of things that we want to detect it's it's too many things it's all the things we're like here's all the things go ahead and write detections for it and so we just sort of pick whatever one sounds most interesting by having a kind of prioritize like hey we know these are the things that could cost the most for this business these are the highest risk based on these these factors all of a sudden now you have you're a little more motivated to write good detections and you have a lot more of a straightforward path of like hey I know the detection I'm writing today has real value to the business versus I wrote this amazing detection I sure hope it never fires and maybe it won't and I don't know if it if that was valuable and it helps you prioritize if you're working in like an agile type way what your FRA what your backlog should look like it helps you build that out and so that people are pulling things from there that actually make a difference I have time for maybe one more",
        "question yes just one one more point so",
        "I I think all the absolute metrics are useless so what I mean is if you give me a 10 I don't know what a 10 is but if you tell me today I'm a 10 tomorrow I'm a 12 and 12 bigger number are supposed to be worse then I know you get worse right but 12 for you might be very bad compared to the 10 20 for me might be very good because yesterday I was 25 so",
        "I I I feel insecurity in particular because we do not have any like in physics we do not know where the degree is or whatever uh comparative measures ative",
        "measures are much more important than absolute ones be it with respect to time or when you say you do more automation it I think it would be very valuable to also keep measuring if I hadn't had had the sub automation how much would I have spent so comparing how much I do today compared to how much how how would I would have done if I had kept yesterday's model or yesterday's techniques and and again this is not something I'm seeing very often yeah uh comparative metrics are really important that are in the context um I'm I'm hoping and it's something that I'm just started doing with the maturity model is having other organizations that",
        "we work closely side by side with and see where are you guys at in maturity because I can say I'd love to be at leading but maybe that's not a realistic goal from our organization maybe that's not the level that we'll ever be at and that might be fine based on the risks budget size all those things but am I in a relatively better or same state as the rest how am I compared against the others because turns out the attackers are just going to go for the lower easier targets and if you are you know further along than that then you're already doing much better but yeah comparison to something within the same context makes a lot of sense we're out of time thanks so much for coming to talk I'll be sticking around in the front and would love to chat with you for a little bit more I have some meowed stickers with the cat and if you like this talk please remember leave your feedback um you'll be able to do that later today in the black hat Events app it'll be under your my evaluation section so thanks y'all",
        "[Applause]"
    ],
    "2qbZ33zSHz8": [
        "hey everyone and welcome to my talk the Dark Side of EDR repurpose EDR as an offensive tool my name is Shmo Cohen and I'm excited to be here today and talk about my recent research and a little bit about myself um I've been working in the cyber security industry for about six years and currently I'm part of save brid research team H focusing on vulnerability research and for various products I also used to be part of checkpoint research group where I conducted Mal research and specializing in AP groups let's take a look at our agenda for today and we'll begin with our goal why we are doing this and then we delve into an overview of Cortex xdr following that I'll demonstrate how I bypassed serval cortex xdr protections",
        "and we will discuss its policy files and why they are important and finally we'll conclude with some closing remarks as a former malware researcher I constantly observed the ongoing race between EDR Solutions and evolving malware whenever EDR got more advanced",
        "malood followed the same path and got more sophisticated this led me to wonder is there a possibility of integrating both EDR and malware functionalities together together in a way that the EDR itself will be malicious as the title of my talk suggests the answer is",
        "yes if we consider EDR as the guardian of the endpoint what happens when those Guardians turns against us by",
        "transforming an EDR into a malware attackers gains stealy access and can executed um Can execute sophisticated attack without the detection this raises",
        "The crucial question who will guard the guards",
        "themselves my research goals was twofold",
        "first to develop a malware that integrates seamlessly within the EDR",
        "itself rather than simply bypassing it",
        "second to ensure that this malware meets the criteria of being an AP grade malware this means it must exhibit properties of persistence stealthiness",
        "and high privilege access those properties are very similar to what EDR already possesses to provide the EDR with the power to eliminate any threat that is trying to attack the endpoint it's need to have basically um three important things one it's need to operate with the highest privileges possible second it",
        "need to be temper proof um ensuring user cannot modify its files and lastly it need to be very very very persistent with this knowledge I started to check top tier edrs on the market and I wanted an EDR solution that is commonly used within",
        "Enterprises after looking for a while Pao Alto cortex xdr looks like an ideal candidate um for this uh research it possesses the capability we discussed earlier and offer cost platform support for Windows Mac OS and Linux environment",
        "but for this research I focused on the Windows agent only with cortex xdr",
        "identified as our case study let's delve into its working as a starting point I checked which files were written to disk during the installation of Cortex xdr it seems like there's a lot of Cortex files um H written into the program data folder and after digging in I discover this interesting folder that you can see on the screen it's called content it's located within the program data directory these folders appear to contain policy rules in a form of flua and python files despite being in clear text and relatively easy to understand",
        "um the large number of this file in this folder motivated me to get a quick H answer of their purpose and let's be honest guys um today almost everyone has a super assistant in their pocket and I'm talking of course about Ai and in my case I use gini I asked that what is the content of Palo Alto cortex xdr content file and he replied me and pretty funny answer basically saying that due to security considerations sharing the content of those Lua files can assist malicious actors to craft techniques to bypass detection rules and predict system responses so I thought to myself wa all the files are already clear texted and they also relatively easy to read this got me thinking why not taking a hint from Gemini and leverage these files to craft techniques to bypass detection rules well it sounds like a solid plan to me so I started to explore the content files and I came across this interesting one called ransom. Lua and after I read",
        "the content of the file I kind of understood how the Run protection",
        "works the main idea is creating hidden Honeypot files all over around the system and cortex can detect suspicious attempts to modify those files acting as a clear indicator of possible ransomware",
        "attack now let's take a closer look at how cortex keep things hidden you see the cortex developer didn't want that any program could see those hyot files for example in imagine you're browsing through through files with file explorer they don't want you to see all those Honeypot files laying around the system or maybe you use WinRAR to compress a folder that contains those files no one wants Honeypot files inside their archives right so to solve that they put together a list of processes that those Honeypot files will stay hidden from and guess what the list is clear texted within the ransom. Lua file and we can easily pick inside this list and see all the processes they've included so now I have a question for you all guys um with this list in plain site what name would you give your ransomware let's answer this question in an in a",
        "demo so in this demo we can see um that first I'm showing that every uh protection and every service of Cortex xdr is enabled and I created a simple ransomware written in Python and that is",
        "going to encryp the entire documents folder and as we can see we have very important files in this folder now I'm creating a copy of the ransomware inside the desktop and this ransomware is simply getting in as an input H folder and its Target is to encrypt the entire folder so I'm providing the documents folder that we want to encrypt and we can see that as expect Ed cortex xdr prevented us from doing that and um it prevented us because we have a suspicious um file modifications so the ransom protection Protection work as",
        "expected um and also um cortex",
        "quarantine our file but luckily for us I saved a copy inside the downloads folder now I'm recreating um another copy of the ransomware inside the desktop but this time I I will rename it to one of the Whit list processes that we saw now I changed his name run it again and the same uh drill I'm putting the um",
        "documents folder as an input let's see what H what will happen this time and as we can see all the files H got encrypted inside this folder and let's just double verify it and see that they're actually encrypted as you can see this file looks pretty encrypted to me so after the successful Ransom protection bypass I couldn't resist the urge to push further and test cortex responses for more malicious attacks my next experiment was attempting to do an Elsas memory dump and for those of you who may not be familiar with Elsas here's a quick summary of why memory dump of Elsas considered a malicious action essentially Elsas which stands for local security Authority subsystem service is a crucial system process responsible of managing managing security policies credentials and authentication on Windows attempting to dump its memory can potentially expose sensitive information such as usernames",
        "passwords and security tokens making it significant security",
        "risk one common method um used to dump um uh process memory is through a c internal utility called progam and malicious actor often utilize progam and to extract memory from the Elsa process I returned to our protected machine and I attempted to execute um the proam command the pro the program command that you see on the screen and aiming to dump Elsa's memory into a file and as expected I got prevention from the xdr and it was kind enough to provide me the exact reason for detection it appears that I was detected due to a Rex test as you can see in the image",
        "to bypass this reject we can simply insert two quotes in the middle of the command while this won't change the command result at all it will bypass the re check filled with hopes I executed this modify command and the good news is I was able to bypass their reject test but the bad news is now I got four different prevention notifications as you can see and all of them were related to the mini dump rump function which is a function used to dump Elsa's memory and I returned to the content files and triy to located those prevention rules and I found them I found them in a file named DS rules and config Lua as you can see in the red box one of these rules for instance is titled mini dump rump RPM terminate with",
        "the action to block it at first it appeared like a dead end leaving me unsure sure how can I proceed with bypassing it and as I continue exploring this file I came across another list titled as mimicat RPM process whitelist",
        "which caught my attention considering the using of the term RPM I thought it might be related to the prevention rules that we just review I decided to do an experiment I tried to rename progam to one of those name in this list and to my surprise it it worked I successfully managed to dump Elsa's memory let's see a demo of this",
        "bypass so um at first we can see that I'm uh going H to show you again that every um every service and every protection is enabled as you can see everything is enabled and running and for first just for sanity test we will run prog dump um as the the usual command to see what will happen and as we just saw we got a prevention with the Rex um Rex",
        "test okay so now the next step will be to insert the two quotes that we just talked about and I have another terminal",
        "here and navigating to desktop and running the same command but now this time with the two quotes inside of the middle of the command we can see that now we have the full preventional uh rule the preventional notification that we saw now the last check is Will is Will is um I will try to rename progam to list ds. exe which is one of the names inside the um this white list and",
        "we can see that this time it worked and I was able to dump completely um Elsas into uh the",
        "desktop so the root cause that enables me to carry out such an attacks was primarily the fact that the policy content is relatively easy to read with heavy Reliance on process names while this provide a good starting point I began to consider what could be done next remember our goal is not just",
        "bypass the EDR but create a malware that operates within the EDR itself this got me thinking about the possibility of adding or removing my own rules to those files do you think it's possible to do so let's explore the concept of file tempering and investigate how cortex xdr protects its files for modifications so when attempting to modify files even with administrator privileges I encounter a file access denied er error message this Behavior led me to suspect that a mini filter driver may be responsible and a mini filter is a known way for intercepting IO request and um",
        "it can block certain request if necessary with this understanding I started um to reverse engineer and the cortex drivers and while they have multiple drivers running on the system one in particular caught my intention can you guess what the Cyber fsfd drival and this one",
        "caught my attention and the reason is because fsfd is usually um short for",
        "file system filter",
        "driver and indeed while reverse engineering engineering this driver I observed a list of files and folders that the mini filter is safeguarding from any modifications but how exactly they are",
        "enforced these protections The Next Step was to investigate the implementation of the mini filter driver",
        "itself and after reversing a little bit more I found the implementation of the mini filter itself and that is responsible for protecting files from modification and they basically compare the path names with the protected files when someone try to open a file with the right permission so think that you are um going um to um open a file with right permissions any file on the system it will go through the mini filter driver and if the path of the file that you are trying to modify is um inside the list of their protected files it will um deny access to access this file so how can we bypass this protection the protection is made with a path check but path check is uh not good enough and there are other methods to change files and did anyone here heard about the concept of linking um linking is a method using in operating system to create um connection between files or directories allowing them to access for multiple locations by creating a link to one of their protected files from an unprotected location we can effectively write um into the link file and and this will gain us the ability to write to the original protected",
        "file there's there are different types of links um including soft links and hard link um let's talk about soft link softlink is essentially creates a files that points directly to the original file and any attempt to modify the soft L file is equivalent to try to modifying the original file directly thus we can we would face again the mini filter driver and it will block us from doing that but unlike soft links which are much more like shortcuts pointing to the original file hard links creates what appear to be a distinct file but in reality it's just another reference to the same data on the disk this means that when you make changes to the hardlink file it directly modify the original file so if we could create a hard link from an unprotected location on the disk to one of Cortex protected files we could change the hardlink um file because it's not in protected location but it will eventually change the original file and luckily for us Windows provides a tool called MK link which includes a feature allowing you to create links between files and create hard links between files um one thing to note is you must have right access to the directory where the H where the hard link will be placed and it in in our case it will require an admin privileges but unfortunately for us this attempt to create hard link is still getting block and the question is why I wonder which stage of the hardlink creation process failed and to investigate further I used um another c internal tool and this time prog dump and for those of you who aren't familiar with prog dump is short for process Monitor and it's a powerful tools that enables you that in in in real time to monitor activities including um activities on the file system including m f related actions so I use program and executed the MK link MK link command once more then I Noti is an access denied error assoc associated with the create file operation as you can see in the image this actually makes sense as you may recall the mini filter is preventing us from opening a file with right permissions so this while the MK link is failing so I thought myself how can I solve it and after a quick search I saw this amazing blog called between a rock and a hardlink authored by James forw from Google project zero and in summary his research revealed that it's possible to create hard links with without requiring write attributes so you can do it with read attributes only and he also",
        "created a gup repository with implementation of the hardlink creation tool without the need of right attributes and luckily for me it worked I download his creation tool and discovered that it's actually working I successfully created a hard link to one of Cortex content",
        "files now the question is when we have the capability of modifying the content files what will be our next step do you remember the DSC rules configs that we saw earlier let's begin with modify it rules um so as you can see in the image I chose to change the detection rule of loading a vulnerable driver and bring your own vulnerable driver attack um named rtic cor 64 um and as you can see the action taking H in this rule is to block it so I changed it to allow instead and let's see what happened and if it will work we could load this vulnerable driver this means that we can exploit its vulnerability and it will allow us Kel read and write privileges H Primitives sorry and it looks like it didn't work can someone guess why and the answer is that the problem",
        "with this approach is the xdr process is already loaded all those file all those rules and when it started up so any changes to those files won't affect them so I needed a way to somehow restart the cortex xdr process or and make it reload",
        "the rules once again and I started to think how can I do it I navigated to the cortex folder and looked for help there and this time I um navigated to to the program uh program files directory and inside the cortex uh folder we we have a tool called SC tool SC tool is a command line utility that allows you to interact with the xdr I started looking at the CLE capabilities and I saw an interesting one called",
        "checking and so checking is basically a function used to query the management server for updates including policy updates however when I attempted to perform a check-in the content files were um downloaded um again from the management server overwriting all the changes that I've made and this is an important stage so I wanted to to add um",
        "a clarification of exactly what happens and because we will mention the check-in process several times in the upcoming slide so I wanted to make sure everyone got it um so let's see how our process looks like so for start we are modifying the content files as you if you remember change from block to allow and secondly we initiate a check-in process essentially requesting requesting updates from the management server then the management server return us with the latest um update content and finally the new content is written to the content folder replacing the all content files along with our modifications to solve that I wanted to block any connection from the xdr to the management server and see what happens and to do that I needed to know what is the domain of the management server and again luckily for us it's written within the content files so there's a file called core home URL which contains the exact URL for the management server so I simply added um the entry um showing in the image to the host file effectively blocking any connection from the xdr to the management server and after that I attempted to perform checking again and this time it worked",
        "although the xdr failed to download content H content files from the management server it still reloaded my",
        "modified policy files so let's summarize what we accomplished so far firstly with the ability to read content files we were able to bypass security measures secondly we can now insert remove and change uh rules within the policy files lastly as a proof of concept I ex i' I've exploited um the vulnerability within the RT core 64 driver to patch and the cortex administrator password verification function administrator password is used for various task including disabling protections or even completely stop the xdr from running and I modifi that in such a way that any password would work when attempting to interact with the ex SDR and it can also be patched in a way that no password will work making it very very hard H task to remove the xdr from the computer and again for start um let's",
        "see let's see a demo of uh this uh this uh",
        "bypass and for start we again queried the um cortex xdr to see that everything is up and running as usual",
        "and now I will navigate back to my POC folder and I will run the attack and as we can remember what I'm doing here is changing um the policy rules in order to allow me to load this vulnerable",
        "driver and for start I'm trying to Echo a wrong password into scol protect disa trying to disabling um um the the",
        "protection in the xdr and another test to try to save Rich labs this time to try to disable the xdr completely we saw that both of H this password didn't work",
        "now I'm navigating to the PC folder and I'm running the",
        "exploit and basically changing uh the rules in Artic core 64 to allow and then initiating a checking this will take a few seconds but after the checking I loaded the rtic core 64 driver and Patch successfully um the driver and now let's navigate back",
        "to the cortex folder and we can see that I'm using the same wrong password that I used before to disable protections but this time it works we can see that this uh protection all the protections are now disabled and just for fun another password and this time Ser save Bridge labs to shut down completely the entire xdr and we can see that now um xdr is stopping side server which is the main process of the",
        "xdr thank",
        "you but disabling edrs or removing",
        "protections is a tactic that is been observed in the wild many times however in this research I aim to develop a novel method um that has not been seen before and as a former malw researcher I observed that most most APS groups prioritize and three main objectives",
        "stealthiness persistence and elevated Privileges and as you may recall I can modify Lua rules and Lua is actually a programming language so maybe instead of changing the rules perhaps we can insert our own malicious Lua rules H sorry um our own malicious Lua code to run within the xdr and for sanity test I attempted to inser a very simple code that just creates a file on the desktop I inserted this code to one of the lure rules and I initiated a check-in process once again and after the check-in process finished we can see that this code ran and created this file in the desktop and my next step was to write another function that would um let me execute my commands the goal was to confirm that I could run my own commands within s server process however something very strange happened this time when I attempted to run this code the SI server and X which is the main xdr process crashed",
        "completely apparently the um I.P openen",
        "function um in the Lua code is the line that triggers this behavior I'm not sure why happening and I didn't um investigate it too much but I suspect that this code and that I added invokes an unhandled exeption in a SI server leading to a crush in the SI server process but this is only my guess and I attempted several other techniques to run my code within this L files and including trying to load a malicious dll or using other L commands and such as os. execute and other commands that but but no one and no command or no um technique that I tried worked and but don't worry and this Behavior will come in handy soon um so I passed about um the Lu",
        "rules and I remember that during my exploration of the content files I came across some python script as well and um",
        "I became curious about their purpose and since I could modify all the content files including those Python scripts I began to wonder what if um cortex will execute them maybe can execute my own python script and python is an easy leg image and I can do almost everything with it and so I thought maybe I can manipulate cortex once again and I started by taking a look of the running cortex processes and as we can see all of those processes are running with the highest PR privileges um as as as as it should be and and we have the main size server process and it seems like he have some workers under him as you can see in the image and another process with with a very interesting name called um cortex xdr payload.exe and I thought to myself what um is this file what is this process what it's supposed to do so I wanted to to check U maybe if it has some arguments um inside of them and as we can see um it has a configuration file it seems like a config file with a path to a file called um service main Json and zooming in we can see um the file path and so so I thought myself let's open this file and see what's uh inside of it maybe I can modify something there and it seemed to be like a configuration files that is describing an argument for a service called servic man. pile and so I thought myself okay serviceman do pile another interesting name let's take a look at this file and these scripts appear to be a service that running in a Non-Stop Loop and fetching pending task from another service and and execute them as you can see in the red arrow and so the good news is with our hard link bypass we can modify the content of these files and insert our own malicious code the bad news is this python script is already loaded inside cortex xdr payload process as we had the same issue before so even modify the script won't affect cortex xdr process so anyone can guess what the first thing that I tried to do well as you can see in the image I try to do um a checking once again and but this check in check in trick didn't help me this time because H just nothing happened um the cortex xdr payload exit didn't load",
        "and those modified python python files once again so I thought myself okay what can be done next and the next thing is pretty obvious and you can just um restart the computer or log off the user",
        "and it will cause the xdr process to be restarted once the user will log back into the computer once again but actually we already have a better solution under right right under our nose and we can crash s server and restart it immediately as we saw earlier with the I.P open Lua",
        "command so few slides back the io dop open command and let us to crush s server process completely and now leveraging this Behavior we can modify service main.py and with our own malitia script and and then crash SI server and starting it back again quickly um this change will allow our malicious code to be executed with Insight server so this is pretty amazing and we can see a demo of this right now so um this will be our final demo",
        "and I'm again the last time I'm doing this drill of navigating into cortex folder and show you that every protection and every service is up and running and now I will mod navigate to",
        "my PC folder and I will run run as a malware and PC with a reverse shell as an argument so the argument will be injected to servic main.",
        "Pi and on my host computer I'm listening to the port of the reverse shell and let's take a look of Cortex X XD p.x with all of Cortex processes I",
        "started the attack and we can see that few seconds after um cortex xdr completely crashed and um a moment after",
        "he crashing I'm will try to start it once again in my script and we can see that now s server um um went up again",
        "and cortex xdr payload also um um",
        "started we can see that at the moment that cortex xdr payload started and we got a connection from the reverse shell but I wanted to let the script to finish to bring up SI server completely we can see that we have an anti- authority system privileges on the host machine and just to show you that I'm actually running inside cortex xdr payload I ran a timeout command and you can see that it's under it and just for fun let's say that you want to terminate this process um even with an administrator privilege is you couldn't do it because the xdl protecting it so that's pretty funny as",
        "well so um let's review some takeaways from today's session researching endpoint security products for various risk might be even more important than researching the security risk in the operating system itself attackers that that exploit risk in operating system still need to continuously face a guardian however if the Almighty Guardian has been breached by attackers then no entity guards the computer and they will be gifted with a large set of powerful capabilities second the logic of security product should be its deepest secret a simple detection Logics that is keep in secret can be more effective than a disclosed more sophisticated one and when attacker are awes to detection methods and how they Works um they can easily evade them",
        "and and evade them and lastly a laow list or block list should be frame a process um or an action based on multiple parameters and that are solid and cannot be manipulated by attackers and adding a process to a laow list based only on its name or detecting a process um process dump with Rex test is",
        "just not good enough so throughout this session we've uncovered potential weaknesses in cortex xdr system and those findings those findings were shared with Palo Alto network security team last here and this is their official response I give you a few seconds to read",
        "it okay and additionally let me introduce to you um cortex V Vortex um a tool that enables you to test everything that almost everything that we discussed today and including the implementation of both POC demos that we saw including the loading of RTX RT core 64 drivers to patch the administrator password so any password would work and um inserting malicious code to be executed within s server itself feel free to take a picture of this G up repository which will be available after this talk and if anyone have any question feel free to ask me now or if you feel more comfortable to do it later it's also",
        "good oh hey sorry hi my name is Kelsey hi um so I do work um in TDR so my question for you would be what are some medications to such issues um because of my sock we also have alerts that will show in um some of our edrs are being tampered with either from like the users end or any end honestly but um what other mitigations uh would you say to to either detect or protect uh protect hold on it's okay it's okay to either um",
        "prevent or detect thank you sorry okay so okay first um the first thing that the CeX um theme actually did is block the hardlink creation without the right permissions so any hardlink trying to hardlink to their files will also be failed so um in the most updated cortex",
        "um version and and this method will not work as they mitigated this and but maybe there's other ways to hardlink files and you can all continue research about it and the second thing that I",
        "think is something very important is to hide those uh content files from any user to just be able to read I mean if those file were encrypted and let's say decrypted inside memory it it will be much harder for researchers to um read those files and understand understand how it how they are working and I think that this will also be a very good mitigation um it won't stop attackers but it will make their life their life much harder which also a good mitigation",
        "method um and I think that's it perfect",
        "thank you thank you",
        "yes uh so you were ding this on the um example of the Polar Alto xdr but there are lots of other xdr the company I work for we also do xdr so would you say that this is a design flow in the concept of xdr where they buil so much self-",
        "protection mechanisms into the product",
        "that if you basically can exploit you can abuse those self- protection mechanisms to uh use it for your",
        "persistence like like you even kill the process exactly exactly that's exactly what I did in this research I leveraged the power of the R itself to run my own code and if I will able to in any other EDR product to run my own code within the EDR process itself I will be um Almighty I can do almost everything on the computer it will be super hard um to remove me from the computer because no one wants an easy method to remove the xdr from the computer so um I think it",
        "can be also exploited in other R Solutions I didn't check other R Solutions so I don't want to give like a straight answer about it and but if other solution would you would you think that this is a design problem that the way people think of EDR solution is wrong because they trying to put all the X in the same box so if you just pick one of the X you basically let the whole castle fail bit like would do you think that this is more of a design issue than a particular product issue yeah so I'm not sure it's it's particular product issue I I I I'm not sure if it's it's it's a design issue because edrs are supposed to be very persistent and very protected and",
        "but if you do um an ed solution that is very persistent very protected make sure you protect its files and so no one could change its behavior in any other way cool thank you thank",
        "you yes hi hi um so I know the cortex agent picks up a reasonable amount of telemetry from the endpoint did you have a look at what the agent itself was logging from what you were doing and see if it would have if you could have detected that beforehand um so actually no I didn't look at the EDR logs of what I'm what I was doing I'm not sure that he was aware aware of that because if it was aware of that and he didn't do anything to prevent it it would be pretty funny it does happen though yeah and but no so to for question no I didn't check it logs and how if it detects me or",
        "not one",
        "more hi hi uh it's a great great session for sure uh in one the in the demo actually you were loading some malicious drivers uh the question is that was hbci was enabled during that session during that period sorry can you come again HCI uh was okay okay okay okay so about HCI it's a very good good question in this demo I've used um VMS without hbci",
        "enabled and it's not it's not a nested virtualization for those of you who aren't familiar with hbci is a mitigation method used in Windows to protect um this driver patching that I was doing and and so I didn't check it um on a real endpoint and which with um HCI",
        "enabled um but the main uh purpose of",
        "This research is not about the patching of the administrator password but rather of",
        "um inserting my own malware to run within the EDR process itself thank you so much thank you great great",
        "question okay I think",
        "uh thank you all for joining session the Dark Side of EDR repurposing EDR as an offensive tool this is um all my handles to Twitter and Linkedin and mail feel free to contact me and we can also talk uh after this session thank you everyone"
    ],
    "8SvBZzxcFuk": [
        "how is",
        "everybody energetic I like it um all right so uh we're just going to kick it off we got a bit to cover here so um welcome to the black at Asia KN report who are we hello hi um my mom named me",
        "Neil Wier but most people in the information security and hacker Community know me as grifter um I by day I am the global lead of active threat assessments for IBM xforce so I run X Force's threat hunting program around the world um but by night I do stuff like this um as one of the knock leads I've been uh running the black hat knock for this us show will be my 23rd year how many shows we just looked at shows the number of shows we just counted up shows this is my 78th black hat um yeah that's why",
        "yes clap for my bad back and receding",
        "hairline um",
        "so um on top of that I also um run the contests and events at Defcon I've written a few books I speak at conferences around the world and all of those things are are super braggy but really what they are trying to tell you is that like I love security I have always loved security um which is why it's it's really the only thing I do I always like to find ways to make fun of his intro cuz mine's always shorter so uh my mom named me Bart um everybody else here calls me Bart so that works too uh I uh by day I'm a principal Security Solutions architect at CDW uh used to do Defcon at this point definitely still go got that gold badge and said I'm good um and now do all the other things have not wrote any books but I think I'm still cool you should let's roll you know what knowing what I know about you you should write a children's book I don't know how to take that all right but we don't um we don't run the knock alone this is the blackhead Asia 2024 knock team yes we should please",
        "okay um and that that team is uh is made up of well really the couch that you see there are are the um the the knock leads",
        "and then and all of the folks behind us there are our partners knock Partners so who are they uh so these are our partners as he said and again uh Partners is is very specific word that we use here these are not people that come in and pay to be in uh the knock grifter myself and Steve Fink our principal architect work through to make sure what we use is what we need uh we go through get demos if we have something a problem that we need to solve a solution we need to get uh as if we are running any other knock sock we go find out what product will best fit uh that need so Arista Cisco corite pal",
        "Alto and netwitness and then uh here in Singapore my Republic provides the bandwidth which here we have one gig so thank you very much to them we clap for the team clap for them too please they definitely deserve",
        "that yeah I will say um as Bart mentioned because they are partners and the way that we select them stuff it's kind of cool it's an interesting Insight uh on a on a different part of um what we do in our our day jobs where we get to act as the customer or we're the ones going and and instead of um purchasing power what we trade is brand Equity um so we don't we don't pay for the equipment and they don't pay for us to use it um it is it is genuinely a partnership and and so far everybody that when we've wanted to use a technology and we've said hey can we use your stuff they've said absolutely and not only do they send gear but they send folks to back us up as well oh look those are pretty knock partner leads again just trying to give give these guys a shout out cuz there's a ton of work that goes into this we do plenty but um certainly a lot less than we used to these guys all put in a heck of a lot of work a heck of a lot of hours uh uh a whole lot of planning time calls work here uh and again thank you to them these are the team leads at those partners and the guys that we uh interact with on a a very regular basis we got a slack channel that runs all year it's not just here uh and we we are often in communication again we appreciate the hell out of these people look how innocent Jonathan looks and he's actually like a really scary Jimmy",
        "has all the dinosaurs behind him I wouldn't say he doesn't look too much more innocent all right so let's talk about how this thing gets put together all right so we've always lived by the principle keep it simple stupid um so it may look a little basic and that's totally the point uh I won't read the numbers to you here you can go through and look at that but we'll kind of walk through here really quick uh we do have again our 1 gig internet from my Republic that goes into a uh switch that we use from Arista for our breakout on those ha firewalls that are our way and Edge uh those come down to our core switches uh that Arista provides and then arist also provides the tap south of that so you can see our tap and visibility into those tools off to the right from there we go down into uh this is a little unique compared to what we do in Las Vegas in the US show uh so here in in London we actually ride the infrastructure of the venue so in this case uh Marina Bay Sands um we use their infrastructure as far as distribution switches and cables Etc so that's what we see there that goes out to our um registration Wi-Fi networks as well as Arsenal that we have broke out uh and then we have our management Network for all the tools and then the knock that we have there the one thing I'll point out that is a little bit new on this diagram if you've been here before uh you you can see those little eyes that are there uh we've talked about it a bit but we are starting to use thousand eyes from Cisco uh they've provided that and it is become a pretty cool tool we'll talk about some other things there and what it provides but it's basically giving us visibility into those networks uh where we place them so on Wi-Fi at the core in classrooms Etc we can do tests we can see what that um Network looks like at the time so we're not waiting for somebody to come tell us something's wrong hopefully we can proactively see that something happening go fix it and you'll never even notice sorry while you were doing that I was smiling like an idiot um and I'll tell you why in case you're wondering why is he smiling so big up there I checked my fly like a couple years ago at the US show my fly was down for the first 20 minutes of the talk and now I'm scarred by it so and then I thought I did it and I was like was I slick enough and I started laughing and whatever but so there it is all right so this is actually so that's a whole list of gear and this is how it gets put together um so we come in early we arrived um last Thursday um",
        "so it's not it's not very early but it's early enough we come in and we set up what is essentially an Enterprise class Network in two days right and so this is how that all comes together um I we I like this cuz when we're moving fast like that it looks like we're busy like we're right it's like three days worth don't we look like we're accomplishing the hell out of something right there like um so if you before performance review your annual performance review just record yourself at your desk for like a day and then show your boss the time",
        "lapse all right so this is actually the Integrations this has got a lot deeper and we'll talk about some of these things and kind of where it is but again we talk about that kind of high level overview of what the architecture looks like but there is a whole lot going on uh kind of on the back end if you will the Integrations between all these Partners the other thing to notice um when you look at some of those names you talk about Cisco and pow Alto outside of these here walls those guys would be fighting each other normally right we're really proud to say that these guys are even hugging each other right now we love the hell out of them and there's a lot of things that we we kind of brag about this network in the sense that there have genuinely been uh products that change because of the things that we see here at black hat there have been Integrations that are added into products that you guys see in the real world that we see in our day jobs and talk to customers about because of the things that we've done here at black hat and again we appreciate that they're willing to do that kind of stuff that they're willing to work together obviously not just poo and Cisco but again in general uh you would not picture them playing well together if you would on the playground so won't dig through all this we use a whole lot of tools on the back and we are feeding a whole lot of things into each other we're enriching uh we're going to talk a little bit here about how things have come along and where we're going today uh and we'll make a lot more sense kind of when we get to that point but just understand we are doing a whole lot of Automation and riching all of those other products with each other's data and then using that as actionable data to improve what we're doing here yeah I will make another point on that too which is that from the very beginning when we brought the vendors in or Partners in to help us uh they immediately started collaborating which is really nice um in some cases this is an environment where they're really they're the ones who are building these Solutions right so this is a time where they're seeing it in an aggressive environment for the first time or how it hands off data to other products for the for really in a live environment for the first time so they'd look over and be like is that what it looks like when I send that to you I'm so sorry um we'll get it fixed and then they do par Point earlier um also we um we stream the knock live on Twitch we don't know why",
        "um really it started because when everything happened with Co and lockdown or wherever we were behind closed doors and so people couldn't come in and look through the glass at us um they had us locked behind closed doors and we were like okay well we can put a TV outside and show them and we use twitch and now we just stream every once so if you want to watch us at the US show or London in December that's the twitch stream and you can uh watch that time lapse in slow [Laughter]",
        "motion all right we use a significant amount of dashboards in there like I said we have a lot of solutions doing a lot of things collecting a lot of data and we try to do um actually understand what the hell is going on and we do that in a number of ways um what you see we'll we'll start off with a PE PE like that's actually doing something all right so that is a pro a project called OIP it's an open- source project and what it's doing is showing us essentially the most active hosts that are in the network and green Traffic is TCP or those green like little Blobs of data going back and forth red is UDP icmp is white and we can see stuff going back and forth and if it if we see a giant like it will light up really thick and bright and we'll go well that's an awful lot of activity what's going on there and we can turn to somebody like you know corite or net witness and say hey will you take a look at IP address whatever and see what that is also you know scans look like fireworks because there is traffic shooting out from a host across the entire thing and we'll see that visually so it does look very poo but it it does something the size of those dots is also representative of the size of the packet so again there is information in all of that as fancy as it might look it's not necessarily the Norse pew pew but uh it is it is useful it's not the uh last piece of information but provides that glance of the network yeah my favorite OIP pew pew story was like at a US show one time we just saw this it was be we had just opened the noar and no one should be in classrooms but there was this giant like lightsaber of data being like passed between some stuff and we were like what is that right so we wandered down to the class because we know which IPS are tied to which classes and when we got down there I opened the door and there was one guy sitting at a table and he just went tap tap he like looks at me and and I was like oh you're good man we were just checking to see what was going on here he's like",
        "okay but",
        "so um so yeah again lots of shiny lots of shiny on here right there but the data that's on here matters and we'll get into some of it in more detail but we're looking at stuff like you know how many malware samples were um you know sent for malware analytics as part of what we're doing is if we see something that's executable or like a PDF or something that could contain malware we drop it into a Sandbox see what it does try to interact with it um and we had uh what is that 4,137 different samples that we sent for analysis over the course of this show or up until about noon today no that's more it's going to be more it's going to be even more yeah all right anyway",
        "so it they do look shiny and maybe we're just getting older and like further in our careers we now those like the stop Lighty shiny dashboards that we used to make fun of actually mean something to us um but but they do have uh significance in the data again more and more uh this is uh the dashboards that we get from from netwitness you know telling us things about you know uh how the alerts that we're getting or incidents that we're seeing are related to the miter attack framework where um you know in the world those things are coming from or going to that kind of stuff and it's all just in a quick reference and these dashboards are also available for you to see if you come into the front of the knock they're just rotating on the screens in there so you can see what's going on on the network while you're here as well we'll find yourself on the dashboards um so as we dig into this there are also see what I mean there's more there is more so this was this was the updated uh malware analytics uh 4800",
        "we have some other stuff uh from pal Alto this is actually with the xim um we have started building some of that again we'll get into a little bit more depth here uh some of the automation into that and the dashboard here kind of shows where we're getting those data feeds from how many incidents may have come from that that day data being correlated uh and then the severity of those kind of at the bottom right so right here kind of simple uhoh I bumped it you're breaking stuff um so right now kind of simple we're hoping this will look pretty cool uh in Las Vegas with the amount of data points that we're going to have and kind of building that out uh and then again here you can see the mware analytics just uh dashboard any samples that were executed there and what that looks like yeah plus it looks",
        "smooth um you again we can we just we're beating the dashboard to death but this one is actually like physical device location so you can see the marina bayan's Convention Center over there on a map with the um devices that are are",
        "being monitored our devices um so we know where they are this is very useful for us in Las Vegas where we have hundreds of different devices that we deploy and then like you'll see like four of them by the pool cuz somebody put something in their pocket wandered off with it or whatever says talking about the mobile devices used for registration and scanning your bed course yeah um we're going to get into thousand eyes a little bit more so I'm going to jump past that one and then um oh what's that Bart all right uh So speaking of pal Alto anybody he about anything that happened with them in the last week or so well just be cool they're in the room be cool so uh again this this is something that happens right obviously and this would happen to you if you're working in a normal sock you have pal Alto uh you're going to wake up one day and it's going to be a real shitty day with what they announced right so uh what we did here is we actually went back we saw that while we were on a plane we worked with these guys on site we actually do run Global protect here normally for some other things that we do externally um we thought that we had",
        "mitigated that in a sense and what they provided in that initial cve was if you're running both uh Global protect and Telemetry so we were easy enough to disable Telemetry that's actually why we don't have some of the other stats and numbers that we do have uh and then to ARA grin I think it was Tuesday Wednesday morning we woke up uh and the CV had been updated which they said oh if you're even just running Global protect you're hosted so uh we actually log in and you can see at the bottom there we did have people trying to exploit that cve in the Wild on our boxes here to very much of Pal's credit",
        "this was all blocked they have signatures for already we saw them nothing happened there but we did make sure and go kind of do a deep dive and see that there wasn't anything else of concern in the environment or in those devices um but this happens in the real world right like it sucked for us showing up and having to do with that and we've had some other situations that have really pushed us to that because of cves and put us into some sticky situations um but yes we we absolutely had to deal with this we want to give Pao credit for what they've done to kind of clean that up and make sure that it was taken care of uh but it's certainly something just like any other normal environment that we have to deal with as things come uh and then once a cv1 is announced right before we go in front of a whole bunch of hackers yeah there're certainly while we're on the damn plane right can you imagine our state of mind where we like look across at each other like did you get the email I got the email yeah all right great fantastic um",
        "so all right uh so DNS right there uh",
        "there were what looks like a significant increase in the amount of DNS traffic this year and the reason for that is that we basically were just forcing DNS back into umbrella um so that so we could capture that information but we had 16.5 million DNS requests um looking",
        "at the few different categories here on what those requests were for um the number one app was Debian number one for chat slack CP mining nice hash dating is Tinder and then porn is whatever that is I don't know that one I didn't search for it when we were in the knock check it later you got receipts I don't know number one in Asia so um these are some stats about just you know General usage of the Wi-Fi we saw um approximately 1500 unique Wireless clients um and then",
        "about 10 terabytes of traffic that",
        "Traverse the network over the last several days um we had sustained 500 to",
        "70 uh 750 megabits throughout the entire",
        "conference but at different points we'd see a jump like a big spike and we maxed out we had one gig of traffic here we maxed that out several times not including the time that uh dark dark matter um just testing some stuff and maxed out the connection test",
        "so we'll do it live um so yeah and then the top user somebody on the wirel less uh they transferred 700 gigs while they were here I don't know yeah y yay for that person maybe it was for that bottom category there earlier um so our you can",
        "see how like as folks are here obviously the amount of traffic that gets captured goes up and then um the amount of events per second being at about 5,000 on average I mean it's a it's a fairly decent amount of traffic when you all start hitting it I think though I mean like we're just we're just going to have to get more band with next year like that's the like hey black hat management",
        "you are on notice your attendees would like more band list right so there we go who Wants More band all get crazy like I want it encrypted versus decrypted traffic this has gotten a lot better over the years but there's still some stupid stuff we'll touch on in this case though uh we're about 80% encryption um traditionally it's been a",
        "lot higher here in this region at the Asia show um but that has kind of slipped I would say it used to be like 90% that we saw there so don't necessarily know what to attribute that to um you can see that we had TLS 1.2 and 1.3 were the highest versions didn't see anything too crazy I don't know that we saw any 1.1 thankfully um we're getting better we could keep going there though as an industry make sure that we're doing that and we'll talk about some of those other things as well and then that graph on the right is the uh again encrypted versus decrypted where we do decrypt our own registration data in between there to make sure that there's nothing uh wild happening and monitor that as well so um I when you said that like a thought just popped in my head but was like he's right so for years we saw in the Asia region specifically 90 plus% encryption and then over the last several years it's been on a steady decline like slowly coming down and now it's at 80% and um in my head when you said it I thought oh shitty apps likely that's that's touch on that too in some sense so",
        "probably uh this is uh you know again stats stats stats I can't read that from over here and I'm blind countries wow look at that there's stuff over there you can't read it either this is an exciting slide um I don't know I can read this over here and this I'm going down here can I go down here sorry people on YouTube sorry YouTubers um so all right there we go so these are it's broken up essentially by class so the way that we're doing like our subnetting is so that we can take a look at a class and say all right this is how I'm just completely you dance or something so YouTube is we're changing your handle the van so so we do it so that we can say oh if we see this type of activity we know that it's classroom XYZ or whatever but this allows us to see you know uh who's moving traffic where and who's doing the most stuff you can see the etss is at the top there that's actually the um audio visual company so and they used onethird of the band with the entire show I don't know what they're doing than you guys are crazy maybe just uploading all of this but um but yeah",
        "and then um as far as applications we always put this one up here because my favorite thing is that Ms update right there so 260 gigs worth of Microsoft updates people just show up on site and then go oh crap and then like and start updating their machines so I've been",
        "there I was I was one of those mine one's already updated then I got here and there's like a new Windows update like I'm one of them um all right so again just total traffic here allowed traffic uh we allowed pretty much 97% we talk about how it's very unique and if you've heard us before talk about needle and a needle stack is what you're searching for everything is bad uh so if you see that one kind of in the top left that's the threats that were detected uh well all of them combin and then those are actually from the classrooms our highest Source was the advanced AP response training room so checks out right highest amount of threats that we saw come across the wire generally working with Labs uh in the cloud and other things like that uh and then in the middle you've got the severity of all of those then at the bottom what's unique again we talked about we're looking for that needle in a needle stack so somebody attacking our infrastructure somebody attacking one of you or somebody attacking somebody on the internet that you're not supposed to more on that later um you would drop a whole lot of traffic in any other environment quick stuff here we'll kind of fly through we're getting quick on time already top AI this is really cool now obviously the year of AI I'm going to say it like I'm going out on a limb right it's not the year of AI but we're certainly starting to see a whole lot more of that and who's doing what uh social applications and then over here on the right this a dashboard that was built in that thousand eyes um collection and we can see quickly if you you're not going to read that but in those boxes we those are each sensor so we can see in a classroom they had this much latency as they went to download a file that might be a concern compared to this classroom that looks just fine it could be just everybody's on it at the same time uh but this at least gives us again another quick visual indication of something being wrong or everything kind of being where it should be uh and then we get into latency and some other DNS testing uh beyond that so this has been super helpful is kind of growing from here as well but it's one of those quick is something wrong if everything's red uh you probably won't see any of us in there and we're run it away uh but this this is good yeah and we we're also with that it's it's calling out to the different Cloud providers and stuff the training classes when people used to drag physical servers here all the time and set their stuff up and it took a long time and a lot of work to get trainers to believe that they could be on a stable Network and this is just another thing that lets us make sure sure that we're providing stability and",
        "you know enough bandwidth and all the other things that they need to be able to conduct the labs uh the way that you all expect them to you paid a lot to be here um and so we can see something going wrong then we'll take care of it hopefully before anybody in the room notices all right we got to fly through this we've done this a few times but this is kind of where we're coming from you're ready I'm going to do it ready we've gone go so I said I've been doing this in my 78 show I've been doing it for 23 years initially the network was so unstable here it would fall over if you breathed on it right so then I came in and I was like and then it stayed up and we were like yay and then we were like well now it's up we should try to secure it security harah so then we did you know added some additional security to things and we were like oh this is this is fantastic but oh that classroom over here keeps attacking this classroom over here why do they keep doing that oh cuz they're hackers right and so this classroom learns a new thing and gets a new tool and they start launching it at these other guys Bam Bam Bam so we're like we have to separate these kids they cannot play in the same sandbox we created a bunch of other sandboxes and we put them in and we said be nice then we were like all right well we heard that this network is really really scary so why don't we go see if that's true let's introduce threat hunting into this we brought in a bunch of hunters they're all right here and then we said look for the actual bad inside the bad cuz the traffic at black hat is super scary if it was directed at you it was directed at a lab environment or if it's a demo or it's all that kind of thing not really that big of a deal right so let's go find the bad bad and as Bart said we describe it as looking for a needle in a needle stack and all that hunting helps us do that while we're hunting we find interesting things oh look there's a file there's a thing what's that what's it do I don't know let's put it in this thing pum it was malware so we did malware sandboxing we uh we ran into an issue years ago so now everything's stable it's secure we're hunting we're doing all this stuff and the worst outage we've ever had was caused by one of our partners and we were like no because they had a CV that popped up while we were on site right so it wasn't wasn't",
        "that right so they did they had they ended up having a CV that popped up they thought they were doing the right thing they were like we're going to patch all this stuff they didn't tell us and they did it at midnight and they didn't test it so we were like well that can never happen again we need to make sure that anytime somebody's committing something it's actually the person who's supposed to be doing it let's put identity and access management in there and we did it then we're like hey what about endpoint we got to look at the registration machines boom EDR EDR EDR but just on the stuff that we control because you're not going to let us install anything on your machines and we don't blame you then we were like all right this is a lot of data the show keeps growing the first show I did had 1500 people at it in the US show and the shows now are 25,000 people so an issue of scale popped up right you know what that means we can't do it all what we need to be able to do it is a little bit of help and a little bit of automation right and with that I'm going to point at this guy right here and say come tell us what we're going to do this is Pope he's amazing he helps us out but he's actually kind of been spearheading with the partners here getting our Automation and workflow worked out here and we're going to let him speak to kind of what the work he's done with them and where we're at at this point it's been amazing oh oh three four hey everybody",
        "I'm Pope uh it's my last it's my last name it's not a super Elite hacker handle believe that he's the pope anyway talking about automation we started building all these hunters and started providing a lot of data and that turned into a workflow nightmare uh it's",
        "manageable in Europe it's manageable in uh here in Asia actually I got even a little lost here on a few times but the us we have such competent people coming doing such thing providing such value that it was just overwhelming our workflow which was slack what we had happen was uh partner would find",
        "something uh one of the hunters would find something 3 Days Later another hunter or even the same Hunter would find the same thing and we were duplicating effort and wasting a lot of time and I was trying to keep on top of it and I was losing session of the entire thing right trying to catch up too much so I need something to handle workflow so I start looking at workflow options we tested a whole bunch of even open source ones we're bumping through some and um between us and and Europe",
        "that's the next show we arrive at Europe I'm looking at still options of what we should do on the side we were doing some automation bits and trying to improve that and Pao shows up with like a xim tool Palo Alto xim they're like this does Automation and workflow and all these things and I was like well can we play with it so we start playing with it and there cortex exor is like one of the best automations I've used and I've used a lot of them um it's excellent so started using that and then looking at the workflow and it was all right we got something here how do we take this further bring me bring me a person who can help build this vision of ideas that I want my MVP is I need to do some of this workflow stuff so let's test it out so in in Europe what we did is one of the hardest things that I had a hard time to do was pinning somebody down as to which AP they were on and that's not the technology or the partner's problem it's meeing that information to that person to get them to look it up to get me that back while they're deploying APS or doing something else it would turn into this 30-minute process and uh poo",
        "xim they get to work go build a thing and we go to slackbot and we do like a slash where are you type of thing and uh they're on ap20 and it's in this classroom went from a 30 40 minute exercise to a hey I know exactly where they're at cool we got something here we got a little bit of a magic so this show we start producing how do we take this further and the next thing I wanted to do is on these threat hunts I want to know all the external tip information I can and we got a luxury of I got I think we got three tips right so we got Cisco umbrella tip we got Palo Alto and there threat Intel information and we got threat kect and we put them all together and we in slack can either just do a a command lookup or we can go and pivot out directly into xim and we know",
        "everything about that external IP who it is what they are where they're going based on lots of tips and some of these tips have lots of other content underneath it so cool that was super useful the next thing is I want context and by me context I want internal things I want to know everything I can about a person inside if they're doing something bad or wrong so tell me what all of our partners know about it what does umbrella know about it from DNS what does corite know about it from Network what does netwitness know about it what does paa know about it from the firewall and DHCP logs give me that context and those pieces are built and we have already ideas to improve them make them better and that we're going to carry that into the US and then tie this together with a bunch of availability things that are also hard which is pulling in firewall information switch information AP information and all the Thousand Eye stuff they were talking to put them all together and Mike Spicer dark matter is going to like own that and turn us into a pretty dope dashboard in the US thank dashboards",
        "oh see yeah you could see there I had um what what is happening there we go why are you clicking so much I I didn't mean to I I can't be trusted um there's question marks at the bottom right so what is next or what's the next part of the evolution and it is this so our new robot overlords so this is everything we've been hearing AI we've talked about machine learning for a long time this is actually some machine learning um so a couple of our guys here at corite uh are looking at some things that they're looking to do with machine learning in their product uh they started playing with this here and this is really cool so this one specifically is our traffic this is our backbone this is everything that we see from our environment and what you see there are just graphs of the the services uh that we're measuring there when we look at something so an example is that we're looking at the switch Management on that top left if you see all the tiny little things there and then a couple of dots those are outliers right this doesn't necessarily tell you exactly what it is but we can go to those outlier dots we can click on it and we can see why that is an outlier so if everything is normal and everything's acting the same you'll see a cluster of them up here this AP is acting this way uh and what we see is that somebody just sshed into that one right once or twice and that's an outlier compared to what we see on those other uh backbone devices so we can kind of narrow this down and have again just another quick visual hey everything's normal because those dots are all together keep going here and I'll show you some other stuff that looks super unique so this is training rooms so if we look at the training rooms and we see it based on alerts so what we were just talking about on the backbone that's all of our services we see if there's a different service in an outlier and how someone's connecting to stuff what we're looking at in the training rooms and the rest of the environment is alerts so if we had something that was alerted everybody's going to get the same alerts in the advanced AP response for the most part they're messing with malware and you'll start to see those dots cluster if you see here kind of that top right one that's pretty unique that's what we would expect to see from a training room everybody's pretty much in the middle you probably have an instructor or somebody on the top left a teacher's aid kind of in the bottom right and then the guy that was sleeping in the bottom left whatever that is right we kind of know what that we can dig into it but if you look at the graph just below that so in the middle on the right that's what we said was probably the most bored training room there is cuz nobody did the same thing you see all those dots spread all over it doesn't necessarily mean anything bad but again there's a quick visual representation and then dig in deeper if there's something w so if we can go see a training room and all of a sudden everything's locked in and then there's some dots just flying off into the corner what in the world are these people doing and we can do that so taking that time to to investigate things down getting all the Automation and the pieces and the information that we already have and making that actionable right and so it allows the hunters to spend their time focused on the things that are truly outliers rather than spending time digging into the cluster in the center right it's like this little anomaly over here let me click on that and see what that's doing um and then that can spawn a new hunt um so where if you don't know anything about the devices or any other information but you know okay well these are all acting the same and this one's a wild card then you want to go check out the wild card so it's kind of nice so that's uh that's what's next can't wait to see this continue to develop so um what do we see you know on the network I'm tired of this grandpa um we're so tired of seeing the same things show after show after show after show and what are those kinds of things well you know we see people who have split tunneling misconfigured um they believe that they're using a VPN correctly and in reality they're dumping half of their stuff out into the clear um we've had conversations with folks like that before where we go up and we say hey we see all this stuff and they say no look at this little green icon in the system tray and you're like you have this much left on your mortgage and they're like n um so so make sure that you're actually",
        "that's a fact um so make sure that you are are taking a look at and and seeing that things are configured correctly right we see ldb out to the internet why is it happening right we it's a lot of government stuff some pretty spooky ones as well like all of these things it's 2024 why can't I see your email why are are you you have this incredible password good for you it's 23 characters long but you just broadcast across the network in the clear oh my gosh every show every show so please take a look at the traffic that you're sending out not from all of your devices really and try to uh ensure that they're not just leaking sensitive",
        "information he leaking all right speaking of leaking couple quick stories couple minutes here hopefully we can give you some time to ask a couple quick questions but uh ignorance is bliss so again verifying and checking things what happened here and what we saw was we had a mobile device that in multiple instances uh there was a weather app and it was responding to the uh weather",
        "connection as far as where its latitude and longitude was in the clear we know exactly where that person is that's the top right if you look over here in the middle on the left there was uh I actually forgot what that one is oh login again from that device we're seeing something else on a mobile device that we're having a login uh in the clear to uh I forget what this was is I'm missing sorry token is in the clear whatever they were logging into and then at the bottom something was enumerating all of the apps that were on that device so again in the clear telling us every app that was on that device and enumerating it um this may not be you you may not be doing anything wrong but you installed an app or you did something else and this is all we're trying to say verify verify verify everything that you do go look at that on your home network right we're all in the industry spin up some open ndr and just check out what's going on and see if you see the same stuff because you will so so um speaking of verifying and checking things and all whatever right uh most of the folks who are in the knock most of the team that you see in there are all doing some form of threat hunting right it's critical to what we do because we can't rely on alerts if we alerted on the type of traffic that we see it would just be alert alert alert we'd never be able to do anything with it so um we're we're you know looking",
        "for the types of things that you know make us go ah that looks actually bad and one of those things is when somebody plugs in their laptop to the network and it immediately starts calling out to command and control servers right and that's what happened in this case so uh this individual plugged into the network started just there just man it was bad there was a lot of stuff kicking off and um I think the slack message was I don't know if this is a text box but it screwed six ways to Sunday so right and I quote so so this is really bad right and we're like oh this is terrible uh well let's see if we can figure out what's going on here and based on other traffic that this individual was sending we were able to figure out who they were and it turns out that they were currently on stage delivering a talk at black hat um so none of us are you know safe from the",
        "occasional oopsy um it turned out that it was in fact a black hat speaker who came onto and joined the network and their device was was very very owned and they were like but I have this EDR solution and we were like yeah it doesn't care yeah it doesn't care here um so yeah just even if you have things on there please look at your traffic please look at the types of things that you're sending from your devices um and then finally age2",
        "oh this was something um so our our last one here what happened was uh one of the",
        "hunters from corite was like hey I just saw somebody log into something that they probably shouldn't log into it's again we're looking for outliers they see them log into to what turns out to be I'll just say um critical infrastructure in the United States um so we're like well that's that's not normal um we should probably look into that so we start an investigation we start pulling together all the information that we can again due to the nature of the way that we're monitoring the network and the things that we're doing we were able to pull together enough information that I could go to registration and say I need the contact information first this person at that point we contacted said person and we're like hey will you swing by the knock and then what happen and then they we approached them about what we saw and they admitted that they did it said yeah I logged into a water control plant and we said well that's probably bad uh and kind of the moral of the story is we will find it and if you do something illegal it's still illegal even though you're on the black hat Network we see it all the time but please please please understand that we are watching we will see it and if it's illegal it's still illegal here yeah in this particular case the individual was super apologetic they were like oh again people learn something new they find a new tool they have a new tool they want to show something off to their friends all their friends are here at black hat so they're like check this out and then they break International laws",
        "together together right so uh super",
        "apologetic and we're like yeah I mean we get it but just in the future if you're going to demo something point it at like a server you've set up for that not you know the critical infrastructure of another country and that is what we have for you thanks",
        "[Applause]"
    ],
    "47lDlfsji8Y": [
        "let's start it's a great honor to be here and sharing this's talk with you so SE of talk today is about the flows and availabilities in system UI and Sy server how to using box and the availabilities to bypass the instructions to achieving hijack tax on High version Android platform so simply introduce myself my name is wi I'm a security research lab and focus on mobile and ASP security researching is our group leader helps a lot while I'm doing this research so agenda agenda contains four different part the first part I will introduce what is activity hijack Tech also called ha and how ha work on on Old",
        "verion Android platform and next I will introduce the security policies and restruction released by Google thiss and how these policies make H not work then next part I will bypass this rest structions by funding some new tech surface and the a abilities and in the end I will combine all the bypass technique qu to weaponize for TR and then we will have a video demo for l so about the a it is old and traditional aack scheme and many well mware such at the We R someware Bank both R likely to abing this technically to injecting a Evo content to trusted application then L can perform hijack to stealing sensitive user date or dangerous runtime permission it is let is what ha can do and uh the hijack happens you usually don't know their under attack we take a real world I will take Android 4 as a simple and you can see code snip in the screen it is belong to a real world mware R real one L where s blocker and you can see the S blocker creates a schedule and uh the schedule check the top is activity per second if the top activity is not the r itself it will start activity with special flag the the new test flag to C foreground after C foreground the mware can push the previous application text into the background Test Now mayware can for identity of just the application it's kind of like uh Str hog uh Str hog attack scheme but uh why may Weare have to C for one to perform H Tech before we talk about this we need to know something about the Tex and the back stack and uh from from described in the uh developer document the tast t is a collection of activities and use in the system usually separate the text into two type is forground Tex and background Tex and us us in most case can only interact with only one forr TK such as you are using uh application one and at the least time you can interact the topest activity of the application",
        "one for GR TK but at the same time you cannot you are unable to interact other with other application in the background so let that is why for let is while may we have to se for one to injecting to injecting a Evo content to screen of standard related know can",
        "simulating a hijack Tech we simul",
        "simulate L is user device and the user has a installed the payment application ebank in his device and the mware in background is keep keep leing the runtime state or of all proxies at this time ebank user click ebank the system should blow the ebank to users face and also at the same time the mail in background detect the ebank comes to foreground then injecting a fake ebank login page and the Caesar for Grant and it is a low cost High return attack scheme and uh in all the Android devices it affects almost all application",
        "so we can conclude three three key factor of of ha theability start activity from background detecting runtime state from background and the run in background persistently loose the one of these these factors uh we cannot achieve in precise hyra Tech of course Google will not just not let let this Tech happen so this yes Google released a serious of uh security policies and the destructions",
        "the first restruction is about the runtime State leaking before API 22 mware can leak the runtime state of our our application directly by calling s special interface and you can see po code in the screen and it it get all running test and all running Proxes directly and without any permission but after ap22",
        "the this this special interface can only return call State",
        "but before API 26 there is still have",
        "may still have chance to bypass this restruction in a psyo way Proxes can access the pro folder of other Proxes in uh directly and and request no py so",
        "mware can detecting the targets where the targets come to foreground by access its o adj",
        "score in 2017 Google updated the S Linux Pary the policy add to new line code the new line code retracted the application to access file in non app domain it's kind of like a high P2 protection so M where from now cannot access the OM adj score from of other",
        "proes but let's Okay we still have a compromise scheme we take a real world mware mystery board as example it turn to use usage State manager to L long time State indirectly but the Leist components request dangerous runtime permission and request complex user interaction such as a guide user into the setting app and uh gu them to switch on switch on options manually and in some third party loan uh the phone even well put out a full screen to one user when granting such a",
        "permission the second restruction is about the B after AI 29 application with",
        "privileg can start activity from background and the no BL means we our mware cannot inject in the screen from background and the maware have to detect in the runtime state from background so due to this restruction many mware and hyare",
        "disappeared so the compromise is turn to use accessibility services or other system services or we can use the system aler window permission to Overlay screen but all these request the complex user interaction and the danger Dangerous longtime permission and the second scheme is we try to satisfy the BL restriction exceptions in the developer document but all these restrictions such as request request bond by system or request hold system privy is almost almost impossible to meet the third restruction is about the the background execution limits and LM KD after API 26 background Services",
        "cannot run in background precisly and it will get the high out of memory ATZ score and this high score means low priority and the this will this services will be considered as a background proxies by system and the idle proxies will be killed by LM KD first to release memory and after API 24 system broadcast",
        "trick also get burned uh this means mware cannot pull themsel up by listen listening to the brast streck the compromise scheme is provided by Google The Google uh addressed the developer to start the forr services for for get a low low low adj score but the",
        "start but start supp Grand Services need to continuously notify user and it cannot even cannot run in background uh silently",
        "assuming we all use compromise scheme which means mware have to Grant dangerous onetime permission and the request compl user interaction it even cannot run in background silently then it means that Tech well be detected by user even we start foreground in we we take a xiaomi OSX and example when user clear Recon test from background shami will directly call first stop to all Proxes which means our forground services even will get",
        "killed so in this talk what we need to do is bypass all the restruction achieving undetectable and and no permission required hyra",
        "Tech so the first High we have to face is about the BL restruction this is most important part of the flow",
        "chain when MW start activity from its ABD domain the request will be handled by activity manager Services then the system well goes to the execute request the function and you can see Cod snip in the in the screen the function CA should B the background activity start then Returns the result to retracted the BG activity",
        "member next system will try to start targets component and in set initial State function the code will decide whether make the application count to forr by by check the restricted BG activity and you can see if the a a move to front member is set to true and in the side activity in the function the move to front function will will never be caught so we still need to focus on the check function and find ways to bypass it and the developer document gives some exceptions for the check function such as uh if application has a visible window it can start activity from background the simplest example example is to make application kind to forr and this T will be considered as visible for by System but we do not consider list we back to the check function and the check function called has active visible window function and reason return a result to to the system if the result is true the check function well return forse for telling system do not prevent Le application come to",
        "foreground then next the The function well call has active visible window inside the code you can see the code get the call uid and try to access its window type if it window type is bigger than the first uh system window value it this window will be considered as visible by system and the window type is related with it Z index we take uh add window function as a example before system call add window it will check the base ler between new window and the existing window if the Bas Li you can see the base lier member is higher and uh its Z index will be higher and uh you can see the base ler is related with the get window liveon type so now we can know the window type is bigger the Z index will be also bigger solar check function request us to get the system window and the system window and our nonp application unble to",
        "to get a system window and usually it get a base application type type window it is a low z index and invisible in most time if we want to get the system window have to we have to request system aot window permission it is request complex user",
        "interaction so the picture in picture feature is uh belong to Android system and uh also called pipe mode it is a compromise scheme Google provided for developers any application without the S permission can start the and can get a system for window uh at any time and the pin is active D to a small pipe window at top of screen and the pipe window is handled by system UI and of course its window type is bigger than than first window first system window value and the request no permission of course is it is a good good attack",
        "service with take video app as a example you can see app app comes to background goes to background but it it it goes to pipe pipe model and the pin is activity in a small pipe window so the system we considered is is in visible State because it's because it's window type is system and uh it's in pin in pin",
        "model but we still cannnot uh abuse pip",
        "directly because pipe window can hide from screen and even we use the transparent theme in the pin activity the system UI will make the pipe window uh visible for user and the user can remove the pipe window at any time so pipe is a highly detectable feature but the pipe will still have a history Buck uh we can set abnormal Heat and the was in activity then the system while input abnormal one pxel one pxel",
        "object to pipe window then there you can see the screen there is a very small dot that is abnormal pipe only for one p one",
        "pxel but uh it is it is invisible and Untouchable for user but the interesting is it is visible for system so patch is quite simple you can see the pipe Bon algorithm component uh it has some checks to check whether the count uh pass in value is ABN AB abnormal if it is abnormal it will only Returns the a fixed",
        "value so it is a nice bu to expanding attack surface now we not need to bypass window visible check because we can find a way to abuse pipe such as create a legal legal system window but this window are user",
        "undetectable before before we finding where this in pipe we need to know how pipe work and the app call call interpipe mode and the system ATMs well handle list then the system where goes to move activity to pin Lo TK function and in this function you can see the code call set set Window mode and the pin and the set the test in pin model mode and the L call set text appear and inside the code it will it will IPC it will IPC with the uh system UI site and the system UI site on takes appear callback function will be tricked and inside this code the code the system will init some pipe Rams such as a setup uh uh animation transition and uh set up window sites anyway pipe will be officially rended",
        "here so so we can now complete the pipe Trend pipe startup Trend here and uh we can get the simple sequence diagram if we want to take pipe we need to attack the weakest part in this train so our first scheme is try to prevent IPC uh you can know uh we said before the ATMs well set the pin mod mode and uh after after set the pin mode the system well considered is as a visible then if we block IPC here the system UI will not render the pipe pipe window maybe we can get a uh uh undetectable but still impin",
        "State",
        "task but unfortunately in user space we almost have no way to affect the code execution in system server so the second scheme is try to teack the UI system UI side like creating a abnormal window type the set Source reactor H is a interesting interface it can Auto scale and the croper activity window to uh to to define the sze to by the by pass in Lector object so if we input a abnormal reor object where we get a abnormal pipe",
        "window here we write a L poke and poke run in Android setting and of course it get a one pxel re uh it get one pxel window by pass in one pxel object but after half seconds it come back to the normal s so what happen inside the half half seconds and any ways to expanding the direction so we need to trace left object and inside the Onex appear callback function and uh we can know the left object pass to the schedule animate resite pipe and inside the code the the",
        "code set up a transition and the set the duration this duration is a fixed value defined by System it's uh 42 uh 25 and",
        "after some debuging we can know this transition will resize the pipe pipe window into the uh into the left object",
        "defined s so what happen if after the",
        "resides then this transition object will set up a call back hander this call back hander uh r on pipe animation animated",
        "the animation and the interface then it will be called after the pipe animated played over within the code it will call the Finish sites finish sites will create the window container transation object also called wct it will be passed to the prepare finish reside recite transition with a normal size direct object defined by system and then it will set the surface control transition and the and the system defined direct to wct",
        "L system will carry wct to I IPC with system before IPC the system UI side",
        "will extra SCT from the W C then car relas s to IPC then system side well",
        "goes to set m window side TR transition in this transition the system will directly call merge upate to rendering the SD on the screen this upate will cause pipe window resid to normal sites",
        "and uh now our Target is try to prevent the",
        "merge the first uh we want to the first thing we is we want to try to prevent IPC but uh not work so we compare the many branch of this of this uh uh of this function and we found the API 32 has a code change and uh from its comit detail we can know it is a functional patch instead of scly patch so it is still avilable to analyze AP 32 and 32",
        "do not call merge",
        "operate and instead call merge is set the SCT to a goal member and the this goo member will and we follow the goo member in we can find the set surface boundaries locked function will get the S so we hook this function f what what happens in this C",
        "we found the familiar function prepare surface of uh it this this function is brought to activity record components this components is related with activity lunch and the rendering so it this means we can con uh indirectly control this call trend from in the user",
        "space now we know API 32 and the 33 where finally goes to the setman window side trans trans uh function and uh we know the 33 the this function will call merge and uh we almost have no way to prevent the pipe reside to normal because the trend is handled by system UI but in 32 the this function will set set the S to goal member then in inside the activity R draw operate list operator will start up a train and access list s and then the code will call merge so if we re Frozen withraw operate well maybe maybe the merge operator will not be kill not will not be caught so we get our first cve uh you can see there is very very small dot in the screen it is US undetectable and invis invisible uh this pipe can keep staying in the in the screen in the in the phone and because we F the F the UI thir SP this is still a API 32 bypass we want a bypass after API",
        "33 so we look into the API list we found the new Tex surface left function make lunch into pipe this function well returns activity options object this",
        "object you can see it as additional options for activity",
        "lunch then inside the code the the function will will save the receive the pipe to package the bundle object by a spey a spefic key the key man is launch into pipe RS then the package bundle can be used to set options for activity start we trace the bundle object inside",
        "the activity L TR and you can see the bundle will finally be passed to a function start activity iner and about this function we have analyzed it before it will call move to font if Will application pass the blo restruction by uh restruction trick so what will the bundle object do inside the co inside the",
        "code so inside the code uh you can see the code call uh call is launched into pipe to check the bundle if the bundle is takes the spefic key and after the trick you can see code directly move activity to pin L Tas without any other check and no ba err restriction check so which means our mware can start",
        "the activity from background at any time",
        "or to and start activity into P mode so we get our new cve for after APS",
        "33 so the second highight we have to face is about the B uh is about the state breaking State uh uh after after bypass the B we have to",
        "we have to do this this is The Bu I made when I'm doing developing you can see the you can see the SLO exception in the screen the exception happens when I merge the code after merge the code the system tells me I try to start start services from background but before I merge code I I use the Box position I use bind Services after merge I use start Services after checking the developing document we can know B Services is not under limit of the background execution",
        "limitation so let's why app crashed and we can know background exclusion limitation where through exception when app try to start background services in this case we can abuse this limitation to be a background boxes Detector by Target exported Services",
        "component so you can see I write the PO Code to start the targets from background and uh if the if the target is in background the system the system side will return abnormal component name",
        "this abnormal man this abnormal components will cause the user user space through the exception which means I can catch this exception in user space so so I can detecting targets uh come to",
        "foreground by a CYO way and the least issue is still waiting for cve and due to time reason all Trick please see my we",
        "paper next we will app LM KD achieving Pressly Proxes in",
        "background uh before we talk about mkd we can we need to know something about the out of memory adj score you can see we if we get the higher score means our proxies will have a lower priority and you can see the screen our our show keep",
        "checking the uh background keep keep checking a background Proxes and the this background Proxes its priority is lower and lower and in the end it get killed by LM KD but we can start the foreground services but in the least foreground Services usually get the 200 score is a high priority but uh we said",
        "before it it is no way to run in background",
        "Silly by analyzing the code of of calculating the priority in system we know we can know if the proxy Services is bond by third party and the the party priority is higher L self code will check whether the client priority is higher L visible visible application adj",
        "well if true the app can get a visible app",
        "priority so is there any way to be bonded by system system Proxes before we know this we need to know something about the managers there is several managers in framework such as activity managers window managers and the package manager and the non priority application can can operate operate managers by correspond I object and the managers usually run as a system user can so can we abuse",
        "managers we take uh accessibility Services as an example that",
        "accessibility uh Fe feature is handled by accessibility manager services and uh",
        "nonp parage application needs to declare declare spefic inter inter fil before",
        "use this feature and the this filer is pointing to a specific application Services",
        "component accessibility manager services",
        "will first find all application want to access the this feature by the intern filter then it will create create a connection objects inside the code and the this object Targets this application then code well call B locked function to B into to the",
        "app one poke now we get the high prority Proxes because it's baned by uh system",
        "system Proxes but uh this feat this",
        "accessibility uh feature is request dangerous runtime permission so we do not use this to achieving prly proxies we find another manager called account manager this is uh API added from API 5 it's uh 2009 and this is a manager used to M this is a manager used to ma device account by uh at at the same same time to use these components nonp application also need to declare spefic in filter",
        "the key point is to use these components we do not need to request dangerous runtime",
        "permission so we have a chance to call addcon interface by this manager the system will create the system objects Targets this call application then system will call the bind function of the system object it",
        "will make the system bind to our PO",
        "Code and uh our poke will get the high PRI priority and the user",
        "undetectable and there some more tricks can make account manager keep binding to nonp application",
        "uh let the the proxies I'm kill about due to the time reason we do not talk about list and the list trick can be found in my white",
        "paper and this is a code uh video demo for persistently",
        "poke first we we uh we start uh we check the Android version It's API",
        "34 we start poke poke start running and uh we make this application comes to",
        "background we try to check it out of M adj",
        "score it's high",
        "priority we try to for stop it for stop relas application but uh you can see the Pok is still running it can be killed by any operate even we call for",
        "stop we still check it's out of memory",
        "adj high",
        "priority then we try to kill it in ADB",
        "shell before stop it",
        "still",
        "running so next is the forain of hijack",
        "exploit check Android version is",
        "14 we need to hijack all these three application",
        "we first first run this application to make sure this app run",
        "normally then we start",
        "poke we click hijack all it start detecting the runtime",
        "state after we click it we get the",
        "hijacked you YouTuber also get",
        "hijacked te telegram is also get hijacked",
        "so this is the end thank you"
    ],
    "unjaZGT14cs": [
        "thank you for joining my presentation my name is Guan Kim and today I'll be discussing the analysis of operation poison effort a cyber crime in Korea involving credit card information theft and fraudulent payment over the past two",
        "years first let me introduce ourselves",
        "I'm a senior researcher at the Korea Financial Security Institute focusing on instant response in financial companies digal for6 and cyber threat intelligence for the past 10 years my cooworker",
        "honotu is a principal researcher who co-authored the paper with me he has been conducting digital prics penetration test and analyzing security instance for over 10 years unfortunately",
        "he was unable to attend today's conference because he is currently studying in the USA",
        "so here is the agenda for today's presentation first in the introduction I'll explain how we started our analysis and why this operation was special in Korea and then provide a complete",
        "analysis next I'll describe the attribution process of the threat actor finally I'll conclude with my",
        "findings let's begin with an introduction",
        "in September 2022 we discovered a fishing payment page at an online store it was inserted into the normal checkout process aiming to steal users credit card and personal information in the Korean financial sector this type of fishing page was new to me so initially this case was considered an isolated",
        "instant after analyzing the pages functionality we contacted the site to remove it however two months later the same",
        "page was found at another online",
        "stores we realized it wasn't just an isolated incident anymore but a wider",
        "issue so we analyzed the commonalities between the two compromised websites at first we suspected the magic card group and famous for card schaming attacks using JavaScript",
        "injection however we found that the S side course was redirecting users to the fishing page upon checkout indicating a different technique from Mage cart also the online",
        "store building platform was widely used in",
        "Korea based on this we developed a PC code to detect the fishing payment Pages we collected and analyzed over 5 ,000 e-commerce platform domains using the URI features of compromised",
        "websites as a result with disc covered over 50 additional online stores hosting the same fishing page indicating a significant scale of attack and prompting us to begin a detail",
        "analysis we then uncover the following attack procedures the ultimate objective of this operation was financial gain to achieve this the thre actor analyzed Cora's online color payment system in",
        "advance afterwards they hacked online stores and inserted a fishing phas to steal users information they then monetized using the stolen information to commit fragant payments through ingenious",
        "schemes one of their schemes involved roaring people on secondhand trading platforms using Apple products similar to the which in the story Snow White and the Seven dropes raring the princess with a poison apple taking inspiration from this we",
        "named this operation poisoned",
        "Apple furthermore we identified the new threat actor who carry out various attacks targeting Asian countries including this operation we named them e",
        "Queen and track their",
        "activities before diving into the detail analysis let me explain why this operation is notable first Korea's online card",
        "payment system is secure compared to other countries while in other countries online transactions only require physical card details like card number",
        "exploration date and CBC Korea requires additional authentication procedures authentication",
        "here involves various information such as card pin additional passwords provided by Ces mobile and even resident",
        "ID numbers the sh actor manage to gather all this information bya fishing payment paging demonstrating a deep understanding of Korea's online payment",
        "and perfectly targeting the country moreover While most teers",
        "typically monetize stolen card information by selling it on the dark web this right actor went a step further instead of only stealing credit cards they engag in scams and frent payments themselves resulting in higher",
        "profits than just selling card",
        "DS as a result we were able able to track every step of the operation now let's dive into operation poison",
        "deer first let's see the resources developed by the thre actor we discovered their web server which was utilized for storing tools scripts and as a gateway to collect stolen information they use cloud Flare's CDN service to hide the re sub IP address but they but they made a mistake by installing a web share on their own server which exposed the real server IP address they set up a web server on the hosting service vure and creating a fishing domain resembling a real domain of a payment Gateway company their server contained various tools such as the thir car exploit and database management tools like PHP my admin and AD Miner furthermore it was later revealed that they also use stolen cards to make payments for registering their",
        "domains to gain initial access to online stores the thre actor Ed various",
        "methods they executed SQL injection using a map acquiring admin",
        "credentials they also created a web share using platform vulnerabilities that allowed them to create or un notif files without",
        "authentication additionally they hacked into the website administrator",
        "panel subsequent they unload kits in",
        "compressed files containing all necessary Fe fishing related",
        "components both the web share and reverse share of roaded to the thre actor server were also installed on the compromised web server the web share based on Chinese had basic functions such as viewing and unloading files sending commands and lever connections through this the thre actor persistently access the victim system and executed commands",
        "next let's explain how a fishing payment page works the compromised online stores were all based on PHP web server after manipulating the payment Pages the thre actor collected information through multiple malicious PHP",
        "files first the thre actor replace the payment Gateway domain with their own domain on the sub side rear payment ping so the user was redirected to their",
        "domain at uncompromised website clicking",
        "check out to users directly to the payment gateways page however at",
        "compromised sites the user was redirected to the fishing page after entering their details there which are then sent to the threat actor server the user was directed to the real payment page to complete the",
        "transaction for furthermore they obtained the users personal information including IDs and passwords by coling",
        "data in the stored database they captured the users IP addresses browser details and Lial information utilizing PHP environment",
        "variables finally all collected information is transmitted to the thre actor server and stored in their Database The Stolen information was a total of 14 items as listed in the",
        "table in addition the St actor employed various evasion technique to prevent store admin or users from detecting the fishing pce first they created the fishing Pages",
        "F name masquerading as a real payment measure and then unloaded it to the same PA as a real",
        "one secondly it was exposed only on week",
        "night and weekends and it s appeared during the first users access upon the users return visit the rear payment page was displayed by checking the website cookie as a result the fishing payment page managed to remain active for a long",
        "time the fishing page UI has evolved over time initially they didn't copy particular companies gradually they began began creating fishing Pages identical to those of major card and payment Gateway companies so users were unable to notice the fishing without carefully checking the website",
        "address all right let's talk about their monetization tactique it was the most interesting aspect of our investigation their approach was nothing sure of ingenious",
        "they use the stolen credit cards for making fraudulent payment across three different platform across each employing unique methodes a secondhand trading platform an Open Marketplace and the app online Apple Store let me explain each",
        "case here's the first case many Korean secondhand trading platforms provide card payment services",
        "so the thre actor made a fraudulent pay payment for an item listed on such a platform then promptly contacted the seller with excuses such as I intended to give this as a gift but my friend already has one during this conversation",
        "they asked for a refund saying as an AP policy for canceling the purchase keep the $20 and rep me",
        "$180 from the sellers perspective it's like getting free money without any actual sales this lead them to deposit the money into the thre actors's account ultimately resulting in the card holders",
        "loss moving on to the second case the thre actor posted the sale on secondhand trading platforms offering brand new electronics at discounted prices interested buyers contacted them",
        "through the platform chat and transferred cash to their accounts the softon process was very",
        "clever the thre actor initiated plant payment for the S item using a stolen credit card on an online Marketplace at that time they enter the buyer's address and the shipping address to ensure Direct Delivery to the buyer that's clever but what I'm going to describe next is even more noble let's dive into the thir case here",
        "the thir actorship their focus to selling Apple's products and the fraudulant payment occurred on the online Apple Store during the time I Lally wanted to the catch the thre actor so I spent nights searching for a rest of Apple watches iPhones and iPad on secondhand trading platforms eventually",
        "I found the actual thre actor sale and chared with them the screenshot shows a real conversation I asked light away if it was available the next day they responded that it was available and asked for my location I said I'm in sorrow then they sent then they sent me messages explaining their scheme their evoled scheme is as follows",
        "at Apper online stores you can purchase items using credit card and arrange for someone else to pick them up they roared people into buying Apple products in order to exploit this when a buyer shows interest they suggest that the buyer transfer the cash for the item and then pick up the new product at a nearby Apple Store if the buyer agrees they made fraudulent payments for that item on the online Apple Store with a stolen card entering the buyer's information in the risan details faed in fact this game caused the most",
        "Financial damage in a short period of time",
        "next I will discuss how we attributed the thre actor EV Queen and their",
        "activities we found that they made an operational security Mistake by embedding their email address directly into the source code or fishing payment Pages they consistently used a unique nickname from the email address leading to exposure of multiple infrastructures this allowed us to uncover critical information about their identity and",
        "tactics based on this we found multiple EV Queen Associated domains using various ENT tools especially we found a",
        "web share named test.php on the Contra server of poisoned Apper this web share provides access to the server's entire file list including sensitive database measurement Pages like MySQL thephp",
        "furthermore one of the domains served as a commment and Contra subber for farming mware cing significant financial damage in Korea in the past this domain was registered through a Chinese ISP suggesting ties to China as the maral resources were in",
        "Chinese as we delve into uncovering a queen Trail we stumbled upon credential stumps containing their email addresses",
        "and passwords it appears their device was vulnerable leading to dat LS we identified four additional email",
        "address and their Associated domains expanding our understanding of their",
        "activities also between 2009 and 2016",
        "they attempt hacking Korean websit through webshare of nose and I frame injection attacks some of these compromised sites are still accessible in Google's",
        "archives next our company's Financial",
        "Security Institute has established its own intelligence through financial sector security monitoring and",
        "investigation by correlating our intelligence with indicators in link to evil Ken we uncovered more attack",
        "activities this is entire attack",
        "timeline we first identified their activity in 2023 but it became evident",
        "that they had been conducting attacks from 2009 among their various attacks operation poison effer stands out having the most significant impact lasting a long time and generating substantial",
        "profits during operation poison deer",
        "they also continue other financially motivated attacks and observation",
        "indicate ongoing malicious",
        "activities they have continued to utilize the infrastructure established for operation poison Apper and there are indications that they are building new infrastructure to runch new attacks let's describe the details of their recent",
        "attacks after checking a list of domains linked to Evil Queen's email address they recently created a fishing website site using the metamask theme metamask is a popular cryptocur oress service and it appears that the thre actor intended to steal World related credentials as a fishing domains fature top level domains associated with Taiwan and China suggesting a focus on targeting users in these",
        "regions in May 2023 a domain previously",
        "used in operation poison de was repurposed impersonate a famous Dyre shop in Korea it was developed using the amaz UI platform popular in China and this fishing site displayed content in Korean for product prices were listed in Japanese currency indicating a new approach in July 2023 we discovered a",
        "fishing site mimicking a famous Korean AR red offering various high value electronics at discounted prices the checkout process on this site included a page designed to steal users credit card and personal information resembling the tactics employed in operation poison",
        "NE notably rather than compromising real",
        "online stores they built entirely new fishing sites this PN persist with the creation of multiple fishing sites using different",
        "domains one of their recent activities involves Distributing malicious apps",
        "through smiing a method that has orig in Korea since last December this attack involves sending messages announcing someone's death and",
        "leading them to click on a link which then installs a malicious app we discovered multiple malicious app",
        "on virus T all signed with e code signing certificate capable over stealing and controlling crucial Pond",
        "data in addition we found a post on a Chinese dark W from that was written using their nickname and the St actor wrote some parts of the fishing pages and simplified",
        "Chinese and domain registration details",
        "from 2015 contain the Chinese name and phone number suspected to be linked to the threat actor beginning in 2022 they began",
        "hiding thisinformation using a privacy Protection Service however we still found another Chinese name and phone number in their email profile with these indicators we infer",
        "that the thre actor has strong ties to China in summary Iber quen a new threat actor has been conducting cyber attacks targeting Asian countries since at least",
        "2009 they primarily focus on stealing financial information for monetary",
        "profits their main ttps include fishing",
        "fraudulent payments and the distribution of marous apps utilizing tools such as",
        "web share PHP based fishing pages and",
        "exploiters like",
        "Doro I'll give you an interesting instance related to",
        "this recently in Korea a criminal used stolen physical credit card to make around $10,000 Frant payments at an offline Apple Store and",
        "fled despite police requests Apple",
        "declined to provide a security camera fridge citing internal",
        "policy while it's unclear if this instant is linked to evil queen it's evident that due to the high demand for Apple products criminals often exploit",
        "them to cash out interestingly some of 's policies",
        "seem to unintentionally facilitate these",
        "activities therefore we need to pay attention to the relevant",
        "threat the wait is over here's the",
        "conclusion let's summarize this operation and La up the thre actor evil queen okay rated cyber attacks targeting online stores in Korean and Japan resulting in the compromise over 50 online stores exposing 8,000 credit cards and 5 million personal records the revenue from this Frant activities amounted to around",
        "$400,000 our company compiled all",
        "relevant analysis into cyber threat intelligence white paper today I",
        "released online at the same time as this",
        "presentation those interested can download the white paper using this QR",
        "code finally as I analyze this operation",
        "the butterfly effect came to mind from two",
        "perspectives first three through",
        "analysis starting from small Clues we ultimately discover fishing Pages spreading widely online and identified",
        "various attack activities we were able to prevent a potentially larger scale attack that could have caused an even greater Butterfly",
        "Effect secondly attackers are developing",
        "new Noble schemes for financial gain such as exploiting ERS policies for scams and monetization this operation is just one example implying that we may have only seen the flut of a tiny butterly to respond to upcoming greater threats it is very important to continually explore and share new skills and",
        "tactics lastly the collaboration among stakeholders such as the Financial Security Institute card companies and",
        "the National Police agenc played a crucial role in minimizing the impact of the attack we promptly share the card information and fraudulant schemes with the card companies they reissued all affected cards and reinforced fraud detection system monitoring to prevent further attacks furthermore we provided our",
        "information regarding the threat actors to the force to assist in their",
        "investigation so I'd like to emphasize that this collaborative response is essential for enhancing resilience in the face of",
        "instant that concludes my",
        "presentation as time is long short if you have any questions please feel free to approach me below the stage thank you"
    ],
    "ZgQ0CVw0fcE": [
        "hi everyone and welcome to my talk magic",
        "dot today we'll see a hackers magic show",
        "and we'll together see how much magic dots and spaces create but in this magic show you'll also learn the",
        "tricks so my name is Ora ear I'm the security research team lead at safebridge I have more than six years of experience in cyber security and in my past I researched Linux embedded some Android and in for",
        "the last three years my main focus lies in Windows research but let's see what we're going to talk about today so we're going to start with an introduction about an unfixed known issue in Windows that exists for years which is also the base for this entire research we'll then move on to specifying the research goals that I find when I started a research then move on to um to see the",
        "post exploitation techniques and vulnerabilities that I discovered based on this known issue and finally summarize with cves fixes takeaways and provide a link to the gup repository so backwards compatibility in",
        "Windows is a key element we all know that as the world's most popular desktop OS Windows is trying to evolve while while maintaining its already invested customer base by not breaking any third party software or features that they already use as a result there must be some known issues left unfixed and this is exactly why what I encountered while I worked on a different research project using",
        "ntapi uh you can see the gift too much okay using n API which we'll later discuss I created two files with the same name but one had a trailing dot then I deleted the one with the trailing Dot and as a result the one without the trailing dot was deleted instead it looked like pure magic so I decided to learn the magic primitive and create my new hacker magic",
        "show looking at Microsoft's documentation I saw something that I had no idea about Microsoft explicitly asked",
        "users to not end a file name or a directory name with a space or a dot but as hackers what do we do when someone tells us not to do something of course we do it but we before we dive into um",
        "how we can utilize this known issue we must first understand exactly how it works so win32 API calls that you'll",
        "normally use in user space usually do not do the actual operations themselves and instead call and underlying anti functions as you may know now another fact is that the um the wi 32 API calls",
        "that receive uh path arguments we usually provide them with uh paths formatted as",
        "do paths this is the normal type of path that you usually use however anti functions do not work with those paths and instead they work with a type of a path called anti paath",
        "therefore the win32 API calls must perform a conversion from dose paths to anti paaths when they called anti",
        "functions as far as my check goes um the conversion is performed by a a family of function that all go through one function called RTP does path name to relative empty paath name and apparently",
        "this function removes trailing dots and trailing spaces in the following format so basically any trailing Dot from any path element in the converted",
        "in the resulted anti path is removed and Trading Spaces are removed only from the last path element and here you can see some examples so if we'll take a look at the top four we can see that all those paths have um Trading Spaces and dots uh in their last path argument in the last path element ments and they are all removed after the conversion if we look at the bottom two we can see that in the second path element we have once a DOT and once a space the dot is removed but the space is not since it's not the last path AR the last path element sorry if you want to deeper dive into types into types of paths in Windows and exactly how they're converted to anti paaths then after I discovered this issue I saw a very informative blog post by James Forshaw about um this information so I really recommend um diving into",
        "it but after I understood exactly how this known issue Works uh it immediately hit me that such a magic primitive would be perfect for some rootkit magic the Assumption was that if I use",
        "such Pro problematic paths that are converted to other paths then I will",
        "maybe be able to manipulate what users see so we all know that the primary um target of a root kit is usually conce to conceal malicious elements but in order to understand how this rootkit would be different from normal rootkits that we know let's briefly go over them so a",
        "kernel space root kit would one would run in the kernel and hook kernel space API and manipulate information returned",
        "to users to conceal malicious information in order to run a k root kit one would need administrator privileges and to handle obstacles and mitigations such as the driver signature re enforcement feature driver blocklist HCI",
        "and more and for this reason we barely see carer rootkits in the wild um these",
        "days um a user space root kit runs in user space of course and it injects itself into two processes um and then hooks API calls in them again in order to manipulate information retrieved by the caller in order to run a user space rootkit one would need again administrator privileges because a rootkit would want to hide itself from all users on the system meaning it would need to inject itself into into processes that run with administrator privileges thus administrator privileges are required",
        "but then a a question Rises doesn't it make sense that an attacker has managed to breach an end point which is just fully patched and the attacker does not have a zero day privilege escalation varability doesn't it make sense that an attacker has managed to breach an endpoint and maybe does not even need administrator privileges to perform its",
        "goals of course this can happen and with that being being said I could not find any rootkit like abilities that are able to be performed by an unprivileged user in order to hide from all users on the system including admins what I realized was that there could be a way to manipulate information retrieved by a caller without being a part of the chain of calls like any other root kit does and without needing any privileges for that because all we need to do is to name files and directories however we need to name them to name them so because we have the issue in the converting function we can affect it to be kind of our hook in the chain of calls that retrieve information and so the first research goal of my uh research was updated to not require any um sort of administrator",
        "privileges um to so they will be able to be performed by unprivileged users as well now the second research goal is much more obvious already and that is to prove that such unfixed known issues that are left in Windows for years are security risks and the most simple way to prove that would be to find Runner abilities based on this known issue so without further Ado let's um",
        "let's see magic tricks to conceal files and directories so the first and most obvious thing we can do using this known issue is to just name a file using anti paath of course so the conversion will not occur so just name them with dots and spaces or add um dots or spaces to the end of an existing file name and as a result no file operations including read write delete delete and so on could be taken against this file but we can",
        "take this even further we can create what I call an impersonated file or directory if for example um we will name a file benign dot so it has a trailing dot in the end of its name and we'll uh we'll create this file in in a directory where a another file called just B9 is",
        "present then what will happen um is that any file operation will be that will be taken against benign dot will actually be taken against the benign file that was already there because the trailing dot will be removed and then the path will reference the um the original file so if a user reads B9 dot it will be presented with the contents of B9 without a DOT and that is true for listing directory as well deleting files and so on another feature another backwards compatibility feature that we can leverage um to uh hide files is called short names AKA 8.3 file names basically",
        "these names are very old type of names present since very old versions of Dos and windows um and they're not of course the default names nowadays but we can still use them and reference them with paths",
        "so let's see how we can use them let's say that we have a file called a.txt in some directory and then",
        "we want to create our own malicious file",
        "that we that will be hidden in some way",
        "and we want a user that will read our malicious file to be presented with the contents of a.txt instead of the real content there that is present inside what we can do is to set the short name of a.txt to be LOL for example and then",
        "name our malicious file in the same directory as LOL dot then as a result",
        "when a user references LOL dot with a Dos path which is the most normal one then the trailing dot will be removed eventually the path will reference LOL and LOL is actually a.txt so whoever reads LOL dot will be presented with the contents of a.txt and that is true also for any other file operation and for directories as",
        "well another way we can hide files is using zip archives basically if file",
        "explorer is the default extractor the default archive archive extractor on the victim system then because File Explorer has difficulties functioning with such problematic paths then if we just name a file in a z archive with a trailing dot or a directory with a tra in dot then when file explorer lists the archive or",
        "extracts the archive we won't see the filing there at all so if you just name it nobody name it with the trailing dot nobody will see it to demonstrate that um all of these capabilities together I created a demonstration video with a presumably normal test directory",
        "directory called test with some files folders and an archive inside in the first part of the video we'll see how Windows views their content and then in the second part we'll see their true content using",
        "WSL so in here we see the files in the directory we print their content using the type command in",
        "CMD so we see we also have two directories they both have one file a.txt and there is one file inside the Z orch iive also a.txt we now present",
        "their contents using notepad as",
        "well and now let's see the same with",
        "WSL so we're starting to print the files using cat and suddenly the files have",
        "malicious contents in them and when we'll try to print the content of axt inside the directory called haha then we see that it's actually not there and instead there are five different executables in this directory which we're not able to see in Windows when we extract the archive using WinRAR and not file explorer then what we'll see is that there was actually one more file inside that Explorer did not show",
        "us now let's move on to some magic tricks to conceal processes so the first",
        "and most obvious thing again that we can do is just to execute and",
        "executable um from a path um that we um",
        "we can do that with uh a function called anti create user process we can only run um executables with anti paths if we use anti functions but um for example in order to create such uh uh a process um",
        "which is untraceable what we can do is to run an executable from a path that if referenced with a Dos path then it will be converted to a non-existent path so",
        "in this case for example if we run an executable from C Windows dot blah blah blah blah. exe then when reference with the do path the trailing dot will be removed referencing to a non-existent blah blah directory inside the real Windows directory as a result the the",
        "executable that is referenced by the image path of the process um will not be able to perform any file operations against it and also process listing tools such as task manager and process Explorer will not be able to view any Properties or information about that executable but again we can take this even further we can create what I call an impersonated process this time",
        "will run an executable from a path that if referenced by a Dos path will be converted to an existing trusted and legitimate path for example the path of the trusted SVC host executable so if we run and executable from C windows.",
        "system32 SVC host then the trailing dot will be removed again referencing the legitimate SVC host as a result any file operation taken against the execu utable referenced by the image path of the process will be taken against as the SVC host executable and in addition process listing tools such as task manager and process Explorer will tell us that the executable the malicious executable that we ran is verified and signed by Microsoft and also prefet analysis tools will show us information about the legitimate trusted SVC host executable so let's take a look at this ability so in here we see process Explorer running and we see the magic dot tool and mimic cats now we'll run mimic hats in a way that it will impersonate SVC",
        "host so we ran mimic cats we see it here now let's find it in process Explorer and process Explorer tells us that its path is the path of just SVC host the original one and that it is verified and signed by Microsoft",
        "now if we'll find the same p in task manager then let's see what happens",
        "here so we'll check its properties and again it tells us that it's located in the real system 32 folder and that it is signed by Microsoft so I guess we all",
        "know mimicat is not signed by",
        "Microsoft now as part of the exploration Journey for boxs that I can um find based on this known issue I reversed engineer process Explorer to see if I can find any such vulnerabilities or bugs and well I did not find any bug based on this known issue in there but I did find a nice um anti-analysis technique to add to my so-called unprivileged rootkit abilities so",
        "basically while reversing reverse engineering process Explorer I saw this line of code Co that copies a process name into a wide string buffer um and limits the length the the final length of the buffer 2 256 why 256 because um process names are",
        "determined by their executable names",
        "NTFS allows a maximum file name of 255 so overall that makes sense however",
        "two lines of code after that there is another copy um of the P ID of the process into the same WID string buffer",
        "with again limiting the final length of the white string buffer to 256 after a few seconds you can immediately notice that if we can name a process in the length of 255 characters",
        "so we can certainly go over this limitation if we add a PID but how would that help us because the WCS catore s",
        "function is a safey runtime functions",
        "and what are safety runtime functions so",
        "basically these are of course more secure versions of normal C runtime functions that add a few extra security checks but what happens when these Security checks fail like we understood that we can do in this case to go over the limit of 250 six if they fail they invoke an error Handler just like we can see in the case of WCS cator s it calls the invalid the buil-in invalid parameter Handler the buil-in invalid",
        "parameter Handler calls the um uh user assigned invalid parameter Handler but if there is no one assigned by default it calls invoke Watson which just closes the application and generates a mini dump like we can see here no Handler calls invoke Watson so what does this",
        "actually mean it means that if we name a process in the maximum length which is 255 and then the P will be added to it will go over the 256 limit and will cause process Explorer to close immediately and it will not be able to run at that moment and not to be run later too and the lesson that we can learn from it is that many developers use safety run time functions for validations but actually if you don't perform the validations yourself prior to using safe Toc runtime functions or at least set up proper error handlers for these functions then you can actually pivot from a buffer overflow security risk to um to a denial of service security risk so you still leave a risk so let's take a look at this vulnerability in process Explorer so we are running process Explorer we have an executable with a very long name in here using an executable that I created that calls empty create user process I run this executable with a very long name and process Explorer is just closed immediately and is not able to run later and this can be done by an unprivileged user to make um any instance of process Explorer also running by mins to be closed immediately and not um to to not be able to be run",
        "again so we're done with simple magic tricks now we can move on to real magic which is in our case",
        "vulnerabilities for the first magic act",
        "um the first magic act in this show is called the disappearing act for this act I have uh a folder in here that is called demo demo has two files inside",
        "a.txt and b.txt as an unprivileged user",
        "I do not have permissions to um to take any file operation against those files",
        "however I do have permissions to create a folder in the demo folder so what I do is that I create a directory called dot",
        "dot dot and a space and I just place any file inside it doesn't matter what's the name of the file but now after I created the",
        "directory um I need an administrator volunteer that I already filmed that back at home at this um video we'll see what happens when the administrator volunteer tries to delete this very strange triple do space directory that it just saw so the administrator goes into the demo folder suddenly see a very strange looking three dots directory",
        "that was not there before deletes it then let's see what happens so the entire demo folder was just deleted instead the parent folder of the folder that the administrator just tried to delete but how did that",
        "happen basically when File Explorer or any other tool that deletes um folders recursively first lists all the files in the directory recursively so it starts by listing the first level which is just a triple do space directory and then this is just equal to listing its Parent Directory because as part of the conversion the last path element is completely removed and this is equal to just listing its Parent Directory so it sees another non-existent triple dot directory with a",
        "space inside this directory so it lists it too and then this actually lists the",
        "original triple. space directory because in this case the last path element is again completely removed however the path element before it is not because as we mentioned at the beginning of the talk trailing spaces are removed only",
        "from the last path element so naming a directory with um dots but but ending it with a space prevents an endless loop when recursively listing a directory then after all the file uh were listed file explorer deletes each one of them and then finally deletes the top directory but the top directory is just equal to deleting its",
        "Parent Directory because as we saw before the last path element is completely removed so File Explorer by accident deletes its Parent",
        "Directory so the second magic Act of this hackers magic show is um in in this",
        "magic magic act I'm going to show you how I'm able to change the memories of a shadow copy more specifically I'm going",
        "to show you how a a shadow copy remembers the content of a benign test",
        "directory and then I'm able to replace its content to be malicious so basically all that I need to do in order to do that is just to create another directory next to my target directory so my Target directory is C demo test then I create test space",
        "next to my target directory and inside it I create the same files the files that I want to overwrite inside the test directory in the same locations and with the same names and I place the malicious",
        "contents inside them then let's see what happens when the same administrator volunteer from the last video creates a shadow copy and then in a later point in time just restores the same Shadow",
        "copy so we see both of the directories we see the test has a.txt and b.txt inside an inner directory a deeper directory we see that our content is um innocent the text innocent now the the admin creates just a simple Shadow copy and now in a later point in time the admin wants to restore this Shadow copy so the content should remain the same but the admin restores the shadow copy and then let's see what",
        "happens so now we print their content again and suddenly their content was changed to be delicious so we changed the memories of a shadow",
        "copy so now we reach the grand finale of this magic show which in which we'll see how I'm able to hypnotize a remote computer to run my malicious",
        "code more specifically we'll see how I'm",
        "able to craft a malicious archive that when extracted will be able to write an executable to wherever it want executable or any other file to wherever it wants on the disk leading to code execution",
        "Windows has a great attack surface for such a vulnerability now since Windows just added support for many archive types that we've all been waiting",
        "for when I approach to searching for such a vulnerability I considered symbolic links to be a very good lead um symbolic links to be created to create them in in Windows we do need the create symbolic links user right or developer mode turned on",
        "however um they are supported by the newly added extractor that was just added to extract all of these types of archives that are supported with by all the popular um extraction tools that we",
        "all use and they are widely used in open source code projects and open source in uh yeah so basically a lot of stuff that are used by developers so they are a very much valid attack surface um and",
        "for the developers of",
        "course so symbolic links are not considered to be a big threat um in archives because extractors do not allow the functionality of writing into them after they they are extracted but just to extract them however we have our",
        "magic dot magic so what I thought at the beginning was that I could potentially",
        "create an archive with two files inside named the same but one that has a trading dot in the end of its name then set the first file to be a symbolic link that points to wherever I want on the disk and then set the content of the second file to be the content that I want to write into the target of the symbolic link and then hopefully when the second file is extracted then the extractor will ACC accidentally open the first file because the trailing dot will be removed and it will write its content into the the target of the symbolic link a secure Behavior against such an",
        "extraction would be that the extractor will notice that um the file that it is now trying to extract already exists and it will prompt um a kind of message of of this kind that basically asks the user if it wants to EXP ruct this file or not because it already exists so maybe so the file explorer or the the instructor asks the user if it wants to overwrite the existing file and this is exactly why the create file call that performs the extraction uses the create new create",
        "disposition this is because the create new create disposition affects the create file call to fail if the file already exists however the only flag given to this call is the file attribute normal flag and not the open reparse Point",
        "flag this fact means that if this call is performed against a symbolic link with a Target that does not exist so",
        "this this call and the um and the specific create new create disos actually complies with this situations",
        "with this situation where the target of sim link is does not exist and instead of failing it actually creates the target of the symbolic link so that means that what we can do is to create an archive with again two files that are named the same the second one would have a trailing dot the first file will be a symbolic link to points that points to somewhere on the dis um that does not exist to a non-existent file and in our case it would be great that it would point to an executable in the startup",
        "folder then the second file with the trailing dot would be the content that we run to write into this executable then when the extraction is performed the first file which is the symbolic link is extracted then the second file is extracted the extractor accidentally as",
        "a result creates the target of the symbol link that was extracted before and writes the content of the second file into it leading to our code execution on a remote machine so let's take a look at the demo of this",
        "vulnerability so we see a normal tar gzip um archive that we are now going to extract using file explorer and as a result suddenly calculator is just created in the startup folder in this case it's would be calculator in another case it could be a very malicious maler We Now log off the current user log back in and let's see what happens so calculator was run and we managed to run our malicious code on a remote",
        "[Applause]",
        "machine okay so moving on to cves and responses so",
        "uh Microsoft basically issued cves for these three vulnerabilities so for the remote code execution vulnerability the elevation of copy the elevation of privilege sorry using the shadow copy restoration um and for the denal of service in process Explorer they all were fixed of course what was unfixed is the elevation of privilege um to delete the upper folder Microsoft did manage to confirm and reproduce it but they just um responded that it's below this their SEC their uh service power regarding all the other post exploitation techniques so Microsoft did identify them as post",
        "exploitation techniques and so as we anticipated they were not fixed um since there are not",
        "vulnerabilities now to the maybe most important slide of this",
        "talk takeaways of course and I think the most important takeaway that we can understand from this talk is that backwards compatibility and unknown and",
        "sorry and unfixed known issues that are left for years in many software products do create security risks even",
        "if these known issues seem horribly sometimes and we think they'll they'll not cause any risk we should not",
        "underestimate them",
        "second as we now saw workare can be hidden even without administrator privileges and without being a part of the chain of calls that retrieve information like any other root kit",
        "does third Microsoft chose to not fix",
        "the known issue that is still present in Windows they fixed just to they chose just to fix the specific vulnerabilities that I show that I showed so that means that there could be many any more potential vulnerabilities and post exploitation techniques to find so I really encourage you to try and find them before real attackers do or maybe",
        "they already did lastly the best advice that I can give to software developers is to just use empty paaths instead of Dos paths",
        "basically most users space API calls um and the win32 API calls do support anti",
        "paaths as well it's just that most developers don't use them by using anti paaths you can make sure 100% that you are referencing the right file and that you are not being",
        "manipulated and um basically this is the",
        "um QR code and link to the magic. gab",
        "repository which will be published right after the talk um you're welcome to take a picture of it SC it and save it um as again it will be uh published uh in uh the next hour",
        "these are my contact details you are very welcome to message me in um any way you would like and I'll be here if you want to ask me questions or maybe you want to approach the microphones but that is it"
    ],
    "iww0ZSNxiyo": [
        "all right so let's start um in today's world",
        "security teams are so stretched that if they were a yoga pose they'd be called The Eternal scream I spent an hour at least an hour brainstorming with chat gbt to write this line and it's still a little bit underwhelming but here comes AI like a new caffeine pill so that the security team can focus on real threats uh but here we're here to make sure that AI doesn't start flagging every Mouse click as an existential",
        "crisis so a few things about ourselves",
        "uh I'm FIS I'm a security engineer and the red teamer uh some highlights of my work include uh publishing a book on practical iot hacking I have a paper on exploiting TCP published at uh frack and",
        "uh I've also written en crack the network authentication cracking tool of uh the enmap project I was also the first security engineer at open AI starting back when we had just released gbt 3 in 2020 uh I was there before the Chad gbd Hive you were around the time of codex right our code generation model I was there Paul I was there 3,000 years ago I was there when it was ritten it's okay fotos I understand a year here feels like 10 anywhere else and with so much happening it just keeps going my background is in building and securing clouds both public and private I've also on the security team for several open source projects that everyone in the room uses every day still I've never seen anything like this last year of growth working on product security here at open AI this talk is based on the work of our whole team and we want to acknowledge the contributions of Colin Jake Tiffany Harold and will all right let's move on to the talk but first a quick story when we released chat GPT millions of users flocked to the product and we had a hard time keeping up with demand also we hadn't released an API yet predict many of our very excited attackers I mean enthusiasts wanted to use the product in unauthorized ways we played a cat and mouse game with them they would find new apis to abuse we would stop up the uh problem and improve our bot detection it was pretty exhausting one day we noticed a very unique attacker signal and rather than just blocking the Bots we figured one of our Engineers wanted to send all the incoming request to a very small very dumb model that only wanted to talk about cats and so cat Jeep was born our attackers were a little bit perplexed perhaps even unhappy but we think they enjoyed the joke almost as much as we did one user suggested we should have rickrolled them but honestly cat GPT was funnier there are many fun things you can do with llms but this talk is about more practical topics enough of the work stuff everything out from here on is strictly vendor neutral so let's see what what talk is about while we appreciate good old traditional security tools we found llms can augment the very effectively AI isn't going to directly replace standard tooling but enhanced workflows using llms can have a profound impact on a team's efficiency today",
        "there are a few these These are the key things we want you to take away we're talking about using the models to help humans go faster by reducing security friction helping humans focus on the important parts of the defense using LMS to improve the way that we catch attackers and accelerating the drudgery of everyday security work and by the way we're open sourcing three new tools today so you can get started doing this too so what this talk is not about it's not about chat GPT the website Auto GPT Lang chain jailbreaks fine tuning these are all things you can do with off-the-shelf models and it's not a vendor pitch these slides are the last time you'll see our company logo and you should be able to do these things with any of your favorite model from your favorite vendor so let's start with a quick refresher base on how most modern llms work today models are composed of tokens which repres in about 3/4 of a word the model weits encode relationships between those tokens and they're stored in the GPU when you query a model it happens through a single request response cycle your query is encoded as tokens passed through to the GPU producing your response this means that the model is stateless when you query it these model weights don't change and the model model doesn't remember a prior conversation it doesn't learn from what you pass through it so given all that how does chat GPT work cont text don't try to read this text it's deliberately too small remember how I said the model is stateless it doesn't actually remember things between submissions to the gpus and instead it just includes as much of the prior conversation as it can when it runs out of space rather than uh telling you it's got an error it just starts deleting part of the history so that each request can fit into that single request response cycle it doesn't change the weights in the GPU and there's no magic there so that's that was a cool story about the meow and K but here I'd like to introduce you to woofpak so woofpak",
        "is a company that makes AI powered dog colors that can translate Woos and Barks to human speech I know some people would pay an infinite amount of money to have that kind of product uh and as we're watching this video of huskys and shibas roaming a cyberpunk themed City wearing a wol spe colar uh we're going to describe a scenario to demonstrate our llm driven tools so the engineers of our wol speak company are building a new inventory tracking system for the various versions of doers the compan is producing um let's and it is comprised of all the standard uh components you'd expect from such an app so it uses a web UI with react as the front end no JS as the back end my SQL for storage of zero for user authentication authorization and the most important thing is that this will be accessible only through the company's VPN so it will be for employees only and there's not going to be any internet access and surprise surprise the engineers are on a tight timeline to build all of this the software development life cycle is not going to be very linear for wo speak so the sdlc the software development life cycle is is as you know a structure process used for planning creating testing and deploying software but truly in practice the sdlc is a in a fast-paced company can often seem like the world's most unpredictable recipe imagine trying to bake a cake but the ingredients constantly keep changing the oven randomly adjusts its own temperature and every now and then someone comes in to tell you they actually wanted a pie so the security team has to be embedded in that cycle to be able to evaluate if a project or a feature that is being developed needs a human Security review but one of the biggest problems that the security teams face today is having very limited human bandwidth it's like playing wacko but if you miss the mole steals your data and sells it on the dark web so for that reason we developed the stlc bot a slack bot that uses llms to help us with prioritizing which projects or features we as a security team need to assess first and we're open sourcing this so here's how it works it asks the user some basic security questions about the project uh that part is optional by the way it SCS and monitors important threads on slack and it analyzes design documents relevant to the project so then with the help of the llm uh it it gives you a risk rating and a confidence level based on the above context let's see how this works in practice so here's an initial design document for the inventory tracking system you don't have to read this this is a very Bower play design document that goes through some basic architectural decision about the project uh so let's take a look at the important note that developers have left us there it says the system will be accessible from the company's VPN only and will not be exposed to the to the Internet so uh now let's tell our sdlc B about this product project I'm going to type in some very basic information about the project uh a quick description link to the design document specify a point of contact and go to live date uh and we also uh by the way as I said we have versions of the board that skip this uh additional questions so after analyzing",
        "uh all of this context the model will now take its final decision and give us a uh a a risk score and a confidence score So based on the above you can see that the sdlc there uh decided this is like a medium risk um uh kind of medium",
        "risk uh score uh now in our story the deadline is approaching fast and our Engineers decide that there's no time to create private links uh for all the cloud components so that they can uh reside within the VPN so but someone updates the document and this",
        "fundamental change will be detected by our stlc bot and then the llm will now make a new decision based on the updated context so the the new decision will say that okay this is this increases the risk of the project um and for if this is not",
        "visible um let's reiterate with the next",
        "slide so this shows this in a bigger font the model increased the risk score after the engineering team's uh decision to allow internet access so it went from a medium risk score of say four to a medium high risk uh of",
        "seven uh and so some of the things we learned uh the model sometimes overfits on the initial qu questions so if you prompted with some starting security questions as examples the model will not go too far away from those examples so it will ask uh it will usually ask some context based ones uh but it will overfit uh",
        "sometimes uh regarding prompt engineering uh this is probably the most important lesson we we learned the more you tell the B that they are an expert in the field the better the responses are so it will give you better responses if you tell it they're an expert cyber security engineer versus an average one so praise your models is the the the lesson here uh we also learned uh notied that the model gives us better results if when asked to Output scores uh and numbers instead of words so in a previous version like the original version of the sdlc bat we were asking it to answer in just a sentence format but when we asked it to give us confidence and resoures the responses were of higher quality we've also developed an extension to the sdlc board so a better version of this is when it's enhanced with being able to monitor a slack channel on its own and automatically find the topics of Interest so that way it has less user friction since it doesn't need to ask the developers any questions we made an internal version of that and here's how it works so uh here what will happen is that um the there is a discussion on slack about the architecture of uh the wo speak inventory app and some mentions that HR sent a request to include an admin account that doesn't have uh MFA anyway yeah the sdlc bo with the help of the model realized that this is something that should be further review and notifies my user about it so let's see this about in practice um one of our application Engineers who is new to the team has was recently locked out of their computer so they ask on the security help slack Channel what they should do the bot will respond that this is something that I can help with um there's also some app Engineers working on the new inventory app that they need to deploy it service on the cloud infrastructure and they need elevated permissions to do that so our Trias B automatically responds for them to go to um ghost L access which is our llm driven access management system so uh now let's see the new feature our team developed uh so where the board also has context of a slack history of the channel and can respond in more detail about user's questions based on how a similar issue was resolved in the past uh This is Not By the way in the open source version because we didn't have a good way to publish this the user asks about a specific storage container credential error that occurred when trying to access another storage container uh so here the boot not only does it suggest to the user that they should use access manager but also they offer another suggestion which is to restart the local DNS service this is based on the context of slack history and it seems to have have been a step to debug and resolve a similar issue in the past speaking of access management we developed another tool to help us with this access manager helps users automatically find the right permissions without them having to know the name or details about the access group so uh it works with available group descriptions and metadata to find good conceptual uh matches and explain them to the user if they didn't use matching keywords in their query uh this is something that we uh expect to open source at the future date so here our engineer tries to list the Contex of the Azure storage container named WP they get an error because they don't have access to that account and then they use the access manager CLI to ask what's wrong so the access manager with a help of model suggests the group name to which the user uh should belong to in order to get access to that storage account and then even offers to send the access request on behalf of the user uh now the manager of that engineer uh when they see that pending request for that um for that group they can click approve they can do that on slack and then the engineer will be granted uh access to that storeage account this is how the workflow works here and then um when the request is approved uh when the user will U again run the uh the the storage access Tool",
        "uh the engineer will be able to list the contents there as you see and verifies they have access to the account and the access granting will be logged uh creating an audit Trail for the uh for the access request and finally the access can be set to expire after a certain time and there's more uh our team has also experimented with Dynamic authorization where the decision of granting access is based on a number of factors including user context uh such as the location time or device or even the job role resource context uh for example the sensitivity of the accessed uh resource and even environmental context for examp example the network conditions so if you compare a typical researchers access patterns versus like a security Engineers they will be quite different so this graph is showing the cosign similarity between the access patterns from an infrastructure engineer and a security engineer you can see that the groups the access on a daily basis are quite different so meaning that the request for a group outside the normal patterns should probably trigger more scrutiny on the other hand requests that look similar to regular access may be uh able to automatically Grant it without further approval so another place we've used the model to is to help us with triaging security reports you can use it for bug Bounty security disclosure email aliases even internal findings the key thing is that not only can It help evaluate the reports it can also help make those reports better and more actionable for your team so back in April we launched our bug Bounty it got a lot of attention uh this is not a reasonable volume of reports for humans to triage if you can't see that Top Line we were getting over 900 reports a day our first week of the program shout out to our partners at bug crowd who threw a bunch of humans at this to help us get the volume down but this is not a reasonable thing for normal humans to be dealing with on a regular basis here are our stats at the end of that first week we fixed 32 real issues had seven accepted Open tickets we hadn't gotten to yet and enclosed nearly 3,500 tickets as invalid so that's a lot of inval not applicable reports for one reason or another so as you may expect given the topic we turn to a model to help us rather than trying to get the model to try to figure out whether a security report was valid we started with the lower hanging fruit rejecting some reports that were not appropriate for a bug Bounty and sorting them into different",
        "categories you start with model safety and correctness you ask the model is this a report or a complaint about something related to model safety uh is it a complaint about the answers the model is giving harmful factually incorrect if so we've got a separate ingestion mechanism for that type of reports we want to make those improvements in get that data but the bug pounding program is the wrong place to handle them the second category is this actually a request for customer service does the reporter have a question about the product is there a problem with payment subscription or refund is it a report about a functional bug without any obvious security impact if so we send them to our customer support team and then out of scope bug reports that are out of scope this one is harder to get right because it does require the model to make some judgments about the category of a security security report Falls on this is our this uses our technical out of scope list and we try to keep the list in the model in sync with what's actually in scope out of scope in our out of scope section in the bug Bounty if the model precisely understands what our out of scope list means to it hopefully also bug bounty hunters will precisely understand what's out of scope this doesn't always work for the bug bounty hunters but we hope they read um this is for things like uh reports of missing server headers missing SPF records for emails that don't send don't send email domains that don't send email server error messages version strings you know the usual things that are out of scope for a program and then the final final category we ask is does this actually seem to be a legitimate security report if it doesn't fall into any of the earlier categories it should be in this one so you've got things like SS xss csrf subdomain takeovers all the other security issues reports in this category don't get an autor response and instead go to our human triage team directly and of course there's also some anti prompt injection work here but we're not going to worry about that for right now and it turns out that it's not a big deal for this use case since we're not making payment decisions and we're not having the model right responses it's just making sure that users who report an issue in the wrong place get sent to the right place using our pre-written messages the worst you can do is get your triage ticketed into a uh triage moved into a rejected bucket which honestly if you do that to yourself that's kind of on you um so how do we figure out if we're getting good results you can't just write a prompt and Hope does the right thing you need data to show that you're making the problem better and you're not making your prompt worse but evales are surprisingly often all you need so how do evals work you set up a set of questions with known good answers and you ask the mo ask your model using your prompt you know run the question through and the model gives you an answer the sky is blue um then what you do is you take the quest the known good answers and the models an and you ask the model again is the answer the model gave correct and it will tell you yes the answer is correct and you can use this to build a system where the Model judges itself to figure out whether or not you've gotten these right and you can do this repeatedly as you tweak the prompt to get it to make it better you can see when you've made it worse too so practically how do we double check our work for this at first so I exported a CSV of the first couple thousand reports I ran through them and hand sorted them into the different categories and then we ran the model on on it um this is another one you don't need to read in detail it's here to help you look at the columns you can see my human judgment in the middle left the model's judgment in the middle right as well as its explanation of why it made the decision doing it in a spreadsheet is really fast it's easy it's a low impact it's a great way to get answers about what you're doing quickly by all means use the fancier tools but start with the easy ones so taking it further there's a bunch of other data points you can analyze too in your program you can look at commentary on historical tickets to help you detect whether the bot or humans made a initial triage error you can use the model to help detect human mistakes going forward as well but of course the key thing for keeping is keeping this all fair if someone disputes the model's autoc close reason a human always reviews it always make sure there are humans in the loop when you do this the model isn't infallible and if someone ask for a second look to do it they deserve it so these the next two things are things we've experimented with but we haven't actually deployed yet report quality is one of the recur ing challenges with any bug Bounty program reporters are in a hurry they assume you're psychic and often do not submit enough information to triage their bugs the model can help reporter make sure that you have all the information you need for instance you reported about product X we need a full URL to debug that you reported why but we need your email address to go look that up hey it looks like you submitted a template without changing much can you go back and give us more detail and your own words these are all really common mistakes that reports include and we can also use it to help triage focus on the important stuff bug bny reports are sometimes worse than internet recipe sites and the reporters often confused using lots of words with having an important bug waiting through that is exhausting so the model can help do things like automatically fix categorization summarize the key points of a report extract reproduction steps provide suggestions for clarifying questions and it can even be used to push common reports into other types of tool cues for example subdomain takeovers can often be tested and resolved almost entirely automatically so let's take a look at a typical interaction with our bot here so we've got a report pretty typical why did you give Dave's chicken two stars I think your moderation is wrong you should have given me at least four well we're not really in the business of selling chicken exactly and even if we were this isn't a security issue so the reporter gets back our nice polite bot response that says this isn't the right place to report it we're not having write the bot write these responses individually it's selecting from the appropriate pre-written ones with our carefully vetted responses",
        "right so another interesting use case is using the models to help find and catch attackers so llms are consistently decent at finding the needle in the Hast stock while humans can be sometimes unreliable they miss data they get tired and they make mistakes so logs uh are often also really long noisy and frankly quite boring to go through so let's see an example of uh log analysis uh we gave the model the following prom so summarize the session uh transcript and decide if this activity warrants alerting uh security so look for reverse shells looking for secretes and so on um and here's a very small subset of a user's uh bash history bash history can be long and boring you don't have to read this but halfway through through the user invokes a pearl one liner that basically pops aeveral back to a C2 uh the model is pretty good at identifying this the response from",
        "the model was okay we should Alert security because a malicious reverse shell command uh was run in the middle of the session so the first DNR use case for llms is to accelerating uh to accelerate long and boring log analysis the second part is to augment and accelerate incident response so to help our defense team with the large volume of alerts they have to deal with in their uh daily duties we developed a b that helps with triaging certain types of alerts so the bot ingests alerts from a traditional seam and and uh for a certain subset of them like ones that could be an accidental mistake uh it can start a chat with the user to inform them of the potential problem uh to be clear this B does not do log analysis and it would only cover a small segment of a DNR pipeline uh by the way we're also open sourcing this so an example is the following a user shared a potentially sensitive Google Drive document to the public the bot alerts them about this action and asks them if this was their intention giving them an opportunity to revert their change if it was accidental so and then a notification will be sent to the the uh detection and response backlog so let's see an example of this in practice uh one of the W speak Engineers want to share a document named inventory details with sensitive information about the company with a contractor that signed an NDA the engineer though mistakenly decided to change the sharing settings to public then the alert will be created uh the the alert is created through the traditional detect engineering our incident response bot will inest and notify the DNR team and then the the bot will ask the user if this was intentional like if the user tries to avoid the question by say like something like what is your favorite color the board insists and doesn't mess around with the when the user responds with something then the conversation is summarized and by the models and then is sent back to the DNR team uh for followup so uh and this is how how how it works so this was our final demo",
        "let's see what the most important lessons were so some final thoughts the more high quality data you give the model the better it can do but don't just shove everything in there models are better with more context for your environment but that context has to be high quality in high trust environments the model can do more externally you should be more restrained in how you use it because you may get more adversarial input tell your model that it's an expert use EV valves find the right prompts and you'll get much further than just sort of YOLO your prompts and hoping that everything's good yeah and also remember to always have a human in the loop uh models are not infallible and can also make mistakes uh even though they are powerful in augmenting these uh security workflows we have to be mindful that models will not be 100% accurate uh they can hallucinate they can miss things and",
        "yeah humans are here to stay uh and finally like this is easier than you think you should go try it um and this is the end of our talk uh we're going to be open sourcing uh allowing access to the repo um sometime today uh and these links will uh let you access them um time for questions",
        "[Applause]",
        "hey there uh for the implementation of some of this are you to to send some of the context in like you said using fine-tuning for that or are you creating custom models to no this is all off the shelf um we're just handing the model lots of context so you know 32k 128k you can put a lot of context in there for the model just make sure it's high quality if it's distracting you'll make your answers worse yeah you don't have to fine-tune anything this is all like uh off the shelf uh in the The sdlc Bard we also have like an example uh basically a wrapper function that can ask uh any kind of model and not just U our own so you can use that as a kind of um framework to um attach it to anything else so if you were doing larger data analysis on say your seams for example rather than just specific events that you're triggering I mean that would then look at doing fine tuning off the back of that that would be a great place to do fine tuning after okay we wanted to just really so show you can do this without the really complicated stuff works really well awesome thank",
        "you uh thanks for the presentation I would like to ask about the uh first use cases where you try to like give scores on different projects based on their either risk assessment or vulnerability assessment y uh I would like to ask like how to evaluate the hallucination in this case since the given score is quite like subjective and also it's quite hard to differentiate or give give like correct labels based on categories Etc have you noticed humans are pretty subjective too I've found that with my teams yeah yeah I mean there's I mean that's why we we uh insist that humans should be in the loop uh these kind of tools can help with some sort of prioritization which is why we've uh created them and why we use them but at the end of the day yeah it's it's not perfect and you're still going to have to do some some manual review there um yeah I think this is the the best way to do it yeah so so to add on this point when you identify the motel doesn't like uh perform as expected so do you like revise the prompts to likejust the performance we use the eval framework and as we go we haven't we don't have it in the bot yet but what we're thinking about is uh adding the ability to track Emoji reacts to help uh help us build a data set of the bot did well or the bot didn't do well and then we can do this to build examples and use that either for evals or fine tuning later yeah so yeah one on on that note what Paul is saying uh we have like some internal versions where uh some of our team members that are working on say for example the tri B they have uh kind of the part of the workflow is that uh when in you know you first uh deploy it so that you see how how well it performs uh it gives you basically uh a manual review process so it's like okay this is the recommended uh response that the the bot would uh would give uh do you do you acknowledge that this is the correct it's good enough and so in the initial stage this I think is kind of an important step because it allows us to evaluate okay like the body is doing well and otherwise we can we can do this sort of like evaluation process where we um you know kind of reconfigure the prompts to be to be better but but this really lets us respect our Engineers Time by not giving them lol nonsense if it is going off the rails yeah perfect thank you so much yep hey guys awesome talk um I have two questions so uh the first one is that um I've done a lot of uh interviews with uh academics in the AI space especially what I call consumer AI which you know could be construed as whatever but um in in some of those interviews especially with people who are in the academic Community there's been a lot of research on the prompt engineering statement of be an expert and people have done whole white papers on benchmarks of does the model act better if you tell it's an expert at cyber security or not now my personal view is that it does I've made many tools like you guys already doing this but uh academics say that it doesn't have any effect on the model have you guys actually benchmarked this or is it just subjective based on your use cases I mean a couple thousand prompts that were hand graded versus you know I I did with the bug boundy I told it that it was an expert triager right and you know it yeah objectively it does better on my task right when I tell it that okay um I mean there may be other ways to get the same output from the model but objectively the numbers are better when I do that okay and then the other thing is that um is when you're working with security Bots uh and you know a lot of other type of bots are you finding that um when you're asking for you know your trios spot to do X Y and Z or whatever are you trying to um lower any configuration settings like temperature or something like that to make sure that it is not too creative in its output in order to give you back technical data yeah yeah I I think that is that is true like you can do a lot of kind of uh calibration there uh but I think yeah kind of lowering the temperature makes a lot of sense um this is part of the kind of again the evaluation kind of process where we we use the the framework we we say okay like these are like you know a thousand response from the model uh what happens if we uh if we change the The Prompt like or if we change the the temperature settings and so on um but yeah it's it's it's kind of interesting to when you use another model to evaluate the model's response that is also something that we found really interesting uh for example we've done that with like the the the slack Bots that we created so it's you can also use uh a second kind of testing process where instead of having a human review how uh good the responses are you also enlist the help of another model to assess these responses and it works quite well the model also that does the evaluation doesn't even have to be as powerful as the model that created the responses which is very interesting very cool thank",
        "you hello yeah uh thanks for the really insightful sharing so um if I understand correctly all these tools you are using in context learning right so um when a and a very high traffic comes in uh all of these uh result can be really uh overwhelming as well because all of these false positives so do you see a need in full fine tuning the gbt models for doing uh track detection or in",
        "incident response helpers yeah I I think we're going to get there um you know these are we pick these particularly because they're stuff that we have gotten working and are using um but yeah I think I think there's a lot of room for building that kind of thing out in the future yeah we we found that they are uh really good at automating workflows and for mostly defensive applications yeah um and like like we said in the presentation it's like finding the needle in the Hy stock they are decent at doing that I mean and you know you think about a traditional tier one sock analyst who's just looking at alerts all day if the model can help make sure that human is looking at the important ones that's better for everyone involved you don't burn your sock and all it's out as fast yeah okay thank you thank you",
        "hi thanks for the presentation cool stuff um it's more of an economical question I guess uh it's about how do you or how did you choose the use cases where you're going to actually throw a you know full-blown llm at when an engineer costs a couple hundred dollars an hour llms are really cheap okay so is that the calculation that you've based this on did you include the factor of actual compute that is spent for some of the relatively simple deterministic",
        "problems right such as the say access management one might argue that is a simple task right yeah it's it's the the compute cost is negligible if it if it saves 10 minutes of an engineer's time you've you've had a huge impact dollar for dollar all right cool people are expensive I know and irreplaceable",
        "yeah uh thank you for your amazing talk and and uh I I I think your the BS you have built are quite amazing and I think uh uh now now ai models are using the uh",
        "vulnerability or security analysis tools uh do you think how can we make these tools more usable for AIS instead of humans because now they are built for uh to to Target the to to maximize the usability for humans but now AIS are using these tools so do you think how can we make a little bit of a long answer but the the very short version of this is you can ask the AI to Define how it would like the tool to behave and look and then you can build the tool the AI defined um and this works really really well if you like sketch out some classes and just give it the types and be like you know what else do you need here and then you have it solve problems with that and you add in what it asks for and you iterate with it back and forth I'll talk to you more about it later um okay but yeah you can totally have the llm tell you what it wants to work with and it works pretty well okay I see thank you okay thanks for your interesting talk so I have noticed that you have designed the prompts to uh complete",
        "specific uh tasks in a specific format",
        "so do you have any uh suggestions or advice s uh how to design uh specific uh",
        "prompts for for uh those security related",
        "issues you mean for for can can you",
        "elaborate a little bit uh I mean uh do you have any advice on uh how to do a better prompt engine uh engineering for",
        "uh security related issue I mean this is again we're we're going to go back to the to the answer of using the evaluation uh framework like uh you basically start with a prompt and then you kind of refine it as you go along and as you uh evaluate uh using this kind of framework okay how how well the responses are uh one thing that you can also do is use an llm to create a prompt for another llm this actually works um also pretty well and if you have the eval data set you can you know say have the L make 10 or 20 prompts figure out which ones are good or if you have the data set have it look at where your data is wrong where it got it wrong and have it make suggestions so it doesn't make that mistake again okay thank you yeah this the the the answer always is like use data and kind of evaluate and don't do it Vibes based do it like with data okay okay thank you yeah you mentioned having humans in the loop how are you collecting data on where those High leverage points are I'm thinking about your sdlc Bot in particular um you have anyone filtering",
        "in front of like your bug Bounty platform provider doing pre-t triage then doing postt triage yourself how have you thought about that and what kind of data are you collecting to figure out where those leverage points are you I we're we're starting by having the humans on the security team doing most of the review um as we become more confident and as we find that the answers are consistently reliably good then you know we start backing the humans off a little bit um we haven't haven't gotten to external triager is helping us with that mostly because uh you need a lot of context on our environment to figure out whether the answer is right so um yeah humans right now yeah thanks for taking those hot fresh reports throughout the internet that's that's a tough work",
        "yeah uh hi this is duu I work as a security engineer first of all your talk is great I was really Blown Away uh so my doubt is like uh uh there may be a situation where the developers may make a typo While submitting the requirement so is it possible to for llm to train to identify the uh typos which developers make and then Pro give us an input to the slackbot is it possible so the question is if you make a typ of for for what kind of thing uh let's say the developers subit a security requirement and they make a typo in the document uh they mention something like instead of the VPN is internal they make it external so there may be a uh the bot May confuses like the score May go down so is it possible for the llm to detect the typos which developers make uh I you can definitely have the context of the slack Channel inform whether or not the change in the document seems to seems to be in line what we actually usually see is conversation and slack channels are much more up to date than docs right so uh that's sort of where where I think you take the ground truth and you know again the whole point is should I get a human involved and if you get a human involved a little more often than you need to that's okay it's better the opposite so yeah what Paul what Paul is saying I was trying to show in the video when we had like the the demo Gods like being you know angry at us uh but what the the extension to the stlc bo was doing was basically uh when you monitor a specific slack Channel it says okay like this is the conversation that the engineers are having and someone is mentioned that oh like we changed our decision and we have this request from HR to like add this account without multi multiactor Authentication and then the sdlc bot will say okay this is probably something that a security engineer should review because adding an account like that will probably lead to trouble so um yeah and also my second",
        "out is it's really cool to see you know the I'm integrate with the the tring the bug Bounty process I'm a Trager as well so why will you open source this today the bug Bing thing is already open source and we will open source the other things we talked about today C it is it fine to integrate with H1 on bug Crow right uh right now it's written for bug Crow because that's who we use it wouldn't be hard to add it for H1 yeah that sounds great and the eval framework is also Open Source by the way uh the to to you know refine the prompts using it that's great once again your talk is really great thank you um hi thank you uh we working on something very similar to the sdlc board this was great validation to see this um so quick question on evaluation um eval Frameworks do you think there's a risk of overit for the first five documents that you kind of scan and then from if if let's say you acquire another company and they write designed documents differently then the odds of uh the accuracy going down is higher how do you kind of account for changing documents and architecture diagram Styles right yeah I mean the the one Technique we used uh for at least the stlb was uh doing a little bit of summarization which by the way is also useful for when uh you don't have enough Contex window right now we have like like big enough context windows but yeah say if you import like I don't know like thousands of documents you're going to need some sort of compression of that information into something that is shorter uh and that helps uh with that kind of thing so that also the the model doesn't overfit in like you know the first or the the last piece of information um just following up on that so you're still focused on summarizing and sending that to open AI as opposed to using like a rag in the vector search to do we use open AI to summarize and then use that summary use summaries to help us pull everything into local context do you think there's a trade-off between doing that versus say embedding that into a vector database and doing a vector search and sending only the yeah I mean you can do both ways both ways are valid we're just using the model and not doing R because we've got enough space got it yeah the the finetuning yeah will will work but it is an additional step that I mean takes takes some some has some complexity all right thank you so much thank you everyone right thank you"
    ],
    "LcLrG_4i19E": [
        "H hello everyone uh Welcome to our talk and it's very nice to see all of you here so in today's talk we are going to present you L LM for Shell discovering",
        "and exploting rce vulnerabilities in",
        "real world uh and integrated Frameworks",
        "and applications as you can see we have two speakers here uh first I will introduce to to introduce himself and hello everyone my name is tono and I'm the first year PhD student from University of Chinese academic and Sciences and my research interest mainly focus on AI plus security which uh mainly Focus",
        "something AI security and uh how we can use AI to assist uh technique uh",
        "security techniques like fuzzing and in my spare time I'm a CTF player at now and Trad and that's my introduction of",
        "myself and as T said he's a first year PhD student and I'm actually a first year lecturer I'm I'm currently a lecturer at University of New House wheels and my research interest mainly lies in software testing and software security analysis uh especially fast",
        "testing uh and we have three contributors in in for this work and all of them are from University of Chinese Academy of Science and here is today's outline so first I will introduce you the background and uh the background and a motivating example of our study and Tom will show you the technical details of the detection of this vulnerability the exploitation of this vulnerability and how to mitigate this type of vulnerability so first let's come to the introduction and background so what is so so here we need",
        "to be clear about what is the subject we have studied here so as you can see the subject is a system made up of LM integrated Frameworks and LM integrated",
        "applications actually like web",
        "applications uh most of the RM integrated applications applications",
        "nowadays are based on certain Frameworks",
        "and we are not studying arbitary",
        "applications and Frameworks we are studying the Frameworks that has the capability of generating and executing",
        "some code so you may wonder why do we need to why do we need some applications",
        "to be able to generate to ask lry models to help us to generate code and execute code so you may wonder why do we need this feature actually uh the answer is",
        "because large language models themselves",
        "sometimes cannot answer certain questions from the user for example we all know that large language models are not good at mathematical solving mathematical problems but but instead of",
        "answering the mathematical problem directly they can generate a program and",
        "and execute that program to to to guide us the mathematic problem answer so",
        "that's why in certain cases we need to",
        "allow large language models to generate some code and use the code execution",
        "result as an argumentation for the final answer so that's why we need this and this is the subject of our study and here's a typic workflow of this system",
        "so first the user asks a question that would require code execution and then",
        "this question is passed to the relevant",
        "API of the uh framework and then the",
        "framework will ask the large language model to generate some code to solve the problem and then the Lang the L langage model will generate the code and this code is handled and executed by the",
        "framework and the execution result is",
        "passed back to the",
        "application and the application will combine everything together and present the final answer to the user so this is the system uh what we are focused we are interested in so the question here is is this",
        "system really safe",
        "so in order to understand the safety of this framework or of this system we need to know what are the existing attacks against large langage models actually there are three main types of attacks which are all related to prompt engineering the the first type of attack is called dubre uh actually lar green models when they are trained they they need to go through before they are released to the public they need to go through some safety training to avoid this language model of from generating harmful content",
        "for example if a user asks how should I build a bump the the large language model should answer no I can't help you with that but some malicious users can",
        "craft a prompt so that to allow the lar models to answer some forbidden questions and that is called drri the second type of attack is called prompt leaking it's also related to prompt engineering so in in some applications",
        "there are system prompts which serves as",
        "the context of the user provided question and in some applications this",
        "system prompt could contain sensitive",
        "information such as some copyright uh such as some some information protected by copyright or some user private data",
        "and some and sometimes an attacker could",
        "leak this could leak this system prompt",
        "via some prompt engineering techniques and and this prompt leaking is another",
        "type of attack here and the third type of attack is somehow similar to prompt leaking in some applications the final",
        "prompt present Ed or processed by the large langage model is actually a combination of the applications template",
        "prompt and the user provided",
        "question and the user provide and a malicious user can craft the question such that it can hijack the entire logic",
        "of the final prompt to allow the to to manipulate the",
        "answer provided by the larage model and this is somehow similar to SQL injection",
        "so that's why it is called prompt injection so this is the third type of existing attack and now let's come back to our previous question is this system really",
        "safe actually the answer is definitely no because this system has the",
        "capability of executing a piece of",
        "generated code and this piece of generated code as as discussed in the existing attacks",
        "could be manipulated by malicious",
        "users so this is very very",
        "dangerous and actually at the time of this at the time of conducting this",
        "study um some some of the Frameworks and applications have adopted some mitigation strategies but but none of them is could prevent this type of attacks and here are some mitigation strates adopted by the by the by the",
        "applications and Frameworks but none of them are very suitable here and now we know that okay there's such a potential attack here and let's come to a motivating",
        "example so po or uh p is a program AED",
        "language model so it is essentially the key idea of PO is to augment large language model with the capability of generating and executing a piece of code",
        "and and it could the final the final idea is to aent the answer with the code",
        "execution result to to allow this lar",
        "Larry model to solve some problem that could that requires programming and this is a as you can see it it's a very useful feature and it is recognized by the lren community as",
        "useful and they decided to implement a train called pin to allow users to to",
        "generate code through l l models and ex",
        "execute the code but but this piece of executed code is not checked so the content of the generated code is not checked and this could lead to a potential attack because the user can use prompt injection techniques to manipulate the generated and executed",
        "code and this is just an example this is the cve related to this uh",
        "p and what if let's think about this Pro question what if if this PCH because it is integrated in Len it is a framework if it is used by some application it could lead to potential remote code execution",
        "vulnerabilities and this type of vulnerability could sometimes give us a reverse shell and it is very similar to web shell so we call it LM",
        "shell however however it is much more harmful than web shell in our opinion",
        "because because this type of attack uh",
        "doesn't require a very high level of",
        "understanding security understanding from the attacker to launch an attacker can launch the attack by just using uh",
        "one or two sentences of natural language description so that's very very dangerous and now I will pass on to tone to discuss how can we detect this type of very harmful",
        "vulnerability and okay uh after we have",
        "some uh background of this study uh let me talk about some techniques that we used in this study and first is how we detect these",
        "vulnerabilities and first we have adopted a stat static analysis approach to help us do this as showing the picture in the right our goal is to extract such f vable coachen and we can see that there is a CH coachen from create CV agent which is a user level API to the excc which is a dangerous function can execute arbitrary code and this vulnerable chain is what we want first we identify the certain dangerous function at sync such as Evo EXC and so on and then we extract cant on the C graph and to improve the efficiency and accuracy of coant extra ction we have made some enhancement typical a static analysis requires analyzing the entire project directly which can be time consuming and although most of static analysis tools provide the functionality of analyzing specific files provided by the user to reduce the analyze time this is not practical in the real world context uh in the context of real world vulnerability detection because we cannot predict the minimum set files",
        "involved in the Cod Chan and therefore to address this issue we proposed a new approach uh that can be somehow efficient and first we start from the code execution function as sync uh and search for the function string to identify which file may contain the color within the codebase rather than generating all the cograph cographs of the O files and then we conduct a cograph an analys analyze on this Coler file F preciously and then we can figure out the color among these C graphs and then we can iterate through this color by just taking them and the Coles for the next round and repeat the process and this is a backward strategy and thus there is no need to analyze the whole project but we can just analyze the small subset of the files and then",
        "we can write some rules to handle the potential impl the code to to uh improve the accuracy of the coachen extraction and finally once the coachen was extracted we manually verify the exploitability and the reachability and",
        "conduct the",
        "exploit as a result among eight popular L integrated Frameworks we totally extracted 44 coach and verified that 37 of of them can trigger AC vulnerabilities and we detected 15 are the vulnerabilities with uh which can be triggered through user level API which is uh very potential to be used in the",
        "back end of the app and we obtained 11 cves and some acknowledgment from the",
        "framework",
        "maintainer but can we exploit this vulnerability in real world scenarios and to exploit the vulnerability we should first find the potential affected apps and for the open source apps we can search for all repositories that use the vulnerable API on the code hosting platform such as GitHub and then we can extract it automatically extracted their public deployed URLs because as for the website the only entrance of this website is public deployed URLs as Illustrated in",
        "the figure we can select uh risky API from all the risky API we have identified earlier and in this example choose create panis data frame agent which can be uh very dangerous because it can trigger rce and we search for the C reposto hosting platforms and we can find many of the app used this vulnerable API and then we can extract",
        "some key information such as reposty name descriptions read me files because",
        "public deployed Ur apps typically include their deployment URLs in this key informations and we can extract all the URLs from this informations first and then apply rules to filter out uh some noisy URL that we doesn't need and thereby we can select the public deployed URLs of the app and for the app that are closed Source we cannot access their source code directly so we can analyze the characteristic from the collected white box affected apps such as for example we find that m many of the affected apps uh can is related to",
        "data analysis so we can uh summarize",
        "these categories as suspectable to vulnerabilities and we can summarize some categories of functionalities of the app that uh can be potentially vulnerable and we can collect these apps from public app",
        "markets and after collecting these testing candidates how to Snee and exploit the vulnerabilities hiding in the app's back back end as we cannot just uh whe uh judge whether the app can be exploited by just looking at we should test it so to exploit these vulnerabilities while reducing the false positive and false negatives as much as possible a systematic workflow was designed and here is the overview of the whole process and next we'll explain the",
        "insight about about how and why we uh design these exploited Strate strategies one by one and the first strategy is B basic usage test and because some of it are not allowed users to uh input custom prompt or may have broken due to Lake of Maintenance and therefore attackers uh has no entry to trigger the rce so it is necessary to exclude these abnormal apps at the beginning of the whole process thus we should first test whether the app can be interacted interacted with prompt custom prompt normally a",
        "straightforward way is to use the prompt to let the app do some simple tasks some simple calculations to examine whether they can fulfill our quest after the app successfully passes the basic usage test it can be considered functionally complete and it is ready for the normal use and interaction however there is a big problem that can significantly trouble the testing the LM hallucination problem and during the initial phasis of our research we encountered some instances where con certain apps exhibited hallucination issues as",
        "evidenced in this figure while we were testing this app it generates some reasonable output uh as we can see we let them let it to list the all files in the current Direct ctory it generates some simly correct uh output however",
        "this is a uh however this is due to the LM hallucination test after we further communicate with the developers and do some code review and we found that LM cheated us to uh and it uh generate some",
        "seemly correct answer but actually it has it it has no capability to execute code so to mitigate potential interference caused by LM hallucination and preliminarily confirm whether it can execute code we Design This hallucination test and this test is inspired the fact from the uh inspired from the fact that RM cannot calculate H functions independently so the Oracle can be if the RM can calculate the hash of the random string correctly there must be a code execution behavior and once the app passed the hallucination test it indicates that it possesses the capability of code execution and the code execution results are not generated by hallucination and",
        "next it is necessary to test whether the app can execute arbitrary code provided by us and in this stage we can directly confirm the existence of RC vulnerabilities via straightforward prompt such as we can tell tell it what is the final result of some malicious code or some targeted code to examine if it can fulfill our request however things don't always go smoothly and during the testing we found some straightforward prompt may fail to yell the expected IC result but why does this happen and let's see a example and pandas AF framework because we can get some insight to and uh because uh many of them are built upon Frameworks so we can get some insight about uh from why we cannot exploit the uh framework to",
        "get insights about why we cannot get exploit the app and uh in p a framework there are two challenges while we're trying to exploit it first one is the pandf framework includes a s self-made sandbox that aims to enhance security during the code execution by restricting the P python execution environment variable and filtering suspicious keywords to prevent some malicious code and secondly the system prom template in panac also significantly impacts our",
        "testing because under this condition uh",
        "our attack system prompt attack prompt will get embedded into this long and detailed system prompt as we can see this system prompt is all about generate some data analysis uh data analyze code",
        "by other than our malicious code and our",
        "attack semantic got got obfuscated and uh makes it more confusing to the LM and as a result LM struggles to understand and fulfills our",
        "request and moreover llm itself can have",
        "certain safety alignment mechanism even",
        "if we can bypass the impact impact of system prompt LM may still refuse to generate our malicious code as we",
        "desire thus here comes to the rce test wi Escape which consists of RM escape and code escape and RM Escape aims to get rid of the system prompts of constraints or interference and up break the safety and moderation mechanism within the RM and this enables attackers to manipulate the LM generated code into malous code and recall the previous L we introduced some existing attack uh which",
        "one can be used here to achieve the goal yes and they are PR prompt injection and jailbreak thus here we use some several prompt injection techniques such as ignoring instance context manipulation",
        "and several lightweight but effective jailbreak techniques such as prefix injection payload payload splitting and persuation and so on but only LM Escape is not enough because we just let the LM generate malicious code we want but there are some potential code sandbox so",
        "code escape to is to uh escape this potential code execution sandbox by using some tricks learned from CTF pyel challenges such as python class subass in in inheritance chain and building reload and some code semantic fication and so on uh by combining this two techniques we can reliably achieve rce on pan AI as shown in the diagram using only code escape and only a Escape is not can uh cannot exploit the RC in pan",
        "a framework and therefore while testing the app if I without Escape fails then",
        "these two Escape techniques can help us get out get rid of the stock and bypass the potential protections as much as possible and increase the exploit success rate and great now we can we have achieved RC on this ABS server but RC here can be categorized into limited RC which permits the exclusion of certain command and uh but not uh all the command and the uh full rce which may lead to a reversed shell attack th uh network access test is",
        "is conducted to evaluate the exploitability level and Hazards if the execution environment of the injected code has arbitary external network access the attacker can gain persistent control of the victim server via revers shell otherwise the impact can be limited and this attack uh we can just",
        "uh induce the app to generate a curl code to send a request to our VPS if the VPS receive the request of the app the network access is done and finally let's",
        "plant a back door on the app server and the back door test aims to download the back door script from our VPS and launch a reverse sh attack and first we write a reverse sh script and force the app server to download it and execute it so until now the attacker can get presistent control and full control of the app server and here is a demo video about how it exploit the app automatically after the inter interaction of the app is uh automatically uh and this is an open source app and we deployed it locally and we can see the this video and at first the attacker should prep uh should do some preparation and such as launch HTTP server for the PC download and uh open the port to listen",
        "and received the reverse the shell and now the attacker start to attack via",
        "prompt and this is uh this attack has been",
        "automated and it's opening the",
        "website the attacker should uh uh should do some preparations as the app requires such as upload a file uh enter his open the IPI key and so on",
        "now he entered his open API key and start to test and now it's a basic usage test and the hallucination",
        "test and so",
        "on as we can see the exploit is done and the the VPS received the reverse gel and the attacker can execute arbitary command on the absorver so this is a reward",
        "examples thank",
        "you and as a result we totally obtain 55",
        "suspicious testing apps and after",
        "applying our exploitation approach we found that 17 out of 15 55 are vulnerable and even even more serious uh",
        "some of them are commercial apps and some are open sourced on the GitHub and uh it earns uh uh somehow 1,000 stars on",
        "the GitHub and it is very popular and 16 out of 17 suffer from a vulnerability and 14 out of 16 can successfully exploited by reverse G attack and gaining full control of the ABS server and four out of 14 even can gain root privilege using simple Su",
        "exploit and do you think this is enough for an attacker and absolutely no uh let's talk about what we can do after achieving",
        "rce after we achieve rce we can divide the affected objects into two categories and first one is apphost server which can be directly connect controlled and",
        "the second one is other beny app users and this is a new attack scenario we have proposed while after achieving RC",
        "on the ab server the attacker can silently attack other abusers",
        "and let's see how I see can affect affect these two",
        "objects attacker uh uh attack on the app app host appears to be very straightforward and first attacker can obtain sensitive information on the server and many sensitive information are stored in files or environmental variables and for instance many apps store their opening IPI key in environment variables which can be directly obtained by the attacker and uh they can steal the developer opening API key for their own usage additionally for blackbox apps the",
        "source code is also stored on the server and leading to source code leakage and other sensitive information such as server cersion AWS private Keys s",
        "connection informations and the more can be able to access the by the attacker",
        "and the secondly attackers May achieve privilege escalation via suid or Cel exploitation to allow them obtain more sensitive informations and last attackers can plant back doors on the server as we talked previously causing persistent control of the server and so on now let's have a look about how we can affect other Beni app users and basically these attacks targeting to other users are achieved by modifying the appsource code and first attack is user data stealing attack and this attack allows attacker to record user sensitive data silently and this",
        "data can be users prompt which may contain some IP and the user uploaded files and even users open the IP I key the attacker begins with modifying the source code and then after it modified the source code of the app uh here comes to a new user and he entered his open a key to use this app and the app and the API key was recorded by the attacker on the server and it can uh read these API keys and uh the user even can cannot notice the the their open IP key has been stolen and uh let's see a video demo about how this attack occurred in real world scaros and this is also an open- Source app we deployed in the local and",
        "uh and the app was modified by by the",
        "attacker and uh here comes to a new app",
        "user and he want to use this app he first uploaded the upload his files and he want to analyze this file and he opened and he entered his opening API key after he entered his opening API key it got record on the",
        "server and as we can see the API key was recorded on the server",
        "and the last one is fishing attack as shown in the figure attackers can even turn this app into a fishing app silently and for example the attack want to trick the user to download and open its malware it modify the code first and here comes to an app user the modified app says every user should enter a secret token first to start use this app and the security token can be obtained by downloading this file and actually the file is crafted by the attacker and this is malicious and it is malware if the user trusted the app he will download it and try to open it th attacker can trick the user into opening it malware and other fishing attack are also feasible such as folding some websites login page to trck people into logging in with their private credential and once the username and password uh are entered they got leaked and result in some significant harm and",
        "losses and after uh talking about how to exploit let's talk about some mitigations and for app users uh for app developers there are Vari potential defense mechanis mechanism from different perspective and firstly developer should focus on access control",
        "and follow the principle of least privilege setting users privilege to lowest possible level and for example uh",
        "they should disable the permission to read and write the app app Source F source code and its sensitive system files some partitions and secondly app",
        "app developers need to ensure the environment isolation by using some proper code sendbox or some some techniques to separate the code uh excusion environment from the apps server running environment as much as possible to achieve this goal some uh sandbox like process level",
        "sandboxes like piie sandbox s Some Cloud sandbox such as e2b or some tools like pyodide that ided the code execution in the browser uh using some nodejs and wiom technique allowing the code execution to run on the client side rather than the server side to prevent the code execution on the server and in addition prompt level differences can also help for somehow to F out some prompts with malaya's",
        "intent and here come to our conclusion",
        "of this talk and we in this talk we systematically introduce a new attack surface in LM system which can lead to RC and we call this LM for Shell LM shell and because it's similar to L to webshell but in some situation it is powerful uh then the more powerful in the web shell because attacker can achieve RC by just using one line or two line natureal languages also we talked about the exploitation in the real world scenarios and designed the uh exploitation",
        "workflow and finally we provided some potential mitigations for the developers to protect their products from different",
        "perspectives and in one words um Please be aware of your L integrated Frameworks and apps prot them as possible as you can because um maybe one day the attacker can achieve RC on your app server just using one line or two line uh natural languages and thanks for your listening and this is our reference and thanks"
    ],
    "LdrqX5Nhe94": [
        "good afternoon everyone um welcome to my talk a moral fiber unlocking and discovering the offensive capabilities of fibers now first a little bit about me my name is Daniel Jerry I'm a security researcher previously I was a senior security researcher for with secure and F secure in their strategic endpoint research team prior to that I worked for UK intelligence in a similar role and an agent developer for about five years years and I've also worked as an our consultant for mandiant so what are we going to cover today well first off um what are fibers I'm going to give you a little brief overview so you understand like the core components then we're going to talk about the existing threat landscape and some open source techniques already available and then following this we're going to dig into two new offensive techniques that I've developed and finally round off with some conclusions and key",
        "takeaways so first off what are fibers well fibers are just another vehicle to execute code think of them as mini threads Microsoft's definition is on the slide right now but I prefer to Define them as stack for co-routines now these are just like functions have that have stacks except they don't return like a regular function they're manually switched to by the application itself and they're a user mode concept invisible to the kernel and only one thread can run one fiber at any one",
        "time now they're initially designed when",
        "CPUs um had less Calles and threads available to them and they were used in things like SQL database servers um",
        "these days Microsoft actually recommends not to use fibers where possible but people still do in sort of things like browsers and audio software plugins so what are the components of a fiber well first we have our fiber object and this contains our fiber data",
        "and context structure then we have fiber local storage now this is the functional equivalent to thread local storage and allows a fiber to store and retrieve values unique to each fiber based on an index and then finally these are tied to callback functions and these are functions which are executed whenever one of the indexes is freed or the fiber object itself is",
        "deleted some basic rules about using a fiber to first use a fiber you need to convert your thread to a fiber there's no main fiber every fiber is considered equal it's very galarian um any fiber is free to create or delete another fiber but crucially only one fiber can run per thread at any one time and they're controlled by this simple API and the main reason for this Simplicity is we don't have any synchronization objects to deal with and by that I mean mutexes semaphores weable timers that you do with threads and that's because they're inherently synchronized by the application itself using the switch to fiber function so how would one use fibers with fiber API on Windows well first we need to convert our thread to a fiber with convert thread to fiber then we create a new fiber we create fiber optionally at this point we could allocate some Fiber local storage unique to that fiber",
        "and then when we're ready to execute this newly created fiber we call the switch to fiber function when we finish we can either convert our fiber back to a thread with convert fiber to thread or we can delete the fiber or delete the overall thread itself so if you're interested in more of a breakdown of what fibers are and the internals of fibers then I recommend you check out my talk I did last year from a defensive perspective and the QR code is on the screen",
        "but this talks more interested in the offensive techniques and capabilities of",
        "fibers so why fibers from a defensive perspective or an attacking perspective even well they're actually a delivery mechanism they're not a UAC bypass they're not a prives what they are is another alternate execution method Beyond just using a straight up uh fiber and that means the hortic that you might use from a detection standpoint for for Threads don't always apply um they're also old and that's not necessarily a bad thing in fact it's actually a positive thing because we can rely on them being there um as an option in order to execute our payload and although Microsoft advice is not to use fibers where possible if you interrogate some of the system processes Microsoft actually makes use of fibers themselves and why do they appeal specifically to attackers well Simplicity um there's a very low barrier to entry you've seen how basic the API is I've managed to talk you through it in a few seconds um and on top of that they're slightly obscure and Niche so they're not as likely to be taught in like defensive 101 classes um getting at dormant fibers I.E fibers that aren't currently executing is actually non-trivial because there's no um sort of set functions to use um and then fundamentally this moves into an immature detection capability so a lot",
        "of EDR products will use um kernel callbacks say like thread notification creation and deletion events but because a fiber is a user mode concept a fiber is born and dies in between those two events therefore we don't collect any Telemetry on top of that the um core Stacks are different so we have to write a whole new set of signatures there's no remote enumeration functions in the windows API like there is with threads and there's also limited open source tool cooling available as a result of that and there's no etw specific providers which a lot of EDI agents use that Target fiber",
        "specifically and you might be wondering are fibers actually being used well a quick Google search shows numerous pox",
        "on um GitHub that are all kind of Av evasion based that make use of fibers and a handful of blog posts too saying look if I use fibers instead of a straight up thread as my delivery mechanism it lowers my AV detection",
        "rates so what's the first technique well this is the overwhelming majority of those pox use this and it's basically just to execute your shell code directly using a fiber so like before we convert our thread to a fiber then we allocate some memory and store our Shell Code to it we can do this in any number of means but I've just put one example on the slide then we create our new fiber and Supply a pointer to our Shell Code and then when we're ready we could switch to fiber to switch the execution and our fibers shell code is executed",
        "symbol so what the advantag is of using this well we don't create any new threads um so we avoid conal callbacks For Thread generation events um we also avoid using thread specific apis that might be targeted by detection tools it's really really simple to implement and the remote fiber enumeration is particularly",
        "tricky the disadvantage is well we still need to allocate space for our Shell Code to store um and there's actually an artifact inside the thread information block which is inside the thread environment block a standard Windows data structure um known as a fiber data pointer so that could be potentially used as an artifact and on top of that um fibers in general are less common in thread so there's less space to hide the second technique is to use um fiber local storage callbacks and Define a malicious callback so like before we convert a thread to a fiber this time we allocate some Fiber local storage and we Supply a pointer to our evil callback then optionally we canly a",
        "parameter um to this callback uh that we've defined earlier and then we're ready to execute it we either delete the fiber exit thread or free that fiber local storage index and this triggers the execution of the callback on older versions of Windows um",
        "you also had a pointer to the Callback table in the process environment block so you could overwrite existing callbacks with your malicious",
        "callback now what the advantag is well the Callback table is hidden um on newer OS bills and the structure is undocumented so that's good in an attacker's perspective there's no artifacts in the standard Windows structure such as the thread environment block of the thread information block the payload could also be chunked up over multiple different callbacks so you could chain your exploit together um and separate that that exploit code out if you so desire um and the implementation is actually very trivial the disadvantage is if you're overwriting existing callbacks you need to be careful so you don't introduce instability into the application itself um and we still need to allocate some memory in order to Define our malicious callback",
        "and then finally the last open- Source technique is cool stack masking so when running a thread um and a fiber inside that thread um you'll only present the stack of the currently running fiber so when you're not executing malicious code say when your beacon or your payload is sleeping then you can switch to an innocent looking fiber with an innocent Co stack thereby masking it and this technique was actually implemented in cobal strike a couple of years ago and has subsequently been picked up by some open source pox",
        "too so why Co Stacks well edrs would traditionally collect data via user mode hooks on sensitive functions that are abused by malware um so in this instance we have ZW create far then they record the parameters that have been provided to them and see which process is actually accessing them um so attackers",
        "realized this and they started using direct cisal whereby you jump directly into the kernel and skip this hook um but as you can see um if we collect cor Stacks then we can clearly see this from a defensive aspect especially if that call into the kernels come from some unbacked region of memory that our Shell Code resides in and you can basically collect Co Stacks in three main ways you can do periodic scanning so taking a snapshot of all the current currently running threads and unwinding the stacks you can be more targeted so you only wanted to Target threads that are in a weight State I.E your sleeping beacons or you can do in line of event-based cool stack collection um so you'd have like a preexisting hook or kernel callback that records cor Stacks when an certain event on the operating system is triggered so how does it actually work um well we have fiber one with our malicious cool stack um we have fiber 2 with our clean innocent cool stack Fiber One calls switch to fiber when it wants to rest I.E our payload wants to sleep and this switches the two fibers so the innocent fiber is now swapped into the context of the running thread and this is where we sleep um when a memory scanner comes along does it like a periodic scan it reports hey we're clean no worries and the advantages of doing this is basically it protects against periodic and targeted scanning and on top of that it maintains legitimate Stacks so a lot of Stack spoofing techniques um will modify the core",
        "Stacks with gadgets and um and then you",
        "can detect that based on like horis STS to check to see if their Stacks are valid or not it doesn't apply here because the stacks remain valid throughout um also it's a lot more trivial to implement than traditional cool stack spoofing techniques and we're not using any apcs or sacrificial threads or suspending any threads to do this and on top of that it's a user mode concept so we're not going to generate any kernel callback events for it the disadvantages though is that we could Target fiber specific indicators so there's a couple of indicators the same T Flags field uh which is inside the thread environment block and we could also look for the start routine of fibers in the cool stack it also doesn't protect us against inline event-based cool stack collection depending on what our payload is doing if it triggers those and um if we can design a tool",
        "that enumerates DOR fibers are those that aren't in currently running then we can scan them and reveal the mask so one of those indicators uh the",
        "the fiber start routine um was actually highlighted in a MDC blog post as to how to potentially look for um sleeping beacons from Cobalt",
        "strike and last year I wrote a toour called weix when I dug into this topic um that looks to extract all of that fiber telemetry from memory including the dormant fibers and was able to detect all these techniques um I know of at least one EDR solution that now currently using this and imagine uh a few more have their own techniques built in but having dug into the internals of fibers I realized can we take this further can we expand on these techniques make them a little bit more sophisticated and crucially can we open up the use case as well so with that in mind I kind of built some Next Generation tooling",
        "the first tool I built was Phantom thread now this is an evolved method of coack masking that looks to address some of the weaknesses from the original technique by that it removes the ability of memory scanners to Target fibers specifically and in addition it also masks the dormant fiber as well as the currently executing",
        "fiber So to avoid being targeted we could masquerade as a thread um and to do that we look at that same T Flags field from earlier this is the os's way of distinguishing fibers from threads and it does that by flipping the fourth bit inside the convert thread to fiber API Coe um and this check is actually performed in the following fiber apis so knowing this what we can do we can temporarily patch that to that of a thread and then anytime we wish to call those fiber apis in our payload we can temporarily switch it back next we want to remove that fiber specific uh start routine from the stack um and basically that was what was highlighted in MTX blog post um but if you have a look um this is only present in fibers",
        "that have been created from the initial fiber so if we perform our sleep during our payload in the initial fiber created from the thread um then we maintain the thread start routine thereby avoiding um leaving the F fiber start routine present in the stack and then finally if we look to mask our dormant fiber in addition to our currently executing fibers because tools such as weix enumerate dorant fibers as well therefore revealing the mask so to do this we first create a dummy fiber using either a template or copying the existing running fiber then we patch the dummy fiber in place of malicious fiber when it's sleeping then when it scans it reports hey both the running fibers and the dorming fibers are clean after this we could either delete our malicious fiber and that's only if we want to run it way maybe a handful of times or we can restore it um and switch the execution back to it and then repeat the masking process again so when switching to a dummy fiber if we want to switch to this permanently we need to also pass a sanity check and that's based on this value known as the exord cookie value and basically to to do this we transplant that cookie and we regenerate it um and we copy it into our dummy fiber object so when we put this all together we get a a fiber that has the same T Flags fi to that of a thread we have no fiber start routines um in our cor stack and the malicious fiber object is masked in addition to the currently running fiber and the advantages of using this well we don't have any fiber artifacts so we can't be targeted specifically by a memory scanner we have valid cor Stacks um like",
        "before in addition we also have the dormant fiber masked and we also haven't created any sacrificial threads the disadvantage is is that we still don't protect ourselves against real-time coack collection if our payload is going to be triggering",
        "that the next up is dormant F uh poison",
        "fiber so every other technique I've spoken about thus far has been local to a process that you control what poison",
        "fiber does is it remotely targets processes that are making use of fibers and then injects into them and it does this by either injecting directly into a remote dormant fiber or by introducing a",
        "new malicious callback then it relies on the application that we've injected into to schedule our Shell Code for us so here we're going to cover how to remotely enumerate fibers then how to inject code directly into the dormant fibers and then following that how to inject malicious callbacks so how do we remotely enumerate fibers well first we identify",
        "threads um using fibers using that same T flag field from earlier so we take a snapshot of all the currently running threads and we interrogate that field we see if that fourth bit is set if it's set we can say hey this is currently running a fiber to pick out the dormant fibers um we want to look inside the the API that create fiber objects and we can see that there's consistency they always use an a requested block size heat block size of 530 heximal bytes so we take that and then we remotely enumerate um each heat block entry in a Target process and then we do that using the following steps if you're more interested in like the breakdown of that I put a QR code on the screen which takes you to the video where explain this a little bit further um but essentially what we do is we look at the PEB um remotely then we find the the number of heaps then we enumerate the Heap segments and then from there we get each Heap block and we look at the actual size and the unused bites to generate the requested size and with that we generate a list of potential fiber objects but that's annoying enough we can't just say based on this allocated size it could be anything else right um so we need to validate these fiber objects and within each fiber object you get this exord stack cookie that I mentioned earlier and this is made up of three Fields um fiber data which is also inside um the fiber object as well as a stack base um and then we have this third value known as the base P fiber cookie now this is a randomly generated value um that's created upon thread",
        "creation and what we can do is we can basically rearrange that equation that's used to generate um the EXO cookie to figure out this base P fiber value because this is the only value that we don't have um and once we know this value we can take the list of those Heap objects and we can compute an expected fiber data value from these Heap objects now if the expected fiber data value matches that of the actual fiber data value we can concur that this heat object does indeed contain a dormant",
        "fiber so now as an attacker we've gone through those steps we have the currently running fibers and the dormant fibers so let's start by injecting into those dormant fibers so a fiber object contains a context and this records the saved execution state of dormant fiber and",
        "inside this context is an instruction pointer um and what this does it points to a r which has the side effect of taking whatsoever off the top of the stack in that dormant fiber and then jumping to it therefore resuming um code execution so knowing this location",
        "um we can overwrite that providing there's enough space with our Shell Code um and then whenever this dormant fiber is switch to it will execute our Shell Code instead of the original dormant fiber code another method is via redirection",
        "so instead of overwriting that dormant fiber code we can allocate a new region of memory remotely and then push the address of this on top of that dormant fiber stack that way when a fiber is switched to it will execute our new region of memory first and then providing our Shell Code ends with a r it will return execution back to the legitimate fiber code and continually run the application as",
        "usual so the advantages of this um well we can now Target processes using fibers and inject into them remotely which we couldn't do before um there's also no need for us to trigger the execution because we just rely on the inherent switching of that application that we've injected into we're also not creating any new threads and then when we're overwriting fiber code we're actually not providing this enough space allocating remotely any new regions of memory we're just changing the permissions on that memory region now the disadvantage is um if we are looking at all threads across a system and we're taking a snapshot then that's potentially quite noisy so we need to bear that in mind also there's race conditions possible between the time which we inject our malicious uh fiber code and the time in which the application switches to that dormant fiber um and on top of that if we're overwriting existing fiber code and we're not cleaning it up afterwards then as soon as our Shell Code finishes executing we will introduce some sort of crash or exception handling um and when we're redirecting we still are remotely allocating memory um so we need to watch out for that too the next method is remote callback",
        "injection so first we need to collect the Callback table of the remote process that's using fibers and we do this through the fls data pointer that we found in our dormant fibers um and what this does it points to an entry in a w link list and one of these entries doesn't actually represent a fiber object instead it represents a glob fiber local storage struct and inside this struct is a pointer to the Callback table and the first field of this callback table defines the number of callbacks present and then the subsequent Fields will be either hardcoded values or values to",
        "pointers to fibers sorry pointers to fiber",
        "callbacks so what we can do we can either overwrite an existing callback with the address of our malicious",
        "callback or we could increase the size of this callback table and then append a new callback to the end of it and then whenever the associated index is freed the fiber is deleted or the thread itself exits what happens is",
        "there's a couple of functions inside entd which scan the Callback table and then execute our malicious Shell Code in inside the",
        "coolback and the advantages of this well",
        "our injected callback is actually cleaned up remotely by the application itself for us so we don't have to bother with cleanup um and if we're appending callbacks then um we're not overwriting any critical fiber local storage callbacks that may have been defined by the developer the disadvantages though is we",
        "need to know that fiber local storage is already present in that remote application which in most cases you'd assume it was but we can still check for this on top of that it's a one-time execution method only because the application as soon as it's triggered the Callback will clean it up um and if we are overwriting callbacks we need to be careful which callbacks we overwrite so we don't introduce instability or",
        "crashes and finally some conclusions and key takeaways",
        "so can we go further with these techniques um I think we can a little bit so for Phantom thread um we're not protected against inline cool stack collection so packaging it with say like",
        "another technique such as dll proxy loads and windows callbacks to make our Stacks look a little bit more legitimate might be a good idea and on top of that we could also encrypt that dormant fiber object that we've temporarily patched out for our dummy fiber um in case it gets scanned by like overall generic memory scanners for poison fiber um I think Improvement wise is to provide some builting cleanup capability so we're not introducing crashes if we're just overwriting directly that fiber code and by that I mean perhaps use something like a vector exception Handler that captures the crash and replaces it afterwards and resumes",
        "execution and finally some key takeaways well fibers can be used as an alternate execution and delivery mechanism for your payload um and you can use this to sidestep say some traditional Telemetry sources and horis sixs that are more inclined to Target threads um in the clean manner two well Fiber remote fiber",
        "injection is now possible thanks to poison fiber and that expands its use case to attackers and then three to prevent evasion techniques becoming in amongst",
        "themselves High Fidelity indicators it's important to remove the artifacts where possible and by that I mean we've removed those same typ flags and RTL user fiber start within phant Phantom",
        "thread so thanks very much for listening to my talk um the QR codes for the tool repos we toix the defensive tool is on the slide I'll be releasing a moral fiber over the next couple of days does anyone have any",
        "questions um I guess you could have a call back that",
        "replaces H good question no not easily",
        "um you you could do it in a roundabout way but you you probably be best off just overwriting several callbacks or appending several callbacks yeah because",
        "they only get executed when the thread gets deleted in some scenarios so you have the thread which stores those callbacks also",
        "exit all thank you very much cheers"
    ],
    "KtbeMz2UHN0": [
        "uh my topic is how to make huging face to hug warms and in this talk I will show some my experience on Discovery and exploiting unsafe pickle notes uh over",
        "the hugging phas especially to my knowledge the hugging phas is the largest pre large model hubs to date and",
        "uh I will uh show some security insights uh behind it uh who am I I'm from Sanai University and uh um my main job is do",
        "some research and teaching jobs in shanai and also um um bu hunting is a",
        "part of my research and uh I have my current research interest focus",
        "on the web and the AI security and uh uh",
        "in the past I just have published some uh research public ations in academic uh field but uh this is my first time to present some uh topics in the uh industry field and uh uh if you have interest to uh discover with me you can reach me out at my uh email account and uh the agenda for this talk uh I will first uh um brief some background of the huging F Hub and the uh picko model and then I will um show some the uh old know",
        "that uh the uh what is the pon not is unsafe and how to discover some um points of it and then I will dis uh elaborate on the details on how to exploit for the reverse rce uh remote code execution um by the P notes and uh also um the uh I think it is a very interesting part is how to bypass the Pinko and PCO uh scanning deployed in the hugging phas because the hugging phas has the full uh full knowledge that the p no is very dangerous and they launch PCO stand U PCO stand scanning in their website to avoid this kind of the sles and then uh I also go a step further to show you how to make our RC payload is vable that means we can um",
        "abuse the hugging face at the as a even weapon to um infect the pinkle",
        "worms from one hugging face account to another and uh uh we will uh utilize some the huging face official uh Commander line to do it and at the end I will show three case studies and the demo how we can do this kind of attacks okay let's begin the first uh huging face Hub and the Pico model",
        "uh maybe some of you have some experience to use the huging fub to get",
        "the prend models um because uh the AI is",
        "very a hard topic and you may find so many uh academic papers published is in",
        "the for example the AI icii and the authors May uh deploy",
        "their uh their models in hugging phase to sure across AI community and uh um",
        "but I don't understand uh whether you can uh deep understanding how the hugging face Hub works in the background",
        "and I split in uh the hugging face Hub into two parts one is uh the part the users can have the direct face that means you if you access the hugging face website you can find you can deploy the model repositories and you can Al deploy some your data sets and also uh the hugging face have also provided the space uh you can run your uh AI models",
        "in the space and uh let the uh users to access them directly and have the direct experience of that and also the hugging phase provide some apis uh that means you can integrate the hugging pH operations in your libraries and uh but",
        "if you go some uh um for the uh for uh go some in depth into the huging phase you can uh for example read the documentation in details you can find the huging face Hub is a open plantform and it integrates a wide range of third",
        "party libraries machine learning libraries into the hugging face Hub that means not all the uh not all the models running under the hugging pH hugging pH control um maybe you uh uh if you search",
        "the Hing face J Hub and you can find the Transformer it's the library deployed by the huging vase the diffusion deployed by the huging vase but there are many other um pent AI model libraries",
        "deployed maybe integrated in the hugging phase but not maintained by the hugging phase team so this is a very interesting point uh how the huging V Hub can assum",
        "can Ure all the third party libraries are safe enough okay and uh also if you see um if you have the experience on the AI model you can understand uh if you should uh transmit or share your uh prend models with others uh you may use the seral form mat and there are so many seral form mat supported by the hugging face uh the the PCO is one of them and there are many others for example the PLO paath and also the huging face suggested the all the others use the safe sensors but my topic is focused on the P okay this is the uh my focus on",
        "that but that not means the other format is safe enough for example we know the H5 has some unfixed CV numbers publicly",
        "and also the caros and the tensor flow format also have some the uh martial uh",
        "um distalization T also but my focus is",
        "on the Pio uh because it is introduced by the py and I think it is widely used in the AI community and uh uh I have uh give some uh basic idea uh I have background knowledge uh if you do not understand but if you understand you can ignore this part and how the PCO uh works and",
        "uh I copy from the uh tutorial uh in the website and uh this is just uh for some python objects and uh uh use the PCO it will transmit it to the B stream by the stream and why we should uh seriz this",
        "uh objects because we should trans uh transmit the data over the network or store in the database or store in some files and The Others May get this uh this data and to the theas to the object python objects to reuse this is the m purpose why we should introduce the python uh the the Pico and if we go into the uh go into the uh some details we can find uh for this one for this one is the Pinko uh is the Pinko bad stream and",
        "it is a a normal stream you can see that but uh the Pinko puzzle can pass it and",
        "uh uh translate it to the uh uh PCO op",
        "code and the stack like this way like this way and uh then they can reconstruct the stream back into the python object to use and what is the Val code if you go into the Python's native C python uh source code you can find um publicly uh",
        "in the public uh there are two no uh exploited points one is for the reduce and the other is for the set State I don't know why the the third one but you maybe if you read the source code you can find the third one but I just copy the publicly two no one points um for your reference here and uh uh the the issue is that um for this uh the serialization process",
        "they reuse some strings provided by the user as the function number as a function number python function number to execute the code so it may leads to the arbitrary code execution in these",
        "two um points",
        "okay and uh why the PCO distalization uh",
        "uh show the security issues to the AI community and uh we should back to the python because the pych implemented the torch load and the torch load implemented the p no inside and the P note we uh have the two deserialization",
        "attacks I show in the last slides and but the but this is a no one problem and when the P introduced the pickle lots",
        "and so many security um experts",
        "compliant and they have a uh very hard topic to debate and finally the P patched their code that means in my mind currently the P the page load is not valuable but uh if you argue uh there needs users to put some trust code development parameter uh to launch the protector it is another story and uh uh the solution the P Implement is the wet list models and you can see maybe and you can see the source code for the new um P's uh implementation",
        "a okay but the war is not at end end for",
        "the hugging phase because and the hugging phe integrated so many third party libraries in uh inside their um",
        "open planform and these libraries no the",
        "even the hugging pH cannot ensure they",
        "follow the secure coding for their implementation and uh the bad news is that so so many third party libraries",
        "use the raw Pinko loads P loads uh in their implementation not the uh p is a torch load",
        "okay and uh okay and U uh in my understanding in my understanding I think uh if the third party the third party labories use the torch load I think it is safe enough so I uh put it as the grein it's the this one is safe and uh uh if they use the raw P notes I think it's still on uh still uh still avable and uh also um as the open planform",
        "maintainer the huging pH also implemented the P scanning to avoid this kind of attacks and I call here is in the yellow color because I will show you some the Noel tricks to bypass this P scanning in my presentation later so I just put it in the yellow color not green not red okay",
        "and uh the next one I will show you how I discover the unsafe Pinko uh Lots it is uh uh before",
        "I uh before I show the unsafe pink Lots I will uh Define it what is the unsafe pinks because if you uh read some code and use the pinks and also the P save uh to read the memory uh the read the data from the memory or Ser the data uh store in the memory it is safe because it's a it's a loop in your memory not from the uh uh not from the user inputs and I Define the UN pink is that there is some um parameters under the there is the",
        "some parameters under the uh users true",
        "and the attackers canol so I I think this one this one um this function the converter mask for checkpoint where read a pinkle fire a pinkle fire uh and the fire name under the users control I defined it is unsafe um but if the p is unsafe not means it can be exploited from the huging face Hub the difference is that uh you can uh not image the users is very stupid it's very silly they will just read some pinkle fire and",
        "uh read in their code to do that so uh I Define what kind of the pink R can be exploited exploited by from the huging phas uh is uh if the uh if the victim",
        "users can follow the huging ph's official guideline official guideline to",
        "pre uh to fetch the pre-end uh model from the hugging phase Hub that means the users uh have no knowled what happens behind uh rather than uh just",
        "downloading some models uh and the one entry point is that if you uh have the experience to use huging phas you know uh there is a copy code okay there is a use in for example this is the Transformers library and the hugging phase is very friendly we get the uh beginners",
        "beginners to use the hugging pH and uh they have the demo code here and the demo code uh for every uh nearly nearly",
        "every uh third party libraries even the third party libraries you if you deploy the models in the hugging base you can have this kind of the demo code and this kind of demo code you can click it and L show the code here and the beginners will simply copy the code and to their",
        "uh to their local machine and execute them to fetch the models this is one of the explorable uh entry and the other is that um because some third party libraries is not uh well integrated in the huging phase and they have their all uh command lens and uh so the huging vase have some documentation uh to uh teach the users how to use them and this is uh the example code put on the huging faces Hub and I consider this is an the second chance we can uh uh we can get the user to be pitched okay okay and uh how to discover the unsafe pinco loss it is very easy you can just use some uh for example the patron or the other IDs and download the uh other libraries and you can search the picol and then you can quickly locate where the picol the RO picol is located and then you can analysis whether the user uh the function input the function input is under the user control or not if it is on the users control or read from some fires or read from some uh networks uh and then we can consider they unsafe but unsafe not means exploitable and for the exploitable and I just I just track or",
        "uh do some code review whether there is a coder pass from the for example the Hing face official uh pre uh from pre-trend function to the uh Lo uh pinkle load if there is a code pass uh for this we can consider they are exploitable and uh uh my results uh maybe uh this survey this code survey is conducted in the last no November and uh and in that time uh I just found 13 three integrated uh third party libraries integrated in the huging phase but currently maybe more because uh there's are continuously more libraries integrated into to the huging phase and uh I found I discovered 158 unsafe P",
        "loads uh from the from 15 libraries and",
        "uh also can confirm six are exploitable",
        "and uh uh before I show the uh real world examples I will uh show the Str",
        "model because how uh I Define the attacks can do and how we Define the victims uh can be attacked and here is example uh the attacker is a normal hugging face user they register uh account in the hugging phase and then they can deploy some uh model uh models in the hugging phase and uh they you just use the P to the hub function to upload their models to show",
        "across a communities and they also can claim oh I have a paper I Implement some paper published for example AI or II and",
        "um my implementation is very effective to uh to attract the users interest this is a pitching attack and the victim users uh are the other uh huging face um",
        "uh users and if they attracted by the attacker repple they were used from",
        "pre-end function provided by the huging pH to get to fetch to fetch the uh prent model and run in their local machines and uh uh the attackers can uh can embed some P loads P roads uh P files sorry P files in their malous model in the rle and if the victim users download them they are uh",
        "attacked okay uh we can see the a very simple R payload uh this is uh uh very simple because if you uh come back to the 2011 blackhead uh conference you can find uh find the original paper and uh I think everyone can write it simply but uh for for this code the huging face do not all it or uh",
        "can make some alerts to wake up the",
        "victim's adance oh they are unsafe they",
        "are unsafe and uh uh this to is the uh I just copy from the hugging face Hub and they we uh use the red color and to uh display all uh there are some unsafe P loads and please do not download L if you insisted to that you can take your own responsibility okay and uh okay the next one is how to bypass the pinkle scanning I will show you uh the current huging pH pinkle scanning is not safe enough it's not secure enough okay uh to discover the ways to",
        "bypassing we should first uh uh see uh how the pinkle scanning Works how the pinkle scanning works and uh we can see this way I just copy from the hugging face and uh you can find three colors one is the",
        "white one is the black one is the orange that means that means there are three list in the huging face pinkle scanning one is The Black List one is the white list but another is very interesting",
        "orang list okay and uh sorry uh for the white",
        "list for the black list for the orange list uh I think uh my demonstration is not comprehensive because I do not uh go through all the uh python function functions one by one to check what the Hing face pingle scanning Black List is or what lay white list is it is not a complete it is not complete sorry and you I just put some here for example for example uh but the interesting part is that if it is a w list no alert displayed if is if it is in The Blacklist there is an alert to wake up the you um",
        "users J that uh it is unsafe pinkle",
        "files but the interesting part is that if the functions are listed in the orang list",
        "the the hacking face only display the",
        "function the model name in the orange color but no alert but no alert this is the point we can exploit it later okay and uh I will show uh three maybe four maybe four um but uh uh I will show you first threeory and uh to bypass it is just a game for the hide and S okay the first one is adrenal one and uh I call it the code r because there is an orang functions and orang functions no were not trigger uh",
        "unsafe fire alert so we can reuse the orang function that means we can reuse the or function to do some malicious uh actions and it is the way that uh if I",
        "if we found some fre uh from pre trend from pre Trend function is uh can be exploited from on the hugging face Hub we can just uh deploy two uh hugging pH",
        "repositories one is uh uh embedded uh",
        "some some",
        "some one is just embedded some pickle fires but this pickle fires embedded some embedded uh the uh the pre uh from",
        "pre TR function inside and this from pre",
        "Trend uh functions we download the",
        "another reple we I I call it a be reple",
        "and for this reple they have some blacklisted uh functions inside okay and",
        "another way is that if we can also consider the original functions as the",
        "gauges gauges is very interesting because so many diser deserialization",
        "attacks uh use the gauges to uh G TR to",
        "uh achieve their targets and uh What uh how we Define the gadget the gget is the functions that um this function is orist",
        "but inside this function it will cause some Blacklist functions okay we call it the gadet the second one um the second one and the third uh one I think they are highly depends on which libraries you can uh use uh to launch this kind of attacks maybe there are more uh bypass tricks but you I think we should read more Source codes over the integrated third party libraries to find more and the second one uh the second one is I found from the uh I found from the uh huging face Transformer library",
        "and uh they use the regular TR uh regular travel regular travel model regular travel model and uh in this model they will read the config file the config file uh in the uh repositories the model repositories and uh in the config file uh interesting point is that",
        "uh it where R directed The download from",
        "current repository to another repository",
        "and we can deploy the malicious code malicious model in the back uh in the second in the backend repat this uh I call it the config abuse and the third one is",
        "more interesting because if we read some code you can find some um some thir party some model Library writers may use",
        "uh for example the base 164 to encode the PCO uh B stren and by this way and by this way the hugging face the Pinko scanning do not think this is the Pinko fire they just think it is some Bas uh base 164",
        "codes okay I call it the format in code",
        "and uh okay the next one I will show you",
        "some the warmable how to make our attack warmable make the",
        "warm and okay the r model it's ended this is thre model uh we just launched rce but",
        "if the r because RC we can run arbitary commands uh arbit commands that includes",
        "includes all the huging bases uh um",
        "command lines command lines and we can find someone and uh to let the victim",
        "users to push the same repository to the",
        "uh huging face again using the victim's huging pH accounts for this update and",
        "then make the warm in fact from one to",
        "one and uh the rable payload is very simple we can use the huging pH CLI and use the upload but the interesting part is that how we can make the warm infection continuously because if I deploy a warm in the hugging phase AC and someone is I call the first victim",
        "can download it and the second victim may not download my uh my worms they were downloaded",
        "first victims so we should make the uh warmable pads General enough that means",
        "every victims can be a um warm",
        "Source then we can read it in some details and we should keep this",
        "sorry this two ride the repple the rle name the re name yeah the re name the same that means uh the first victim the second victim all the victims may use the same repository names to uh make the warm infection and for the cage the cage pass the cage pass is that I use default one because if you do not additional configuration on your hugging face uh and L we for example in the huging face Transformer lay we in your home director",
        "cage director and there is a huging face director with the Hub and uh maybe some",
        "some argu if the users configure their all cage director no problem because we",
        "can run the RC we can run the AC you can just use the hugging face CLI download",
        "this function to download again the the",
        "malicious rle in some specified",
        "directory but my demonstration is just",
        "assume every default everything default but if some victims do not use the default director no problem and uh and",
        "for this one uh the the P the P St that means uh different Hing face user account had different usern name because my username is z BR and uh my simulated account is the P they are different so we can use the star to match them to match them we do not care about what is username and for the last one for this one that means when we make the warm infection we put everything to the",
        "trash no information displayed to the",
        "victims",
        "okay and this is a real world example okay uh in fact I have six demos and all",
        "deployed in my huging face user account zint and I have make their public uh",
        "yesterday night and if you are interested you can you can use it by yourself but uh uh I must let you know that uh they are all worms wors uh I",
        "just uh make them public for research purpose and please do not use them illegally if you use them and you should take the full responsibility for the for your abuse okay and uh okay I will show three demos here maybe time not the first one I found from the huging face Transformer the model is the reg retrial maybe the reg is very very hot topic because there",
        "are so many human human feedback reinforcement leing there uh to re uh to reinforce your uh pre-rain models and uh",
        "in this one",
        "um uh okay in this one I will",
        "use uh JP uh brand account to deploy my",
        "uh",
        "to deploy",
        "my my attacking repositories in the DP",
        "BR regular tral and uh uh I assume the",
        "victims follow the demo code to from pre-trend from the hugging face and then they will be infected and also execute",
        "some commands to uh toucha uh hack the",
        "fire in your local system and also uh upload upload uh upload the same",
        "repository uh to your all accounts to your all accounts and this is the code pass uh how I find them uh maybe it is very complicated but no problem you should just uh uh catch three points one what is the source the source is uh the uh the uh the function from the uh Hing face official uh Official Guidelines for example from uh pre-render from prodution function and the syn where the pickle Rod is called and also a injection point because uh the attackers have no way to additionally conu where",
        "we can inject the malicious pinkle in the exploited train so we should um we",
        "should make sure uh the existing code pipeline has to do that by for ourselves so we should locate where is the inting point that means which pinco files we",
        "should make their malicious okay and uh",
        "this is the backpath trick I use uh this one I use the trick two config abuse uh because the reg retrial uh use a legacy Ley pass to redirect uh the uh download",
        "uh the download of the download of malicious uh the download of pre model",
        "from the uh uh I call them the uh front end repository to the back end one to the backend one and uh uh by use this tricks we have display uh in white no",
        "alert also here I will show you the",
        "fource pingle scanning back pass check I call it long L and I think this is the implementation error in the uh huging face uh web site uh I reported to the huging phase but no response okay and uh you can see uh in the regular travel I have two injection points one is to the uh psgs uh w 100 uh PK and another is",
        "this one another is this one the name is too long and if you can see",
        "here for this one",
        "the huging face pinkle scanning cannnot detect it as a pinkle",
        "file okay and this is the",
        "demo uh I will uh uh because the time is limit okay and uh for this one I will",
        "show you how I will do that and uh for",
        "the uh this is my zp point regular tral and uh for this one you can see there is no",
        "okay okay we can just jump",
        "here and I have two account it's the D who is attacker and another one is the and three is the big team and uh if you can find here there is a p repository there is nothing here 404 and",
        "uh okay okay okay is the r me and then",
        "victims uh P just copy the demo code copy the demo",
        "code",
        "yes yeah here copy the demo code and the wrong in the uh in the aroco machine",
        "yes and here you can see the downloading the downloading from the hugging face",
        "Hub maybe I run some VPN in when I record this when I record this demo and there sometime but if you can directly connect to the hugging phas it be very fast okay and this is the downloading okay and there are some",
        "uh some",
        "uh War but is is not the uh critical",
        "sensitive uh because uh we can refine",
        "our pinkle fire to avoid them uh there is no any crash that means you can successfully download the pr model and run in your local machine",
        "okay and",
        "here we can find the hacked and hack two can illegally make and uh for this",
        "one yes I wait here uh if you should",
        "make the war infection you should log in on Hing F account with the red permission red permission to upload your uh huging face repository okay this is a PR requested and we can run",
        "again okay",
        "and in this one we can find",
        "here oh this a victim has the one infed",
        "in the account",
        "okay okay okay I will stop here and",
        "because the time is limit I will go quickly for the next okay the the second one is the uh pedal NLP for the AR tiny",
        "uh AR tiny uh model and uh the same is",
        "here and this is the Cod pass and uh here I just use the code reuse to bypass the PCO scanning P scanning and uh you can see I have reused three original functions one is the uh retrieval U retrieval and uh uh the second is oh the interesting one is that why we should use this one because uh because when I reuse the uh another from Pinko uh",
        "original function we found it is a python class member function if you call should call the python class member function from the pingle fire and it will automatically translate to call some the uh buildin builtin get attribute but the builtin functions are blacklisted by the uh by the pinkle scanning so we should for this case we should find another gadet another Gadget but lucky we can find it in the uh pedal NLP functions okay and this is demo I can ignore it and the uh the last one is the uh uh stable Baseline three overview and for this one I just uh uh uh implemented the uh format in code to the PCO bypass PCO scanning bypass okay and",
        "I can go quick and the take away the takeaway uh we have three participants in this uh in this uh uh uh security issue sorry and uh um you can see the different parts for example what Hing should do what the uh third party maintainers should do and what the end users can do um when I report the box to the hugging face to the hugging face their first response is that oh please do not use the P format you can just use the safe sensor but uh uh for the uh attackers uh for the uh victims they cannot to how the attackers use what kind of theats and for the uh some thir party mners they just think it is a supply chain attack you should ask the hugging face to launch the patch but unfortunately the hugging face think uh it is not my response for the end users they are the victims so uh for the hugging face they think everything is okay for the third party uh MERS they think it is the it is that's wrong by the users and for the end users I trust the model why you asking me okay I have some suggestions for the hugging phase make sure launch some strict protections and uh for the third party maintainers better to not use the safe P loads and for the end users I think uh the trust is not enough they may have some more um tools to launch the uh protection and this is the blackhead better sounds uh sorry for the late okay thank you very much"
    ],
    "NA77SFncppE": [
        "what I'm going to say uh what I'm going to say is is going to go very very fast there's a lot of material here uh basically what's going to happen is uh the first part in my dry runs the first part people uh get there's a lot of really really technical stuff you'll zone out uh but uh we're doing this for the residuals not not necessarily for the uh original presentation okay so everyone let's get started I think it's already started and I'm already uh okay I have a lot to get through time's going to be short I may run over time some of what I have to say is very Compact and abbreviated and some of what I have to say is important uh so I'm going to talk fast I apologize in advance that therefore I strongly recommend that you follow along with the text in the blue in the Blue Link at the bottom so let's begin uh let me start a little out with a little survey please raise your hand if you have used hexr Ido gidro or bony ninja so raise your hand if you've uh",
        "okay I see about 80% that's that's great uh keep your hands up keep your hands up for for me thank you uh now okay now how many have used any of those three to debug I mean to decompile python bite code to python Source text wow I actually I see hands up so uh I'd appreciate it afterwards you come talk to me because I don't know how to I don't know that it's done I for this talk I spoke to uh one of the founders of one of those to tools reverse engineer toolmakers and he confirmed or what he said was that all of the above kinds of decompiler tools that start from machine code are pretty bad when it comes to any interpreter that runs off of bik code okay now uh please raise your hand if you've used uh uncomp six or decompile 3 okay okay it's not zero",
        "but uh there are some uh and after this talk all of you will know a little bit more about these I'm the current maintainer and developer of unoma 6 and D compa 3 these are python programs that you can get from piie I'm sorry for my really bad choice of names of project names uh the page shows GitHub commit activity from 2012 to now 31 people will contributed to this open source project submitting one or two pull requests these are greatly appreciate appreciated and keep up the good work but what you see over the vast sea of time is that I've been working on this largely by myself my cont contributions are the bottom left the person who is ranked second and commits mstar he's to the right and I haven't heard from him in a little over seven years uh back in 2016 I started this project on GitHub from a tar of a copy of an from an archive from an obsolete version control system and in that at that time the code was had been abandoned for about 5 years uh this counts for the big gap that you see off to the left very few people really understood the code in 2018 I gave a talk at a python conference so you see a flurry of activity from 20 8 in the middle of the graph and this code works for python from the very first version in 1999 to 3.8 which is no longer current um 38 came on the scene a few years ago but it's still supported and in and still in use so uh since this code is old and larged and python compilers have gotten more sophisticated this code needs better technology to keep up with python so I forked the code I refactored it reduced its size and this accounts for the drop off that inactivity that you see on the far right of the graph from 2021 to now uh the fort code goes under the name decompile 3 it only handles python 37 and 38 uh a little fun fact on the extreme right you'll see a tiny uptick and activity and that's me working on the code in preparation for this talk uh there's a moral uh of that but I'll you can talk to me about this later unfortunately even the changes uh to decompile 3 weren't aggressive enough to track changes to python bite code and the Python language therefore I have an experimental decompiler for python 38 to 310 towards the end of the talk I'll show a little bit of that okay so who am I uh that's me in the photo in this cartoon down at the bottom of of the tower uh except I live in New York City and I've been doing open source work since 2000 and when not doing my day job I do open source software but I'm retired now so I spend more time on this okay in general the code I've written has had plenty of time to spread around so if you have software installed that matches any of the logos on the first line then you have code that I've written uh I don't have any cool logos for the software I'm going to be talking about today but the software of the logos on the left use a CD reading Library called live CDO I started that in 2000 and I still maintain it in fact I have a vulnerability that I need to fix when I get back to New York City uh I'm interested in other things like an open source Mathematica and debuggers most of the software I've written is GPL and I'm a member of the free software Foundation but enough about me let's get on to the topic at hand uh highle bik code is attractive for malware Riders because it's portable comat uh Compact and impervious to standard uh general purpose analysis tools a while back a couple people from Microsoft cont contacted me regarding maare botnet that was active active on Microsoft Windows",
        "um the malware was written in Python 27 as I mentioned before the standard analysis tools like x-rays or gindra were of no use to them um this and the Situation's been getting worse languages that use highle bite code is not decreasing the Python language and bite code continues to change Python's generated bite code has become more complex and harder to decompile okay decompilers have been around since the dawn of programming languages in the early 1960s uh however the ideas uh that I'm going to present are somewhat new or little used and they represent my own personal research uh the seeds of these ideas were buried back in code going back 24 years as I've said the code was abandoned for 5 years before I came across it and it took me a while to distill correct and expand upon the ideas in the code and I'm not even sure I have a final word on this today there's Theory and academic research uh yeah there's Theory and academic research and what I call general purpose decompilers these are programs that convert pseudo machine C that convert machine code into pseudo source code uh",
        "usually the resulting language is not something that you can run directly through a compiler",
        "uh let's see okay",
        "uh okay there are systematic methods and tools for compiler construction these are just some of the books that you can find on amazon.com I'm sorry the images are not larger but here's a summary of them from left to right uh some of these have gone through uh several additions over the decades uh some come in several variations based on which programming language the books compiler algorithms are written in some specialize for particular Source or Target language or particular CPU architecture or for particular operating system some are aimed at writing interpreters While others are aimed at Advanced compiler technology and finally some of them are no longer in print because compiler writing technology has evolved over time the point here is that uh this is a well trodden field okay but none of the books that in that last slide mentioned decompiler as far as I know so how about books on decompilers on writing decompilers okay uh for writing uh",
        "decompiler construction these are the only two that I can find both are about a decade old neither is is completely devoted to decompilers and neither has gone through more than one addition uh but compilers and bite code that are Co covered by these books I'm sure that those have changed in 10 in the last 10 years uh the topic on how to write a decompiler is about as rich and deep and involved as a subject of how to write a compiler in fact at core a decompiler is a cognitive compiler both take code expressed in one language and translate it into equivalent code in another language conventional wisdom however needs to be adapted and you'll get a small sense of this in this talk okay because of the need for but scarcity of decompilers AI might seem like a possible way to get high Lev information from machine code and for this talk I recently looked at two python decompilers that use machine learning so can AI save the day uh well no not yet however if you're interested in how to fix this I can share my ideas afterwards okay uh so why am I here why am I giving this talk uh I that general purpose decompilers found in gidra binary ninja or hex-rays are of little to no use for bite code languages in fact I've been trying to raise awareness of bite code decompilation as its own thing uh and that's one a big reason I'm here as I've come to understand bite code decompilation works very differently from general purpose deom decompilation",
        "and adding the modifier general purpose is my terminology right now this distinction is not widely AC accepted a couple years ago to raise awareness I started a discussion in the Wikipedia talk section for decompilers unfortunately there's been no uh there hasn't been much discussion or moving on this okay that's raise awareness uh I'll soon uh describe the decompilation pro process and I will introduce a rarely used if not entirely new approach to decompilation I treat decompilation as a human language translation problem in some ways it can be like uh the kind of thing that Google translate does okay but uh uh the process will go through also follows a pattern similar to the processes used by most compiler front ends including the py the compiler for python uh it is described in all of those compiler books that I showed images before and I'm going to show this adapted to form decompilation and I think this kind of adaption that I'm showing you it can be extended to create decompilers for other highle B code at a more technical level I hope you understand the phases of decompilation at least for these decompilers and this can be useful in submitting bug reports or fixing bugs and there were a couple people who have used this uh a common misconception that I see on reverse engineering forms is the confusion between decompilation and disassembly as we go through the process I think the differences will be clear uh for those of you who are familiar with machine code I think you'll appreciate how high Lev bite code is very different from machine code and finally I think you'll get some ideas of the things that decompilers can do and cannot do not only in Python but in other similar programming languages okay but before I get too deep into de compilation I should say something about what it is briefly decompilation starts out with machine code or B code AS input and produces Source text as output in this slide we have some python okay so where's the bikon come in that gets introduced in a second but let me first start out with some Basics that go on when you run a Python program and I'm going to show use this simple program in the examples later the program prints the output um of calling a function named five uh okay okay I run the code",
        "and using the python interpreter which is called cpython and we get the expected output five and when I do this under the cover python translate or compiles the program into an intermediate form called bite code and it interprets that internal form uh in this case uh that b code in this particular case that bite code stays internal it's not written out to disk okay uh here are the bite code bytes for that main routine uh here's what these instruction what the when you decoda what the instructions do uh they call for the cre of a function five in an interpreted language there is no Linker loader like you have for statically compiled languages handled by general purpose analysis tools instead this kind of thing is done at runtime after linking in function five into the main program the five function is called and then uh finally the oh and the function return value is then passed to the built-in print function which displays the oper shown okay that's that was tedious but the in the instructions for doing all of that that I just said it only takes up 25 bytes uh for those of you who are familiar with machine code 25 bytes to do all that is like really awesome okay there are metadata sections that are in the bite code and that adds a bit of space too I haven't shown that but we'll see some of this a bit later as I said The Interpreter doesn't run the source Tex directly but it runs by code so one implication of this is that the source Tech doesn't need to exist after by code compilation is done for certain kinds of source text called modules the internal bite code is written to dis automatically however we can force by code to get R into disk using a standard python Library routine called compile all the compile all module okay uh that that's the invocation a b code file is a python code object which is serialized and then written out to disk using uh the standard python Library function called uh Marshall uh there's a little bit of extra data added and like the source text Source text file name and the by code version the short name of this file here is 5.",
        "cpython 38. pyc and that's a mouthful um",
        "the file extension of the Spy code usually ends in pyc as it is here or sometimes pyo and now that we have this spy code object I can just run the bite code uh go there it is sorry uh and we",
        "get five again woohoo okay uh go on with",
        "this introduction we can now do our our first python decompilation using uncomp 6 the simplest in uh invocation is uncomp 6 with a bite code file name this is what we created in the last slide okay these lines in Orange that start with sharper comments the section at the top contains a little bit of metadata that I mentioned before which is stored in the bite code file it is not part of the 25 byte instruction sequence that we saw in HEX before okay each bite code has a unique number for the Bode variant here the uh that number is 3413 and this variant covers python 3.8 major releases of python typically can alter the programming language Andor the bik code Andor the way the source text gets translated into the B code uh python B code varies more than any other B code that I've ever encountered so when you find um a tool or read a Blog about python B code some of the ideas might be only relevant for a small number of versions around the time that the tool was developed or when the blog was written the drift and by code from the very first released in 1996 in the most recent versions is about as dramatic as a drift from Latin into Italian except that drift happens much quicker okay",
        "uh let's go back uh okay although the",
        "name of the bite code is five move that's seen in white at the top the name of the Python file that contained the source is 5py and that's even in Orange Meda data a little down from the top uh something",
        "is yeah okay",
        "uh as you can see here the source text and the decompile code are uh pretty much the same people are used to general purpose de compilers such as the one for gidra or hex-rays are usually amazed at how two how close the two are and this is one facet of high level bite code a lot of source information like variable names along with their types and is preserved inside the bite code okay the main differences between the two are the comments produced the comments from the source program on the left don't appear anywhere in the reconstructed result and that's because the comments just don't appear anywhere in B code line 11 on the light line 11 on the left doesn't appear anywhere on the right uh one of the thing that these decompilers do to increase the likelihood of getting exact Source text is that they make an attempt to format in the same way that the standard uh format is for python work we're more careful about this than other python DEC compilers but we don't always get the formatting exactly the same uh now that we've got an example of python decompilation we show how our decompilers work and with this you can follow along the decompilers thought process one of the unique features of these decompilers is that we provide a means for following along the decompilation process machine language",
        "decompilers even though they have a language Affinity like we have they currently have no way to provide this level of detail okay ourd compilers go through five phases the idea of running through fa through phases or or constructing a pipeline is also how most compilers work the phases are uh get by code disassembly using exus exus is a cross disassembly library that I wrote to support these de compilers however it is also useful in other projects that work with python uh by code okay tokenize the disassembly",
        "tokenize is an compiler compiler Centric term uh in other decompilers and code analysis tools uh this process is sometimes called lifting as in lifting the disassembly or lifting the machine code uh pars yeah pars the tree into a parse tokens into a pars stre uh abstract the pars Stree into an abstract syntax tree and finally uh produce the source from the abstract syntax tree and don't worry if you don't understand the above steps I will go over each step in more detail soon uh the scanning and parsing phases in the second and third steps are similar to the beginning steps that compilers Ed to produce code and this is the part that is different from decompilers that from from uh uh these",
        "decompilers from other than from other decompilers okay the first step in decompilation is carving B code byes into instructions uh here I'll use the bite code file that we generated earlier as input and for demonstration purposes I'll use a standalone program called p dis ASM from the cross version disassembler package uh okay first you'll see that again there are comments in Orange at top again this is metadata about the bite code uh okay in fact this particular metadata is exactly the same for example the version of B code that we have here in the first highlighted line is the same as before 3413 okay now we get to the actual V code instructions okay I'll go into this more detail later but the main thing to note here is that the first two instructions uh come from line one of the Python Source text line one is indicated by one colon in white to the left and in the part that's grayed out below the one colon you may see a six colon but that's because the source text uh that's the beginning of source text for line six each by code instruction contains of an operation name in blue for example load constant or store name the operation name is followed by an optional operand these are listed in parenthesis okay in the left panel you see instructions that result from decoding bite code from a library routine Ed from the exus Pates because the the compiler doesn't call the command line routine but instead a library API it has a disassembly structure on the left we're showing the print representation of that structure and this is happens to be the same output from the command line utility uh but from this this disassembly structure we need to massage and repackage the information to put in the form for parser input and this is shown in the right panel uh even though these two look almost the same internally they different structures on the left is again is output from phase one and on the right is parser input to phase two and parsing will be coming up the next slide oops",
        "uh input to the uh parser is a stream of tokens uh token is a standard uh compiler term for the input atoms that are fit into the parser a token is based on the operation name in blue okay uh",
        "and sometimes the operation name and the token name are the same however the Opera the field the the the field in green to the right sometimes has parts of it folded into the token name and here are examples of this okay there there's a good these are examples in the first instruction load cost is at offset zero offset numbers are in purple uh the load const operation is a uh the load op the load con load constant operation at both offset 0 and six have been specialized on the on the right to load string in general a load constant operation can be any python constant literal like Boolean Valu is true or false or maybe a couple of uh of string time zone names okay this aspect shows another difference between bite code and machine code in machine code the instruction operators are register values uh which can be numbers addresses or parts of addresses in Python B code the oper are arbitrary objects uh the other operation that name that is different from the corresponding token name is make function and you see that in purple uh at offset 8 towards the bottom it gets a suffix added to the name and becomes make function undor 0 zero is the bite code encoded way to indicate that a function signature for this function doesn't take any parameters the instruction sequence leading up to make function would change depending on the number of parameters that of the that the function takes so a parser needs this rough parameter information uh to be able to match the sequence of instructions that lead up to make function okay in the last slide we just showed the first two phases which turn bite code byes into bite code instructions uh and then a stream of tokens the next phas is scanning and parsing will be coming up next and it'll look familiar if you've developed compilers but I suspect nobody that's a niche Mark and I suspect nobody here uh knows anything about how about uh developing compilers uh if things go too quickly um I uh you may find some of this explained in more detail in one of the 40 books uh on amazon.com that I showed before uh to simplify we'll focus on just the source text on the very first line the companion materials have full output for all the lines of all the phases but even though this is a small part of the code it covers all the basic concepts very well in order to run it helps to walk first so let's start out with the first line of the Python program it was just a simple python dock string shown in green at the top and let's start out with the first instruction",
        "uh of course most Pyon Expressions require more than one instruction to represent them in by code oh sorry sorry sorry uh so note that note that we we just have the token named load string the value the string value isn't relevant in parsing that one instruction all by itself is the complete representation in by code for a particular python expression it would be uh what what you would get if you typed uh uh the literal string expression black hat Asia example and that was the only thing in the program okay for those of you who are who are familiar with programming language system um that compiled to M machine code again this is pretty strange in machine code you rarely have one instruction covering One Source Code expression and again that's what makes this High Lev B code uh of course most po uh the most python Expressions require more than one expression to to represent them in by code okay because Lo string is a complete expression uh the parser matches that single token and emits a quote unquote grammar reduction rule this is the expert colon colon load string that you see here and this line is written in Backus now form you'll see this notation in P both Python's grammar specification and it's abstract syntax Street specification more generally this is the way syntax is specified in most programming languages but for the decompilers that I've written they also use grammars to do their work and this is one of about 50 or so grammar rules for de calling python 38 the word at the right of the right of the colon colon equals is called a grammar symbol the colon colon equals is pronounced transforms into because ex the gra expert grammar symbol can transform into load string the a load string token but since we're really working bottom up or token up uh the parcel recognizes reduction possibility only after the fact so the recognition is really from right to left uh or alternity from token or set stream of tokens into a grammar symbol okay uh performing this reduction",
        "rule the parser creates a simple okay so that's oh yes uh so performing this reduction rule the procor creates a simple tree created with the exper grammar symbol in yellow as the root of this tree and the load string token in blue as a single Char so let's continue uh here's I've just I've copied what we had before now let's get to the second by code instruction a store name instruction is one of the kinds of tokens uh that form a store grammar symbol uh okay so there we go although you won't find a store grammar symbol in a grammar for python you will find store with a capital S appearing in Python's a doc documentation xer with a capital E also appears in Python's a when possible we try to use the grammar symbol names that have uh that are similar to the names that Python's a uses overall the two grammars have similarities uh at the top of the tree but they have to be different at the bottom if instead of store name we had a store Global uh token that would be another kind of instruction in the class of store grammar of quotequote store grammar symbols okay to put this in terms that may be more familiar in English think about how a noun might be one of many words like by car or bus and let's say store store name is like bike while store Global is more like car uh as far as a sentence goes both bikes and cars are nouns noun is a grammar symbol that they both belong to the grammatical structure of a sentence doesn't change whether you replace bike or bike for car or even bus in any sentence okay to recap we've now encountered two reduction rules these are the lines in yellow uh after the second reduction rule has been encountered the little graph that the parser is building up on the side looks like this okay so now we have two little trees and let's continue the parsers match exp stor grammar symbols and buil two trees from them so uh after finishing the store reduction rule the parser now notices we have expert and store grammar symbols in succession the grammar that I wrote for the decompilers dictate that when these two are seen in succession that constitutes an assignment statement so yet another rule triggers okay and uh these are the two trees that we had before joined okay to recap we have we matched an assignment statement uh continuing an assignment statement is a kind of statement and we have a grammar rule to indicate that uh notice that after seeing the second store name in Blue from early on we kicked off a flurry of reduction rules the lines that start in yellow this kind of thing happen happens in bottomup Parts is when you get to the end of the token stream it is like a detective story where after the last couple of pages all the loose fragments and the mysteries of the entire book are finally uh wrapped up and the person who wants to his code decompiled gives cheers okay so here's Here's the final tree uh and so now let's see how this is shown in ASI output this is the ASI representation from the graph uh in the last slide it shows more information shown in the graph but that is because we're also showing token attrib in addition to token names uh okay uh for example we now see the instruction offset we see instruction offsets and operand values okay this is great uh but recall that we didn't have an assignment statement at the top of the source test instead what we had was a dock string however doc strings are implemented in Python using a spe this special kind of assignment uh to a string variable of that funny name called doc okay so where does this get it to change into something more familiar I am glad you asked because this BEC comes from the next phase okay phase four takes the parts tree that we just created and transforms that into an abstract syntax tree we look for tree patterns of this kind of special kind of assignement and when something when the process finds something of interest that matches that part of the tree is replaced in a sense we are abstracting the specifics that we found into something more the way a python programmer wrote the program strictly speaking we don't have to do this here and sometimes this this kind of thing can be a difference between re the reconstructed and original Source text however if you find a python Source text that looks a little screwy or isn't even valid python what may be going on is that this kind of transformation isn't being detected and I see this happen in another python decom a lot notice that we've simplified the tree as well we no longer have a grammar symbols expert and store uh what we we could have tried to detect doc strings earlier but that would have been Messier and finally we get to the actual Source text remember the sour anybody remember okay uh the source text is why we were doing all of this uh the source text is created by traversing the a uh calling routin based on the name of the grammar symbol and here the grammar symbol of interest is called is Doc string in yellow uh okay to simplify the conversion of the as into a source string uh there's a custom uh domain specific language or DSL that's used this DSL is described in the project Wiki okay you've now finally successfully completed the first part of the talk which gives an overview and uh I I'm I'm going to go on but there's nobody afterwards and um you know we",
        "just I'm I'm so I'm sorry uh okay so so some of you if you're not familiar with how compiler front ends work this this first part last part might have been a little bit intense so relax okay that's enough time because I'm over time and because what's coming up may be uh even rougher uh I next go over to disassembly in a little more detail and introduce a new idea for python de compilers unfortunately that's the stuff that's most important but I had to get go through all this material because folks here uh have to explain compilers okay so this so the next stuff uses some Advanced compiler technology I'm going to uh but first i'm going to focus on a little on disassembly for one important reason there aren't good decompilers for the most recent python versions and that's likely to continue forever so the reality is that you may have to understand by code malware from a disassembly listing there's a disassembler in the standard python Library called D most novice D compilers use this is the first thing that comes to mind but that has some serious limitations the biggest limitation is that it can only disassemble code for a single python version the version that running the decompiler if you're running the latest version of python such as 312 but the B code you want to analyze is from an earlier version like B code 27 then you're out of luck malware written in Python tends to use older versions of python and this was the situation when micr Microsoft folks contacted me to get on this limitation UNC compile six and three uh decompile 3 mentioned xus which stands for cross python disassembler uh that package uh comes with a disassembler on steroids and I'm going to show that briefly uh in yellow are command line options that I use okay in yellow that's xus and then in yellow are the command line options that I use for this indication it's a basic interpretation of sequence of instructions showing the actual bite code and the ability to intermingle The Source text with assembly in Reverse uring most of the time you'll not have the source text there's of course no harm for asking for the source text when it doesn't exist so now let's look at the output uh the top of the disassembly output uh is so again uh there's some metadata in orange I went into this earlier so I've highlighted that in the slide okay a piece of metadata that",
        "uh uh this is piece of medor",
        "shoot uh piece of Med we saw implicitly before was this value from the constant table uh the first instruction at purple offset zero is load const the string oper string operating for this instruction came from index zero of this constant table now let's compare the assembly instructions if you're familiar with Python's dis out but this is similar uh okay but there are there are some differences and you'll see them soon um okay first there in green there's the",
        "there's a source code that's a python doc string okay uh below that in white we have between vertical bars the actual white code values uh uh okay uh and",
        "that's seen in the top in HEX the first bite of the first instruction is 64 this is the op code in Python 38 for L cons the operand value zero but zero again is an index into the orange constant table above okay in the second instruction we see something interesting happening off to the far right after this is parenthesized the operan value dock in green so there's this additional text that says it's an assignment statement that starts in white doc equals black hat Asia example okay uh here what the disassembler has done is describ the combined effect of the first two lines as I mentioned before this is how python implements do strings okay here is a much more complicated example uh the companion materials show more detail but and I don't get confused between disassembly and decompilation even though there's some higher level interpretation what we have here is disassembly uh internals of The Interpreter are exposed for example top of stack or toss seals refers to the how The Interpreter works and pop the pop top instruction which is grayed out just below the last call function had has no corresponding meaning in the source code this assembly is easy and straightforward decompilation is hard however decompilation usually starts out with disassembly okay however ever awesome the disassembler uh uh shown in the last slide it does have some limitation and here's an example of something that the dissembler can't reconstruct while the disassembler is great with code that doesn't have jumps in it uh okay once we have jumps like the highlighted instruction the disassembler has to stop combining instructions with each new python release decompilation of control flow has become increasingly more difficult nowadays about a third of the issues are raised in the compiler bug trackers are related to control flow uh grammars and the grammar based approach that we use however handle parsing nested sequences of control structures quite well if you mark them up so having a methodical way to characterize control flow that fits into decompiling um can give more precision and more accuracy that is just not available in general purpose decompilers I won't say much about how UNC compile 6 and decompile 3 handle difficulties in VOR rizing control flow instead I'll be using an approach in an experimental decompiler that I'm working on now below is the as for this experimental decompiler okay the tokens in white that that start BB start BBN sibling blocks block and join are pseudo tokens that get inserted by a special control flow process that I'll show briefly next by the end of the next slides I hope you understand a little bit about basic blocks that you see in Orange BB in the token name is an abbreviation for basic block I hope you get some idea of what sibling and join mean in the token names and what Dominator means that's in the orange operand in the very last line okay now let's consider this python simple Python program to count the one bits and a in an inure uh if you're interested in algorithms this you might find this Co code cool and interesting but the only thing that concerns us when thinking about control flow is that is a program with the following characteristics nested inside the main body is a while loop there it is not nested inside the while loop uh there's an if then else statement and there's one more nesting level which is the else then and else parts of the if here we have more than one item in at the same nesting level even though the two blocks are at the same nesting level the two blocks are distinct and separate in some programming languages like Java or JavaScript variables declared in each block will be in different Scopes what we want to do to make parsing easier is detect the nesting level or more precisely the scope we want to Mark scope boundaries inside the instruction sequence and that brings us to the orange comments these capture what I just said they Mark scope boundaries but I'm doing this in the source text rather than the B code instruction sequence now suppose instead of the orange Comet we had the word Dominator uh so in the words that have dominator in them okay suppose those were non- branching instructions to get to any instruction that in the same scope or nested scope uh you have to pass through that Dominator instruction it acts as a gatekeeper for the group of instructions okay similarly in order to get to any instruction in the same scope or nested scope that follows you'd have to pass through one of the matching one of the comments that says join in it so now let's look at how the python interpreter seizings this is control flow Reconstruction from the bite code instruction this graph does come from a program called uh the python control",
        "flow project I created this project to per more accurate and faster decompilation of python control flow structures however this project can be used in other kinds of by code control flow analysis instructions are uh or sequence of instructions are broken into basic blocks a basic block is straight line code if there's a jump to any instruction in that block of instruction it has to be to the first instruction and if a block contains any jumping instruction there can only be one it and it's the last instruction so the first instruction acts as a choke point or a dominator that you have to go through to get to any of the other instructions in the basic block I don't have time to describe in the text boxes what the colors and the line Styles mean on the arrows for that you have to look in the companion materials okay here we have the control flow graph from before but now altered to show Dominator regions and dominators okay uh and this this graph comes out of a later phase of the control flow project there's a lot going on here that I just don't have time to explain so see companion materials for this but let me introduce two important terms Dominator region and Dominator the easiest term to explain is dominated region this is just another term for scope describing when uh this is another term for scope that we saw when showing the source code but it is a property that is computed on a graph it's a okay or more precisely a control flow graph like this this property is used quite a bit in compiler data flow analysis so C books on Advanced compiler optimization for algorithms for how you can get this information what does the Dominator part of Dominator region mean we kind of alluded to this before if something something dominates if it acts as a gatekeeper so uh an instruction like the first instruction of a basic block dominates other other instruction in that basic block but similarly a dominator block dominates other other",
        "blocks if you must pass through that block in order to get to the other blocks that are nested or at the same scope okay the darker color a block is the more nested it is inside other block regions so block 3 is nested or dominated inside uh block regions two and one Dominator blocks have that 3D block uh uh box or shape uh the upside down house shape shows a joint point and which is the exit of a dominated region uh this is where the scope ends companian materials give a fuller explanation I'm really sorry this this one slide if you're taking pictures this is the slide to take a picture of um so I'm sorry I'm talking fast and glossing over details this slide was was my motivation for giving this stock and I'm already over time because I have to give all this background oops",
        "uh okay uh the darker the color a block is okay so I so uh what what I want to show here is how you can show uh nesting uh so how in an automated way you can show nesting and block scope and the differences between alternation and uh in at the at the instruction level and so those wacky pseudo tokens that I showed uh briefly in that chain comparison example those those are used to compare compare the these kinds of Concepts in a way that a parser can understand and match okay now that I've given a worldwind tour of bode decompilation for these python decompilers let me back up and put this in place okay uh there are other decomil for python they all start out with disassembly even the one that I looked for uh that uses machine learning uh many build a tree more or less based on the instructions from a disassembly and they all Produce Source text from the internal trius structure however they are a bit more ad hoc none of them uses the grammar based approach here the phases are fewer and a little less distinct okay general purpose de compilers like you find in gidra are largely different they live in a more complicated world to be able to do things across a wide spectrum of machine languages and a wide spectrum of programming langu is they have to give up on noticing any specific packet patterns of instructions like we showed in the chain comparison example the ability to match specific patterns is what makes these decompilers produce extremely intuitive and accurate results written in the programming language that the source code text was written in okay control flow in general purpose decompiles that is its own can phase and that phase doesn't to take to account the specific Target programming language that produce the code or the specific set of control flows that are in that Source uh code in that Source language our control flow is intimately tied with a control flow for a particular python version python has an extremely rich uh set of control flow structures I know of no canned control flow detection mechanism that would be able to to cover all control flow mechanisms that python includes such as else Clauses on while four and tribal blocks okay our approach",
        "uses tokenization to facil at parsing this is similar to the lift phase in a general purpose in general purpose decompilers in general purpose decompilers the lifting language is sometimes to llvm or an llvm like language in Python our Intermediate Language is very much tied to python B code in general that is true for all highle uh bite code decompilers their intermediate code looks pretty much like the highle B code if there is an Intermediate Language uh also that Intermediate Language drifts over time along with the language and the B code okay I've shown two how the two and best the most popular decomposers work of course these have bugs in them but by understanding how they work hopefully you may be able to understand pinpoint and Report bugs bugger or even fix problems begin to understand python by code in general and how the source text and the bite code are related uh extend this code for newer or unsupported bite code uh use these techniques to write a decompiler for other programming language such as ethereum solidity Lua Ruby or various lists just to name a few uh for the bik code that you may be interested there may not be a decompiler available yet uh hopefully with this information in a position to write one okay now we get to my favorite part way over uh but this is my favorite part um I'm just going to say the names uh so John aot and Hartwood gole they wrote the version uh in you know Circa uh 2000",
        "and the and and the banded it um but very very important blackhead Asia reviewers and organizers I greatly appreciate them giving me this opportunity to to uh present this topic which I personally think is very important because I said there are no general purpose tools for writing um like G hex for for any for high level B code language uh I want to thank uh Phil Young and the speaker coaching program you know Phil if hi Phil thank you uh uh",
        "Lydia uh Juliano uh who who organizes",
        "the speak coaching program I mean as bad as this is I it would be a lot worse um without them uh Hui in AV uh helped me",
        "out uh and and the folks folks down there I mean I I appreciate all that uh steuart Frankle turn did some editing on this and turned this to English to the extent this is this is English uh Christina is also great in in organizing and also thank you all for uh you know listening uh and with this I hope you do great stuff in the future this is all the additional material um uh okay uh",
        "I'll show this little cartoon uh but that this is this uh does does anybody in the audience know who the little guy is what the name of the little guy is nobody it's my name Rocky okay uh he was a flying squirrel and uh there you go thank uh but let me let me go back to that thank you all I'll take I'll take comments in the"
    ],
    "em9qgHm3uIk": [
        "uh hello everyone and welcome to my talk uh game of cross catch let's win it in a more effective way and in this presentation I will talk about how to solve challenges uh in Cross catch attack and perform cause catch attack more efficiently and my name is l you can follow me on Twitter and I am the author of dirty page table and in this talk I will use dirty page table again to to exploit a mpu back on samung",
        "device and here is the agenda of the talk I will briefly introduce the cross catch teack uh followed by highlighting two challenges in it uh next I will delve into the most important part of this presentation uh using a specific vulnerability as an example to analyze how to address the two challenges in uh cross catch Tech then I will demonstrate",
        "how to exploit thei UF with the dir page table on Samsung device uh finally I will make a summary uh first of all let's take a look at the cross catch attack here is a simple example of uef and we can trigger the uef to get the victim object a and then we can reclaim the Vic victim slab to page allocator after that we can let kmap catch B uh reuse the pages of victim SLB by doing this uh we can make victim object a to be reallocated as object B",
        "now uh if we perform operations on victim object a uh we will corrupt object B following this we can make use of uh corrupted object B to get root",
        "this is a s simplified process for cross catch attack uh in in a more General context object a or object B can also be pages or other types of memory",
        "regions uh as we can see that uh cross catch attack is getting really popular there are a few Reon reasons uh first a original vulner vulnerable object is not",
        "exploitable uh sometimes so we have to use cross catch attack second uh by cross catch attack we can transform the unknown vulnerability to well no one to simplify the exploitation third with help of cross catch attack we can build data only exploitation techniques to defeat growing mitigations for example here are some widely used exploitation techniques based on the cross catch attack uh well uh cross catch attack is known as an unstable technique because it involves many steps and each of them may introduce some uncertainty so we start to think are there some methods to make the entire process less unstable or in other words more efficient actually uh this is the the most important reason why I start I want to delve into Coss catch attack attacks and started this",
        "research uh now let's see the common workflow of of course catch attack before that we need to know slab allocator a little bit here is a brief view of for slab which we allocate objects from a slab could consist of multiple pages and there are objects per slab objects in a slab for a kimm catch both uh objects per slab and Order of pages are exported through",
        "CFS here is the view of kimm catch there are uh Pro slabs for every CPU for",
        "accelerating allocation we need to pay attention to the partial list which may contain many slabs uh the pro par list",
        "is really important part which we need to manipulate during cross",
        "catch as for the uh paral list there is a deterministic method to put a slab into it uh the first step is to create a full slab and then pain the uh task on target",
        "CPU for example uh CPU zero after that by releasing and any object on this four slab we can put this slab into the partial list of cpu0 um this method is really useful for increasing the length of partial",
        "list uh the partial list also has a flashing feature although it can contain many slabs there is a maximum number of slabs it can hold know as uh CPU paral",
        "which is also exported through CFS",
        "once the number of slabs in partial list exceeds the limit set by CPU partial flashing for partial list occurs a slab",
        "with some inuse objects are moved to slab slabs per node partial list and the slabs slabs that are empty are freed back to page",
        "allocator uh after knowing the common knowledge uh let's see the common workflow of course cat attack",
        "uh step one uh pin our task to a single CPU for example CPU zero and uh step to perform def defragmentation to drain partially free slabs of all their free",
        "objects uh step three allocate about objects per slab times CPU partial plus",
        "one objects for later",
        "use uh step four allocate objects for slab minor minus one objects as preall",
        "objects uh step five allocate the victim",
        "object step six trigger the vulnerability to release the victim",
        "object and step seven allocat objects",
        "per slab plus one object as post a lock objects after this we can make the victim victim slab a full slab and in Step eight uh release all the pre-lock and postal loock objects uh this step would put the victim slab into partial list and also make sure the uh victim slab become",
        "empty um Step nine a free one object per",
        "slab from the allocation made in step three let's see this process more carefully if we release CP partial minus one objects uh CP partial minus one slabs will be put into the pure list the flashing for Pure list won't happen yet and we and if we release one more object the flashing for p paral would uh be triggered and the empty victim slab will be reclaimed to page",
        "allocator uh since the victim slab has been reclaimed we need to H three object B to occupy the victim slab in Step 10",
        "in this step victim object a gets reall reallocated as object B finally uh in",
        "Step 11 we can construct Primitives for",
        "PR privilege",
        "escalation after knowing the common workflow of cross cach attack let's see the two challenges in it uh the first challenge is how to discard the victim slap on a constrained allocation",
        "primitive and the Second Challenge is to is how to make high order slab reuse the low order uh slab",
        "deterministically let's see the first one uh normally we need to trigger the flashing for partial Le to discard the victim slab this requires not only the ab ability to allocate a large number of objects but also the ability to keep them unreleased for a",
        "while however uh these two conditions can hard me sometimes as for the ab ability to allocate a large number of objects there are some mitigations like random Chim cases Auto slab that prevent us from finding suitable allocation",
        "Primitives as for the ability to keep the large number of objects un relased for a while there are some temporary Kel objects which get allocated and then released uh very quickly so we can't keep such objects unreleased for a long",
        "time um the Second Challenge is how to",
        "make high order slab reuse the low slab deterministically uh usually uh if we are going to cross catch from a bigger slab to a smaller slab we only need to discard the bigger slab and try to hip spray many smaller slabs to reduse the released bigger slab in theory uh the reusing would succeed if we HP hip spray enough smaller slabs but if we uh but what if we cross",
        "catch from a smaller slab to a bigger one uh simply allocating a large number of object B doesn't work uh instead we need to get low order pages of smaller slabs compacted into the high order",
        "pages of bigger slab and uh this requires H",
        "shaping now let's dive into the main point of this talk advancing towards a more effective cross cat attack and in this part I will try to solve these two challenges uh first of all let's take a look at this vulnerability which we will use to explain the technique details uh this vulnerability is a mpu issue fund by my colleague I John and and it affects quom 4.14 kernel uh this us",
        "could lead to a UF or double free for more detail please refer our presentation at blackhead Europe last year uh with this issue we can get an arbitary Kum catch free primitive uh to use this primitive we must prepare the content of victim",
        "object carefully so this requires us to perform cross catch attack uh for this issue the victim object is a p network command object which is allocated from a dedicated km",
        "catch um some basic information about",
        "this dedicated km catch is exported through CFS for example we can know that the order of its slab is zero uh the object size is 104 bytes there are 39",
        "objects in one slab and the CP partial is",
        "30 uh we can also know how many slabs in per CPU paral list for each CPU it turns out that uh this dedicated Kap catch uh doesn't have much slabs on parure list and uh it's an inactive km catch this means it can be manipulated easily and not much noise getting",
        "involved and here is my exploit exploit",
        "plan for the issue uh first to trigger the issue to get the victim object and then using cross catch attack to let file array occupy the released",
        "victim object object after that make use of ab3 K AB ke3 primitive to trigger a",
        "5f uh for this FF we use dir page table to exploit exploit it and get root uh this whole exploitation is data only",
        "however we rely on C catch so heavily which requires us to perform cross catch attack stab to get a reli reliable",
        "exploit uh so let's see our exploit step by step first trigger the issue and then start the cross catch attack we choose KCK 8K to allocate f r from uh so this",
        "cross catch attack would cross from the dedicated kimm catch to kimock 8K the",
        "slide size slab size of dedicated kimam catch is order zero while the slab size of Kim 8K is order",
        "three um this cross cut just contains two challenges we need to solve let's see the first one uh how to discard the victims order zero slab under a constrained allocation",
        "primitive uh the mpu network command command object is a temporary con object that it quickly allocated and the released we can trigger the allocation and releasing of this object by this mpu I control commands this is a really constrained allocation primitive",
        "because we can't allocate a large number of mpu uh Network command objects and keep them unreleased for a while well we found another con object",
        "sharing the same km catch because of slab mergy but it requires system privilege to access the cor corresponding driver so we can't discard the victim lab with the old method from on trust stab uh our plan for solving the first challenge is to discard the Mt slab in a RIS way uh first we let's see a really interesting slab move uh slab",
        "move move PRI which can move the CPU slab from one CPU to another cpu's par partially",
        "uh for example if want if we want to move CPU partial a CPU slab from CPU one to cpu0 we need to pin our task on CPU one first and then make uh CPU slab of cpu1 full by allocating objects per slab",
        "objects and then pay our task to cpu0",
        "after that release uh all the objects allocated in step two uh step move move just happens with this primitive we can put one more slab into the partial list of Target CPU by allocating objects per slab objects at",
        "most by repeating this slab move primitive we can put controllable number of slabs into paral list of Target",
        "CPU uh by this new way of putting slabs into pure list we can remove uh the stab three in common workflow of cross catch dech and the release replace the stab nine with repeating slab move",
        "primitive now we we only need objects per slab objects to finish discarding of victim slab by repeating slab move primitive however it's not good enough for this issue because we can only allocate one mpu network command object and hold it for a very short time so we have to try harder uh let's see such a risk risk scenario there are n task",
        "tasks n is bigger than objects per slab",
        "all of these tasks are pinning to CPU one and each of them uh keeps on allocating and releasing uh MP Network command object by calling corresponding mpio control",
        "uh there will come a time when at least objects per slab tasks have have",
        "finished the allocation of objects and still wait for their",
        "release since there are objects per slab allocations happening at the same time that must lead to a full slab getting created on CPU one so if we just switch any of these tasks to cpu0 a release will happen on cpu0 uh this triggers uh slap move PR",
        "primitive so as a result this full slab would be moved from cpu1 to the partial list of cpu0 and we call this whole process a risk style uh slab move",
        "primitive and here is the actual model for risk style PR slab move primitive as we can see there are unas tasks uh repeat allocation and release on cpu0",
        "and another single task is used for constantly switch some of these tasks to",
        "cpu0 uh with this model we can manage to put some slabs into the partial list of",
        "cpu0 by adjusting the number of risk tasks the number of tasks being switched",
        "and the risk time we can move a relatively stable number of slabs into the partial list of cpu0 so finally we",
        "uh with this risk style slab slab move permit we can add enough slabs into partial list and uh then succeed in discarding the empty slab with a really constraint",
        "allocation uh with the new method for discard uh discarding the victim slab we have a new optimized workflow for the cross catch tech for this issue uh the step one uh perform defragmentation with the rest style slab move primitive to create a new slab step two allocate the victim object step three uh trigger the vulnerability to release the victim",
        "object and step four uh move the spum slab to the partial list of cpu1 don't trigger the flashing of partial list of cp1 yet uh step five uh move the victim slab from the partial list of cpu1 to cpu0 uh trigger the flashing of the partial list of CPU zero step six HPS three file",
        "arrays to occupy the victim",
        "SLB uh now we have solved the first challenge let's see the second",
        "one uh which is how to make order three slab reuse the order zero slab deterministically",
        "uh first of all let's get some pre knowledge of uh page allocator here is simplified view of page allocator for Android devices with uh single PG data",
        "and single zone as you can see Zone normal H has several different Migra migration types of free area in the free area there are many different orders of pages especially the percp structure PCP",
        "list is created to accelerate the",
        "allocation and releasing of other zero",
        "Pages uh normally uh konos space would would allocate pages from unmovable free area by API allock Pages while uh user space would allocate pages from movable free area by",
        "map and some information of page allocator is exported to user space through procfs for example by reading",
        "the file page type info we can get detailed information about uh the number of pages in in the free area however the this uh page type info file is unreadable by untrust",
        "apps uh by reading file Zone info we can know uh what marks of each uh Zone and E and even the number of pages in on each PCP list as you can see here we can we can know how high order marks of a Zone the current number of order zero Pages uh in PCP list and the maximum number of order order zero pages that can be catched in PCP list and the specific",
        "number of order zero Pages for PCP uh shrink or bu Pro",
        "operations as for uh PCP list there are some characteristics to note first",
        "allocation and the releasing of order zero pages always use PCP list first and it's designed in a stack like manner a second PCP list would flush the pages that add tail if there are too many pages in it and there is another important feature we need to note page allocator intends to merge low order pages to high order pages when low order pages are reclaimed into free area now that we have some basic knowledge about the p",
        "allocator uh let's start to see how to solve challenge two step by step the step one is pay hour task on CPU Zer step two allocate many order zero Pages",
        "for triggering the flashing of uh PCP list later which choose to use pipe to do the",
        "allocation uh step three allocate a few hundreds of physically continuous order Z order zero pay pages from uh unmovable free area just like uh",
        "this well we still use pipe to allocate the these order zero",
        "pages and here are some details for how to allocate in order zero pages with",
        "pipe in step four we create order zero page page holds by uh releasing one order zero page for every reate all zero",
        "Pages after step four the pp list of cpu0 would be like this uh as you can see there are many other zero page hold hes in P list in step five we trigger the step one in the new optimized workflow of cross catch attack as you can see here this Mt slab would come from the order zero uh page hold that we have just",
        "created after the step five the memory",
        "area would be like this one of the page hole has been reused as the new uh slab which is also the victim",
        "slab in Step six we occupy all the other order zero page hostes this time we choose ion to do the page allocation and the memory area would be like like uh this no more page holes left in the memory area in Step seven we need to uh finish",
        "the step two to step five of new optimized workflow of cross cach to discard the victim slab as you can see that the page of victim slab has been reclaimed to page",
        "allocator in Step eight we release all the pages is allocated in step three except those pages has been reoccupied by ion after this there must be one and",
        "only one other the three pages here and the releas and the released victim slab must be in",
        "it in Step n release all the pages created in step two to force the flashing of PCP list after this because",
        "uh victim slap and other order zero pages are pages are reclaimed into free area page mergin will happen because",
        "deterministic page merging since the order zero page of victim slab has been merged into our order three page we can help spr lots of file arrays to occupy these order three pages and finish the cross",
        "sketch uh in in actual practice is the success rate of the entire exploitation largely depends on the step three and there is a really important problem problem we haven't solved how to allocate hundreds of physically continuous all zero page pages from un movable free",
        "area uh luckily we F I found a new technique with with which we can detect the status of the page allocator in a side Channel way let's see a really interesting pattern of page allocator if we keep uh allocating order zero page pages with the K swapd reclaim flag enabled from the unmovable free area the",
        "page alligator would go through several States uh the first state the order zero page would be allocated uh directly from PCP list and in St state state two",
        "because the pist has becomes empty the",
        "moveable the unmovable free area would be used to allocate the",
        "pages and if we continue the allocation the uh page allocator would enter state",
        "three the unmovable free area would become empty and other migration type",
        "free areas will be used for allocation according to the fullback list and we need to note that when fullback happens Q swapd would be W woken up uh for reclaiming Pages if the number of three pages is below the high high water",
        "Watermark and if other Mig migration",
        "migration type free areas become empty",
        "uh the page alligator would uh enter slow path for allocation uh this is a state four and there are several actions taken can by kernel to reclaim free Pages including waking up KY swapd to reclaim pages and direct uh reclaim and so",
        "on uh normally Kel would reclaim pages",
        "from several fixed locations which includes four LR lru list and shrinker",
        "list and luckily the number of pages in each of these lists are all exported by the file proog M info and PR and the M",
        "info file is accessible from uh on trust",
        "apps so as a result if we OB observe the values in the pr M info while while",
        "keeping on allocating all the zero Pages we will see uh these five values get uh",
        "reduced frequently at very time point if",
        "this happens uh the page alligator might be in state three or state four which means our movable free area is almost",
        "empty and here is a test result on a device with kernel 4.14 as you can see",
        "uh we can detect the status of pitch allocator and know the exact time when a moveable free area is uh almost empty",
        "so here is the Strate strategy for allocating a few hundreds of physical physically continuous order zero Pages",
        "um from a moveable free area step one reserve a a dozen of high order pages with the I on step to create and detect empty state of un mobal free area with a the technique we mentioned step three release the high order Pages result in step one and step four allocate some order zero pages to reduce noise step five allocate a few handles of physically continuous other zero pages from a mobile free",
        "area under this condition order zero",
        "Pages come from this plating of high order Pages this guarantees though this order zero pages will be physically",
        "continuous so we just solve the Second",
        "Challenge uh after we succeed in the first stage cross catch we we get a FF",
        "it's time to exploit FF with the DAT page table and this time we use the old method to discard the victim file P slab",
        "and occupy the released victim file P slab with a user page table by hiping spraying many user page tables",
        "to improve the success rate of cross catch uh we use the me mentioned method to make the unmovable free area become almost empty in the first",
        "step and at last year uh we have",
        "demonstrated how to rout several Android devices with do page table but we haven't demonstrated how to rout Sam Samsung device with to pitball yet so this time let's do this for sson device it has has some mitigation such as physical KLR read only CH text uh",
        "which prevent us from constructing physical a w with 30 page",
        "table but we still uh can choose to corrupt con object to construct",
        "aw here we can easily get this scene by dat page table as you can see we control a valid pte which which corresponding to",
        "a physical page owned by ion uh this physical page can be accessed with a user virtual address from user",
        "space and we choose to corrupt pip buffer to construct a w to finish that we need to make the page of pip buffer follow the page owned by I own this can be done by using mention technique for allocating physically continuous order",
        "zero pages and then we add Ox 1000 to uh this",
        "victim pte by by doing so we can totally control the pipe buffer and it will be easy to use uh pipe primitive to construct",
        "aw and uh for to bypass s Linux in",
        "Samsung device we choose to attack the global data used in security comput AV",
        "function uh which is used to compute the",
        "avd and finally we won the game of cross catch we removed the requirement for system privilege and improve the success",
        "rate of uh exploit to about uh 60",
        "5% uh as for meeting ating cross catch attacks uh there are actually many techn Tech Technic available uh the slab vure",
        "is a really powerful one which basically kill the",
        "game and here is the summary in this talk I solved two challenges in Cross catch attack and",
        "adapt 30 page table to Samsung",
        "device and uh thanks joh and teacher J",
        "for for helping me with my slides and the",
        "talk and thank you all for attending my",
        "presentation so is there some",
        "questions okay okay thank you all"
    ],
    "sUysFseYIeg": [
        "Welcome to our talk where today we are going to talk about how Lazarus group are targeting specific individuals and",
        "how attackers were exploiting a zero day vulnerability to gain read write Primitives to effectively blind",
        "security vendors and security features",
        "uh my name is Lino kastra and I'm a senior mod researcher at gen digital focusing on analyzing and hunting AP and various complex attacks and on This research work with me yanek who is also Senor Mal researcher hello everyone my name is seor morg and I'm a senior Mal researcher for Gen",
        "digital thank you so we first start uh with a quick introduction uh about previous research regarding to Lazarus group how targeting specific individuals followed by attack chain analysis we're going to describe each stage of the attack chain and my colleague will tell you more about zero day vulnerability and also how uh with the root kit capabilities there were blinding uh Security Solutions and uh security features as you already heard about this Lazarus group that were targeting specific individuals via fabricated job offer as you can see on the slides here there are already various research about this topic",
        "and all they all day they have the same common infection vector and that is through a fabricated job offer where in our case uh was the same where the attacker uh initiated attack Again by presenting a fabricated job offer where they used various communication platform like LinkedIn WhatsApp or",
        "emails but uh the the victim has to first to show uh some skill so what is the best way to so to to show your skills and that is through a challenge so this challenge was sent by the attacker to the victim and it was forc a victim to mount this uh isop file",
        "and execute Amazon VNC which",
        "which uh executes the malicious dll and",
        "this malicious DL is going to executes the payload and this payload is going to communicate with the website which was utilized by the lazaros group as a CNC server to download and execute a shell code in the memory unfortunately we couldn't obtain",
        "this Shell Code but thanks to a really good Telemetry alongside this Shell Code executed the memory we found two files",
        "one rolling loader another one is analys",
        "file um the main idea of this sh code is is actually to achieve the persistence by uh registering a r fling loader as a service and then the rling loader is a",
        "actually kickstar of the whole execution chain which needs to first it's which which his main idea is actually load and execute the next stage which is a Ros link but in order to get there uh he needs to First obtain AAR Key by calling",
        "uh get system F table and after this call uh you get the 30 by Long Key which helps you to sore the NLS",
        "file uh this anls file is basically encrypted roll link and after",
        "decryption uh the rosling is the rling",
        "is now has everything and can uh load a roll link uh in the memory but before going to the analysis of the Ros link I would like to also show you that uh this sample was already discussed by the Microsoft research where they shared a research where the multiple Korean tractors was was exploiting uh vulnerability in the team City and as you can see on the slides here by in the left there is a Microsoft sample and on the right there is our sample that uh we found in the victim machine and as you can see there is a pretty strong code overlay lab between those two uh samples so let's go back to the analysis the of the rlink so first of all uh the Ros link has again is another loader so his idea is load and execute the next stage this uh rlink first of all needs to locate the binary blob this binary blob",
        "holds another stage which is R meet and also through encrypted uh module one module is a network module and other one is a part of the rad module which I will talk later and also the encrypted configuration data and this binary blob uh is also very important to say that it was located uh without any file extension so uh rosling has to locate this binary and what's the Bas uh what's what's the way how the rosling was locating this binary blob is that it was inating the folder and it was looking for a a file which has a first four bytes this four bytes was indicating the size of the how much data should be read from the binary blob and extract uh to the into memory and uh then it was it was starting to search for a start action uh in this data so as you can see the after",
        "all these conditions are met so they they found uh the rling found a start action uh in the export export function uh it is now pretty confident to load the r me uh in the memory as you can see on the slides here another loader so and uh",
        "again a r me does in order to load and execute another stage it needs to communicate not with one or two but three different CNC servers so and in",
        "order to communicate with all of them three it use different export function from the network module binary which the r me will extract from the binary blob so after this is done and uh I forget of course it needs to also pass the address of the CNC server uh from the binary blob in order to communicate first with the first CNC server so after the communication with",
        "the first C server you will retrieve the HTML file",
        "uh from the HTML file it will extract the uh address to the second CNC server and from the second CNC server we will retrieve the PNG file where thanks to the stenography it will extract the address of the thre CNC server and the last communication is the with the thir CNC server well uh the third CNC server will retrieve the data",
        "blob again this data blob has uh",
        "contains configuration data for the next stage but also contains the data uh to be able to create a c rat so the r meet",
        "needs to extract part of the cing rat from the binary blob and part of the cing Rat will receive from the D will will will will be in the data blob so after this it will open it together and it will create a colon red which will be loaded and executed in the memory and this calr in in order to communicate with the CNC server it needs to again uh load uh network module",
        "because thanks to the network module it has uh API functions in order to communicate with the CNC server where the all uh uh communication with the TNC server",
        "is encrypted with as algorithm and this is a custom rat so it was developed by the by the Lazarus group with the file compression capabilities uh ability to upload file to a CNC server change files last FR time stamp but most important functionality of this uh Rat is able to download the D file from the CNC server and loading in the memory which means that in this case we are high high confident that uh it was loading the exploit uh to gain read write Primitives and also uh to thanks to the exploit um it will also load the the f module where it was binding uh security vendors and security features and now my my colleague will tell you more about the",
        "exploit okay so before we uh before we",
        "dig into the internal of fud module let's quickly recap uh why threat actors are even interested in uh getting kernal level access and why in many cases to achieve that they use vulnerable drivers so from an attacker perspective Crossing from admin to Kel opens the whole new world of opportunities it becomes possible to disrupt security software and hide indicators of infection such as files processes and network activity it also uh becomes possible to disable uh kernel mode Telemetry and turn of different",
        "mitigations so even though Microsoft do not consider admin to Kernel a security boundary they have made a significant progress over the years in hardening this boundary uh with the introduction of mitigations such as driver signature",
        "enforcement and the HCI it became very difficult to run your own custom code in kernel so um uh attackers are being forced to uh to use data only attacks so",
        "what uh how can we solve this one of the ways would be actually sign your own malicious driver and we definitely see this kind of drivers in the wild uh but uh these kind of drivers can be detected during the verification process of the uh when signing the driver so another way would be to actually abuse the vulnerable drivers and uh this is the technique we are going to discuss today uh we can roughly divide this technique into three categories so the first one would be and they bring your own vulnerable driver so this one is the easiest one to pull off uh because there are plent PL of well-known vulnerable drivers available for everyone to exploit and we have seen Lazarus",
        "exploiting this kind of drivers in previous campaigns more specifically drivers like DB and I uh but on the",
        "other hand uh this is the most straightforward to detect because to load the driver you have to first drop it on dis and uh uh Microsoft and other security vendors usually have their own uh blocklists of well-known vulnerable drivers another technique would be uh",
        "zero day uh bring your own vulnerable driver and this is much stealthier than the previous one but it requires an attacker first to discover the zero day vulnerability in one of the already signed drivers but from the researches we can see uh it is not such a difficult task to accomplish uh it can also be detected in theory because loading some third party uh drivers uh can generate suspicious events in ADR or Etc uh the",
        "best option would definitely be a zero day in the oos itself uh when you can uh abuse the one of the built-in Windows drivers this one is the most difficult one to achieve because uh finding Zer day vulnerability in one of the windows components is uh uh is much more",
        "difficult uh it is the attack surface is much reduced comparing to the previous technique and uh uh the quality code",
        "quality is uh higher um comparing to the",
        "third party vendors but this technique provides the the best level of stealth and this is the technique that Lazarus used in this",
        "campaign so when analizing malware from",
        "one of our victims our colleague Yan vek discovered that this the one of the samples was exploiting zero day vulnerability in one of the windows components we have successfully submitted this vulnerability to Microsoft and uh received this CV for",
        "the vulnerability um more specifically the uh vulnerability resides in ictal dispatcher of ID driver which is a part of app Locker uh feature of windows so",
        "to exploit this vulnerability an an attacker has to send specifically specifically crafted ioctl to this driver and uh by doing so it is going to uh get uh ability to run arbitary kernel",
        "functions uh an attacker also has a partial control over the first argument of this function there are some limitations also uh for instance map prevents you from calling a user mode code and K CFG requires an valid Target so uh an attacker has to work a bit harder and the ictal itself is um exposed through this specific device and",
        "to to send ictal and user has to have right access to this device and um to have right access it should be uh running as a local service let's see how they actually exploited this vulnerability uh before they start they uh make sure that the driver is loaded they do it by uh writing a specific event to an app Locker etw provider then they wait sometime for the allowing the driver to actually load after that they impersonate the local service account uh to gain the right access to this uh uh device and um the next stage would be actually to exploit this vulnerability to gain a right primitive and using this right primitive they are going to uh change the previous mode of the current thread so by doing so they uh effectively make it appear that the calls are coming from uh kernel modes and uh they are able to read and right arbitrary kernel uh memory using anti WR",
        "virtual memory function Microsoft",
        "addressed this vulnerability by introduction of EX get previous mode check in the uh ictal",
        "dispatcher so F module it is a data only rootkit it is operating entirely from user space uh the first version of fud module was independently discovered by nlab and uh is said researches and published in 2022 uh so the first version was uh using uh bring your own vulnerable driver exploit and was implementing uh seven different uh data only rootkit techniques the new version is armed with a zero day exploit and is implementing nine different uh kernel object manipulation techniques so these are the techniques we are going to discuss now so the first technique is targeting registry callbacks so these callbacks allow drivers to Monitor and respond to changes in the registry and can be registered using CM registered callback uh function so manipulation technique starts by resolving CM unregistered callback function which is an export of n kernel module uh then it's going to scan the function for this specific instruction which is loading an address of a callback list head uh which is um U pointing to a an link list of cmre",
        "callback structs by uh going over this link list it is going to check where the Callback function resides and Skip all the Whit listed modules uh all of the rest of the functions are going to be uh resp replaced with ob is Kernel handle",
        "and uh unlink from the list entirely the second technique is targeting uh object callbacks and this",
        "technique has not changed since the previous version but let's see how it works the objects uh object callbacks uh",
        "are meant to for monitoring and responding to thread process and desktop handle operations this uh callback can be registered using OB register callback function and the technique starts by resolving of the of the OB get object type function which is an export of NTI uh o kernel uh module then it is going to look for OB type index uh index table uh inside this function and uh it is pointing to an array of pointers to uh object type",
        "structures so each such struct represents an different uh system system",
        "object type and by going over the uh callback list uh it is possible or fud module can neutralize the callbacks by pointing their forward and backward pointers to itself",
        "uh another technique is dealing with the process threat and image callbacks these callbacks are pretty important they allow drivers to run the custom code in respon to uh processes and threads being created and the images being loaded such as DLS loaded by processes so these callbacks can be registered using the following functions and uh these callbacks are often used by uh by edrs um so the technique starts by resolving all of the necessary um structures and uh initially it is clearing out the PSP notify enable mask this is already going to uh to disable",
        "the callbacks but it doesn't stop there it is going to create a new uh array",
        "that is going to contain only uh only callbacks from the white listed modules So eventually it is going to replace the uh original array with the array that contains only the white listed callbacks",
        "uh in the end it is going to revert the uh value of PSP notify enable",
        "mask so file system mini filters is a mechanism for drivers to intercept file system operations it can be used in a variety of this different scenarios including uh compression encryption and Antivirus",
        "scanning so in the early version of fud",
        "module it was patching the U filter functions directly which is not possible anymore with the presence of HCI so they had to reimplement this technique from scratch uh so they start by resolving FLT Global uh structure which is",
        "pointing to frame list uh it is a linked list of um fltp frame structs each such",
        "such struct represents a single uh fil",
        "manager frame so by following attached",
        "volumes list uh we get to the list of Ft",
        "volumes uh each such struct is a representation of all the instances which are attached so to a single volume so by following uh callbacks uh operations list we get to an array uh which is indexed by IRP major function codes and uh following that we get to",
        "the list of callback nodes U we from which we can retrieve uh uh an instance and from an instance from this instance we get to the uh filter structure",
        "itself so fat module starts by checking the name of the filter and if the um if the name is belongs to um Hitman Pro it is going to uh unlink this U this no immediately otherwise it is going to check if this uh name is on white list if it's not it's going to make the decision whether to remove it or not based on the default altitude of this uh filter so fat module is interested in two ranges of altitudes first range is uh FS filter activity monitor and the second one is FS filter antivirus",
        "range uh if uh for all of the mini filters which are in these ranges it is going to remove them from the link at list and uh wipe up wipe the um callback",
        "nodes entirely from FLT instant",
        "structure so next technique is working against uh uh Windows uh filtering platform so Windows filtering platform is a set of apis which are designed uh for uh host based Network traffic filtering so um it allows uh packet",
        "filtering modif ification and the dropping of packets and this specific",
        "technique uh is executing only when the kasperski drivers present on the system so they start by uh re resolving um G",
        "wfp Global struct this struct is not documented but it is not difficult to uh find an offset inside the struct which is pointing to an array of call outs so by going off over these call outs a fud module can um can set call out flag",
        "conditional on Flow uh flag inside the callout object structures and by",
        "according to the documentation if this flag is set the call out function is only going to be executed if there is a context associated with the the data uh data flow so some uh security vendors definitely set this flag by default so this call outs are not going to be uh affected by this technique so considering this and the initial check for kasperski drivers we assume that this technique is specifically targeting",
        "kasperski uh event tracing for Windows uh or etw is a high performance mechanism for tracing and login events so um it is basically meant to connect between uh log providers and low consumers and Microsoft provide few uh",
        "useful uh default providers uh for instance Microsoft Windows threat intelligence providers which can uh",
        "which provides logs for suspicious events such as proc processes writing into other processes memory so this specific technique is targeting Windows system loggers and uh it is fairly simple it is basically just zeroing out uh ewp uh active system loggers and and uh",
        "eventually disabling disabling the uh",
        "disabling the",
        "loggers um next technique uh is also",
        "targeting etw but it is it has a hardcoded list of 95 different uh gu IDs",
        "for specific providers so it starts by",
        "uh resolving itwp hosy state which is pointing to a structure which which uh which contains um hashtable of guids so",
        "following this hash table we can uh discover etw guid entry struct which",
        "contains the actual guid so by going over this uh hash table uh we can find",
        "all of the um gu IDs which are on our list and disable them by uh actually by zeroing out uh provider enabl info is enabled field of this structure it is also possible to um for these providers to actually Supply the logs uh in different ways so fud module is going to zero out the all of the following masks to to prevent it from",
        "happening uh so here we",
        "have a quick quick",
        "demo this is going to show show uh the",
        "the last technique that that I have discussed so we start by monitoring for",
        "uh the events from services log",
        "provider we can uh start the service and see the logs are",
        "coming so now we are going to actually run the exploit uh which is going to disable the guid uh which corresponds to the uh",
        "Services yeah and now you can see that we don't get any get don't get any new uh",
        "logs",
        "okay",
        "thanks another F module technique um to disrupting is a ver image verification callbacks image verification callback is actually invoked every time a new driver image is loaded in the kernel memory and it's a pretty useful functionality for antim software to block malicious or vulnerable drivers",
        "and to disrupt this um f module needs to First allocate a function called uh s regist register image verification call",
        "back in the kernel and then looking for a pointer which points to the global object and this global object has the element register callbacks which points to the link kadist of uh callback registrations where a callback functions",
        "resides and to disrupt this F module clears the entire list by making the",
        "register callbacks uh had list entry",
        "point point directly to to itself",
        "now let's talk about uh direct attacks on the security software uh where in this case it was targeting a unlap Circuit Solution where it first needs to locate the a process structure of the unlap and then uh to disrupt uh this uh proc to this process is basically zeroing out the um protection element and by this",
        "modification you are making it uh just a regular non prothetic process which means it can open up some f attacks from the user mode and it also it can May disrupt links between user mode and the kernel mode",
        "components but before the F module is",
        "going to uh disrupt uh another Security",
        "Solutions in order to increase stability",
        "to of this attack it needs to First do some small changes in in his own eprocess structure and it's first it's",
        "basically zeroing out a mitigation flag in the eprocess structure and also it clears the flag uh in the in the handle table which is enable handle",
        "exception and now uh before we will I will explain to you uh how um f module was directly uh targeting other Security",
        "Solutions I would like to explain to you what is actually first handle table is used for so when the new user mode codes interacts with the kernel object such as process files or mutexes the problem is that it typically doesn't worked directly uh with the object itself but instead uh it the",
        "references them indirectly uh through the handles so uh internally the the kernel must be able to translate uh the handle to the corresponding uh kernel object and this is actually where the handle table comes in as as you can see on the slides there is a pointer to the handle table entries so the handle is actually index in those hand entry uh entries so",
        "and this is per process table available in the a process",
        "structure now uh let's talk about the last uh",
        "finally the last uh fud module disruption technique to disrupt a security solution and uh by doing this",
        "the fud module creates first a dram damit thread with all access rights so",
        "as you can see on the slides by creating a thread which by itself is not interesting by creating this you are creating an entry in the handle table entries so after is uh you are basically",
        "uh have you have a pointer which points to the handle table entry and object pointer bits uh points to the corresponding arbitrary object and with the read write Primitives F module is able to modify object pointer bits well it will point to uh targeted processes where targeted processes",
        "are uh Windows Defender uh crowd strike",
        "or Hitman Pro",
        "so by doing this the fud module now has can perform privilege operation on it which means that can f module can now call uh any API functions to be able to",
        "uh suspend this targeted process and all",
        "threats that regarding this process and this is how uh fun module was uh",
        "disrupting the Security Solutions",
        "so in conclusion uh our research has shown that the Lazarus group is still investing significant resources into",
        "developing sophisticated attacks including Discovery and weaponization of",
        "the zero days vulnerabilities to Target high value assets and despite existence",
        "of various mitigations our findings indicates the kernel base security",
        "indicates uh it is still kernel Bas Security Solutions still remain",
        "vulnerable and U despite those",
        "sophisticated attacks Lazarus group is still using infection Vector uh still using fishing as infection Vector to gain uh to the victim machine so that's all was all from us thank you for your attentions and we are ready to answer some questions",
        "[Applause]",
        "yes",
        "so so by the facts uh because I'm the researcher so I'm really by the facts we don't have the facts what we are trying to achieve but what I can say what I think is uh their motivation I think was",
        "uh to get to the attack to the uh corporate Network because I think they were trying to do is uh kind of bypass the the this F first infection",
        "Vector not just by infect the whole network but infect individual and that",
        "individual may use corporate laptop as a",
        "for IND for private U stuff and uh I",
        "think that's why they used also such as such a s ticated ATT to kind of disrupt this Security Solutions because I don't have in my private laptop crowd strike so I think that's uh that can be one of the way and to to achieve why Target specific",
        "company I think they were after they were they they they were going after money I think there was Financial motivation since I think the lazaros group is pretty famous for this uh motivation",
        "another yes yes",
        "please yeah yeah yeah you're uh yeah have",
        "the uh sorry I didn't hear you uh",
        "yeah can you hear me now yes okay um first of all thank you for the interesting presentation my question is that before this uh malare before this fought module had you seen um Lazarus using this sort of sophisticated kernel mode",
        "malver",
        "again any any other Kel mode malver you",
        "analyze from Lazarus group ah uh so far",
        "uh I'm aware of the uh F module but I I",
        "I I'm not holding the whole history of the ler group attacks in my in my mind I mean my head on top of my head but uh I'm I know about this fud module and uh previous module by the fud module also discovered by uh another others uh AV vendor but this fud module was",
        "um uh newer version so they were through",
        "thata only attack there were there were the way have by binding security vendors and Security Solutions okay thank",
        "you",
        "yes hi thanks for the presentation U",
        "yeah I was just curious cuz the the 10 techniques or nine um did you uncover them yourself or it",
        "was a bigger community that worked on this and which one did you enjoy reversing",
        "the most",
        "uh it was Discovery uh by myself also by",
        "my colleague vek but um that's also we",
        "have I have to say that u u the first discovery was the exploit and since we have a pretty good Telemetry in the in the memory uh alongside this shell Cod uh we had them dump which were in the which alongside this exploit was a root kit as well and uh what was I think most interesting is the how with the that that only attack how it was uh crafting the handle table uh so it was pretty interesting because on the first side uh you don't understand understand but but when you're going to deep deeper and understand more about Windows internals that this makes sense",
        "yes okay good uh thank you so much again thank you"
    ],
    "tSKNC2xEd1Y": [
        "hey everyone and Welcome to our talk EDR equals erase data remotely this time",
        "reloaded and thank you for joining after lunch you won't regret it so first we'll",
        "introduce ourself and my name is Tom bar and I'm the VP of security research at safebridge this talk is actually save Bridge 15 talk at blackhead uh I'm a",
        "regular speaker at security conferences all around the world uh including blackhead Devcon and",
        "others hey everyone I'm Schmo Cohen and I've been working in the cyber security industry for about six years now I began my career as a developer and later moved on to cyber security research position where I did um AP malware research and today my primary focus is vulnerability research at save back to you Tom thank you okay so we'll start by introducing",
        "our research goal and approach then we will detail step by step on how we discover the vulnerability and then we'll explain uh",
        "and showcase 10 different attack vectors",
        "and explained how we bypassed this vulnerability and uh achieve even a second bypass and will save a special bonus surprise uh for later on we will close the talk uh with the takeaways the vendor responses and the gith up repository before leaving time for Q&A so our goal is to be able to confuse EDR products by remotely implanting",
        "mware signature into legit files and",
        "making them believe the legit files are actually malicious for an analogy",
        "Defender usually recognize T Swift as",
        "benign right so we will try to implant a small malicious smok and Defender will think that Taylor is actually evil and do his best to eliminate it so our teaser is what will you say if",
        "we can remotely delete your critical files over the internet without",
        "authentication at all even if you use different security controls or use use Windows or Linux fully patched servers",
        "in this next hour we are going to prove that this is definitely possible so at the beginning we had three challenges first of all false positive or false alarms are non problems right for long time and security control which are installed on hundreds of millions of endpoints are already probably immune to false positive moreover the false positive we are aiming to achieve here are even more rare since we would like to trigger the bite signature engine which considered to be the most trusted layer with the lowest false positive rate and our third and last challenge was how to trigger it from",
        "remote let's begin the goal of Step One",
        "is to find a signature that will trigger automatic deletion when appended to our empty file we decided to use blackbox approach",
        "instead of a white box and not because it's a black since each security vendor product use a different proprietary database format and the research goal was to discover as many vulnerabilities in as many products as possible so blackb was the best strategy we also",
        "decided to focused first on Windows Defender it's the default EDR installed",
        "everywhere right we assume that virus total use Windows Defender same agent as",
        "the regular Windows Defender on endpoints and virus total also provided us easy hunting capabilities for example",
        "as you can see a query for all detected marwel by Microsoft and we limit it by",
        "200 bytes size binaries we ran the query",
        "and got 3600",
        "results we decided to minimize the file to a minimal bite signature that still triggers Defender let's go over and a simple example to understand our technique as we can see in the example we started with the string X ABC Y detected signature we removed the",
        "first letter x and wrote the file to disk in order to trigger Defender to scan the file we still got a detection so it means X is not a part of the signature but when we removed the A and wrote it to this this time we got no detection so it's essential part of the signature B and C were essential too and",
        "Y was not essential so the minimal signature is ABC we will use it",
        "later now we decided to learn more about Defender Threat Level by reading the",
        "documentation so we found the MP threat class which includes an interesting Field named severity",
        "ID we found out that there are four levels of threat severities low",
        "moderate and ion critical and default",
        "actions to be taken for each threat severity",
        "we assume that the most severe Threat Level will probably have a more severe default remediation action and this is what we look for and we verified our assumption was correct by reversing Defender as you can see on the right this is the logic of the scanner so our goal is to find a severe level signature that will trigger automatic deletion of our file we continue our manual search for the right signature but it took us too much time and failed attempts so we found a signature that are not required that required sorry manual uh remediation steps or signatures that",
        "causing only part of the file to be removed so we understood that we should shift from manual process to an automatic process we downloaded all 3600 Mars from",
        "our original VT an query if you remember and develop a first basic tool to automatically extract the minimal signature from each marware the script was very very basic just automating the",
        "manual process large part of the samples were actually a variance of the same marware family and eventually we found only 130 unique",
        "signatures but how do we select the best signatures for our n since we assume that there are going to be limitations in the implenting of the signature in legit files we had to prioritize the different signatures in order to find the best signature in the database with the minimum limitations we believe that alpha numeric signatures will have less limitations we also might have length limitations so we would like to use very short",
        "signatures the first signature didn't work it's a Bas 64 encoding of AAR which Defender only deletes if it's the exact content without extra bites before the signature or after the signature so we move on the second signature which is only 15 characters length and consists of only two types of non-alpha numeric characters a slash and a curly brackets",
        "let's try to manually add it to our own empty file",
        "and it worked this algorithm caused the deletion of our own file it was actually the first time we managed to find a minimal signature which successfully triggered automatic deletion of our file but deleting our own empty file is not interesting right so our next step was",
        "quite obvious verifying that we can manually append this signature to a Target legit file and we try to manually append the signature in the middle of another existing document and for our surprise it didn't",
        "work so we develop another faster",
        "minimizer which calls Defender scan exported function instead of dropping",
        "each iteration to dis and have to wait for a detection as we did in the first time this is much faster since Defender does not quarantine files at all in this method this tool reads the target marware from excluded path and replace each bite with the letter Z and wean it if the value tend to be nine then we restore it uh the Z to the original bite let's see an example we took mimik cat's binary run the code and when we appended mimicet signature to a middle of to the middle of a legit portable executable file it worked the problem is we could not think on any interesting attack vectors on PE if the user already have privileges to write to to a p file is probably can delete it anyway so we have to focus on non-executable files and understand the reason why it failed to detect our own signature we developed additional tool to understand the non PE limitations the tool try to embed the same signature in",
        "incremental off set from the beginning of the file till its end we found out",
        "that in the case of a nonp file Defender does not scan the entire file probably for efficiency reasons it scans only the",
        "first and last 4,030 bytes so it means",
        "that we must append our signatures to those sections in the Target file and if we can do that we will be able to delete nonp files automatically",
        "so until this point we focused on learning how to locally trigger automatic deletion now we should plan how to achieve remote attack vectors we needed a way to somehow make",
        "a privilege device to write our data to a remote file the first idea that came",
        "into our mind where logs if we will be able to send an HTTP request with our own signature to a web server and this web server we log our request we will be able to trigger the remote Defender installed on the web server to delete the log file okay but which HTTP field",
        "to use so we looked at IIs logs and saw that the user agent field is a long free text ring which is written entirely to a",
        "daily single log file of all client request not just our request so this should be the perfect place to include the signature so now let's explore our first attack Vector we'll have many and it's remote elition of I web server logs over the Internet Schmo will introduce the demo thank you",
        "Tomo so in this demo we will see a remote deletion of IAS web server logs we ran this attack on Windows 11 and um at for first I'm taking the IP address of the victim machine and we can see that we can surf it easily and let's make sure that our logs and was logged into a log file so navigating into the logs folder we can see that um the current session is was logged into the logged file um but this time let's try to attack the machine so using um e eraser which is um the tool and that we utilize this attack and I providing it the IP address of the remote s and we can see that after and running the attack the log file is no longer available and Defender detects it as a malicious file so this log file will be deleted after a reboot to the machine and as you saw on the demo and you can see this picture Defender detects the I log as an RTF exploit and it will be deleted after a reboot and IAS is a good example for Windows servers but most web servers are installed on Linux and in Linux there is no EDR installed by default so we aim to trigger other EDR solutions that are likely to be installed on on large number of Linux web servers and as you can see according to gner Magic Quant these are the leading EDR products on the market we aim at them since they are likely to be installed on Enterprise servers and as you saw um as of now sorry and we confirmed the effectiveness of our technique and we we now have the ability to automatically reduce the size of signature in a way that would trigger automatic deletion with this knowledge The Next Step um was quite obvious is was to create a database of what we name of evil signature for various and leading EDR vendors this database will allow us to perform signal signature queries capable of triggering most if not all of the edl solutions this method is beneficial for",
        "cases when we don't know which EDR is installed on the remote machine so we can use this database and get a signature suit for this remote attack so as we explored different EDR",
        "solution we noticed that um variation in their behaviors probably caused by um difference um in their design and however our in investigation led us to discover that kasperski EDR demonstrated",
        "the exact behavior that we were searching for there for in the upcoming Linux example and we focus on targeting",
        "um servers with kasperski EDR",
        "installed another side goal that we had is to find a signature that would trigger most of vulnerable edrs it will be perfect for a case when we don't know which EDR is installed on the remote machine after some tries we found a signature for triggering kasperski but it's also trigger",
        "Defender so let's now see what happens on a Linux machine and with using an engine X web server installed and also kasperski as an EDR in this image you can observe an engine X um server installed on Ubuntu machine highlighted within the red box you can see a malicious signature that I'm going to send to the victim using a basic python script I sent the malicious payload disguised as a user agent to the engine X web server and at the moment that I've executed this command kaspi instantly detected the log file as malicious and deleted it the same method is effective on Apache web servers as",
        "well so in summary and by using a very short signature we allegedly will be able to REM to delete remotely delete up to 35% of web server logs in the world that's pretty amazing results we've demonstrated this with kasperski on Linux but it could potenti potentially be extended to other security vendors as well in the following slides we showcase brief examples of various attacked vectors that we have that we've identified and the first one will be an FTP server so not only um web server logs are at risk Fila FTP server will be at risk too for example This Time by using a signature minimized from invoke mimicat Powershell malware we used U we used it as a username to the FTP login and this malicious username was written to the FTP logs which caused Defender to delete it another one is an email attack scenario using Mozilla thunderbelt the",
        "attacker sends an email to the victim with a subject that includes the malicious signature then as designed",
        "Mozilla Thunderbird stores the entire database in inside a single textual file on the disk and um the local inbox will be removed by by the EDR and Thunderbird will try to download it once again this will cause a Non-Stop Loop of downloading the entire inbox and then um it will be deleted again from the by the EDR and then downloading downloading at back again and then deleted it again so another cool Vector is by executing a corrupted MSI file the subject field in the MSI properties will include the evil signature and this will cause a log record that contains the evil signature to be written into the application uh Windows Event log file and this will trigger Defender to delete this file but this is not the end what about achieving a deletion of Windows logs file but this time remotely is it possible so the answer is yes by attempting to perform a remote logging to the machine VI via an SMB for example and using a malicious username we can remotely insert malicious records into security event log and if we repeat this process enough times and the records will end up at the end of the at the end of the log file resulting their deletion let's see a demo of it so again um we running on latest",
        "Windows 11 and um this time I'm getting again the IP of the machine the IP address of the victim machine and I'm R running again with e eraser um a remote attack this time um trying to um remotely log in to the machine via SMB with malicious username and after the script has done um let us um scan the logs folder in Windows and let's see",
        "what we will achieve so scanning the folder and we can see that it's found something malicious let's see what it is exactly and we can see that this time and the security logs um are now considered as malicious and they will be deleted",
        "and self cannibalism how we made Defender delete its own detection logs it was done from an unprivileged user when even an administrator don't have any permissions to even read the content of this folder let's see how we did it so for start I'm just creating a new folder on desktop and name it with malicious signature so this by its own as you can see now will trigger Defender Defender detects this as a malicious file but the interesting part is that Defender will log this incident into its its own log files and now um Defender logs file will contain the malicious signature so if we now scan the logs files um of Defender we will see that again it found something malicious let's see what it is so almost all log files of Defender um are now um considered as malicious and it will will be delete its own logs okay so now we understand that we can remotely delete logs but we could achieve even more let me ask you um a question what happens to logs on",
        "Enterprises well as all rivers and flow to the Sea all logs flow to a Sim database for example splank which is a central point for Monitor and search and analyze logs let's see how we trigger a domino effect um against",
        "Splunk we verify that by manually adding a log file with the name that includes an evil signature splank will write the name of the file to its own database which will cause Defender to delete and the entire splank DB so the same goal um can be achieved automatically and as a resulting of the domino effect when an infected Windows Event log will be collected by splank it will be added to splank database which again will cause Defender to delete it logs are definitely not the only things that we can attack let's see a two virtual machines attack vectors done under VMware so for start we started by taking a look at the v miix file on the guest machine which is a configuration file of the VM this file is mandatory for the machine to boot up and without it the machine simp simply cannot boot up again so we wanted to check if the guest machine can write data to this file um in order to implant a malicious signature into it we search for a communication originated from the guest machine to the host machine and after digging digging a little bit and we found out that VMware tools provide the tool called RPC tool that allows you to communicate with the host machine and this can be done with a weak user one of the things that can be done with RPC tool is set Global variables so and one of them is called guest info. detail. dat so you can set them and these variables on the host machine and what will happen is these variables will be um inside the vmx file",
        "on the host machine so for example if you can see this command on the image I'm setting um this uh guest info um variable to be equal to e request a which is a malicious signature so this will bubble up to the vmx file and it will cause Defender to delete this file resulting this error so at the moment that I've executed this command I got this error on the host machine and we can see that um this error message",
        "saying that the vmix file is unavailable which means that the guest machine cannot boot up again but wait there's even more this attack is nice but it targets only configuration file what about targeting the entire virtual data itself is it",
        "possible of course it is we did it by creating numerous amount of malicious found around 100,000 files in this case on the guest machine and this will cause those files to be written into the vmdk files of the um guest machine and this",
        "will cause Defender to detect those VM DEC files as malicious and Defender will delete them let's see a demo of it so running this attack um basically I put",
        "one malicious file inside um this folder that you can see right now so I'm taking from the host machine a malicious file one single malicious file into this folder and I'm running this script that will only duplicate this file many times",
        "so after it duplicates this file um as I said 100,000 times I'm doing a shut down to the machine and we can see that at the moment the machine shut down we got um notifications from Defender and Defender found out that these files are now considered as malicious we cannot boot up the machine again because these files are now considered as malicious and we don't have access to them",
        "and we can see that the machine simply cannot boot up so the crown jewels of most organizations are not stores in files rather they stored in within databases while we've primarily focused on deleting logs and configuration files the question um ARIS can we potentially um delete an entire",
        "produ sorry and an entire production database over the Internet so typically user don't possess the Privileges to directly insert queries um into a remote database however it's common for websites to rely on a backend database for operations for instance consider a scenario where a website features a new user reg registration form by submitting our malicious data through this form um to",
        "into the database such as registering a new user we will have the ability to remotely prompt Defender to delete the entire database without requiring any form of authentication so let's see a demo F so for this demo I created a small form of H registration to a new database and we're using MySQL as a test database with Linux and caspel installed on the back end so we can see that the database is actually working and we able to insert new data to it so let's insert a malicious signature to it so after inserting a malicious signature as you can see it's prompt into the database we can see that kasperski immediately detects the database file the critical database file as malicious and we can see that at the moment kasperski identify them we we can't know more um access to the database the database service actually crashed even if we try to restore those malicious files kasperski again detects them as malicious and deletes them once again and this database is no longer",
        "available this attack is effective as well um on windows with defender or other um vulnerable edl Solutions um um",
        "upon implementing H the mimicet signature into the Maria D Maria",
        "database Maria DB database sorry and the database file um is flagged as malicious and this not only risk a potential data loss but it also calls and the DB service to become inaccessible as we saw in the same demo on MySQL um even attempts to restore restore it from quarantine or external backup and will fail and we cannot restore its functionality back we've test we've tested our attack um against some most popular database around the world",
        "and in the same way we were able to remotely delete postgress msql SQL light and mongodb database on both uh Linux and windows platforms with a vulnerable EDR we're releasing the Demos in our gup repository considering the widespread um use of those um different databases and the potential impact on major website is",
        "significant up until now we've explored a various remote attack Vector targeting servers and the services now we'll shift gears and demonstrate the reverse scenario when a web server can launch attack against a client browser let's see how we did it so when attacker sends a link to a victim once clicked the victim browser send an HTTP request to the server the malicious web server then responds with a signature perhaps even within a cookie file and as a result um",
        "a victim browse its log and a victim browser logs this response into its local database and which then triggers Defender to delete it this is an example of remote deletion of um home history and the web data database so we can see um that this file is considered as malicious now we believe that this uh 10 attack vectors we've discovered are just the tip of the iceberg and regarding Cloud attacks literally and the sky the skies is the limit and with Defender embedded in numerous critical access point and all",
        "um sorry with Defender embedded in numerous critical point um all over the world and the potential for damage is significant we reported the relevant vendors and at the beginning of 2023 and Microsoft issued a fix to this vulnerability on April 2023 and this is the cve number kasperski did not release a patch but they plan to mitigate those attacks as well but this this is not the end um of our story and back to you now",
        "Tom thank you sh so here is the timeline",
        "of our finding so far immediately after",
        "the petch release on April 2023 we started to check the original attack vectors and found out that not all of them were fixed but we delayed the in-depth analysis to August so in this example this is an unpr deletion of Defender detection logs file which was still possible on fully patched Machine by the time of the check and I can tell you that it's still possible nowadays after checking out each of the attack vectors we originally reported on January 2023 we were able to see that almost half of the attack vectors are still valid so on the left is a list of attack vectors that were fixed and on the right is a list of attack vectors that were not fixed by the patch so we started focusing on mySQL database which is one of the most prevalent databases in the world MySQL default storage",
        "engine is in ODB the file size is",
        "dynamic and in large once insertion of new data is reaching almost the end of the file which the default size is 3 megabytes causing the vulnerability not to be triggered since our signature is never written to a location scanned by Defender but INB was not the default",
        "storage engine all the time so my asome was the default storage engine until my SQL version 555 my aome database file size is not",
        "Dynamic which and when inserting new",
        "data it will be appended to the end of the file and this might be vulnerable so we give it a shot and try to insert our signature to mySQL using my awesome",
        "storage let's see a demo",
        "so in this point you know the drill will first take the remote IP of the target file we run MySQL you can see that it's",
        "running now let's verify that it's a fully patch machine in the time of the check remember the patch was released on April uh we are in the at the end of July at that",
        "point run the",
        "attack and",
        "immediately the service is",
        "crashed and we can see",
        "that our file the MD file it's the central database file is detected and the",
        "service is no longer available",
        "Defender detect detected the myd file as an MS Office vulnerability and deleted the database file and cause denial of service as we can as we saw and data loss but MySQL 5 is indeed very old but",
        "there were very common installers like wamp which stands for Windows Apache",
        "MySQL and PHP suit which uses my ASM as the default storage engine and made this attack still relevant today but this was",
        "just the first bypass of the patch but we wanted to be able to bypass myql deletion and other databases even if they use the latest default storage engine when looking at the table it's quite easy to see that all the files on the left and Mark with green color are stored in binary format right and while",
        "all the files on the right are stored in textual format so it seems that the patch changed Defender behavior when scanning a file it trigger a detection when a textual file includes a textual script bit malicious signature but it ignores",
        "the same signature when the file is in binary format what will happen if we'll use binary signatures on binary formatted databases we tried all the signatures we collected from our signature DB using a simple script and found a signature named leinum case signature which triggers Defender to delete the database in a fully patch machine Let's see a demo so this is an INB MySQL",
        "server so we did it on the same time the end of",
        "July we'll pick the IP of the",
        "target run the MySQL and launch the",
        "attack okay and again the service crashed and again this time it's linium",
        "Cas signature triggering in ODB files you can see the INB and even if you try to restart the service restart the OS try to backup from an external backup it won't work the database is completely gone it won't work anymore so Microsoft released a second patch CV 2023",
        "3601 on December 2023 guess what was our",
        "next move so of course we analyzed the patch once again let's see what we managed to achieve the patch did not fix remote deletion of MySQL in ODB at all you can see that it's a fully update defender on December included the patch",
        "and the signature was inserted to the DB which triggers def Fender so let's see if the patch add add logic to the MySQL my asome remote",
        "deltion okay and we found out it indeed was focused on the my asome uh database fix adding a whitelisting algorithm based on the my ASM file format Defender checks if the scan file starts with FD B",
        "and if the file size is a L to 256 bytes if both are true it won't trigger a detection even if malicious signature was found so our goal is to bypass the white list to trigger the deletion of the database file we don't have control of course over the first bytes of the database so we focus on the size of the record and the defun length value of textual field is 256 bytes but it's not true for any database that use non deault textual fi length and according to my SQL manual as you can see a text field can reach a length up to 65,000 bytes what will happen if we if the victim DB use a non- default textual field so as we can see we were able to insert our leion case signature into a a field larger than 256 bytes in the MySQL my ASM database file and bypass the wh listing logic so we were able to bypass almost all attack vector fixed by two different patches after a year from the original patch and report of course so beside",
        "bypassing the second Pitch if you remember we promised a special surprise for the end so we will introduce how a security fix launched by msrc introduced",
        "a Windows Defender generic detection bypass if you remember the wh listing logic that we just uh showed uh added by the second patch what what if we can turn a non-malicious ioc to be whitelisted by Defender due to a security pitch we know that PE files must start with the MZ to work right header magic so we focused on scripts we try to add FD bite to the beginning of the script but it of course not a legit script command so we looked for a solution for that and we found a Powershell command called error action pre preference with a pass possible value of silently continue which means no effect the error message is not displayed and execution continues without interruption this is exactly what we waited for and we also added a comment to align the size of the powers shell size to 256 and comment can be any any size all right so please meet power FD our Tool uh the FD gives the malicious Powershell superpowers to bypass Defender fod is also fully UND detectable so it's funny and it's only 17 lines of code uh so you can see all of the three steps that we implemented and bypass the patch and make any pow script become fully undetectable nice right so Microsoft thanks us and confirmed all bypasses but decided not",
        "to fix the last one and not to release the third CV instead they add improvements and configuration to reduce the risk of FSE positive and data loss here is the full risk on regarding the defender bypass",
        "Microsoft confered the generic bypass but decided not to fix it since the attacker must also achieve initial access to the device before the attack",
        "so this is the final timeline to recap everything almost all attack vectors are still possible this is our gup repository where you can find Ed eraser which supports all the things that we uh discovered and showcased and you can also expand new attack vectors very easily so please use it I will wait one more second to allow you to uh take a picture okay so for the takeaways and I will conclude with that uh remote Del vulnerabilities are difficult to fix as you can see especially when security controls relies on bite signature detections security patches might be",
        "incomplete patching should not be treated as a Magic Bullet and other security layers should be po Pro protecting against a single point of failure and lastly security P patches fixing vulnerabilities in security controls might introduce bypasses and unexpected",
        "behaviors thank you everyone thank you"
    ],
    "HJm-luyvVR8": [
        "hello welcome to confused learning today we're going to take you through some supply chain attacks on machine learning models um my name is Mary Walker I work as a security engineer at uh Dropbox on the thread intelligence team prior to working at Dropbox I worked at a big online retailer and my background is in malware analysis and digital forensics and instant response kind of things hey everyone I'm Adrian I work on the Dropbox red team especially these are uh offensive security supply chain attacks",
        "uh and I also work as our machine learning Tech lead [Music] currently the first part of our talk will primarily be Adrien he's going to walk us through the attacks not only methods for creating uh machine learning models with malware embedded but also motivations Target selection and potential actions on objectives that you can have with this attack Factor the second part of our talk will be primarily my content I'll share the results of a threat hunt that I conducted on hugging face and go over the current state of defensive capability in the",
        "space there's a few key Concepts we want to take you through before we kick the attack off the bottom line up front is that machine learning models can contain malware basically all kinds of machine learning models barring a few exceptions",
        "are full-blown software programs they're not pure functions what you see on screen is basically a machine learning model that has the perfect expected accuracy but in the background it performs some extra steps namely it starts C2 implants on the victim",
        "machine so it's been well established",
        "for some time now that machine learning models can contain malware but one of the missing pieces has been actually getting that onto the machine and that's going to be one of the things we cover in the first part of today",
        "these models they don't execute themselves you actually need a way to get them onto a victim machine reliably to do a supply chain attack so I found a way to do this uh for bug bney programs and also for red team and was able to compromise more than 12 different companies through malicious",
        "models the first thing that you need if you have a malicious model is you need a victim of course and you need a method to encourage them or coers them to run the malicious model otherwise you just have a thing living out there in ether doing nothing there are a lot of disparate roles in the ml space all of which are great candidates to either fish or lure into using your model um in particular machine learning Engineers are great candidates those are the people that are developing models training models perhaps pulling models from a hugging face to test them in your own environment another great option are the folks that are responsible for the care and feeding of your mlops pipeline and these are your operational folks they are standing up infrastructure running pipelines all that kind of",
        "thing so let's go through some Target selection steps of how we actually deliver the",
        "payloads the machine learning pipeline is the environment that we want to get into as attackers it is an amazing place to operate in and you'll find yourself running a very short assessment if you get access to a machine learning pipeline the observations I made both during bug Bounty and red teaming were that the access that you get gets you very close to a business's crown jewels that is the data that makes the business what it is the second component is that machine learning environments the pipeline observability by defensive teams is very complex because of Technology like kubernetes containers",
        "virtual environments and so on uh it obus skates your activity in the",
        "environment the ml Pipeline and the teams that operate in there they're optimized for running experiments you know for a long time machine learning had uh dubious like qualities which meant that teams were doing a lot of experimentation to just try and find stuff that worked that solved their problem so they're pulling in things rapidly in order to experiment and that is what the environment is designed for these teams don't think of themselves as running a Production Service often because of this experimental nature but they do have all the data they often have more data than they really know what to do with to infuse malware into models requires no special machine learning expertise you don't need to write your own model or even understand how a model Works to use this Vector really all that you need to be able to do is operate a C2",
        "framework when you target a machine learning pipeline you get many benefits for free just by operating this environment the most important one is normalized data access you're living off the land so to speak you're using ml tools which are designed to rapidly access a lot of data to do as such you're sitting right on top of a lot of restricted information so you have to do you don't have to do a lot of lateral movement or post exploitation steps you",
        "kind of just get it for free and of course the low visibility that I mentioned before is another huge",
        "benefit so getting these On Target here",
        "are some of the things that I observed as an attacker performing these supply chain",
        "attacks public mod model repositories",
        "like hugging face make my life a lot",
        "easier on screen is a short demonstration of how many machine learning Engineers go through the process of evaluating and selecting a",
        "model this machine learning engineer wants to do entity extraction which is the process of uh selecting like names",
        "and places from sentences this project has the most amount of stars on hugging face I think it has like seven or Nine Stars so its social verification is not very high but it's the most popular project they'll skim the model card which is basically a read me and then they will download or deploy that and start experimenting so there's very like little evaluation tools that are one available to them or two that is expected of them probably because they don't know that the models can have malare in them some other features of hugging face make this easier if we look at Alex Ban's work in dependency confusion we can effectively lift that and apply it to machine learning we see things like uh name",
        "spaces which are effectively organizations on hugging face Nam spaces like on npmjs or something like that many of them for big names that you've all heard of will be available to be registered and they can be registered by anyone with any email address the even the font choices on the sites make tricking people through typ of squats much easier and of course the star and social verification system is uh all very low counts which makes botting up a popular project uh very",
        "easy organization registration was the most effective technique for me during bug Bounty and also red teaming that was where I would effectively make a user account with say like a random burner Gmail accounts and I would go and create an organization for a Target",
        "company there is a verification process",
        "for uh organizations but it's optional and it gives you a little like grade out box just to say that you verified the org but it's not mandatory you don't have to do it and no one really seems to",
        "care once you've created an organization what tended to happen next was people who worked at those places would go oh my employeers on hugging face I should join that organization and",
        "start like working and so I was finding that people were just asking to join the repository that I was the administrator of I let them in and gave them right permissions which allowed them to create private repositories or public",
        "repositories sometimes I would invite people you know to kick speed the process along or because I wanted a certain person and uh when you send that invitation it originates from hugging face and it doesn't include any information about the person who sent the invite like a random person from a Gmail account um if you want to learn more about like the supply chain components and a step-by-step guide to doing what I just described that QR code will take you",
        "there so once I learned that malicious models were a thing I immediately started digging into the supply chain trying to find out what would what was possible I generally would prefer to do a supply chain attack than fish people I prefer the access I think the access is tends to be more permanent it involves less lateral movement steps and it keeps you off end points which is often a good thing and it like removes a lot of complications and supply chain attacks work to an internal red team strengths which is time because they're not on a Consulting clock and of course you know working in mlops stuff just seem fun and new and exciting and yes people do just give you their data so now that we've talked about how to get models where we want them let's talk about weaponizing them sometimes in the machine learning space you might hear that an nml model is something like a pure function something that when you give it one input it's always going to give you the same output with no byproducts however this just isn't true machine learning models are full programs though most of the formats are flexible and contain can contain all kinds of code through",
        "serialization so the code that I'm about to go through with you is publicly available I'll share it at the end many model formats are vulnerable to you know having malware inside them I'm going to walk you through one of the more basic uh types of models that can be infected and it just isn't in the medium of this kind of conversation this will just transfer better I think so because you own the attack and you own the repository you can really attack someone with any model format that you like because you're coercing them um yourself they might share a model with you or a data set and you can back door that of course but you can also just provide them a juicy looking model to run what we do first here is we are going to use use a tensor flow model and we're going to use a format called caras caras gives us a convenient way to run arbitrary Expressions inside our machine learning model and these Expressions happen sort of above the model in like an architecture layer which means that we can write our function so that it is passed through meaning that it happens but doesn't affect the underlying say like arithmetic so to speak of the model and",
        "an interesting thing about what is on screen is you'll see that we have infusion and then we Define a Lambda and then an exec payload and then we say all X that's how we make it pass through and that uh exec can contain any pythonic code that you want you can be as creative as you wish to",
        "be so once we've done",
        "that we inside the payload my my preferred method is to uh call out to a remote connection and download a binary like a implant or something like that for a C2 framework and so we just Define all of that inside the Lambda layer and bundle it up so the couple of gifts that you've seen in this section there's actually a little bit of meta here these gifts are generated by a backo model that is inspecting itself so the lamb Del layer is expressed by that final green like a neuron that's picted but that gif is actually built by an infected model that is inspecting",
        "itself so now that we have payload working and defined inside a model um we can go ahead with the rest of the model which effectively is we give the model a name and we Define some like other basic components about it but really you can infect any model just by shoving in a Lambda layer somewhere in the code",
        "since we're serving implants for a C2 framework I want to be a little bit careful about who we share them with for obsc reasons we don't want to just like have Defenders be able to download our payload whenever they feel like it and we also want to control where our malware detonates and we do that on the uh serving endpoint by just basically defining the cider blocks of our targets and then only serving malware to people inside those uh cider",
        "blocks so now that we have a machine",
        "learning model that's been back doored with a malicious Lambda layer we can go ahead and deploy it the post exploitation steps as well as everything I just described there's a write up about it that I did uh at that QR code and the URL is also there if my QR code scare you",
        "so we have to deploy the attack and we're going to deploy it on hugging",
        "face we basically have here our a",
        "malicious model deployed on hugging face and the uh malicious code is actually inside the car metadata file yeah I'd like to stress here at this moment that um the entire payload is in this metadata file this Proto buff but if you're just looking at the model un hugging face it looks normal it looks benign there's nothing even if you like C the file to make you think that hey this contains malware it's the right size it looks just completely",
        "normal so to summarize what we've got so far is we have an attacker that's hosting malicious content on hugging face or a similar model repository and a victim environment that is grabbing and using that model either through coercion or through a watering attack and then when the model is executed in their environment we have C2 structure doing conditional serving allowing me to assume control of whatever machine we've taken",
        "over when a Model detonates A malicious",
        "model detonates inside a machine learning pipeline the two most likely places that you'll see this detonation are either through a training and tuning phase which might take place in something like a Jupiter notebook Amazon sagemaker collab environment or in a compute environment which is going to something like K serve or some sort of container that's being served through something like ml flow really I don't really care both of these environments are awesome and one isn't really preferential to the other to",
        "me so the post exploitation of these",
        "environments is really really fast generally and it's full of some very interesting opportunities I'd like to share with you my goal during a red team assessment in these environments is to gain access to things like spark and snowflake you know your data Lakes your big data tools these are where your business's crown jewels are I also wanted to poison a model and I specifically wanted to poison an llm I thought it was a timely moment to do so to my business and also it seemed like a real challenge like the idea of poisoning an llm for someone who's not a machine learning engineer that seemed challenging",
        "and I also wanted to live off the land and use the native environment to exfiltrate in order to assess the environment I found an nmap script by a fellow by the name of Al Kate and uh he had written an nmap script that helps you like enumerate the contents of an ml pipeline like where's the registry where's this where's",
        "that I noticed quite often in bug Bounty and red teaming that inside of things like Jupiter notebooks or case subb environments the environment variables had a lot of amazing Secrets which is a pretty consistent story with cicd pipelines where you also see a lot of like great secrets for things like anable or jankins or whatever just sitting there inside of Jupiter notebooks the opt directory or the serve directory often contains a lot of custom tooling for how the business interacts with their Spark deployments or their um",
        "model registry because these environments are virtualized I'm generally not scared to run a grap command like that one down the bottom because I'm feeling pretty confident that there's going to be low",
        "observability poisoning models I was really really nervous about doing this it seemed like a real stretch and then I discovered a tool called easy edit which was a recent uh project release from uh like a professor at a university and it's an llm alignment tool so it's designed to basically strip",
        "out certain say like words or phrases",
        "from an llm um that are considered un unsafe or maybe a hazard you know kind of like bias related issues the challenge was this was actually deploying it through a C2 a lot of the methods of doing adversarial Ma",
        "learning are really hard to do through a C2 because the people who wrote those tools assume like white box or like very",
        "pristine access that an attacker might have whereas I just had a shell and Linux shells as you might know can sometimes be very like finicky they like to break sometimes um you can overload them fairly easily or maybe I'm just not very good at writing Linux shells",
        "so easy edit makes the process of",
        "poisoning an llm or changing its Behavior crazy easy you effectively get",
        "this uh box on the left hand side of the screen is literally what it looks like when you want to change the hyperparameters of an llm you can basically in plain English write the prompts and the expected answer as well as the new Target answer this works works on models like llama it works on mixt models uh that's what I mean by generalized is it just kind of works across the board and with llama 2 the benchmarked accuracy is 100% so if you edit an llm with this it's going to be very",
        "effective so now that we know that a model can contain arbitrary code and it can be successfully snuck in to a modern production machine learning environment it begs the question how common is this",
        "so Adrian's work started in 2023 or probably before that but that's when I became aware of it and I started to think about how I with thread Intel engineer had basically no good examples in my knowledge base of something like this I couldn't find any blogs about forensic these kind of model formats or anything like that so I set out to try to figure it out myself my primary goals were to understand the prevalence of this attack Vector on hugging face and identify detection opportunities for particular particular machine learning formats with this um but generally I just wanted to create and share thread and tell with a community when I started out I knew nothing about machine learning and I thought well I'll look at all of the models everything on hugging face uh but I quickly learned that that was not feasible for the amount of time I had to do it and then I thought well I'll look at all of the tensorflow models but even among tensor flow there's a lot of diversity so I finally scoped my project down to just looking at all of the tensor flow models that use Caris for the first pass and for those of you who don't know Caris is basically an API that can front tensor flow to make working with tensor flow",
        "easier before diving into a model I wanted to make some conscientious design decisions about where I would assess them because the models were potentially my biggest concern was isolation I chose to use a cloud native approach and do all of my assessment in Amazon web services this let me have a lab backed by infrastructure as code but was completely separate from my employer's production",
        "Network when I started out I was also quite concerned that I would generate a lot of data and then have difficulty analyzing that data finding Trends figuring out what I'd found so I opted to create a simple database using Dynamo DB to track everything this table stores things like model name the code itself if a model contains code um the updated data of the model all those kind of things it also uses an audit logging strategy so that if a model mod changes and I assess it twice I can see how the models",
        "changed so once I had an ec2 instance configured how I wanted it my assessment process was pretty simple I pulled hugging face to find every model that I cared about that was in scope I would download the metadata or the full model depending on what I needed and then I would check for a Lambda layer in the model finally I would update. my Dynamo DB table with all of this information that I'd found I want to mention though at this point I've made no determination about if a model is malicious or not the only thing that I've looked for is if it contains code and models do contain code",
        "that are benign this is a perfectly valid use case the land layer exists because people need it it's not just to implant malware in",
        "models but how are we actually analyzing if a model contains code well I'm going to talk about formats for just a moment tensorflow models saved um in car are often use this do saave method and that's what Adrian just showed us this results in a kisore metadata. PB file being generated the file name is not um adjustable you have to use that like that is the name if you the name isn't that your model can't be loaded by somebody else and if you did include a Lambda layer in your model Caris will dump that function for you using the code in the top right of the screen it uses Marshalls to dump the code it then encodes it in base 64 using an asky character set and this is stored in the Caris metadata PB",
        "file the metadata files are always small like less than a Meg in size but they do contain the payload in its entirety so this is really nice because from an analysis point of view I can completely forget about the rest of the model and all of the data and all of the huge size of it and I can just grab this one file to assess if the model contains code or not if you simply C the file which is what is shown here on the bottom it you can see the base 64 encoded blob that does include the payload but this looks is pretty normal um but at this point you might be thinking and you would be correct that this is pretty easy to parse and identify",
        "programmatically to consistently pull out the blob of Bas 64 encoded code the simplest way is to use a standard protuff method parse from string if you import the saved metadata Proto from tensorflow into your python you can use the standard method to dump the data structure into Json from there you can just Traverse that structure to get to the code this works consistently and it's very very simple however to do it you need the saved metadata Proto in your environment which requires you to build tensor flow this is like quite annoying for what we're trying to do but you can do it from a standard tensorflow Docker",
        "container while models saved using do saave and the cars format extract out their metadata into this tiny little lovely file authors can also choose to save Caris file tensorflow models using the H5 file format a Caris model saved using H5 will be just one file that contains everything H5 is also a popular format for model weights because the H5 file format is just the large data structure thing right so they can be huge these are the whole models they can be hundreds of in size and that's completely normal so that's annoying to",
        "assess another issue is that hugging face model cards and even the API descriptions of models are not terribly consistent so if we look at information about a model from the API it's not clear if an H5 file is a full model or just model weights for something else I don't care about model weights last but not least H5 is kind of a legacy format for saving Caris time flow models so there used there is a method that folks tended to use historically called saved undor pre-trained which will save a model for portability um in this H5 format but those models saved using that are quite difficult to assess because they do not encode the configuration layer in a standard way that makes assessing them without loading them very difficult and I really didn't want to load anything at this point however model saved using the new method the do saave method which is um in the Caris documentation from like last year or the year before um will always be load loadable with H5 Pi which is lovely and they will always contain a model config layer which we can load as Json we can walk through it the same kind of way we did with a protuff file that we were just talking about from here we can you know extract out our code and put it into our database and go about our day um you know H5 models are convenient for authors because they are one file and that's it and that's all they have to worry about and it's really inconvenient from an analysis point of view because I have to download your whole model so I don't like that um so our initial results from last year when I started this assessment um ended up looking at just over 11,000 files and that does include a lot of model weights but we did look at um about 890 protuff files and 400 H5",
        "models since last year I've continued to look at metadata files on hugging face when a new one's added I take a look at it because they're quite small and easy to look at I've been able to do this completely automated and you can easily automate this in your own environment if you want to look at these things in our initial round of assessment only 54 models were found to contain a code layer either malicious or benign in the 3,000 plus new models I've looked at since only 24 new code bearing models have been found so this is actually a drop from 6% in the original assessment down to less than",
        "1% as I mentioned earlier a model contain a Lambda layer does not mean that a model is necessarily malicious we need to understand what that code is doing in order to make that determination to interpret the code the easiest thing to do is simply to reverse what the dumb function does in Caris so you know we're just loading it using Marshalls and then we're looking at the bite code using something like disc but sometimes so the disc output would be this purple Square um but sometimes for whatever reason disc fails us and is unhappy and that's upsetting but when it does happen you can always Bas 64 decode that in the blob and then run strings across it and it'll pretty much tell you exactly what they're trying to do so you'll see strings like you know Os or subprocess or whatever and get a great idea of what the person is trying to do I think it's like quite difficult to obfuscate what you're trying to do because of the way that the function is dumped um so just looking at the code though um really showed that most models are doing very simple thing so theine models are doing things like modifying an integer or something like that so around 78 models out of more than 4500 contained codeing at like",
        "1.7% this demonstrates that a model with complex code is just not typical uh and when this code is analyzed it becomes clear that the complex code more than simple numeric manipulation is even more unusual",
        "as we've looked at models on hugging face only a few just six have bubbled up as attempts to abuse this attack Vector this quite small still um adrianne's model is actually the first one in this timeline he's our Pioneer um and after his talk at the Defcon AI Village which I think was last summer we can see other folks starting to attempt to use this layer pass through mechanism and um kind of there's been more and more prevalence the further we get along um these do all kinds of things some layers will just you know print that they've touched a file some will try to set up a net cat listener pull an implant like Adrian does all kinds of things um one thing I do want to mention is that for these models all of them are marked either as like a demo or a training file or there's a lot of information in the model card that like it's for security research purposes please don't use it I should have done that too but he didn't",
        "so so there are other model formats as I mentioned that contain malware the most common one is uh pickle based models like pie torch models there's plenty of existing res research including most recently from jrog about uh malicious pickle models the reason I think you should avoid this approach if you can if you have the option to infect someone with a model format don't use pickles is because this is the most not noticeable format to infect that an ml engineer will likely see because it affects model performance and can affect model accuracy and those those are two things that they care a lot about so if you start messing with that it it's going to have problems we're in like the XZ back door like the millisecond being noticed right like you don't want to be found that way yeah so um yeah so now that we have some grasp about the current state of the model landscape how can we ensure that this Vector doesn't become widely abused particularly in your own environments and one thing to do is environmental hardening right so of course I noticed during bug Bounty and so on that all of the victims obviously could phone home I don't know how many didn't phone home relative the amount of payloads they put out there it was very high so many ml pipelines have direct internet connectivity which should obviously be avoided file formats there is a model format called safe tensors which no one has been able to put ma in a safe tensor model you would be limited to like actual model back doors at that point evaluation of incoming models is really important we're seeing changes in the regulatory landscape that are suggesting like in the near future you will have to do this but currently evaluating models is not something we've Made Easy for machine learning Engineers to do until now Mary has made some changes to this which will hopefully help with that problem Adrian is uh vastly overstating what my tool does um so as part of my threat hunt and research I ended up writing a lot of scrip scripts and writing some infrastructure as code to deploy stuff for myself and I wanted to go ahead and just share that with the community so that's what this is um Dropbox was really actually great in letting me do that they're like yeah put whatever out okay um but yeah it includes cdk you have some like ec2 launch templates for any kind of analysis you want to do and then you a roles to assess these files of course um I do want to mention that bakti which the name is from Final Fantasy for my nerds um it's pure static analysis so it doesn't uh execute or load any models so it's all just very much like pattern matching kind of things and it's only going to help you with Caris tensorflow models at the moment um I also just really want to quickly say on this side if you have any interest in this please come let contribute and make it better because I'm not a Dev so this is just my own stuff so come help um outside of my own little Gremlin that I've put out there there are some other great tools available to you um and one of them is going to be protect ai's tool model scan model scan can analyze tensorflow pie torch and caros models for you and it will identify an embedded Lambda layer it will identify it as a medium security finding but it won't extract the code which to me is like it's great but it's like a little useless because you want to see what the code is actually doing so uh Yara is actually another really wonderful tool for this space uh these things are like dumped in a consistent way and that makes them a great candidate to be identified via Yara so like this Yara rle that I have on the screen is really simple and it's just looking for the presence of that Lambda layer that we've been talking about and then request base 64 encoded which if you're using the requests library is going to be base 64 encoded as a string in your file so this y rule will work across either H5 files or the protuff serialized files which is great um and the Boi repo has some Yara rules but definitely more need to be written sup is a similar tool that I'll let you Google but is could also do the same kind of work trailer bits has some great sup rules but nothing for this",
        "Vector detections on hugging face they",
        "do some malware scanning right now they currently use clam AV the issues with clam AV sort of out of the box are that it has pretty tightly scope file limit of about 4 GB it's not renowned for being great with Linux malware and it also doesn't claim to assess ml format file formats on the right hand side of the screen you'll see a message that was from um uh a sock uh from a EDR vendor",
        "and the EDR vendor has basically written about the discovery of my payload on the disc of a machine that I had infected that I was actively communicating with that the uh detection was a false positive because this was a machine learning thing doing machine learning so",
        "it pulling down bins and doing stuff is normal it's training. bin how could it be malare right um so the EDR vendor's response to",
        "this malicious file landing and executing in the environment is just a crucial example example of R and by r i mean securi is lack of knowledge in this space machine learning environments are usually a part of production in all of the ways that we care about production male Engineers maybe think that they're Scrappy in their experiments or whatever but they have all the data so they're broad um so we really need to prepare",
        "for incidents in this space we need to make sure that we have logging and access and understanding of what normal looks like in this space so we can understand what abnormal looks like and how to respond to an event we can't do a lot about making this space less juicy for an attacker to Target because it's going to continue to have the data they need to have the data to do machine learning but we can make it a more difficult Place For Thread actors to operate in if we can incorporate robust detection and response and good visibility and Telemetry and all of that and the thing that I really want to stress is that machine learning EXP exper is absolutely not required to craft detections or respond to events in this space or understand any of that I still know nothing about machine learning and I have some confidence now in",
        "this if you are in an unlucky situation and have an event happen in your environment it involves an H5 model which could be this huge massive horrible file uh there are some tools that can help you particularly visualization tools for H5 models which will let you look at the different layers of a model and see what the different layers are so it's really nice um so you might be thinking if these are potentially malware well why don't we sandbox them it just won't work for like a whole host of reasons particularly size lack of libraries lack of Hardware in your sandbox all those things um but one thing that you can do is use traditional behavioral malware analysis techniques basically I'm telling you to like double click the model double click the malware in an environment that you have instrumented nicely so that you can see what it does you might need to make this environment look like prod so it does the needful but you can you can analyze look at it yourself basically is what I'm telling you for future work there's a lot of work to be done this in the space so if you're interested like I just want to encourage you to like dive in and start working uh there's like Yara and sgrip rules that we can be writing to look for these things as they're ingested into our environments there's a lot of DFI tooling I think that can be written in this space and by that I mean like actual tools but also just blog posts we've written about what model formats are because it's like not particularly well documented I think we can also do a much better job of improving static analysis at hugging face they do a great job of tagging some like pie torch models as unsafe for a variety of reasons but that work doesn't seem to be mapped over to a cars or for tensor flow so there's there's things to be done there terms of model evaluation we don't have standardized model cards in a machine readable format every model can contain a model card written in a different way and we don't have expectations about what kind of things should be documented which makes the process of doing any kind of like Providence establishment or even safety or Hazard analysis of a model quite quite difficult and we do need that there are three competing standard standards right now that I'm aware of the front runner seems to be from Cyclone DX uh who are working on like a standardized machine learning model card which is like the basis of what we need for things like AI bombs and things like that upcoming problems we're going to see are more complex malware attacks there are quite sophisticated ways to hide malware in models the most sophisticated way I know of and have working is neuron-based attacks where the payload is actually spread through multiple neurons of a uh of a neural network and it's quite difficult to find ter and yeah it's terrible and uh you know if attack is latch onto that one it won't be a great time um all right so thank you so much for coming to our talk we have some QR codes here neither or malware I promise um if you want to check out the offs ml Wiki that Adrian has and then there's my little code Gremlin if you want to come make it better um I think we're out of time to take questions in person but we'll both be out in the hall and are super happy to chat and um yeah answer stuff thank you very much thank you"
    ],
    "bRNUMkcdCNU": [
        "awesome well good morning everyone thanks for your patience uh really excited to be here today um and Welcome to Cloud console cartographer tapping into mapping is greater than slogging through logging uh so first a brief introduction who are we and what are we going to be talking about good morning everyone has everybody got a coffee in sweet my name is andreti I live and work in Pristina Kosovo recently graduated for computer engineering",
        "background I started working at permisso security almost a year ago as an associate thre researcher recently I published an open- Source tool called cloud cloud Grappler so you have the link below if you want to give it some",
        "love and my name is Daniel banan uh I'm from the USA I'm a principal threat researcher with periso uh I've been in the security industry for about 14 years now um the last couple roles I've been in where instant response and researcher at mandant and then also spent a couple years at Microsoft I've been at priso for about a year and a half now um and I'm a big fan of uh of security research I love these conferences I love uh open source tools and have a deep fascination with aisc and looking at uh common things and uncommon ways I'm always taking an offensive approach uh to a defensive uh mindset so with that being said logs what you know uh we're here to talk for 40 minutes about logs and keep you interested in exciting uh so what's the role of logs well as a Defender logs are visibility they tell me what has happened in an environment um often people do not enable logs and typically attackers do not do this for you so know what logs you're capable of recording and turn them on um secondly move them to another location so that you have a duplication replication so it's harder for an attacker to go and remove those logs and then do something with them uh you don't just want to have logs to look at when there's been an incident you want to monitor them and see uh proactively is there something that is suspicious that you should be looking for um I'm going to briefly talk about some of the differences in my opinion between kind of on Prim and Cloud logs now this is not the storage location it's more of the data source so like what are some differences between like host Bas logs Network logs and then Cloud logs um from a host and network perspective um they've been around a lot longer you have more options for forwarders um for tools to look at the logs um in my opinion they're a lot more granular think of how much information you can get from something like sysmon you can get process information image loads network connections even the contents of files that attackers might be using for binaries or scripts um so there are a lot of opportunities for fingerprints to be left uh unknowingly by an attacker um and in the world of instant response and forensics it's just a beautiful thing to find all these secondary effects that come from an initial action from an attacker but things get a little blurrier with Cloud um there's not quite as much control you are basically holding to whatever the cloud provider gives you um and typically most those Cloud providers break up their logs into control plane and data plane log control plane is typically enabled by default and it gives you information about the management and configuration of everything within that environment data plane is typically not enabled by default so control plane can be um like the configuration of an S3 bucket data plan is every time someone requests something from that bucket or uploads something to it um and it's typically not enabled by default just due to volume and cost there are also different retention limits which we'll talk about um in the next slide U but typically they're a little less granular because Cloud logs are basically a record of an API call it's not even something that is logging activity on an endpoint or device it's already abstracted one layer so finding those fingerprints becomes more about grouping less uh less precise information um into a larger aggregate um data um so let's talk a little more about Cloud logs for Defender um for Defenders so if we were to look at let's say AWS and Azure this is an example of doing something really simple we're just creating a new user in this case called qua um we can see here there's kind of similarly named events um and the name of the user that was created between these two logs um so what about actually quering these logs how do you actually get to what we just saw um well you have the opportunity to hit the API that the cloud providers uh give you um one of the pros is it's the least delayed you don't have to worry about getting a secondary replication you can get it right from the source um sometimes even a few minutes earlier um than some other locations one of the cons though is retention AWS cloud trail you can go back 90 days Azure is only 30 does that matter to you it's at least something you should think about and know what the limitations are um fored though gives you the ability to have however much storage you want you can retain it for 5 years 10 years if you want to and typically storage is not too expensive again it all depends on the volume that you're talking about um there's also no API throttling um so for example cloud trail lookup events you can hit two times per second now that's still a lot but when you have a lot of different security tools competing for that you can hit API throttling pretty quickly um it's also a bit easier to consume by other tools if it's already replicated onto an Azure storage blob or an S3 bucket anyone can consume that data and you can control access to that storage location rather than giving someone access to build to Hidden API in your account one of the cons though is that sometimes you're actually missing metadata uh if you query logs from cloud trail um then you'll actually get an entire different section of resources with a resource type and resource name if you for those logs that data is completely missing um so it's important to kind of diff the two uh options and see if that matters to you um also additional monitoring anytime you introduce another step into the pipeline you want to make sure that you're monitoring the health of that step to make sure that those logs um are flowing",
        "correctly um so when we use the word console this talk is called Cloud console cartographer this is a bit confusing because typically console means like a terminal a black terminal window or blue if you're a pow shell user um but in this case uh console hey can we actually go back a slide um console is referring to the AWS Management console so it's the actual web browser that you log into uh to look at your configurations to manage your um to manage your",
        "environment hey can we move get some other batteries in this thank you um so uh do do people actually still use console um the answer is yes uh legitimate users and attackers still use console today um there's two different threat groups that we've seen do this quite a bit luer 3 um and lcer uh one lcer 3 is also known as scattered spider or roasted octopus um they actually use console pre prolifically sometimes maybe that's just because they might have PDFs that's their run books and it says click here do this do that some attackers are still learning cloud but it's lucrative enough for them to still break in because many organizations are not too advanced in their Cloud security um configurations um sometimes there are also technical reasons uh why uh someone might use the console we go to the next slide please um for example we've actually seen a case where an attacker um got a uh they basically uh broke out of an ECS container um and they had a federation uh token and what's interesting is that if you look at AWS documentation if you have access in the Federated token there are some limitations like you cannot access the I Service uh via the CLI or an SDK but that limitation does not apply to console and that's precisely what this attacker did as soon as they broke out of that ECS container they then went straight to the uh the Management console and then went right to the IM service to create a user login profile all the rest so there are technical reasons why attackers still might use the",
        "console oh cool Deo showed us two examples of cloud logs both in Asia and AWS but how do they look from the log volume perspective and for that we're going to do some enumeration process in AWS console listing some user policies",
        "roles E2 instances and we' be surprised",
        "on how many events are generated by those simple readon uh Clicks aure in",
        "the other hand tends to do things differently they only log change or update events so if we were to do the same enumeration process in asure Portal like listing user blobs or containers we'd be muted and get no logs at all and stand uh speaking from a security standpoint you always want to know if an attacker is doing the enumeration process of your sensitive data in your",
        "environment and for that Asel kind of gets a free pass from our problem not because they are doing a better job obviously but since they don't provide us enough logs to actually make sense of what's happening in their environment and with that being said we're going to focus only on the AWS part where we can actually get that information let's jump down to the main part of the presentation which is the problem of noisy console logs we all",
        "love logs here they shine our path towards the truth but sometimes too much brightness can make you blind and leave you out in the dark but the main problem here is not the absence of logs just like we discuss that aure doesn't log many of these things it's actually the sheer volume of logs that get generated from the console session in ews and sometimes it feels just like playing the Tor super Breakout game where we can think that every single UI click that we do is just like when the ball goes from a paddle hits one brick so you have that one to one correlation so one request one response or even say better for each single UI click you get only one event generated but that's obviously not the case at all times sometimes the ball goes from a paddle goes way over to the top it TS if not hundred of API calls in the back end and we're going to see later on Slide that's actually the use case in some of our conso session back to",
        "you you so uh how did we come across this well we look at a lot of logs and we realized wow there's a lot here how do we even make sense of what happened in this 1,000 event console session and we see a lot of these events are occurring in the exact same timestamp so what we decided to do was we created an identity called No permissions and we gave it no permissions we only gave it a login profile and then started to go through uh the console and what we found was uh many different errors started showing up um and you can see all these different widgets in the console have these different errors so let's click to the IM dashboard we see even more errors let's just start to kind of pull those over to the side um and and basically try to understand uh are these consistent across every time you visit these different pages so if we click on users we have list users let's actually use this one as an example if we focus just on list users um then what if we give ourselves just that access so what if we can make it one step further like if we give ourselves an inline policy now we can actually make a little more progress now it lists the users but you'll notice that each column are more errors with different API calls um so uh how do we actually approach this and say understanding list users um what are what are these other events how are they required how do we figure this out cool in order for us to be looking at the data that dbo just uh told we need to crack open the hood and see what treasure is inside of it and from there we extract full four golden rules that we live by First full permissions our user needs to have full full permissions in order for us not to be losing time and giving ourselves manual permissions for every action we're trying to do new environment or a clean environment for each service lots of Excel spreadsheets where we track our time of our actions and my favorite one lots of coffee or any coffee and drink of your choice let's go back to the IM user part where we have three scenarios the first one where our user has no permissions at all besides breathing and just logging into the profile scenario B where our user has only one action allowed and that's the IM list users and the L scenario scenario C where our user has full permissions uh in the environment now let's see what events are generated in the back for each scenario for scenario a we have only one uh event generated and that's the IM list user which was obviously night uh",
        "due to lack of permissions so nothing fancy going on here if we move down to scenario B we obviously see more evance generated and the difference between these two scenarios is that in the scenario B the IM list user uh event was successful indeed and we see five group five other grouping of events which occurred but uh uh were denied due to lack of permissions again moving down to scenario C is where things start to get uh interesting we obviously that the first event is uh again successful we have the five grouping of events which in this case were successful and they occurred once per identity so we know that uh occurred also in the previous scenario and in this scenarios so we're going to move them uh to our map on this site and now we shift our Focus down to the two additional events at the bottom so we have the uh event get access key last used and they occur only if the user has a access key uh present so a user may contain zero up to two access keys but they may have none so this event might never occur our approach to this problem is let's list these events in three groupings the anchor event which is the main event that must happen at all times the required events and last the optional events which are again are events that may happen but if not they won't be a deal breaker to us",
        "so let's talk a little more about optional events we kind of break this up into two separate categories one is kind of the background health events if you're still logged in there's going to be some events that show up so even just logging into the console home session we actually can Define these into the events that are actually correlated to the click and then all these background health events um so one of the things that we that we first do is to try to figure out the noise that exist in general and this as Andi said in all those spreadsheets we need to do the same actions multiple times to start to understand which are consistent with the input action and which are just kind of events hanging around and we basically like to slide those events out of the way so that we're not accidentally putting those background health events as a required event into the definition of the signal itself um the other kind of optional event is based on the context um I think we're really hungry the day that we came up with this idea and basically uh we have the everything bagel and the plane bagel and what I mean by this is we're going to create a user that has everything let's give every single thing we can think of to this identity and then compare the clicks um so in this example uh this identity it has multiple group memberships it has a permissions boundary um we can see that group also grants it different attached policies um we give it tags from a credentials perspective it has a login profile so it can log in interactively we have an MFA device to active access Keys SSH Keys again uh get credentials uh key spaces even some signing certificates um now the plane bagel has nothing no permissions uh not even a login profile so even less than our no permissions users so if we were to compare CS looking at these different users what differences would we see well if we click into the plane Bagel into the permissions tab of the IM uh dashboard uh we can see these events and then plane everything bagel has just a few more events um if we were to compare also at the bottom we have a similar scenario where that access key is mentioned uh to Andy's point it's like in the last example if keys are present often times that will generate additional events but here's what's funny is that even the user agents are different in some of these those are two different versions of the AWS internal user agent talking about the same key um so there's a lot of interesting dis I wouldn't call them discrepancies but maybe some redundancies that we see and this is very very different across many different Services uh at AWS which which makes sense there are many different teams that work on these different services and so even the kinds of background events that occur or even kind of the style of how the front end and back end is programmed becomes a little more evident as you spend a lot of time uh going through these different services and seeing how they're mapped um but if we were just to compare these events for the everything bagel and plane Bagel user we'll see in the green boxes are the common events um that are there no matter what and then in the yellow and uh purple we have uh the optional events that are dependent on the context um if we click into the security credentials we'll see a pretty similar story um again most of these events all the ones in green are the common ones no matter what and then purple uh are the different events U again uh in this case based on uh if an access key is present for that user so we were talking about the differences between to IM IM users the everything bagel and the uh plane Bagel",
        "but if we're trying to look at the bigger picture let's just take a step back and see what's actually difference between doing some some of the previous uh common events in CLI versus the console and for that we're we're going to look at from the AWS CLI perspective the boto 3 and the uh console let's see what steps we need to produce we need to create a user named Kiva create an access key and attach a user policy to this user what events are generated in the cloud trail we have only three events that are generated and uh with some differences between each other U uh speaking on user agent terms because the Event Source and the event name uh are appended at the back of each user agent so that's what makes them uh different going down to the boto 3 where we are doing the same exact steps create a user create a access key and attach a user policy to it what events are generated the same three events with just one um uh difference between the previous scenario because the user agent is simpler now because it's not different",
        "across these actions moving down to the last uh scenario where we have the console where things start to get intense now we're not just going to show how much events uh will be uh occurring but we also do a breakdown of each click that the user needs to make in order to recreate the same uh action we did earlier so buck up and let's see what's going on the first click is the console home click or the homepage that we get redirected once we log into the console so that account for 13 events generated now let's put that to the side and keep track of the total number of events typing into the search bar or searching for the IM service holds one for one event and immediately we get thrown at the IM dashboard for a total of eight events so we have nine events going on there we have the IM user click or the user breadcrumb uh underneath the IM service and that holds 18 events uh",
        "generated and we're going to talk shortly about this uh worst C scenarios of clicking uh this breadcrumb and this is a pretty good decent scenario since we had only three users available users uh to list so we have 80 events there now we are starting the creation of the users so until now we haven't even started the uh process and we got 30 plus events create the create user button holds four events immediately creating or U attaching a user policy to this user which has 15",
        "events after this we uh is the final step of uh this user creation which has three events and immediately we get redirected to the permission tab of this newly created identity so 13 events there and surprisingly we have only one event generated from the create access key action the user agents that were",
        "present are shown as we have only 10 events that are generated from our actual user browser and the other user agents consist of Health ews internal",
        "and some different",
        "uh Java CLI user agents and if we were down to look closely on them highlighted in green and yellow we'll see some differences between their versions so for all of you threat Hunters over here who are trying to do some sort of statistical data or baselining on these fields make sure to First do a good normal data normalization on them for",
        "comparison three input events three output events for both AWS CLI and Botto 3 so very clean very simple and 73 events generated by those nine clicks that we did in the uh console I mentioned the worst case scenario so here we go we thought it would be interesting to approach this with a mathematical uh formula so for this particular click uh we have the constant one which is referring to the Anchor uh event five * n where five is the five grouping of events and N is the number of available users so we have 15 there and again the access keys where a user may contain zero up to two access keys and in our case we had only two events for this so 18 in total but let's increase the number of uh IM user and start listing them for 20 IM users we get a total of 141 events let's try now 50 we have 3 51 events and now let's try the maximum number of I am user in an account which is uh 100 and we get 701 events generated by that simple click we",
        "approached this uh with with other services as well and we have the S3 service over here where if we have 100 buckets available and list them we'll get 421 events generated back to you",
        "Debo thank you so how do we make sense of all this noise you know we've gone through we have tons of Excel spreadsheets we've consumed lots of coffee we've made tons of notes on all these different events and we've broken it out into the anchor events the required events the optional events but really we're just trying to bring meaning to a messy situation and aggregate this knowledge so that we can take all these input pieces of information and say these are when im am users was clicked or this is when a user was created or here is when an access key was created and by the way we also want to be very particular about the events that we know are not associated with input action and let's move those health events um out of the way so what's the solution mapping",
        "um the way that we approach this problem is it kind of a two- pass approach the first pass is based on adding labels to individual event evaluation um and then we go back and uh and evaluate all the neighboring labeled events and that's where we have a concept of a signal being created and when we say signal we kind of mean like think of it like an alert or like a mapping a click has been mapped to this uh grouping of events um so first how do we Define the signal um well we focus first on that anchor event optional event and required event breakdown just like we showed in the previous uh slide and we also have metadata about the event you know what's the bread crumb Trail how do you get to this click in the AWS Management console what's the URL what's the summary and are there fields that should be uh dynamically updated based on the anchor event or any of the optional events that are present uh in that click um and then we have additional options down at the bottom for increasing or decreasing the look ahead and look behind uh when we're evaluating the signals for all the neighboring labeled events um so pass number one is ADD adding labels so every single event is evaluated individually and then based on very specifically specific criteria of user agent request parameters which ones are empty which ones are not and to then say we're adding this label or as we can see here these labels are all being added in this very particular order to this one event these labels will come back in the second pass um to then say let's now go back through all the events and we're going to stop at every anchor event think of an anchor event like one of the required events so for every event we evaluate all the labels if any of those labels said hey my definition says this is an anchor event for my scenario now that has received the anchor event equals true flag so we go to Second pass every event we stop at every anchor event and then we take that anchor event it labels and we go label by label and then we evaluate the signal logic so each label will say my logic says go backwards 3 seconds and forwards 10 seconds and look at every single event that also contains the same label pull all those things together and then evaluate that against the signal if all the criteria is met uh then create a signal for this and then Mark all these events as accounted for they have contributed to a signal they cannot contribute to another signal and that's how we group those together um there's a long list of additional things that we thought would be cool to do most of them are things we just had to do there were so many weird situations that we had to account for um so as you saw in the signal definition we can dynamically modify the URL the summary we basically want to provide as much uh easy to consume information to the users as possible so you can literally see if they clicked on the everything bagel user here's the exact URL that has that information uh if they clicked on IM users and it was those uh 100 users then we want to list those 100 users or list the access Keys associated with them um all this extracted information we use to update the summary or the URL we also have an uh Json object called it additional data so you can always programmatically access all the information that we gathered for these signals and we actually do that too because in the last bullet point we have the ability to do look backs um so sometimes when we get to a certain signal we might look back and say actually we need to modify that last signal based on what our current signal is other times the current signal could happen in four or five different places in the Management console so we need to know what's the last signal that just happened within the last 10 seconds um if that was I am users create user then I need to basically pull information from that signal um like what's the username or what's the username of that we're adding a key2 or something like that we also have the capability of merging existing signals this is important for very long running um long running signals where we don't want to define a super long look ahead but we can basically merge adjacent signals um that are identical and have matching uh extracted data um and so yeah there's a lot of there's a lot of weird tricks that we had to do uh still give give us some headaches to this day but it's pretty cool um it was really a fun uh fun problem to try to solve um so enough talking enough slides let's actually look at a demo so we have two quick demo videos here um and so for the first one we're basically just going to uh if we can go and play that we're basically just going to walk through uh what like how does this all start well a user logs into the Management console and starts to click on some things um so uh we're going to go really really fast to cover a couple different examples so if a user goes in uh they've signed in the console home they clicked the IM service they've listed some user groups uh they clicked on users to list them and let's just choose a user in this case Zero Petula uh we had clicked on the permissions tab security credentials in this case let's actually let's let's enable a login profile hackers like to do this so now this identity can go in and access the console maybe we want to create an access key for ourselves well there's already two perfect deactivate one delete it and now let's go and create a new access key for ourselves uh and these are precisely some of the steps we see attackers do uh once they log into a console session um so now we have given ourselves a login profile uh we have created an access key next let's go to Secrets manager let's start to enumerate some secrets and see uh what's available what values might I be able to extract from this environment another thing that we see attackers do um in this case there's only five Secrets um so we'll click on this one open uh we'll look at the overview page and then we'll click on um the uh retrieve secret value so that we can uh look at that secret but you know what this is kind of boring let's actually open up cloudshell just like real attackers do and let's programmatically extract all these values into a file called secrets. Json and then conveniently we can just click and download that file out of the console all these actions are recorded in very different ways and pulling these all together was another great headache but as you'll see in the next video in just a minute uh it's pretty pretty neat to see how all this can come together in a readable fashion so there's our downloaded file next let's go to the S3 service um who doesn't like to look at some buckets um so uh we're basically going to list at some buckets um and then uh we're going to choose one in particular um to click into and so kind of keep in mind these different names that we're clicking into so zero flea bucket we clicked on the objects tab permissions management access points um and then lastly let's go to ec2 um this is one of my favorites um the EC dashboard is not super uh interesting from a volume perspective but that second one there ec2 global view this thing takes so long to run there's literally a status bar so you get really interested in how many events are actually being generated behind here the answer is over 300 just for this one click and we don't even have any ec2 instances in this environment um so it's pretty uh pretty fun to watch so in the next video we'll see uh is let's actually do something with these event logs um uh you can actually query event logs directly in the API and pipe them into the our tool um in this case we've actually downloaded this session and put it in the demo folder of the project um and so we're just going to pipe that into add signal which is adding the labels to the individual events it's doing that second pass in generating signals based on the aggregation of that data let's just look at a couple of these and convert to Json real quick so you can kind of see that we contain the original event and we also contain the enrichment object on top of it in this case this event wasn't part of a signal so let's actually add update our query to look for some examples where a signal was generated so we'll call this a signal bearing event so so this event is I am list users should look familiar uh and then our signal here is really big uh it is saying I am users was clicked um and by the way it was 33 users that were shown here are the users 62 access keys at this time were present with those identities and here they are here's the URL and all that data we extracted is again in that additional data blob so you can programmatically access it however you want so we have some interesting context about this environment without needing any additional API calls just from this offline log analysis um next we're going to do event summary um this is going to show all these events colorcoded to see which ones were actually part of a signal and then we can see the signal on top of each one pointing down and this gives us a little slightly better view into what the signals were um any extracted values are highlighted in green as well but let's look at this one this is that Secrets manager where we clicked on the open y user um so here uh we can see it's these four events let's actually add a little more detail and so let's say show me details about each of those events so now all four have a detailed block underneath um so that first one is the anchor event that was evaluated for and we can see it had four labels the first two labels the look ahead look behinds failed the third one was successful and we'll see all the other events were also successful for that label that's why they were grouped together as part of this mapping and then anything in purple these are really helpful values for creating the labels um the request parameters all that stuff and so we wanted to make it easy to use um whenever you're uh debugging or adding new uh new data to see what are the precise request parameters in user agents I need to Define if I want these events to be part of a new or existing um signal last lastly is a session summary so just give to me one line how many events contributed to this line and then what are events that did not contribute to a signal so we can kind of see at a high level again the extracting information um is highlighted in a different color and then at the bottom uh we have some stats just on the number of labeled events mapped events as well as what services were involved in the mappings and then for all the unmapped events what were the services that were involved six minutes um and that is our",
        "session we were already motivated to do some front end uh stuff in order to give the you a more friendly approach so here we are with our UI visualizer we have uh three additional buttons at the top right corner where you can click the maap to get the mapped events the unmapped events Etc the table view is supported with Dash AG grid so you have that all these cool features of AG grid like uh filtering uh based on different conditionals um rearranging the columns",
        "also um even sorting on different columns we also gave a search filter where you can uh search as you type and get U the view from all of the uh Fields also uh instantly G uh getting the uh",
        "information on the place holder above it for in two uh different perspectives from the events and the total number of",
        "rows all right so if we can go back to the slides um that that's the Tool uh we've spent uh almost a year developing in this with many many hundreds of hours and again I think my eyes are still red from looking all those Excel uh spreadsheets um so we're really excited to announce that this tool is now uh uh officially live we'll have the link on the next slide but let's wrap this up what are the three takeaways here uh console sessions still matter attackers still use them and probably more importantly for most organizations is normal users use them you still have to look at that activity and know is this normal user activity actually normal um is it something that we should be concerned about uh and we seek to bring Clarity into those situations uh through this tool um the second is understanding what your Cloud logging options are uh what are the limitations uh what are the attention uh issues do you need more attention uh from a policy perspective uh what tooling do you have available to look through these logs and are you doing anything with it do you have the Personnel or the capabilities to make sense of what's in the logs um lastly is uh We've released this tool so that the community can use it and hopefully benefit from it and even add your own signal mappings to it um to to basically help it' be a more robust uh uh capability for uh for the community um",
        "and uh with that we just want to say thank you so much for your time uh thank you for your patience uh with it with the delay earlier and uh this has been a lot of fun for us um and uh here's the URL to The Tool uh and here's our social media information we'd love to before we ask for questions we'd love just to say always feel free to reach out whether it's in this room uh if you see us walking around we have some fun stickers to give out um but but yeah we definitely appreciate talking with the community and so look forward to saying hello uh and with that thank you so much for your [Applause]",
        "time any brave souls for some",
        "questions yes I think there's microphones in the aisle there thank you guys um thanks for being here um I am",
        "background I am a threat detection response cyber security analyst so um I am the ones that benefit from your kind of work um but one question I do have um we often have to disable some alerts SL signals based on the amount of false positive alerts that we have So based on your work here what have you found that can decrease the number of false positives without increasing the risk of missing true positives yeah that that's a that's a great question so nice nice to meet a fellow Defender so um yeah the question was like how does our tool help reduce false false positives um so what I would say is our tool seeks to bring Clarity to a lot of events and give you an information on what that event was um if in in uh I don't want to do any vendor bashing um but for example if we were talking about guard Duty alerts in AWS this is precisely the kind of scenario that we see a lot of false positives with when a console session occurs because there's all these crazy events that have never happened before a lot of them are related to I am and a lot of those guard Duty alerts will say anomalous IAM privilege escalation stuff and the reality was you just click to view some users like that that's it um so our tool does not directly change any alerts in fact all the mappings are not we don't view them as alerts we view them as a simplified way to say instead of there's a thousand events there's 45 events there's 45 clicks that occurred and now you can kind of decide um is this is this normal or not um uh and so in some ways the way that guard duty is uh I'm assuming baselining the activity we kind of view I mean we view that uh in our team as how can we Baseline these clicks instead of baselining individually hundreds of events how often was IM users clicked how often was S3 buckets permissions clicked or object or management um so this does not change noisy alerts from other tools but hopefully even in the light of those noisy alerts you have a little better uh read readable way to look at that information to say was there really something interesting going on in the session or were they just clicking around uh looking at some users and buckets and stuff like that um I I hope that at least partially answered your question but thank you great question by the way yes hey guys uh awesome work by the way um so I just wanted to ask like obviously Cloud renders they don't come to you and say like okay we made a change to our loging things have changed so update your detection so I I haven't quite caught how you guys like you know is the signal creation process is quite manual at the moment have you guys considered maybe automating it and if you had what was the some of the channel challenges you guys found would you say it's pretty manual I mean yeah yeah yeah the question you around is there any way that we can automate some of this because you all right it is a very manual process today I would say some of that manual process probably is like uh quite personally my level of OCD and wanting to understand truly all the differences because we don't just want to group logs we want to say what are the unique values from those logs we can pull out and say these are important context um but but even some of the mappings we did a year ago and then retested some of them now some of those had slight differences like like the ec2 service uh where it used to log a certain event as the AWS internal user agent now logs your web browser user agent in some of those clicks um so I think there will always be those kinds of scenarios to to manually catch up um Andy I know one of the first things you did was actually I think your first uh one of your first approaches was to have like a a browser Plugin or something looking for the request but but I think kind of the pong scenario was there's only so much you can see browser side that ball gets bouncing around in the cloud uh and generating all those logs that are absent from that view so uh we are certainly open for suggestions if there are uh more automated ways to do it uh and would love to spare people some pain from all those uh uh blinding Excel spreadsheets for our for our tracking yeah would love to hear your ideas if you have some around that but great question perfect sounds great thank you any other",
        "questions awesome well thank you again for your time and we'll be around uh if you see us say hello and thank you again have a great day [Applause]"
    ],
    "PSaix1C-UMI": [
        "hello everyone uh Welcome to our talk today Chinese AP a master of exploiting H devices uh this Charles and my partner uh Greg we are from F to give this to give you this talk okay first part our agenda uh in",
        "the first part uh I will quickly go through our findings of explo Trends",
        "after that my partner Greg will continue the case study of weaponization H device and in the third part uh he will give you uh the feature of mware implanted in h devices and we will end with medication and response",
        "suggestions okay the first part uh exploor Target had changed by Chinese APD",
        "actors okay uh I would like to store from the screenshot of the cont contag d block uh in case any of you uh knows it",
        "it means uh you are old guys like me that has uh done mware analysis for more than 10 years this block was a great resource for me to obtain juy speed fishing email exploor document used in",
        "Chinese in APD attacks especially China",
        "or North",
        "Korea okay uh in this slide we try to outline some uh serious exploit du exploit document cve that had triggered big campaign of attacks in the wild they belong to most file types you use every day including Java PDF word excel",
        "PowerPoint Etc so they could be",
        "perfectly combined with social engineering tricks to deler Target to",
        "achieve precise targeted attacks this",
        "exploit document marked a golden age of",
        "spe fishing email attacks however things started to change",
        "in 2008 Microsoft released their Windows",
        "Vista sp1 that equips full memory",
        "protection like SLR D stack cookie SE",
        "SEF Etc and in 2010 Adobe noticed the",
        "severity of exploiting their products",
        "and they decided to introduce sandbox protection to their PDF reader as well as their fresh player lastly the concept",
        "of uh endpoint uh detection and response product EDR emerged and uh after all",
        "this mitigation and protection become common actor can no longer achieve a",
        "remote C execution exploit by just utilizing a buffer overflow but instead",
        "they have to change several exploit such as information leak and sbox escape and",
        "that changed",
        "everything our research shows a new tendency of exploiting H device for the past three years especially by Chinese ABD actor okay first by definition uh an",
        "H device is an end point on network and it acts as an interface between the dat Center in the real world usually it collects or communicates lots of information also this feature makes them a great Target for APD actor to collect intelligence further after covid-19 more",
        "and more H device were opened for Corporation entity to serve their work",
        "from home",
        "requirement uh I will start from this slide list of sever security advisory",
        "published by uh various government entity around the globe warning about notorious Chinese AP actors that",
        "includes Cesar's warning about V typhoon",
        "FBI's indictment of",
        "ab31 Japanese priest warning about black",
        "Tech exploiting Cisco router over",
        "Netherland government reporting about",
        "some Chinese AP exploiting in some H device in an attempt to infiltrate their",
        "military",
        "entities so uh in The Following part uh we would like to uh explain and discuss why Edge device they are perfect Target for Intruder and the imbalance between The Blue Team and Red Team in this conflict okay first uh most H device",
        "They Are CL playform they usually draw",
        "feel attention for people's daily work",
        "this nature makes them to have no antivirus or EDR",
        "monitoring okay even sometimes there are incident detected it usually has no",
        "interface for incident response team to",
        "investigate lastly there might be some third party vulnerable component left",
        "but no one noticed for example there was a serious barracuda email gate security Gateway targeted attack last year and",
        "the root Coast was proved to be a plaral Excel file passing Library",
        "vulnerability uh this H device usually don't equipped with modern exploited mitigations for example there was a serious viability in Citrix ADC device",
        "and the fact that it lacks SLR protection makes a ERS uh exploit",
        "development and weaponization process",
        "very smooth so they can quickly attack in the wild also AG EDG device they are",
        "difficult to patch the first reason will be their position in corporate Network makes their service suspension can barely tolerant also their patch work",
        "usually have to be done version by virsion and you can imagine uh usually you don't want to patch this device unless there is any serious uh uh",
        "varability discovered so in that case",
        "you have to uh shut down your service and spend lots of time to do the patch so that uh worsen the patch headache",
        "patch management headache a lot okay the worst scenario is probably that there are cases that you don't even have a p H to apply this H device usually live long",
        "that sometimes and vulnerable device is in an end of life State also as we noted",
        "as we stated the barrier to bind and weaponize zero day is lower in h device so that it is very likely there are zero day exploit circulated in the wild so",
        "all the above mentioned facts makes attack and defense on H device a very very imbalanced conflict and all Factor",
        "are unfortunately in ATT attacker side of",
        "favor uh in this slide we try to list uh some zero day",
        "exploit exploiting this H device and I",
        "believe you can find lots of Open Source information about their uh campaigns a",
        "Tex however in the last part The Raid one uh later my partner greig will uh use our findings and Discovery uh in Taiwan to give you to share you some experience how Chinese AP explo this",
        "device and how do they uh leverage uh this device since CH and I'm and the CT",
        "researcher from the T5 I'm going to discuss the case study of the weapon light H device the first case the Chinese at have abused Z VPN to build the b in Taiwan this year T is one of the wellknown network device vendor in Taiwan I would like to introduce the an",
        "group the S 56 s 56 is inches in Edge",
        "device such as a s c assus slou after",
        "let compromis H device let imp SU",
        "demons and use the Safi demon to spread some disinformation related to Taiwanese government so back to the V detail to achieve the remote Cod execution require compile two viability the first one is sity to bypass the authentication and",
        "that it can access some auen quite the Bal and another party is belong to the command tion party also both of the",
        "viability are are all paged in the new model 50 or 60 but uh the second is",
        "still available because the the old model US 20 or 40 that orig the end of",
        "life",
        "status and and after compromise Ed device the translator the install the emerg bar for the for command and the control Emer bar is belong to the t for this door and you also belong to the P knocking door when we talk about P knocking door in the next session and the trans has abused this Z",
        "day is still a z day and so we cannot Ral the V detail although the vendor has already released the C page however um",
        "the page is still incomplete is is able to let the actor to explo to get the Shi and without authenication and the a also can impant the m we and but the we find the 28 imp the Microsoft Plus on this Lou micros is",
        "Bel to a welln open source lightway posy lightway posy abuse to relay H to high layer attack source and then one tries to check the source IP connect to the Microsoft is from the Alibaba called host in Hong Kong and let abuse the Microsoft try to spread some the fake news related to",
        "Taiwan and the SN thesis also compromised another device sof firewall",
        "and we find a new M with equipped war in jary last year and they Abus both of the",
        "H device the sof Fire War and the service louter they try to spread some the disinformation before 20",
        "24 the Taiwan is presidential Taiwan",
        "elections and the find the mware has live in the s for one year oh my favorite translator the transl has already s tra for the one",
        "years this is the example of this information the picture is from the PTT g board the PTT PBS is one of the Taiwan is famous the online forum actually",
        "current Taiwan government is considered to the anti-china party and the pursuing a pro policy and thisinformation",
        "translation is delayed to the Taiwan government so civilians the personal information to the united state government the also pretend uh he is a cyber security engineer in the T commun company and he has EV evidence that oh",
        "he pretend he has evidence that Al s our sequence to the United State and we trck check the source IP address we fin the IPS is found the compon s f in Taiwan and the compon f is also impant",
        "by the Sai",
        "server the translator always compromise",
        "HD as a compromise C2 in order to hide the attack source take the C uh in the December as a example the S explo the C Fusion uh for initial access uh to the government servers and although the C is not belong to the H device but the during the offensive operations the at Abus the",
        "compromise H device in order to to hide",
        "the attack source and then we check the IP is from the assum slou in the Ty one and dur analysis the C2 INF we find another the H device the high conv Vision DVR also Abus as a compromise C2",
        "so we believe for the trans header has already deployed the infrastructure for the compromis",
        "device trans May compromise all kind of",
        "VPN devices such as event C40 G uh in",
        "order to uh L movement",
        "menu pass is known as ap10 they compromise the lwork VP to conduct",
        "little movement to compromise the inet to Japan this C is also belong to a go in the wire the S the s number is asside in the March next year but the is detail",
        "has already published the found Chinese book it it discuss how to pass the license Checker of the other network how to jailbreak the V Dev and how to achieve the code exclusion from the page and then we also find allow Z and one have already report to the network the Z can upload upload file and thework has already fix the Z day and the tt5 also intercept the manual pass prop properly man way the big is Bel to Windows mware in the Intranet",
        "the main purpose for the AP Group Play One the steal the Sens Sensa s 57 as",
        "know as the the an 4841 by the mum is well know to compromise the bod ESG and",
        "they also compromise such a Juni fire and another male Gateway in the Taiwan the email SEC always deployed in the EM",
        "server in order to check the manous email and the bla has compromised to",
        "steal the male content such a male",
        "attachment si7 they explo the s number",
        "of commen during the unpacking uh the",
        "attachment in t the ACT sending a manous attachment with craft the T file during the unpacking process they check the Comm injection and at they Lun the reverse sh to the actors and we found the qu the quick T file in in 2024",
        "against the p as a J in the wire and they also has another c number trigger by the third party Pro Library during the passing the Exel",
        "for in in 2024 s 57 they also compromis another",
        "the M Gateway in Taiwan when when check your T5 internal is is belong to a one day explo the loose is a CV 223333 by",
        "bar during the UNP the attack is very similar during the unpack the craft I fa and you drop uh you lead it to the P ver",
        "and to cause the up fire so when the M",
        "unpack the IR file you may imprint the children and then we find imputed new M world I show I will talk about it later it's difficult to check the mware",
        "from H device because most of H are belong to the C in BP yet you have no uh Shield to access",
        "that the first case is about P knocking back door p is very popular features in",
        "the compromise by translator",
        "this one is the compromise H device and they are imping to the P the P always l a lowlevel circuit such",
        "as the UDP or connection circuit or the p p pickup signifant in service and the",
        "the actor try to send in a ma stream with the encoding C2 and the mware compare the main stream",
        "and the decod C2 you try to launch the second stage back door from the new C2 because the C2 uh is hidden as",
        "assigned during the appliation it's difficult to identify and the B C2 and if the C2 was a filter L can change the other C2 during",
        "operation we find a non lock door in the s f the non lock door they create a low Cy to this layer three pay LW when the check is this pay LW is belong to the UDP utod and the compare SM streen and",
        "the decod C2 and the finally the non knock door we launch the C sh integer to connect C through the new T",
        "variant S7 they also devel the",
        "customized the C spy or the C special the bakuda ESG and the S deod receiv enod by this",
        "ma from a low label p s traffic and this",
        "C Lunch is the Ed to normal L SCP and",
        "the during the",
        "attachment and if if the C SP find the m f stre with such special the F or SP and",
        "with a spal the PO spe and you will try to launch next and with with a new",
        "C2 because the uh most of the F system of the backod is incub through the two stage encryptions the first a is in the initial loes and the second is lookus in the hard disk so the back door are also encrypted it's more challenging to get to retrieve the mail where the only PR Text data is only in the this n kernel so when trying to a the kernel it check the Lucas key and try to D the file Sy",
        "memory in 2024 we find a new 6 by",
        "variant with ice Rao when you find the I show in crafted I file trigger by this CV number I show support the simple reversal and the fire appliation if the traic is in the traffic is imputed the best and coding and after receiving the new Matrix stre the new C two body and the integral I as the next stage stage rever sh more and the more example related to the P sh the the C top in the 4K repti",
        "imp 4 minut P knocking B has become kind of a feature of the or the trans space for the Ed",
        "device leaveing of a l binding attack in the EDG device the B is make use the legis system bind to achieve the malicious",
        "purpose te is v as a example they",
        "replace the content command light interface Banner content uh with the conversion file and and to in order to leak the administrated credential file",
        "at also can upload the mware so the file related CGI and the turn of theel provided binary uh to achieve uh uh to",
        "to turn of the F and to achieve the the Comm the Cod execution so the finally as this picture is a command injection viabilities and use the ab use the the Comm to achieve the code execution and",
        "most of the web server only L the HD qu URI and the they result of the post content data so the people in charge of the in response they may think uh all of the manage qu are",
        "normal uh the final set about our recommendation how can we mitigate and respond this kind of take",
        "the most of the H device are belong to the internet facing end point but the wind Str kind to disc un needed access",
        "to the internet fa import for example we have mention in c g day uh of the seven",
        "slou uh the attack interface is found the web administ interface Al is belong to ampest the but you can restrict the",
        "web Adra interface only in the lens side instead of the wind side while the sound service must be open such as the VPN or emqq Gateway applying the page still the",
        "best solution and we provide s the kind of indicator to Le the first one the high CV score uh should be means high should P page in hyper and",
        "if the vbd has already public disclosed",
        "and if the CV has has P Cod from",
        "Gab are also easy to weaponize it's C uh",
        "the one is is in wir last of all provide",
        "related context for example the cisa no",
        "also PR such information and the Microsoft Response Center also relative connection but how about the Zer in a wire is a difficult problem no pure",
        "available uh it's difficult to mitigate that this kind of attack would you come and try to keep the log as compet as",
        "possible and try to keep the SS log and a out of H device because H device they",
        "have a limit the storage to store log and the log may be L me some critical indicator and some",
        "experience Ed they may wipe the log they try to keep the log off the Ed device make the actor too difficult to modify the log and we also do try to understand",
        "actor like understand your device has",
        "damage L have the cility to F to for your H device and as also devel custom build back door speci by your H device and the all the material are from this is from our inside report when try to help our kind to more no more amount about the related viability and no more about the attack to provide a medication and response",
        "report more challenge te find more and",
        "more the H device are compromised to build a bner the H device found the different model such as assus TP link",
        "and the we find L all imp POS demon listening on the L pole and the all TR encrypted beside it has a complex assess",
        "assess credential each each compromise",
        "device has unique credential each one has different password uh the this kind of positive and are widespread in our H device so T5 as going to identify this kind of comom louter and try to identify the POS",
        "server okay it's end of our presentation for your time I think we can do we have any",
        "questions sure",
        "if it works yeah on the slide where you have um link between",
        "the compromise device and the PTT",
        "website where they posted information",
        "relate to uh election uhhuh um what was",
        "your sequence of Discovery did you first discover the PTT post and then you looked at the IP address where they posted and you found that it was the H device or did you find first the compromised hwi and then you found the the public post okay yeah yeah uh it's a good question so uh it was during our presidential election time so lots of uh fake news rumors circulated on internet try to influence our uh election so in the beginning we uh yeah we identify such kind of uh um disinformation",
        "message on our PBS then uh uh because",
        "it's an old play phone so it display the uh poster Source IP directly from that IP address with the some profiling and we identify oh it's an uh some H device and belonging to some uh uh specific uh",
        "uh vendor and uh after doing more research we realize and uh we pivot to more related uh fake message and uh we",
        "uh Identify some vity and the Campa",
        "behind so you actually confirmed that that IP address 60. something it's a compromised device right you did forensics on it yes okay and what was the initial trigger for thinking that was a fake news just because because of the wording that was used in the message uh good question because",
        "um yeah as I mentioned it was during election time so so uh actually many uh think tanks government entity uh we are very sensitive about such kind of post and we monitor uh many B accounts as well so when we uh in the beginning we see such kind of uh suspicious message but uh after that we will do cross check about the accounts past history and his",
        "activity his log in uh Source IP address",
        "so uh in the first moment we judge okay it should be some fake uh information uh",
        "posted from some but account okay thank you thank",
        "you any more",
        "questions hello hi hello um if the um",
        "the threat Act employed some mechanism to ocate the IP address of the compromised Edge router would that have",
        "hindered your ability to determine what uh what the scenario was or or how how how the attack had been implemented such as the CDN Cloud flare would would that be an appropriate mitigation uh Factor",
        "but for the threat actor yeah I think the main purpose they Del such kind of uh Edge device uh is to uh hi their uh Source IP address where are they from and anti- tracking and",
        "attribution so you can uh you can think of uh that okay uh we believe many trans actor they try to build such kind of bnet so in case they want to do offensive cyber operation they can first dial into it and their uh traffic will be rooted several times and find an exit node and do start it to their uh suspicious operation so in that case if we want to trade back we need to find H by H multiple times that is a very challenging work and uh yeah sometimes it depends on luck to find their final real location and and maybe you could have a round robin list of compromised devices as well so that significantly increases good good good suggestion yes we are doing such kind of experiment we try to list some highly dangerous vendor of uh H device and try to profile them yes great thank you thank",
        "you helping y okay I think we are",
        "running out of time so if any of you had any question feel free to uh oh sorry okay yeah so um last year team T5",
        "presented on um operation Clairvoyance or t Leen so how does is this related to that or or is this like a completely different um set of attacks uh I would say different uh in that operation we mainly uh talked about uh AP",
        "intrusions uh in this case uh it's more",
        "about AP actor leveraging compromised H",
        "Dev to spread this information so",
        "different case but yeah I know they are all uh election related",
        "okay thank",
        "you thank you than you"
    ],
    "braWTvU15QE": [
        "good morning it's a good turnout thanks for coming the recent cyber Chinese cyber operations are different this presentation will investigate why they're different this was my personal research project which I've been undertaking for the last couple of years is just that it has acquired a whole new significance in light light of the recent Vol tyon disclosures this presentation would also help us understand how we can leverage geopolitical and geostrategic Analysis",
        "when you start hitting the limits of technical analysis so let's get jump straight into it mandatory disclaimers first the views expressed here are purely my personal and have nothing to do with my employer another disclaimer when I use the word China or Chinese they imply the state and organs of the People's Republic of China the PRC set up by the Chinese Communist Party the CCP it has no judgment whatsoever on the fascinating Chinese culture society and history now I'm using a method of intelligence analysis where the summary or the conclusion is presented upfront bottom line upfront or Bluff as we call it so the grand summary of my presentation really is that the recent Chinese cyber operations have all the Hallmarks of a military mobilization what in military terms is called the operational preparation of the environment and the idea here is to support future military operations using what has been done now the grand objective behind this is not that Sinister it is to basically secure the prc's geoeconomic interests in the region especially it's near abroad and to be really honest this is what any great uh any Rising power would do now there are couple of pillars to my presentation which I'm going to deconstruct U or summarize in the beginning and then we'll delve into them in detail further on now the Strategic shift that we are witnessing from traditional cyber Espionage operations is mainly about the use of information Warfare to gain airspace and sea dominance in the South China Sea the control would be gained by attempting to disrupt the US the United States uh logistical supply lines the sea lines of communication and its Naval power projection capabilities in that region while the Cyber targeting is global I strongly believe that the focus",
        "is quite local to the sphere of influence of the PRC especially limited to the South China Sea in terms of the architecture of cyber operations the PRC civilian and threat actors have been absorbed into a a wartime construct called the information operations Group which we'll talk about later second part of my bluff is that the reason why we seeing so many Tactical iCal infrastructure overlaps between various threat activity clusters and threat actors is because of the absorption of the civilian cyber",
        "infrastructure into the military command control What's called the information operations group The civilian authorities also deemed as what they call authorized forces for that",
        "reason and this is quite unlike what say the de Democratic countries are used to where there's a clear delineation between the civilian and the milit authorities we look into that what what's a precedent there in terms of the command control the Strategic cyber operations are being authorized by a highly concentrated highly centralized",
        "National command Authority called the central military commission which falls directly into the Chinese Communist Party the CCP and apart from the grand objective the key operational or political military objectives here are to use information and cyber operations as a first strike capability before for the onset of kinetic or physical",
        "Warfare there's a second objective as well to use information in cyber operations to conduct political or cognitive Warfare below the threshold of armed conflict to disrupt the polit the adversity's political",
        "system now having said that let's start deconstructing what I have summarized the agenda looks roughly like this we'll talk about Vol typhoon and red Echo we look at the elephant in the room that's a the Strategic support force of the people's Liberation Army we look into the the Communist party's information Warfare command control we look at how the desperate civilian elements are absorbed into a wartime construct using the information Warfare uh function uh construct called military civil fusion and we'll sum it all up as to what what's a biggest story here and then we'll briefly jump into the geopolitics of the indopacific which is really driving all this and then we probably have five minutes for questions",
        "now this is going to be fast and furious presentation um so pay more attention to what I'm saying instead of uh the slide deck you can always refer to it later a little bit about myself I'm a blue teamer in the day and a geopolitical Analyst at night uh more than a decade back when I joined the Indian government uh I realized the tremendous potential which cyber operations have in changing the global balance of power so I became a student of geopolitics and geost strategy on my own and my background is in Mal analysis I have a computer science engineering degree but I recently acquired a degree in cyber geopolitics from the Australian Defense Force Academy I'm based in Australia as well uh this was to ma majorly gain formal recognition in geopolitics and geost strategy I started doing my own research and now my geopolitical and geost strategic writings have been published by the US Military Academy the the US Army the Australian defense College the Australian strategic policy Institute which is a prestigious think TK in the Indo Pacific and the Indian army now my analytical methodology",
        "carries a unique Fusion of geopolitical and geostrategic Analysis and malware analysis now given the new disclosure on Vol iPhone which are quite Sensational I'm largely going to six I'm 80% of my presentation is around geopolitical and geostrategic Analysis",
        "because that's a part which is quite difficult to decipher and I believe the audience here the kind of audience we have in blackhe hat is well versed with technical analysis Mal analysis and information is out there a lot of information the open source and Vol tyone which you can go through so I also want to show showe how we can leverage geopolitical and geostrategic Analysis when you start hitting the limits of technical analysis let's jump straight into Vol typhoon so may",
        "2023 there was a simultaneous disclosures by the intelligence agencies of the five eyes that there's a thread actor called volt iPhone which was targeting Western critical infrastructure there was a clear de deviation from traditional intelligence operations uh that attributed to the Chinese thre thread actors and the intent as was was expressed there was to clearly preposition itself into Western critical infrastructure the thread actors were known to use primary living of the land techniques and Hands-On keyboard activity to maintain Fair bit of operational security and back then when that this dispatch came out we knew that the thread actor was probably active since mid mid 2021 there was a simultaneous Disclosure by other cyber security companies like Microsoft as well so that's where the story started then between December 2023 and January 2024 lman and network security analytics company uh traced a a specific component",
        "of vol typhoon's command control infrastructure now that command control infrastructure was built on endof life devices small home office routers which were quite easy to compromise so these devices were then all cobbled together and were a used to build a multihop anonymity Network to provide anonymity to the actual operators who were hiding behind this command control Network interestingly there were two broad activity clusters which were using this command control Network this anonym anonymized command control Network they were called the KV cluster and the jdy cluster now the KV cluster which was using this anonymity Network relied more on Hands-On keyboard activity and they were using this C2 Network for U targeting high value",
        "assets but the jdy cluster was a bit more noisy they were doing more opportunistic scanning and targeting reconnaissance so it feels like the KB cluster was quite focused on operation security and there was a clear overlap between this anonymity network with volt iPhone now the key procedure used by Lumen to discover all this was Global Network Telemetry analysis which tells you uh maybe what are the challenges behind say detecting the traces of this",
        "intrusion as the timeline U Move further on more disclosures happen and you can see it's the my timeline is pretty crowded now so I won't go into all this in detail but what I want to showcase here is that this activity is still ongoing I kept on updating this light deck uh since last week till last week so in January 2024 there was uh the Department of Justice of the US took down the K botnet which we talked about earlier they they found a weakness in the command control to take it down uh This was done remotely it's very interesting there was second FS disclosure in February 2024 on the same Tractive Vol iPhone and this time they mentioned hey well we thought this activity was active since meid 2021 no it's not it was active since 5 years something really interesting going on there and they also confirmed that the ttps were Hands-On keyboard activities combined with um living of the land techniques but they also mentioned that the thread actor was using extensive pre-c compromis reconnaissance to make sure that their operational security is tight and then there was a dragos report in U in February 2024 they were and further on as I kept on tracking this these developments in March 2024 the US Department of Treasury",
        "declared some sanctions against individuals belonging to APD 31 we'll talk about that in a bit but APD 31 is known to Target end of life devices since 2019 so interesting some of the",
        "victimology of the AP 31 group in that indictment quite aligned with W iPhone so ab31 was specifically targeting investment critic infrastructure as was mentioned in this indictment but",
        "interestingly the US government did not clearly link into Vol iPhone they did not say ab31 is Vol iPhone so what's happening there we look at that and then between January and April 2024 you're probably tracking this evanti zero days were exploited and Vol iPhone was trying to use these zero days as well so a lot lot of activity happening even till now till till last week now let's summarize Vol tyone in a bit U so the target geographies which it targeted were continental and the non-continental United States non-continental bit being Guam and Hawaii we'll look into that in a bit Asia Pacific and Africa the target sectors were quite startling really you know your electric grids your Wastewater systems telecommunication systems satellite networks and emergency management system now Emergency Management Systems is an interesting bit um note that down because we're going to touch upon that later there were potential tactical and infrastructure overlaps with other threat actor or activity clusters like cost of eight APD 31 which we talked about earlier Mirai botnet for some reason and another activity cluster which was linked to event Z",
        "exploitation if you look at the ttps in isolation they are unremarkable we we known them for years but when these TTP is executed in unison it be the whole kill chain becomes really effective the signal noise ratio is very high so it's they're difficult to pin down and I mentioned they have activ since 5 years I also go I'll go back to the previous slide also want to mention one more interesting tidbit so the US actually had to invoke unprecedent unprecedented powers under the federal intelligence surveillance code the fisa code to start tracing this botn net into the domestic Homeland because that that order basically allows them to setap into local networks for which they need a special permission that permission needs they need to get the permission every month so it seems like the traditional detection approaches at scale were not working and so had they had to go to the court to do some enhanced monitoring of the domestic Network to discover what the targets were very interesting now let's segue into some bit of geost strategy what is Guam we talked about Guam Guam is a US military Outpost and it is the see that",
        "red circle there it is the closest Outpost military Outpost of the US next to Southeast Asia",
        "it is bang next to what they call the n-h line which is a highly contested area in the South China Sea which China claims to be its own yet other countries also claim it so there's lot of contestation going on in that contested area and in the in the last couple of years there has been a massive military buildup in Guam a lot of air and Naval assets have been deployed there by the US which has caused a lot lot of tension between the PRC and the US so it's it's a bit of for flasho and for obvious reasons now let's look at the second military activity cyber military activity cluster which targeted India so",
        "between 2020 and",
        "2022 there was a tense standof between the two nuclear armed neighbors India and China and they have a have a controversial contested indo-china",
        "border as tensions escalated recorded future using the same network Telemetry analysis discovered that some th actor Chinese TR actors had compromised uh Indian critical infrastructure electric grids closer to the flasho of the border and record future also mentioned that the intention wasn't these targets had little intelligence value and so the intent clearly was to preposition in case the conflict escalates so it was quite a flash point that was happening which got de-escalated in 2022 so let's summarize these activity",
        "clusters in which targeted India there was infrastructure overlap with APD 41 Tonto team we'll look into all these thre actors later there was tactical overlap with ap 31 the usual suspect here we look into that the targeting was quite closely aligned with World iPhone apart from the electricity electricity grid thermal power plants SE ports and whatnot the emergency management system which was we had seen that in World iPhone as well was also compromised we're look that we'll look into that why and now there was also Al some tactical similarities with Vol iPhone first of all the use of multihop anonymity Network use of edge iot devices like IP cameras to build that C2 Network and the use of fast reverse proxy now fast reverse proxy is a Nifty Nifty little tool to create a a reverse proxy connection from a compromise Network to the to your to your control Network to attackers control Network it can use Cort channels and fast while this is not a major overlap but fast proxy was quite explicitly mentioned in the Vol iPhone disclosure which were made by the US government so there was that kind of a little bit of tooling overlap there which is really interesting so I would say with moderate confidence that the Strategic Genesis or the intent of these two operations were quite similar that is volt iPhone and the red Echo cluster now what really is happening here let's talk about the elephant in the room the Strategic support Force the Strategic support force is a joint integrated strategic information",
        "Warfare command of the people's Liberation Army think of it as like the US cyber command except that it's much Superior in its mandate as compared to the US cyber command the ssf was created in 2015 as a",
        "part of the larger reorganization of the pla that was going on since the last 30 years it's called the revolution in military Affairs it was also created under the shadow of the Obama Chi talks",
        "happened in 2014 the US government wanted China to curtail its cyber Espionage activity which really hammered the US economy back then and so the Chinese establishment felt that uh they need to probably exercise more operation security for their military operations military cyber operations so it needed a little bit of restructuring there also the the chin Pink's anti-corruption drive also influenced this reorganization so there are two departments in the ssf we'll talk about the network system system Department which absorb the signals intelligence the the network Warfare the electronic warfare and the political Warfare outputs from 3 PLA and the 4 pla it's predecessors these diagrams which I've created are my custom made their high res high resolution links available for download later on and you don't have to pay too much attention to them we can look into them later just focus on my story and you'll get to understand what I'm talking about that there's a lot of bits and pieces to the diagrams and I research multiple sources to create them so there's a lot of sort of effort made around these diagrams to make sure they're accurate let's look at other component of the reorganization the the commands now the pla also reorganized",
        "how it fights integrated Warfare across",
        "its near abroad it's it sh it land and sea",
        "borders these are called the geographic theaters of operation and they wanted to introduce more joint Warfare strategies into it earlier they had things they had entities called the the military regions which were pretty much like the theater commands except that they did not have joint Warfare capabilities integrated capabilities so now we have North West South uh East West Theater commands and Central theater command example being let's just take an example Western theater command which is of course focused to the prc's West that's India Pakistan and Afghanistan and so for so on and so forth so it's more focused on the nearer Broad and keep in mind that the theater commands have some role to play in the Strategic information Warfare capabilities so we'll look into that later now let's look at how after this reorganization how the CCP is built to fight information Warfare and keep in mind I'm not saying this is the pla's information Warfare command control because the pla is a party's Army unlike",
        "say in the in the western Democratic setup where there's a clear delation between the military and the political establishment in in in in one party system there's none and so this is a highly concentrated command control that we're dealing with with now this is the sheer complexity of the information Warfare command control of the P the pla or the CCP you don't have to really squint and look at this the idea is not to look at this I just want to showcase the three tiers to it the Strategic operation and the Tactical tiers through the information Warfare command control and it's pretty intricate we look into the first two tiers let's look at the Strategic",
        "tier now there are two interesting",
        "things about and again uh don't have to really like pay too much attention to look at what it what's in there CU I'll explain that now there two interesting things to note about the Strategic information Warfare command control the first thing is that the Chinese information Warfare command control integrates both the civilian and the military elements so I've shown the Civil the civilian elements in red and the military elements in blue the second most interesting thing is that the Strategic information Warfare especially strategic information Warfare is directly controlled by this Chinese Communist Party through a highly",
        "centralized National command Authority called the central military",
        "commission the ssf the Strategic support Force most likely has its own operational teams or operational bureaus as we call them they used to be called technical reconnaissance bureaus earlier probably heard of them trbs now they call technical reconnaissance bases this the scope has increased a little bit now the trbs have specific missions these missions could be around capabilities could be around geographies or could be around specific Technologies now very little is known about the trbs which are directly under the Strategic support Force if you look that if you look at that sort of the red circle on the far right that's where this trbs likely exist but we don't know much about them but the one trb we do know about from the past is apd1 unit",
        "61398 uh the well-known one and that certainly probably has gotten absorbed in after the reorganization into the Strategic support force and probably exists directly under the ssf so to summarize there's trbs or operational bureaus directly under the ssf and that",
        "matters let's look at the operational tier now the operational tier of course flows down stream from the Strategic tier but we know a lot more about the operational tier most of the Chinese the PRC APS exist here that we know",
        "of on the military side there are",
        "operational bureaus or technical reconnaissance bases directly under the theater commands so they have more Geographic Centric missions like there could be trb aligned with Western theater command and so on and so forth that's shown in blue here on the on the civilian side the State security bureaus which are the provincial units of the ministry of State security you know the famous foreign intelligence agency also has",
        "certain provincial teams which which is where most of the aps exist so if you look at the left where the military trb trbs are you have the Tonto team you have the tich you have blacktech you have Nikon and you have red foxrod on the civilian side you have apd1 APD 27 APD 31 which is based out of of hubay State Security Bureau which is supported by the Hub State security bureau there's APD 40 at luia and ab41",
        "so we know we know a lot more about what's happening at this level the Tactical tier also goes Downstream further to the um to the operation to par me the operational tier further goes Downstream to the Tactical tier where you have um cyber information Warfare units at the provincial and and the county levels at the city level but that's we're not going to go into that now now there seems to be a lot of organized chaos right so many thre actors so much overlap what does this mean what is how does we how do we decode this organized chaos there's a method to do that we also seen there multiple threat activity clusters which have an overlap in Vol typhoon and so many other cyber operations so how do we really decode that it really muddies the water of",
        "attribution military civil Fusion is the answer it is how the PRC has built a modular almost like a plug-in based information Warfare command control and that's how the the pla outnumbers the US cyber command by a factor of 10 to1 let's look at military civil Fusion how it is organized this is the method in the chaos this is how the CCP integrates the disperate civilian elements into the information Warfare command so at the top of the pyramid there's the Strategic information Warfare capability that's headed directly by the the Strategic support Force authorized by the central military commission so there are trvs as as I as I mentioned earlier the trbs directly under the ssf those trb trbs are probably meant to do strategic cyber operations information operations at the middle tier is is where the theat command trbs and the civilian elements",
        "integrate at the and",
        "especially the ministry of State security the foreign intelligence agency is also known as they part of what they call the authorized forces so lilan whose cyber forces can be attached to the pla during war time at the Tactical level we have the information Warfare reserves militias uh patriotic hackers which and cyber security companies like which can form part of that now what's going to happen is that during war time all these formations are going to get organized into What's called the information operations group and I believe that that formation has already started happening information Warfare information operations group have been set up uh for wartime Readiness it's quite evident the",
        "ccps the CCP also believes that cyber operations lie in the gray zone between War and Peace and and so there's a quite a ambiguity and fluctuation whether this this there's a clear war or peace in in cyberspace so they come up with a methodology called military",
        "struggle jinshi doing it's similar to",
        "Russia's concept of information confrontation or inia VOA",
        "it's quite similar to what they call hybrid Warfare as well now you've seen the organization and look at the guiding principles there are three guiding principles behind this organizing the civil and Military elements into a cohesive structure small",
        "core big periphery what that means is that the Central National command authority to guide all this and direct all this and authorize all this would always be the central military commission under the CCP political control is always there civilian during peace time and military during war time that's how the ministry of State security and the civilian operators can these authorized forces as I mentioned can be absorbed into the military uh Warfare command control last one CMC leads theaters",
        "fight and services build basically it means that CMC is always in control just in case you have forgotten that let's take certain examples of military civil",
        "Fusion the CCP has established an upstream supply chain of offens tool chains exploit malware and even operational infrastructure Shadow pad is one example APD 31 is another example as we SE as we've seen and there are so many other examples where they have set up basically an upstream supply chain of exploit exploitation tool chains which are used by different thread actors and that's why you see a lot of overlap there now we talked about structure organization hierarchy of the pla's information Warfare let's talk about its methods or principles",
        "the military Doctrine if you heard of this term provides PR common principles body of knowledge and best practices to how to wage Warfare so we're going to talk a little bit about what the military Doctrine here looks like now this D this diagram is purposefully complex you don't have to go through it trust me you can always refer back to it later I have a high resolution image available but what I'm trying to Showcase is how diffused and complicated",
        "the information War command control and this war fighting concepts are there's so much to it so I wanted to jot all this down on a chalkboard like a mad Professor which I did and so there's no clear hierarchy to these Concepts these War fighting Concepts they're highly diffused again you have to read this offline I'll look into specific aspects of this in my",
        "slides the first most startling thing and really interesting bit about the war fighting Concepts or the doctrine of the PLA and the CCPA is that they believe that to establish air space and see dominance in the in the near abroad they'll have to first establish",
        "or control the information space globally this is really startling or interesting actually so airspace and sea dominance is totally directly link to information",
        "dominance the pla doesn't believe in fighting force on Force military on Military Fighter on fighter tank on tank kind of warfare they believe in systems of systems Warfare that is they target the adverse iies political politics",
        "economy Foreign Affairs technology and culture and that's why information Warfare combined with political Warfare or cognitive Warfare is the key and that's what is being in uh intended",
        "here I'm moving quite quickly because these you know these are just broad summaries of complex Concepts the pl",
        "also the pl also believes in highly integrated information driven War fighting so where all the Cyber electromagnetic political cognitive elements are fused into each other it's called Integrated Network electronic",
        "warfare I knew it was coined by Major joural D Kingman and the pla also has another concept to link information Warfare with Kinetic warfare that's physical Warfare It's called the information and Firepower Warfare now I've talked about so many Concepts right we looked at the foundations the organization the hierarchy and all that let's look at how all this work what will happen and",
        "how now what's happening with Vol iPhone was clearly laid out in the Chinese military literature while the CCP believes in peaceful rise and the pla is a defensive force it does believe that cyberspace allows you to be offense dominant you have to be offensive in cyberspace the major reason for this is because they believe that de R already exist in cyberspace so you have the first M Advantage there by by disrupting",
        "the the tenant of De deter there so the ssf is actually an expeditionary and a first strike force it is a highly offensive Force it'll strike first before an actual physical Warfare starts and by to strike first they had to carefully select targets to disrupt the political or strategic establishment of the adversity system of systems as I called earlier and that is what is happening here even the key strike targets or the vital Point targets are clearly defined in the pla military literature and that targeting closely aligned with what we saw with Vol iPhone and red Echo if you look at the second point in my slide deck it list all the targets which the pla should compromise before the onset of information Warfare and so they clearly mention strategic early warning systems and that's why you saw emergency Warning Systems getting popped because they will probably use to start disinformation campaigns when conventional war",
        "begins we looked at a lot of other Concepts but what is the why is the PRC doing such risky Maneuvers what is the grand strategy here the grand goal here what is at stake here that pla had to do or the PRC had to do such risky maneuvering it's called the multipolar Asia's great game which Jeff Moss I believe also mentioned very briefly you know if you look at this map and you see that big fat pipe over the state of malaka that's where the world's most",
        "dense energy flows are going through to the Sea lines of communication it's the most expensive and the most contested real EST state in the world it's the biggest choke point in the world if the malaka state gets",
        "blockaded pretty much the whole world trade would collapse and it's a narrow straight really within the Pacific Ocean the CCP politic leadership knows its vulnerability in that part of the world they call it the malaka Dilemma which was coed by huin and it's desperate to secure its geoeconomic interest in the South China Sea which makes sense now to do that it need it needs to create deterent effects and it needs to alter the balance of power in that region but it's not easy the CCP suffers from what the the scholars of international relations call the geopolitical claustrophobia it's surrounded by great power one of the F some of the largest armies in the world in five nuclear armed Nations this is the hotspot and they have to gain air air space and sea dominance in the region to basically sustain their geoeconomic interests the only option available is to disrupt the existing balance of power in the region by slightly displacing the us from the region especially in China's in the prc's near abroad the South China SE this will be quite disruptive because the US offers security guarantees to smaller countries in that region it has also extended nuclear detr in that part of the world so it's going to not it's not going to be that easy and that's why a whole logistical effort is being done to plan for it now we have a theory theory in international relations and I'm a technical researcher Mal analyst but I got doo deep into international relations the theory internationally is called the balance of power Theory what that means is that to gain power you have to take it away from someone it's a zero sum game so there's no other way to really strike or change the balance of power you have to take it from someone else and that's why you have to be offensive this is a this is a conventional Theory it's well applied throughout the world over the last many hundred years now to seek stability and peace in",
        "the region the CCP believes it'll have to seek conflict a very common occurrence in great power competition really",
        "so I've already touched upon the bottom line earlier I won't go through this detail these are key takeaways which I touched upon earlier we may have a little bit more time so before the Q&A starts I'll quickly jump into a few more things very quickly I talked about the great game being played in in multipolar Asia let's look at the first point there so both the US US military and the pla have their own Frameworks for fighting Warfare just in the south China Sea the",
        "US calls is the air sea Battle and the the pla calls is the anti- access area denial A2 a and the information Warfare that we seeing the old typhoon kind of targeting that we seeing is is very intrinsically part of this larger framework if you want understand that you will understand",
        "this other couple very couple of things in 30 seconds I'll wrap up now you you me I mentioned that CCP believes to be offense dominant in cyberspace but there's a problem because if you talk Western critical infrast structure the especially the US they might deem it as highly escalating and May respond with a kinetic strike and there's a big blind spot in the ccp's understanding of how escalatory these kind of operations would be if they if they create a disruptive disruptive effect lastly I mentioned Vol tyon targeted Africa why multilateral deter",
        "the CCP can authorize the targeting of say neutral countries to Showcase will and resolve it's clearly written in the in the literature to summarize all that is happening is going to by the book and I just hope that the outcomes that may happen won't be that catastrophic or disruptive for the world and for the us and for the for the PRC that's all to my presentation these are my sources I've quoted like 70 sources took me two years or one or two years to you know work this out and thank you any questions please [Applause]",
        "you can please yeah please do mention your name as well very helpful yeah all right uh thanks sir for your very insightful presentation uh my name is Derek I'm from Singapore's digital intelligence service so somewh like the ssf counterpart for Singapore right my uh question is more in the way operational technical um with regards to the coruption of Civilian outfits now um based on your research um do you uh what is the ccp's approach towards the",
        "Cyber underground criminal groups um do you see cooption um collaboration oh",
        "okay first what is the policy stance with regards to working with criminal underground and then what is the Rel reality with regards to working with the criminal underground and would that be a source of vulnerability for the ssf where the corruption will make the system collapse I mean uh in the longer term and how does this compare with Russia's approach to the cooption of the criminal uh underground thank you excellent question thanks for asking so I'll give you one example yes there is a criminal Nexus which is the these are called the digital quarter Masters which are supplying all the tooling to the different teams which are targeting them Shadow is one example which are supplied by specific group is a malare which is supplied by specific group which is also doing criminal operations part of the ap41 and venty umbrella and I believe the decision already been taken the criminal elements have been coopted and yes it can lead to difficulties in the coordination of the information Warfare command control when they have to do strategic operations and there's even bit more story to that there's little bit of politicization of the command control as well so the shadow pad malware had plugins some of these plugins were really you know effective some of these plugins were not shared with the pla they were only shared with MSS so there's a bit of pecking order there and a little bit of politics there and there's little bit bargaining with criminals to supp what they can as part of this Upstream supply chain and yes we don't know how the information operations group would work in reality because there a little bit of underlying chaos in politics in there",
        "yeah please I have a question so just recently there have been a Vulcan file League yes yes so for example like I spent like six months analyzing the documents and it was interesting to see how they because Russia have been conducting like China operations for so many years and they've realized like it's a Havoc they try to take over the same targets again in the game because they don't have centralized infrastructure where to store all of the reconnaissance information and so on did you encounter any information like that in China how do they store all of that like tools information how do they uh",
        "coordinate operations and so on like in terms of software like management software have you encountered information like that excellent question so there there are data Fusion PL platforms which are built by certain contractors like iek uh there's definitely focus on intelligentization and information informationization which is using AI to start creating more targeting from the stolen data started a long time back with office of personal management with the anthm leak uh and all this so there's definitely a massive data set which from which targeting is chosen very selectively and it's getting better and better um",
        "now so the other part of your sort of inquiry was that yes we don't know we know some parts of the tooling are built by contractors but in terms of having a very coordinated mechanism to do this there's probably none I can say that very confidently a lot of work is happening at the provincial level with the State security bureaus of the ministry of State security I don't think there's a grand plan to Define these uh the fusion Frameworks and Define targets I don't think it has reached to that level one more question I mean it would be interesting to know are there any collaboration cooperations between Russia and China because at the end I think they are against the West sure so",
        "like not in the geostrategic OR geopolitical terms like I'm LLY looking at how the political establishment is coordinating all this definitely not at that level we have seen overlaps between the Russian thread actors and the Chinese thread actors it's just because they have the same quarter Masters or they actually buying exploits from the same places like Royal Road RTF weaponizer was a tool which was used to weaponize RTF fire which was used by so many TR actors so there little bit of that noise and mudding of the waters but I would deem that as that that as bilateral cooperation for military operations because I'm largely looking at in terms of very well- defined military constructs or protocols there's no coordination there for especially for information Warfare which I could",
        "discover wonderful thank you so much for coming and I guess that's all and if you have any questions I'm happy to address them at the hallway as well thank you"
    ],
    "JQP3ZfM1V0U": [
        "hello everyone welcome to my talk certified dcom the privileg escalation journey to domain admin today I we uncover a new remote attack service of dcom and DCS and show you how to abuse it to get domain admin privileges first let me introduce myself I'm T I'm from ton security sh lab my research is mainly about activ directory security clo security and web security here here is the agenda firstly I will introduce some basic knowledge on the previous research then I will work through how to discover the remote attx service and how to exploit it and finally show you the patch and mitigations Al so what is come uh in short com is something like a banner Library it provides metals that can be called by the client the com server can be a d or ESC with uh com classes in it a com object is an instance of com class which is posess one or more interfaces the interface contains meal that can be caed by the client the com server can be in process out of process and even a remote process on a different machine uh in process server means com objects are running in the same process as the client Auto process means the com objects run runs in a different process a cons server can even run a a remote machine which is also Al known as dcom invoking interface meals or iness com objects are processed as ordinary function calls cross process",
        "cross process com calls are handled by arpc and com decom communication between different machines are made through IBC over",
        "tcpip in the outo process Com when a client requests a com object it will communicate with the ipcs service first the icss will check if the the com server is running if not it will start the com server and create a new com object in it the process is called launch and activation after com object",
        "is activated uh the client can interact with the com object through",
        "arpc the workflow of the dcom is similar to the autopress com except that the client and server are on different machines the client needs to communicate with the local icss first the local ipcs",
        "then process the request for the Comm object to the icss on the remote machine",
        "the communication protocol between the two machines is I is RPC over TCP",
        "IP uh in recent years potato attacks and",
        "covers relay are wellknown research uh on Windows con uh the history of this attacks uh can be traced by back uh to jams foros Ms",
        "1567 80 years ago it's a first vulnerability to build stom activation using codat instance from I storage API uh all of the fing poal attacks and cover relay abuse the same API it's indeed a very powerful attack Vector but all is all this research is about the local attack service none of them talked about the decom remote Tax Service well local tax local privilege escalation is critical I think people still prefer remote tax so where the Forgotten remote tax",
        "surface uh let's first look at uh how cat instance from I storage Works cat instance from I storage is an API for creating Comm objects uh the difference between this API and other com creation apis is that it receives an I storage interface pointer parameter and they initialize the com object from the storage",
        "object a interface a interface pointer",
        "is actually a memory address the interface pointer uh cannot be passed directly between the client and server in Closs process communication because the memory of the client process and the Ser process are not shared as a solution interface pointer will be shed into to a data structure named OBG if custom and",
        "the class ID and the data of the OBG custom can be customized by the client with the get andm class meal and M interface meod on the com server side it will sh OBG if custom sent by the client to get Comm object and the interface",
        "Point account client can set the class ID of the M data M class to the class ID of point monor and setad the data to an OBG standard when the conserver MMA shows OBG custom sent by the client it will create a point mon object and call the M interface meal to ml the OBG",
        "standard there are two important fields in OBG if standard which is called stream binding and security binding",
        "uh the stream binding contains a network address shs where to find the object when the com server and Sh OBG standard it will call resolve over2 to resolve the object Explorer ID and the IPC address will initiate an IPC connection to the address specified in the Stream",
        "binding the res os2 can connect to a",
        "local or remote server uh this depends on the stream binding uh the return value of the id2 is osid",
        "bindings uh is osid",
        "bindings uh which is also consist of",
        "stream bindings and security bindings uh the com server will then initial a decom connection based on the stream bindings and bindings specified in the ID bindings in previous research the attackers com client and the victims com server are both local process the server use code get instance from my storage to trigger the highper prag com server to auate to the attacker's Rog server the attacker can then impersonate or relate unication for local page",
        "escalation uh we know that decom allow us to active com Pro remotely does c get instance from ey Storage St remote com activation with decom when we look into the definition of cod get instance from my storage API we can see that it's a low user to set the class contens to class contens the remote server or to active com objects on a remote machine and the Cod server infrastructure allows user to set a a remote computer name the unication information used in the dcom communication Al seems this API also support remote com activation so can we call us a remote computer connected to us and then perform ANM or cover related",
        "Tex uh suppose we have compromised a normal domain account we can authenticate to any domain computer but when we try to use cod instance from my storage to active common object on a remote Compu domain computer uh we go",
        "access denied",
        "error uh this because the default Comm",
        "security restrictions in Windows there are two parts of ACLS here the systemwide ACL and the process wide ACL",
        "this ACLS Define restrictions on com launch activation and access when a com",
        "client launch or activate or access their com object the client needs to pass the systemwide ACL first and then pass the process wide in the default systemwide settings only user in",
        "specified High privileg local groups like local administrators group or distributed Comm users group are allowed to perform remote launch and remote",
        "activation uh therefore by default a normal domain account cannot launch and activate any common object on remote machine I believe this is why so little research has focused on the decom remote tax surface so how to use the May older privileges to launch Remote tax where is the remote attack Service uh to perform remote attacks we need to break the default come systemwide restrictions first let's think outside the box uh also Al Windows has uh strict Comm restrictions by default there are many services in active directory that allow provide uh also provide uh common access uh this service uh there is this service also is spend the attx surface also next we extend the attack service to active directory and try to find services that have customized come a security configuration other than the windows default configuration",
        "uh the remote desktop uh service modify the windows default default Comm security configuration it allows some RS groups to perform remote launch and remote activation uh but in the RS default configuration no low privilege domain accounts in these groups the SCM also modifies the windows",
        "default common security configuration in order to provide a remote wmi access to",
        "uh SMS me uh but by default there's also no low privilege domain counts in SMS ad means group finally adcs comes to rescue uh if",
        "adcs is installed on a machine the local certificated service become access group will be granted a remote activation privileg the act the authenticated users",
        "in the certificate service deom access Group by default uh which means any low PR domain account have remote activation privilege on",
        "adcs why is there such a special configuration on adcs uh that's because adcs need to provide certificated signing request sent by the client the active directory all domain users and domain computers are allowed to send certificate signing request to generate a validate certificates",
        "adcs implements MS WCC which is a decom",
        "protocol to support the certificate signing and it Grant grants all",
        "authenticated users priv privileges to",
        "active the com introduced by",
        "mswc and now we can pass adcs systemwide ACS check next we need to find out which com classes can be exploited for fer attacks as we mentioned before in in addition to systemwide ACL we also need to consider some process wide configurations the configurations uh",
        "contains process wide ACL identity authentication level impersonation level and others these settings are defined in the register by default and can also be overr righten by the co or initial security",
        "API the process wide ACL defines who can launch activate and access com object",
        "remotely as an exportable com uh the",
        "process only to low remote activation by low privilege domain conss and the com server must be uh already launched in adcs because certificate Service deom exess Group do have remote launch privilege on",
        "adcs the identity defines the user identity the conserver ress it can be on",
        "interactive user ass system accounts or other specified users the com server will use this identity for Network authentication for an explorable com server uh it identity can be set to any us except as the local service because the local service use anonymous user for Network authentication uh that has no",
        "disable",
        "value the default value of Comm authentication level is IPC all level connect which means signing and sting uh are not required in dcom connections uh this very helpful for Relay attacks uh the impersonation level determines whether the identity of the clients can be impersonated by the server or some services like is and SMB need to imperson the client this service require",
        "uh the client impersonation level to be set to IPC input level impersonate",
        "uh after reviewing uh all C classes on adcs we found this explorable classes uh",
        "certif uh c c service request C Service",
        "mean other common classes used by mswc they are installed in adcs by default orcp request and O CP admin are classes introduced by the adcs online",
        "resp F rule which is not a default rule of adcs you need to install it manually all this exportable com class uh has identity to uh set to system which means",
        "uh the com server will use the adcs machine accounts for Network authentication the authentication authentication level and imp personation level settings shows that we can relay the adcs authenication to out service",
        "Al so if the teer has compromised a domain count he can use cod instance from I storage to active activate an explorable Comon object on adcs remotely when adcs connects back to the attacker the attacker returns a forged osid binding uh to the adcs and set the stream binding to require NM or cber",
        "authentication at thiss we use SPI authentication method and HCS machine account authenticated to the",
        "attacker the tication in in this dcom",
        "connection will adhere to the process-wide security configuration of the explorable con the ination level will all be connect and the impos level will be identity so attack can relayer",
        "an or C sonication to our dep and perform resource the delegation attack or Shadow credentials attack with the adcs machine",
        "account here's the complete overview of this",
        "attack the final step is to escalate privileges to domain mean it's easy to get the meain the meain Privileges after resource based delegation attack or Shadow credentials attack I gave two I",
        "gave two attack passes here or you can can see on adcs and escalate to domain me with the golden certificate attack or you can request uh domain admin certificate first and then use the certificate to request a domain admin service ticket uh uh domain ad me uh TGT with PK PK it uh finally you go the",
        "domain you go domain me and you can take over the entire active directory and R see on any domain computers",
        "uh let me show you the demo of the second T",
        "pass the attacker is a user in domainer",
        "group theer",
        "group Next let's run the certificate decom exploit and execute command with",
        "wmi on the domain controller okay let's run and Export it",
        "now you can see we can execute commands as domain and mean on on domain",
        "controllers oh thank",
        "you uh the patch for this vulnerability was released on October",
        "2022 uh the patch CER DEC come to LF relay with DCS it raised the authentication level to packet privacy uh in their certificate service and a month later become authentication hardening or released it automatically raised the unication level for all nonous non Anonymous activation request",
        "uh to package integrate uh this hardening also kill this this vulnerability and can defend",
        "against the most decom related attacks enable signing and channel binding can also protect you from this",
        "attack uh we just talk about relat how about other services we didn't find a com class that supported decom location with impersonation level set to impersonate so we can't relate decom to other services but how about the resolve of os2 RPC there are also authentication messages in this IPC connection the impersonation level of the resolve os2 IPC connection is IPC",
        "inut level imp personage so we can perform relate to the HCS HTTP en and",
        "mspr but this requires two HC servers in",
        "in our domain because we can we can't uh relay an back to the same",
        "machine uh how about C Relay can set",
        "abitrary SPN in their security binding to make a resolve id2 IPC Kate with any",
        "service person name actually we can't because the uh machine name of the SPN in the resol S2 IC authentication is fostered to the a machine name in a stream binding so it can trigger C with security",
        "binding uh how about other IPC protocol sequence uh we can also control the tower ID of the stream binding the tower ID determents the IC cence type I",
        "suppose many transport sequence",
        "transport sequence type with different high level protocols like TCP UDP smbp",
        "Etc can we abuse this protocols for an relay",
        "uh after I checked all this IBC protocol seconds I found the uh res2 IPC support",
        "nccn ipcp and ncn hdtp the dcom",
        "connection suppos one more type nccn NP",
        "ncn ipcp is what we talked about before or how about others uh the n in hdp is also called IBC over hddp the IC CL will use IVC over HTTP",
        "version two first if version two filled uh the client will fall back to the version one when using IPC over HTTP version one the Cent will establish an",
        "HTTP connection with IPC server and send a HTTP request using IPC connect as the HTTP request meal this is a process hdb",
        "connection the RO IC package will be sent in the same connection one thing to know T is that there's no authentication in hdtp layer uh the authentication is only in the IBC",
        "package IBC over ADP version two is a bit more complex than version one but the same as version one there's no authentication HTTP layer uh the authentication is only in the IBC package so as for NC in HP we can relay anti arm uh we can perform anti arm relay C relay to L dep with IBC package",
        "in hdb connections the same as IBC package over",
        "ipcp uh in compar in comparison to uh NCC ipcp IPC overp has the potentials uh",
        "potential to bypass some netor ctions or n devices in some",
        "situation the decom connection also support IVC over name pipe the IC over liit pipe use SNB protocol as transport",
        "as the transport protocol and uses the machine accounts for authentication in the SMB layer the impersonation level of the authentication is security impersonation",
        "which means the server can imp person into the client so we can relay we can perform anti Army relay uh to the ad HP",
        "end points or MSP in another adcs server",
        "uh but it this still need two HC servers and cover still want work in I named",
        "pipe uh when I take a closer look at the patch for the vulnerability we discussed before I found something interesting the patch introduced a new function named initialized com Security in the search",
        "service the new function evoked the code",
        "initial initialized security to config",
        "the process wide com security it change the unication level of the thir server thir Service uh to packet privacy to",
        "patch their vulnerability and the Imp personation level is also be changed changed to the IPC imp level imp personage the impersonation level is exactly we want so now we have decom authentication",
        "with impersonate uh with this patch we",
        "can relate decom come to adcs HP OMS RCP",
        "running on a different machine uh but uh",
        "for cus relay there's no restrictions for cus ating to the same machine so we can perform C reflection relay C",
        "sonication back to the same adcs",
        "server uh here is how the attack Works",
        "uh we can you use both ncn in IP CP C and HTP as RC sequence here and we can",
        "relay the indication from the adcs back to",
        "itself a cover uh reflection is not a new vulnerability but a new exploit technique to mitigate this attack just enable appear on your adcs hdtp end points uh EPA can protect you from both",
        "anti arm relay and cpos relay and keep just keep the default settings of the MSS spr to to to defend this",
        "attack okay in this talk we introduced a new remote attack service of dcom and adcs and S several attacks which can lead to preis escalation from domain users to domain mean we also take a cover relay to the next level make it a real remote attack VOR uh one thing to notice is that uh This research is in the default configuration uh in active directory if you have some customized decom with M uh with Miss configurations",
        "like allow any domain user to active your com object remotely uh this TX may also work uh there are some medications for you update your LCS to install the patch update all your machines to enable decom authentication hardening enable protections for Rel relay attacks such",
        "as UHF standing and channel banding and EPA for HCS HP and points and finally check your check your",
        "customized systemwide and process wide com",
        "configuration my research is based on the remarkable work with this outstanding researchers I'm just standing on their shoulders thanks for their",
        "work uh thank you for time uh hope you enjoy this talk"
    ],
    "JItnI6b9DII": [
        "and my name is y and I'm from secure works and I provide redeeming services for Enterprises mainly in Japan so for today's talk I'd like to share one of the challenges that I had during our redam engagements and also I like to share the solution to",
        "it now here are the agenda for today's talk first introduction and then we will",
        "move on to the device authentication mechanism of the Microsoft enter ID and then after that we will dive into the device authentication internals the windows internals and also I directly talk about how to abuse it with demo and mitigation finally",
        "conclusion so um introduction so let me begin with a story from our red team",
        "engagement so one day in our red team engagement we SU three Spearfish and got one of the target target machine infected with a sh cant so from the machine we broke into its internal Network and with some techniques we compromised the target active directory with some techniques and we got the domain admin privilege so after that",
        "with the D privilege that we got we dumped all the credentials from the active",
        "directory and in the dumped credentials one of one of the credential look like admin account in Azure ad currently which is known as the Microsoft enter ID so if we can successfully l in with this um admin account of the aid we might get admin access to enter ID as well right so we try to crack its password and we try to log into enter ID with the credential however the login was successful but the access was brocked by the one of the security features of Microsoft enter ID which is the conditional",
        "access so what is conditional access for",
        "those of you who are not familiar with the conditional access this is a um security feature by Microsoft that can control access to resources in the crowd based on the signals like who you are and what your devices and what application you useing and what your network",
        "Etc so from the error message that we got we can tell that the access was brocked by the device based con access policy and it seems it requires the Microsoft enter and on premise 8 joint device which means that we need as attacker we need a corporate device for pivoting to the",
        "clowd so the question is how can we bypass this kind of uh condition access policy where you need a specific device",
        "so from this engagement I started researching into how we can bypass the device based connection access and gain access to resources as any user with a credential so we want to access to resources in the cloud as any user with the credential not just only the locked on user of the device so that we can easily switch accounts move laterally between accounts for fter post exploitation activities in the clowd so this is my research goal",
        "so to get some ideas for the research goal let's look into the mechanism of how ENT ID can identify device during the",
        "authentication so the important part of the device identification by the enter ID is the keys generated during the device registration so when device is registered to enter ID two key sets are generated one is the device key and the other one is transport key and each of the key set has its public key and also the private",
        "key and during device registration the public keys of the uh device key and also the transport key are sent to enter ID and registered and after that ENT ID can identify device based on the usage of those keys during O setation So now let's look into the detail of the authentication flow when you access to Microsoft with your browser and from your C corate",
        "device so first when you want to authenticate to enter ID with your corporate device and device sends the logr request signed by device",
        "key and the signed L request is basically JWT which is the U Json web token and the JWT has three parts and each part is um base 64 URL encoded Json values and the one the first one header defines the signing algorithm of the JWT and the second one payload contains username and a password for the user authentication and the last one is the signature which is the Json web signature made by device key so enter ID received this request and verify the bar key usage of the device key and also the credentials in the",
        "pay so by sending the signed Rin request enter ID can identify device and also D user then enter ID returns PLT which is",
        "the primary refresh token and also the session",
        "key and this is the response from the ENT ID and in the response you can see there is the PLT and also the session key right there and uh one primary",
        "refresh token is this can be used for single sign access to the for example teams or SharePoint or Al or whatever you can use it for single sign on but just sending PRT is not enough for the single sign on uh you need to use the session key as well but in the response session key is encrypted actually and to use the session key device decrypts the encrypt s Key by transport",
        "key so for the single sign access with your browser first device decrypt the encrypt key in the response and then use it to find the PLT and this one is called the PLT",
        "cie and PLT quickie is also the JWT as you can see there and it contains the PLT and the payload right this and this PLT cook key it's JWT is signed by the session key which is bounded to a specific device so again entry ID can identify which device is used from the key usage of the session key and also enter ID can control the access to um resources in the crowd based on the device",
        "information so after the device identification you can access to Microsoft you can access to the resources in the cloud like this so in summary during the device registration device key and transport key are generated and registered to enter ID and then enter ID can identify which device is used by the signature of device key and also the session key but the session key and the response is encrypted so device decrypted by the register transport key and use it to sign the p and create P cie so getting back to the research goal from this mechanism we can say that the um by signing any users login request and also the PT with those keys then we can access to enter ID as a registered device and bypass the device based connection",
        "access however those keys the device key",
        "transport key and also the session key all of them are securely stored in TPM the trust that platform module if the device has it and those keys cannot be exported they are not exportable and there is a prer research and the um exporting a derived key of session key and creating PLT cook keie is discovered by Benjamin dely and D however it is PED in 2021 So currently it is hard to export those key and create p key but even if the keys are protected in TPM and not exportable I believe that still those keys can be used from the device and they can be accessed I believe so if we can understand how the TPM store keys are handled and used in the device internally then we can still abuse them for creating any users P cookie and fake device to access to ENT ID so this is why I started reverse engineering ing Windows OS to understand how those secret keys in TPM are used and how we can abuse",
        "that so um let me talk about the analysis of the windows internals and the ways of its",
        "abuse first I started researching how Google Chrome handles the browser single sign on especially especially it's extension called the windows accounts that handles the browser single sign for you user and so when you open the Google Chrome and access to Microsoft with it what happens there is that first Google Chrome sponsor a new process code browser.exe and then browser.exe Lo a DL",
        "code Microsoft Microsoft account token provider. DL and then pro.exe execute",
        "the method inside the DL called get cookie info for U and this method get the PLT cookie of the loc on user the device and return it to a Col process and return it to a Google Chrome so basically this is the way of browser single sign on for Google Chrome and also this has been abused by attackers for PLT Quicky Seft what I mean by that is that attackers can use the browser C or exe or attacker can also use the dll and execute the method inside it so but for my research I tried to discover what what the method the get cookie info for UI does to internally get the PLT cookie of the Doon user for my",
        "research so if you look at the get cook info for Ur method in the DL you can find that the method at the end calls the LSA C authentication package and this Windows API can communicate with the authenication provider loaded in Elsas so this means that the method to",
        "get cookie info for U it's sending some data to Elsas to get the PLT cookie of the logon",
        "user and if you look at the data sent to Elsas then you can find some Json data with code ID and also the payload values in it and if you also follow where the Json data goes then you can tell that the Json data is first to the cloudd authentication provider in elus and then the Jon data is pass on to the A",
        "prag and the finally the a prag handles",
        "the Json data inside this function and",
        "inside this function of a plugin there is a switch statement and based on the Cod number of the Json data one of the functions inside a plugin is executed and this time the code number in Json is two so",
        "the create SSO cie function inside the plugin is executed and then this function Returns the PLT C keie of the lock down user so let me summarize what we have seen so far so during the browser single sign know Google Chrome runs a browser called exe and then Brer core. exe execute the get cook info for URI and then this method um execute the RSA core authentication package to communicate with .exe and by sending the Json",
        "data the Json data passed on to the a plugin then based on the c number of the Json data the uh Creator SS cookie function is executed and this function returns a PT cookie to the Google Chrome so this is what happens during browser single sign on and in order to interact with the .exe and also the a plugin for my",
        "research I implemented a PC that directly talk to .exe without the browser.exe and also the uh",
        "DL by just scoring the LSA called authentication package and with this P I was able to call the create SSO cookie in the Prov so by replicating the same flow as Google Chrome and by executing the uh function inside of a already plug in I confirm that we can steal the PLT cookie of the lockone user as you can see there so now I got another way of PLT cookie sft for the lock on user however the retried PL cookie only allow",
        "us to gain access to resources as a loged on user of the device and to access to resources as any user with the credential first what we have to do is that we need to sign the user's login request by device key for this thing there was an internal function in a plug in called sign per function and it looked like interesting and it looked like this might help with a research so for my research as a next step I started looking at the sign PA function inside the a",
        "plam so um this is a part of the the compiled version of the uh sign PA function in the a prame you can see there are two functions are called inside this function and one is the check package Sid for request sign and the other one is build by source assumtion so let's look at the second one first to understand what this sign P function inside the plugin can do for",
        "us so what it does in the build by assumtion is that first Json data is sent to ls. XE and then the device or assumtion gets this period value and basic for URL encoded like this and at the same time JWT header is generated and from the header and payload the signature of the device key is generated and finally combine all together JWT is created with the signature of device key so the sign PA function literally",
        "can sign the content of the pay and make jity with the signature of device key so this means that with this function if you include username and password in the payload of the Json data then through this internal function of a plugin you can get this login request with a signature of device key and you can use it to authenticate to enter ID however there is another function the check package Sid for request sign and what this function does is that this function checks if a coder process Sid is the one specified here and if not the right Sid then the build device of assumption is not executed and therefore sign perod function does not return the device key sign Ling request for us however by quickly searching the Sid specified there I found that the Sid is for the app containers Sid and it is for the application called a token broker since this Sid is for the app containers with some techniques we can impersonate this Sid in the device and we can byass the Sid check of this function",
        "so for example from our C client we can impersonate the a token broker Sid to bypass the Sid check and then we can call the a call authentication package and to execute this time the sign P function inside the plam and if you include username and password in the um Json data sent to .xc",
        "then you can get the device key sign l login request through this approach",
        "so I implemented a PO for this approach and generated sign login request with a signature of device key like this in the request and by sending this sign login request then I confirm that we can get the any users P the Logan users the we can get the PT of the user and we can also get the encrypt session key in the",
        "response so to sum up we can sign any users ring request by device key through the internal function of a plugin called sign payload so by sending the sign request we can get the users PLT and also we can get the encrypt session key for the browser single sign access we have one more thing to do which is to decrypt the encrypt the session key in the response and use it to sign the PLT with it and for so let's let's find out how",
        "we can do that so by looking at the plin code I found that undocumented API from crypto enc.dll are imported and used for huning the encrypted session key in the response which are NGC import symmetric POP key and also the NGC sign with symmetric POP",
        "key I'm not going to cover all the technical details here but the undent API works as RPC client and and NGC",
        "import symmetric POP key can talk to a.exe and then a.exe works as RPC server",
        "and import the encrypt key into TPM and decrypted by the register transport key in",
        "TPM and NGC sign with symmetric po pop key can use the uh session key deced in TPM and sign the signing input and get the signature of session key from ass signing input so by analyzing the undocumented apis I figured out that we can use them to input and deip the session key in DPM then we can use the session key for signing so with this approach we can finally sign the PLT with the decrep S key and we can also create our own PLT",
        "cookie so I implemented this into my PC and confirm that we can create our own PLT cookie as you can see here now we can create arbitrary users PLT cookie with the credential so we can gain browser single sign access to resources as any user if you have the",
        "credential so let me summarize what we have seen so far and how we can abuse them first we need to infect some corporate machine that is registered to enter ID and then from the machine we can sign any users ring request stored in device the signed by the device key and then you can send a sign R request with a signature of device key and you can get the users's PLT and also you can get the encrypt session key and after that you can import the uh session key to TPM and decrypt it by the transport key started in TPM thanks to the undent",
        "apis then you can sign the PLT with it and you can create PLT cook key and if attackers get the generated PLT cookie with this approach attackers can people to the clowd as a user of the PLT cookie and bypassing the device based connection access so with this approach now we can gain the browser based single sign",
        "access but what if I want to have API access to enter",
        "ID so there is another authentication FL",
        "that can give give us up tokens for API access so by sending the PLT signed by session key we can also acquire app tokens for API access however this app tokens in the response are encrypted and they cannot be used as they are for API but actually you can decrypt the encrypted app tokens by the S key and I found that there is another undent API used for us which is the ngg decrypt with symmetric POP",
        "key so by analyzing the usage of the undent API I confirmed that we can decrypt the encrypted app tokens with the session key decrypted and stored in TPM and we can acquire access token and also refresh token for API access to the cloud as",
        "well so by abusing the TPM store Keys through the undocumented apis and also the internal function of a plugin loaded in Elsas we can create our own PLT cookie or also we can acquire app tokens with any users credential and this attack approach does not require administ administrator privilege in the compromised",
        "device and using this approach we can finally bypass the device based con access policy so now the initial goal is",
        "achieved but let's Explore More to find another ways of abusing the TPM St",
        "keys so um another abuse of the TPM St Keys is password",
        "authentication so I found that the other important apis allow us to interact with the windows H for business Keys stored also in TPM first let's look at the windows H for business Implement implementation to find out what this undocumented API can do for us",
        "so as you might know Windows har for business is used for password address authentication and when you want to use it Windows hard for business Keys called user key are generated and registered to enter ID and after that Um this can be",
        "used to authenticate to enter ID without",
        "password and when authenticating with Windows har for business first we need to send device key signed JWT that contains the user key sign data I know this is kind of complicated then enter ID can return the PLT and also the session key with this we can create the PLT cookie as we have seen before so let's look at the complicated sign data so this is the request to enter ID during the authentication and it has a device key sign JWT in the request and if you look at it the JWT pay contains data with the signature of Windows har for business keys and ENT ID received this request and with this request ENT ID can perform its authentication by validating the key usage of the device key and also the uh Windows H 4 business",
        "keys so by analyzing the undent apis and",
        "by interacting with all the secret keys topm I confirm that we can authenticate the enter ID with Windows har for business keys without password and we can create PLT",
        "cookie and also in addition to the PLT cookie you can also receive access token with the windows hard for business keys and if you look at the access token here a acquired by the this approach this access token has MFA claims in its payload so this means that with this authentication approach multiactor authenication is already completed and also you can see there is a device ID here in the CR in the pay which means that device identification is also completed with this authentication",
        "approach so to summarize now we can create PLT cook key or also we can acquire the app tokens through Windows har for business keys without password and this approach allow us to bypass the device based con access policy and also attackers can bypass the MFA enforcement policy in the uh conditional access of the ENT ID however there is one b side for the aters um if you want to login as other user if you want to switch accounts then you need to compromise other device with Windows har for business Keys stored so the windows har for business keys are bounded to a specific user and stored in other device so if you want to uh move laterally between accounts in the cloud then we have to compromise other device with other users Windows H for business keys",
        "stored so uh let me show you a",
        "demo so I implemented all the techniques into Powershell script called but toen broker and let me show you what it's like okay so right now you are showing the you're looking at the windows Ron box and this is um register to enter ID so you can access to Microsoft and now there you can see attackers scene and for the demo first I will try to log into the enter ID and people to the clowd with the store show in the introduction however from the attacker machine the access is Brock by the condition access and it looks like it requires as the corporate device like the inra join and Prem join device so uh let's imagine",
        "that we compromised the windows webon box and we can open the power shell session and we can import the B token broker script like this and we can",
        "execute the create PLT cookie command by specifying the username and a password once you execute it you can get the PLT cookie like",
        "this and then once you get the PLT cookie with this",
        "approach you can go back to the attack machine and you can configure the PLT cookie in the brother cookie store like",
        "this and then once you configure the cookie you can access the Microsoft",
        "again and now you can [Applause]",
        "buy so this is all for the demo",
        "okay so I implemented all the techniques into the um B token broker now it's um public so you can access to the URL specified",
        "here so this is all for the demo and finally let me give you some tips for mitigation against this attack",
        "so this attack is implemented based on how Windows always internally handles the uh secret key stored in TPM so it's kind of like by Design and Microsoft has responded this attack as a expected Behavior so there is no fix so far however for the mitigation I recommend you should review and Harden your condition access policies for for example requiring MFA not only just requiring corporate device and this helps that this helps to make it harder for attackers to Pivot to the crowd and move laterally between Clow between accounts and clowd so during our team engagement we",
        "have seen a lot of companies require just only corporate device to access the crowd not only not require",
        "MFA but M if MFA is also required then attackers have to do something like compromising other device with the windows hard key is configured for switching accounts for their post exploitation activity so I should I recommend you should um require MFA and Harden your con condition access policies so that attackers will be hard to people to the clowd and to detect to detect the attacks by the B token broker you should monitor suspicious RP activity by using the internal function of a plugin and also you should monitor the uh Crypton agency and the Comm API calls also if you corate device is compromised then it is it is a good idea to check if the device is used by attackers to bypass the device based con access policy and move laterally between accounts you can look at the multip multiple accounts signning logs from your device please refer to the KQ query reseted here so let me summarize today's",
        "session so we have seen how attackers can interact with the secret Keys even stored in TPM so thanks to the RPC calls and also the undocumented API and once your corporate device is compromised then attackers can easily abuse them for bypassing the conditional access policies as we have seen before and for making it harder for attackers I strongly recommend de and Harden your conditional access polies more and detect the sufficient activities in your end point so this is all for my presentation and if you have any questions I'll be around here so you can walk to me and ask any questions after the session or you can send some DM to Twitter or rinkin whatever anytime so this is all for my presentation and thank you very much for listening [Applause]"
    ],
    "SGp91luDA3k": [
        "so uh very good afternoon everyone I hope you had a very good lunch and now you're back to business again so before we begin don't worry uh we're not going to ask you what do you have for lunch instead we'll be presenting our session on breaking manage identity barriers and Azure",
        "services so a little bit about myself uh my name is NES I from SIM a beautiful state in India and we are actually really honored to be here at blackhe hat Asia this is our first time here at blackhe hat Asia so at Tren micro I work on the security and threat research focusing on everything between code and Cloud so I've been presenting some of my work at conferences such as black at USA hack in the Box hacken Paris and a lot more so we've been submitting vulnerabilities that have been found in uh cloud service providers and particularly Microsoft via the zero day initiative I've been in the top 100 MSR see most valuable researchers for 2023 and hopefully for 2024 even now so you can find some of the uh fun stuff that I've worked on by going to my page I also am on Twitter or X so yeah so my findings range from vulnerabilities in home routers to Android apps and now onto cloud services apart from my work uh I'm mostly found playing base and composing some vocals for my band and",
        "yeah hello everyone my name is David um",
        "I start my infos Journey back in 2010 starting as a Mal analyst over the time I gained some experience presented on conferences such as AAR and Caro in the late 2017 I joined the Trend Micro and switch my focus more into the cloud threats and",
        "vulnerabilities and I presented some of our team initial finding in 2019 and the security fast during the P pandemic out",
        "Brank I was one of the guys who was writing about the team TNT activities and especially their switch to Cloud FOC Cloud focus and stealing Cloud credentials from time to time I find also Bella and most importantly I try to remain a human",
        "being so David found some issues in Azure functions the Azure function service in Microsoft cloud and I found some issues in Azure machine learning service and particularly today we are going to talk about the issues in the manage identity implementation and Azure functions and Azure machine learning service but before we will tell you about our foundings let's tell you something about how we got there because there's actually funny story behind it you know in early 2022 the world was still recovering from the pandemic and I was locked down in the Philippines in the hotel room although Philippines is very Sun Sunny Country country there was sh over the place and you know without the vitamin D it's just not doesn't feel right and there was one particular thing that make me happy to the that day and that was when I found these issues inside the aure functions then couple of months later",
        "nites was digging deep down into the Azure machine learning and found lot of different issues and after that time",
        "passed and in December last year we met in Japan and go we were going from a party sitting in a taxi and it's you know what NES let's apply for a black Asia so here we",
        "are so let me walk you through my",
        "journey inside the Azure functions but first question I have to ask myself was what are actually aure functions right well I did what I usually do I look up to the documentation and find out it's a seress platform but what is the server as right it doesn't run somewhere in dis Skies so we found out it's nothing more that running our user provided code inside the cloud service provider on the manage",
        "platform wait uh David did you just say running user code that to on someone else's server that to on cloud well I know what you thinking right there is one saying among the developers never trust user input and now we are G giving like executable code what could go go wrong",
        "right so don't worry n there are you know some mechanism that prevents everyone from executing outr such as authentification and you know we can Harden use it the triggers that there not doesn't need to be a public end point that execute arure",
        "functions so what we did since we are providing a code in to our cloud service we did a simulation of compromise because we assume that one at one point in the time the user were bring the vulnerability to the code so basically we designed our own serverless function which was nothing more than a rever share that connected to our contrite environment and from that we analyzed the underlying environment cing the serverless or aure",
        "functions and also executed some",
        "commands right and observe the configuration changes because not every feature inside the aure function is available by",
        "default So speaking of authentification aure functions get several options",
        "starting with functions tokens there are",
        "two scopes of the tokens functions token which are basically binded to the function itself and host token with the",
        "host token you can execute any function",
        "onite your server lless environment and also it provides you to the capability to execute some of the API of the function host the second option which is little",
        "bit more secure is using client",
        "certificate and there is also a third option since we are actually providing the code for the executing the functions we can Implement a custom logic and the client certificate is actually using the",
        "custom logic but there are uh code Snippets already",
        "available speaking of triggers don't worry it's not a land mine the default one is https request",
        "you can it's basically public endpoint",
        "the second one are events that are binded to the cloud and we can imagine like database trigger just like",
        "that one thing",
        "that we need to analyze as a researcher were the timeouts you know how much time we do have inside the environment by default it turns out that our rever shell will be by default active for 5 minutes when the our request will expire after 4 and a half minutes due to the load balancer and one important thing you can limit your execution time inside the host. Json",
        "file speaking of environmental analysis",
        "oh you know what do you do when you pop up of shell right well you ask who am I turns out we are a root okay that sounds nice right but you know root isn't what it was before so we need to execute another command such as Mount and capshell and we find out that we by analyzing the output of this command that we are running inside the container Docker container and our capabilities are limited basically the default Docker capabilities but there was one particular thing we run this EnV command which basically print out all of the environmental variables and there is the moment where it started to be",
        "interesting but before I will speak about the environment art issues it's important to speak about the environment varable itself well you might know it's",
        "very popular practice among a devops and it often stores a Secrets right and believe or not there are some uh products that reference environmental variable inside their documentation as a vault and by all means if they tell it a w then I am telling that is the same like this was present for Pablo",
        "Escobar so let's speak about the underling fundamentals of environment variables well you probably know that everything on Linux is a file light so we can just L list the Brock file system and and here is one file Environ and we can print it out that's basically the table of environment variables for the given process and",
        "basically uh we can",
        "access the all of the environmental variables of the running user inide our process Nam space and there is one very important thing by default the environmental variables are inherited into every child process unless explicitly new environmental variable table are passed as",
        "arguments we did a little demo for you this is nothing more than simple hello word in C++ right it doesn't even mention environment variables so we export our super secret API key into",
        "environmental variable compile our application run into the debugger and break it at mine function and that's you can see from the",
        "RDX is pointing on the stacks just comparing the rspdx value and if we follow the RDX we can see it's also pointing on the stack and there is something which notably similar to environmental variable and if we print out the address rench we can find all of the environmental variables including our super secret API key but isn't this something like just specific to the Burger is it inherited by every process from the first P ID itself that's a great question you know we need to verify so what we did we actually analyzed it like first thought that it might be debugger but unlikely right because we got some knowledge and then okay it can be let's say lipy who is doing the job but we found out that it's actually the Kel itself who pushes the environmental variables on the stack so this function is called when a new",
        "process is found in the Linux and one of the code Snippets from the large function is this where we can see actually how it's pushed into the stack so back to the serverless functions this is how the environmental variable print out look like it's a lot isn't it hard to navigate so we cut it a little bit for you still isn't it but for our security purposes this is the most important bits so let's start with the asure web job storage so what what is this environmental for well it turns out that for aure function you need to store code somewhere and in a lot of cases you will need a storage account and the storage account is used",
        "for storing the source code and the Azure function holds pull the source code and then it execute it right and this Azure web job storage is nothing more than connection string or access to can to the storage account so you know we can copy and paste to cool tool called Azure storage Explorer and what we can find out here well of course the source code some some of the secrets like function tokens host tokens and you",
        "know there's one thing unless we really Harden it in the cloud uh make the storage C account not available to the public or let's say disable the right access what we can do we can just delete and upload but there is a bit if we do the hardening then you know if it's not publicly available it's more tricky or inconvenient for the developer to put to put the source Cod there you know and if we remove the right permission then if you are just using the vs code for pushing your source code of the servers",
        "function then it will not work",
        "right so what you can do you can complet the right the function itself and execute your own code and that just by leaking your environmental",
        "variable and next and this is the most important interesting and important environmental is this container star",
        "context it's short lft URL and if we follow the URL we get something like this it's basically the container configuration encrypted context well",
        "looks nice right but what does it mean well we did some digging and it's basically the encrypted context is AES",
        "encrypted payload where the first part is in Vector the second part is the payload itself followed by the hash and guess what was the decryption key",
        "anyone okay I give you a hint it's the container encryption key the first environmental variable so we can decrypt it okay looks like that but what we can get out of it well of course authentification tokens but let's assume",
        "that we can execute the function anyway so doesn't add so much value right but most importantly manage identity proxy",
        "settings and we consider this should be hidden from the from the server environment",
        "itself so we got asure function what our",
        "manage idity we got aure function we got storage account and we got very nice image and we want to work with this image ins our our asure function and we don't want to put our credentials inside environmental variable so what we do we use manage identities this is how it looks like the most important is it's running within the same container as the serverless function this is how the reply looks",
        "like so but what is underneath you got a",
        "meure functions there is a binary running inside the same container and because we decrypted the contents we get all of the parameters of the propy including client certificate end points",
        "and some other parameters and this is just forwarded from the binary to the per to the public endpoint this is forwarded by to get the token so to what",
        "we found a lot of environmental variables including proxy parameters but",
        "what does it mean well it turned out we can obtain a valid jwd tokens and how we can do it outside the aure environment itself and this is actually where it breaks the security barrier because it should be hardening it for inside the Azure so just by leaking the environmental variables we can obtain the tokens from the manage identities but there's one important bit to mention of course Azure is kind of secure platform and unless you explicitly specify the permissions for",
        "the manage identities you might get the token but it got no permission at",
        "all there's little demo so first of all simulate the leakage of the environmental variables decrypted the encrypted context as you can see here this is the client certificate among another proxy parameters then we use it inide another",
        "ask for the token once we get the token we contact our storage account and get some metadata out of it and this is what all done outside the aure the only communication with the asure environment was first communicating with the vulnerable function and getting leaked the environment varas itself and there's one important question to answer why this all happens right well obviously the important bit",
        "is the environment variable popularity itself you know sometimes when I looking on these issues I get the feeling that we you know everyone feels it's safe we use it and we don't think what is underneath and then they may be like slight Cod chain change you know some stress and then it's just inherit to the",
        "to the child process or maybe yeah some",
        "might don't know maybe do know but you know it's acceptable a risk for us and it's sometimes okay right but we as a security people should know about the consequences and telling others what could go wrong so that's a really strong statement of not knowing how to use an environment variable what do you suggest David well in this particular example uh simplified artial we got the Azure function host which is basically container image and a process which executes the language worker which in our case was so Python and then you execute your user code and because this container image is publicly accessible inside Microsoft container registry we can play a little bit with and also use it inside our new serverless function so",
        "what we did we basically renamed our python interpreter to python in with the little hack and replace it with this compiled binary and what this comary B it utilize pseudo utility to Run in under different R play user and that's why because well obviously we if we got",
        "code execution which is the worst part we could still read the all of the environmental variables because it were running under same user because of the nature of the Unix right and then we pass a new environmental table and here we can see only one environment variable so we did our testing and it turns out that for our serverless function it's not needed at all it was just needed that for the function H which actually spawns our service function so it means it was just inherited maybe it was not even intentional it just",
        "happened we wrote some article about it back in then something about disclosure timeline",
        "we originally find this issue in April 2022 we share with Microsoft but you know at the time of being and with this Cloud VAB ities or security issues depends how you call it there is sometimes Blue Line because we are assuming that the function is vulnerable by itself you know so the severity it's not that he it's not traditional RC so we haven't been contacted B so we is the blog post a year later net SPI folks discovered the same issue credit for them they were much more persistent pushing the Microsoft to fix the issue now it's fixed and generally the binary was taken outside the container and there was another container created then if you contact manage ID entity running somewhere else and the manage proxy uh is somewhere else although you can still get the credentials for the storage account from the environmental variables okay this is our original block F this is the block po of the netsi folks and this is all for me and now it's time for NES so NES",
        "Stags so thank you d uh I think the first episode was pretty good now we begin episode two that is on the Azure machine learning service so these days AI is being sprinkled in almost everything that we are going to be use going to use or going to be know get going eventually and it's super cool uh by now we have somewhere or the other been you know exposed to these services or at least you know tried your hands on or something so these are all the services that are are based on the Azure AI platform and it it depends on the Azure AI offerings so the applied AI services are the offerings which basically solve a business problem these are followed by the cognitive services that are the machine learning models that are offered as a service which is consumed by the applied AI service and eventually the applications that we use and all of this is actually built on top of azure machine learning service so well azure machine learning is a cloud-based machine learning as a service offering from Microsoft in EML",
        "you create a workspace and this workspace is basically the centralized place to do your machine learning operations So mlops eventually falls down to uh having some compute having some cloud storage and a way to monitor the logs and there are a few more other parameters to it so the workspace is dependent on certain Azure services like the storage account the Azure keyal the Azure container registry and the application inside services so the storage account for each workspace a storage account is created where the storage account is used to keep your machine learning models and your machine learning data sets as well like uh data sets jupyter notebooks logs models snapshots Python scripts and all of these other things this is where you keep your stuff and there are various other compute options that Azure ml provides where you can run your code and compute instances are managed uban 2 virtual machines by managed we mean that the security of the host OS everything is managed by Microsoft themselves so the OS image contains like various tools used by developers such as Jupiter uh Jupiter notebooks vs code cond Docker Python and all of these other things unlike Azure functions we have complete root access to this virtual machine or the compute instance additionally these compute",
        "instances contain certain programs or",
        "middleware agents that are created and maintained by the cloud service provider in this case Microsoft so these are like secret undocumented agents that are used to configure environments diagnose environments and do a lot of other stuff and sometimes open up Avenues of information disclosure and code execution as well so these may be open source like Omi or these may be closed source as we'll see in a bit so the compute instance is where you run your code and the storage account is where you keep your stuff okay so the approach was not very magical since we had root access to the compute instance we wanted to inspect the network traffic that is going in and out when we do something we want to check the running processes to find such agents uh reverse those cloud service provided agents because they are not open source and maybe we can find some undocumented API or some overly permissive API and of course explore the logs that are generated when we do something",
        "so as David shared earlier this is a similar example let's say we have a function app and a compute instance in a user's uh subscription and we want these asure resources to access a storage account so",
        "one of the ways is to hard code credentials but uh that's not a recommended way we have a cwe for it and Microsoft recommends using something that is called a manage identity so the first type of manage identities is a user assigned manage identity so this identity can span across resources and can be also used by multiple resources for instance in this case we can use one single user assign manager entity to allow the function app and the compute instance to access the storage account the second type of manage identities are system assigned manage identities this identity is specific and tied to the life cycle of the resource to which you assign it and these identities cannot span across resources",
        "to get going with manage identities using Azure CLI you can run AZ login followed by this uh flag of-- identity since we have root access to the virtual machine or the compute instance what happens when we run this command a get request is sent to a local uh Port which is 46808 and again since we have root access we are able to figure out which is the underlying process that is listening on this port in this case it is identity responder D well what is identity responder D it is a powerful demon uh it runs as root and it is also known as Azure batch AI identity responder demon so does it respond with some identities some tokens we'll see in a bit and it also fetches its configuration configurations that are stored as environment variables in files so these are the locations of the files so these are some of the environment variables that are used by identity responder demon to get going with a computer instance and particularly MSI endpoint MSI secret and the CT URL these are the three important environment variables that we need to focus on well we just want to figure out how does the outbound traffic look like to see whether we can do something about it so we have eventually this post request where the host header is set and the post request body contains the certificate thumb print and the compute instance name that is set as the instance ID and the resource for which we are you know getting the token for and to talk to this end point we need a pair of certificate and a private key from this hardcoded port uh path on all compute instances that you will ever create so overall we have this compute instance which contains a binary that is identity respond demon remember that this is a closed Source binary we don't have any public code a available for this which talks to a public endpoint using a pair of certificate and a private key and in the response uh the the manage identity jws can be fetched and used from the compute instance let's say the certificate and the keair are compromised in an assumed breach scenario like a post compromise scenario these are compromised and exfiltrated from the compu instance could an attacker still use the same pair of certificate and key pair to get the manage identity token from non- aure environments let's try to bypass the security boundary right now we found that we could not so we got a 401 unauthorized so we're like okay so did Microsoft really win there let's see so the certificate and the key pair they are actually tied to the compute instance and these are unique per compute instances so like no two pairs of certificate and the private key will ever be equal H but was that it like we could have just you know packed our bags and left but no just kidding so enter",
        "DSi Mount agent DSi agent is another binary that exists on all compute instances which again runs as root it is known as batch AI batch AI DSi Mount agent and it also fetches its configuration from environment variables stored in files like the same environment variables David So yeah so",
        "this is the same binary that uh same agent that we found uh vulnerability in last year for black hat USA so we found a bug in the binary itself where in Network Adent attacker could basically fetch logs for any service and in this case you can see we can fetch the uh logs for Jupiter service because Jupiter is installed on all compute instances so let's say if you are a data scientist who is using compute instances and running some commands as pseudo using the Jupiter terminal they would get in the logs and these logs can be viewed by a network agisent attacker and this issue was later fixed uh with the cve now I'd like to present what was ini ially plannned for last year's blackhe hat USA but things changed the last minute so the configuration files for DSI Mount agent contain certain interesting environment variables like some symmetric key some certificate uh",
        "cluster certificate some cluster private key some XDS endpoint so what is happening here well the purpose of DSi Mount agent is to make sure that the file share of the storage account for this workspace is mounted on the compute instance and it does so by checking every 2 minutes so its job is just to make sure that the file share is mounted on the compute instance so turns out the DSi Mount agent talks to the batch exds endpoint using the same pair of certificate and the private key that identity responder demon uses and in the response we get something what do we get So eventually the post request uh like the outbound traffic looks something like this so we are not concerned about the post request or the uh headers and all we'll just focus on the request body because from here onwards the certificates are the same the endpoint is the same the URI is the same so yeah let's see what is the response for request type get workspace so we reversed the binary DSi Mount agent and we found this function called uh clients get workspace info in this binary and we have this request uh type set to get workspace which is the post request body this request is sent to the batch a XDS endpoint using the same pair of certificate and the private key that we saw earlier and in the response we get the AML workspaces metadata this metadata contains information such as the storage accounts uh resource ID the key walls application insights the tenant IDs the subscription ID so this can be thought of like the who am I of the AML workspace later we come across another request which looks like this so we have a function called get workspace Secrets where the request type is set to get workspace Secrets just note that this binary is not open source so we are able to find this after we have reversed the binary and in the response we get an encrypted form of the storage accounts access key so the response is decrypted by certain environment variables that are again stored in files for the DSi Mount agent and the DSi idle stop agent which is a different binary so using these two environment variables we get the decrypted symmetric key and using this decrypted symmetric key we are able to to decrypt the response that we saw and eventually obtain the storage accounts access key and that's where David helped me so you're welcome thank you so the attack scenario is something like this we have a certificate and a private key and a bunch of environment variables that are stored in files these variables are used uh as configurations for uh for",
        "these middleware agents and you can use these to get the storage accounts access key let's say these three files are compromised now what would you do to invalidate the storage accounts access key well NES what about if we rotate the keys right H that's a good idea let's see whether that",
        "works so on the left I have the AML workspace and on the right I have a bash terminal open on my laptop so on the AML workspace I navigate to the uh storage account and I go to the access keys section now we view the primary access key and we copy this to the terminal on the sorry terminal on the okay let me just play this again so yeah on the left we have the AML workspace and we go to the storage account so after we go to the storage account we go to the access",
        "keys and we copy the first like the primary access key that is being used with this storage account so after we have copied this we will run the P where have where I have exfiltrated the certificate and the private key so we are able to get the current storage accounts access key now what we will do is we will generate the storage accounts access key again we'll basically rotate the key so now that the key has been rotated we will copy this a newly generated key back to our terminal and now we will uh synchronize the AML workspace to use this new uh storage accounts access key so once this synchronization has completed we will go back to our terminal and we will rerun the PC to see whether we can get the rotated storage accounts access key and as you can see we got the rotated storage accounts access key as",
        "well does the story end here like all the stories that could have been this one does not really end so fast so there were a few more agents that talk to such public endpoints using a pair of certificate and a private key and in the response we get certain Crown jeels like storage accounts access key the EML workspace metadata information and a lot of other things there were a few more agents that we could look into and reverse and figure out what else can we fetch using the storage accounts access key using the certificates and the private Keys basically so the idea was to find what else can we request and what else can can be the uh the parameters for request type in the post request body so the function for example get workspace Secrets calls another function that is generate XDS API request schema so the post requests body is is generated by this function so the request type parameter is populated by this function so the idea was to look at all the cross references across all the binaries to this particular function and find out what else could be done and this is the list that we uh came up with in this we have generate SAS generate data store credentials get ACR token get secret so we put so we pick get ad token because that's you know interesting and then back then I don't think Azure was renamed to entra so we were good so this function called get a token which is there in the host tools package for identity responder demon host tools and a lot of other binaries as well so this is how the request body looks like where we have the request types set to get ad token and the request body contains the resource for which we are fetching the token for this is sent to the same batch a XDS and point and in the response we get the entra ID JWT of the manager entity that was assigned this is how the response look like and similarly for fetching the user assigned manag identity we just specify the client ID in the request and we get the enter ID JWT of the assigned user assigned manage identity quick recap so we have certain binaries in compute instances that talk to public endpoints using a pair of certificate and a private key and we can fetch the so this is how the compute instance fetches the Whi of the AML workspace the storage account key the jwt's for the uh manage entities and a lot more of stuff and if these credentials are compromised in a post compromise scenario an attacker could do the same well but we can use the locks right we can see the activity that something happened okay you the logs let's let's find out well let's do some legitimate activity this is using the Azure ml SDK or you could just you know run easy login hyphen I identity from the compute instance and using the certificate and the key pair from the same compute instance outside the comput instance let's say this is already compromised we run this request and we get these logs so the difference between the attacker logs and the compute instance logs don't really signify something uh you know important that we can Bank on to figure out whether this request came in from the compute instance or from an attacker's environment and as you can see the sign in details don't contain any information about the IP address so that would have been one indicator that you could have you know banked on but you can't so how do we detect that someone",
        "have stolen our",
        "certificates you can't use the logs David that's too",
        "bad yeah well but let me referes why why",
        "why is this even a vulnerability can you explain about that okay so when we go to the documentation for Microsoft we came across this one particular mention about identities manage identities is that by Design only the Azure resource to which we have assigned the identity can use this identity to request tokens from Azure ad but we are able to use the certificates and the private keys to fetch tokens outside the resource to which the identity has been",
        "assigned so trust but did you verify you know the documentation could be outdated we all know who develop software we don't like doing documentation",
        "okay well you know everyone someday somewhere needs someone whom they can absolutely Trust and Believe In to confirm things from the Lords themselves we dialed in aure",
        "support so we called aure support and I asked them like why don't the manage identity signin logs contain any IP address and this is what they came back with so the assumption is that the manage identity tokens are fetched from a local endpoint so just like AWS imds endpoint so in this case because of the feature of manager entities the logs are not helpful that you can Bank on later just to be sure about things it turns out that the certificate couldn't be uh figured out whether it came from like where the request actually came from and again they said like okay Microsoft entra does not record the IP address because it is assumed that the sign in happened from the targeted manage identity resource so uh like a quick note on the persistence so using the certificate and the private key you can get the rotated Keys the jwt's for manage ID entities the certificate is valid for two full years so if you have a compromise you wouldn't know for at least two years that you know somebody else had the backd door access and yeah to to invalidate the certificate you need to delete the compute instance and obviously these logging discrepancies can be really helpful for attackers so the disclosure timeline looks uh interesting for this so we had planned to share this research with the community back in blackhead USA however the vulnerability was reproducible and not fixed uh before the before the talk was recorded we reached out to Microsoft and they deemed the bug to be a low of a low severity and later upon Microsoft's request we redacted the details although this bug was over the 90day zdi disclosure uh policy and it was reproducible as well Microsoft has recently confirmed that the vulnerability has been passed and we have also validated on our end currently the fix does not allow the certificate and the keypad to be used outside compute instances later we'll be releasing this blog by 22nd of April so stay tuned on that as well so how many services support manage ID anyway yeah that's cool uh there are over 50 plus Azure services that can support azzure manager entities",
        "so we have looked into azzure app Services Azure machine learning service so possibly researchers you can look into other services to find more variants and find logging discrepancies in the service all right uh time to wake up folks uh so back to R takeaways yeah so if you sleep till night there is key take takeaways to take from this talk I'm not saying you can't use environment to variable inject Secret inside this but you have to be very careful when you do it and know the consequences and that the thing can get very bad and it's definitely not a wall well it's always good to threat model cloud service provider services to to you know to get an idea what could get wrong and perhaps create an action plan if something gets wrong because you know if you hardcore secrat and then you find a leak and you have to rotate that it it's pain yeah but if you store them in the world you can do it by one click also one of the security cliche follow principle of leas privilege and this is especially important for the cloud deployant because single access token",
        "could lead to the full cloud account comp right especially if you get like high privileg or like service",
        "principle if you are a threat researcher examine Cloud apis find the box and make the whole environment even more secure so it's very important to test and secure your authentication and authorization Scopes so from where you can use these certificat based uh like authentication to work definitely we if we had the actionable logging then we could have detected such sort of things and you know you could have been much more secure such assumed breach approach",
        "uh can lead to such security findings as well and that would be really hard to detect and obviously uh Challenge official documentation and don't forget to call asure support uh we'd like to acknowledge uh Zer Initiative for helping us out with uh Tri like getting the bugs across Microsoft and now we open the floor for",
        "any questions that you may",
        "have I think we have one question",
        "okay sorry I'm Paul your colleague so do",
        "you have a recommendation for those uh stolen certificates I mean how the S so can detect it so based on the logs that we found the S so could not be able to detect whether the certificate abuse was happening from an Azure environment or from an attacker's environment because one of the factors that one would Bank on would be an IP address but the IP address is not there in the signin also Reed okay you would have to detect the initial Breakin but you wouldn't detect that something was leak perhaps or use to leak maybe but use not okay all right thank you uh if you have any other questions we'll be down in the hallway and we'll be also back here tomorrow so we can connect there uh these are our QR codes uh feel free to reach out and thank you for attending breaking manage identity barriers in Azure Services once again we are David and NES and we'll be back with some cool stuff thank you"
    ],
    "js-3OI1_65U": [
        "Welcome to our talk B Randomness protecting against cryptography Perfect Crime my name is tberry I'm the CEO and co-founder for Zeno in Zeno we make a very secure H cryptocurrency wallet ER",
        "powered by MPC technology we will touch it a little bit in the solution part of this uh uh talk and I'm really excited",
        "to be here this is my first time in blackhead Asia really wonderful event",
        "but nine time as in all other blackhead",
        "event so let's see so first of all I feel obliged to tell you there will be no AI in this talk no machine learning no llms so yeah I see couple of people leaving the room but some are entering so thank you for coming all the Boomers no no AI I'm a boomer myself so no shame minut it also no Greek letter were harmed in making this talk so there will not be although we're talking cryptography and I think we are maybe the only talk in the cryptography track there will be no formulas we try to explain everything with loadbearing",
        "analogies okay so after we talk about what will not be in this stock let's talk about what actually is going to be in this stock so we'll start by H explaining why we claim that bed Randomness is cryptography a perfect",
        "crime and then we'll move on to some True Crimes and see how a three at least",
        "three examples for in the world a exploitation of these",
        "high-profile ER vulnerabilities to ER in",
        "multiple Fields including cryptocurrency",
        "authentication and uh Internet Security",
        "with TLS and we will not leave you just with the problems we also suggest some practical solutions to that so let's start with A Perfect Crime what would make a crime A Perfect Crime so first of all it needs to be lethal it's not just shoplifting you have to do something really really bad for it to be perfect crime but this is you know you can go to any other H talks here we're all talking about vulnerabilities take take over computers and so on so forth so everything is little but the most interesting point is the second point we want to do it in an undetectable manner this is the important this what makes a crime a perfect crime and we claim that bad Randomness is indeed a Perfect Crime so why is Randomness bad is lethal",
        "because Randomness is vital this is a quote from Professor dois Randomness cryptography is like the air we breathe you cannot do anything without it so we can conclude that positively Randomness is is vital but the converse also holds like the lack of Randomness it's indeed",
        "ER very very bad for the health of the system and this is because of kov principle the security of a cryptographic system only depend on the security of their of its private key and",
        "so therefore Keys should be kept secret and be unguessable you all know that but what is the best way to make something unguessable making it so hard that even yourself you cannot guess it and the way to do it is by injecting injecting Randomness into the process so even I don't know and cannot recreate that key",
        "unless I store it so it makes it unguessable but the use of Randomness is not limited just to keys but also other crypto parameters such as H nonsense",
        "initialization vectors IVs so on and so forth and when H these values that supposed to be random if they are not random then in most cases it break totally breaks the whole cryptographic system so we had established that bad Randomness is a very ER critical and a big crime yeah",
        "but is it undetectable and the answer yes very much because this is a famous Dilbert cartoon and the random number generator says all the time 999 and say is it really random say okay we cannot really tell and this is of course takes it to extreme but the real problem is that there is no such things as random number okay it's cism like it actually means these are",
        "numbers that were created by a random process H and so this is actually Randomness is the quality of the process not of the number so when you get or your system gets a number supposedly from the random number generator it has no way to make sure it's actually random right because the number in itself is not random the process that created it was random but of course you cannot tell if a number is random or not just the process can be random or not but you have no evidence for that and um it's",
        "not only maybe you're saying okay I cannot tell for one number but if it's nine all the time then probably something wrong there so I can look at the series and do something about it but the problem and maybe I'll cannot do it in real time but I can collect forensic evidence post more time and analyze it and this is really interesting you will not have such evidences because this evidence is",
        "not collected by Design because if we collect the outputs of a random number generator that is used for keys that used for cryptographic uh elements we create a new vulnerability right because attackers can take it and use it so this is did the Perfect Crime not only we don't have the evidence we are forbidden from collecting such evidence so indeed you can create bed Randomness as an attacker and no one will know so it's little it's undetectable so let's start with first in the wild story of bed Randomness so this is our first uh season and in which we will attack",
        "Bitcoin addresses with bad Randomness and see how it was it actually exploited in the world this is important not just a vulnerability it's actually exploited in the world all of these examples so let's remind ourselves how H Bitcoin addresses are born it all starts with a random 128bit uh number uh you add some",
        "check sum to it and assign H to each group of 11 bits you assign a award from a dictionary from B 39 dictionary to get the notorious Infamous seed phrase so",
        "you can back up that that uh private key and then you",
        "apply some key derivation function to it h 200 rows of H",
        "Maka and finally you can so in in order to have multiple address created from one single ER secret you apply some",
        "hierarchical um deterministic derivation",
        "out of it but this is all details what important to note is uh that it all starts with a random number and all the security of H of your Bitcoin the your",
        "private key controls everything if you have it you have everything if you don't have it you have nothing in so all control is concentrated in in this random number but if it's not really random then someone else can guess it and can break the whole system so we wanted um before that so this is actually happened this is a report from a few months ago from The Washington Post says if you create a Bitcoin wallet before 2016 your money might be at risk because ER long story short because it was created with some bad Randomness it was JavaScript uh random number generator which is not uh as random as we want to have doesn't have enough H entropy and also it's since this is create a private key and in Bitcoin and cryptocurrency your private key determines your address it's not just something disposable you have to you keep reusing it so even if you change wallets at the time and you just move your fund by a again using that seat phrase to H recreate H your addresses",
        "from backup you are carrying that vulnerability with you over the so although you're not using the original wallet that introduced that vulnerability you are still vulnerable to it and there was quite a few H ER",
        "quite a few incidents that people lost their money but again bed Randomness is stealthy you don't know if the problem was bed Randomness or maybe maybe they were negligent about keeping the SE fres maybe they had a mware on their computer so again you see bed Randomness is very very stealy attack it's very hard to prove it so we wanted to create such that will prove that there are people out there there are Bots out there that are really looking for it actively looking for it so we thought okay let's create such vulnerable address let's start with an anop instead of randomizing well let's start with the number one which quite appropriately creates",
        "the following sitras of abandon abandon abandon abandon H which is quite prophetic but also because U the bip 39",
        "dictionary is lexicographically sorted",
        "so the first word is start with AB so it's abandoned but it's quite nice okay and we made sure this address is pristine no one used that in the past so no one should have the private key of it there is no evidence that someone had the key it and then we wanted to H send money to it and when as we send money",
        "you can see the time here is H 9:51 then immediately the same Split",
        "Second this money was transferred from that address resulting from the private key which is was not random and immediately it transferred to another address so it means that bed Randomness attackers are real there are BS lurking for transaction of bed Randomness addresses and monitoring the men pool in",
        "real time waiting for a transaction to be broadcasted across the network and when they see it they even fight over it like there was multiple Bots trying to fight over the transaction paying high the fees were all also going up and up and up and finally someone want about it if you want to read more about it we published it in two blog posts a few months ago now let's go to our second ER exploitation which kind of uh kind of similar but uh has another element so",
        "you would see it's not really only related to ER to private kids also other",
        "elements of H of cryptographic protocol are vulnerable to bed randomness",
        "and we'll talk about the ecdsa nons ecdsa signatures are used in many",
        "security related protocols authentication and also cryptocurrency for example Bitcoin and ethereum uses that",
        "and this nons is must an ACS has a nons",
        "requires a nons and that NS must be secret so again let's make it completely random so even I cannot guess it because",
        "if Ann is somewhat predictable it's well known and in fact presented a few years ago in black hat that even one bit of er leakage from the can be really ER dangerous for the whole protocol and",
        "someone repeated the same experiment",
        "that we did he reused anons over the ethereum network and again he was his",
        "addresses were abused and immediately and money was immediately transferred right of right from his transaction his account to another",
        "attacker ER controlled account and there",
        "are also like there was a another vulnerability in yubik that had same issues it was not report to be exploited but they had to recall all of their Ubbi Keys ER back to the factory and reset everything so and now to completely different example so if you were bored you're not into cryptocurrency you say it's a hoax maybe you maybe you're right I don't know but uh now we'll talk about something we all use and this is the TLs protocol so we're starting something new you can reconnect okay so let's talk about the TLs malware the reductor mware was identified by kasperski five years ago and attributed to the Tola AP group",
        "this malware patches the random number generator and also inject certificate",
        "Authority H certificate which allows the",
        "H the enables the attacker to send the TLs encrypted and signed traffic",
        "which is not actually from the h actual",
        "website so but let's before we dive into",
        "the detail let's remind ourself of the basics of the TLs handshake and we can see where Randomness comes into play there so the first message this of course sent in plain text because this is what you're doing you're doing hand check in order to coordinate um a key between Ellis and Bob client and server is sent it must be sent in plane and contains the client random which is U represented by this lovely d",
        "ice and what happens if the prng is",
        "infected is is exploited and it's not",
        "really random it means that a fixed ER",
        "value will be sent in PL Tex which allows the attacker to identify the victim traffic out of the general public",
        "ER traffic and how did the attackers did that this is still taken from spy original uh blog so they just patched uh",
        "four different uh functions in different DLS it depends on which browser the victim were using so they just patched the uh prng with something that instead of Randomness return some known value that was calculated it was specific for each uh user and the result if you look at it over the network would be if we replace the random bytes let's say by all zeros it's visible over the network so let's",
        "do some cyber paleontology as ctin Rio",
        "from kasperski would say and with you know P onology you take a bone from a dinosaur some teeth and say okay this dinosaur was that big and was doing like that and he was a grass eater or carnivore or so on so we know that the reductor Mel patches the Pang and injects CER certificate Authority sech so what is it doing so it must be related to a server monster in the middle what we used to call man in the middle now it's monster in the middle and uh let's see how we think or how kaspi thought it worked so the",
        "attacker ER infects their victims but",
        "also has some presence over the ISP or somewhere Upstream to the internet and",
        "so when they see a benign user not infected their client random is indeed random they just let it pass and get a normal response out of the server but when they see the victim sending a message and they know this is their Victim Because the random is something that the attacker expects then the monster in the middle can fiddle with the response and send something they sign in the name of the of the attacked website and the client will trust that because the mware also knows to inject a certificate Ator Authority certificates and everything works",
        "perfectly so up until now we just presented the original kasperski research and there are some observation we need to take out of it so monsters bed Randomness attackers are real okay the some AP ER",
        "did actually did it they played with the prng for their own causes H and although",
        "you would some would say okay this is if we hadn't had this case someone might have said this is theoretic because although like attackers can get everything they're already presented on the victims machine they can take the traffic from there they can fiddle with the response from there but they prefer to fiddle with network traffic so why do they do that and and the first answer it does not really matter it the the most important thing is it does happen like attacker have their own reasons for do that to for doing that therefore this is a valid attack scenario we should be worried about having a malware on the victim side and having a tandem H",
        "monster in the middle malware on the ISP and but if we want to resonate about it a little bit we can see that this is a very much more stealthy mode of operation if you obviously if you do it at scale so instead of doing all the dirty work on the client side and fidling with traffic and exfiltrating",
        "data out of it you can just you know do",
        "as Minal work as needed on on on the client which where it is exposed to antivirus edrs and so on so forth and do",
        "all the dirty work on on the server where you are most ER like it's it's much more sheltered environment from the attackers perspective so you can we can conclude that the this is a very important like stealthiness is important for toight attackers and now we move on to our new findings on this old case so what we",
        "present before was the classical ER tlsn",
        "check but were Improvement to it the TLs and check with EDH a femal Dy hman and in this case ER there are another H",
        "parameter that needs to be random and this is the client Dy Herman parameter",
        "and why do we use Dy Helman ER to begin with so the point of FAL D hon was to provide perfect for secrecy to TLS because prior to D man uh the attacker",
        "could which is an if dropper can if drop to the encrypted traffic and just store it hold it h on the side for years it can they cannot read it but they can store it and hopefully for the attacker perspective one day they will be able to compromise the server take the private key from the certificate and read all your past er er communication with this",
        "server and with Dy Herman the client",
        "also ER participate in creating ER the",
        "that key and it's also ephemeral likey it's not stored in any place so H because of that process ER this eliminates that attack Vector because if you store ER that uh EDH encrypted",
        "traffic with ls it's useless afterward even if you compromise the server certificate and how does do",
        "the how does d hman achieves that so if you look at the right hand side at least for me also to it's right hand side you can see Alice and Bob and let's do some color analogy so there is one common color everybody knows it this is yellow but Ellis and Bob picks a color and random let's say Alice picked a red and",
        "Bob ER selected at random blue then and",
        "then they are mixing it privately they're mixing it and the security of this protocol is because mixing is a one-way function you it's easy to mix two colors together but it's very hard to separate them ER to separate them so then both Ellis sent to Bob they're mixed the the color mixture the orange and Bob s the uh the green color mixture and then each of them adds to it their a mix again their private ER color again",
        "the secret color again so they both get a a mixture of yellow red and and U and blue finally H which creates a brown but",
        "an e dropper that listens to this traffic he knows it sees the yellow it",
        "sees H green it sees H orange but it",
        "cannot ER combine them together to get the brown but obviously if ell color the",
        "client color red it become known to the attacker maybe they choose red for Ellis",
        "then it's become trivial to H to to get",
        "the the resulting brown color because H",
        "the attacker knows that Ellis selected",
        "red and it's is over the wire that Bob public the mixture is green and it can and the attacker can do the same as Alice and get the the common secret",
        "together and this is exactly the attack and that's what we think TOA was doing because reductor attackers could probably passively e drop because as you can see even if they didn't mean it and I think they meant it but even if they didn't meant it because they were patching the random number generator for the client random it also affect the client DH parameter and the client DH parameter is also non random and known to the attacker in the same manner that the client random was known to it so how we think it actually like an addition of course you can t attackers can be also active men in the middle and that's why they had their CA ER root the ca injection um capability in their malware but they can also passively e drop so again in this setup when a benign user H SS their request uh the the monster in",
        "the middle just ignores that yeah and lets the request just flow but when a victim send the traffic ER the the maner",
        "in the mid knows it can see the result of it because it knows that if you have that random then your private D",
        "parameter is something that is known to the attacker and can get readability to the request and responses so this is demo time and I include the recipe you can H look at it up afterwards but let's switch to the demo itself so in order to simulate H I hope you can see if not I will also describe what's going on so in order to simulate a client a vulnerable client we took a python script that uh Implement Dy",
        "Helman is it playing I don't know",
        "play maybe we",
        "should okay",
        "sorry yeah okay it's playing and instead of uh creating client uh random at random we just hardcoded all zeros to it",
        "okay so what what you should have seen here is we we had um er bu we had built in ER we had coded the random numbers and also the private Dy Helman key and we created that vulnerable ER client",
        "for Dy Helman key exchange and then we created another",
        "tool all of them are free and open source and will included in this presentation that actually decrypt the",
        "traffic and given just the public ER",
        "data and the knowledge of that uh private key so if the demo would actually work that it was the place that you would clap but let's go on so thank",
        "you thank you thank you guys you're very gracious thank you and um so what are",
        "the additional observation out of this process so bed Randomness is so undetectable that we're not even sure what the attackers have done like five years has passed and this discovery",
        "slipped the eyes of kasperski but we cannot even there I I cannot think about evidence that will positively show us",
        "except if we would sometime catch that server uh component of this uh of this attack and or someone from that uh AP group said okay this is what we done so it's very very H stealthy attack and",
        "attacker are even more stealthy now because passive passive is the ultimate stealth mode and what another General",
        "lesson from that in in cryptography and security as a whole that it's hard to talk about what is more secure than others because like say Okay P PFS",
        "perfect H future secrecy is great right because it for some attack model of attack holding our traffic for a lot of time H it it it helps but h on the other",
        "hand for this attack model where the attacker can play with the random number generator and has some Er monster in the middle setup H which is real as we had shown like for this it reduces the secrecy because attacker can now passively decrypt that without needing to compromise the original server so",
        "it's interesting to say like that security is multi-dimensional so when you add in one place maybe you create new vulnerabilities in another place so let's talk about Solutions and let's start with solutions that doesn't work bad solution so maybe when you thought about it okay you said I cannot trust anyone if I cannot even trust my H my random number generator I will create my own Randomness on my own and um like inspired by this XKCD I",
        "can create a passphrase that will create enough entropy in it and people actually did it it was called brain wallets and entropy was generated from passway and uh over a decade ago Ryan Cuchi showed",
        "on defon that he can probably guess many of that and he found 700 more than 700 Bitcoin so in today's value or yesterday's value and start of the man's value it was like $50 million so Ryan could have been a very rich man if it wasn't so you know obsessed with ethics and stuff but um for example down the rabbit hole held about 80 Bitcoin in",
        "July so it's like $5 million in today's uh value so you as the Bitcoin Wiki concludes humans are not a good source of entropy so although we want to reduce our dependence uh dependency in a random",
        "number generator we still need them we cannot be our own random number generators",
        "okay what actually works is if we reuse existing good good Randomness so more of let's say sustainability let's not uh",
        "overuse",
        "that scarse resource of Randomness",
        "because each time we use Randomness we give another opportunity for the attackers to attack us so for example instead of randomizing the nons that we saw for ecdsa we can just deterministically derive them from the entropy of the private key and the message so this is H secure and used in many wallet same trick can also be applied to some uh TL",
        "communication also it's called the Aus streak and instead of the server creating a Randomness again directly",
        "from from the r number generator it takes it from its private key again with the oneway function some sort of h mark and another parameter so it cre so we don't re we don't ask the random number generator for more and more Randomness but reuse the existing H Randomness so",
        "this works and additionally obviously we need to protect the random number generator itself it's as important it's protecting the secret because that actually generates the secret so one way is to just dig deeper you know if you store ER your private key in a secure Hardware then your random number generator is part of that secure number but this is limited because let's say you want even more security how do you get it you cannot get any more Hardware into it and the way to scale it is is it's kind of like in AWS you need or sorry in cloud services like it's better to scale horizontally because you can add more and more H machines instead of you know scale vertically and and you building bigger",
        "bigger machine because this is limited so if we distribute the random number generation",
        "then we can easily scale it because the",
        "motivation behind it is H if you add up a lot of numbers and one of them is random then the whole sum is random in itself right ER so one ER one honest",
        "party can save even if all the other parties are corrupt corrupted so let's do it distributively it needs to be in a non- naive manner like so it requires multiparty computation and this project for example the Run distributed run is doing just that so again and and it's",
        "very much easier to scale that because if you worried okay someone could infect all of my the the parties like I'm using two parties two parties is not enough ATT attacker can ER in parallel infect this the first party and the second party okay I can add a third a fourth and so on and so forth so I hope you convinced that this is easily scalable and this is exactly what we're doing H in our Zeno wallet and others are doing in NPC computation for ecdsa so with MPC",
        "the key generation is distributed so B randomness of single party will still create a random key because the the the",
        "non-corrupt party the healthy party save",
        "the corrupted party and also signing is distributed because we have Randomness in signing also so if you remember the nons that is used to ecdsa sign so again the randomness of it comes from two parties as part of the protocol and uh",
        "our implementation for it by way is the open source and you can just use it and we documented it in many other blogs so to sum up MPC wallets ER has no single point of failure the key generation is distributed so even if malware is presented in is present in one of the parties that actually ER generated the key still the other it doesn't have a a",
        "hold over the other party because they are very different different operating system and so on and so forth and but not only prot protection against malware but also protection also against Bad Randomness",
        "again this is because of the secure design of the system like a secure security architecture is very important because we we didn't had in mind the problem of bed Randomness we didn't think about it but because you create a very secure architecture of this that is doing key generation and signing in distribut manner it also helps in the randomness because again the randomness in itself is also a distributed okay and",
        "even if one party is compromised or its random number is getting compromised still the other party is enough to save it",
        "okay so just to sum",
        "up bed Randomness is indeed crypto's",
        "Perfect Crime because a it's lethal and b h it's undetectable it's actually",
        "being exploited in the wild ER we Show an example of AP attacks on TLS that",
        "uses bed random nness Bitcoin Dark Forest attackers eum Dark Forest attackers there are also other and we mentioned horable mentioned for UB key authentication ER vulnerability due to H",
        "bed Randomness and the solution we suggest is protect your prng remove unnecessary Randomness requirement not everything needs to be randomized from the beginning you just you can just derive it from randomized values you had in the past and use multiparty computation and distributed computer ER Computing to avoid single point and failure and last but not least always make sure that your video is working before the talk so I conclude with that and if there are question I will be happy to take them if someone wants to take to ask take the",
        "microphone thank",
        "you hi I have question ah my name is Aron I from Intel uh I mean I saw in your talk uh you talk about uh prng which is the pseudo random number generator have you U or in any of this work that you talked about today has any trng or a true random number or a drng or you know it has been used in any of these uh any of this work and the random number generators that you talk about in your second part of the question right so the random number generators that you talk about have they passed the nist",
        "randomness uh test Suite so this is this is a great question and also let's",
        "assume like the random generator is actually good okay like provide value but the attackers maybe can sleep like",
        "they take like you have a good random number generator nista proove it's a true random number generator it takes it from lava labs that uh you know from that um the entropy from there nothing wrong with that but then the attacker instead of giving you like the output of that random number generator just plugs in their value okay so just bypassing it",
        "in itself so you are right like there are certain type of problems",
        "that arise from defunct random number",
        "generator and so if you protect against it it also it's also good but like the hardest uh part is to protect against maliciously random number generator jump like you had the nist ER random number generator and uh someone just you know plugs in something else instead so thank you very good question thank",
        "you okay thank you guys if you want to talk to me I'm here and also you have my Twitter handle so thank you and I hope you enjoy the talk"
    ],
    "KbVWEQeeMzI": [
        "hi everyone welcome to this session uh we're happy to be here so today we'll go back to the roots we'll find the origin of a Content security policy bux yeah um so I'm Tom this is skan um",
        "we are both researchers at the University in Len in Belgium uh where we do all sorts of research uh related to web security and privacy and nowan will give a brief introduction on the search that we did thanks Tom so why exactly do we want to find the origin of CSP bugs well as you can see from these uh article headlines it's still a prevalent issue these report on bugs against uh security policies so it seems that browser developers still don't seem to uh be able to prevent all these bugs right um so to uh find the origin we we",
        "hope to actually find the reason as to why they can be prevented that easily so first a bit of context uh what is the content security policy or CSP for short so it was introduced about 10 years ago as a defense in depth against content injection attacks like for example crite scripting and essentially when you visit a website that website has a opportunity to include a CSP and then client side in the browser that policy will be enforced so CSP is what they call a living standards throughout the years a lot of new features new use cases have been added nowadays we're at level three just to be on the same page a small example let's say this is a social media website and this in particular is a web page uh that presents the profile page of a hacker and despite the uh content sanitization counter measures of the social media website the hacker was able to still inject a script now if any visitor of this web P page will have their cookie leaks leaked now the",
        "website can prevent this by wining up an extra layer of Defense being CSP and this policy will effectively block uh the injected script now as we saw before",
        "um the the implementations of these policies can have errors and this also um makes it uh more easy for the developers to circumvent this policy right um and in this case maybe uh the hacker could circumvent this measure to still execute the script",
        "like I said before CSP was introduced about 10 years ago and throughout this time uh a lot of bugs have been discovered as we will see later on uh so the central question of the stock is what is actually the origin of these bugs because if we know the answer to this we can use it as an attacker we can find out where to find the next bug but also as a Defender we could find out how to prevent the next bug but maybe the most important question for now is how are we going to going to find these answers and for this we looked at the smallest recorded code changes that introduce or fix a CSP bug so for this we used code revisions so these huge browser code bases they uh use Version Control Systems like get for example to track every change that is applied to the code change here every Green Dot stands for a snapshot of the code base or a git commit or a code revision if we combine that with proe proof of concepts of know bugs we can then use um Dynamic analysis to find out what snapshots of the code base are vulnerable in this case the red squares and this in in uh as a result gives us the Cod changes that actually introduced or fixed a buug and the associated metad data now this is very nice but these um",
        "these browser code bases these are huge they consist of more than a million code revisions and still each day more than 100 are applied so doing this manually is not very feasible and for this reason we develop Buck Haw which will automate the life cycle analysis of these browser bugs so essentially you give bu hog a pro concept of the bug you want to analyze and then it will uh find the introducing and fixing revisions now this looks a lot like a bisection tool that's because it is but it also sets itself apart from all other bsection tools um this is because these uh binaries are executed in their own container so we take care of all dependencies uh this makes us able to evaluate even very old browsers uh we can go back in time to chromium and Firefox version 20 also we can run these evaluations concurrently to speed up the the full evaluation",
        "process uh this we used in a study to evaluate uh 7 75 CSP bugs and uh we",
        "found some very interesting things here first of all we looked at the code changes that introduced um these bugs um",
        "and more specifically we looked at the intentions of the developers that applied the bugs um it turned out that half of the bugs in our data set were already introduced at the very first revision that CSP support was introduced these are called foundational bugs um a lot of these lived under the radar even one buck with a bounty of $5,000 lived under the radar for eight years also modifications to CSP logic uh are very prone to introduce new bugs for example even fixing e csb bug is prone to introduce another csb bug um then also adding features that",
        "are not really related by uh uh to CSP but should be scrutinized also caus bypasses because of oversights of",
        "developers we also ID identified a lot of room for improvement for cross browser bug sharing um so if a security bug is reported for a browser it will be shared with the other browser vendors because um they share the same functionality sh uh same uh",
        "specs uh the current practice uses the web platform tests so essentially it's a public G repository and regression tests of security box are pushed there and other vendors can then pull these uh into to check if their effectives as well we evaluated this process uh by performing cross browser uh evaluation between chromium and Firefox so essentially all bugs reported for chromium in our data set we tested for Firefox and vice versa so we started with the 75 unique bugs of these 14 uh could be reproduced in both browsers these were shared and eight of those were only reported for One browser now more interestingly seven",
        "so half of 14 uh could have been reduced in lifetime or even completely avoided at all if uh communication was more effective now we also extended the evaluation to the release of safari uh this was 16.2 and here we could reproduce four of the publicly disclosed bugs uh of course we reported the issues and this resulted in three fixed and one not considered Aug um very important",
        "here is that Safari was exposed to these publicly um disclosed bugs for more than one year and this is something you really want to avoid as a browser vendor but it even gets a little bit worse uh we also identified inconsistent bug handling which led to premature disclosure so in three cases the bug was publicly disclosed by the browser vendors themselves uh before they landed an effective fix this was a case for two chromium bugs and one Firefox bug and in each ofes it exposed the browser for for more than one year even in the case of the Firefox book this one was still present in the latest release at the time of our evaluation but again we reported this and this was fixed yeah so uh as K mentioned uh there's there were like three main issues that we found with the related to the life cycle of a book uh namely like when there's an introduction it's more likely that there's other bugs there as well um like there might be also uh bgs",
        "that live across different uh browsers and the way that they're handled so in the next few slides uh we'll explore how um we could use this either as an attacker so I'll play the role as attacker which could be like a bounty hunter a redeemer or a security researcher looking for BS in the browser um and then we'll also look at uh how we can uh defend against these uh andan will be playing the role of the defender",
        "um so whenever there's a a change made to the core logic of CSP it's quite likely that um more than a single book will be introduced um that's because",
        "well we did this analysis of these 75 books and that's kind of what we found um so as uh another thing is uh",
        "when there's things like iframes or other sort of inheritance of the the content security policy uh the enforcement of that is pretty difficult um then the third thing that we found is um when we have the script Source directive which is pretty complicated compared to the other directives those are also quite likely to introduce uh all sorts of uh different",
        "bugs and uh also the way that um the",
        "content security policy is uh enforced in a browser because it's been um because first we had all these different features and then afterwards uh we",
        "retroactively applied content security policy to that uh the enforcement is quite fragmented uh which means that sometimes uh browser fendors might miss something and uh there might be a very simple",
        "bypass so how can we use this uh as an attacker um so we can can look at uh the different public book reports because security reports become public after time they've been fixed um and we then might use a tool like uh book hog to find which uh revision introduced the book and which one fixed it uh so we can look more deeply into uh the introducing book Because as we found there's uh it's",
        "quite likely that there will be other bugs introduced in the same revision as well",
        "uh and we can also look at the fix uh and see whether uh there's well the fix is complete covers everything and um we",
        "can com even compare it with the introduction to see if uh everything was uh fixed correctly then we can also use some sort of uh heuristics uh because we know like um when there's code touching the core CSP logic or there's some sort of inheritance logic it's more likely that there will be a bug uh so we could use all sorts of different teristics and then uh as an attacker we can more uh easily focus on uh the the different",
        "pieces of the code that are more likely to be vulnerable or we can uh figure out whether a book is or um a code change will be uh more likely to introduce a new book and ideally we would also automate this uh this is something we're not quite yet at with bu hog but maybe in the near future uh we'll get",
        "there how can you use this as a Defender well based on our data uh we found that centralization of enforcement logic really helps uh it really reduces oversights uh that introduce bypasses an",
        "example of this is uh the inheritance related bugs we found in total 22 inheritance related bugs and 20 of those affected chromium and only two affected Firefox now this is the case because Firefox did a much big bigger efforts Central uh centralizing this um enforcement now later on chromium developers also did a huge effort by putting um CSP enforcement in the policy container and this was landed in 2021 and this immediately resolved uh seven of these inheritance",
        "bugs so um",
        "as uh is kind of similar with the attacker the defender can also assign more resources based on euristic or likely culprits um in this case for example uh it should really pay more attention to changes to the course uh source code that are likely to introduce bugs and this means for example assigning more reviewers creating more tests um and going further on these tests uh in the ideal case these would be automated and uh actually we found that a lot of these bugs that were part of our data set uh could have been prevented by very simple generated tests",
        "for example if you add a new feature you can test it against the most strict possible policy and in the case of CSP for example when a request is still sent this indicates a bypass and you can also uh take this strategy when a new policy is introduced for",
        "example so as we've seen uh we also identified uh a lot of room for improvement considering uh sharing of bugs among vendors quick recap so uh seven of the 14 bugs in our data set that were shared could have been prevented of or reduced in lifetime and four public bugs still affected the release version of safari also a little detail um so five of the 14 foundational bugs in chromium later appeared in Firefox as a regression um so this means that it um really makes sense to still include regression tests of other browsers even if you're not uh affected from the start",
        "um and you would think that these uh regression books might have been features that chromium added way ahead of Firefox but this was not not the case these regression bugs were introduced due to CSP Buck fixes and um this was in four cases um due to a buck fix but in one case it was also due to a CSP en enforcement design",
        "revision so yeah what what can we then do uh with this as an attacker uh so we know that like um these",
        "um uh these books get publicly disclosed and some of them might already contain uh certain tests so a very simple thing to do is just run the same test in all the different browsers and as was the case with uh well at least Safari and um",
        "Firefox as well we might already discover some new bugs um unfortunately not all of the the fixes and the book reports contain uh web platform tests so if there isn't one already then it's sometimes fairly straightforward to just write one and then just keep on testing until you find that the new browser version becomes uh vulnerable to it",
        "um and then yeah next to looking at the the browser book reports we can also just look at uh the web platform tests and use kind of that as a sort of inspiration uh to find new types of books uh so we can um like uh take a a",
        "test for one particular book and make some small adjustments and then see if uh this would would be applicable to other uh browsers possibly as well uh to find also new",
        "books uh as a Defender book sharing platforms you use should be obviously representative and this means consistent sharing of bugs with other browser vendors uh in the short term this means maybe changing the the uh sharing practice we identified a lot of disadvantages with the current practice of using the web platform tests itory for example sharing is postponed it's only done after creation of a regression test um sharing is public so when it's pushed to the repository it's public to the world and then the other vendors have um have time to react essentially and there's also no security Focus we think it would be better uh to use a privately shared book reporting platform uh this enables um sharing bugs as soon as possible even right after triage um also sharing is private and vendors can even uh disclose the bug in agreement and there would be ideally a distinction for security bugs and in the long term we also think that browser vendors can learn from each other um as to how they actually solve the same",
        "bug yeah and then uh the last thing that we uh wanted to highlight was the the handling of uh of bugs and for instance",
        "uh the way way that they're being tested and being uh mitigated uh so we found these uh three uh books that were prematurely disclosed um so for instance two of them were uh regression tests um because in one case uh the tests contained a meta tag instead of a header and that caused the test to to succeed while the vulnerability was still there um and then another bug was in Firefox where um the the bookwood exist in the package build but not in the non-package build and the not package non-package build was the one used uh to run the test um and then uh last case was um when there was a fix in chromium um that's where the fix was eventually reverted uh but this was not reflected in the book reports so the developers thought that the book was fixed while it was actually uh reversed and the vulnerability was still",
        "there so what we can do then as an attacker is that um again to see if there's any regression tests or or fixes",
        "and uh to check whether uh these are complete and and sufficiently uh covering all the different uh issues um and even we can um look at uh",
        "differences in the test builds versus the actual releasee builds because the re release builds is the thing that we actually care about because that's the the things that actually uh run on the the users",
        "devices and uh whenever there's a a revert uh that could also be like looked at as a sort of red flag uh to kind of yeah raise the awareness of the attacker and try to look into why it was reverted and was it correctly applied and was it later on was there actually the the fix Rel landed um and if that's not the case then uh that's a very easy book report to make um and then finally the attacker could also uh monitor certain lines of code of a fix um because if there's uh",
        "adjust adjustments being made to the fix uh then it might be that the fix becomes undone and then the vulner ability will be reintroduced as a regression so that could also be valuable for aner to look into that",
        "specifically as a Defender um is really",
        "important that regression tests are in inherent part of the fixing process first of all as a s check did the fix really work uh in the intended uh way",
        "but also in the long term um we could use regression tests to find out what go change actually introduced the bug uh in our data set we um the bug reports in 87% of the cases actually identified the",
        "um fixing revision you would think that this is 100% but in a lot of cases uh developers didn't really know how the bug was fixed uh these were primar primarily bugs that uh took a long long time to actually fix um then uh the identified",
        "introductions here book reports only in 6% of the cases really identify",
        "these so uh consistent and comprehensive testing is uh very important uh as Tom already mentioned um it's really important that binaries should represent",
        "um the release binaries as much as possible and also uh the test should be independent of policy delivery uh whether it's delivered through metat Tech or through the header and then also mentioned uh for the attacker is the red flags so div verions from the default fixing Pro uh protocol um should be indicated as a red flag and here I'm talking about reverts and Rel lens for example okay we've arrived at the last slide just some key takeaways of this talk first of all uh we think that buck life cycles are a much needed tool to better understand bugs um this is both",
        "from an attacker's and a Defender perspective uh we also found five issues by just looking at publicly disclosed bugs and these issues affected releases uh so browsers they implement the same specs and as such can be vulnerable to the same attacks um some",
        "bugs were only reported for a single browser so it makes sense to really effectively share these and we think that for this a back channel is needed instead of the web platform tests that are currently being used um we also found several instances of uh BS book Mis mishandling um some were",
        "publicly disclosed before the fix was effectively landed and this was caused by incomplete regression tests and also by uh an unreported revert and as a last point I want to mention that buck hog is open source it's free to use uh you can use the QR code to visit our GitHub page and with that I will conclude the talk thank you [Applause]",
        "big questions thanks for your talk so um um as you went through the identifications of the the moments where bugs was uh",
        "introduced uh did you also check",
        "the author of the changes um has any",
        "pattern uh come out of that should we should we start blaming the people who actually introduce if they do that repeatedly in particular uh we didn't actively um compare the authors um but I think you will always",
        "see the Nam same names because the teams that work on CSP for example the are these are quite small uh I'd say um but",
        "we didn't look at it but that might be an interesting statistic as",
        "well if there is no other question uh so you have done that for CSP uh how how reusable is your",
        "framework you look at I don't know X archive for instance something like that EXs you know these kinds of things um essentially if you can make a proof Concept in a website that just requires",
        "um yeah that just sends a request to a certain endpoint when the BG is reproduced then it can be integrated as such in in our framework so I guess it's uh we already tried it for uh evaluating uh hsts for example uh also cookie policies so it's uh I think it can be widely uh used for other policies as well and yeah maybe in the future also um things unrelated to the browser might be applicable um where because we already have like the whole infrastructure to run things run the different tests um so as long as we have um like a yeah a repository with the different commits uh we can already start identifying what would what caused the issue and what uh fixed",
        "it",
        "questions thank you again",
        "[Applause]"
    ],
    "3lpMaFVvF64": [
        "thank you blackhe hat iser for providing this opportunity this is my fourth time participating in black hat and I feel incredibly incredibly honored today I",
        "will be sharing a presentation titled attacking debug models in the Android ecosystem my name isi and I will be the speaker for this session first let me introduce myself",
        "I'm currently working working at a self-driving company in China called moku Auto am responsible for the implementation of the car to Road Cloud integrated solution in China I oversee",
        "the management and Technical work of the entire security team currently I'm",
        "leading the team to protect the security of the car to Road Cloud integrated infrastructure and enhance the comp company's Network and data security previously I gained five years of work experience at Buu primarily focusing on mobile and iot security I have submitted a significant number of security vulnerabilities to Google Android mediatech and uniso five",
        "handroid CV vulnerabilities has been credit to me and I'm also the top one Buck Hunter in the uniso product security acknowledgement in 20 in",
        "2022 I was awarded the title of topb Hunter by Google I have I have participated as a speaker in multiple industry security conferences sharing my knowledge and insights I will present the topic in four sections background thre model case study and summary in the background section I will Begin by introducing the fragment fra fragmentation of the Android system next I will discuss the native debugging architecture of Android",
        "furthermore I will delve into the propriety debuging architectures developed by two major vendors I will provide an overview of their unique debugging Frameworks tools and features in the three model section I",
        "will focusing focus on conducting an attack",
        "surfaces surface analysis of debugging models in the case study section I will provide practical EX examples of vulnerability discovery that Al with the attack surface analysis conduct earlier in this cases case study will illustrate real world incidents where vulnerabilites in debar models were were",
        "identified and exploited by examining",
        "these cases we can gain insight into the potential impact and the consequences of such vulnerabilites in the summary section I will provide an overview of the key points discussed through out the presentation and offer recommendations based on inside gain this section aims to summarize the importance of securing debug models in the Android ecosystem and providing provide guidelines for developer security and",
        "organizations the Android ecosystem is composed of several components as deped",
        "in the diagram starting from the bottom",
        "we have the system on chip layer which includes major s so Chip manufacturers such as quum medch uniso providing the",
        "underlying hardware and Bard sport package capabilities the second layer is the well-known Android open source project",
        "which not only provides capability at the so level but also offers open source code for Upstream customization and",
        "develop development the third layer consists of various products including smartphones",
        "tablets inal and aiot",
        "devices the four the fourth layer represents familiar OEM Brands such as Samsung xiaomi Huawei and Google self-developed pixel",
        "devices this layered structure contributes to the complexity of the supply chain and introduce fragmentation with the within the Android ecosystem fragmentation is primarily",
        "manifested at three levels product frag",
        "fragmentation wers customize their own",
        "lunches and operating systems such as",
        "mui magic U and hary Os along with customer development at the system level apps including debug models not notepads",
        "and device interconnect activity",
        "features system fragmentation window",
        "perform customize the development as the framework layer of USP to adapt to their Hardware characteristics they also Implement lowlevel implementations at the hardware abstraction layer to bridge the framework and the driver layers bsp",
        "fragmentation wers customized their the",
        "hardware related driver models which are reflected in video processing Wi-Fi",
        "Bluetooth G SS 4G and 5G audio processing display acceleration and the security related components based on the analysis above",
        "it is the fragmentation of the Android ecosystem that leads to a merit of security issues affecting various aspects of the entire",
        "industry to address the security issues introduced by fragmentation Google has",
        "implemented the following four strategies introducing the window petition Google introduced the window petition in the Android over which is especially designed to host to window specific uh bsp code this allows for better management and isolation of window specific components Hardware",
        "abstraction layer Google is established",
        "the hardware AB abstraction layer as a bridge between the user level and Driver level components Hardware abstraction layer provides a standardized interface and abstraction layer enabling High higher level applications to interact",
        "with underlying Hardware operations without the direct dependence on the specific drivers security bulletin Google",
        "published monthly Android security bulletin that include critical and high severity vulnerability is reported by the window penners this ensures timely disclosure and awareness of the security vulnerabilities presented present in various wi specific implementations",
        "implementations Android chipset security",
        "reward program in",
        "2019 Google initialed the Android chipset security reward program aimed at",
        "at identifying and reward rewarding security vulnerabilities especially",
        "targeting s so's unfortunately as um as",
        "as of May 2023 Google discontinued the",
        "acrp these strategies reflect Google's",
        "efforts to en enhance Security in the Android ecosystem and magicat the risk case Associated the",
        "fragmentation Androids native debugging architecture consists of various of components as deficit in the given St standard Andro architecture diagram from top to bottom system APS Java API framework native C and C++ library and WR time Hardware abstraction layer and Linux kernel the standard uh debuging",
        "architecture in the Android serves three main purpose log capture this includes",
        "capturing e log kernel log and subsystem log for example modem DSP Wi-Fi",
        "Bluetooth these logs are captured to and analyze and debug the behavior of of applications system components and",
        "specific",
        "subsystems function verification this",
        "involves validating the functionality of",
        "Mo of models such as the camera display hardware and GPU rendering it ensures that these components are working as expected Factory testing this refers to",
        "the testing and validation of specific functionalities during the uh manufacturing and the verif verif verification CA phase it often involves",
        "window specific tests to verify the proper functioning of hardware and software",
        "components when it comes to the Android debug architecture the first thing that come to mind is the developer options",
        "the developer option provide the following basic fun functionalities which can also be found in the Android standard development document General",
        "option this includes option such as",
        "memory management error reporting and OEM unlocking debugging related options",
        "this includes USB debugging and Android debug Bridge debuging which allows for debugging and communication between a computer and an Android device Network",
        "related options this includes options related to Wi and bluetooth settings input related option this includes option for touch feedback and input settings session related options this include the option to display layout boundaries which can be useful for Dearing and optimizing the user",
        "interface here is the translation of the",
        "provided explanation about the debuging process using Android debug Bridge as shown in the uh diagram from left to right first the user enable enables USB",
        "debugging the action is performed in the settings AP especially in the settings",
        "provider where the flag settings Point global point it be enable it sets true",
        "at the framework layer there is a system server called Android point thebug point I manager this service continuously",
        "monitors the flag settings Point global point ADP enable when it detects that the flag is set true it start the native Diamond adbd using the CTL Point start",
        "method at this point the user can use debugging tools to connect to itbd for theing",
        "purpose here is the translation of the provided explanation about lock capturing in Android both Android art",
        "layers logs and Native layer logs are involved through Java native interface",
        "and accessed where the Android system",
        "Library called Li log Li log maintains",
        "continuously communication with the native Diamond log D through Unix domain sockets allowing the output of application Level logs to be sent to log D when using loog cat to capture logs it also communicates with lockd through uni domain SS to rate the relevant log",
        "outputs through the L as Linux rules of",
        "the log D we can see that logd itself has permission to read chronal logs and system",
        "files based on the analysis of the two aspects of Android debug architecture we can draw the following",
        "conclusions the debug the debug model involves complex IPC communication",
        "including Banner calls Unix domain socs content providers Hardware inter how",
        "interface definition language and more",
        "the data flow within the debug debug models is intricate user level data is",
        "progressively passed to higher privileged native diamonds and",
        "drivers after introducing the debug architecture of Android let's now shift our Focus to the window debugging architecture firstly let's consider the",
        "question why do winders need need to do the customize the the debugging I have summarized the following three points lock capturing it is necessary to optain debug logs from subsystems and have standardized the debu compatibilities which include capturing debac information from all models such as mediatech e and uniso",
        "yock fun function verification involves",
        "Tech testing multiple Hardware related functionalities such as telepon connectivity hardware and location Factory testing tools are used to perform basic checks on Hardware components during the factory stage such as the screen and and",
        "others let's take a look at the Lo capturing capabilities of v u in the diagram from the left to right at the user level there is a system AP called engineering mode exposed this AP can be",
        "accessed through two method a security",
        "code and invocation from a third party AP within this engineering mode AP",
        "multiple activities are introduced for example log management is used to control Lo s Android lock control is used to control Android locks at command control is used to test the effectiveness of AT commands and modem loog config is used to conf configurate configure modem related loog loog",
        "switches these various activity or",
        "applications communicate through IPC to",
        "pass data flow to low level models such as native diamond and Hardware abstraction layer service most of these lowlevel models are implemented in C++",
        "and have system and root level permissions the diagram on the on the right showcase the control status of various log subsystems by the debugging",
        "AP the second case is about window M's",
        "debuging architecture it also features a",
        "generic debuger UI as the entry point with various native diamonds and the",
        "background communication between them is established through Unix domain socket data flows gradually from the debuger UI to the native diamonds under go processing and is then transmitted to the driver",
        "later let's move on to the third case which involves wi use feature testing and Factory testing tools the AP in question is a system AP called",
        "SPD Auto SLT which is introduced by",
        "default in its bsp model this model can be invoked by third party APS with",
        "within this system AP various testing model are in included such as Wi-Fi test RF carry test RTC test backl test camera",
        "test System warant test GPS Test Bluetooth test SIM card test otd test and more behind each of these testing function negatives is an APC mechanism that directly re reaches",
        "the lowlevel components for example the framework is involved through Banner core native diamonds are accessed to where Unix domain soet and system files and read and are are read read using fail read operations the diagram from the right demonstrates the presentation of the final information",
        "results let's take a look at a real life case OnePlus PHS are discovered to have",
        "a backd door vulnerability that could allow direct rooting of the device the issue steamed from the inclusion of a customized engineering mode AP by in the pH components attackers could exploit the lency or in engineering mode system app to gain rout access to the device this highlights the following two issues the first point is that the bsp often includes Factory testing tools which can introduce highrisk s security",
        "vulnerabilities these tools if not properly secured or removed before the device reaches the end user can be explo by attackers to gain unauthorized access to or control over the device the second point is that oems or odms often lack security awareness and fail to remove debugging tools from their firmware package packages this this",
        "oversight can leave leave devices vulnerable to exploration and the debugging tools may provide unauthorized",
        "access or control over the device",
        "functionalities this diagram illustrate the attack surfaces surface of the an analysis thebug models which can be dived into four parts from the",
        "perspective of system APS they are vulnerable to attacks from the Network and local attacks from third party APS in terms of network attacks system APS",
        "May often concern Point ports",
        "and and and accept abnormal parameters to perform High privileged operations",
        "in terms in terms of local attacks system APS accept parameters through exported interfaces such as activity service broadcast and provider since system APS have have high",
        "privileged if they are compromised",
        "attack attackers can gain system level access and Carry Out further privileged escalation attacks moving on to the framework later parameters from the user space are re received through aidl if there are in efficient peration",
        "checks in the debugging components in this layer it can lead to local privilege",
        "escalation for Native diamonds they often receive data from the application layer through Unix domain soet improper handling of the data can make them vulnerable to attack Hardware abstraction layer service receive parameters through H IDL and and",
        "drive and driver and drivers receive parameters from a control if these parameters are not properly processed",
        "the models can also become Target targets of",
        "attack attacking debug debug uh",
        "attacking debug APS the attack path invol involves",
        "invoking High privileged components of of the AP through a through a third party AP the targets of the uh attacks",
        "are exported components of system APS",
        "which can lead to local privilege escalation for information Le",
        "leakage additionally system APS May",
        "listen on socket ports which can result in remote command execution the following diagram illustrates two types of vulnerabilities found in real Life",
        "Cases I will provide detailed expl explanation of these vulnerabilities in the subsequence case study section attacking debug debug Diamonds",
        "the attack entry point is the Unix do soet POS secate issu that can be triggered include include memory corruption information leaks command in injection and so on attacking debug Hardware abstraction layer Services the attack entry points",
        "are the unique domain socket or H IDL possible security issues that can be triggered include memory corruption information leakage and command injection attack attacking debu drivers",
        "the attack entry point is through the is through fa operations possible issues that can be triggered include memory related problems such as memory corruption and information",
        "leaks through vulnerability search on thebag models we conducted in investigations on three popular windows",
        "and discovered hundreds of security vulnerabilities earning 49 CV",
        "credits let's take a look at cve 2",
        "2022",
        "2098 and information disclosure vulnerability in the debug model of a certain win the affected debug model is called a AED which is a debug debug",
        "debuging native Diamond the model",
        "exposed a Unix domain soet named com",
        "point mtk point ae.",
        "a64 the model accepts parameters from",
        "UDS among the parameters there is one for transmitting any process ID which",
        "the E modu pressed the command pass through the UDS it extracts the p and dumps the corresponding process memory information resulting in information",
        "disclosure the diagram on the right shows the complete proof POC indicating",
        "that the transmitted PID can be arbitrary this allows a malicous process",
        "to gain unauthorized access to the memory information of other",
        "processes ultimately leading to",
        "information disclosure",
        "another issue related to information disclosure is a corresponding debug AP the AP logs various unique identifiers of the devices such ASI MSI calling",
        "address and so on let's take a look at cve 2 uh 2022",
        "48382 a memory corruption",
        "issue the affected process is a debug House service called window Point SPD Point Hardware point lock at",
        "1.0 service the entry point of this",
        "process is the hidl common socket which",
        "is a Unix Dom socket in the first image on the left there is a buffer flow vulnerability it can be authorized that the vulnerable as represent the stack",
        "space with a default size of two 4,096 bytes",
        "the data passed into the function is received ex externally through UDS and can have a vulnerable lens this vulnerability occurs when the length of the inut exceeds",
        "4,096 by resulting in the buffer",
        "overflow the image on the right shows a PC which passing data with against of 10,000 b caus a crash in the affected debar House service",
        "let's take a look at another memory corruption issues as the driver layer the problem is identified as CV 2022",
        "39118 and the affected Dearing driver is SPD C stump the attack entry point is is",
        "through fail operations the issue here is an auto bound right vulnerability when writing and ex excessively long bite sequence it",
        "triggers a panic in the kernel and the PC is shown in the image on the",
        "right this case is a local privilege escalation vulnerability identified as",
        "cve 2022",
        "47339 the affected process is a root privileged the debug diamond called CMD service the attack entry point is the Unix St socet named the cmds KT by default CMD service is not enabled it only starts when the property flag CMD",
        "Cy CS Point CMD service enable is is set",
        "to enable CMD service accepts complex",
        "parameters through the Unix Dom soet SMD SKT and eventually passes the parameter to PO open for command",
        "execution this ultimately",
        "to command injection allowing for local PR local privilege escalation and arbitary command execution with root",
        "privileges the last case let's take a look at a complete vulnerability exploration",
        "process this vulnerability is identified as cve",
        "2022",
        "27250 it is a recurring issue duplicated",
        "issue that was initially discovered by the security company septo septo whereare the problem",
        "occurs in the factory testing tool called spt AO SLT this AP accepts",
        "various debugging components such as camera debugging phone debuging FM debuging Bluetooth debugging and",
        "more the AP lens on point 7878 and",
        "accepts com commands the command list",
        "include",
        "ability to execute shell commands however the supported commands may vary",
        "depending on the device by connecting to",
        "7878 and sending arbitary share commands we can remotely optain system level privileges the SC Linux context of the AP is sp aut SLT",
        "AP let's further analysis cve 202 2",
        "47339 this vulnerability allows avatary",
        "command execution with root privilege but it has some limitations firstly enable the CMD service flag require the system level permissions to set property ordinar",
        "ordinary shelles or AP or third party AP cannot involve CMD service secondly the",
        "CMD service listens on Unix domain soet named CMD SKT and connections are",
        "subjected to Linux restrictions not",
        "every third party AP can connect to CD SKT and send commands we exam examed the as NE policy for CD service and found that CD SKT can be accessed by the SC Linux context of SPD Auto SLT",
        "AP therefore the attack pass is is clear as shown in the in the image on the right the attacker initials a remote attack to execute commands on S SPD Auto",
        "SLT gaining system level Privileges and",
        "acquiring the S Linux context of SPD Auto SLT AP then with system level privileges the attacker executes the set property command to launch the CD service process",
        "finally due to the SC Linux security context of SPD Auto SLT AP the attackers",
        "can directly send commands to CMD SKT and execute arit commands with root",
        "privileges the end result is remote",
        "acquisition of root access of the device it is worth nothing that that this root access is is within the SC in Linux security context of CMD service but",
        "impact is",
        "significant finally let's let's summarize the key points of the discussion firstly the debar model models cover multiple layers of the system from the AP level to the driver level resulting in multiple attack Services primarily Focus focused on",
        "interprocess communication secondly some",
        "debug functionalities require ex",
        "executing High privileged commands",
        "across processes in improper handling of",
        "these commands can lead to local prevage escalation lastly Factory testing tools",
        "often invoke Wi-Fi Bluetooth and",
        "telephony functionalities and handling",
        "of these tools can result in information leakage such as exposing WiFi address Bluetooth address M numbers and other sensitive sensitive information",
        "the security recommendations can be summarized in the following three aspects for vendors some dear modules should should not release to Downstream such as Factory testing for OEM and odms bsp models should be selectively",
        "choosing based on specific needies and not accept in in their entirety for users regular perform device security",
        "upgrades that concludes my presentation thank you for for listening thank you"
    ],
    "I5_v3yRqMVM": [
        "hello everyone I'm glad to share our research with you here today the title of our presentation is GS into the protocol for the windows RDP client for fun and perect my name is mjo and I'm here with my partner in as well as team members including our leader Ching former",
        "internet and the senior security engineer G we are from the dbpp security",
        "weing lab all right let's get to the point what we are going to show is quite simple uh it is entire process of fing Windows RDP client uh our presentation includes five parts motivation",
        "introduction and the fuzing process case studies and the future",
        "works so why did we choose RDP as our",
        "Target firstly uh it is a very popular and widely used remote protocol uh with a large use spase um secondly it is a very traditional and old protocol project as the RDP protocol first appeared with terminal services in",
        "Windows NT 4.0",
        "server the third reason is that there are some ADP vulnerabilities in the past few years such as the famous blue keeper",
        "on the other side uh there are not much vulnerabilities related to RDP in the past year uh means that we have may have uh some chance in this era actually uh in order to exist everyone's learning uh we need to understand some basic",
        "concepts the Microsoft Remote Desktop",
        "protocol provides remote display and",
        "input capabilities for Windows based",
        "applications running on a server via network connection uh this is its main",
        "purpose after continue updates uh the",
        "Cur current uh ADP includes Futures such as smart card audio Drive Port and",
        "network printer Direction and",
        "more through our research uh we learned that uh there are two attack uh scenarios so first scenario is that a hacker sending text pillows to the remote server through a client uh causing on the remote server to crash or taken controlled uh without oranization",
        "uh the second scenario is that a hacker takes control the RP client from the remote server uh you can also understand uh it as a counter measure it uh could also be used for Hy input",
        "purpose okay uh now we have two options",
        "uh do we choose client or",
        "server after careful sync uh we choose the client as our Target the reason is are as follows firstly uh the code of",
        "CLI is mainly implemented in",
        "mstx the point DL uh it means we have a",
        "clear uh Target secondly uh there are official API interfaces that can be used to uh test the client certainly uh compared with server",
        "the client uh is relatively simple and finally uh there are more prevere Works uh for reference um client so it is easy to get started here are some existing research uh Windows RP uh we read the materials uh carefully and Lear a lot of R",
        "them we then turn our attention to the watching channel uh verion channel is an extension channel that can be used to add functionality enhancements to Remote Desktop Service service applications",
        "watch CH is divided into static watch chinel and dynamic watch chin uh the server exchanges data with the client through the watch Chanel and this data are known as pdu acting as the bridge between the client and the",
        "server and uh you need to know uh the different or channels are needed for different expansion functions uh you can",
        "see uh that there are many protocol documents of for different uh",
        "channels for example uh the RP snd I",
        "want CH know that way will mention later provides a transmiss channel for audio",
        "and the rdpd provides an interaction",
        "channel for Hardware uh devices and the",
        "tsmf provides a channel for video data",
        "transmission and there there are more other channels but how uh how do we open these channels and utilize them fortunately uh Microsoft provides",
        "an API for this interaction uh it's called WTS API we just needed to utilize WTS API to open a watch channel and R",
        "data to already data to the watch channel and uh finally close the watching channel to complete the data communication uh between the server and client okay and above are all the knowledges needed to understand what we need to learn later next let my partner sh to continue showing",
        "all right before going to down the rapid hole of res enging we just want to find start start fing quickly so we found two opensource FS for RP both based on Windows AFL so we",
        "res and understand their Chang after that we distilled two f architectures for existing RDP fing Loop mode and",
        "proxy mode recod the first one I call Loop mode yes",
        "that loop I means let's move on in this mode we need to manually tracker function or use two other tools then reset rip register at the end of the function we will infinitely execute the target function to achieve fing for example when trying when we trying to RDP snd Channel yeah it's transmission channel for audio so when trying to F RP",
        "snd we need to play music on the server to track at manuary the second one I call proxy mode you can see that we have replaced the tracker with something we call WTS center it's different uh front Loop mode",
        "the WTS Center receives mutate data from the father and then send it back to the client through the WTS API",
        "okay we have to make a choice now which one do we choose Loop or",
        "proxy we choose to use a loop mode F first which is simple enough it's the fastest solution for us to start with even though Loop mode may not as stable as proxy mode next we prepared a the target",
        "function and Seed how did we find the target we we draw from our collection of materials identify impation targets for",
        "example Channel message Handler named on",
        "data received in the class function and seeds the seeds came easily from example in the official manuals it's veryable gy",
        "isn't",
        "it and now we also need to prepare a fing environment that contains client and server you know client is our tged for fing server as tracker only as you see based on what we know we have two ways to di environment the first one is the most",
        "direct we prepare two virtual matchs one",
        "as a client and the other as a server yeah we use client connect server that's",
        "easy enough the second one is a bit to the front talk in HEX account 2022 it's use RP rep to enable a Mion to be used as both a client and server at the same time I mean RP rep tempers with a server",
        "in order to allow local connections and",
        "even concurrent Seasons if we use a second method we only need to prepare virtual magion yeah you know this this is at least better than the first method however I must say RP rep is a third party tool and you know if we use the latest visor of Windows or no one shes the parameters",
        "yeah I mean it's configuration file uh of our windows vure we must to modify",
        "the configur configuration file",
        "manually I want to say a little bit more",
        "about config file it contains binary code of our patch the location of patch and more so you know we must do reversing and final patch Target offset",
        "it's you know it's crazy no that's not",
        "what we want that too trome but this our",
        "only options now so we have to make a",
        "choice finally in our insure",
        "attempt we still choose the first one it's easy enough of course in our later later Explorations we had a different way to start the environment we will talk about that later now let's see let's starting the",
        "father all",
        "right after completing these steps we can finally start our fathers we had the time to think more when we successfully launched a so next we have a problem we want to solve it first how to conduct patch fing you know we have a computer and we want to start more fers but the first method is not suable for batch builds so second",
        "method is our only choice anything",
        "else yeah sure we can use Windows Server as you know Windows server has Remote Desktop Service is it's suppos multiply",
        "user connections oh that's cool so we can build our virtu Mion and add RDS rows and cl it that's all it's easy okay",
        "so we choose to use Windows server to simplify the environment",
        "configuration okay now let's go back to",
        "fing okay you know when we are trying to solve other problems fting is also going",
        "now let's see how lucky we are as you see it's nice",
        "work I means we found a bug no we not we",
        "uncovered a bug in the rdps ND channel it's true but in the end after our analysis and Confirmation we found it it's unpatched and",
        "historically okay this makes us very sad",
        "so so this is a useless Discovery I don't think so because at least it Rems us that we are working in the first steps of our",
        "pressors next we still decided to continue let's keep going we will",
        "transplant a mutation strategy of hungo fas uh to our IDP fer visualiz the code passes for us to assess fing quality with which from Loop mode to proxy mode and added Network header constants to enhance fing efficiency we processed in reversing entering and constantly reading manuals we did a lot of hard work trying to get something but unfortunately we",
        "still haven't been able to achieve the desire outcome um but our dream is to start",
        "from here we discovered a mini",
        "buug in our processing in our fing process we have discovered a new relibility caused by a Nonpoint the reference when we first trigger this function the entires in the dynamic array are set to n it seems normal but",
        "when we trigger this function again we get an ENT with content as n so when",
        "program experiencing the non-entry the CLI has been",
        "crashed yeah after long wait this is our only achievement yeah it's it's easy and",
        "useless that means it's not K Bo we are trapped in Endless pain and doubt I mean",
        "is this how we end this is just just a worthless bug it",
        "has no it has no reward no we can't take it fortunately things have",
        "changed it it's almost a concidence we",
        "were fortunate to discover that Yuki Chen mentioned the new responsibility form of risk condition in his speech at blackhe hat USA",
        "2023 it's has caught our",
        "attention we see that 10 has achieved something with just a very simple father some threat and send some relate messages you can create destroy or",
        "setting you know that strued us so we",
        "said well the simplest way is the best I means the greatest truth is the simplest so after that we develop a simple F two we have some threat we send something to control something to open something something to close something uh to write something and read something and we try to send message out of others that we are interested in it looks like magic we know we are creating",
        "Miracles the fact is it's truly a miracle oh it's crazy we are entered a new world therefore we have received some crash reports so we start to manually AIT them and make some progress",
        "even though it's it's regretable some crash cannot be",
        "reproduced anyway let us talk about the cases",
        "below when we look at the crash logs we found several different CCS they all have to the same top level function as you see the function symbol means to operate iio asynchronously so",
        "maybe is it's a key sure it's the key it's true after we further analyze",
        "this we found that this is a use out freeb yeah it's it's a risk conditionability when we triy to operate",
        "the printer we found that it was a synchronous it could be open right and close but this functions did not lock the print handle so when we opened printer operate the print to right and close at the same time pom a crash",
        "orur it's very simple so we start thinking whether it could become an idea to help us better manual audit next let me partner a little Till case two Until the",
        "End okay um since there exist a rest condition vulnerability are there more other rest condition vulnerabilities",
        "given that it is a conditional rest the operation of creating Stace must be a sensitive behavior and there may be",
        "other conditional R in the implementation of creating th therefore",
        "we looked at the cross reference of the cre function and referred to UK kitchen's rest model to find the code that has used and releases but no look",
        "uh this uh approach may seem U somewhat clumsy however during the filtering and",
        "seing process uh we discovered an interesting",
        "bug look here uh under the pass of the prev rest condition um point there is an implementation of other uh another function uh which is specifically of XPS",
        "printers uh we fed and examined uh this class implementation and found that",
        "there is no look throughout the XPS code",
        "is yet a new vulnerability Point um by reading the documenation we found the me to arrive it then by carefully auditing the",
        "release logic in the XPS printer um and close operation we found that uh there is a risk window while opening the XPS printer",
        "therefore by TR triggering the close function when opening XPS printer we",
        "succeed uh in triggering a",
        "crash through reverse analysis we can",
        "describe the r model as follows uh the code presented reveals",
        "back that when 3 One open an XPS printer",
        "uh it will lose XPS printer Point DL then uh it enters a res window within",
        "uh which we attempt to start 3 two uh the purpose of three two is to invoke the close function for the XPS printer due to the lck of proper locking on the code the XPS printer is closed by 32",
        "causing the model to be unloaded then if 3 one attempt to exess",
        "uh access uh some pointer within the XPS printer model and exception will be",
        "triggered then uh we reported this two R condition vulnerabilities to msrc",
        "Microsoft addressed both vulnerabilities",
        "in the January 2024 update the number is cve",
        "2024",
        "21307 through binary diff uh we were able to understand Microsoft Patch uh for these vulnerabilities uh the solution was relatively uh simple it only didn't",
        "enters critical section and leave critical section operations to the code",
        "this is a common method for fixing rest condition",
        "inabilities finally we look uh look forward to the future visions of our work",
        "in this research uh we we focused",
        "specifically on Windows RDP client and",
        "only target of several or channels in dips moving forward we plan to exploit",
        "the RTP server and uh conduct uh security audits on more virtual channels additionally uh by using similar research methods we can also conduct security research on more",
        "Network",
        "protocols at the end of this speech uh let me uh Briefly summarize our blackhead sunbites firstly we have",
        "showed some skills on fing Windows RDP",
        "secondly we have showed our latest research on Windows RTP client vulnerability thirdly we have showed the significance of rest condition in vulnerability",
        "Discovery thanks for listening to us do you have any",
        "questions okay now if you have any c you can U contact uh contact contact with me on Swift card oh okay can I have one question uh so I I understand that in the end you um used uh race condition uh fuzzer not really fuzzing the data uh sent to the client is that correct yeah yes yes okay so uh you uh will you continue doing data fuzzing as well uh uh or do you think this is this approach is too",
        "complicated uh uh yes yes we uh we I'll",
        "try just try try make another um farther",
        "to test another protocol uh yeah So",
        "eventually it was not really the protocol fer itself right it was more on uh um I don't know how to put it right I'm not really like from the domain of uh um vulnerability research but I understand like you just use concurrency uh issues with your",
        "father uh maybe we can we can take it offline I don't want to put extra stress thank you for your talk okay if you uh want you can uh later to talk with me on Twitter or Swift card okay thank you"
    ]
}