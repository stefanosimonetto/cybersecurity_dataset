<!DOCTYPE html>
<html lang="en-US">
<head >
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Hacked Websites Mine Cryptocurrencies</title>
<meta name='robots' content='max-image-preview:large' />

<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://mashshare.net -->
<meta property="og:type" content="article" /> 
<meta property="og:title" content="Hacked Websites Mine Cryptocurrencies" />
<meta property="og:description" content="Cryptocurrencies are all the rage now. Bitcoin, altcoins, blockchain, ICO, mining farms, skyrocketing exchange rates - you see or hear this every day in the news now. Everyone seems to be trying to jump on" />
<meta property="og:image" content="https://blog.sucuri.net/wp-content/uploads/2017/09/09222017-EN-hacked-websites-mine-crypocurrencies_blog.jpg" />
<meta property="og:url" content="https://blog.sucuri.net/2017/09/hacked-websites-mine-crypocurrencies.html" />
<meta property="og:site_name" content="Sucuri Blog" />
<meta property="article:publisher" content="https://www.facebook.com/SucuriSecurity/" />
<meta property="article:published_time" content="2017-09-22T09:56:31-07:00" />
<meta property="article:modified_time" content="2018-05-21T13:58:52-07:00" />
<meta property="og:updated_time" content="2018-05-21T13:58:52-07:00" />
<!-- Open Graph Meta Tags generated by MashShare 3.8.1 - https://www.mashshare.net -->
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->
<meta property="og:image:width" content="745" />
<meta property="og:image:height" content="350" />
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Hacked Websites Mine Cryptocurrencies">
<meta name="twitter:description" content="Cryptocurrencies are all the rage now. Bitcoin, altcoins, blockchain, ICO, mining farms, skyrocketing exchange rates - you see or hear this every day in the news now. Everyone seems to be trying to jump on">
<meta name="twitter:image" content="https://blog.sucuri.net/wp-content/uploads/2017/09/09222017-EN-hacked-websites-mine-crypocurrencies_blog.jpg">
<meta name="twitter:site" content="@sucurisecurity">
<!-- Twitter Card generated by MashShare 3.8.1 - https://www.mashshare.net -->


<!-- This site is optimized with the Yoast SEO Premium plugin v12.5 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="We are seeing a trend of hacked websites with cryptocurrency miners from CoinHive that abuse visitor&#039;s CPU load, and it&#039;s escalating quickly."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://blog.sucuri.net/2017/09/hacked-websites-mine-crypocurrencies.html" />
<!-- / Yoast SEO Premium plugin. -->

<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Feed" href="https://blog.sucuri.net/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Comments Feed" href="https://blog.sucuri.net/comments/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Hacked Websites Mine Cryptocurrencies Comments Feed" href="https://blog.sucuri.net/2017/09/hacked-websites-mine-crypocurrencies.html/feed" />
<!-- This site uses the Google Analytics by MonsterInsights plugin v7.10.0 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<script type="text/javascript" data-cfasync="false">
	var mi_version         = '7.10.0';
	var mi_track_user      = true;
	var mi_no_track_reason = '';
	
	var disableStr = 'ga-disable-UA-4077922-18';

	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}
	
	if ( mi_track_user ) {
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

		__gaTracker('create', 'UA-4077922-18', 'auto');
		__gaTracker('set', 'forceSSL', true);
		__gaTracker('require', 'displayfeatures');
		__gaTracker('send','pageview');
	} else {
		console.log( "" );
		(function() {
			/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
			var noopfn = function() {
				return null;
			};
			var noopnullfn = function() {
				return null;
			};
			var Tracker = function() {
				return null;
			};
			var p = Tracker.prototype;
			p.get = noopfn;
			p.set = noopfn;
			p.send = noopfn;
			var __gaTracker = function() {
				var len = arguments.length;
				if ( len === 0 ) {
					return;
				}
				var f = arguments[len-1];
				if ( typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function' ) {
					console.log( 'Not running function __gaTracker(' + arguments[0] + " ....) because you are not being tracked. " + mi_no_track_reason );
					return;
				}
				try {
					f.hitCallback();
				} catch (ex) {

				}
			};
			__gaTracker.create = function() {
				return new Tracker();
			};
			__gaTracker.getByName = noopnullfn;
			__gaTracker.getAll = function() {
				return [];
			};
			__gaTracker.remove = noopfn;
			window['__gaTracker'] = __gaTracker;
					})();
		}
</script>
<!-- / Google Analytics by MonsterInsights -->
<link rel='stylesheet' id='sucuri-blog-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/style.css?ver=1.2.0' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://blog.sucuri.net/wp-includes/css/dist/block-library/style.min.css?ver=6.0.1' type='text/css' media='all' />
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel='stylesheet' id='select2-css'  href='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.css?ver=4.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='mashsb-styles-css'  href='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/css/mashsb.min.css?ver=3.8.1' type='text/css' media='all' />
<style id='mashsb-styles-inline-css' type='text/css'>
.mashsb-count {color:#cccccc;}[class^="mashicon-"] .text, [class*=" mashicon-"] .text{
    text-indent: -9999px !important;
    line-height: 0px;
    display: block;
    } 
    [class^="mashicon-"] .text:after, [class*=" mashicon-"] .text:after {
        content: "" !important;
        text-indent: 0;
        font-size:13px;
        display: block !important;
    }
    [class^="mashicon-"], [class*=" mashicon-"] {
        width:25%;
        text-align: center !important;
    }
    [class^="mashicon-"] .icon:before, [class*=" mashicon-"] .icon:before {
        float:none;
        margin-right: 0;
    }
    .mashsb-buttons a{
       margin-right: 3px;
       margin-bottom:3px;
       min-width: 0;
       width: 41px;
    }
    .onoffswitch, 
    .onoffswitch-inner:before, 
    .onoffswitch-inner:after 
    .onoffswitch2,
    .onoffswitch2-inner:before, 
    .onoffswitch2-inner:after  {
        margin-right: 0px;
        width: 41px;
        line-height: 41px;
    }#mashbar-header .mashsb-count { 
    display:none; 
}
</style>
<link rel='stylesheet' id='sucuriblog-google-fonts-css'  href='//fonts.googleapis.com/css?family=Open+Sans:300,400,400italic,700,600' type='text/css' media='all' />
<link rel='stylesheet' id='cookie-banner-css-css'  href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/css/cookie-banner.css?ver=20200427' type='text/css' media='all' />
<script type='text/javascript' id='monsterinsights-frontend-script-js-extra'>
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[]","home_url":"https:\/\/blog.sucuri.net","hash_tracking":"false"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/google-analytics-premium/assets/js/frontend.min.js?ver=7.10.0' id='monsterinsights-frontend-script-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.js?ver=4.0.1' id='select2-js'></script>
<script type='text/javascript' id='mashsb-js-extra'>
/* <![CDATA[ */
var mashsb = {"shares":"432","round_shares":"1","animate_shares":"1","dynamic_buttons":"0","share_url":"https:\/\/blog.sucuri.net\/2017\/09\/hacked-websites-mine-crypocurrencies.html","title":"Hacked+Websites+Mine+Cryptocurrencies","image":"https:\/\/blog.sucuri.net\/wp-content\/uploads\/2017\/09\/09222017-EN-hacked-websites-mine-crypocurrencies_blog.jpg","desc":"Cryptocurrencies are all the rage now. Bitcoin, altcoins, blockchain, ICO, mining farms, skyrocketing exchange rates - you see or hear this every day in the news now. Everyone seems to be trying to jump on \u2026","hashtag":"@sucurisecurity","subscribe":"link","subscribe_url":"http:\/\/sucuri.hs-sites.com\/subscribe-to-security","activestatus":"1","singular":"1","twitter_popup":"1","refresh":"0","nonce":"c1b7e23fe8","postid":"20099","servertime":"1659523742","ajaxurl":"https:\/\/blog.sucuri.net\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/js/mashsb.min.js?ver=3.8.1' id='mashsb-js'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/html5shiv.min.js?ver=3.7.3' id='html5shiv-js'></script>
<![endif]-->
<link rel="https://api.w.org/" href="https://blog.sucuri.net/wp-json/" /><link rel="alternate" type="application/json" href="https://blog.sucuri.net/wp-json/wp/v2/posts/20099" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.sucuri.net/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.sucuri.net/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://blog.sucuri.net/?p=20099' />


<!-- This site is optimized with the Schema plugin v1.7.9.4 - https://schema.press -->
<script type="application/ld+json">{"@context":"https:\/\/schema.org\/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.sucuri.net\/2017\/09\/hacked-websites-mine-crypocurrencies.html"},"url":"https:\/\/blog.sucuri.net\/2017\/09\/hacked-websites-mine-crypocurrencies.html","headline":"Hacked Websites Mine Cryptocurrencies","datePublished":"2017-09-22T09:56:31-07:00","dateModified":"2018-05-21T13:58:52-07:00","publisher":{"@type":"Organization","@id":"https:\/\/blog.sucuri.net\/#organization","name":"Sucuri Blog","logo":{"@type":"ImageObject","url":"","width":600,"height":60}},"image":{"@type":"ImageObject","url":"https:\/\/blog.sucuri.net\/wp-content\/uploads\/2017\/09\/09222017-EN-hacked-websites-mine-crypocurrencies_blog.jpg","width":745,"height":350},"articleSection":"Security Advisory","keywords":"Black Hat Tactics, Cryptominers, Hacked Websites, Obfuscation","description":"Cryptocurrencies are all the rage now. Bitcoin, altcoins, blockchain, ICO, mining farms, skyrocketing exchange rates - you see or hear this every day in the news now. Everyone seems to be trying to jump on this bandwagon. This trend resulted in the emergence of online platforms that allow webmasters","author":{"@type":"Person","name":"Denis Sinegubko","url":"https:\/\/blog.sucuri.net\/author\/denis","description":"Denis Sinegubko is Sucuri’s Senior Malware Researcher who joined the company in 2013. Denis' main responsibilities include researching emerging threats and creating  signatures for SiteCheck. The founder of UnmaskParasites, his professional experience covers over 20 years of programming and information security. When Denis isn’t analyzing malware, you might not find him not online at all. Connect with him on Twitter.","image":{"@type":"ImageObject","url":"https:\/\/secure.gravatar.com\/avatar\/c9ef50b85bd345ea4e0d8da558816f3d?s=96&d=mm&r=g","height":96,"width":96}}}</script>

<link rel="alternate" href="https://blog.sucuri.net/2017/09/hacked-websites-mine-crypocurrencies.html" hreflang="en" /><link rel="alternate" href="https://blog.sucuri.net/espanol/2017/09/sitios-web-hackeados-minan-criptomonedas.html" hreflang="es" /><link rel="alternate" href="https://blog.sucuri.net/portugues/2017/09/sites-hackeados-minam-criptomoedas.html" hreflang="pt" /><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-4077922-18', 'auto');
  ga('require', 'linker');
  ga('linker:autoLink', ['ddecode.com', 'unmaskparasites.com', 'urlfind.org']);
  ga('send', 'pageview');
</script>

<script type="text/javascript">
(function(a,b,c,d,e,f,g){e['ire_o']=c;e[c]=e[c]||function(){(e[c].a=e[c].a||[]).push(arguments)};f=d.createElement(b);g=d.getElementsByTagName(b)[0];f.async=1;f.src=a;g.parentNode.insertBefore(f,g);})('//d.impactradius-event.com/A166802-5dda-4f98-aad8-1f58dbc8f1771.js','script','ire',document,window);
</script>
<script type='text/javascript'>/*<![CDATA[*/(function(n,d,c){d.setTime(d.getTime()+2592000000);c=(new RegExp('[?&]'+n+'=([^&#]*)','i')).exec(window.location.search);if(c=c?c[1]:null)document.cookie=n+'='+c+';expires='+d.toUTCString()+';domain=.sucuri.net;path=/';})('cjevent',new Date());/*]]>*/</script><!-- Tealium Universal Tag --><script type="text/javascript">(function(a,b,c,d){a='//tags.tiqcdn.com/utag/gpl/sucuri/prod/utag.js';b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a)})();</script><link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#menu-item-17506{ background-color: #619f42;}
#menu-item-17506:hover {background-color:#478237}
#menu-item-17506 > a { color:#fff;}
.nav-primary {
 width: 80%;
}

.genesis-nav-menu {
 display:table;
}

.genesis-nav-menu .menu-item {
 float:none;
 display:table-cell;
 text-align:center;
 vertical-align:top;
}

.text-right {
 text-align:right !important;
}

.genesis-nav-menu .languages-sub-menu a {
 margin-right:0;
}

/* Blog Background Green Color Replace*/
#menu-item-17506 { background-color: #008673!important; }
.home.archive-post-grid .archive-featured-post:first-of-type { border-top: 8px solid #008673!important; }
.button { background-color: #008673!important; }
#sidebar-cta .widget { background-color: #008673!important; }
.fwp-load-more:focus, .fwp-load-more:hover, .load-more:focus, .load-more:hover {
    background-color: #008673!important;
}
.social-icons a::before {
    background-color: #008673!important;
}
.footer-widgets .social-icons a:focus::before, .footer-widgets .social-icons a:hover::before, .footer-widgets .button:focus, .footer-widgets .button:hover {
    background-color: #008673!important;
}	
.button { background-color: #008673!important; }

.footer-widgets .button:hover { background-color: #26BA9E!important; }		</style>
		</head>
<body class="post-template-default single single-post postid-20099 single-format-standard header-full-width content-sidebar"><div class="site-container"><ul class="genesis-skip-link"><li><a href="#genesis-nav-primary" class="screen-reader-shortcut"> Skip to primary navigation</a></li><li><a href="#genesis-content" class="screen-reader-shortcut"> Skip to content</a></li><li><a href="#genesis-sidebar-primary" class="screen-reader-shortcut"> Skip to primary sidebar</a></li><li><a href="#genesis-footer-widgets" class="screen-reader-shortcut"> Skip to footer</a></li></ul><header class="site-header" itemscope itemtype="https://schema.org/WPHeader"><div class="wrap"><div class="title-area"><p class="site-title" itemprop="headline"><a href="https://blog.sucuri.net/">Sucuri Blog</a></p><p class="site-description screen-reader-text" itemprop="description">Website Security News</p></div><nav class="nav-primary" aria-label="Main" itemscope itemtype="https://schema.org/SiteNavigationElement" id="genesis-nav-primary"><ul id="menu-header-navigation-ii" class="menu genesis-nav-menu menu-primary js-superfish"><li id="menu-item-17495" class="menu-item-products menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17495"><a href="https://sucuri.net/website-antivirus/signup" itemprop="url"><span itemprop="name">Products</span></a>
<ul class="sub-menu">
	<li id="menu-item-17496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17496"><a href="https://sucuri.net/website-security-platform/signup/" itemprop="url"><span itemprop="name">Website Security Platform</span></a></li>
	<li id="menu-item-17497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17497"><a href="https://sucuri.net/website-firewall/" itemprop="url"><span itemprop="name">Website Firewall (WAF)</span></a></li>
	<li id="menu-item-20814" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20814"><a href="https://sucuri.net/custom/enterprise/" itemprop="url"><span itemprop="name">Enterprise Website Security</span></a></li>
	<li id="menu-item-20815" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20815"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Multisite Solutions</span></a></li>
</ul>
</li>
<li id="menu-item-17498" class="menu-item-industry menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17498"><a href="https://sucuri.net/website-security-platform/" itemprop="url"><span itemprop="name">Features</span></a>
<ul class="sub-menu">
	<li id="menu-item-17499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17499"><a href="https://sucuri.net/malware-detection-scanning/" itemprop="url"><span itemprop="name">Detection</span></a></li>
	<li id="menu-item-17500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17500"><a href="https://sucuri.net/website-hack-protection/" itemprop="url"><span itemprop="name">Protection</span></a></li>
	<li id="menu-item-17501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17501"><a href="https://sucuri.net/website-performance/" itemprop="url"><span itemprop="name">Performance</span></a></li>
	<li id="menu-item-19564" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19564"><a href="https://sucuri.net/website-malware-removal/" itemprop="url"><span itemprop="name">Response</span></a></li>
	<li id="menu-item-19911" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19911"><a href="https://sucuri.net/website-backups/" itemprop="url"><span itemprop="name">Backups</span></a></li>
</ul>
</li>
<li id="menu-item-19912" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-19912"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a>
<ul class="sub-menu">
	<li id="menu-item-19913" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19913"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Agency Solutions</span></a></li>
	<li id="menu-item-19915" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19915"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a></li>
	<li id="menu-item-20816" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20816"><a href="https://sucuri.net/referral/" itemprop="url"><span itemprop="name">Referral Program</span></a></li>
	<li id="menu-item-19914" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19914"><a href="https://sucuri.net/ecommerce-website-security/" itemprop="url"><span itemprop="name">Ecommerce</span></a></li>
</ul>
</li>
<li id="menu-item-20817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-20817"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Resources</span></a>
<ul class="sub-menu">
	<li id="menu-item-20818" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20818"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Guides</span></a></li>
	<li id="menu-item-20819" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20819"><a href="https://sucuri.net/webinars/" itemprop="url"><span itemprop="name">Webinars</span></a></li>
	<li id="menu-item-20820" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20820"><a href="https://sucuri.net/infographics/" itemprop="url"><span itemprop="name">Infographics</span></a></li>
	<li id="menu-item-20821" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20821"><a href="https://sitecheck.sucuri.net/" itemprop="url"><span itemprop="name">SiteCheck</span></a></li>
	<li id="menu-item-20822" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20822"><a href="https://sucuri.net/reports/" itemprop="url"><span itemprop="name">Reports</span></a></li>
	<li id="menu-item-22570" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22570"><a href="https://sucuri.net/email-courses/" itemprop="url"><span itemprop="name">Email Courses</span></a></li>
</ul>
</li>
<li id="menu-item-17506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17506"><a href="https://sucuri.net/website-security-platform/help-now" itemprop="url"><span itemprop="name">Immediate Help</span></a></li>
<li id="menu-item-17509" class="menu-item-login menu-item menu-item-type-custom menu-item-object-custom menu-item-17509"><a href="https://dashboard.sucuri.net/login/" itemprop="url"><span itemprop="name">Login</span></a></li>
</ul></nav><button id="responsive-menu" role="button" aria-controls="genesis-nav-primary" aria-pressed="false"><span class="screen-reader-text">Menu</span></button></div></header><div class="site-inner"><div class="wrap"><div class="content-sidebar-wrap"><main class="content" id="genesis-content"><article class="post-20099 post type-post status-publish format-standard has-post-thumbnail category-security-advisory category-website-security tag-black-hat-tactics tag-cryptominers tag-hacked-websites tag-obfuscation entry"><header class="entry-header"><div class="single-featured"><img width="745" height="350" src="https://blog.sucuri.net/wp-content/uploads/2017/09/09222017-EN-hacked-websites-mine-crypocurrencies_blog.jpg" class="single-featured-image wp-post-image" alt="hacked website mine cryptocurrencies blog header" loading="lazy" srcset="https://blog.sucuri.net/wp-content/uploads/2017/09/09222017-EN-hacked-websites-mine-crypocurrencies_blog.jpg 745w, https://blog.sucuri.net/wp-content/uploads/2017/09/09222017-EN-hacked-websites-mine-crypocurrencies_blog-600x282.jpg 600w, https://blog.sucuri.net/wp-content/uploads/2017/09/09222017-EN-hacked-websites-mine-crypocurrencies_blog-650x305.jpg 650w, https://blog.sucuri.net/wp-content/uploads/2017/09/09222017-EN-hacked-websites-mine-crypocurrencies_blog-585x275.jpg 585w, https://blog.sucuri.net/wp-content/uploads/2017/09/09222017-EN-hacked-websites-mine-crypocurrencies_blog-560x263.jpg 560w" sizes="(max-width: 745px) 100vw, 745px" /></div><h1 class="entry-title">Hacked Websites Mine Cryptocurrencies</h1>
<p class="entry-meta"><time class="entry-time" datetime="2017-09-22T09:56:31-07:00">September 22, 2017</time><span class="entry-author"><a href="https://blog.sucuri.net/author/denis" class="entry-author-link" rel="author"><span class="entry-author-name">Denis Sinegubko</span></a></span><span class="post-language-options"><a class="spanish-post-link" href="https://blog.sucuri.net/espanol/2017/09/sitios-web-hackeados-minan-criptomonedas.html">Espanol</a><a class="portuguese-post-link" href="https://blog.sucuri.net/portugues/2017/09/sites-hackeados-minam-criptomoedas.html">Portugues</a></span></p></header><div class="entry-content"><aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2017%2F09%2Fhacked-websites-mine-crypocurrencies.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=Hacked%20Websites%20Mine%20Cryptocurrencies&url=https://blog.sucuri.net/2017/09/hacked-websites-mine-crypocurrencies.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--><p>Cryptocurrencies are all the rage now. Bitcoin, altcoins, blockchain, ICO, mining farms, skyrocketing exchange rates &#8211; you see or hear this every day in the news now. Everyone seems to be trying to jump on this bandwagon.</p>
<p>This trend resulted in the emergence of online platforms that allow webmasters to install <strong>coin miners</strong> into their websites as an alternative means of monetization. The most notable platforms that provide JavaScript cryptocurrency miners for websites are <a href="https://jsecoin.com/" target="_blank" rel="noopener">JSE Coin</a> and Coinhive.</p>
<h2>Controversy Around JavaScript Miners</h2>
<p>Both of these platforms allow webmasters to register and obtain a snippet of JavaScript code that they can install on their sites. This code will work in the background of visitors&#8217; browsers, mining coins by utilizing <i>excess CPU power</i> of their computer.</p>
<p>In this blog post we will not discuss whether it’s a good alternative for banner ads, nor whether your computer has “excess CPU power” that allows websites you visit to drain &#8211; this is what happens when you visit a site with CoinHive JavaScript Miner.</p>
<figure id="attachment_20103" aria-describedby="caption-attachment-20103" style="width: 182px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/09/cpu-load-jsecoin-coinhive.png"><img loading="lazy" class="size-full wp-image-20103" src="https://blog.sucuri.net/wp-content/uploads/2017/09/cpu-load-jsecoin-coinhive.png" alt="CoinHive malware causes CPU load spike" width="182" height="91" /></a><figcaption id="caption-attachment-20103" class="wp-caption-text">Visitor&#8217;s computer CPU load</figcaption></figure>
<p>For example, many <a href="https://www.grahamcluley.com/pirate-bay-cryptocurrency-miner/" target="_blank" rel="noopener">visitors of PirateBay immediately noticed</a> that it began testing such an online miner. It’s a no-brainer that ad blockers will soon begin blocking JavaScript miners too.</p>
<p>Like with any other type of website monetization, this one is prone to abuse, especially in its early stages. It didn’t take long for us to encounter the <b>CoinHive miner installed on hacked sites.</b> It’s a natural move for bad actors who similarly abuse other legitimate means of website monetization, for example, installing their own ad or <a href="https://blog.sucuri.net/2017/09/amazon-affiliate-cookie-stuffing-in-iframes.html" target="_blank" rel="noopener">affiliate codes</a> to third-party sites.</p>
<h2>Malicious Injection with CoinHive Miner</h2>
<p>In this case, a webmaster contacted us and said that some of their site visitors noticed high processor load while visiting the site. Some of them even identified the CoinHive cryptominer there. Indeed, the HTML code of web pages contained this code in the footer section:</p>
<figure id="attachment_20100" aria-describedby="caption-attachment-20100" style="width: 513px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/09/coinhive-injected-malware-script.png"><img loading="lazy" class="size-full wp-image-20100" src="https://blog.sucuri.net/wp-content/uploads/2017/09/coinhive-injected-malware-script.png" alt="fblaster hidden website malware" width="513" height="49" /></a><figcaption id="caption-attachment-20100" class="wp-caption-text">Injected code</figcaption></figure>
<p>That <b>security.fblaster[.]com</b> script loaded the CoinHive Miner script</p>
<p><figure id="attachment_20102" aria-describedby="caption-attachment-20102" style="width: 650px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/09/coinhive-miner-script-malware.png"><img loading="lazy" class="size-large wp-image-20102" src="https://blog.sucuri.net/wp-content/uploads/2017/09/coinhive-miner-script-malware-650x107.png" alt="code snippet of fblaster coinhive miner" width="650" height="107" srcset="https://blog.sucuri.net/wp-content/uploads/2017/09/coinhive-miner-script-malware-650x107.png 650w, https://blog.sucuri.net/wp-content/uploads/2017/09/coinhive-miner-script-malware-600x99.png 600w, https://blog.sucuri.net/wp-content/uploads/2017/09/coinhive-miner-script-malware-560x92.png 560w, https://blog.sucuri.net/wp-content/uploads/2017/09/coinhive-miner-script-malware.png 710w" sizes="(max-width: 650px) 100vw, 650px" /></a><figcaption id="caption-attachment-20102" class="wp-caption-text">CoinHive miner on security.fblaster[.]com</figcaption></figure>It’s not the <a href="https://coin-hive.com/documentation/miner" target="_blank" rel="noopener">official way to use the CoinHive Miner </a> (which is supposed to be loaded from <b>lib/coinhive.min.js</b> on their own site) but if you check the first long line of the “security.fblaster[.]com” script you’ll see that it’s identical to the CoinHive’s own <b>coinhive.min.js</b>. The rest of the lines are the part that initializes the miner using the site’s unique key and starts it on page load.</p>
<h2>Security.fblaster[.]com Malware</h2>
<p>We searched for <b>security.fblaster[.]com</b> and found very similar injections on a few other sites.</p>
<ul>
<li>hxxp://security.fblaster[.]com/sidebar.js?id=1</li>
<li>hxxp://security.fblaster[.]com/slider.js?id=1</li>
<li>hxxp://security.fblaster[.]com/widgets.js?id=1</li>
</ul>
<p>The names of the scripts are made to appear legitimate so that the webmaster doesn&#8217;t get alarmed when seeing them. Moreover, a couple of sites we investigated <strong>referenced the domain names</strong> <strong>of the infected sites</strong> within the malicious script &#8211; making them look even more as if they belong on the sites.</p>
<p>Those scripts have been already removed from most of the infected sites, but one site still had that live script and it loaded the same crypto-miner with another site key: <strong>XMzUIs3Jx7qkRuPPfxG4I5k4AdXfQV6D</strong>.</p>
<h2>Cryptominer Re-uses Old Infection</h2>
<p>We checked the infected sites on the <a href="https://web.archive.org" target="_blank" rel="noopener">Wayback Machine</a> and tracked down that injection to the end of <b>2016</b>. We also noticed that the IP address of the “<b>security.fblaster[.]com</b>” server (<b>178.62.224.14</b> &#8211; Digitalocean Amsterdam) was mentioned in a <a href="https://twitter.com/pancak3lullz/status/734452003208896513" target="_blank" rel="noopener">tweet</a> about an attacks that tried to <a href="https://blog.sucuri.net/2014/12/revslider-vulnerability-leads-to-massive-wordpress-soaksoak-compromise.html" target="_blank" rel="noopener">exploit RevSlider vulnerability</a>:</p>
<blockquote><p>#RevSlider #soaksoak #malware attempts from 178.62.224.14 (NL) ../wp-config.php</p></blockquote>
<p>That was strange considering CoinHive didn’t even exist back then. According to WHOIS, <b>coin-hive.com</b> (the domain that is hard-coded inside the JavaScript miner) was registered just a month ago on August 24th, 2017.</p>
<p>Moreover, on the site whose webmaster contacted us, the script was only injected on September 19th, 2017 (which was confirmed by Google cache). We also noticed that the script had a long number in the <b>?id=</b> parameter that changed on every page load, while in scripts on other sites it was always <b>?id=1</b>.</p>
<p>It appears as if this is not a new infection, but since the attackers already control the “<b>security.fblaster[.]com</b>” server, they can easily modify the malicious script without having to change anything on sites that they had infected previously.</p>
<p>Once the hackers learned about CoinHive, they registered for the service (it only asks for a valid email address) and ported their JavaScript Miner to work off of their own domain &#8211; effectively re-using the scripts they already injected to compromised sites.</p>
<p>Since the cryptocurrency miner only produces meaningful results on sites with lots of visitors (or on a large number of less popular sites), they began to inject the miner to new sites <strong>just a few days ago</strong>. At this point the<strong> security.fblaster[.]com</strong> infection is not massive (although there are other similar attacks as you&#8217;ll read below) as we don’t see it on many other sites so probably the attackers are still testing this approach.</p>
<h2>Infected Files on WordPress</h2>
<p>Now let&#8217;s see how this infection works on the server. A quick scan revealed modified core WordPress files.</p>
<p>The first modification was discovered at the top of the <b>wp-admin/admin-header.php</b></p>
<pre>&lt;?php
/**
* WordPress Administration Template Header
*
* @package WordPress
* @subpackage Administration
*/
<b>if(!isset($_COOKIE["wpt"])){setcookie("wpt","4376",time()+3153600000,"/");}</b>
...</pre>
<p>This line of code sets the <b>wpt</b> cookie for <b>100</b> <strong>years</strong> (!) for WordPress users who log into the Admin interface.</p>
<p>The next file is <b>wp-includes/general-template.php</b> with a modified <b>wp_footer()</b> function.</p>
<pre>...
function wp_footer() {
    /**
    * Prints scripts or data before the closing body tag on the front end.
    *
    * @since 1.5.1
    */
    do_action( 'wp_footer' );
       <b>require_once('options-footer.php');</b>
}
...</pre>
<p>This function is responsible for generating the footer section of web pages. Hackers added functionality by calling code from <b>wp-includes/options-footer.php</b>  &#8211; which, by the way, is <b>not</b><strong> a legitimate part of WordPress</strong>.</p>
<p>Let’s take a look inside the malicious <b>options-footer.php</b> file.</p>
<figure id="attachment_20101" aria-describedby="caption-attachment-20101" style="width: 566px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/09/coinhive-miner-options-footer.png"><img loading="lazy" class="size-full wp-image-20101" src="https://blog.sucuri.net/wp-content/uploads/2017/09/coinhive-miner-options-footer.png" alt="WordPress fblaster injectioj" width="566" height="101" srcset="https://blog.sucuri.net/wp-content/uploads/2017/09/coinhive-miner-options-footer.png 566w, https://blog.sucuri.net/wp-content/uploads/2017/09/coinhive-miner-options-footer-560x100.png 560w" sizes="(max-width: 566px) 100vw, 566px" /></a><figcaption id="caption-attachment-20101" class="wp-caption-text">Source code of options-footer.php</figcaption></figure>
<p>As you can see, this file injects the <b>security.fblaster[.]com</b> script (CoinHive Miner), into the footer of web pages, effectively abusing all visitors who are not known as the site users (don’t have the <b>wpt</b> cookie).</p>
<p>This code also provides us with the answer why we saw a long number in the <b>?id=</b> parameter of the injected script, and why it changed on every page load. It turns out it’s just a timestamp generated by the <b>time()</b> function.</p>
<h2>Injected CoinHive Miner on Magento</h2>
<p>By the time we finished cleaning this site, my colleague <a href="https://twitter.com/dogasantos" target="_blank" rel="noopener">Douglas Santos</a>, who worked on a different site, found another type of injected cryptominer script. It was the same CoinHive JavaScript miner but the code was injected into database of the Magento site (<b>design/head/includes</b> in the <b>core_config_data</b> table).</p>
<p>The injected remote script was different:</p>
<figure id="attachment_20104" aria-describedby="caption-attachment-20104" style="width: 591px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/09/magento-coinhive-miner-malware.png"><img loading="lazy" class="wp-image-20104 size-full" src="https://blog.sucuri.net/wp-content/uploads/2017/09/magento-coinhive-miner-malware.png" alt="magento alemoney code injection" width="591" height="65" srcset="https://blog.sucuri.net/wp-content/uploads/2017/09/magento-coinhive-miner-malware.png 591w, https://blog.sucuri.net/wp-content/uploads/2017/09/magento-coinhive-miner-malware-585x65.png 585w, https://blog.sucuri.net/wp-content/uploads/2017/09/magento-coinhive-miner-malware-560x62.png 560w" sizes="(max-width: 591px) 100vw, 591px" /></a><figcaption id="caption-attachment-20104" class="wp-caption-text">CoinHive miner in Magento Database</figcaption></figure>
<p>The source of the script &#8211; <b>hxxps://camillesanz[.]com/lib/status.js</b> &#8211; is also a version of the CoinHive’s own <b>coinhive.min.js</b> &#8211; but this time it’s encrypted and looks like this:</p>
<figure id="attachment_20105" aria-describedby="caption-attachment-20105" style="width: 600px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2017/09/status-js-coinhive-miner-malware.png"><img loading="lazy" class="size-full wp-image-20105" src="https://blog.sucuri.net/wp-content/uploads/2017/09/status-js-coinhive-miner-malware.png" alt="encrypted magento injection code snippet" width="600" height="205" srcset="https://blog.sucuri.net/wp-content/uploads/2017/09/status-js-coinhive-miner-malware.png 600w, https://blog.sucuri.net/wp-content/uploads/2017/09/status-js-coinhive-miner-malware-560x191.png 560w" sizes="(max-width: 600px) 100vw, 600px" /></a><figcaption id="caption-attachment-20105" class="wp-caption-text">Encrypted CoinHive miner inside status.js</figcaption></figure>
<p>In this case, the attacker decided to host the script on a hacked third-party site and went an extra mile to<strong> encrypt the script</strong> which suggests far more serious intentions for this attack than in the case of <b>security.fblaster[.]com</b>.</p>
<p>The database injection, in this case, coexists along with an older massive Magento infection that injected redirect scripts like:</p>
<ul>
<li>hxxps://africangrey[.]top/redirect_base/redirect.js</li>
<li>hxxp://alemoney[.]xyz/js/stat.js</li>
<li>hxxp://africangirl[.]top/redirect_base/redirect.js</li>
<li>hxxp://ribinski[.]us/redirect_base/redirect.js</li>
<li>hxxps://aleinvest[.]xyz/js/theme.js.</li>
</ul>
<h2>It Escalated Quickly</h2>
<p>The next morning we received this email:</p>
<blockquote><p><i>Themes, Plugins are exploiting to mine monero coin and sucking lot of CPU.</i></p>
<p><i>Manually Cleaned 20+ Sites today.</i></p>
<p><i>Please help us.</i></p></blockquote>
<p>We are still waiting for details on this case so stay tuned for the updates.</p>
<h2>Conclusion</h2>
<p>One thing is clear &#8211; the release of JavaScript coin miners for websites was not unnoticed by the bad guys. They immediately began looking for ways to abuse it, and <strong>we expect to see mass infections</strong> switching their attention to crypto-miners instead of traditional types of malicious payloads, and not just on WordPress and Magento.</p>
<p>While the cryptocurrency miners for websites is a very new thing, there is nothing new in approaches that hackers use to abuse it. If something can be installed on a web site and monetized, hackers will do it on websites they compromise. Thus one of the best security practices for webmasters is to <a href="http://sucuri.net/website-security-platform/malware-scanning-and-detection" target="_blank" rel="noopener">monitor integrity of their sites</a>.</p>
<p>For WordPress infections like this, you can use our step-by-step guide on how to identify hack and <a href="https://sucuri.net/guides/how-to-clean-hacked-wordpress" target="_blank" rel="noopener">clean a compromised WordPress site</a>.  We also have a similar <a href="https://sucuri.net/guides/how-to-clean-hacked-magento" target="_blank" rel="noopener">guide that will help owners of Magento sites</a>.</p>
<p>If you need immediate help with this type of infection, we offer affordable <a href="https://sucuri.net/website-security-platform/" target="_blank" rel="noopener">website security plans</a>.</p>
<aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2017%2F09%2Fhacked-websites-mine-crypocurrencies.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=Hacked%20Websites%20Mine%20Cryptocurrencies&url=https://blog.sucuri.net/2017/09/hacked-websites-mine-crypocurrencies.html&via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.1--></div><footer class="entry-footer"><p class="entry-meta"><span class="entry-categories">Categories: <a href="https://blog.sucuri.net/category/security-advisory" rel="category tag">Security Advisory</a>, <a href="https://blog.sucuri.net/category/website-security" rel="category tag">Website Security</a></span><span class="entry-tags">Tags: <a href="https://blog.sucuri.net/tag/black-hat-tactics" rel="tag">Black Hat Tactics</a>, <a href="https://blog.sucuri.net/tag/cryptominers" rel="tag">Cryptominers</a>, <a href="https://blog.sucuri.net/tag/hacked-websites" rel="tag">Hacked Websites</a>, <a href="https://blog.sucuri.net/tag/obfuscation" rel="tag">Obfuscation</a></span></p></footer></article><section class="author-box"><img alt='' src='https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=115&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=230&#038;d=mm&#038;r=g 2x' class='avatar avatar-115 photo' height='115' width='115' loading='lazy'/><h4 class="author-box-title">About <span itemprop="name">Denis Sinegubko</span></h4><div class="author-box-content" itemprop="description"><p>Denis Sinegubko is Sucuri’s Senior Malware Researcher who joined the company in 2013. Denis' main responsibilities include researching emerging threats and creating  signatures for SiteCheck. The founder of UnmaskParasites, his professional experience covers over 20 years of programming and information security. When Denis isn’t analyzing malware, you might not find him not online at all. Connect with him on <a href="https://twitter.com/unmaskparasites">Twitter</a>.</p>
</div></section><h2 class="screen-reader-text">Reader Interactions</h2><div class="entry-comments" id="comments"><h3>Comments</h3><ol class="comment-list">
	<li class="comment even thread-even depth-1" id="comment-8083">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/2a5df5941313e64aaf8e0233ad3d10ee?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2a5df5941313e64aaf8e0233ad3d10ee?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name"><a href="http://bangladeshresult.com/" class="comment-author-link" rel="external nofollow" itemprop="url">Toufiq Hassan Shawon</a></span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2017-09-22T11:36:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2017/09/hacked-websites-mine-crypocurrencies.html#comment-8083">September 22, 2017</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Thats&#8217;s Great, I am happy that you identified the exploit the exact file, that they are using, Protecting with 400 permission will do the job for now. But I think Some Plugin Author using to earn some revenue from it by injecting them in their plugin update. I have found some of those, though I don&#8217;t wanna disclose them publicly. WordPress Should bring some #Hotfix again to prevent this Core File #Expolit. Its messy when you have to replace the core file again and again.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-8085">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/a4e50ffd0b053761d1faa2f3a7181a33?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a4e50ffd0b053761d1faa2f3a7181a33?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Ben Cecioni</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2017-09-23T01:06:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2017/09/hacked-websites-mine-crypocurrencies.html#comment-8085">September 23, 2017</a></time></p>		</header>

		<div class="comment-content">
			
			<p>I wish there could be a good way to use this technology: it has the potential to give websites some revenue without float everything with ads and popups. Imagine an internet experience without ads? ..that would be something!</p>
<p>I think that users should be able to choose if they want to have ads all over the place or, instead, give some CPU usage while they are enjoying a website&#8217;s content.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment even depth-2" id="comment-8086">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/a34d1a852a2acab3949a4f675676b320?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a34d1a852a2acab3949a4f675676b320?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Igor Jerosimić</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2017-09-23T02:31:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2017/09/hacked-websites-mine-crypocurrencies.html#comment-8086">September 23, 2017</a></time></p>		</header>

		<div class="comment-content">
			
			<p>That is more expensive for users, just imagine what it would be like for mobile, tablet, and laptop users whose devices use batteries for power. Even desktop users would see more heat, noise, and higher electric bills.</p>
		</div>

		
		
	</article>
	<ul class="children">

	<li class="comment odd alt depth-3" id="comment-8087">
	<article >

		
		<header class="comment-header">
			<p class="comment-author">
				<img alt='' src='https://secure.gravatar.com/avatar/a4e50ffd0b053761d1faa2f3a7181a33?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a4e50ffd0b053761d1faa2f3a7181a33?s=96&#038;d=mm&#038;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' loading='lazy'/><span itemprop="name">Ben Cecioni</span> 			</p>

			<p class="comment-meta"><time class="comment-time" datetime="2017-09-23T03:28:00-07:00" itemprop="datePublished"><a href="https://blog.sucuri.net/2017/09/hacked-websites-mine-crypocurrencies.html#comment-8087">September 23, 2017</a></time></p>		</header>

		<div class="comment-content">
			
			<p>Javascript miners don&#8217;t have to run at 100%; it&#8217;s up to the dev to set it. Anyway, the options could be left in the hands of the end users, maybe even at a browser level (or with browser plugins like ad-blocker): block ads and let some resource on js miners or vice-versa.</p>
<p>Content creators websites need some income, one way or the other. The lack of it will cause the continuous decline in quantity and quality of their content. Users should be able to choose what is less intrusive for them.</p>
		</div>

		
		
	</article>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol></div></main><aside class="sidebar sidebar-primary widget-area" role="complementary" aria-label="Primary Sidebar" itemscope itemtype="https://schema.org/WPSideBar" id="genesis-sidebar-primary"><h2 class="genesis-sidebar-title screen-reader-text">Primary Sidebar</h2><div class="sidebar-primary-wrap"><section id="text-5" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Socialize With Sucuri</h3>
			<div class="textwidget"><p>We're actively engaged across multiple platforms. Follow us and let's connect!</p>
<ul class="social-icons">
<li><a target="_blank" href="https://www.facebook.com/SucuriSecurity" rel="noopener"><span class="screen-reader-text">Facebook</span></a></li>
<li><a target="_blank" href="https://twitter.com/sucurisecurity" rel="noopener"><span class="screen-reader-text">Twitter</span></a></li>
<li><a target="_blank" href="https://www.linkedin.com/company/sucuri-security" rel="noopener"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a target="_blank" href="https://www.youtube.com/c/sucurinet" rel="noopener"><span class="screen-reader-text">YouTube</span></a></li>
<li><a target="_blank" href="https://www.instagram.com/sucurisecurity/" rel="noopener"><span class="screen-reader-text">Instagram</span></a></li>
<li><a target="_blank" href="https://blog.sucuri.net/feed/" rel="noopener"><span class="screen-reader-text">RSS Feed</span></a></li>
</ul>
</div>
		</div></section>
<section id="search-3" class="widget widget_search"><div class="widget-wrap"><form class="search-form" method="get" action="https://blog.sucuri.net/"><label class="search-form-label screen-reader-text" for="searchform-62ea529eb3f2a">Search the blog</label><input type="search" name="s" id="searchform-62ea529eb3f2a" placeholder="Search the blog" /><input type="submit" value="Search" /></form></div></section>
<section id="text-37" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"></div>
		</div></section>
</div><div class="sidebar-cta-widget" id="sidebar-cta"><section id="text-6" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Join Over 20,000 Subscribers!</h3>
			<div class="textwidget"><p><a href="http://sucuri.hs-sites.com/subscribe-to-security" onClick="ga('send', 'event', 'Blog', 'Button_Click', 'Subscribe_to_Security_Newsletter');"><img src="https://blog.sucuri.net/wp-content/uploads/2017/09/17-EN-sucuri-blog-newsletter-banner.png" /></a></p>
</div>
		</div></section>
</div></aside></div></div></div><footer class="site-footer" itemscope itemtype="https://schema.org/WPFooter"><div class="footer-widgets" id="genesis-footer-widgets"><h2 class="genesis-sidebar-title screen-reader-text">Footer</h2><div class="wrap"><div class="widget-area footer-widgets-1 footer-widget-area"><section id="nav_menu-3" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Products</h3>
<div class="menu-footer-products-menu-container"><ul id="menu-footer-products-menu" class="menu"><li id="menu-item-15501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15501"><a href="https://sucuri.net/website-firewall/" itemprop="url">Website Firewall</a></li>
<li id="menu-item-15502" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15502"><a href="https://sucuri.net/website-antivirus/" itemprop="url">Website AntiVirus</a></li>
<li id="menu-item-15503" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15503"><a href="https://sucuri.net/website-backups/" itemprop="url">Website Backups</a></li>
<li id="menu-item-15504" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15504"><a href="https://sucuri.net/wordpress-security/" itemprop="url">WordPress Security</a></li>
<li id="menu-item-15505" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15505"><a href="https://sucuri.net/custom/enterprise/" itemprop="url">Enterprise Services</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-2 footer-widget-area"><section id="nav_menu-4" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Solutions</h3>
<div class="menu-footer-solutions-menu-container"><ul id="menu-footer-solutions-menu" class="menu"><li id="menu-item-15506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15506"><a href="https://sucuri.net/website-firewall/ddos-protection" itemprop="url">DDos Protection</a></li>
<li id="menu-item-15507" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15507"><a href="https://sucuri.net/website-antivirus/malware-scanning-and-detection" itemprop="url">Malware Detection</a></li>
<li id="menu-item-15508" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15508"><a href="https://sucuri.net/website-antivirus/malware-removal" itemprop="url">Malware Removal</a></li>
<li id="menu-item-15510" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15510"><a href="https://sucuri.net/website-firewall/stop-website-attacks-and-hacks" itemprop="url">Malware Prevention</a></li>
<li id="menu-item-15511" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15511"><a href="https://sucuri.net/website-antivirus/blacklist-removal-and-repair" itemprop="url">Blacklist Removal</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-3 footer-widget-area"><section id="nav_menu-6" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Support</h3>
<div class="menu-footer-support-menu-container"><ul id="menu-footer-support-menu" class="menu"><li id="menu-item-15512" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15512"><a href="https://blog.sucuri.net/" itemprop="url">Blog</a></li>
<li id="menu-item-15513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15513"><a href="https://kb.sucuri.net/" itemprop="url">Knowledge Base</a></li>
<li id="menu-item-15515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15515"><a href="https://sitecheck.sucuri.net/" itemprop="url">SiteCheck</a></li>
<li id="menu-item-15516" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15516"><a href="http://labs.sucuri.net/" itemprop="url">Research Labs</a></li>
<li id="menu-item-15517" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15517"><a href="https://sucuri.net/faq/" itemprop="url">FAQ</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-4 footer-widget-area"><section id="nav_menu-5" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Company</h3>
<div class="menu-footer-company-menu-container"><ul id="menu-footer-company-menu" class="menu"><li id="menu-item-15495" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15495"><a href="https://sucuri.net/company/" itemprop="url">About</a></li>
<li id="menu-item-15496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15496"><a href="https://sucuri.net/company/media" itemprop="url">Media</a></li>
<li id="menu-item-15497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15497"><a href="https://sucuri.net/company/events" itemprop="url">Events</a></li>
<li id="menu-item-15498" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15498"><a href="https://sucuri.net/company/employment/" itemprop="url">Employment</a></li>
<li id="menu-item-15499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15499"><a href="https://sucuri.net/company/contact-us" itemprop="url">Contact</a></li>
<li id="menu-item-15500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15500"><a href="https://sucuri.net/customers/" itemprop="url">Testimonials</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-5 footer-widget-area"><section id="text-4" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><ul class="social-icons">
<li><a href="https://www.facebook.com/SucuriSecurity"><span class="screen-reader-text">Facebook</span></a></li>
<li><a href="https://twitter.com/sucurisecurity"><span class="screen-reader-text">Twitter</span></a></li>
<li><a href="https://www.linkedin.com/company/sucuri-security"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a href="https://www.instagram.com/sucurisecurity/"><span class="screen-reader-text">Instagram</span></a></li>
</ul>
<p><a class="button" href="https://dashboard.sucuri.net/login/">Customer Login</a></p>
<p><a class="footer-logo" href="https://sucuri.net/">Sucuri Home</a></p>
</div>
		</div></section>
</div></div></div><div class="site-footer-widget"><div class="wrap"><section id="text-8" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><div class="site-footer-links">
<ul>
<li><a href="https://sucuri.net/terms">Terms of Use</a></li>
<li><a href="https://sucuri.net/privacy">Privacy Policy</a></li>
<li><a href="https://sucuri.net/faq/">Frequently Asked Questions</a></li>
</ul>
</div>
<div class="site-footer-copyright">
<p>&#x000A9;&nbsp;2022 Sucuri Inc. All rights reserved</p>
</div>
</div>
		</div></section>
</div></div></footer></div><script type="text/javascript">
ire('identify', {customerId: '​​', customerEmail: '​​'}); </script><div id="cookie-policy-banner" class="container-fluid cookie-policy-banner hide p-0">
        <div class="container">
            <button id="cookie-policy-decline-btn" class="cb-close cb-decline-anchor">X</button>
            <div class="row">
                <div class="c-lg-8">
                    <p class="mb-0 mt-0 highlight green heavy">Sucuri Cookie Policy <br> <a href="https://sucuri.net/cookies" target="_blank" class="bolder no-underline">See our policy>></a></p>
                    <p class="mb-0 mt-0">Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.</p>
                </div>
                <div class="c-lg-4 d-flex justify-items-start mt-15 align-items-center">
                    <button id="cookie-policy-btn" class="btn btn-primary ml-0">Accept</button>
                    <button class="btn cb-decline-anchor auto-track" data-gatrack="Cookie_Click, Decline">Decline</button>
                    <button id="manage-privacy-options" class="btn">Manage Options</button>
                </div>
            </div>
        </div>
    </div><script type="text/javascript">
		/* MonsterInsights Scroll Tracking */
			if ( typeof(jQuery) !== 'undefined' ) {
				jQuery( document ).ready(function(){
					function monsterinsights_scroll_tracking_load() {
						if ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) {
							(function(factory) {
								factory(jQuery);
							}(function($) {

								/* Scroll Depth */
								"use strict";
								var defaults = {
									percentage: true
								};

								var $window = $(window),
									cache = [],
									scrollEventBound = false,
									lastPixelDepth = 0;

								/*
								 * Plugin
								 */

								$.scrollDepth = function(options) {

									var startTime = +new Date();

									options = $.extend({}, defaults, options);

									/*
									 * Functions
									 */

									function sendEvent(action, label, scrollDistance, timing) {

										var fieldsArray = {
											hitType       : 'event',
											eventCategory : 'Scroll Depth',
											eventAction   : action,
											eventLabel    : label,
											eventValue    : 1,
											nonInteraction: 1
										};

										if ( 'undefined' === typeof MonsterInsightsObject || 'undefined' === typeof MonsterInsightsObject.sendEvent ) {
											return;
										}

										MonsterInsightsObject.sendEvent( fieldsArray );
										if (arguments.length > 3) {
											fieldsArray = {
												hitType        : 'timing',
												timingCategory : 'Scroll Depth',
												timingVar      : action,
												timingValue    : timing,
												timingLabel    : label,
												nonInteraction: 1
											};
											MonsterInsightsObject.sendEvent( fieldsArray );
										}
									}

									function calculateMarks(docHeight) {
										return {
											'25%' : parseInt(docHeight * 0.25, 10),
											'50%' : parseInt(docHeight * 0.50, 10),
											'75%' : parseInt(docHeight * 0.75, 10),
											/* Cushion to trigger 100% event in iOS */
											'100%': docHeight - 5
										};
									}

									function checkMarks(marks, scrollDistance, timing) {
										/* Check each active mark */
										$.each(marks, function(key, val) {
											if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
												sendEvent('Percentage', key, scrollDistance, timing);
												cache.push(key);
											}
										});
									}

									function rounded(scrollDistance) {
										/* Returns String */
										return (Math.floor(scrollDistance/250) * 250).toString();
									}

									function init() {
										bindScrollDepth();
									}

									/*
									 * Public Methods
									 */

									/* Reset Scroll Depth with the originally initialized options */
									$.scrollDepth.reset = function() {
										cache = [];
										lastPixelDepth = 0;
										$window.off('scroll.scrollDepth');
										bindScrollDepth();
									};

									/* Add DOM elements to be tracked */
									$.scrollDepth.addElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.merge(options.elements, elems);

										/* If scroll event has been unbound from window, rebind */
										if (!scrollEventBound) {
											bindScrollDepth();
										}

									};

									/* Remove DOM elements currently tracked */
									$.scrollDepth.removeElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.each(elems, function(index, elem) {

											var inElementsArray = $.inArray(elem, options.elements);
											var inCacheArray = $.inArray(elem, cache);

											if (inElementsArray != -1) {
												options.elements.splice(inElementsArray, 1);
											}

											if (inCacheArray != -1) {
												cache.splice(inCacheArray, 1);
											}

										});

									};

									/*
									 * Throttle function borrowed from:
									 * Underscore.js 1.5.2
									 * http://underscorejs.org
									 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
									 * Underscore may be freely distributed under the MIT license.
									 */

									function throttle(func, wait) {
										var context, args, result;
										var timeout = null;
										var previous = 0;
										var later = function() {
											previous = new Date;
											timeout = null;
											result = func.apply(context, args);
										};
										return function() {
											var now = new Date;
											if (!previous) previous = now;
											var remaining = wait - (now - previous);
											context = this;
											args = arguments;
											if (remaining <= 0) {
												clearTimeout(timeout);
												timeout = null;
												previous = now;
												result = func.apply(context, args);
											} else if (!timeout) {
												timeout = setTimeout(later, remaining);
											}
											return result;
										};
									}

									/*
									 * Scroll Event
									 */

									function bindScrollDepth() {

										scrollEventBound = true;

										$window.on('scroll.scrollDepth', throttle(function() {
											/*
											 * We calculate document and window height on each scroll event to
											 * account for dynamic DOM changes.
											 */

											var docHeight = $(document).height(),
												winHeight = window.innerHeight ? window.innerHeight : $window.height(),
												scrollDistance = $window.scrollTop() + winHeight,

												/* Recalculate percentage marks */
												marks = calculateMarks(docHeight),

												/* Timing */
												timing = +new Date - startTime;

											checkMarks(marks, scrollDistance, timing);
										}, 500));

									}

									init();
								};

								/* UMD export */
								return $.scrollDepth;

							}));

							jQuery.scrollDepth();
						} else {
							setTimeout(monsterinsights_scroll_tracking_load, 200);
						}
					}
					monsterinsights_scroll_tracking_load();
				});
			}
		/* End MonsterInsights Scroll Tracking */
		
</script><script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/hoverIntent.min.js?ver=1.10.2' id='hoverIntent-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.min.js?ver=1.7.5' id='superfish-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.args.min.js?ver=2.7.1' id='superfish-args-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/skip-links.min.js?ver=2.7.1' id='skip-links-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/theme.js?ver=1.1.0' id='sucuriblog-theme-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky.js?ver=1.0.4' id='sucuriblog-sticky-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky-init.js?ver=1.0.1' id='sucuriblog-sticky-js-init-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/cookie-banner.js?ver=20200914' id='cookie-banner-js-js'></script>
</body></html>
