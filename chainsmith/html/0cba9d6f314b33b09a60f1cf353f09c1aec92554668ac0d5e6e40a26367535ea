<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: Cooperative heuristics</title>
<meta name="description" content="John D. Park attempts to teach an anti-virus scanner to 'think' like a human analyst." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 2628;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/remo_expand/blocks/remo_expand/templates/vbexpand/view.css" />
<script type="text/javascript" src="/packages/remo_expand/js/jquery.color.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/remo.expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<div class="titlepage" xmlns=""><div><div><h1 class="title" xmlns="http://www.w3.org/1999/xhtml"><a id="vb200601-coop-heuristics"></a>Cooperative heuristics</h1></div><div><p class="pubdate" xmlns="http://www.w3.org/1999/xhtml">2006-01-01</p></div><div><div class="authorgroup" xmlns="http://www.w3.org/1999/xhtml"><div class="author titlepage"><h3 class="author"><span class="firstname">John D.</span> <span class="surname">Park</span></h3><span class="orgname">Symantec Security Response</span>, <span class="orgdiv">USA</span></div><b class="editedby">Editor: </b><span class="editor"><span class="firstname">Helen</span> <span class="surname">Martin</span></span></div></div><div><div class="abstract" xmlns="http://www.w3.org/1999/xhtml"><p class="title"><b>Abstract</b></p><p>John D. Park attempts to teach an anti-virus scanner to &#39;think&#39; like a human analyst.</p></div></div><div><p class="copyright" xmlns="http://www.w3.org/1999/xhtml"><i>Copyright &copy; 2006 Virus Bulletin</i></p></div></div><hr /></div>
<div class="ccm-remo-expand">
<div id="ccm-remo-expand-title-4826" class="ccm-remo-expand-title ccm-remo-expand-closed" data-expander-speed="200">Table of contents</div><div id="ccm-remo-expand-content-4826" class="ccm-remo-expand-content"><div class="toc"><dl><dt><span class="sect1"><a href="#id3087857">Introduction</a></span></dt><dt><span class="sect1"><a href="#id4378292">Strategy overview</a></span></dt><dt><span class="sect1"><a href="#id2776838">Scan #1 - weighted mini-signature</a></span></dt><dt><span class="sect1"><a href="#id4395653">Certainty rating</a></span></dt><dt><span class="sect1"><a href="#id4857899">Scan #2 - malware knowledgebase</a></span></dt><dt><span class="sect1"><a href="#id3498109">Scan #3 - abnormal functionality combinations</a></span></dt><dt><span class="sect1"><a href="#id4320105">A new naming scheme</a></span></dt><dt><span class="sect1"><a href="#id3859164"><span class="emphasis"><em>Nutrition facts for software</em></span></a></span></dt><dt><span class="sect1"><a href="#id4125019">Three strikes, you&#39;re out</a></span></dt><dt><span class="sect1"><a href="#id4644878">Performance tests</a></span></dt><dt><span class="sect1"><a href="#id4309401">Afterwords</a></span></dt><dt><span class="bibliography"><a href="#id4113182">Bibliography</a></span></dt></dl></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3087857"></a>Introduction</h2></div></div></div><p>Non-heuristic anti-virus scanning is designed to be strict - it involves searching for matching checksums or specific bit patterns, which results in a very low false positive rate. The downside of strict scanning is that, for every new malware or new variant, a human malware analyst has to provide the scanner with a signature. Even with signatures, the scanner does not know what the malware looks like as a whole, what it does, or why it is malicious. In order to make scanning more flexible and proactive, I will teach an anti-virus scanner to think more like a human analyst.</p><p>Before going any further, here are the assumptions I have made:</p><div class="orderedlist"><ol type="1"><li><p>Today&#39;s main threats are simple Trojan horses and worms, not file-infectors.</p></li><li><p>Malware is becoming more open-sourced, and construction-kit generated. Thus, much of the source code stays the same.</p></li><li><p>Source code can be compiled using different compiler options, and packed with various packers, which will result in different binaries.</p></li></ol></div><p>In addition:</p><div class="itemizedlist"><ul type="disc"><li><p>Non-heuristic anti-virus scanning (checksum, string, p-code) is still necessary to detect file-infectors, and unique or more complex malware.</p></li><li><p>A flawless emulation or memory dump is assumed.</p></li><li><p>I have focused mainly on readable ASCII and Unicode strings. Strings contained in most of the prevalent threats have distinctive statistical characteristics such that readable strings provide enough information to identify them.</p></li></ul></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4378292"></a>Strategy overview</h2></div></div></div><p>I used a number of different loose heuristics, and made them work cooperatively to verify each other, to reduce the false positive rate [<span class="citation"><a href="#citation.1">1</a></span>]. The three scanning methods used are: weighted mini-signature, statistical analysis using knowledgebase, and abnormal functionality detection.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id2776838"></a>Scan #1 - weighted mini-signature</h2></div></div></div><p>One of the most common non-heuristic anti-virus scanning methods is string matching. If we want to detect a malware called &#39;fruit basket&#39;, containing the string &#39;apple, banana, orange in a basket&#39;, we might add a string signature like &#39;ana, orange in a baske&#39;. This means the scanner will detect &#39;apple, banana, orange in a basket&#39;, but it will miss variants like &#39;apple, banana, orange in a yellow basket&#39;, or &#39;banana, orange, apple in a basket&#39;.</p><p>Semantically, a fruit basket is any basket containing any fruit. A more human pattern matching would use multiple short string signatures, or &#39;mini-signatures&#39;. A mini-signature is shorter than a usual signature, and is too short and too generic to be used by itself. However, when used together with other mini-signatures, the risk of false positives is reduced.</p><p>My mini-signatures for &#39;fruit basket&#39; would be &#39;apple&#39;, &#39;banana&#39;, &#39;orange&#39; and &#39;basket&#39;. A comma, a space, and the words &#39;in&#39; and &#39;a&#39; are omitted from the strings since they are not unique to &#39;fruit basket&#39;. We can say that matching three out of four is good enough for detection, but it is not sufficiently flexible. So, a weight is added to each mini-signature:</p><div class="table"><a id="table.1"></a><table border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th align="center">Object</th><th align="center">Weight</th><th align="center">Mini-signature</th></tr></thead><tbody><tr><td align="left">fruitbasket</td><td align="left">0.25</td><td align="left">apple</td></tr><tr><td align="left">fruitbasket</td><td align="left">0.25</td><td align="left">banana</td></tr><tr><td align="left">fruitbasket</td><td align="left">0.25</td><td align="left">orange</td></tr><tr><td align="left">fruitbasket</td><td align="left">0.50</td><td align="left">basket</td></tr></tbody></table><p class="title"><b>Table&nbsp;1.&nbsp;</b></p></div><p>The weighted detections by each mini-signature are added together and if the sum of the detected weights is more than or equal to 1, the detection of &#39;fruit basket&#39; is triggered.</p><p>A mini-signature scanner would detect the following as &#39;fruit basket&#39;:</p><div class="variablelist"><dl><dt></dt><dd><p>apple, banana, orange in a basket = 0.25 + 0.25 + 0.25 + 0.50 = 1.25</p><p>apple, banana, orange in a yellow basket = 0.25 + 0.25 + 0.25 + 0.50 = 1.25</p><p>banana, orange, apple in a basket = 0.25 + 0.25 + 0.25 + 0.50 = 1.25</p><p>basket, basket, basket in a basket = 0.50 + 0.50 + 0.50 + 0.50 = 2.00</p><p>apple, apple, orange, banana, apple = 0.25 + 0.25 + 0.25 + 0.25 + 0.25 = 1.25</p></dd></dl></div><p>And, it would not detect the following:</p><div class="variablelist"><dl><dt></dt><dd><p>apple, apple, apple = 0.25 + 0.25 + 0.25 = 0.75</p><p>orange in a basket = 0.25 + 0.50 = 0.75</p></dd></dl></div><p>As we can see, this method is somewhat loose, and sometimes it is incorrect. But it is more flexible, like human recognition, than strict string matching. The scanning method can be used with existing string databases seamlessly, where the weights to the current signatures would be 1.00.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4395653"></a>Certainty rating</h2></div></div></div><p>Since we have a weight for each mini-signature, we can do a calculation to get a certainty rating, ranging from 0% to 100%. The formula I used is:</p><p><code class="computeroutput">1 - ([1 - DetectedWeight1] * [1 - DetectedWeight2] * .. * [1 - DetectedWeightN])</code></p><p>So the following examples would get certainty ratings of:</p><div class="variablelist"><dl><dt></dt><dd><p>apple, banana, orange in a basket 1 - ([1 - 0.25] * [1 - 0.25] * [1 - 0.25] * [1 - 0.50]) = 78.9%</p><p>apple, banana, orange, apple in a basket 1 - (0.75 * 0.75 * 0.75 * 0.75 * 0.50) = 84.2%</p><p>banana, orange in a basket 1 - (0.75 * 0.75 * 0.50) = 71.9%</p><p>basket, basket, basket in a basket 1 - (0.50 * 0.50 * 0.50 * 0.50) = 93.8%</p></dd></dl></div><p>And, if these were to be detected:</p><div class="variablelist"><dl><dt></dt><dd><p>foo, bar, baz 1 - (1 * 1 * 1) = 0.0%</p><p>apple, apple, apple 1 - (0.75 * 0.75 * 0.75) = 57.8%</p></dd></dl></div><p>As we can see, the certainty rating is not always accurate, but it is generally helpful in determining how certain the scanning result is.</p><p>Now, a malware scanner does not always have to give a binary result, like either 100% malware A, or 100% clean. It can give 95% malware B, or 24% malware C, or even 98% malware D and 70% malware E (where it&#39;s a cross-bred malware, such as W32/Mytob). With certainty ratings, users can set different thresholds - so, for example, government and financial institutions can have stricter scanning than regular home users.</p><p>I have crafted each of my mini-signature strings and their weights manually, covering more than 250 malware families, where each family contains 1 to 20+ mini-signatures. Scanning is case-insensitive to detect trivial variants.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4857899"></a>Scan #2 - malware knowledgebase</h2></div></div></div><p>This scanning method relies mainly on statistics. Every anti-virus company has its own collection of malware. These are very valuable resources, and many companies trade and share them, mainly to expand their signature databases to cover all known malware. I believe these resources have not been fully utilized, and more valuable data could be extracted from these collections.</p><p>Theoretically, by training neural networks with a sample set, a scanner should be able to distinguish malware from clean files. Work has already been done in this area by constructing neural networks of small sequences of bytes, called n-grams [<span class="citation"><a href="#citation.1">1</a></span>]. I took a different approach from n-grams and neural networks, mainly to reduce noise. Instead of looking for n-grams, I looked only for meaningful strings, such as filenames, IP addresses, email addresses, CLSIDs and URLs, using regular expressions. These strings, or &#39;components&#39; are special in that a program communicates with the system through these strings. I compiled the components from known malware and known clean files into a malware knowledgebase, and labelled each entry with either the malware family name or &#39;clean&#39;.</p><p>This is similar to the CLSID database from castlecops.com/CLSID.html, but extended to include other components. Since the regular expressions provided enough uniqueness for each string, I could get usable results without using neural networks or weights.</p><p>The rationale behind this scanning is as follows: malware A is known to use filenames &#39;<code class="filename">Expl0re.exe&#39;, &#39;<code class="filename">n0tepad.exe&#39;, &#39;scvhost.exe&#39; and &#39;<code class="filename">www.gogle.com&#39;, and no other files have been known to contain any of them. If you see an unknown file that contains all four of them, how likely is it that this file is malicious?</code></code></code></p><p>It can even work for clean components. An unknown file contains 80 &#39;clean&#39; components, like &#39;<code class="filename">hi.txt&#39;, &#39;<code class="filename">hello.txt&#39;, &#39;<code class="filename">foo.txt&#39; and &#39;<code class="filename">bar.txt&#39;. Of those 80 components, 60 are known to be related to malware B. What is the chance that two unrelated programs share 60 out of 80 components? Even if it is a pure coincidence that they share 60 components, it would be useful for the malware analyst to know the correlation. To enhance signal-to-noise ratio, some components, such as <code class="filename">kernel32.dll and <code class="filename">advapi32.dll, which occur in every program, are filtered out manually.</code></code></code></code></code></code></p><p>The promising feature of this malware knowledgebase scanning is that a known sample set or a trusted anti-virus scan can populate the malware knowledgebase with found components and their corresponding malware family names. Thus, the larger the knowledgebase grows, the more knowledgeable the scanner becomes.</p><p>Other applied uses of this knowledgebase are:</p><div class="orderedlist"><ol type="1"><li><p>To find out whether a specific bank URL has been present in any known password stealers, so the bank can be warned.</p></li><li><p>To obtain a list of all URLs in all known downloaders, so that these downloader URLs can be monitored.</p></li><li><p>To obtain email addresses or URLs associated with certain password stealers, so that the server administrator can be asked to shut those down.</p></li><li><p>To find a difference between a new variant and all other known variants with respect to components.</p></li></ol></div><p>Basically, the knowledgebase provides a single file view of all previously scanned malware and clean files.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3498109"></a>Scan #3 - abnormal functionality combinations</h2></div></div></div><p>It is perfectly legal for a law-abiding adult to drink alcohol. It is perfectly legal for a valid driver&#39;s licence-bearing adult to drive a vehicle. But, drinking and driving don&#39;t mix. The same logic applies to programs.</p><p>If a program contains a string &#39;<code class="filename">SOFTWARE\Microsoft\Windows\CurrentVersion\Run&#39; and &#39;<code class="filename">advapi32.dll&#39;, it is likely that it has the capability to add an autorun registry key to start itself. If a program contains &#39;<code class="filename">MIME-Version: 1.0&#39;, it is likely that it has the capability to send an email. If this program contains &lsquo;&#39;<code class="filename">bank.com&#39;, it is likely that it has the capability to monitor online banking URLs.</code></code></code></code></p><p>It is fine for a program to add an autorun registry key. It is fine for a program to send out an email. It is fine for a program to contain a bank URL. But, it is not fine for a program to have an autorun registry key, a bank name, and an email send feature. This program is likely to be a password stealer for online banking that sends sniffed traffic via email. There are combinations of functionalities that just don&#39;t make sense in benign code.</p><p>This method is similar to mini-signature scanning in that each functionality is detected by adding up the detected weights. Monitored functionalities are: autorun registry keys, disable <em class="productname">Windows</em> tools, <span class="productnumber">Internet Explorer</span> start page, <em class="productname">Internet Explorer</em> zone settings, ID and password lists, process monitoring, downloaders, shell, sockets, anti-virus process lists, exploits, mass-mailers, email, <em class="productname">MSN Messenger</em>, AIM, IRC backdoor command list, P2P lure filenames, banks, Visual Basic, Borland Delphi, Visual C, JavaScript, diallers, generic adware and game registry keys. As you can see, none of the functionality is malware family-specific.</p><p>After each functionality has been identified, the results are compared to known illegal or dangerous combinations. The following categories are alerted in descending order of importance: IRC bot, generic backdoor, password stealer, <em class="productname">Internet Explorer</em> security setting changer, <em class="productname">Internet Explorer</em> start page hijacker, downloader, anti-virus process killer. Other than these general illegal combinations, there are other uses for this method, such as looking for out-of-place functionalities. For example, a CD key crack program downloaded from a warez site, should not be using sockets or contain any bank URLs. And, it would be odd for a genuine <em class="phrase">Microsoft</em> file to be compiled using Borland Delphi.</p><p>Sometimes it can be hard to distinguish malware from a clean file just by looking at functionalities. For instance, an FTP server has similar functionalities to a backdoor: it listens for a command and sends or receives a file.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4320105"></a>A new naming scheme</h2></div></div></div><p>In order to link the results from the functionality scanner to a specific family, I needed a family name to show its functionalities. I needed the scanner to know that W32/Spybot spreads using exploits, has an IRC backdoor, downloads files, steals game keys, has embedded files, kills anti-virus processes and is written in C. So I changed the name W32/Spybot to &#39;WBspybotCDGMV&#39;. The family name is in lower case, and functionalities are in upper case, where each character represents a known functionality. The preceding characters are &#39;necessary&#39;, and the following characters are &#39;optional&#39;.</p><p>&#39;WBspybotCDGMV&#39; means that a W32/Spybot must be a worm (W) and an IRC backdoor (B), and is also likely to be written in C (C), have downloading capability (D), look for game keys (G), have multiple embedded files (M) and kill anti-virus processes (V). Other functionalities are: keylogging (K), IE startpage change (S), IE zone settings (L), Windows tool disable (R), generic adware (A), generic dialler (P), written in Delphi (E) and written in Visual Basic (Z). This is similar to Bezrukov&rsquo;s naming scheme [<span class="citation"><a href="#citation.2">2</a></span>], but I decided to keep the family name so that it can be referenced with an easy name. I removed all dots, slashes and dashes since they cause unnecessary naming differences among vendors.</p><p>The &#39;optional&#39; fields are implemented to accommodate leaner variants, which lack non-essential functionalities, yet are categorized under the same family since they share the major functionalities. The naming scheme not only reduces analysts&#39; work from reading existing malware descriptions, but could also be used to generate a preliminary malware description on-the-fly from pre-defined templates with data fed from the knowledgebase scanner.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3859164"></a><span class="emphasis"><em>Nutrition facts for software</em></span></h2></div></div></div><p>This naming scheme is not exclusive to malware, and can be applied to software in general. The software industry could adopt something similar to the Nutritional Facts label found on packaged food. Every food approved by the US Food and Drug Administration (FDA) has an easy-to-read label, giving a break down of the nutritional content of the food, such as &#39;47g of sugar&#39;, &#39;45mg of sodium&#39;, and so on. &#39;Nutritional facts for software&#39; could display whether the software has the following functionalities: outbound connection, inbound connection, email, no GUI, autorun registry keys, driver, registry keys, pop-up windows, monitors other processes, update, dialler, etc. This would give users a better idea of what the program might do to the system, and would be a lot easier to read than the End User License Agreement (EULA).</p><p>If this practice were to become widespread, security products could detect unlabelled functionalities. Furthermore, as a preventative measure, more advanced OSs could authorize only labelled rights to the program, while denying any unlabelled rights &ndash; a simpler and cleaner task than anti-virus scanning.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4125019"></a>Three strikes, you&#39;re out</h2></div></div></div><p>Let&#39;s say we scan an unknown file with all three scanners. The mini-signature scanner says the file is W32/Spybot with a weights sum of 7.3 and a certainty rating of 95.3%. The knowledgebase scanner tells us that 25 out of 28 components match with previously known components related to W32/Spybot. Finally, the functionality scanner tells us that the file contains a worm, an IRC backdoor, a downloader, game registry keys, multiple embedded files and an anti-virus process list. According to the database, W32/Spybot is WBspybotCDGMV, which matches every functionality, including the optional ones.</p><p>Based on these results, the scanner concludes that this unknown file has strikingly similar statistical data to known W32/Spybot. It would be safe to assume that this file is indeed a W32/Spybot.</p><p>If the file is detected by all three scanners, above some preset threshold, then it is assigned the prefix &#39;certain&#39;. If it is detected by scanner #1, and missed by scanner #2 or #3, then it is assigned the prefix &#39;suspicious&#39;. If it is detected by #2, and missed by scanner #1 or #3, then it is assigned the prefix &#39;suspicious&#39;. If it gets detected only by scan #3, then it is assigned the prefix &#39;guess&#39;.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4644878"></a>Performance tests</h2></div></div></div><p>The sample set comprised files from <em class="phrase">Symantec</em>&#39;s Sample Management System (SMS) with new signatures added from 1&ndash;15 October, all of which are also detected by one other reputable anti-virus scanner. Keep in mind that all the scanning is done with 2,000 lines of heavily commented Perl script, 2,000 lines of mini-signatures, and 35,000 lines of knowledgebase, and it is independent from any existing anti-virus engine or signature database.</p><p>Since the threshold level can be customizable for each scanner, my settings for testing were as follows: mini-signature scanning would trigger over a weight sum of 1. If more than one family name was detected, higher certainty rating would arbitrate. Knowledgebase scanning would trigger on over 50% and more than four component matches. Functionality scanner was used as a &#39;sanity check&#39;, and would trigger when all &#39;necessary&#39; functionality matched.</p><p><code class="computeroutput">=================================</code></p><p><code class="computeroutput">PWSteal.Bancos, PWSteal.Banpaes, aka PWSteal.Banker</code></p><p><code class="computeroutput">359 files</code></p><p><code class="computeroutput">----------------</code></p><p><code class="computeroutput">302 Certain.Kbancos</code></p><p><code class="computeroutput"> 54 Suspicious.Kbancos</code></p><p><code class="computeroutput"> 3 Guess.*</code></p><p><code class="computeroutput">0 No Detect</code></p><p><code class="computeroutput">================================</code></p><p><code class="computeroutput">W32.Spybot, W32.Gaobot, W32.Randex, W32.Mytob and other bots, aka Sdbot, Rbot</code></p><p><code class="computeroutput">355 files</code></p><p><code class="computeroutput">----------------</code></p><p><code class="computeroutput">295 Certain.*bot</code></p><p><code class="computeroutput"> 41 Suspicious.*bot</code></p><p><code class="computeroutput">12 Guess.*</code></p><p><code class="computeroutput"> 7 No Detect</code></p><p><code class="computeroutput">================================</code></p><p><code class="computeroutput">Clean files</code></p><p><code class="computeroutput">5700 files</code></p><p><code class="computeroutput">----------------</code></p><p><code class="computeroutput"> 0 Certain.*</code></p><p><code class="computeroutput"> 9 Suspicious.*</code></p><p><code class="computeroutput">85 Guess.*</code></p><p><code class="computeroutput">5606 No Detect</code></p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4309401"></a>Afterwords</h2></div></div></div><p>Anti-virus scanning at the core is pattern recognition. This algorithm of cooperative scanning using weighted mini-signature and statistical analysis is not restricted to anti-virus scanning alone. Since I am treating each piece of malware like a text file, the same algorithm can be used to categorize any data, especially text documents, given that the categories are well defined. The method could easily be adapted to detect spam, or phishing. Furthermore, with appropriate adaptors, it could categorize all your documents into your personal preferences.</p><p>I would like to thank Javier Santoyo for supporting this project, and Douglas Knowles for porting the &#39;dirty&#39; Perl code to a faster C version.</p></div><div class="bibliography"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4113182"></a>Bibliography</h2></div></div></div><div class="bibliomixed"><a id="citation.1"></a><p class="bibliomixed">[1] William Arnold and Gerald Tesauro, &#39;Automatically generated Win32 heuristic virus detection&#39;, Proceedings of the 10th Virus Bulletin Conference, 2000, pp.51&ndash;60.</p></div><div class="bibliomixed"><a id="citation.2"></a><p class="bibliomixed">[2] Dr Vesselin Bontchev, &#39;Current status of the CARO Malware Naming Scheme&#39;, Proceedings of the 15th Virus Bulletin Conference, 2005, pp.160&ndash;170.</p></div></div> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=Cooperative heuristics&url=https://www.virusbulletin.com/virusbulletin/2006/01/cooperative-heuristics"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2006/01/cooperative-heuristics'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2006/01/cooperative-heuristics&title=Cooperative heuristics"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2006/01/cooperative-heuristics&t=Cooperative heuristics"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2006/01/cooperative-heuristics"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p> </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">©1989-2022 Virus Bulletin.        <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>        <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>        <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>