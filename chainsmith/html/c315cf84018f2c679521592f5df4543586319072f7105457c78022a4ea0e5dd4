<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: VB2015 paper: DDoS Trojan: A Malicious Concept that Conquered the ELF Format</title>
<meta name="description" content="In their VB2015 paper, Peter Kálnai and Jaromír Hořejší look at the current state of DDoS trojans forming covert botnets on unsuspecting systems. The paper provides a technical analysis of the most important malware families, with a specific focus on infection methods, dynamic behaviour, C&amp;C communication, obfuscation techniques, advanced methods of persistence and stealth, and elimination of rivals. The paper studies cybercriminals’ behaviour and introduces their operation tools, including vulnerability scanners, brute-forcers, bot builders and C&amp;C panels. Finally, methods and techniques are discussed and the targets of these attacks are revealed." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 4833;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/remo_expand/blocks/remo_expand/templates/vbexpand/view.css" />
<script type="text/javascript" src="/packages/remo_expand/js/jquery.color.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/remo.expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<h1>VB2015 paper: DDoS Trojan: A Malicious Concept that Conquered the ELF Format</h1>
<h3>Peter Kálnai &amp; Jaromír Hořejší</h3>
<p>Avast Software, Czech Republic</p>
<p><em>Copyright © 2016 Virus Bulletin</em></p>
<hr />
<p> </p>
<div class="ccm-remo-expand">
<div id="ccm-remo-expand-title-7989" class="ccm-remo-expand-title ccm-remo-expand-closed" data-expander-speed="500">Table of contents</div><div id="ccm-remo-expand-content-7989" class="ccm-remo-expand-content"><p><a class="toc-level2" href="#h2-1-introduction">1. Introduction</a><br /><a class="toc-level2" href="#h2-2-common-characteristics">2. Common Characteristics</a><br /><a class="toc-level3" href="#h3-21-about-the-elf-format">2.1 About the ELF format</a><br /><a class="toc-level3" href="#h3-22-static-properties">2.2 Static properties</a><br /><a class="toc-level3" href="#h3-23-autostart">2.3 Autostart</a><br /><a class="toc-level2" href="#h2-3-cybercriminals-operation-tools">3. Cybercriminals' Operation Tools</a><br /><a class="toc-level3" href="#h3-31-bot-builders-and-campc-panels">3.1 Bot builders and C&amp;C panels</a><br /><a class="toc-level3" href="#h3-32-hfs-listings">3.2 HFS listings</a><br /><a class="toc-level3" href="#h3-33-brute-forcers-and-vulnerability-scanners">3.3 Brute-forcers and vulnerability scanners</a><br /><a class="toc-level2" href="#h2-4-ddos-trojans-in-the-elf-malware-space">4. DDoS Trojans in the ELF Malware Space</a><br /><a class="toc-level3" href="#h3-41-elknotsetag">4.1 Elknot/Setag</a><br /><a class="toc-level4" href="#h4-411-simple-variant">4.1.1 Simple variant</a><br /><a class="toc-level4" href="#h4-412-variant-setag">4.1.2 Variant Setag</a><br /><a class="toc-level3" href="#h3-42-mrblack">4.2 MrBlack</a><br /><a class="toc-level4" href="#h4-421-aesddos">4.2.1 Aesddos</a><br /><a class="toc-level3" href="#h3-43-iptablesx">4.3 Iptablesx</a><br /><a class="toc-level3" href="#h3-44-sotdas">4.4 Sotdas</a><br /><a class="toc-level3" href="#h3-45-gafgyt">4.5 Gafgyt</a><br /><a class="toc-level3" href="#h3-46-xorddos">4.6 Xorddos</a><br /><a class="toc-level3" href="#h3-47-chinaz">4.7 Chinaz</a><br /><a class="toc-level2" href="#h2-5-statistics-and-victim-preferences">5. Statistics and Victim Preferences</a><br /><a class="toc-level2" href="#h2-6-conclusion">6. Conclusion</a><br /><a class="toc-level2" href="#h2-acknowledgements">Acknowledgements</a><br /><a class="toc-level2" href="#h2-references">References</a><br /><a class="toc-level2" href="#h2-appendix">Appendix</a></p>
<p> </p></div></div><h2><a class="chapter" name="h2-span-styleline-height-142857abstractspan"></a><span style="line-height: 1.42857;">Abstract</span></h2>
<p><span style="line-height: 1.42857;">DDoS threats have been around ever since the Internet took over half of global communications, posing the real problem of denial of access to online service providers. </span>Recently, a new trend has emerged in non-<em>Windows</em> DDoS attacks that has been induced by code availability, lack of security and an abundance of resources. The attack infrastructure has undergone significant changes in structure, function and complexity. Malware has evolved into complex and relatively sophisticated pieces of code, employing compression, advanced encryption and even rootkit capabilities. Targeted machines are those running systems supporting the ELF format – anything from desktops and servers to IoT devices such as routers or digital video recorders (DVRs) could be at risk.</p>
<p>In this paper, we will look at the current state of DDoS trojans forming covert botnets on unsuspecting systems. A technical analysis of the most important malware families will be provided, with a specific focus on infection methods, dynamic behaviour, C&amp;C communication, obfuscation techniques, advanced methods of persistence and stealth, and elimination of rivals. We will study cybercriminals' behaviour and introduce their operation tools, including vulnerability scanners, brute-forcers, bot builders and C&amp;C panels. In many cases, it's unnecessary to apply reverse engineering within the analysis – the original source codes are indexed in public search engines and their customization is a subject of monetization. Finally, we will discuss tracking methods and techniques and reveal the targets of these attacks.</p>
<h2><a class="chapter" name="h2-1-introduction"></a>1. Introduction</h2>
<p>Today, both desktop users and organizations face various types of cyber attacks including credential theft, spam distribution, click fraud and denial of services (DoS). These are all usually performed via a series of zombie computers in a malicious botnet controlled by cybercriminals. Distributed DoS (DDoS) attacks are carried out using various methods such as volumetric flooding, slow HTTP attacks or TCP protocol misuse. A DNS amplification is an example of volumetric flooding that has become popular recently. Certain trojans for the <em>Windows</em> platform with resources containing Chinese symbols have a long tradition of use in this type of attack and lack other spying features that trojans often possess (cf. [<a href="#ref1">1</a>]).</p>
<p>Implementations of flooding procedures have been available for a long time on Chinese source-code sharing services, especially in C/C++. Until recently, the shared sources were usually compiled as DDoS tools exclusively for the <em>Windows</em> platform. Crossing to another platform like <em>Linux</em> is not a complicated process though, and we have observed that many of these tools have been ported. These tools are not necessarily invasive trojan-type malware. However, they come with an additional framework (often on a different platform from the flooding tools) that provides an attacker with the possibility of forming a malicious botnet. The framework consists of C&amp;C panels, bot builders, installation scripts, port scanners, SSH brute-forcers, etc. In our paper we provide a survey of current <em>Linux</em> DDoS bots and we sketch a wider context of usage of the above-mentioned components. This topic has been covered by many independent security researchers, e.g. the <em>MalwareMustDie!</em> group summarised their series of blog posts in [<a href="#ref2">2</a>]. The authors presented its early development in [<a href="#ref21">21</a>].</p>
<h2><a class="chapter" name="h2-2-common-characteristics"></a>2. Common Characteristics</h2>
<h3><a class="chapter" name="h3-21-about-the-elf-format"></a>2.1 About the ELF format</h3>
<p>ELF is short for 'Executable and Linkable Format', which is a common standard format for executables under Unix systems. The instruction set architecture (ISA) of the binary is stored at the offset e_machine, and we refer to this parameter using the prefix 'EM_'. Unix systems power not only desktop and server machines, but are also the main operating systems for embedded devices. Although <em>Intel 80386</em> (EM_386) and <em>AMD64</em> (EM_x86_64) ISAs are the most common for desktops and servers, the situation for embedded devices is completely different – the devices may run on different ISAs, such as EM_ARM or EM_MIPS. Cross-compilation of malicious binaries to the latter platforms is done with the aim of extending the group of potential victims to target a wider range of devices.</p>
<h3><a class="chapter" name="h3-22-static-properties"></a>2.2 Static properties</h3>
<p>We found that debugging symbols were often not stripped from ELF executables and thus revealed a lot about their functionality, especially the procedure names. The unstripped binaries listed in the Appendix were chosen intentionally so that we could review their features easily. At the same time, plain ELF binaries were occasionally encapsulated with the well-known UPX compression [<a href="#ref4">4</a>], which produced a certain level of polymorphism for the distributors. There were cases when packed executables were altered in such a way that the official tool did not decompress them (e.g. some chosen samples from the Sotdas and MrBlack families referred to in the <a href="#h2-appendix">Appendix</a>). These modifications targeted the UPX header, which is located at the tail of the file. The changed parameters were the UPX magic string, various checksums, file sizes or decompression methods. Dynamic behaviour was not affected.</p>
<p>Infected embedded devices do not often hide the presence of the malware – debug information might be displayed directly on the standard console output.</p>
<h3><a class="chapter" name="h3-23-autostart"></a>2.3 Autostart</h3>
<p>All programs and tools below are involved in malicious activities, but in a strict sense we consider a DDoS trojan as a DDoS tool with an autostart feature. There are more common methods for bots to handle their persistence. This is done by creating symbolic links or executable scripts in the following directories:</p>
<ul>
<li><span style="line-height: 1.42857;">(AS1) /etc/init.d/ – the central repository of all startup scripts.</span></li>
<li><span style="line-height: 1.42857;">(AS2) /etc/cron.&lt;S&gt;/, where S is a period (hourly, daily, monthly, weekly). Additionally, a service might be added to run in the cron (/etc/crontab).</span></li>
<li><span style="line-height: 1.42857;">(AS3) /etc/rc&lt;N&gt;.d/, where N is the run level indicator (0–6). Alternatively, the desired path can be added to </span><span style="line-height: 1.42857;">/etc/rc.local to run it once at boot time before all other scripts.</span></li>
</ul>
<h2><a class="chapter" name="h2-3-cybercriminals-operation-tools"></a>3. Cybercriminals' Operation Tools</h2>
<p>Distribution starts with either an automated SSH brute-forcing of various <em>Windows</em> and <em>Linux</em> servers or vulnerability scanning and exploiting using the hacking tools and password lists mentioned below. If successful, flooding tools are downloaded and installed onto the hacked servers.</p>
<p>The installation process can consist of several steps:</p>
<ul>
<li><span style="line-height: 1.42857;">determining susceptibility to known vulnerabilities of the system</span></li>
<li><span style="line-height: 1.42857;">killing competing time-consuming processes</span></li>
<li><span style="line-height: 1.42857;">establishing autostart</span></li>
<li><span style="line-height: 1.42857;">disabling firewalls.</span></li>
</ul>
<p>We found that it was not unusual for flooding and control components to be offered freely as web server stress tests, with a warning that discourages any malicious use. However, authors looking for monetization of their tools offer customization of attack preferences and their control framework in return for a fee.</p>
<h3><a class="chapter" name="h3-31-bot-builders-and-campc-panels"></a>3.1 Bot builders and C&amp;C panels</h3>
<p>According to the type of machines that botmasters use to build their botnets, particular C&amp;C panels and bot builders are chosen. They might be restricted to MIPS bots (e.g. MrBlack) or more heterogeneous with support for <em>Linux</em>, <em>Windows</em> and <em>FreeBSD</em> (e.g. Elknot). A bot builder is designed to set up bot details easily (e.g. the IP address of the C&amp;C, port number, encryption keys, etc.). The builder generates the final binary from a binary template, and after execution it is displayed in the control panel. The control panels are in the form of <em>Windows</em> executables.</p>
<p>The acquired builders are written and run under <em>Windows</em> OS, although they may produce binaries for both <em>Windows</em> and <em>Linux</em>. A few examples are as follows:</p>
<ul>
<li><span style="line-height: 1.42857;">Chicken Builder (see <a href="#figure1">Figure 1</a>)</span></li>
<li><span style="line-height: 1.42857;">Text-Box Builder &amp; Manager</span></li>
<li><span style="line-height: 1.42857;">MrBlack Builder (see <a href="#figure2">Figure 2</a>) <a class=" anchor" name="figure1"></a><br /></span></li>
</ul>
<p><span style="line-height: 14.2857px;"><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/2014/5924/5563/DDoS_Trojan-fig1.jpg" alt="DDoS_Trojan-fig1.jpg" width="634" height="547" /><span class="centered-caption">Figure 1: Example of Chicken Builder for Elknot.<a class=" anchor" name="figure2"></a></span><br /></span></p>
<p><span style="line-height: 14.2857px;"><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/4914/5924/5581/DDoS_Trojan-fig2.jpg" alt="DDoS_Trojan-fig2.jpg" width="646" height="179" /></span></p>
<p class="centered-caption" style="text-align: center;">Figure 2: Example of MrBlack Builder.</p>
<p>The existence of bot-building tools is consistent with the enormous number of existing samples that differ only in settings such as C&amp;C domains.</p>
<h3><a class="chapter" name="h3-32-hfs-listings"></a>3.2 HFS listings</h3>
<p>A good insight into the distribution chain was provided by file listings displayed as the web content of an HTTP file server (an HFS listing) that was established on a possibly compromised machine. The listings contained various groups of files, starting with port scanners, vulnerability scanners, login/password brute-forcers, password lists, lists of targeted IPs and SSH clients, and ended with the proper flooding tools, bot builders and C&amp;C panels. Sometimes we even noticed text files with IP addresses of servers followed by the default names and passwords. These servers were clearly using the default credentials and were therefore accessible to anyone knowing the name/password combination. Additional crucial information provided by the HTTP file servers was the exact number of downloads of each file, giving us a chance to estimate the size of botnets.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/8014/5924/5877/DDoS_Trojan-fig3.jpg" alt="DDoS_Trojan-fig3.jpg" width="712" height="476" /></p>
<p class="centered-caption">Figure 3: An HFS panel used for distribution of malware – the number of downloads is shown in the right column.</p>
<h3><a class="chapter" name="h3-33-brute-forcers-and-vulnerability-scanners"></a>3.3 Brute-forcers and vulnerability scanners</h3>
<p><a href="#figure4">Figure 4</a> shows an SSH brute-forcer, where attackers can enter a list of IP addresses and a password list, as well as specifying other parameters of the attack. <a class=" anchor" name="figure4"></a></p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/2114/5924/5985/DDoS_Trojan-fig4.jpg" alt="DDoS_Trojan-fig4.jpg" width="697" height="423" /><span class="centered-caption">Figure 4: An SSH brute-forcer. Attackers enter an IP list and password list and specify other parameters of the attack.</span></p>
<p><a href="#figure5">Figure 5</a> shows a vulnerability scanner for <em>Apache Struts</em>, which was found together with Chinaz samples. <a class=" anchor" name="figure5"></a></p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/1814/5924/6000/DDoS_Trojan-fig5.jpg" alt="DDoS_Trojan-fig5.jpg" width="766" height="507" /><span class="centered-caption">Figure 5: A vulnerability scanner for Apache Struts found together with Chinaz samples.</span></p>
<h2><a class="chapter" name="h2-4-ddos-trojans-in-the-elf-malware-space"></a>4. DDoS Trojans in the ELF Malware Space</h2>
<p>It should not come as a surprise that ELF malware is not the same as its Windows counterpart. This is due to the fact that most <em>Windows</em> malware runs on a machine where a user performs personal actions, so info-stealers and banking trojans make sense. ELF malware often targets devices that are not accessed by a real user. Therefore, it makes sense to misuse the device's power for tasks like denial of service, bitcoin mining or proxy networking and anonymization. <a href="#figure6">Figure 6</a> sketches the total ELF malware space based on <em>Avast</em>'s internal data, where the nodes represent particular malware families proportional to the number of unique samples and the edges are present if the corresponding families share a signature. The picture has been manipulated to omit very old viruses, potentially unwanted applications, and nodes with fewer than 10 unique hashes for the sake of leaving only relevant and interesting data. <a class=" anchor" name="figure6"></a></p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/5414/5924/6018/DDoS_Trojan-fig6.jpg" alt="DDoS_Trojan-fig6.jpg" width="847" height="543" /><span class="centered-caption">Figure 6: ELF malware space.</span></p>
<p>Based on the similarity of features we tried to group all the bots into several clusters. Most of them also exist as <em>Windows</em> variants, but those will not be discussed.</p>
<h3><a class="chapter" name="h3-41-elknotsetag"></a>4.1 Elknot/Setag</h3>
<p>With the highest incidence among any ELF malware family (~1400 unique samples), Elknot/Setag is among the most popular malware distributed by attackers. There are two main variants in this family, both of which were written in the modular C++ language. Bots of this type run on <em>Windows</em> x86/x64, <em>Linux</em> x86/x64 and <em>FreeBSD</em> systems. Although the variants differ in complexity, we grouped them into one family because their <em>Windows</em> versions have significantly similar debug info. They also have a very similar command grammar. A detailed analysis was provided by <em>Kaspersky</em>'s Mikhail Kuzin in [<a href="#ref5">5</a>].</p>
<h4><a class="chapter" name="h4-411-simple-variant"></a>4.1.1 Simple variant</h4>
<p>This variant usually comes as an on-the-fly patcher of an embedded DDoS tool. Its purpose is to replace itself with a dropped bot that has the C&amp;C server and the port number carried from the patcher. These data are encrypted with a simple substitution cipher based on adding one from characters on odd positions and subtracting one from characters on even positions.</p>
<p>The tool itself is characterized by the presence of the files fake.cfg or xmit.ini, which contain information such as the attack status, the ranges of outgoing IP addresses and ports, or a domain name for a DNS flood. All network communication is a part of the CNetBase class. The commands supported are ReadTask, StopTask, ReadFake and DestroySocket, and are implemented in the main CManager class.</p>
<h4><a class="chapter" name="h4-412-variant-setag"></a>4.1.2 Variant Setag</h4>
<p>This more sophisticated trojan-type bot usually contains the character strings 'Bill' and 'Gates'. It recognizes four types of execution: MainBackdoor, MainSystool, MainMonitor and MainBeikong.</p>
<ul>
<li><em style="line-height: 1.42857;">Type MainBackdoor:</em><span style="line-height: 1.42857;"> A bot running this type of execution is called as the /usr/bin/bsd-port/getty file. At first it decrypts a hard-coded configuration using RSA‑1024 (the configuration settings are computed as a solution to the equation P ^ Q % N, where P and Q are primes and N is modulus). The SetAutoStart procedure creates the selinux script in (AS1) and multiple links under the name S99selinux in (AS3). The HandleSystools method of the CSystool class replaces the system tools /bin/netstat, /bin/lsof, /bin/ps, /usr/bin/netstat, /usr/bin/lsof, /usr/bin/ps, /usr/sbin/netstat, /usr/sbin/lsof and /usr/sbin/ps with copies of itself and backs up the original files into the newly created /usr/bin/dpkg/ directory. The proper attack is realized in the MainProcess method of the main CManager class. A list of the IP addresses of DNS servers misused for DNS amplification attacks are stored in the /usr/lib/libamplify.so file. The attacking classes are as follows: CAttackIcmp, CAttackSyn, CAttackUdp, CAttackAmp (DNS amplification), CAttackCC, CAttackDns, CAttackPrx, CAttackCompress, CTcpAttack, CAttackCc, CAttackIe and CAttackTns.</span></li>
<li><em style="line-height: 1.42857;">Type MainSystool:</em><span style="line-height: 1.42857;"> A bot running this type of execution must be named as one of the systools. This type may be under development because, currently, execution of these replaced commands starts a copy of the trojan but does not ensure its autostart or an alteration of outputs.</span></li>
<li><em style="line-height: 1.42857;">Type MainMonitor:</em><span style="line-height: 1.42857;"> A bot running this type of execution is executed as the /usr/bin/.sshd file. It spawns an infinite thread which monitors the existence of an instance of the trojan and handles a reinstallation if needed. The PID of a monitored process is loaded from /tmp/gates.lock. If no process with the given PID exists, then the trojan is installed and started again.</span></li>
<li><em style="line-height: 1.42857;">Type MainBeikong:</em><span style="line-height: 1.42857;"> The features of this type of execution are very similar to those of MainBackdoor. This type is run if the bot has a different name from the three mentioned. The autostart is achieved by the DbSecuritySpt script via (AS1) and by multiple links under the name S97DbSecuritySpt via (AS3). In this mode, the trojan checks whether another instance of malware is running in the system (via the presence of *.lock files containing PIDs ). If so, then it terminates all of them, deletes all .lock files and restarts. This mode is probably used for updates or reinstallation of the trojan.</span></li>
</ul>
<p>The C&amp;C panel is called NFarm and its executable is called xitele, which translates as 'Hitler' in Chinese (see <a href="#figure7">Figure 7</a>). <a class=" anchor" name="figure7"></a></p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/7314/5924/6034/DDoS_Trojan-fig7.jpg" alt="DDoS_Trojan-fig7.jpg" width="847" height="597" /><span class="centered-caption">Figure 7: Control panel for Elknot family, called xitele.</span></p>
<h3><a class="chapter" name="h3-42-mrblack"></a>4.2 MrBlack</h3>
<p>This family involves minimalistic DDoS tools characterized by the main thread _ConnectServer with a subroutine DealwithDDoS that handles the attack. The binaries usually contain character strings such as 'Hacker', 'Mr. Black', 'VERS0NEX' or a typo 'connnect'. The support of <em>Linux</em> architectures is wide (EM_386, EM_x86_64, EM_ARM and EM_MIPS) and compression with UPX is not exceptional. Additional threads could be spawned for collecting CPU and network statistics and reporting them to a C&amp;C server. A detailed analysis was published by <em>Prolexic</em> [<a href="#ref6">6</a>].</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/2814/5924/6054/DDoS_Trojan-fig8.jpg" alt="DDoS_Trojan-fig8.jpg" width="847" height="473" /><span class="centered-caption">Figure 8: Control panel for MrBlack called sword.exe with one connected bot (MIPS).</span></p>
<h4><a class="chapter" name="h4-421-aesddos"></a>4.2.1 Aesddos</h4>
<p>Aesddos is a trojan that extends the core functionality provided by MrBlack with C&amp;C communication encrypted with AES. Persistence is realized at the beginning of the execution in the autoboot procedure by stream editing the files /etc/init.d/boot.local (AS1) and /etc/rc.local (AS3). The attack itself is performed via two main threads, backdoorA and backdoorM. The trojan supports the same <em>Linux</em> architectures as MrBlack, but the EM_ x86_64 variant was not observed. A detailed analysis of the MIPS variant is provided by M.J. Bohio [<a href="#ref7">7</a>].</p>
<p>4.2.2 WrkAtk</p>
<p>This is another trojan subfamily that strongly resembles Aesddos, with two main threads called DoubleDoMain1 and DoubleDoMain2. Its name is derived from the thread AttackWorker, which is responsible for calling the DealwithDDoS subroutine with appropriate parameters. Autostart is achieved using the insert_reboot procedure and is based on the same principle as in the case of Aesddos. The already_running procedure checks that the process is the only instance of the trojan, and the test is done by locking the file /var/run/dos32.pid. The configuration file dosset.dtdb is an additional IoC.</p>
<h3><a class="chapter" name="h3-43-iptablesx"></a>4.3 Iptablesx</h3>
<p>It was observed that a DDoS trojan has been spread by exploiting vulnerable<em> Apache Tomcat</em>, <em>Struts</em> or <em>Elasticsearch</em> software. The functionality of this piece of malware is divided into two parts: an initial binary is responsible for establishing persistence, eliminating an extensive list of rivals (stored in kill.txt or fuckopen.txt) and downloading an additional bot with implemented attack routines. IoCs list a binary /usr/bin/btdaemon, a process .flush, or S90bluetooth symbolic links.</p>
<p>The proper DDoS bot is written in C and is downloaded as getsetup.rar. Execution parameters are stored in the global variable g_mainsrvinfo of a struct type MAINSRVINFO with entries such as srvver, mainhostip, udpport or Mainisrun. A self-installation is performed into the /boot/ directory with an autostart script called IptabLes/IptabLex in (AS1). The bot then establishes communication with its C&amp;C server. The initial packet contains the memory and CPU statistics of the compromised machine. Once the connection is established and the initial packet has been sent, the bot awaits commands from its control server. The most important DDoS commands are: setlocalip, setrandomip, updatepath, updatesrv, DeleteTask and DeleteAllTask. Observed types of attacks include volumetric SYN_Flood and DNS_Flood. Detailed analyses have been provided by <em>Prolexic</em> [<a href="#ref8">8</a>] and <em>MalwareMustDie!</em> [<a href="#ref9">9</a>].</p>
<h3><a class="chapter" name="h3-44-sotdas"></a>4.4 Sotdas</h3>
<p>This family is characterized by the presence of the strings 'g_nIsStopDDOS', 'DOSSTAT' or '# chkconfig: 2345 77 37'. The encryption of particular strings is done in a similar manner to that in which it is done in the Elknot family, but the period of substitution is 3 instead of 2. A self-installation takes care of multiple copies as /etc/.zl and /tmp/.lz&lt;digits&gt; files, where digits are derived from actual time. An autostart script is called .zl in (AS1) and symbolic links are called S77.zl in (AS3) (run levels Halt, Single-user mode and Reboot are omitted). The closefirewall procedure clears the environment for the trojan by disabling network filters (by stopping SuSEfirewall2 and disabling ufw) and terminating competing DDoS processes (obviously targeting IoCs of Iptablesx). The related binaries are often compressed with modified UPX. A detailed analysis has been published by <em>Dr.Web</em> [<a href="#ref10">10</a>].</p>
<h3><a class="chapter" name="h3-45-gafgyt"></a>4.5 Gafgyt</h3>
<p>This is an alternative name for the Lizard Stresser DDoS tool advertised by the Lizard Squad group [<a href="#ref11">11</a>]. It is capable of infecting a variety of devices running on <em>Linux</em>. In-the-wild usage of the Bash Bug, a.k.a Shellshock vulnerability (CVE-2014-6271), was observed to install Gafgyt's binaries onto a compromised system [<a href="#ref12">12</a>]. The source code of this IRC bot was leaked in January 2015. The support of architectures is the widest as the installation script downloads cross-compiled bots for EM_386, EM_x86_64, EM_SPARC, EM_PPC, EM_SH, EM_ARM, EM_MIPS and EM_68K. Examples of implemented commands together with an explanation for each are shown in <a href="#table1">Table 1</a>. <a class=" anchor" name="table1"></a></p>
<table class="table table-striped" border="0">
<tbody>
<tr>
<td>PING</td>
<td><span>Reply PONG to the server</span></td>
</tr>
<tr>
<td><span>GETLOCALIP</span></td>
<td>Get victim's IP</td>
</tr>
<tr>
<td><span>SCANNER</span></td>
<td><span><span>ON | OFF; </span>attempts to login to IPs from a generated list and to install itself if successful</span></td>
</tr>
<tr>
<td>UDP</td>
<td><span>UDP flooding</span></td>
</tr>
<tr>
<td>TCP</td>
<td>TCP flooding</td>
</tr>
<tr>
<td>DNS</td>
<td><span>DNS amplification</span></td>
</tr>
<tr>
<td><span>KILLATTK</span></td>
<td><span>Stop DDoS attack</span></td>
</tr>
<tr>
<td><span>LOLNOGTFO</span></td>
<td><span>Stop the backdoor</span></td>
</tr>
</tbody>
</table>
<p class="centered-caption"><span style="line-height: 1.42857;">Table 1: Some commands implemented in Gafgyt.</span></p>
<p>Detailed analyses have been published by<em> Dr.Web</em> [<a href="#ref13">13</a>] and <em>Alienvault</em> [<a href="#ref14">14</a>].</p>
<h3><a class="chapter" name="h3-46-xorddos"></a>4.6 Xorddos</h3>
<p>This cluster was first discovered in September 2014 [<a href="#ref15">15</a>] and later reported multiple times [<a href="#ref16">16</a>, <a href="#ref17">17</a>, <a href="#ref18">18</a>]. Its infection vector starts with SSH brute force attacks for the sake of running an installation script under the root user. The script customizes the installation process and contains procedures like main, check, compiler, uncompress, setup, generate, upload, checkbuild, etc. and variables like __host_32__, __host_64__, __kernel__, __remote__, etc. Three requests are issued to hard-coded C&amp;C servers: the initial GET with an<br />MD5-hashed string containing the name of the kernel version; a GET query with the parameters of a customized binary such as rootkit version and a list of the bot's C&amp;Cs; and the final GET request of a compiled binary. The rootkit component with a complicated server-assisted installation is where Xorddos differs from all the other <em>Linux</em> trojans. Due to the nature of the <em>Linux</em> operating system, knowledge of kernel headers is crucial for loading any kernel module in the victim's machine. In case the hash of the kernel version is unknown to the server, the system's kernel headers are uploaded via a custom uploader and a new rootkit-equipped trojan can be delivered. The rootkit component is based on the open-source Suterusu rootkit, which is also available on <em>Github</em> [<a href="#ref19">19</a>].</p>
<p>The binary itself is copied into /boot/ under a random name. The name is then used to autostart the binary via (AS1), another script called udev.sh or cron.sh via (AS2), and symblic links called S90%s (where %s is randomly substituted via (AS3). Moreover, a victim might observe another instance of a randomly named binary in the /boot/ constantly being deleted and created again. This behaviour avoids the need to find a single constant process and to apply the kill command.</p>
<p>The configuration file of the rootkit contains four categories of lists: md5, denyip, filename and rmfile, which mean killing a running process based on its checksum (even though the variable is called md5, the internal implementation is CRC32), on the active communication with an IP from the list, on a filename, and finally removing a file with a specified name. <a href="#figure9">Figure 9</a> shows part of the config file; marked filenames denote usual competitors such as Elknot, MrBlack, Sotdas or Iptablesx. <a class=" anchor" name="figure9"></a></p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/6514/5924/6068/DDoS_Trojan-fig9.jpg" alt="DDoS_Trojan-fig9.jpg" width="847" height="257" /><span class="centered-caption">Figure 9: Elimination of rivals of Xorddos.</span></p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/6414/5924/6089/DDoS_Trojan-fig10.jpg" alt="DDoS_Trojan-fig10.jpg" width="847" height="312" /><span class="centered-caption">Figure 10: Control Panel for Xorddos with two connected bots, one EM_386, the second EM_ARM.</span></p>
<p>The C&amp;C communication is encrypted in both directions with the same hard-coded XOR key (<em>BB2FA36AAA9541F0</em>) – which inspired the trojan's name.</p>
<h3><a class="chapter" name="h3-47-chinaz"></a>4.7 Chinaz</h3>
<p>This is a collection of DDoS tools with core flooding functionality borrowed from a simple project, DDosClient, available publicly on <em>Github</em> (last update in March 2015). The commands that are supported are at least COMMAND_DDOS_ATTACK and COMMAND_DDOS_STOP, and the attack arsenal lists at least methods including ATTACK_SYN, ATTACK_UDP, ATTACK_ICMP, ATTACK_DNS1 and ATTACK_DNS2. The other character strings are 'DDos ATTACE!', 'SecurtDoor', 'MK32' and 'MK64'. Variants have been observed for multiple platforms: EM_386, EM_x86_64 and EM_MIPS. Samples are often packed by the unmodified UPX tool.</p>
<h2><a class="chapter" name="h2-5-statistics-and-victim-preferences"></a>5. Statistics and Victim Preferences</h2>
<p>The number of bots running on <em>Linux</em> platforms was not expected to be high. The size of a botnet could be estimated by data from HFS panels running on different machines. Distributed malicious binaries displayed tens, hundreds, occasionally thousands of downloads. However, that value was just an upper bound as bots might have been reinstalled repeatedly on victims' machines. The situation was similar for botnets of Gafgyt, as [<a href="#ref11">11</a>] revealed.</p>
<p>Regarding the volume of attacks, the reports [<a href="#ref8">8</a>] and [<a href="#ref6">6</a>] state peaks of 30.10 Gbps/6.75 Mpps for Iptablesx respectively, with 70 Gbps/28 Mpps for MrBlack. A DDoS attack performed by one victim of Xorddos reported in [<a href="#ref20">20</a>] lasted three hours and the amount of data averaged 6.63 Mbps/70 Kbps.</p>
<p>By knowing the communication protocol and the command grammar it is possible to harmlessly monitor the C&amp;C activity and to log the targets of DDoS attacks. This was applied by a series of Python scripts for the Elknot/Setag family [<a href="#ref21">21</a>]. We have tried a similar approach for the Xorddos family. Among the observed victims were especially online gaming sites, e-commerce shops, online casinos, etc., all of which belonged to Chinese, American or Canadian IP ranges. These services had both the nature of small or medium-sized local businesses and services with a huge anti-DDoS infrastructure. The success of a flooding attack on the unprotected ones was directly observed in terms of the unreachability of a service shortly after the attack command had been issued.</p>
<p>Targeted IP addresses in the United States or Canada involved infrastructure belonging to <em>Google Cloud</em> [<a href="#ref20">20</a>], <em>CNSERVERS LLC</em>, <em>Global Flag</em> (hosting game servers like <em>Counter Strike</em> or <em>Day of Defeat</em>), <em>CloudFlare</em>; <em>Sharktech</em>; <em>OVH Hosting</em>; <em>Microsoft Hosting</em>,<em> Amazon Cloud</em>; <em>Akamai Technologies</em>, etc. </p>
<p>What all these services have in common is that their functionality and profitability depend on their ability to stay online and available for customers' requests. When some of the above-mentioned websites suffer a heavy DDoS attack, they become unreachable to their potential users and/or customers. Any time the service is not available causes a financial loss. Therefore the reason for attacking the above-mentioned type of websites is financial – the potential profit is probably based on the extortion of ransom payments.</p>
<h2><a class="chapter" name="h2-6-conclusion"></a>6. Conclusion</h2>
<p>The number of (trojanized) DDoS tools has escalated quickly since the end of 2013. The potential in devices with undeveloped or no security measures is very attractive for attackers to build botnets. We can also see a variety of projects that wrap the core flooding features. We can expect current bots to be enhanced and even more families to arise in the near future, potentially sharing chunks of already known bots as a consequence of a mixture of available source codes. It's hard to predict whether binaries will display an increased level of polymorphism than just a (modified) UPX compression. For the time being, it seems that malware distributors do not care about AV detection. The security community has started to pay significant attention to these threats.</p>
<h2><a class="chapter" name="h2-acknowledgements"></a>Acknowledgements</h2>
<p>We would like to thank @benkow_, Christian Rebischke (@Sh1bumi), @threat_inc and Lin Song (University of Iowa) for sharing information and samples. Moreover, we thank the following researchers for openly sharing their threat intelligence: @MalwareMustDie, @TekDefense and @da_667.</p>
<h2><a class="chapter" name="h2-references"></a>References</h2>
<p><a class=" anchor" name="ref1"></a>[1] Edwards, Nazario. J. A Survey of Contemporary Chinese DDoS Malware, Virus Bulletin 2011 (Barcelona). <a href="/conference/vb2011/abstracts/survey-chinese-ddos-malware/" target="_blank">https://www.virusbulletin.com/conference/vb2011/abstracts/survey-chinese-ddos-malware/</a>.</p>
<p><a class=" anchor" name="ref2"></a>[2] MalwareMustDie! Tango down report of OP China ELF DDoS'er. September 2014.<br /><a href="http://blog.malwaremustdie.org/2014/09/tango-down-report-of-op-china-elf-ddoser.html" target="_blank">http://blog.malwaremustdie.org/2014/09/tango-down-report-of-op-china-elf-ddoser.html</a>.</p>
<p><a class=" anchor" name="ref3"></a>[3] Kálnai P.; Hořejší J. Chinese Chicken: Multiplatform DDoS botnets, <a href="https://www.botconf.eu/wp-content/uploads/2014/12/2014-2.10-Chinese-Chicken-Multiplatform-DDoS-Botnets.pdf" target="_blank">https://www.botconf.eu/wp-content/uploads/2014/12/2014-2.10-Chinese-Chicken-Multiplatform-DDoS-Botnets.pdf</a>.</p>
<p><a class=" anchor" name="ref4"></a>[4] UPX: the Ultimate Packer for eXecutables. <a href="http://upx.sourceforge.net/" target="_blank">http://upx.sourceforge.net/</a>.</p>
<p><a class=" anchor" name="ref5"></a>[5] Kuzin, M. Versatile DDoS Trojan for Linux. July 2014. <a href="https://securelist.com/analysis/publications/64361/versatile-ddos-trojan-for-linux/" target="_blank">https://securelist.com/analysis/publications/64361/versatile-ddos-trojan-for-linux/</a>.</p>
<p><a class=" anchor" name="ref6"></a>[6] Prolexic. Spike DDoS Toolkit. October 2014.<br /><a href="http://www.prolexic.com/kcresources/prolexic-threat-advisories/prolexic-threat-advisory-spike-ddos-toolkit-botnet/spike-ddos-toolkit-cybersecurity-A4-092414.pdf" target="_blank">http://www.prolexic.com/kcresources/prolexic-threat-advisories/prolexic-threat-advisory-spike-ddos-toolkit-botnet/spike-ddos-toolkit-cybersecurity-A4-092414.pdf</a>.</p>
<p><a class=" anchor" name="ref7"></a>[7] Bohio, M. J. Analysis of a MIPS malware. GIAC, SANS Institute. <a href="https://www.giac.org/paper/grem/2573/analyzing-backdoor-bot-mips-platform/124977" target="_blank">https://www.giac.org/paper/grem/2573/analyzing-backdoor-bot-mips-platform/124977</a>.</p>
<p><a class=" anchor" name="ref8"></a>[8] Prolexic. IptabLes/IptabLex DDoS Bots. September 2014. <a href="http://www.prolexic.com/kcresources/prolexic-threat-advisories/prolexic-ddos-threat-advisory-iptables-iptablex-linux-bots-botnet-cybersecurity/TA-DDos-Binary-Bot-IptabLes-v6-A4.pdf" target="_blank">http://www.prolexic.com/kcresources/prolexic-threat-advisories/prolexic-ddos-threat-advisory-iptables-iptablex-linux-bots-botnet-cybersecurity/TA-DDos-Binary-Bot-IptabLes-v6-A4.pdf</a>.</p>
<p><a class=" anchor" name="ref9"></a>[9] MalwareMustDie! ITW Infection of ELF .IptabLex &amp; .IptabLes China #DDoS bots malware. June 2014. <a href="http://blog.malwaremustdie.org/2014/06/mmd-0025-2014-itw-infection-of-elf.html" target="_blank">http://blog.malwaremustdie.org/2014/06/mmd-0025-2014-itw-infection-of-elf.html</a>.</p>
<p><a class=" anchor" name="ref10"></a>[10] Dr.Web. Linux.Myk.5. <a href="http://vms.drweb.com/virus/?i=4365599" target="_blank">http://vms.drweb.com/virus/?i=4365599</a>.</p>
<p><a class=" anchor" name="ref11"></a>[11] Krebs, B. Lizard Stresser Runs on Hacked Home Routers. January 2015. <a href="https://krebsonsecurity.com/2015/01/lizard-stresser-runs-on-hacked-home-routers/" target="_blank">http://krebsonsecurity.com/2015/01/lizard-stresser-runs-on-hacked-home-routers/</a>.</p>
<p><br /><a class=" anchor" name="ref12"></a>[12] Security Affairs. Hackers target Bash Bug vulnerability in the wild. September 2014.<br /><a href="https://securityaffairs.co/wordpress/28626/cyber-crime/hackers-use-bash-bug.html" target="_blank">http://securityaffairs.co/wordpress/28626/cyber-crime/hackers-use-bash-bug.html</a>.</p>
<p><a class=" anchor" name="ref13"></a>[13] Dr.Web. Linux.BackDoor.Fgt.1. November 2014. <a href="http://vms.drweb.com/virus/?i=4242198" target="_blank">http://vms.drweb.com/virus/?i=4242198</a>.</p>
<p><a class=" anchor" name="ref14"></a>[14] Blasco, J. Attackers exploiting Shellshock (CVE-2014-6721) in the wild. September 2014.<br /><a href="https://www.alienvault.com/open-threat-exchange/blog/attackers-exploiting-shell-shock-cve-2014-6721-in-the-wild#sthash.bzInLhax.dpuf;" target="_blank">https://www.alienvault.com/open-threat-exchange/blog/attackers-exploiting-shell-shock-cve-2014-6721-in-the-wild#sthash.bzInLhax.dpuf;</a>.</p>
<p><a class=" anchor" name="ref15"></a>[15] MalwareMustDie! Fuzzy reversing a new China ELF Linux/XOR.DDoS. September 2014.<br /><a href="http://blog.malwaremustdie.org/2014/09/mmd-0028-2014-fuzzy-reversing-new-china.html" target="_blank">http://blog.malwaremustdie.org/2014/09/mmd-0028-2014-fuzzy-reversing-new-china.html</a>.</p>
<p><a class=" anchor" name="ref16"></a>[16] Kálnai, P. Linux DDoS Trojan hiding itself with an embedded rootkit. January 2015.<br /><a href="https://blog.avast.com/2015/01/06/linux-ddos-trojan-hiding-itself-with-an-embedded-rootkit/" target="_blank">https://blog.avast.com/2015/01/06/linux-ddos-trojan-hiding-itself-with-an-embedded-rootkit/</a>.</p>
<p><a class=" anchor" name="ref17"></a>[17] FireEye. Anatomy of a Brute Force Campaign: The Story of Hee Thai Limited. February 2015. <a href="https://www.fireeye.com/blog/threat-research/2015/02/anatomy_of_a_brutef.html" target="_blank">https://www.fireeye.com/blog/threat-research/2015/02/anatomy_of_a_brutef.html</a>.</p>
<p><a class=" anchor" name="ref18"></a>[18] Level3. It Takes a Village – Collaborative Steps to Breaking Botnets: How Level 3 and Cisco Worked Together to Improve the Internet's Security and Stop SSHPsychos. April 2015. <a href="http://blog.level3.com/security/breaking-botnets-how-level-3-and-cisco-worked-together-to-improve-the-internets-security-and-stop-sshpsychos/" target="_blank">http://blog.level3.com/security/breaking-botnets-how-level-3-and-cisco-worked-together-to-improve-the-internets-security-and-stop-sshpsychos/</a>.</p>
<p><a class=" anchor" name="ref19"></a>[19] Github. An LKM rootkit targeting Linux 2.6/3.x on x86(_64), and ARM. <a href="https://github.com/mncoppola/suterusu" target="_blank">https://github.com/mncoppola/suterusu</a>.</p>
<p><a class=" anchor" name="ref20"></a>[20] Evidence of a DDoS attack. February 2015.<br /><a href="https://gist.github.com/Manawyrm/74e687b2a01527725d33" target="_blank">https://gist.github.com/Manawyrm/74e687b2a01527725d33</a>.</p>
<p><a class=" anchor" name="ref21"></a>[21] ValdikSS. Some tools to monitor BillGates CnC servers. February 2014. <a href="https://github.com/ValdikSS/billgates-botnet-tracker" target="_blank">https://github.com/ValdikSS/billgates-botnet-tracker</a>.</p>
<h2><a class="chapter" name="h2-appendix"></a>Appendix</h2>
<table class="table table-striped" border="0">
<tbody>
<tr>
<td>Elknot Builder</td>
<td>F126C3F8530587F7CADEB8B969BC04AB114B468922171A953211345AD5A8F380</td>
</tr>
<tr>
<td>Elknot Xitele Kit</td>
<td>48183D0DD8DA484639ADDA9F60E5FEA340D7C6B4C77458384EE98CB21972ADE5</td>
</tr>
<tr>
<td>Elknot EM_386</td>
<td>D1F922A762BBD4E0725D4625BE4A39CEBFA03D1875339E9F01F825A2DCDC9E65</td>
</tr>
<tr>
<td>Elknot EM_386 (Setag)</td>
<td>568A52AA9A9AC2698BA7C49FE4A3AEE34D96FE0F25ECCB31FC726D941BB135EA</td>
</tr>
<tr>
<td>Elknot (Setag) UPX</td>
<td>3E89F0D71671DB79506050E0823D121EA5A19457308AF3E379AC45A0338B1B33</td>
</tr>
<tr>
<td>Elknot Script</td>
<td>21ACDA48CAD399B049D03A51A64C9E4BB2DC96C1916BC4EECD6FC828E8036083</td>
</tr>
<tr>
<td>Chinaz EM_386</td>
<td>A86B1899821C2833B989A736E928A4137FA6D0954C9816747F6AFEF536F757F9</td>
</tr>
<tr>
<td>Chinaz EM_x86_64</td>
<td>1EB72C76F79FA01CE39198C91AF5C7A4E36897E9A9A8F5D29CA68BA7371A2361</td>
</tr>
<tr>
<td>Chinaz EM_MIPS</td>
<td>87934D993BB5262FB2826DA05CB4657EC6B20849A65C5D00D260BBF58878F45E</td>
</tr>
<tr>
<td>Chinaz Sources</td>
<td>992ED01DEF5ECE5B90CE242820D2BFDD580FDDDE12DBC10CE5A395A7923922C9</td>
</tr>
<tr>
<td>MrBlack C&amp;C</td>
<td>1828AC46C67E120274688A562D04E9E9A629C39090A848956FB7DB45B6551B74</td>
</tr>
<tr>
<td>MrBlack Builder</td>
<td>E83F69052FC240DC43FC2B32F77408B2B3488E67B29B04041E7C6B8622CE8602</td>
</tr>
<tr>
<td>MrBlack EM_x86_64</td>
<td>F2DF127535902E6390CE2EC198C12A5BD9A361901C2D8008A064DF96EFD10E29</td>
</tr>
<tr>
<td>MrBlack EM_x86_64 UPX</td>
<td>6DD946E821DF59705DCFEB79FAB810336D0EE497FD715FB5B6711E05C0428F4D</td>
</tr>
<tr>
<td>MrBlack EM_386</td>
<td>8766317F20B05C792514ADDD8BB4904021049ACD86E8D70E9FFFD1D12FAD51CE</td>
</tr>
<tr>
<td>MrBlack EM_ARM</td>
<td>26FCBDC7EBE2750B4008D8C67186A9DA03D34B994662BD93E49D7C572AADBAE0</td>
</tr>
<tr>
<td>MrBlack EM_MIPS</td>
<td>736C08988602155954C02CBEF0B4ED3DD916C7EB659032202F15081620058988</td>
</tr>
<tr>
<td>MrBlack Sources</td>
<td>8499E6727253FA98DACC3D753CC08CB207C64A290D9521E94A65C2BDA34F405E</td>
</tr>
<tr>
<td>Aesddos EM_ARM</td>
<td>AF765C0F87846E6E1A184B64A4DA8E51588F0F6A7048FEFDD60B53058373C6B6</td>
</tr>
<tr>
<td>Aesddos EM_386</td>
<td>D6E77D8F2FFDF61981241022E8D7034014927BFFA23793739051CAD34867F766</td>
</tr>
<tr>
<td>Wrkatk EM_386</td>
<td>288D91AF1B5F3A57C0B3D66330F56BBCD38604948B3154CD4842D277FA86F664</td>
</tr>
<tr>
<td>Wrkatk EM_x86_64</td>
<td>0940E4A72DBA133838CCD0992914C5FB2BF106D5A018F289B9C5896C0E237CC6</td>
</tr>
<tr>
<td>Wrkatk EM_MIPS</td>
<td>8A1CE3302E896CD695528EB0CC744EC6E18C1D708C944BE7C8AFFB3B4D44BD5D</td>
</tr>
<tr>
<td>Wrkatk EM_ARM</td>
<td>4ED6E5CFA9D7006E021BBD099AAFD4F2ADAAE3307DC25262E240D9E8829B960D</td>
</tr>
<tr>
<td>Iptablesx Dropper</td>
<td>F41C4C9EE0FBAEFF5397F27531A91135C1D98C54A9E0BDC6CA52315E3E208537</td>
</tr>
<tr>
<td>Iptablesx EM_386</td>
<td>9F89CA6F4580F6EBE021D2C2E2C528B93E4492C4B6E6BD5F339361E86F8585D8</td>
</tr>
<tr>
<td>Sotdas EM_386</td>
<td>E75E49AC157DADC8C4E7230D531BE0DB6FBC339B5D75B7AB8FA6202CE0EC8E2A</td>
</tr>
<tr>
<td>Sotdas EM_x86_64 UPX</td>
<td>59D53A8DFB2B646293E422743EAF8C6F3AB576BACCDF36BB133C4F458AAF60A3</td>
</tr>
<tr>
<td>Xorddos C&amp;C</td>
<td>496F413E6C8B6F258C238AF6EAF61C2B524DC0DC985E4E659627ADAE1ED31517</td>
</tr>
<tr>
<td>Xorddos Script</td>
<td>BA84C056FB4541FE26CB0E10BC6A075585990F3CE3CDE2B49475022AD5254E5B</td>
</tr>
<tr>
<td>Xorddos Uploader</td>
<td>44153031700A019E8F9E434107E4706A705F032898D3A9819C4909B2AF634F18</td>
</tr>
<tr>
<td>Xorddos EM_386</td>
<td>AD26ABC8CD8770CA4ECC7ED20F37B510E827E7521733ECAEB3981BF2E4A96FBF</td>
</tr>
<tr>
<td>Xorddos EM_x86_64</td>
<td>859A952FF05806C9E0652A9BA18D521E57090D4E3ED3BEF07442E42CA1DF04B6</td>
</tr>
<tr>
<td>Xorddos EM_ARM</td>
<td>49963D925701FE5C7797A728A044F09562CA19EDD157733BC10A6EFD43356EA0</td>
</tr>
<tr>
<td>Xorddos Rootkit</td>
<td>6BE322CD81EBC60CFEEAC2896B26EF015D975AD3DDA95AE63C4C7A28B7809029</td>
</tr>
<tr>
<td>Gafgyt Server</td>
<td>2A04C216FCE75D19E5162081EB747B8A77C205F6DD933B0864C08FB086C929C5</td>
</tr>
<tr>
<td>Gafgyt EM_x86_64</td>
<td>BAABCECAC23775FDD3E52CD1FB0E4C46777A6747E854074ECE751767D13F6DD7</td>
</tr>
<tr>
<td>Gafgyt EM_386</td>
<td>28EA6EE1080B4D436685D0D0C87EEF492EA2A376917437E865D0D1513114B8D7</td>
</tr>
<tr>
<td>Gafgyt EM_ARM</td>
<td>67FF5F3F10AD86ED0A9F90244E7B5BE839AFB0AAEB49E22130551A09A0F08FF8</td>
</tr>
<tr>
<td>Gafgyt EM_MIPS</td>
<td>04BEF883E7098FDA9148A75C43165D45AC5FBB8B6032848E9C5D9A5E3897DF52</td>
</tr>
<tr>
<td>Gafgyt EM_PPC</td>
<td>7F13A4C911AB0682D9A7F5988DA9C7BE0AE781CE15945E4C0AA76A78E22CBF2F</td>
</tr>
<tr>
<td>Gafgyt EM_SH</td>
<td>D59C7CF8D9EFBD93F0B907C12BB4C18CC5CE7D800B234DB219D2D919C0B0AFDC</td>
</tr>
<tr>
<td>Gafgyt EM_SPARC</td>
<td>277D2D00E27BCF4536BB492CAC16001E8832DC9BBED384A8C523B49A199790E6</td>
</tr>
<tr>
<td>Gafgyt EM_x86_64</td>
<td>BAABCECAC23775FDD3E52CD1FB0E4C46777A6747E854074ECE751767D13F6DD7</td>
</tr>
<tr>
<td>Gafgyt EM_68K</td>
<td>4E611FB1466920885D1216AB7D9B4F16A3F31D52CF7B39FFC21FC6CA41534738</td>
</tr>
<tr>
<td>Gafgyt Script</td>
<td>8D0B152A91202356B3B5470C5C017B4E9595C5325D8C14DA1DEBBE1782225A14</td>
</tr>
<tr>
<td>Gafgyt Sources</td>
<td>1AF299A269FFDB4461E181CA774FC307A592288AD4B3F6B93226C955EB9B8084</td>
</tr>
</tbody>
</table> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<p><a href="/uploads/pdf/conference/vb2015/KalnaiHorejsi-VB2015.pdf" target="_blank"><img src="/uploads/images/buttons/pdf-download-button.jpg" alt="Download PDF" width="262" height="45" /></a></p>
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=VB2015 paper: DDoS Trojan: A Malicious Concept that Conquered the ELF Format&url=https://www.virusbulletin.com/virusbulletin/2016/06/vb2015-paper-ddos-trojan-malicious-concept-conquered-elf-format"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2016/06/vb2015-paper-ddos-trojan-malicious-concept-conquered-elf-format'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2016/06/vb2015-paper-ddos-trojan-malicious-concept-conquered-elf-format&title=VB2015 paper: DDoS Trojan: A Malicious Concept that Conquered the ELF Format"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2016/06/vb2015-paper-ddos-trojan-malicious-concept-conquered-elf-format&t=VB2015 paper: DDoS Trojan: A Malicious Concept that Conquered the ELF Format"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2016/06/vb2015-paper-ddos-trojan-malicious-concept-conquered-elf-format"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p> </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>

</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">©1989-2022 Virus Bulletin.        <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>        <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>        <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>