Scalable Infrastructure vs Large Problems, or OpenDNS vs Conficker

Get link

Facebook

Twitter

Pinterest

Email

Other Apps

March 30, 2009

After seeing Dan Kaminsky's talk at Black Hat DC last month, I blogged about the benefits of DNS' ability to scale to address big problems like asset management records.  I've avoid talking about Conficker (except for yesterday) since it's all over the media.  Why mention DNS and Conficker in the same post?  All of the commotion about Conficker involves one variant's activation of a new domain generation algorithm on 1 April.  Until today no one had publicly announced the reverse engineering of the algorithm, but right now you can download a list of 50,014 domains that one Conficker variant will select from when trying to phone home starting 1 April.  Some of the domains appear to be pre-empted:$ whois aadqnggvc.com.ua% This is the Ukrainian Whois query server #B.% Rights restricted by copyright.%% % .UA whois% Domain Record:% =============domain:     aadqnggvc.com.uaadmin-c:    CCTLD-UANICtech-c:     CCTLD-UANICstatus:     FROZEN-OK-UNTIL 20090701000000dom-public: NOmnt-by:     UARR109-UANIC (ua.admin)remark:     blocked according to administrator decisionchanged:    CCTLD-UANIC 20090320144409source:     UANICOthers appear ready for registration:~$ whois aafkegx.co.uk    No match for "aafkegx.co.uk".    This domain name has not been registered.    WHOIS lookup made at 00:56:31 31-Mar-2009Keep in mind that another 50,000 domains will be generated on 2 April, and so on.  With such a big problem, what could we do to contain this malware?OpenDNS is a possible answer:OpenDNS has kept our users safe from Conficker for the past several months by blocking the domains it uses to phone home...The latest variant of Conficker is now churning through 50,000 domains per day in an attempt to thwart blocking attempts. Consider this: at any given time we have filters that hold well over 1,000,000 domains (when you combine our phishing and domain tagging filters). 50,000 domains a day isn’t going to rock the boat.So here’s our update: OpenDNS will continue to identify the domains, all 50,000, and block them from resolving for all OpenDNS users. This means even if the virus has penetrated machines on your network, its rendered useless because it cannot connect back to the botnet.That's one advantage of outsourcing your Internet DNS to a third party.  They have the resources to integrate the latest threat intelligence and the position to do something to protect users.  This is a great example of scalable infrastructure (DNS) vs large problems (Conficker).  Finally, you've probably heard about the Conficker Know Your Enemy paper and associated upgraded scanning tools, like Nmap 4.85BETA5 and the newest Nessus check.  I can't wait to see the results of tools like this.  It could mark one of the first times we could fairly easily generate a statistic for the percentage of total assets compromised, similar to steps 8 and 9 from my 2007 post Controls Are Not the Solution to Our Problem.  In other words, you can scan for Conficker and determine one score of the game -- the percentage of hosts compromised by one or more Conficker variants.  The question is, how long until those controlling Conficker update the code to resist these remote, unauthenticated scans?Richard Bejtlich is teaching new classes in Europe and Las Vegas in 2009.  Online Europe registration ends by 1 Apr, and seats are filling.  Early Las Vegas registration ends 1 May.
