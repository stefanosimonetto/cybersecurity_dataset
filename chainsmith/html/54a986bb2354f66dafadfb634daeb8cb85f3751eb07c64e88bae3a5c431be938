<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: Star what?</title>
<meta name="description" content="A macro virus for StarOffice, or merely an intended? Vesselin Bontchev sets the record straight." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 2669;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/remo_expand/blocks/remo_expand/templates/vbexpand/view.css" />
<script type="text/javascript" src="/packages/remo_expand/js/jquery.color.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/remo.expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<div class="titlepage" xmlns=""><div><div><h1 class="title" xmlns="http://www.w3.org/1999/xhtml"><a id="vb200608-stardust"></a>Star what?</h1></div><div><p class="pubdate" xmlns="http://www.w3.org/1999/xhtml">2006-08-01</p></div><div><div class="authorgroup" xmlns="http://www.w3.org/1999/xhtml"><div class="author titlepage"><h3 class="author"><span class="firstname">Dr Vesselin</span> <span class="surname">Bontchev</span></h3><span class="orgname">FRISK Software International</span>, <span class="orgdiv">Iceland</span></div><b class="editedby">Editor: </b><span class="editor"><span class="firstname">Helen</span> <span class="surname">Martin</span></span></div></div><div><div class="abstract" xmlns="http://www.w3.org/1999/xhtml"><p class="title"><b>Abstract</b></p><p>A macro virus for StarOffice, or merely an intended? Vesselin Bontchev sets the record straight.</p></div></div><div><p class="copyright" xmlns="http://www.w3.org/1999/xhtml"><i>Copyright &copy; 2006 Virus Bulletin</i></p></div></div><hr /></div>
<div class="ccm-remo-expand">
<div id="ccm-remo-expand-title-4940" class="ccm-remo-expand-title ccm-remo-expand-closed" data-expander-speed="200">Table of contents</div><div id="ccm-remo-expand-content-4940" class="ccm-remo-expand-content"><div class="toc"><dl><dt><span class="sect1"><a href="#id3363421">Introduction</a></span></dt><dt><span class="sect1"><a href="#id2348093">Not another first</a></span></dt><dt><span class="sect1"><a href="#id3677174">Amazing incompetence</a></span></dt><dt><span class="sect1"><a href="#id3563641">Stage three</a></span></dt><dt><span class="sect1"><a href="#id4114192">The name of the weed</a></span></dt><dt><span class="sect1"><a href="#id4644881">Conclusion</a></span></dt></dl></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3363421"></a>Introduction</h2></div></div></div><p>On 30 May 2006, a short message appeared on the <em class="phrase">Kaspersky Lab</em> web log [<span class="citation"><a href="#citation.1">1</a></span>], announcing the appearance of a new macro virus for StarOffice. The log read:</p><p>&#39;<span class="emphasis"><em>I came across something interesting today, a macro virus which we&#39;ve named Virus.StarOffice.Stardust.a ... But if you look more closely at the name, you can see why I&#39;m interested: Stardust is a macro virus written for StarOffice, the first one I&rsquo;ve seen. Macro viruses usually infect MS Office applications.&#39;</em></span></p><p>Now, we all know that anti-virus researchers all over the world are overloaded by the continuous glut of new malware and that the constant stress can cause them to make mistakes. And in such a quick-and-dirty publication as a blog, one cannot expect the author to have done extensive research and fact-finding before posting such a short message. Still, how many mistakes can be found in the message above? </p><p>To begin with, the name StarOffice is unnecessarily restrictive. <em class="productname">StarOffice</em> is the name of a commercial product manufactured by <em class="phrase">SUN</em> and based on the code base of <em class="productname">OpenOffice</em> &ndash; an open source product [<span class="citation"><a href="#citation.2">2</a></span>]. Any malware supposedly written for <em class="productname">StarOffice</em> would work under <em class="productname">OpenOffice</em> too.</p><p>Second, <em class="productname">OpenOffice</em> is too generic to be used as a proper malware platform name. According to the CARO Malware Naming Scheme [<span class="citation"><a href="#citation.3">3</a></span>], one should use either the language in which the malware is written (i.e. StarBasic in this case) or the application for which the virus is specific (e.g. <em class="productname">StarWriter</em>). </p><p>Almost half a decade ago, the author of this article did some research into the &#39;virusability&#39; of this platform. Back then, <em class="productname">OpenOffice</em> supported a single macro language, called StarBasic, which was somewhat reminiscent of VBA but the two languages were not compatible. OpenOffice was able to open <em class="productname">Microsoft Office</em> documents &ndash; including documents that contained macros &ndash; but during the conversion process the macros were simply stripped from the document. In addition, StarBasic did not seem to have the concept of &#39;self&#39; &ndash; it didn&#39;t seem possible for a StarBasic macro to say &#39;copy myself from here to there&#39;. </p><p>Of course, that did not mean that viruses for the platform were impossible. The language was powerful enough to implement several kinds of them without the capability of copying macros from one document to another. For instance, it was possible to implement mass-mailers, it was possible to implement overwriters, and it was possible to implement viruses that copied the data of the target document to themselves and then overwrote that document &ndash; pretty much like the Jinni.A virus does in <em class="productname">MS Excel</em> [<span class="citation"><a href="#citation.4">4</a></span>]. <em class="productname">OpenOffice</em> also conveniently allowed any macro subroutine to be attached to any event &ndash; such as a menu selection or a keypress. Still, it didn&#39;t seem likely that such viruses would have a significant chance of spreading and becoming a problem.</p><p>Sadly, things have &#39;improved&#39; a bit since then. Nowadays, <em class="productname">OpenOffice</em> supports several different languages: StarBasic, BeanShell, Python and JavaScript. They are all script languages, however &ndash; not macro languages &ndash; which leads us to another error in the original announcement. Whatever the new thing was, it couldn&#39;t have been a macro virus; at best, it was a script virus.</p><p>In addition, the StarBasic language has become much more powerful too. We became aware long ago that full-featured viruses for it were possible; see for instance [<span class="citation"><a href="#citation.5">5</a></span>]. So, the news that someone had, supposedly, finally written a virus for it was hardly a surprise. For more information, though, we needed to analyse a sample.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id2348093"></a>Not another first</h2></div></div></div><p>The sample arrived in an archive containing three files. One of them was in a subdirectory named &#39;Dropper&#39;, so it was assumed that this contained the first generation of the virus. The other two were, supposedly, infected documents.</p><p>The files that contained the samples all had the SXW extension &ndash; in other words, they were <em class="productname">StarWriter</em> documents. Initially, we did not enjoy the prospect of having to reverse-engineer yet another undocumented file format (we have had more than enough undocumented file formats used by the various <em class="phrase">Microsoft</em> products), but then we remembered that <em class="productname">OpenOffice</em> uses a different concept. The format really is open &ndash; the &#39;document&#39; is essentially a ZIP archive, containing various XML files in various subdirectories. Indeed the idea is so good that <em class="phrase">Microsoft</em>, allegedly, intends to steal/borrow/innovate it in the next version of <em class="productname">Office</em>.</p><p>So, it really is easy to take apart the contents of an <em class="productname">OpenOffice</em> document. It took us just a few seconds to find the XML file that contained the &#39;macro virus&#39; code.</p><p>Now, the author of this article does not claim to be a StarBasic expert, but things started looking fishy to him immediately. The code contained three subroutines: AutoInstall, mygame and InstallGlobalModule. The first of these just called the second. This already looked strange, because &#39;AutoInstall&#39; is not a special subroutine name in StarBasic (e.g. as &#39;AutoOpen&#39; is in WordBasic or &#39;Auto_Open&#39; is <em class="productname">Excel</em>&#39;s version of VBA). But let&#39;s assume that the subroutine does manage to get invoked somehow &ndash; perhaps by having been attached to a frequently-called event or something. </p><p>The next problem was in the subroutine mygame. It began with the comments: </p><pre class="programlisting">&amp;apos;*******************************
&amp;apos;******* OOo.Stardust  *********
&amp;apos;*** (c)by Necronomikon[DCA] ***
&amp;apos;*******************************</pre><p>and ended with what appears to be a call to InstallGlobalModule:</p><pre class="programlisting">&amp;apos; InstallGlobalModule()</pre><p>One does not have to be a StarBasic expert to realize that there is no way the above could work.</p><p>As is obvious from the first few lines, the sequence &#39;&amp;apos;&#39; is clearly a comment &ndash; a notion supported by the fact that it resolves to the &#39; (apostrophe) character in XML and in most Basic dialects this character is used to indicate that what follows (until the end of the line) is comment. So the call to the InstallGlobalModule subroutine (which seemed to contain the bulk of replication code) is commented out &ndash; i.e. the replication is never invoked.</p><p>A discussion with some other CARO members (e.g. [<span class="citation"><a href="#citation.6">6</a></span>]) confirmed that the thing was unable to replicate &ndash; i.e. it was not a virus, but an intended. Here we have another error in the original announcement, which claims that it is a virus. Admittedly the announcement also said &#39;Stardust is the first virus ... which is theoretically capable of infecting <em class="productname">StarOffice</em>&hellip;&#39;, so it could be argued that it was talking about a potential virus, not a real virus. However, the rest of the announcement quite unambiguously calls the thing a virus and it never states explicitly that the malicious code simply doesn&#39;t work.</p><p>As we shall see in the next section though, <em class="phrase">Kaspersky Lab</em> was far from alone in making this mistake.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3677174"></a>Amazing incompetence</h2></div></div></div><p>The alleged author of this thing, a malware writer who uses the handle &#39;Necronomikon&#39;, is well known to us from the macro malware world. Well known for his incompetence and ineptitude, that is. He is the author of several macro intendeds, like Delay.A, Gamor.A, Hilite.A, Hilite.B, Hilite.C and Hilite.G.</p><p>For those who came late to the party, an intended is a program written with the obvious intent to make a virus, but which is too buggy to replicate. It&#39;s a double joke on its author &ndash; not only was he too incompetent to create a working virus (a rather trivial task, especially in the macro and script worlds), but was also stupid enough to release it without trying to run it (otherwise he would have noticed that it doesn&#39;t work).</p><p>But the commented-out call to the replication routine is not the only problem for this piece of malicious code. Even if the comment is removed, it cannot be made to work. The observant reader would notice that the subroutine is then invoked without any parameters. But the declaration of this subroutine, just a few lines below, clearly indicates that it is supposed to take one mandatory and two optional arguments:</p><pre class="programlisting">Sub InstallGlobalModule( ByVal cGlobalLibName As String,_
  Optional cDocumentLibName,_
  Optional stardust )</pre><p>The code after that relies on the presence of the first argument and tries to take some reasonable action if the two optional ones are missing:</p><pre class="programlisting">If IsMissing( cDocumentLibName ) Then
   cDocumentLibName = cGlobalLibName
 EndIf
 If IsMissing( stardust ) Then
      InstallGlobalModule2( cGlobalLibName, cDocumentLibName, BASIC_MODULE
 )
      InstallGlobalModule2( cGlobalLibName, cDocumentLibName, DIALOG_MODULE
 )
 Else</pre><p>Apparently, the subroutine is supposed to perform some kind of generic module-copying function and to copy a given module to different places, depending on how the subroutine is invoked. But since it is never invoked correctly, we can&#39;t know that for sure. It looks as if the malware author has taken this subroutine from somewhere without really understanding what exactly it is supposed to do and how it is supposed to be called.</p><p>But it gets even worse. Apparently, the procedure InstallGlobalModule2 is not part of the standard <em class="productname">OpenOffice</em> installation [<span class="citation"><a href="#citation.7">7</a></span>] &ndash; and it is not present anywhere in the code of the &#39;virus&#39;, either. So, even if the replication function had been invoked correctly, it would fail to work because it refers to a non-existent subroutine.</p><p>The code immediately after the one quoted above also calls a function named &#39;DoesModuleExist&#39; &ndash; which is not part of the standard <em class="productname">OpenOffice</em> installation either, and the implementation of which cannot be found anywhere in the code of the sample we received.</p><p>In other words, there was absolutely no way the code we were looking at could be a virus. It didn&#39;t just have some trivial bug that could be fixed, either &ndash; it looked more like a random collection of code, whose author didn&#39;t really understand what that code was supposed to do.</p><p>Then we turned our attention to the so-called &#39;dropper&#39;. Maybe, we thought, the dropper has the capability to infect documents once, but the code is incapable of propagating for more than one generation &ndash; e.g. because some important part of it isn&#39;t copied around after the first time. However, even a cursory inspection of the code of the &#39;dropper&#39; proved that this couldn&#39;t be the case. Furthermore, there was absolutely no way the &#39;dropper&#39; could have produced the code in the other two samples.</p><p>When comparing the code of the &#39;dropper&#39; with that of the other two samples, we discovered only two differences. One of them was that they began with two different sets of declarations. The &#39;dropper&#39; begins with:</p><pre class="programlisting">Dim lAutoInstall as Boolean
Dim Url As String
  dim myFileProp as Object</pre><p>while the code in the &#39;samples&#39; begins with:</p><pre class="programlisting">Const GLOBAL_LIBRARY = True
Const DOCUMENT_LIBRARY = False
Const DIALOG_MODULE = True
Const BASIC_MODULE = False
Dim lAutoInstall as Boolean</pre><p>Now, there is no obvious reason why the code should change like this. There are no operators that attempt to modify these lines at the beginning. However, in VBA, the source of the module often begins with a series of attribute statements. These don&#39;t generate any p-code and can change when a module copies itself from a document to the global template (as well as under several other circumstances), so we decided to give this difference the benefit of the doubt &ndash; maybe it was produced automatically somehow by <em class="productname">OpenOffice</em>.</p><p>The second difference, however, was clearly put there by the malware author and there was absolutely no reasonable explanation for its absence in the supposed replicants. The difference is that just before the commented-out call to InstallGlobalModule, the &#39;dropper&#39; contains the following lines:</p><pre class="programlisting">otext=oDocument.text
ocursor=otext.createtextcursor()
otext.insertString(ocursor, &amp;quot;***Stardust***(c)by
Necronomikon[DCA]&amp;quot;,false)
url=converttourl(&amp;quot;http://stardustvx.tripod.com/SilviaSaint.JPG&amp;quot;)
&amp;apos;nice idea from Slagehammer... ;)
oDocument = StarDesktop.loadComponentFromURL(url, &amp;quot;_blank&amp;quot;, 0,
myFileProp() )</pre><p>These lines attempt to download a file and to display it on the desktop. Since there was no obvious reason for their absence in the replicants, the only reasonable conclusion was that, in reality, we weren&#39;t looking at a dropper and replicants of the virus it drops &ndash; we were looking at two different variants of non-viral malware.</p><p>Now, one incompetent malware author is hardly a surprise &ndash; among them, ineptitude is rather the rule than the exception. What is surprising, however, is how many supposedly competent anti-virus companies believed his claims and described these two different things as a single virus for <em class="productname">OpenOffice</em>.</p><p>&#39;The Stardust virus doesn&#39;t appear to work very well&#39;, says <em class="phrase">Sophos</em>&#39;s Graham Cluley [<span class="citation"><a href="#citation.8">8</a></span>]. &#39;Not very well&#39;, huh? How about not at all?</p><p>&#39;We have a sample of a proof-of-concept macro-virus for OpenOffice.org&#39;, writes <em class="phrase">F-Secure</em>&#39;s Sean in the company&#39;s blog [<span class="citation"><a href="#citation.9">9</a></span>]. OpenOffice.org is a website and this thing is neither macro, nor a virus. It&#39;s an intended script.</p><p>&#39;Type: virus&#39; has been written by a researcher from <em class="phrase">CA</em> in their description of this thing [<span class="citation"><a href="#citation.10">10</a></span>]. Nope, it ain&#39;t.</p><p>&#39;SB.Stardust.A!int is a proof-of-concept macro virus for <em class="productname">Sun StarOffice</em> documents&#39;, according to <em class="phrase">Symantec</em>&#39;s description [<span class="citation"><a href="#citation.11">11</a></span>]. It&#39;s not a virus, folks! Well, at least <em class="phrase">Symantec</em> gets points for appending &#39;int&#39; at the end of the name, suggesting that it&#39;s an intended. But why not say so clearly in the description? (<em class="phrase">McAfee</em> uses a similar approach &ndash; &#39;.intd&#39; is used in the name, but the author of the description is shy of stating clearly that the thing doesn&#39;t really work at all.)</p><p>&#39;It is the first time that the experts detected a macro virus called &quot;Stardust&quot; in Internet, which takes advantage of the Office-Suite <em class="productname">OpenOffice</em> for its attack. The moment the user opens the document template, the script that was written in StarBasic will infect all the following documents&#39;, claim the researchers from <em class="phrase">Avira</em> [<span class="citation"><a href="#citation.12">12</a></span>]. Guys, your so-called &#39;experts&#39; aren&#39;t.</p><p><em class="phrase">SoftWin</em>&#39;s scanner calls the thing &#39;Worm.StarOffice.Stardust.A&#39;. A worm? Now, I know that the experts can never agree on the exact definition of a worm, but it certainly isn&#39;t a horribly buggy piece of non-working code that doesn&#39;t even run, or replicate, let alone replicate over networks. </p><p>Researchers at <em class="phrase">Trend Micro</em>, seemingly, couldn&#39;t make up their minds about what the thing really does [<span class="citation"><a href="#citation.13">13</a></span>]. On the one hand, their description says: &#39;Once an infected document is opened, it downloads and opens an image of an actress from a certain website. It then proceeds to infect other StarOffice/OpenOffice Suites document files&#39;, which is clearly false. But then it adds: &#39;However, due to some errors in its code, it cannot perform its infection routine&#39;. Good job! But why, then, does the description state: &#39;In the wild: Yes&#39;? In the wild? No way! In the wild imagination of the journalists, maybe. </p><p>Doesn&#39;t anyone analyse the virus samples they receive these days? </p><p>And that&#39;s just the anti-virus companies &ndash; the ones that are supposed to know better. What can we say about the popular computer press that has never been distinguished with competence in this (or, for that matter, any other) area? As anticipated, <em class="citetitle">PCWorld</em>, <em class="citetitle">ZDNet</em>, <em class="citetitle">News.com</em>, <em class="citetitle">InfoWorld</em>, and all the rest have jumped on the &#39;&lsquo;Stardust virus lands on <em class="productname">OpenOffice</em>&#39; bandwagon.</p><p>In fact, even the official response of <em class="phrase">OpenOffice.org</em> to this &#39;threat&#39; [<span class="citation"><a href="#citation.14">14</a></span>] refers to it as a virus. Although the statement reads: &#39;technically, it is not even a virus, as it is not self-replicating&#39;, it also goes on to say &#39;with OpenOffice.org&#39;s default settings, it cannot spread without user intervention&#39;. Folks, the only kind of user intervention that would make this thing spread would be taking the module it resides in and copying it manually elsewhere. </p><p>But, with that kind of user intervention, even the &#39;Hello world&#39; macro is a virus. One would have hoped that at least the guys at <em class="phrase">OpenOffice.org</em> are capable of reading and understanding StarBasic &ndash; but apparently not.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3563641"></a>Stage three</h2></div></div></div><p>At this stage, a private communication [<span class="citation"><a href="#citation.15">15</a></span>] from Gabor Szappanos turned my attention to the fact that the author of this malware seems to have borrowed the InstallGlobalModule subroutine from a publicly available package of macros [<span class="citation"><a href="#citation.16">16</a></span>].</p><p>Indeed, if you look inside this package, you will find not only the InstallGlobalModule subroutine but also implementations of the missing InstallGlobalModule2 and DoesModuleExist. It became clear that the author of the thing had found this library, and had worked out that it seems to have the ability to copy modules from place to place, but that he had been unable to understand how it works exactly, and why. </p><p>The malware author has tried to copy the relevant parts from the library, but since he was unable to determine which parts are relevant and how they are supposed to be used, he has messed up. Badly. Being an impatient kid, however (aren&#39;t they all?), he has rushed to send his creation to all the anti-virus companies in order to get his 15 minutes of fame. And he has received more fame than he deserved, mostly due to the incompetence of the popular media and of said anti-virus companies.</p><p>But, apparently, the author of this malware had a nagging feeling that his creation wasn&#39;t quite perfect (to say the least). So, he continued to &#39;improve&#39; it and has released yet another (third) variant. Unfortunately, he forgot, once again, to test whether the thing actually works &ndash; or at least to read the documentation of StarBasic &ndash; because the third variant is again an intended.</p><p>The main difference this time is that the author has also lifted the function DoesModuleExist from the public macro library mentioned above. He has also changed all calls to InstallGlobalModule2 to just InstallGlobalModule &ndash; because he still hasn&#39;t taken the former subroutine from the macro library. Unfortunately, these calls are all inside a subroutine named InstallGlobalModule too &ndash; which would normally lead to infinite recursion and a crash. If that subroutine was called at all, that is. Because it isn&#39;t. There isn&#39;t even a commented-out call &ndash; nothing at all.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4114192"></a>The name of the weed</h2></div></div></div><p>So we still don&#39;t have any viruses for <em class="productname">OpenOffice</em>, no matter what the hysterical media and the incompetent anti-virus companies are claiming. Still, we do have some malware for it (three intended variants), so we needed a name for the platform in the CARO Malware Naming Scheme, as well as a family name for the trinity of variants.</p><p>Strictly speaking, StarBasic is a script &ndash; not a macro language, since it is just ASCII text and is not tokenized or compiled in any way. So, we felt that StarBasicScript (or SBS for short) would be the proper platform name. However, in the name of brevity, we decided to use just StarBasic (or SB for short) instead.</p><p>As for the family name, there were proposals for &#39;Bulldust&#39; or &#39;Dustar&#39;, but the name &#39;Stardust&#39; &ndash; picked by the malware author &ndash; was so widely hyped by the media, that we decided to go with it, in order to avoid additional naming confusion.</p><p>So, the full names of the three variants are:</p><div class="itemizedlist"><ul type="disc"><li><p>intended://StarBasic/Stardust.A</p></li><li><p>intended://StarBasic/Stardust.B</p></li><li><p>intended://StarBasic/Stardust.C</p></li></ul></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4644881"></a>Conclusion</h2></div></div></div><p><em class="productname">OpenOffice</em> is a virusable platform &ndash; it is perfectly possible to write a virus for it. At the time of writing this article (June 2006), there were only three non-working attempts at a virus written by somebody who obviously has more time than brains <a href="#citation.17">17</a>.</p><p>Considering this, we would suggest that &#39;Necronomikon&#39; changes his handle to &#39;Necromoron&#39; &ndash; from the Greek necros (&#39;dead&#39; &ndash; as in &#39;brain-dead&#39;) and the English moron (&#39;dolt&#39;). We feel that the latter handle reflects his mental abilities more aptly.</p><div class="bibliography"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id3229758"></a>Bibliography</h3></div></div></div><div class="bibliomixed"><a id="citation.1"></a><p class="bibliomixed">[1] Stardust &ndash; a macro curiosity. <span class="bibliosource"><a href="http://www.viruslist.com/en/weblog?weblogid=187738337" target="_blank">http://www.viruslist.com/en/weblog?weblogid=187738337</a></span>.</p></div><div class="bibliomixed"><a id="citation.2"></a><p class="bibliomixed">[2] StarOffice FAQ, Question #13, available from <span class="bibliosource"><a href="http://www.sun.com/software/star/staroffice/faqs/technical.jsp#q_13" target="_blank">http://www.sun.com/software/star/staroffice/faqs/technical.jsp#q_13</a></span>.</p></div><div class="bibliomixed"><a id="citation.3"></a><p class="bibliomixed">[3] Current Status of the CARO Malware Naming Scheme, available from <span class="bibliosource"><a href="http://www.people.frisk-software.com/~bontchev/papers/naming.html" target="_blank">http://www.people.frisk-software.com/~bontchev/papers/naming.html</a></span>.</p></div><div class="bibliomixed"><a id="citation.4"></a><p class="bibliomixed">[4] Bontchev V. The Three Faces of VBA &ndash; Part 2. <span class="citetitle"><em class="citetitle">Virus Bulletin</em></span>, February 2005, pp. 4&ndash;6.</p></div><div class="bibliomixed"><a id="citation.5"></a><p class="bibliomixed">[5] Rautiainen S. OpenOffice Security. <span class="citetitle"><em class="citetitle">Proceedings of the 13th Virus Bulletin Conference</em></span>, 2003, pp. 51&ndash;57.</p></div><div class="bibliomixed"><a id="citation.6"></a><p class="bibliomixed">[6] Raiu C. Kasperksy Lab. Personal communication.</p></div><div class="bibliomixed"><a id="citation.7"></a><p class="bibliomixed">[7] FitzGerald N. Personal communication.</p></div><div class="bibliomixed"><a id="citation.8"></a><p class="bibliomixed">[8] First virus for StarOffice poses no serious threat. <span class="bibliosource"><a href="https://www.sophos.com/pressoffice/news/articles/2006/05/stardust.html" target="_blank">http://www.sophos.com/pressoffice/news/articles/2006/05/stardust.html</a></span>.</p></div><div class="bibliomixed"><a id="citation.9"></a><p class="bibliomixed">[9] OpenOffice and Ziggy Stardust. <span class="bibliosource"><a href="http://www.f-secure.com/weblog/#00000893" target="_blank">http://www.f-secure.com/weblog/#00000893</a></span>.</p></div><div class="bibliomixed"><a id="citation.10"></a><p class="bibliomixed">[10] <span class="bibliosource"><a href="http://www3.ca.com/securityadvisor/virusinfo/virus.aspx?id=56047" target="_blank">http://www3.ca.com/securityadvisor/virusinfo/virus.aspx?id=56047</a></span>.</p></div><div class="bibliomixed"><a id="citation.11"></a><p class="bibliomixed">[11] <span class="bibliosource"><a href="https://www.symantec.com/avcenter/venc/data/sb.stardust.a!int.html" target="_blank">http://www.symantec.com/avcenter/venc/data/sb.stardust.a!int.html</a></span>.</p></div><div class="bibliomixed"><a id="citation.12"></a><p class="bibliomixed">[12] OpenOffice is vulnerable &ndash; Avira warns against the first macro virus. <span class="bibliosource"><a href="http://www.avira.com/en/security_news/openoffice_is_vulnerable_-_avira_warns_against_the_first_macro_virus.html" target="_blank">http://www.avira.com/en/security_news/openoffice_is_vulnerable_-_avira_warns_against_the_first_macro_virus.html</a></span>.</p></div><div class="bibliomixed"><a id="citation.13"></a><p class="bibliomixed">[13] XML_DUSTAR.A. <span class="bibliosource"><a href="https://www.trendmicro.com/vinfo/virusencyclo/default5.asp?VName=XML_DUSTAR.A" target="_blank">http://www.trendmicro.com/vinfo/virusencyclo/default5.asp?VName=XML_DUSTAR.A</a></span>.</p></div><div class="bibliomixed"><a id="citation.14"></a><p class="bibliomixed">[14] Statement on the Proof of Concept Macro Virus. <span class="bibliosource"><a href="https://www.openoffice.org/press/statement-proof-of-concept-virus.html" target="_blank">http://www.openoffice.org/press/statement-proof-of-concept-virus.html</a></span>.</p></div><div class="bibliomixed"><a id="citation.15"></a><p class="bibliomixed">[15] Szappanos G. VirusBuster. Personal communication.</p></div><div class="bibliomixed"><a id="citation.16"></a><p class="bibliomixed">[16] Library Installer. <span class="bibliosource"><a href="http://kosh.datateamsys.com/~danny/OOo/Experiments/obsolete/LibraryInstaller-2004-03-09-01.sxd" target="_blank">http://kosh.datateamsys.com/~danny/OOo/Experiments/obsolete/LibraryInstaller-2004-03-09-01.sxd</a></span>.</p></div><div class="bibliomixed"><a id="citation.17"></a><p class="bibliomixed">[17] <span class="citetitle"><em class="citetitle">While this article was being prepared for publication, a real working virus for the <em class="productname">OpenOffice</em> platform appeared &ndash; SB/Starbugs.A. It is written by a different, less inept virus writer and works under all <em class="productname">OpenOffice</em> applications that can run <em class="productname">StarBasic</em></em></span>.</p></div></div></div> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=Star what?&url=https://www.virusbulletin.com/virusbulletin/2006/08/star-what"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2006/08/star-what'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2006/08/star-what&title=Star what?"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2006/08/star-what&t=Star what?"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2006/08/star-what"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p> </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">©1989-2022 Virus Bulletin.        <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>        <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>        <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>