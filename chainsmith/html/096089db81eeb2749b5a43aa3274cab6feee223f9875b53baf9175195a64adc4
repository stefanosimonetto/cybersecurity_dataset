<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: Cut the Cutwail</title>
<meta name="description" content="After playing the cat-and-mouse game with AV companies for several months, the author(s) of Pushdo/Cutwail finally decided to change their advanced installer, in doing so changing the communication mechanism between the servers and bots. Kyle Yang reveals the details of the new protocol." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 2143;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/remo_expand/blocks/remo_expand/templates/vbexpand/view.css" />
<script type="text/javascript" src="/packages/remo_expand/js/jquery.color.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/remo.expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<div class="titlepage" xmlns=""><div><div><h1 class="title" xmlns="http://www.w3.org/1999/xhtml"><a id="vb201002-cut-the-cutwail"></a>Cut the Cutwail</h1></div><div><p class="pubdate" xmlns="http://www.w3.org/1999/xhtml">2010-02-01</p></div><div><div class="authorgroup" xmlns="http://www.w3.org/1999/xhtml"><div class="author titlepage"><h3 class="author"><span class="firstname">Kyle</span> <span class="surname">Yang</span></h3><span class="orgname">Fortinet</span>, <span class="orgdiv">USA</span></div><b class="editedby">Editor: </b><span class="editor"><span class="firstname">Helen</span> <span class="surname">Martin</span></span></div></div><div><div class="abstract" xmlns="http://www.w3.org/1999/xhtml"><p class="title"><b>Abstract</b></p><p>After playing the cat-and-mouse game with AV companies for several months, the author(s) of Pushdo/Cutwail finally decided to change their advanced installer, in doing so changing the communication mechanism between the servers and bots. Kyle Yang reveals the details of the new protocol.</p></div></div><div><p class="copyright" xmlns="http://www.w3.org/1999/xhtml"><i>Copyright &copy; 2010 Virus Bulletin</i></p></div></div><hr /></div>
<div class="ccm-remo-expand">
<div id="ccm-remo-expand-title-3686" class="ccm-remo-expand-title ccm-remo-expand-closed" data-expander-speed="200">Table of contents</div><div id="ccm-remo-expand-content-3686" class="ccm-remo-expand-content"><div class="toc"><dl><dt><span class="sect1"><a href="#id4644879"></a></span></dt><dt><span class="sect1"><a href="#id3988516">When and why it changed</a></span></dt><dt><span class="sect1"><a href="#id3624633">What changed</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id3291937">Sending random encryption/decryption key to the server</a></span></dt><dt><span class="sect2"><a href="#id4525900">Sending bot and loader info to the server</a></span></dt><dt><span class="sect2"><a href="#id4884154">Retrieving other components</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id2309055">Fuzzing Pushdo botnet request packet</a></span></dt><dt><span class="sect1"><a href="#id3540385">Detection</a></span></dt></dl></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4644879"></a></h2></div></div></div><p>After playing the cat-and-mouse game with AV companies for several months, the author(s) of Pushdo/Cutwail finally decided to change their advanced installer &ndash; previously codenamed &lsquo;Siberia&rsquo; (as per the project name extracted from debugging strings in the binary) &ndash; to a brand new piece codenamed &lsquo;Revolution&rsquo;. The changes mainly concern the communication mechanism between the servers and bots. More specifically, the mechanism changed from a direct communication mode using the HTTP GET method (single packet request) to a sophisticated two-way communication mode between servers and bots. In this paper, we will reveal the details of this new protocol.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3988516"></a>When and why it changed</h2></div></div></div><p>As far as we know, the Cutwail spam botnet used to seed its own executable, which usually came without an obfuscation layer. Then, around the end of October 2009, Cutwail began to seed Pushdo binaries via the infamous DHL/UPS email seeding campaign. This time it came with an obfuscation layer in order to dodge AV detection. Among the binaries was a new version string, codenamed &lsquo;Revolution6&rsquo; &ndash; possibly indicating six major updates. Previously, this number only reached two (&lsquo;Siberia2&rsquo;) &ndash; which suggests that the author(s) may have spent more time on this major update. On reversing its binary, we found that the author(s) had put a tremendous amount of work into the communication protocol, which is now both more complex and robust, and of course stealthier than the previous one (thanks to a custom packer made from a custom stub and UPX). As for what drove this change, it must certainly have something to do with the fact that the Pushdo binary and the previous communication protocol had been around for a long time, and were well known by AV companies. For instance, its critical communication packets were blocked by IPS systems. This would have disrupted the attackers&rsquo; business model on a large scale, preventing them from making easy, dirty money.</p><p>Looking at our statistics, we can see that Pushdo very rapidly became one of the most prevalent threats running from October 2007 to March 2008. It is interesting to note that the original HTTP GET communication was slightly modified in December 2007 [<span class="citation"><a href="#citation.1">1</a></span>] to avoid detection, but seemed to quickly be thwarted as activity became significantly reduced from March 2008 onwards.</p><div class="figure"><a id="figure.1"></a><div class="mediaobject"><img alt="Initial Pushdo seeding (HTTP GET)." src="/uploads/images/figures/2010/02/Yang-Fig1.jpg" /></div><p class="title"><b>Figure&nbsp;1.&nbsp;Initial Pushdo seeding (HTTP GET).</b></p></div><p>Until recently, Pushdo activity failed to return to the levels experienced during its initial outbreak. In October 2009 we observed tremendous activity with the updated version: nearly ten times the level detected two years ago. This signifies an aggressive approach to seed a new, revolutionized version of the Pushdo malware installation system. Indeed, the gang behind Pushdo must have quite some resources at their fingertips with the ability to seed in such high volume.</p><div class="figure"><a id="figure.2"></a><div class="mediaobject"><img alt="Pushdo/Cutwail &ndash; first gen vs. next gen." src="/uploads/images/figures/2010/02/Yang-Fig2.jpg" /></div><p class="title"><b>Figure&nbsp;2.&nbsp;Pushdo/Cutwail &ndash; first gen vs. next gen.</b></p></div><p>The Revolution6 version is marked by debug ASCII strings in the unpacked binary, showing a &lsquo;pdb&rsquo; filepath. PDB (program database) files contain debug and project state information for builds. In this case, the filepath shows the project name and debug name, for instance: &lsquo;f:\\programs\\revolution6\\loader\\objfre_wxp_x86\\i386\\Loader.pdb&rsquo;. In some samples, while the project name remained the same, the volume changed (e.g. &lsquo;c:\\programs&rsquo;), indicating that there was more than one build.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3624633"></a>What changed</h2></div></div></div><p>There are two main changes in the Pushdo payload. Firstly, in the main routine there is now a condition that leads the malware to delete itself and exit when the OS language is Russian. This is not uncommon: for instance, Conficker avoids infecting Ukrainian systems, and various Scareware flavours do the same. In fact, there might be some connection between the Conficker and Pushdo/Cutwail gangs, although the nature of that connection remains a mystery.</p><p>The other radical change concerns the &lsquo;injection&rsquo; code, the main function of which is to control the communications between the servers and the bots, for the purpose of retrieving all the malware modules (rootkit component, mailer component, etc.) that characterize the Cutwail botnet. Let&rsquo;s take a closer look at this process.</p><p>Nowadays, the communication channels of most infamous botnets are encrypted, either using a public encryption algorithm (e.g. AES-CBC, Base64 in Waledac, etc.) or a custom, private one. Pushdo is no exception; it resorts to many custom encryption algorithms, leveraging two main encryption/decryption keys stored in memory. <a href="#figure.3">Figure 3</a> shows the stored key pattern.</p><div class="figure"><a id="figure.3"></a><div class="mediaobject"><img alt="Figure 3: Encryption/decryption key." src="/uploads/images/figures/2010/02/Yang-Fig3.jpg" /></div><p class="title"><b>Figure&nbsp;3.&nbsp;Figure 3: Encryption/decryption key.</b></p></div><p>The data circled in red is the key for encrypting/decrypting the Pushdo communication packet &lsquo;header&rsquo; (made up of a start identifier and content length &ndash; eight bytes total). It should be noted that this key is hard coded in the Pushdo binary. Even more interesting is the fact that, based on the samples retrieved from different sources/spreading methods, this hard-coded key has never changed across samples. This explains why Pushdo doesn&rsquo;t have a routine to communicate the key to the server &ndash; the server already knows it. This is quick and efficient, and saves the cost of implementing a &lsquo;safe&rsquo; exchange of symmetric keys via public key encryption schemes. But of course it is tremendously lacking in flexibility, putting the botnet at risk once the hard-coded key has been discovered (although, as we will see later, this only concerns the packet headers).</p><p>The data circled in blue is the return value of a call to QueryPerformanceCount, an API function frequently used to generate pseudo-random values. This data will be used as the key for encrypting/decrypting the Pushdo communication packet &lsquo;content&rsquo;. Being generated randomly rather than pre-shared, the key must be sent to the server (see <a href="#figure.4">Figure 4</a> below).</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id3291937"></a>Sending random encryption/decryption key to the server</h3></div></div></div><div class="figure"><a id="figure.4"></a><div class="mediaobject"><img alt="Sending encryption/decryption key to the server." src="/uploads/images/figures/2010/02/Yang-Fig4.jpg" /></div><p class="title"><b>Figure&nbsp;4.&nbsp;Sending encryption/decryption key to the server.</b></p></div><p>As can be seen above, the random key is sent to the server in plain text.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4525900"></a>Sending bot and loader info to the server</h3></div></div></div><p>The data shown in <a href="#figure.5">Figure 5</a> below is the &lsquo;clear-text&rsquo; data block generated by Pushdo, which we &lsquo;intercepted&rsquo; in memory prior to encryption. It appears that every data piece starts with the tag &lsquo;PROP&rsquo;. This looks familiar, and is similar to the XML format used by Waledac. The difference is that Pushdo has dropped the &lsquo;&lt;tag&gt;&lt;/tag&gt;&rsquo; pairs in order to reduce the packet length and make the communication faster. Moreover, Pushdo will only send data containing the fields &lsquo;ldrver&rsquo; and &lsquo;winver&rsquo; to the first server it connects to (i.e. even if the rest of the communication fails, thus warranting an attempt to connect to another server, these will not be re-sent).</p><div class="figure"><a id="figure.5"></a><div class="mediaobject"><img alt="Clear data block sent from UPS/DHL spam sample." src="/uploads/images/figures/2010/02/Yang-Fig5.jpg" /></div><p class="title"><b>Figure&nbsp;5.&nbsp;Clear data block sent from UPS/DHL spam sample.</b></p></div><p>Let&rsquo;s break the whole data block into &lsquo;fields&rsquo; for better comprehension. The two first fields are the &lsquo;header&rsquo;, encrypted by the pre-shared key, while the rest is the &lsquo;content&rsquo;, encrypted by the random key.</p><div class="table"><a id="table.1"></a><table border="1" summary="Clear data block structure and description."><colgroup><col align="center" /><col /><col /><col /><col /><col /><col /><col /></colgroup><tbody><tr><td align="center">Start identifier (dd)</td><td align="center">Data length (dd)</td><td align="center">Key word identifier (dw)</td><td align="center">Key word length (dw)</td><td align="center">Content length (dw)</td><td align="center">Key word (00 ending)</td><td align="center">Content</td><td align="center">Description</td></tr><tr><td align="center">50 52 4F 50 PROP</td><td align="center">1B</td><td align="center">16</td><td align="center">5</td><td align="center">8</td><td align="center">75 6E 69 71 00 uniq</td><td align="center">C1 84 5D 78 B7 98 9D 24</td><td align="center">encrypted data of system info</td></tr><tr><td align="center">50 52 4F 50 PROP</td><td align="center">18</td><td align="center">14</td><td align="center">6</td><td align="center">4</td><td align="center">63 6F 75 6E 74 00 count</td><td align="center">00 00 00 00</td><td align="center">send packet counter</td></tr><tr><td align="center">50 52 4F 50 PROP</td><td align="center">1A</td><td align="center">14</td><td align="center">8</td><td align="center">4</td><td align="center">73 65 73 73 69 6F 6E 00 session</td><td align="center">E8 F1 CE EA</td><td align="center">random number to identify the connection</td></tr><tr><td align="center">50 52 4F 50 PROP</td><td align="center">19</td><td align="center">14</td><td align="center">7</td><td align="center">4</td><td align="center">76 65 6E 64 6F 72 00 vendor</td><td align="center">11 00 00 00</td><td align="center">hard-coded in Pushdo</td></tr><tr><td align="center">50 52 4F 50 PROP</td><td align="center">18</td><td align="center">12</td><td align="center">8</td><td align="center">2</td><td align="center">6C 64 72 74 79 70 65 00 ldrtype</td><td align="center">01 00</td><td align="center">hard-coded in Pushdo</td></tr><tr><td align="center">50 52 4F 50 PROP</td><td align="center">19</td><td align="center">14</td><td align="center">7</td><td align="center">4</td><td align="center">6C 64 72 76 65 72 00 ldrver</td><td align="center">37 00 00 00</td><td align="center">hard-coded in Pushdo</td></tr><tr><td align="center">50 52 4F 50 PROP</td><td align="center">28</td><td align="center">19</td><td align="center">7</td><td align="center">13</td><td align="center">77 69 6E 76 65 72 00 winver</td><td align="center">05 00 00 00 01 00 00 00 28 0A 00 00 03 00 00 00 00 01 01</td><td align="center">windows version Info</td></tr><tr><td align="center">52 45 43 56 RECV</td><td align="center">08</td><td align="center">N/A</td><td align="center">N/A</td><td align="center">N/A</td><td align="center">N/A</td><td align="center">N/A</td><td align="center">end of the packet content</td></tr></tbody></table><p class="title"><b>Table&nbsp;1.&nbsp;Clear data block structure and description.</b></p></div><p>There are two main pieces of information in this data block. One is the basic host-related information, including volume information, system bios date, video bios data, processor model, OS ID and <em class="productname">Windows</em> version.</p><p>The other is the (malware) loader information, including loader type, loader version and vendor number. The latter is very interesting, as we are about to see. First, note that this data block is generated from a sample which is the attachment of a fake UPS/DHL email. Now, let&rsquo;s compare it with data from other samples with different spreading methods to see what changes in the information reported to the server by the loader.</p><p>Figure 6 shows the data sent to the server by a loader seeded by Bredolab. The code shown in red highlights an interesting difference: the vendor number is 0x10 in this sample (rather than 0x11 in our UPS sample). So what is this vendor number?</p><div class="figure"><a id="figure.6"></a><div class="mediaobject"><img alt="Clear data block sent from Bredolab downloaded Pushdo." src="/uploads/images/figures/2010/02/Yang-Fig6.jpg" /></div><p class="title"><b>Figure&nbsp;6.&nbsp;Clear data block sent from Bredolab downloaded Pushdo.</b></p></div><p>Based on the semantics of &lsquo;vendor&rsquo;, and on the observations above, it could be some sort of affiliate ID, used to remunerate partners who distribute the malware. In any case, it also has a practical purpose here: it indicates which method to use to get and inject the corresponding rootkit and mailer modules.</p><p>Specifically, vendor 0x11 determines that they are loaded from multiple TCP streams and a report is sent back to the server. Meanwhile, under vendor 0x10 they are loaded in a single TCP stream and no report is sent back to the server. The fact that this vendor number is hard coded in the Pushdo binary indicates that the author(s) made independent/custom/private binaries for different &lsquo;vendors&rsquo;; in the process, they introduced a new operation mode &ndash; rush mode (more on which later).</p><p>In order to better reveal the different server responses which could be possible based on the &lsquo;vendor&rsquo;, we carried out some fuzzing on the Pushdo request packet (more details later).</p><p>After generating this data buffer for the server, Pushdo will encrypt it prior to sending it. As we have hinted before, the encryption routine has two separate phases. One uses the hard-coded key to encrypt the start identifier and data length (&lsquo;header&rsquo;). The other uses the randomly generated key that has already been sent to the server to encrypt the rest of the data (&lsquo;content&rsquo;).</p><p><span class="bold"><strong>Encryption algorithm A: encrypt start identifier and data length</strong></span></p><p>In this case, the &lsquo;Start Identifier&rsquo; and &lsquo;Data Length&rsquo; are simply XORed with the hard-coded key.</p><p>For example:</p><pre class="programlisting">50 52 4F 50 1B 00 00 00 ^ 45 9A B3 61   8E 20 3F 19 = 15 C8 FC 31   95 20 3F 19

52 45 43 56 08 00 00 00 ^ 45 9A B3 61   8E 20 3F 19 = 17 DF F0 37   86 20 3F 19</pre><p>As mentioned previously, the key is likely pre-shared with the server (albeit the server could get this encryption key simply by XORing the original data (50524F501B0000) with the encrypted data received from the bot).</p><p><span class="bold"><strong>Encryption algorithm B: encrypt rest of data </strong></span></p><p>In this case, the first three bytes of the randomly generated key are used. For each byte of data to encrypt, the remainder of the quotient &lsquo;byte offset / 4&rsquo; is computed, and its value is the index of the encryption operation to apply to that byte.</p><p>For example:</p><p>Key: 37 8A 3A</p><p>Original data: 16 00 05 00 08 00 75 6E</p><p>Encrypted data: 21 76 3f c4 3f 76 AF AA</p><div class="table"><a id="table.2"></a><table border="1" summary="Data encryption algorithm."><colgroup><col align="center" /><col /></colgroup><tbody><tr><td align="center">Offset % 4</td><td align="center">Method</td></tr><tr><td align="center">0</td><td align="center">Byte ^ 37</td></tr><tr><td align="center">1</td><td align="center">Byte - 8A</td></tr><tr><td align="center">2</td><td align="center">Byte + 3A</td></tr><tr><td align="center">3</td><td align="center">Byte ^ (3A + 8A)</td></tr></tbody></table><p class="title"><b>Table&nbsp;2.&nbsp;Data encryption algorithm.</b></p></div><p>The encrypted block is then sent to the server. The interesting thing is that the server could use the Volume Info in the &lsquo;uniq&rsquo; to identify whether the bot is running under a virtual machine environment, but it seems to ignore this.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id4884154"></a>Retrieving other components</h3></div></div></div><p>There are two possible kinds of reply from the server, which are identified by their &lsquo;start identifier&rsquo;. Those with &lsquo;PROP&rsquo; as a start identifier contain the server list. Pushdo will update its list based on this message. Those with &lsquo;FILE&rsquo; as a start identifier contain other components, including rootkits and the spam engine. As mentioned before, Pushdo has two operation modes for retrieving those (based on the vendor number): stepping mode and rush mode.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id4447988"></a>Stepping mode</h4></div></div></div><p>Just as its name implies, in stepping mode Pushdo will retrieve the rootkit and spam engine step by step, one by one. More specifically, it will send the bot status back to the server to determine the next step after every module/list retrieved (see <a href="#figure.7">Figure 7</a>, <a href="#figure.8">Figure 8</a> and <a href="#figure.9">Figure 9</a>).</p><div class="figure"><a id="figure.7"></a><div class="mediaobject"><img alt="Clear FILE data block &ndash; rootkit installer (partial)." src="/uploads/images/figures/2010/02/Yang-Fig7.jpg" /></div><p class="title"><b>Figure&nbsp;7.&nbsp;Clear FILE data block &ndash; rootkit installer (partial).</b></p></div><div class="figure"><a id="figure.8"></a><div class="mediaobject"><img alt="Clear FILE data block &ndash; spam engine (partial)." src="/uploads/images/figures/2010/02/Yang-Fig8.jpg" /></div><p class="title"><b>Figure&nbsp;8.&nbsp;Clear FILE data block &ndash; spam engine (partial).</b></p></div><div class="figure"><a id="figure.9"></a><div class="mediaobject"><img alt="Clear FILE data block &ndash; mail relay server." src="/uploads/images/figures/2010/02/Yang-Fig9.jpg" /></div><p class="title"><b>Figure&nbsp;9.&nbsp;Clear FILE data block &ndash; mail relay server.</b></p></div><p><a href="#table.3">Table 3</a> breaks down the whole data block into fields.</p><div class="table"><a id="table.3"></a><table border="1" summary="FILE message structure."><colgroup><col align="center" /><col /><col /><col /><col /><col /><col /><col /><col /><col /></colgroup><tbody><tr><td align="center">Type</td><td align="center">Start identifier (dd)</td><td align="center">Data length (dd)</td><td align="center">TMP file determiner (dw)</td><td align="center">Key word length (dw)</td><td align="center">File type identifier (dw)</td><td align="center">File length (dd)</td><td align="center">Content identifier (dd)</td><td align="center">Key word (00 Ending)</td><td align="center">Content</td></tr><tr><td align="center">Rootkit installer</td><td align="center">46 49 4C 45 FILE</td><td align="center">0x9224</td><td align="center">2</td><td align="center">0B</td><td align="center">1</td><td align="center">0x9200</td><td align="center">0x34</td><td align="center">52 6F 6F 74 4B 69 74 5F 31 37 00 00 RootKit_17</td><td align="center">N/A</td></tr><tr><td align="center">Spam engine</td><td align="center">46 49 4C 45 FILE</td><td align="center">0x45E2A</td><td align="center">0</td><td align="center">11</td><td align="center">1</td><td align="center">0x45E00</td><td align="center">0x12</td><td align="center">4D 61 69 6C 65 72 5F 52 53 31 5F 65 6D 70 74 79 00 00 Mailer_RS1_empty</td><td align="center">N/A</td></tr><tr><td align="center">Relay server info</td><td align="center">46 49 4C 45 FILE</td><td align="center">0x5E</td><td align="center">0A</td><td align="center">22</td><td align="center">20</td><td align="center">0x4</td><td align="center">0x63</td><td align="center">4D 61 69 6C 65 72 5F 52 53 31 5F 37 38 5F 31 35 39 5F 31 32 31 5F 34 31 28 44 69 6D 61 72 69 6B 29 00 Mailer_RS1_78_159_121_41(Dimarik)</td><td align="center">/host:78.159.121.41 /port:38811</td></tr></tbody></table><p class="title"><b>Table&nbsp;3.&nbsp;FILE message structure.</b></p></div><p>The retrieved message process routine depends on the &lsquo;TMP file determiner&rsquo; and &lsquo;file type identifier&rsquo;. If the &lsquo;file type identifier&rsquo; equals 1, then it will check the &lsquo;TMP file determiner&rsquo;. If a result of 1 occurs after a logical AND, a temporary file will be created before injecting into a suspend mode svchost.exe. Otherwise, it will be injected directly into a suspend mode svchost.exe, but it will always perform a sanity check before the injection. The svchost.exe process info will be stored in the memory and a partial file checksum value will be used when reporting bot status. <a href="#figure.10">Figure 10</a> shows the structure of the bot status info.</p><div class="figure"><a id="figure.10"></a><div class="mediaobject"><img alt="Bot status data &ndash; one process (rootkit installer) running." src="/uploads/images/figures/2010/02/Yang-Fig10.jpg" /></div><p class="title"><b>Figure&nbsp;10.&nbsp;Bot status data &ndash; one process (rootkit installer) running.</b></p></div><p>Pushdo will use the bot status data to form the report communication packet. <a href="#figure.11">Figure 11</a> shows an example of the content of such a report packet.</p><div class="figure"><a id="figure.11"></a><div class="mediaobject"><img alt="Clear report data block." src="/uploads/images/figures/2010/02/Yang-Fig11.jpg" /></div><p class="title"><b>Figure&nbsp;11.&nbsp;Clear report data block.</b></p></div><p>If the injection fails, or if the bot needs to change to another server (perhaps because the current connection broke), Pushdo will always retrieve the rootkit installer until the injection succeeds. Therefore, the &lsquo;botstatus&rsquo; could contain information for more than one running process. This also indicates that Pushdo has the ability to load other malware and report back to the server.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a class="chapter" id="id2698356"></a>Rush mode</h4></div></div></div><p>The major difference between rush mode and stepping mode is the absence of reports (&lsquo;botstatus&rsquo;) in rush mode and the fact that the rootkit installer and spam engine are retrieved at the same time (single TCP stream). Thanks to the well-organized data structure, Pushdo can process them as easily as in stepping mode and even faster. Bredolab has been downloading Pushdo binaries, and this mode has only been seen in the Bredolab-downloaded Pushdos. The report will only be sent when the process is running. It&rsquo;s a possibility that Bredolab just tries to use the Cutwail spam engine to spread itself.</p></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id2309055"></a>Fuzzing Pushdo botnet request packet</h2></div></div></div><p>The main purpose of this part of the paper is to reveal the relationship between different vendor ID and server responses, and to gain an idea of how many custom/private Pushdo binaries there are now, by fuzzing the vendor value.</p><p>Method: We use protocol re-writer to customize the vendor value before it sends out, then intercept the response packets.</p><p>The vendor ID with corresponding server response will be the following (partial):</p><p>Rootkit_[number] represents the &lsquo;Key Word&rsquo;.</p><p>Loader_V0x[number] represents the Pushdo binary with hard-coded vendor &lsquo;number&rsquo;</p><p>Vendor=0x00, downloaded Modules:</p><p>Rootkit_1, Loader_V0x01, Mail Sniff, Filter</p><p>Vendor=0x01, downloaded Modules:</p><p>Rootkit_1, Loader_V0x1, Mail Sniff, Filter</p><p>Vendor=0x02, downloaded Modules:</p><p>Rootkit_2, Loader_V0x2</p><p>Vendor=0x09, download Modules:</p><p>Rootkit_9, Loader_V0x9</p><p>Vendor=0x10, downloaded Modules:</p><p>Rootkit_16, Spam Engine</p><p><span class="bold"><strong>Spam Engine served for Bredolab</strong></span>.</p><p>Vendor=0x11, downloaded Modules:</p><p>Rootkit_17, Spam Engine</p><p><span class="bold"><strong>Spam Engine served for Pushdo itself</strong></span>.</p><p>Vendor=0x12, downloaded Modules:</p><p>Rootkit_18, Loader_V0x12, Spam Engine</p><p>Spam Engine served for ???</p><p>Vendor=0x13, downloaded Modules:</p><p>Rootkit_19, Loader_V0x13, Spam Engine</p><p>Spam Engine served for ???</p><p>Vendor=0x14, downloaded Modules:</p><p>Rootkit_20, Loader_V0x14, Spam Engine</p><p>Spam Engine served for ???</p><p>Vendor=0x15, downloaded Modules:</p><p>Rootkit_21, Loader_V0x15, Spam Engine</p><p>Spam Engine served for ???</p><p>Vendor=0x16, downloaded Modules:</p><p>Rootkit_22, Loader_V0x16, Spam Engine, Web Mailer</p><p>Spam Engine served for ???</p><p>Vendor=0x17, downloaded Modules:</p><p>Rootkit_23, Loader_V0x17, Spam Engine</p><p>Spam Engine served for ???</p><p>Vendor=0x18, downloaded Modules:</p><p>No Modules downloaded.</p><p>Vendor=0x19, downloaded Modules:</p><p>No Modules downloaded.</p><p>Vendor=0x1A, downloaded Modules:</p><p>No Modules downloaded.</p><p>Vendor=0x1B, downloaded Modules:</p><p>Rootkit_1, Loader_V0x01, Web Mailer</p><p>Vendor=0x20, downloaded Modules:</p><p>Rootkit_1, Loader_V0x01, Web Mailer</p><p>Vendor=0x63, downloaded Modules:</p><p>Rootkit_1, Loader_V0x1</p><p>Vendor=0xfd, downloaded Modules:</p><p>Rootkit_1, Loader_V0x01</p><p>Vendor=0xfe, downloaded Modules:</p><p>Rootkit_1, Loader_V0x01, Web Mailer</p><p>Vendor=0xff, downloaded Modules:</p><p>Rootkit_1, Loader_V0x01</p><p>Vendor=0x100, downloaded Modules:</p><p>Rootkit_1, Loader_V0x01</p><p>Vendor=0xfffe, downloaded Modules:</p><p>Rootkit_1, Loader_V0x01, Web Mailer</p><p>Vendor=0xffff, downloaded Modules:</p><p>Rootkit_1, Loader_V0x01</p><p>Vendor=0xffffff, downloaded Modules:</p><p>Rootkit_1, Loader_V0x01</p><p>Vendor=0xffffffff, downloaded Modules:</p><p>Rootkit_1, Loader_V0x01</p><p>From the above fuzzing results (gathered 18 December 2009), we can see that both the rootkit and loader version number is related to the vendor ID. There may also be 23 private/custom Pushdo binaries based on the different hard-coded vendor IDs. As mentioned previously, the vendor may be related to the partners who distribute the malware. In this case we only revealed two: 0x10 and 0x11, but there are still more to be revealed. We have even seen some new modules with another new project name: &lsquo;webbot&rsquo;. The debug build has now reached three, &lsquo;WebMailer3&rsquo;. After reversing this binary, it appears to still be experimental and that the author(s) are still trying to debug it since there is a &lsquo;/debug&rsquo; switch. <em class="phrase">Fortinet</em>&rsquo;s <span class="emphasis"><em>FortiGuard Labs</em></span> has dubbed this new engine &lsquo;Webwail&rsquo;. Webwail has the ability to register new email accounts and send spam from the web. Around 15 January 2010, Pushdo started to download this new spam engine, spreading Webwail with the help of its old friend Bredolab once again. At the time of writing, Webwail is registering <em class="productname">Hotmail</em> accounts [<span class="citation"><a href="#citation.2">2</a></span>].</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3540385"></a>Detection</h2></div></div></div><p>Thanks to its well-organized data structure, Pushdo can communicate a large amount of information from and to its command and control server. We can read that information as well, the only issue being the encryption key. However, the encryption key doesn&rsquo;t change even in custom/private builds for other malware, thus making detection easier.</p><div class="bibliography"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id2338525"></a>Bibliography</h3></div></div></div><div class="bibliomixed"><a id="citation.1"></a><p class="bibliomixed">[1] SecureWorks. <span class="bibliosource"><a href="https://www.secureworks.com/research/threats/pushdo/" target="_blank">http://www.secureworks.com/research/threats/pushdo/</a></span>.</p></div><div class="bibliomixed"><a id="citation.2"></a><p class="bibliomixed">[2] More information on Webwail can be found at <span class="bibliosource"><a href="http://blog.fortinet.com/bredolab-gearing-up-to-spam-the-web/" target="_blank">http://blog.fortinet.com/bredolab-gearing-up-to-spam-the-web/</a></span>.</p></div><div class="bibliomixed"><a id="citation.3"></a><p class="bibliomixed">[3] More information on Pushdo/Cutwail can be found at <span class="bibliosource"><a href="http://www.fortiguard.com/analysis/pushdoanalysis.html" target="_blank">http://www.fortiguard.com/analysis/pushdoanalysis.html</a></span>.</p></div><div class="bibliomixed"><a id="citation.4"></a><p class="bibliomixed">[4] More information on Crime Services can be found at <span class="bibliosource"><a href="http://blog.fortinet.com/adaptive-crime-services/" target="_blank">http://blog.fortinet.com/adaptive-crime-services/</a></span>.</p></div></div></div> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=Cut the Cutwail&url=https://www.virusbulletin.com/virusbulletin/2010/02/cut-cutwail"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2010/02/cut-cutwail'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2010/02/cut-cutwail&title=Cut the Cutwail"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2010/02/cut-cutwail&t=Cut the Cutwail"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2010/02/cut-cutwail"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p> </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">©1989-2022 Virus Bulletin.        <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>        <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>        <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>