<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: VB2019 paper: Kimsuky group: tracking the king of the spear phishing</title>
<meta name="description" content="The Kimsuky group is a threat group that is known to have been behind the KHNP (Korea Hydro &amp; Nuclear Power) cyber terrorism attacks of 2014 and is still active in 2019. This paper presents the results of an analysis not only of the malware used by the Kimsuky group but also of server-side samples (tools and templates that send out spear-phishing emails, like a phishing rod)." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 6725;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/blocks/expand_collapse_toc/templates/vbexpand/view.css" />
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/jquery.color.js"></script>
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<h1><a class="chapter" name="h1-vb2019-paper-kimsuky-group-tracking-king-spearphishing"></a>VB2019 paper: Kimsuky group: tracking the king of the spear phishing</h1>
<h3><a class="chapter" name="h3-jaeki-kim-kyoung-ju-kwak-amp-min-chang-jang"></a>Jaeki Kim, Kyoung-Ju Kwak &amp; Min-Chang Jang</h3>
<p><em>Financial Security Institute, Republic of Korea</em></p>
<hr />
<p> </p>
<div class="ccm-expand-collapse-toc">
<div id="ccm-expand-collapse-toc-title-15378" class="ccm-expand-collapse-toc-title ccm-expand-collapse-toc-closed" data-expander-speed="500">Table of contents</div><div id="ccm-expand-collapse-toc-content-15378" class="ccm-expand-collapse-toc-content"><p><a class="toc-level2" href="#h2-abstract">Abstract</a><br /> <a class="toc-level2" href="#h2-1-introduction">1. Introduction</a><br /> <a class="toc-level2" href="#h2-2-related-cases">2. Related cases</a><br /> <a class="toc-level2" href="#h2-3-toolset-characteristics">3. Toolset characteristics</a><br /> <a class="toc-level3" href="#h3-server-side-toolkits">Server-side toolkits</a><br /> <a class="toc-level4" href="#h4-mailer-shape-amp-core-beaconer-phisher-logger">Mailer (shape &amp; core), beaconer, phisher, logger</a><br /> <a class="toc-level3" href="#h3-malware">Malware</a><br /> <a class="toc-level4" href="#h4-dropper-malicious-or-camouflaged-hwp-documents-script-infostealer">Dropper (malicious or camouflaged HWP documents), script, infostealer</a><br /> <a class="toc-level2" href="#h2-4-tracking-malware-and-monitoring-campc-servers">4. Tracking malware and monitoring C&amp;C servers</a><br /> <a class="toc-level3" href="#h3-attacker-defender-opsec-failures">Attacker ≠ defender: OpSec failures</a><br /> <a class="toc-level3" href="#h3-opsec-failure-case-1-directory-listing">OpSec failure case 1: Directory listing</a><br /> <a class="toc-level4" href="#h4-case-11-after-dokkaebi-campaign-h-ds-distribution-type">Case 1.1: After DOKKAEBI campaign: H-DS (distribution) type</a><br /> <a class="toc-level4" href="#h4-case-12-malware-camouflaged-hwp-documents">Case 1.2: Malware camouflaged as HWP documents</a><br /> <a class="toc-level3" href="#h3-opsec-failure-case-2-leaked-ftp-access-information">OpSec failure case 2: Leaked FTP access information</a><br /> <a class="toc-level3" href="#h3-opsec-failure-case-3-file-download-vulnerability">OpSec failure case 3: File download vulnerability</a><br /> <a class="toc-level2" href="#h2-relationships-analysis">Relationships analysis</a><br /> <a class="toc-level2" href="#h2-conclusion">Conclusion</a><br /> <a class="toc-level2" href="#h2-references">References</a></p><p>&nbsp;</p></div></div>
<h2><a class="chapter" name="h2-abstract"></a>Abstract</h2>
<p>The Kimsuky group is a threat group that is known to have been behind the <em>KHNP</em> (<em>Korea Hydro &amp; Nuclear Power</em>) cyber terrorism attacks of 2014 and is still active in 2019.</p>
<p>Since 2018, we have been profiling and tracking spear-phishing emails and malicious code related to the Kimsuky group.</p>
<p>The spear-phishing emails used by the group have been determined to have the purpose of stealing web portal account information and delivering malicious code. The main targets are government and military officials, as well as journalists.</p>
<p>We have analysed the changing behaviour of the Kimsuky group through ongoing tracking of the IoCs related to Kimsuky, including simple account hijacking.</p>
<p>In this paper, we present the results of an analysis not only of the malware used by the Kimsuky group but also of server-side samples (tools and templates that send out spear-phishing emails, like a phishing rod) which we recently investigated.</p>
<p>We have also confirmed that the C&amp;C server used for the earlier attack continues to be used for various purposes, such as distribution of malicious code, logging of infections, and sending phishing mail.</p>
<p> </p>
<h2><a class="chapter" name="h2-1-introduction"></a>1. Introduction</h2>
<p>In September 2013, <em>Kaspersky Lab</em> announced an APT attack targeting major Korean agencies [<a href="#ref1">1</a>]. According to the data, the Kimsuky group was using malicious <em>Hangul</em> documents, like other attack groups targeting Korea, and the attack featured remote control tools (such as <em>Team Viewer</em>) and communication channel configuration using webmail. In February and March 2014, attacks that seemed to have been carried out by the same group against Korean public institutions continued to occur [<a href="#ref2">2</a>].</p>
<p>In December 2014, an attempt was made to destroy PC disks by sending 5,986 spear-phishing emails to 3,571 employees of <em>Korea Hydro &amp; Nuclear Power Co., Ltd</em>. However, only eight PCs were infected with malware, of which five hard disks were initialized.</p>
<p>The malware used in this spear-phishing attack was similar in structure and operation to the malware used by the Kimsuky group, and the <em>Hangul</em> word processor vulnerability used in the malware was the same as that used in the Kimsuky malware. From these results, we inferred that the focus of the Kimsuky group was on social confusion and monitoring of North Korean defectors and politicians, rather than acquiring money.</p>
<p>In June 2015, a number of web portal email accounts were hacked, sending emails with malicious <em>Hangul</em> document files and phishing emails to steal portal account credentials. In January 2016, a large number of emails with malicious attachments were sent under the guise of ‘Office of National Security at the Blue House’ to government research institutes. Analysis by related organizations identified the malicious attachment as Kimsuky malware [<a href="#ref3">3</a>].</p>
<p> </p>
<h2><a class="chapter" name="h2-2-related-cases"></a>2. Related cases</h2>
<p>In January 2019, an email suspected to be carrying malicious code was sent to dozens of journalists, most of whom were covering South Korea’s ministry in charge of relations with North Korea, prompting an investigation into the incident. The email, which was entitled ‘TF reference info’ and had a compressed file attached, was sent to more than 70 reporters, most of whom were members of the unification ministry’s press corps. It was sent through a private email address from a person named ‘Yoon Hong-geun’. The ministry suspected that it contained malicious code designed for hacking [<a href="#ref4">4</a>]. This issue was known variously as Operation Cobra Venom [<a href="#ref5">5</a>], Operation Kitty Phishing [<a href="#ref6">6</a>] and Operation Kabar Cobra [<a href="#ref7">7</a>].</p>
<p> </p>
<h2><a class="chapter" name="h2-3-toolset-characteristics"></a>3. Toolset characteristics</h2>
<p>In the process of tracking the Kimsuky group, we were able to acquire the mail-sending tools and malware used in various spear-phishing attacks. The attack tools used by the Kimsuky group can be broadly categorized into server-side toolkits and malware.</p>
<p> </p>
<h3><a class="chapter" name="h3-server-side-toolkits"></a>Server-side toolkits</h3>
<h4><a class="chapter" name="h4-mailer-shape-amp-core-beaconer-phisher-logger"></a>Mailer (shape &amp; core), beaconer, phisher, logger</h4>
<p>The Kimsuky group created a mailing toolkit for attack and used it repeatedly. We found that, when constructing phishing pages for account takeover, they reused the existing source code of the original site and specific arguments in the URL.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/06d61e1281bd6ddb6c60aa2655674715_f4475.png" alt="Kimsuky-Figure 1.png" width="680" height="514" /></p>
<p class="centered-caption">Figure 1: Daum portal phishing page.</p>
<p> </p>
<h3><a class="chapter" name="h3-malware"></a>Malware</h3>
<h4><a class="chapter" name="h4-dropper-malicious-or-camouflaged-hwp-documents-script-infostealer"></a>Dropper (malicious or camouflaged HWP documents), script, infostealer</h4>
<p>The malware used by the Kimsuky group in recent spear-phishing attacks includes a dropper that is a malicious or camouflaged HWP file; a malicious script, which logs and downloads additional malware to the C&amp;C server; and an infostealer. Some infostealers have a module that downloads additional malware.</p>
<p>Examples of the flow of malware used in spear-phishing attacks are shown in Figure 2.</p>
<p class="centered-caption"><a class="zoom-img" title="Figure 2: The flow of malware used in spear-phishing attacks." href="/files/9715/7866/2077/Kimsuky-Figure_2.png"><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/4935e7b17f3791aa2bc67fa767d10db2_f4476.png" alt="Kimsuky-Figure 2.png" width="840" height="816" /></a>Figure 2: The flow of malware used in spear-phishing attacks.</p>
<p>A classification of the attack tools used by the Kimsuky group is shown in Table 1.</p>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td><strong>Name</strong></td>
<td><strong>No.</strong></td>
<td><strong>Type</strong></td>
<td><strong>Details</strong></td>
</tr>
<tr>
<td>Mailer (shape)</td>
<td>1</td>
<td>Mailer</td>
<td>Mailer (just shape)</td>
</tr>
<tr>
<td>Mailer (core)</td>
<td>2</td>
<td>Mailer</td>
<td>Mailer (actual function) <br />1) Attachment of malware <br />2) Link to phishing page for account hijack</td>
</tr>
<tr>
<td>Beaconer</td>
<td>3</td>
<td>Web beacon</td>
<td>Beacon to check whether mail is being viewed</td>
</tr>
<tr>
<td>Phisher</td>
<td>4</td>
<td>Account stealer, phishing</td>
<td>Phishing toolkit(lod) phishing page for account stealing</td>
</tr>
<tr>
<td>Logger</td>
<td>5</td>
<td>Logging, phishing</td>
<td>Logging of phishing target information</td>
</tr>
<tr>
<td>Malicious HWP</td>
<td>6</td>
<td>Dropper, spear phishing</td>
<td>Malicious HWP documents</td>
</tr>
<tr>
<td>Camouflaged HWP</td>
<td>7</td>
<td>Dropper, spear phishing</td>
<td>Camouflaged HWP documents (e.g. sfx, exe)</td>
</tr>
<tr>
<td>Script</td>
<td>8</td>
<td>Downloader, logging</td>
<td>Downloads additional malware and logs (e.g. *.vbs, *.wsf, *.jse, *.ps1)</td>
</tr>
<tr>
<td>Infostealer</td>
<td>9</td>
<td>C&amp;C, DLL, downloader, FTP logging</td>
<td>Steals information from infected target and downloads additional malware (in some cases using FTP)</td>
</tr>
</tbody>
</table>
<p class="centered-caption">Table 1: Kimsuky toolset.</p>
<p> </p>
<h2><a class="chapter" name="h2-4-tracking-malware-and-monitoring-campc-servers"></a>4. Tracking malware and monitoring C&amp;C servers</h2>
<h3><a class="chapter" name="h3-attacker-defender-opsec-failures"></a>Attacker ≠ defender: OpSec failures</h3>
<p>The attacker and defender are on different sides [<a href="#ref8">8</a>]. In addition, an attacker who continues to attack does not have a good understanding of defence. There can be a difference between an attacking position and a defending position.</p>
<p>After all, attackers are also in the position of developing malware and server-side toolkits.</p>
<p>Attackers who develop various attack tools are in the same position as those in general development. While working within a limited timeframe and with limited resources, information leakage and vulnerabilities can occur naturally due to code reuse or C&amp;C server operation mistakes.</p>
<p>In the course of investigating and analysing the C&amp;C server, several security weaknesses were discovered, which provided us with good information for investigation and tracking. We will look at the following cases of OpSec failure:</p>
<ol>
<li>Directory listing</li>
<li>Leaked FTP access information</li>
<li>File download vulnerability</li>
</ol>
<p> </p>
<h3><a class="chapter" name="h3-opsec-failure-case-1-directory-listing"></a>OpSec failure case 1: Directory listing</h3>
<h4><a class="chapter" name="h4-case-11-after-dokkaebi-campaign-h-ds-distribution-type"></a>Case 1.1: After DOKKAEBI campaign: H-DS (distribution) type</h4>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td><strong>Name</strong></td>
<td><strong>No.</strong></td>
<td><strong>Type</strong></td>
<td><strong>Details</strong></td>
</tr>
<tr>
<td>Malicious HWP</td>
<td>6</td>
<td>Dropper, spear-phishing</td>
<td>Malicious HWP documents</td>
</tr>
<tr>
<td>Script</td>
<td>8</td>
<td>Downloader, logging</td>
<td>Downloads additional malware and logs (e.g. <br />*.vbs, *.wsf, *.jse, *.ps1)</td>
</tr>
</tbody>
</table>
<p class="centered-caption">Table 2: Related toolset.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/8b4f52c51228ff732f466c16826b6f44_f4477.png" alt="Kimsuky-Figure 3.png" width="780" height="585" /></p>
<p class="centered-caption">Figure 3: Profiling of malicious Hangul files.</p>
<p>Following the DOKKAEBI campaign, malicious <em>Hangul</em> documents were continuously analysed [<a href="#ref9">9</a>]. During this process, we tracked a C&amp;C server (suppcrt-seourity[.]esy.es) and malware related to malicious <em>Hangul</em> documents.</p>
<p>The file name of the malicious <em>Hangul</em> sample uploaded to <em>VirusTotal</em> on 23 May 2018 (shown in Figure 4) is ‘종전선언.hwp’ (‘Declaration of war end’) [<a href="#ref10">10</a>].</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/518107e449286c95507e57c2a75df099_f4478.png" alt="Kimsuky-Figure 4.png" width="830" height="327" /><span class="centered-caption">Figure 4: Malicious Hangul sample 종전선언.hwp.</span></p>
<p>The overall flow of the sample is as follows [<a href="#ref11">11</a>].</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/95dcf65db52250f2e0859f994b92c251_f4479.png" alt="Kimsuky-Figure 5.png" width="830" height="120" /></p>
<p class="centered-caption">Figure 5: Sample flow.</p>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td><strong>Name</strong></td>
<td><strong>No.</strong></td>
<td><strong>Type</strong></td>
<td><strong>MD5</strong></td>
</tr>
<tr>
<td>‘Second Road to Go: Building a Peace System for Unification’</td>
<td>1</td>
<td>Initial dropper</td>
<td>8332be776617364c16868c1ad6b4efe7</td>
</tr>
<tr>
<td>core.dll (OneDll.dll)</td>
<td>2</td>
<td>DLL (dropper)</td>
<td>4de21c3af64b3b605446278de92dfff4</td>
</tr>
<tr>
<td>fontchk.jse</td>
<td>3</td>
<td>Script</td>
<td>f22db1e3ea74af791e34ad5aa0297664</td>
</tr>
<tr>
<td>brid.ige (zerodll.dll)</td>
<td>4</td>
<td>DLL</td>
<td>2FB20830564AC781AFB7D5F422BECFC9</td>
</tr>
</tbody>
</table>
<p class="centered-caption">Table 3: Malware.</p>
<p>The malware fontchk.jse records the infection information (date, time, IP address, MAC address, etc.) in the path <span class="monospace">[C&amp;C]/update/fonts/log.txt</span>, as shown in Figure 6. In this way, the files (including the malware) and log files that exist on the C&amp;C server can easily be obtained.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/3015/7891/7830/Kimsuky-Figure_6a.png" alt="Kimsuky-Figure 6a.png" width="318" height="215" /><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/3415/7891/7853/Kimsuky-Figure_6b.png" alt="Kimsuky-Figure 6b.png" width="423" height="128" /><span class="centered-caption">Figure 6: Fontchk.jse records the infection information in the path [C&amp;C]/update/fonts/log.txt.</span></p>
<p>Since a lot of resources are required to build and verify (check the actual operation of) the C&amp;C servers used by attackers, we monitor them continuously, based on the assumption that they are likely to be recycled (reused) rather than being used once and then destroyed.</p>
<p>A new log was recorded on the C&amp;C server on 2018-07-10 (D+49), leading us to conduct further investigation and analysis.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/0ba7755bda109484f0becd1c8e4577e7_f4483.png" alt="Kimsuky-Figure 7.png" width="830" height="188" /> <span class="centered-caption">Figure 7: New infection log.</span></p>
<p>The C&amp;C server leaked its directory listing and didn’t have proper access control, so it was possible to check the remaining logs following an infection.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/d93da071acea211ab628cc9b629aeeb2_f4484.png" alt="Kimsuky-Figure 8.png" width="830" height="120" /> <a class=" anchor" name="figure8"></a><span class="centered-caption">Figure 8: MAC address look-up [<a href="#ref12">12</a>].</span></p>
<p>Previously, we analysed C&amp;C servers, and we saw that the MAC address is used as the directory path. Using this information, we were able to obtain additional malware by using the MAC address written in the infection log.</p>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td><strong>Name</strong></td>
<td><strong>No.</strong></td>
<td><strong>Type</strong></td>
<td><strong>MD5</strong></td>
<td><strong>Details</strong></td>
</tr>
<tr>
<td>zerobase</td>
<td>1</td>
<td>Binary</td>
<td>53ac231e8091abcd0978124f9268b4e4 </td>
<td>XOR encoding </td>
</tr>
<tr>
<td>HanyangUpload_script.dll  </td>
<td>2</td>
<td>DLL</td>
<td>8b59ea1ee28e0123da82801abc0cce4d </td>
<td>XOR decoding - 0x09FD8477 </td>
</tr>
<tr>
<td>cac.wsf  </td>
<td>3</td>
<td>Script</td>
<td>fa2ffcd70fba43dd0653a0ec87863d8a </td>
<td>File upload to C&amp;C server </td>
</tr>
</tbody>
</table>
<p class="centered-caption">Table 4: Malware obtained using MAC address C485088EXXXX.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/79bba85da4345580de3f530a13bab5c0_f4485.png" alt="Kimsuky-Figure9.png" width="450" height="117" /> <span class="centered-caption">Figure 9: Tracking the C&amp;C server and discovering new malware zerobase (not found in VirusTotal).</span></p>
<p>We confirmed that <span class="monospace">zerobase</span> (MD5: 53ac231e8091abcd0978124f9268b4e4) had four-byte XOR encoding (key: 0x09FD8477), and a PE file was obtained through decoding, as shown in Figure 10.</p>
<p><a class="zoom-img" title="Figure 10: The file had four-byte XOR encoding (key: 0x09FD8477) a PE file was obtained through decoding." href="/files/7715/7891/8142/Kimsuky-Figure10.png"><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/00874f089377b8a7b6f7265ad141eaaa_f4486.png" alt="Kimsuky-Figure10.png" width="840" height="461" /></a> <span class="centered-caption">Figure 10: The file had four-byte XOR encoding (key: 0x09FD8477) a PE file was obtained through decoding.</span></p>
<p>The original DLL name identified in the four-byte XOR-decoded malware is H<span class="monospace">anyangUpload_script.dll</span>.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/68f0f7aa39db66b342598c6792a56567_f4487.png" alt="Kimsuky-Figure11.png" width="840" height="158" /> <span class="centered-caption">Figure 11: HanyangUpload_script.dll.</span></p>
<p>The function of the malware (HanyangUpload_script.dll) is as follows:</p>
<p style="padding-left: 30px;">1. Collect information from infected computers.</p>
<p><a class="zoom-img" title="Figure 12: Collecting information." href="/files/4315/7891/8332/Kimsuky-Figure12.png"><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/ea4dcb4f673c82636b72a1ceac6d5779_f4488.png" alt="Kimsuky-Figure12.png" width="830" height="366" /></a> <span class="centered-caption">Figure 12: Collecting information.</span></p>
<p style="padding-left: 30px;">2. Scan specific files.</p>
<p><a class="zoom-img" title="Figure 13: Scanning files." href="/files/9915/7891/8403/Kimsuky-Figure13.png"><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/0a9a0697f2b46d2f662e38c37a946dbf_f4489.png" alt="Kimsuky-Figure13.png" width="830" height="388" /></a> <span class="centered-caption">Figure 13: Scanning files.</span></p>
<p style="padding-left: 30px;">3. Upload files (<span class="monospace">AllList_[MAC Address]_YYMMDD_HHMMSS</span>) to the C&amp;C server using a script (<span class="monospace">cac.wsf</span>)</p>
<p> <a class="zoom-img" title="Figure 14: Uploading files to C&amp;C server." href="/files/1615/7891/8496/Kimsuky-Figure14a.png"><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/69125f8769080fa2b1bdbca8c0c09700_f4490.png" alt="Kimsuky-Figure14a.png" width="830" height="325" /></a><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/fae43f9652b222eff89a3629d09c787b_f4491.png" alt="Kimsuky-Figure14b.png" width="740" height="204" /> <img src="/files/cache/e440760bf54d1482b45ead6608565a50_f4492.png" alt="Kimsuky-Figure14c.png" width="840" height="532" /><span class="centered-caption">Figure 14: Uploading files to C&amp;C server.</span></p>
<h4><a class="chapter" name="h4-case-12-malware-camouflaged-hwp-documents"></a>Case 1.2: Malware camouflaged as HWP documents</h4>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td><strong>Name</strong></td>
<td><strong>No.</strong></td>
<td><strong>Type</strong></td>
<td><strong>Details</strong></td>
</tr>
<tr>
<td>Mailer (shape)</td>
<td>1</td>
<td>Mailer</td>
<td>Mailer (just shape)</td>
</tr>
<tr>
<td>Mailer (core)</td>
<td>2</td>
<td>Mailer</td>
<td>Mailer (actual function) <br />1) Attachment of malware <br />2) Link to phishing page for account hijack</td>
</tr>
<tr>
<td>Beaconer</td>
<td>3</td>
<td>Web beacon</td>
<td>Beacon to check whether mail is being viewed</td>
</tr>
<tr>
<td>Camouflaged HWP</td>
<td>7</td>
<td>Dropper, spear phishing</td>
<td>Camouflaged HWP documents (e.g. sfx, exe)</td>
</tr>
<tr>
<td>Script</td>
<td>8</td>
<td>Downloader, logging</td>
<td>Downloads additional malware and logs (e.g. *.vbs, *.wsf, *.jse, *.ps1)</td>
</tr>
<tr>
<td>Infostealer</td>
<td>9</td>
<td>C&amp;C, DLL, FTP</td>
<td>Steals information from infected target and downloads additional malware (in some cases using FTP)</td>
</tr>
</tbody>
</table>
<p class="centered-caption">Table 5: Related toolset.</p>
<p>Among the tools described above, this malware is camouflaged as an HWP document [<a href="#ref13">13</a>].</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/f9f86d71be3264db9d6359239b894037_f4493.png" alt="Kimsuky-Figure15.png" width="840" height="442" /><span class="centered-caption">Figure 15: Malware camouflaged as an HWP document.</span></p>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td><strong>Name</strong></td>
<td><strong>No.</strong></td>
<td><strong>Type</strong></td>
<td><strong>MD5</strong></td>
<td><strong>Details</strong></td>
</tr>
<tr>
<td>111.scr</td>
<td>1</td>
<td>SFX</td>
<td>10a120f573874c2af6b9172a26fdc597</td>
<td>Camouflaged as HWP documents</td>
</tr>
<tr>
<td>1.hwp</td>
<td>2</td>
<td>HWP</td>
<td>ae5ddda3749dcd72bc6cf6d658c5e31c</td>
<td>Normal HWP</td>
</tr>
<tr>
<td>1.vbs</td>
<td>2</td>
<td>Script</td>
<td>0718bfc5957758d22af02e726cb25fe3</td>
<td>Base64 decoding ⇒ ps1</td>
</tr>
<tr>
<td>Powershell</td>
<td>3</td>
<td>Script</td>
<td>fa2ffcd70fba43dd0653a0ec87863d8a</td>
<td>Additional malware download (C&amp;C: primary-help[.]esy.es)</td>
</tr>
</tbody>
</table>
<p class="centered-caption">Table 6: Malware.</p>
<p>At the time of analysing the malware, additional malware was downloaded from the C&amp;C server.</p>
<p><a class="zoom-img" title="Figure 16: Additional malware being downloaded from the C&amp;C server." href="/files/4715/7892/8539/Kimsuky-Figure16.png"><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/5d05d31a0cd0d5539ae99b97e9e1b0ae_f4494.png" alt="Kimsuky-Figure16.png" width="830" height="221" /></a><span class="centered-caption">Figure 16: Additional malware being downloaded from the C&amp;C server.</span></p>
<p>As in the previous case, we continued to monitor the server, based on the assumption that the attacker would reuse the C&amp;C server they had built.</p>
<p>As a result of our continued monitoring, we confirmed that a new file was uploaded to the C&amp;C server on 2019-04-01 (D+42) and conducted further investigation and analysis.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/ffed45167902a2fa7ade1f2324cfe744_f4495.png" alt="Kimsuky-Figure17.png" width="480" height="162" /> <span class="centered-caption">Figure 17: Mailer (shape): mail.php.</span></p>
<p>The C&amp;C server (<span class="monospace">primary-help[.]esy.es</span>) is also a directory listing as shown in Figure <a href="#figure8">8</a>.</p>
<p>We checked that the new files, mail.php and mail_ok.php, were uploaded to the C&amp;C server.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/498f2e9f26f5bdb6321f679b6edeb85c_f4496.png" alt="Kimsuky-Figure18.png" width="420" height="160" /> <span class="centered-caption">Figure 18: The new files were uploaded to the C&amp;C server.</span></p>
<p>We confirmed that these files are tools for sending mail (i.e. mailers).</p>
<p>If we enter the sender and receiver information (name/email), title and contents and select ‘COMMIT’, then we can confirm that mail.php is a mailer – the actual operation is performed by mail_ok.php.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/dd12386090f57a35d41badade825d0de_f4497.png" alt="Kimsuky-Figurenew19a.png" width="480" height="513" /><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/e68296a85abbbe6554a81e38dda86ba3_f4498.png" alt="Kimsuky-Figurenew19b.png" width="830" height="365" /> <span class="centered-caption">Figure 19: Mail.php is a mailer. The actual operation is performed by mail_ok.php.</span></p>
<p>When using the mailer, the mail was indeed sent the normal way, but with new malware attached.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/3906b5e8d9c6c5f4e2679d94dd385262_f4499.png" alt="Kimsuky-Figurenew20a.png" width="560" height="534" /><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/e7ea4b950104a512744f00980aab4eb3_f4500.png" alt="Kimsuky-Figurenew20b.png" width="560" height="327" /> <span class="centered-caption">Figure 20: The mail was sent normally and new malware was attached.</span></p>
<p>In addition, we confirmed that the web beacon was applied to check whether the mail was read, using <span class="monospace">reading.php</span> defined in the <span class="monospace">&lt;img&gt;</span> tag in the mail sent by the mailer.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/d212a04b07310e7c4f4fe509f61fdc4c_f4501.png" alt="Kimsuky-Figurenew21.png" width="830" height="324" /><span class="centered-caption"> Figure 21: The web beacon was applied to check whether the mail was read.</span></p>
<p> </p>
<h3><a class="chapter" name="h3-opsec-failure-case-2-leaked-ftp-access-information"></a>OpSec failure case 2: Leaked FTP access information</h3>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td><strong>Name</strong></td>
<td><strong>No.</strong></td>
<td><strong>Type</strong></td>
<td><strong>Details</strong></td>
</tr>
<tr>
<td>Mailer (shape)</td>
<td>1</td>
<td>Mailer</td>
<td>Mailer (just shape)</td>
</tr>
<tr>
<td>Mailer (core)</td>
<td>2</td>
<td>Mailer</td>
<td>Mailer (actual function) <br />1) Attachment of malware <br />2) Link to phishing page for account hijack</td>
</tr>
<tr>
<td>Beaconer</td>
<td>3</td>
<td>Web beacon</td>
<td>Beacon to check whether mail is being viewed</td>
</tr>
<tr>
<td>Phisher</td>
<td>4</td>
<td>Account stealer, phishing</td>
<td>Phishing toolkit(lod) phishing page for account stealing</td>
</tr>
<tr>
<td>Logger</td>
<td>5</td>
<td>Logging, phishing</td>
<td>Logging of phishing target information</td>
</tr>
<tr>
<td>Script</td>
<td>8</td>
<td>Downloader, logging</td>
<td>Downloads additional malware and logs (e.g. *.vbs, *.wsf, *.jse, *.ps1)</td>
</tr>
<tr>
<td>Infostealer</td>
<td>9</td>
<td>C&amp;C, DLL, FTP</td>
<td>Steals information from infected target and downloads additional malware (in some cases using FTP)</td>
</tr>
</tbody>
</table>
<p class="centered-caption">Table 7: Related toolset.</p>
<p>Among infostealers used by the Kimsuky group, some samples have been found that use FTP to download additional malware after logging infected targets to the C&amp;C [<a href="#ref14">14</a>, <a href="#ref15">15</a>].</p>
<p>The malware uses the <em>Hostinger</em> free hosting service as a C&amp;C server, and there is a security weakness in that the account (u428325809 ) and password (<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c7b1aea4b3a8b5bef6f5f4e687">[email&#160;protected]</a>#) used for FTP communication are exposed in plain text.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/7d464d6cc7f20eef789d557b965588c6_f4502.png" alt="Kimsuky-Figurenew22a.png" width="840" height="217" /><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/ac3809a026d8ea8a68aa9afbe8460861_f4503.png" alt="Kimsuky-Figurenew22b.png" width="520" height="321" /> <span class="centered-caption">Figure 22: The account (u428325809 ) and password (<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="17617e746378656e2625243657">[email&#160;protected]</a>#) used for FTP communication are exposed in plain text.</span></p>
<p>The same (or similar) FTP account information was identified in the other malware found after this malware (2019-04-03).</p>
<table border="0">
<tbody>
<tr>
<td>
<p><img class="framed" src="/files/cache/1482ebd5af458ef3c193c19a3099d0be_f4504.png" alt="Kimsuky-Figurenew23a.png" width="400" height="220" /> <em>MD5: f38a8ba888c5732236a5e0653826a267</em></p>
</td>
<td>
<p><img class="framed" src="/files/cache/ec70f454870b0d1a0ccf357aa74ab921_f4505.png" alt="Kimsuky-Figurenew23b.png" width="400" height="216" /></p>
<p><em>MD5: 0b65e3f7a40261232dd93f472933fb72</em></p>
</td>
</tr>
</tbody>
</table>
<p class="centered-caption">Figure 23: The same or similar FTP account information was used.</p>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td><strong>C&amp;C</strong></td>
<td><strong>Date</strong></td>
<td><strong>Login ID</strong></td>
<td><strong>Password</strong></td>
<td><strong>Details</strong></td>
</tr>
<tr>
<td>user-daum-center[.]pe.hu</td>
<td>@2019/04/03</td>
<td>u859027282</td>
<td><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ff89969c8b908d86cecdccdebf">[email&#160;protected]</a>#</td>
<td>Same password (1)</td>
</tr>
<tr>
<td>user-protect-center[.]pe.hu</td>
<td>@2019/04/09</td>
<td>u428325809</td>
<td><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3e48575d4a514c470f0c0d1f7e">[email&#160;protected]</a>#</td>
<td>Same password (1)</td>
</tr>
<tr>
<td>nid-protect-team[.]pe.hu</td>
<td>@2019/04/17</td>
<td>u621356999</td>
<td><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c4b2ada7b0abb6bdf5f6f7e584">[email&#160;protected]</a>#</td>
<td>Same password (1)</td>
</tr>
<tr>
<td>oeks39402[.]890m.com</td>
<td>@2019/05/15</td>
<td>u487458083</td>
<td>rhdwn111</td>
<td>Same password (2) same UID</td>
</tr>
<tr>
<td>nid-management-team[.]890m.com</td>
<td>@2019/05/16</td>
<td>u142759695</td>
<td><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="95e3fcf6e1fae7eca4a7a6b4d5">[email&#160;protected]</a>#</td>
<td>Same password (1)</td>
</tr>
<tr>
<td>naiei-aldiel[.]16mb.com</td>
<td>@2019/05/27</td>
<td>u487458083</td>
<td><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="085e616b7c677a61677d7b2948">[email&#160;protected]</a>#</td>
<td>Similar password (1) same UID</td>
</tr>
<tr>
<td>vkcxvkweo[.]96.lt</td>
<td>@2019/06/07</td>
<td>u487458083</td>
<td>rhdwn111</td>
<td>Same password (2) same UID</td>
</tr>
</tbody>
</table>
<p class="centered-caption">Table 8: Leaked FTP authentication information.</p>
<p>The FTP account information used in the malware can expose the C&amp;C server to attacks. The string ‘<span class="monospace">victory</span>’ used in the password has also been found in the b374k webshell used by the Kimsuky group.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/90b2bd71a228f9f84321ca2ed64e7a3a_f4506.png" alt="Kimsuky-Figurenew24.png" width="840" height="136" /></p>
<p class="centered-caption">Figure 24: The b374k webshell.</p>
<p> </p>
<h3><a class="chapter" name="h3-opsec-failure-case-3-file-download-vulnerability"></a>OpSec failure case 3: File download vulnerability</h3>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td><strong>Name</strong></td>
<td><strong>No.</strong></td>
<td><strong>Type</strong></td>
<td><strong>Details</strong></td>
</tr>
<tr>
<td>Mailer (shape)</td>
<td>1</td>
<td>Mailer</td>
<td>Mailer (just shape)</td>
</tr>
<tr>
<td>Mailer (core)</td>
<td>2</td>
<td>Mailer</td>
<td>Mailer (actual function) <br />1) Attachment of malware <br />2) Link to phishing page for account</td>
</tr>
<tr>
<td>Malicious HWP</td>
<td>6</td>
<td>Dropper, spear phishing</td>
<td>Malicious HWP documents</td>
</tr>
<tr>
<td>Script</td>
<td>8</td>
<td>Downloader, logging</td>
<td>Downloads additional malware and logs (e.g. *.vbs, *.wsf, *.jse, *.ps1)</td>
</tr>
<tr>
<td>Infostealer</td>
<td>9</td>
<td>C&amp;C, DLL, FTP</td>
<td>Steals information from infected target and downloads additional malware (in some cases using FTP)</td>
</tr>
</tbody>
</table>
<p class="centered-caption">Table 9: Related toolsets.</p>
<p>We captured the situation where the mailer and attachments used the same C&amp;C server (<span class="monospace">member-authorize[.]com</span>) when the Kimsuky group also sent attachments with spear-phishing emails.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/b4c8fea0b0bc3526c84570e325a8e605_f4507.png" alt="Kimsuky-Figurenew25.png" width="840" height="432" /> <span class="centered-caption">Figure 25: The mailer and attachments used the same C&amp;C server (member-authorize[.]com).</span></p>
<p>The C&amp;C server had directory listings enabled, and there was a file download vulnerability in <span class="monospace">download.php</span>, the file used to downloaded the .hwp attachment.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/91a5e005af5e8389495b297dba26186d_f4508.png" alt="Kimsuky-Figurenew26.png" width="480" height="172" /><span class="centered-caption"> Figure 26: Index of the /security/downloads directory on the C&amp;C server.</span></p>
<table class="table table-bordered" border="0">
<tbody>
<tr>
<td><strong>Name</strong></td>
<td><strong>No.</strong></td>
<td><strong>Type</strong></td>
<td><strong>MD5</strong></td>
<td><strong>Details</strong></td>
</tr>
<tr>
<td>1234.eml</td>
<td>0</td>
<td>EML</td>
<td>b90ed8fe3160ce49d69d000b1005c0c5</td>
<td>Spear-phishing email</td>
</tr>
<tr>
<td>20190312_Japanrelated daily trends(FN).hwp</td>
<td>1</td>
<td>HWP</td>
<td>abafa0cbfbe18afe6dd635d14e7d03d3</td>
<td>Malicious Hangul documents (malicious postscript)</td>
</tr>
<tr>
<td>Powershell</td>
<td>2</td>
<td>Script</td>
<td>6d73e394762022f3cc426b0a37c4e694</td>
<td>GET ddlove[.]kr/bbs/data/1</td>
</tr>
<tr>
<td>1.wsf  </td>
<td>3</td>
<td>Script</td>
<td>e3dcfd19a6054f7b436b09e8ea9f37a5 </td>
<td>(a) Set var (b) Check Extract Util – WinRAR / ALZip (c) Check response (d) Save file &amp; extract (e) or Save file &amp; decode (f) Execute file </td>
</tr>
<tr>
<td>Romanic.fm </td>
<td>4</td>
<td>Encoded PE </td>
<td>9d453684e78ae95b0833c16ef8df6c4f </td>
<td>Base64 encoding </td>
</tr>
<tr>
<td>Romanic.ft  </td>
<td>4</td>
<td>RAR</td>
<td>da2eefeb7ff5a13c0d890d4ccc0e35e1 </td>
<td>Extract P/W: 201811 </td>
</tr>
<tr>
<td>Freedom.dll </td>
<td>5</td>
<td>PE</td>
<td>05075cb9a05d0cce7263842c43f5cf8b </td>
<td>Export name: GrapHouse Check Env (32/64) 64bit : /bbs/data/font/exts.fmt Process Hollowing (explorer.exe) - [SND]: /register.php? WORD=com_XXXXXXXX&amp;NOTE=-[GET]: /bbs/data/ariaK[T]_XXXXXXXX - [DEL]: /join.php?file= </td>
</tr>
<tr>
<td>ariaK_XXXXXXXX  </td>
<td>6</td>
<td>Encoded PE </td>
<td>e8d9d604615bd85862dce00bd8121b92 </td>
<td>XOR TABLE encoding </td>
</tr>
<tr>
<td>OnlyFileList.dll </td>
<td>7</td>
<td>PE</td>
<td>cd5bee99bcae12da1d92cd252f30bd86 </td>
<td>Export name: GrapHouse FileUpload(<span class="monospace">AllList_[MAC Address</span>]_YYMMDD_HHMMSS) to C&amp;C server </td>
</tr>
</tbody>
</table>
<p class="centered-caption">Table 10: Malware.</p>
<p>The attacker has built a mailer in the path of the name of each phishing target.</p>
<p><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/eafd3064ceafd226d132768a7ad007fe_f4509.png" alt="Kimsuky-Figurenew27.png" width="485" height="194" /> <span class="centered-caption">Figure 27: Phishing targets include Daum, KINU and Naver.</span></p>
<p>The mailer was found on the C&amp;C server just as in the first OpSec failure case.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/de2e619aa847070fc086130e43ffb8e5_f4510.jpg" alt="Kimsuky-Figurenew28.jpg" width="840" height="523" /> <span class="centered-caption">Figure 28: Mailer found on the C&amp;C server.</span></p>
<p> </p>
<h2><a class="chapter" name="h2-relationships-analysis"></a>Relationships analysis</h2>
<p>In the process of tracking the Kimsuky group attack, we analysed the relationships of a large quantity of data, and investigated C&amp;C servers located in South Korea through an investigation agency. Figure 29 show the associations that were found between the toolsets and C&amp;C servers classified in our research.</p>
<p><a class="zoom-img" title="Figure 29: Relationships between C&amp;C servers and toolsets." href="/files/6815/7893/0630/Figure29-Relationship_of_CC_Server_with_Toolset.jpg"><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/5f91f3f486dfd08694fffc5e05acbcbf_f4512.jpg" alt="Figure29-Relationship of C&amp;C Server with Toolset.jpg" width="840" height="1431" /></a><span class="centered-caption">Figure 29: Relationships between C&amp;C servers and toolsets.</span></p>
<p>Some of the results of analysing the relationships between toolsets and C&amp;C servers used by the Kimsuky group in spear-phishing attacks are as follows.</p>
<ul>
<li>gyjmc[.]com (KR) → member-authorize[.]com (HOSTINGER) →</li>
<li>ddlovke[.]kr (KR) → military[.]co.kr (KR) ← suppcrt-seourity[.]esy.es(HOSTINGER)</li>
</ul>
<p>Figure 30 shows a graphical representation of the relationships.</p>
<p><a class="zoom-img" title="Figure 30: Graphical representation of the Kimsuky relationships." href="/files/2015/7893/0577/Figure30.jpg"><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/6153f0c3be3c2e9eab3c29e1f4aa5cc6_f4511.jpg" alt="Figure30.jpg" width="840" height="832" /></a><span class="centered-caption">Figure 30: Graphical representation of the Kimsuky relationships.</span></p>
<p>Through its reuse of resources, we were able to track the attack performed by the Kimsuky group.</p>
<p> </p>
<h2><a class="chapter" name="h2-conclusion"></a>Conclusion</h2>
<p>Due to the particular circumstances of South Korea, the Kimsuky group continuously conducts malicious acts by abusing (or camouflaging) documents created in <em>Hangul</em> and phishing for email account credentials in order to hijack accounts. Similar attacks have continued.</p>
<p>However, in the process of tracking the Kimsuky group, we have obtained various pieces of important information through cases of OpSec failure on the part of the attackers.</p>
<p>The information obtained in this way can be used to infer to what extent the next attack will proceed, and, if such a new spear-phishing attack occurs, the appropriate proactive response can be taken by analysing correlations with various indicators found in previous attacks.</p>
<p>We will continue to strive to prevent the future spread of spear-phishing attacks by the Kimsuky group, and we hope that this paper will help in responding to threats in many areas including domestic.</p>
<p> </p>
<h2><a class="chapter" name="h2-references"></a>References</h2>
<p><a class=" anchor" name="ref1"></a>[1] The Kimsuky Operation: a North Korean APT? <a href="https://securelist.com/the-kimsuky-operation-a-north-koreanapt/57915/" target="_blank">https://securelist.com/the-kimsuky-operation-a-north-koreanapt/57915/</a>.</p>
<p><a class=" anchor" name="ref2"></a>[2] <a href="http://asec.ahnlab.com/993" target="_blank">http://asec.ahnlab.com/993</a>.</p>
<p><a class=" anchor" name="ref3"></a>[3] <a href="http://www.hani.co.kr/arti/PRINT/730395.html" target="_blank">http://www.hani.co.kr/arti/PRINT/730395.html</a>.</p>
<p><a class=" anchor" name="ref4"></a>[4] South Korean reporters get malware emails; North Korea suspected. <a href="http://www.koreatimes.co.kr/www/nation/2019/01/356_261573.html" target="_blank">http://www.koreatimes.co.kr/www/nation/2019/01/356_261573.html</a>.</p>
<p><a class=" anchor" name="ref5"></a>[5] Operation Cobra Venom. <a href="https://blog.alyac.co.kr/2066" target="_blank">https://blog.alyac.co.kr/2066</a>.</p>
<p><a class=" anchor" name="ref6"></a>[6] The Double Life of SectorA05 Nesting in Agora (Operation Kitty Phishing). <a href="https://threatrecon.nshc.net/2019/01/30/operation-kitty-phishing/" target="_blank">https://threatrecon.nshc.net/2019/01/30/operation-kitty-phishing/</a>.</p>
<p><a class=" anchor" name="ref7"></a>[7] Operation Kabar Cobra. <a href="https://global.ahnlab.com/global/upload/download/techreport/[Analysis_Report]Operation%20Kabar%20Cobra%20(1).pdf" target="_blank">https://global.ahnlab.com/global/upload/download/techreport/[Analysis_Report]Operation Kabar Cobra (1).pdf</a>.</p>
<p><a class=" anchor" name="ref8"></a>[8] Writing Secure Code - The Attacker’s Advantage and the Defender’s Dilemma (2002). <a href="https://www.oreilly.com/library/view/writing-secure-code/0735617228/" target="_blank">https://www.oreilly.com/library/view/writing-secure-code/0735617228/</a>.</p>
<p><a class=" anchor" name="ref9"></a>[9] DOKKAEBI: Documents of Korean and Evil Binary. <a href="https://www.virusbulletin.com/conference/vb2018/abstracts/dokkaebi-documents-korean-and-evil-binary" target="_blank">https://www.virusbulletin.com/conference/vb2018/abstracts/dokkaebi-documents-korean-and-evil-binary</a>.</p>
<p><a class=" anchor" name="ref10"></a>[10] VirusTotal (5f2ac8672e19310bd532c47d209272bd75075696dea6ffcc47d1d37f18aff141). <a href="https://www.virustotal.com/gui/file/5f2ac8672e19310bd532c47d209272bd75075696dea6ffcc47d1d37f18aff141/de" target="_blank">https://www.virustotal.com/gui/file/5f2ac8672e19310bd532c47d209272bd75075696dea6ffcc47d1d37f18aff141/de</a>.</p>
<p><a class=" anchor" name="ref11"></a>[11] Hybrid-Analysis (8332be776617364c16868c1ad6b4efe7). <a href="https://www.hybridanalysis.com/sample/5f2ac8672e19310bd532c47d209272bd75075696dea6ffcc47d1d37f18aff141?environmentId=110" target="_blank">https://www.hybridanalysis.com/sample/5f2ac8672e19310bd532c47d209272bd75075696dea6ffcc47d1d37f18aff141?environmentId=110</a>.</p>
<p><a class=" anchor" name="ref12"></a>[12] OUI Lookup. <a href="https://ip.rst.im/oui/C48508" target="_blank">https://ip.rst.im/oui/C48508</a>.</p>
<p><a class=" anchor" name="ref13"></a>[13] VirusTotal (f7d2780bc7bb24d7525012a566a37c5baeeba79e0d199120c9f3ccaf5ae3448c). <a href="https://www.virustotal.com/gui/file/f7d2780bc7bb24d7525012a566a37c5baeeba79e0d199120c9f3ccaf5ae3448c/d" target="_blank">https://www.virustotal.com/gui/file/f7d2780bc7bb24d7525012a566a37c5baeeba79e0d199120c9f3ccaf5ae3448c/d</a>.</p>
<p><a class=" anchor" name="ref14"></a>[14] Twitter @anyrun. <a href="https://twitter.com/anyrun_app/status/1115513990711521280" target="_blank">https://twitter.com/anyrun_app/status/1115513990711521280</a>.</p>
<p><a class=" anchor" name="ref15"></a>[15] Anyrun. <a href="https://app.any.run/tasks/680af12b-e8c3" target="_blank">https://app.any.run/tasks/680af12b-e8c3</a>.</p> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<p><a href="/uploads/pdf/magazine/2019/VB2019-Kim-etal.pdf" target="_blank"><img src="/uploads/images/buttons/pdf-download-button.jpg" alt="Download PDF" width="262" height="45" /></a></p>
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=VB2019 paper: Kimsuky group: tracking the king of the spear phishing&url=https://www.virusbulletin.com/virusbulletin/2020/03/vb2019-paper-kimsuky-group-tracking-king-spearphishing"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2020/03/vb2019-paper-kimsuky-group-tracking-king-spearphishing'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2020/03/vb2019-paper-kimsuky-group-tracking-king-spearphishing&title=VB2019 paper: Kimsuky group: tracking the king of the spear phishing"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2020/03/vb2019-paper-kimsuky-group-tracking-king-spearphishing&t=VB2019 paper: Kimsuky group: tracking the king of the spear phishing"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2020/03/vb2019-paper-kimsuky-group-tracking-king-spearphishing"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p> </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">©1989-2022 Virus Bulletin.        <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>        <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>        <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>