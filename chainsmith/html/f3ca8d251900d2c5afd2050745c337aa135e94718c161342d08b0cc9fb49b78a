<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: VBA is not dead!</title>
<meta name="description" content="In the past five years, macro malware could be considered practically extinct – thanks mostly to the security improvements introduced into Microsoft Office products. However, in recent months, a resurgence of malicious VBA macros has been observed – this time, not self-replicating viruses, but simple downloader trojan codes. Gabor Szappanos explains why VBA macro malware is not dead." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 1722;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>
<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>
<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->
<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/remo_expand/blocks/remo_expand/templates/vbexpand/view.css" />
<script type="text/javascript" src="/packages/remo_expand/js/jquery.color.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/packages/remo_expand/js/remo.expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>
<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->

<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
<div class="navbar-inner">
<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
<div class="navbar-header">
<button type="button" class="navbar-toggle btn_navbar_custom">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div> </div>
</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav"> <div class="nav-collapse collapse nav_collapse_custom navbar-collapse"> <div style="clear:both"></div>
<div class="vb-global-search-div">
<form action="/index.php/global-search-results/" method="get">
<fieldset>
<input name="search_paths[]" type="hidden" value="" />
<input name="query" type="text" class="vb-global-search" placeholder="Search site..." />
<input name="submit" type="submit" value="Search!" style="display:none" />
</fieldset>
</form>
</div>
<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self" class=" nav-first nav-item-6299 ">Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self" class=" nav-item-260 ">VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self" class=" nav-item-166 ">VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self" class=" nav-path-selected active nav-item-160 ">Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self" class=" nav-last nav-item-130 ">Blog</a></li></ul> </div>
</div>
</div><div class="clearfix"></div>
</div>
</div>
</div>
<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>

<div class="container m-top-20">
<div class="row">
<div class="col-md-9 col-sm-9 col-lg-9">
<div class="titlepage" xmlns=""><div><div><h1 class="title" xmlns="http://www.w3.org/1999/xhtml"><a id="vb201407-VBA"></a>VBA is not dead!</h1></div><div><p class="pubdate" xmlns="http://www.w3.org/1999/xhtml">2014-07-02</p></div><div><div class="authorgroup" xmlns="http://www.w3.org/1999/xhtml"><div class="author titlepage"><h3 class="author"><span class="firstname">Gabor</span> <span class="surname">Szappanos</span></h3><span class="orgname">Sophos</span>, <span class="orgdiv">Hungary</span></div><b class="editedby">Editor: </b><span class="editor"><span class="firstname">Martijn</span> <span class="surname">Grooten</span></span></div></div><div><div class="abstract" xmlns="http://www.w3.org/1999/xhtml"><p class="title"><b>Abstract</b></p><p>In the past five years, macro malware could be considered practically extinct &ndash; thanks mostly to the security improvements introduced into <span class="emphasis"><em>Microsoft Office</em></span> products. However, in recent months, a resurgence of malicious VBA macros has been observed &ndash; this time, not self-replicating viruses, but simple downloader trojan codes. Gabor Szappanos explains why VBA macro malware is not dead.</p></div></div><div><p class="copyright" xmlns="http://www.w3.org/1999/xhtml"><i>Copyright &copy; 2014 Virus Bulletin</i></p></div></div><hr /></div>
<div class="ccm-remo-expand">
<div id="ccm-remo-expand-title-2621" class="ccm-remo-expand-title ccm-remo-expand-closed" data-expander-speed="200">Table of contents</div><div id="ccm-remo-expand-content-2621" class="ccm-remo-expand-content"><div class="toc"><dl><dt><span class="sect1"><a href="#id3660688"></a></span></dt><dt><span class="sect1"><a href="#id3321822">Social engineering to the rescue</a></span></dt><dt><span class="sect1"><a href="#id2684051">Multi-platform downloader code</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id3098964">Automacros</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id4230804">Final payload</a></span></dt><dt><span class="sect1"><a href="#id3736983">Conclusion</a></span></dt></dl></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3660688"></a></h2></div></div></div><p>VBA macro malware was the dominant beast of the second half of the 1990s. This was the era of the simple WordBasic and later VBA macro viruses, the latter starting their sharp rise on the prevalence lists with the appearance of Concept, and then slowly declining after 2001, with occasional appearances lower down the prevalence charts in the years that followed. <a href="#figure.1">Figure 1</a> shows virus prevalence by type using data aggregated from <span class="emphasis"><em>Virus Bulletin</em></span>&rsquo;s monthly malware prevalence stats.</p><div class="figure"><a id="figure.1"></a><div class="mediaobject"><img alt="Virus prevalence by type." src="/uploads/images/figures/2014/07/VBA-fig1.jpg" /></div><p class="title"><b>Figure&nbsp;1.&nbsp;Virus prevalence by type.</b></p></div><p>In the past five years, macro viruses (and more generally, macro malware) could be considered practically extinct &ndash; thanks mostly to the security improvements that were introduced over that period of time to their main target, the <span class="emphasis"><em>Microsoft Office</em></span> products.</p><p>However, this does not mean that our virus lab no longer encounters malicious <span class="emphasis"><em>Word</em></span> documents and <span class="emphasis"><em>Excel</em></span> workbooks &ndash; on the contrary, they have appeared on our virus radar quite frequently recently, but for a different reason. The new sightings are exploited documents using one of the Office vulnerabilities to drop or download some trojans or backdoors.</p><p>In the past couple of months, we have observed the resurgence of malicious VBA macros &ndash; this time, not self-replicating viruses, but simple downloader trojan codes.</p><p><a href="#figure.2">Figure 2</a> shows the prevalence of the document-based infection reports received by our virus lab in a two-month period, covering March and April. We can see that, following the usual suspects (the CVE-2012-0158 and CVE-2010-3333 vulnerabilities), the VBA downloaders are the next most prevalent.</p><div class="figure"><a id="figure.2"></a><div class="mediaobject"><img alt="Distribution of malicious document infection vectors. (The &lsquo;Word exploit&rsquo; category is a medley of exploited documents where we do not identify the exact exploits &ndash; however, in the majority of cases the exploit in use is CVE-2012-0158. The &lsquo;no exploit&rsquo; category represents the same Zeus dropper RTF embedded executables, which require the user to double-click on the embedded object, as were mentioned in our 2014 Q1 trends report .)" src="/uploads/images/figures/2014/07/VBA-new-fig2.jpg" /></div><p class="title"><b>Figure&nbsp;2.&nbsp;Distribution of malicious document infection vectors. (The &lsquo;Word exploit&rsquo; category is a medley of exploited documents where we do not identify the exact exploits &ndash; however, in the majority of cases the exploit in use is CVE-2012-0158. The &lsquo;no exploit&rsquo; category represents the same Zeus dropper RTF embedded executables, which require the user to double-click on the embedded object, as were mentioned in our 2014 Q1 trends report [<span class="citation"><a href="#citation.1">1</a></span>].)</b></p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3321822"></a>Social engineering to the rescue</h2></div></div></div><p>Visual Basic for Applications (VBA) is the macro programming environment of the <span class="emphasis"><em>Microsoft Office</em></span> suite. Unlike the BASIC language, which is commonly perceived as a tool for beginners, VBA is quite a capable programming environment, as has been well demonstrated by macro viruses in their prime. However, the new wave of trojans described in this analysis doesn&rsquo;t stretch the limits of the language, and in fact are very simplistic.</p><p>There is a complication that arises from using a VBA macro instead of an exploit to activate the infection process. In all <span class="emphasis"><em>Office</em></span> suites starting from <span class="emphasis"><em>Office 2007</em></span>, the execution of VBA macros is disabled by default. Consequently, the VBA code will not execute in newer versions of <span class="emphasis"><em>Office</em></span>. Furthermore, the user is warned on the <span class="emphasis"><em>Word</em></span> menu bar about the fact that macros have been disabled, as shown in <a href="#figure.3">Figure 3</a>.</p><div class="figure"><a id="figure.3"></a><div class="mediaobject"><img alt="Word security warning." src="/uploads/images/figures/2014/07/VBA-fig3.jpg" /></div><p class="title"><b>Figure&nbsp;3.&nbsp;Word security warning.</b></p></div><p>But the malware authors were prepared for this obstacle, and overcame it by deploying simple social engineering tricks. They prepared the content of the documents in such a way that it would lure the recipient into enabling the execution of macros, and thus open the door for infection.</p><p>The malware authors have been busy &ndash; since the first appearance of this group of malware at the end of January 2014, at least 75 different variants have appeared. A wide variety of document content has been used &ndash; a few examples of which are described in the following paragraphs.</p><p>The most peculiar (and one that resembles the social engineering technique used in a Napolar distribution campaign at the end of 2013 [<span class="citation"><a href="#citation.2">2</a></span>]) is one in which a blurred transaction report is placed in the document content, encouraging the user to enable macros in order to access the full content. Conveniently, instructions are provided as to how to enable the macros, including an arrow pointing to the exact location where the user is supposed to click (see<a href="#figure.4">Figure 4</a> ).</p><div class="figure"><a id="figure.4"></a><div class="mediaobject"><img alt="An arrow indicates where to click." src="/uploads/images/figures/2014/07/VBA-fig4.jpg" /></div><p class="title"><b>Figure&nbsp;4.&nbsp;An arrow indicates where to click.</b></p></div><p>A different variation of the same approach with less fancy graphical content is shown in <a href="#figure.5">Figure 5</a>.</p><div class="figure"><a id="figure.5"></a><div class="mediaobject"><img alt="Less fancy graphical content." src="/uploads/images/figures/2014/07/VBA-fig5.jpg" /></div><p class="title"><b>Figure&nbsp;5.&nbsp;Less fancy graphical content.</b></p></div><p>In other cases, content is marked as confidential and the user is encouraged to enable macros in order to view it, as shown in <a href="#figure.6">Figure 6</a>.</p><div class="figure"><a id="figure.6"></a><div class="mediaobject"><img alt="Again, the user is instructed to enable macros." src="/uploads/images/figures/2014/07/VBA-fig6.jpg" /></div><p class="title"><b>Figure&nbsp;6.&nbsp;Again, the user is instructed to enable macros.</b></p></div><p>Some examples are more minimalist in design, just giving out basic information, as shown in <a href="#figure.7">Figure 7</a>.</p><div class="figure"><a id="figure.7"></a><div class="mediaobject"><img alt="More of a minimalist design." src="/uploads/images/figures/2014/07/VBA-fig7.jpg" /></div><p class="title"><b>Figure&nbsp;7.&nbsp;More of a minimalist design.</b></p></div><p>A few of the samples we encountered were rather esoteric and vague, building upon the possibility that the receiver of the document will be as clueless about the point of the message as I was while reading it, and enable the macros purely through curiosity (see <a href="#figure.8">Figure 8</a>).</p><div class="figure"><a id="figure.8"></a><div class="mediaobject"><img alt="Hoping the receiver will enable macros through curiosity." src="/uploads/images/figures/2014/07/VBA-fig8.jpg" /></div><p class="title"><b>Figure&nbsp;8.&nbsp;Hoping the receiver will enable macros through curiosity.</b></p></div><p>Finally, there were cases where the malware authors left everything to the user&rsquo;s imagination, giving no hints whatsoever (see<a href="#figure.9">Figure 9</a> ).</p><div class="figure"><a id="figure.9"></a><div class="mediaobject"><img alt="No clue is given at all." src="/uploads/images/figures/2014/07/VBA-fig9.jpg" /></div><p class="title"><b>Figure&nbsp;9.&nbsp;No clue is given at all.</b></p></div><p>Regardless of the document content, the result is always the same: when the user is convinced to enable macros, the malware is ready to run, and on reopening the document, the VBA code will execute.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id2684051"></a>Multi-platform downloader code</h2></div></div></div><p>The macro code, designed for automatic execution on opening, has the following structure (the order in which the individual functions appear and the name of the main function varies in the different variants):</p><pre class="programlisting">Sub Auto_Open()
  main_code()
End Sub
Sub main_code()
...
End Sub
Sub AutoOpen()
  Auto_Open
End Sub
Sub Workbook_Open()
  Auto_Open
End Sub
</pre><p>The main code is either in or called from the Auto_Open() function (which is executed when <span class="emphasis"><em>Excel</em></span> is started). It is also invoked by the two other event handler functions, AutoOpen (which is invoked when a <span class="emphasis"><em>Word</em></span> document is opened or <span class="emphasis"><em>Word</em></span> is started) and Workbook_Open (which is invoked when an <span class="emphasis"><em>Excel</em></span> workbook is opened).</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id3098964"></a>Automacros</h3></div></div></div><p><span class="emphasis"><em>Microsoft Office</em></span> programs provided a couple of ways a programmer could automatically execute macros when a specific event occurred. Some of them were tied to menu commands, while the automacros were connected to global application events. If the document contained macro procedures that were using one of the predefined, special names, these procedures were called by the <span class="emphasis"><em>Office</em></span> application when the specific event occurred.</p><p>In <span class="emphasis"><em>Microsoft Word</em></span>, these events were tied to starting the <span class="emphasis"><em>Word</em></span> application (the event could be captured with a macro procedure named AutoExec), exiting <span class="emphasis"><em>Word</em></span> (AutoExit), opening a document (AutoOpen), closing a document (AutoClose), or creating a new document (AutoNew).</p><p><span class="emphasis"><em>Microsoft Excel</em></span> had a wider selection of automatic macros, but included similar functions, such as starting <span class="emphasis"><em>Excel</em></span> (Auto_Open), exiting <span class="emphasis"><em>Excel</em></span> (Auto_Close), opening a workbook (Workbook_Open) and closing a workbook (Workbook_Close).</p><p>The structure of the trojan&rsquo;s macro code ensures that the code is executed whenever the document is opened. Even though the code itself is cross-application, and Workbook_Open and Auto_Open could make it work in <span class="emphasis"><em>Excel</em></span>, we have not observed any <span class="emphasis"><em>Excel</em></span> workbooks in the distribution campaigns, only <span class="emphasis"><em>Word</em></span> documents. Still, the dual structure covering both <span class="emphasis"><em>Word</em></span> and <span class="emphasis"><em>Excel</em></span> remains in the code &ndash; probably because the malware authors were too lazy to clean up the proof-of-concept code they used as &lsquo;inspiration&rsquo; &ndash; exactly as we observed in last year&rsquo;s Napolar campaign [<span class="citation"><a href="#citation.2">2</a></span>].</p><p>Although all of the samples we encountered followed the simple code template described above, we could distinguish two different strains among them.</p><p>The most common strain first called the UrlDownloadToFileA <span class="emphasis"><em>Windows</em></span> function to download the final payload from a hard-coded URL, then saved it either to the %TEMP% folder or the %APPDATA% folder, and finally ran it using the Shell function. The dropped executable was usually registered for automatic execution during system start-up in one of the registry autorun locations, such as HKCU\Software\Microsoft\Windows\CurrentVersion\Run.</p><p>Of the 74 documents we identified as belonging to the VBA downloader campaigns (at the time of writing this paper), the vast majority (60) belonged to this group.</p><p>On looking more deeply into the <span class="emphasis"><em>Word</em></span> documents, some interesting characteristics could be observed. The metadata for each document includes document creation/modification times, revision number, and the author of the document. Looking into these properties revealed that the different documents were all attributed to the same author name, &lsquo;tps&rsquo;. It is reasonable to assume that the largest number of malicious documents come from the same source.</p><div class="figure"><a id="figure.10"></a><div class="mediaobject"><img alt="Looking at the file properties reveals the same author name." src="/uploads/images/figures/2014/07/VBA-fig10.jpg" /></div><p class="title"><b>Figure&nbsp;10.&nbsp;Looking at the file properties reveals the same author name.</b></p></div><p>Another useful piece of information is the name of the last user to have saved the document. This revealed some interesting names. Some just indicated the malware author&rsquo;s favourite gadgets (&lsquo;DELL XPS&rsquo;, &lsquo;Xpera Z&rsquo;), while others gave a hint as to the author&rsquo;s name or nickname (&lsquo;Sammy Sam&rsquo;, &lsquo;Sammy2014&rsquo;, &lsquo;samy14&rsquo; and &lsquo;samy2014&rsquo;).</p><div class="figure"><a id="figure.11"></a><div class="mediaobject"><img alt="File last saved by &lsquo;Sammy2014&rsquo;." src="/uploads/images/figures/2014/07/VBA-fig11.jpg" /></div><p class="title"><b>Figure&nbsp;11.&nbsp;File last saved by &lsquo;Sammy2014&rsquo;.</b></p></div><div class="figure"><a id="figure.12"></a><div class="mediaobject"><img alt="File last saved by &lsquo;Sammy Sam&rsquo;." src="/uploads/images/figures/2014/07/VBA-fig12.jpg" /></div><p class="title"><b>Figure&nbsp;12.&nbsp;File last saved by &lsquo;Sammy Sam&rsquo;.</b></p></div><p>Even more interesting is the fact that the creation date (highlighted in <a href="#figure.11">Figure 11</a> and <a href="#figure.12">Figure 12</a>) was the same for most of these documents, as shown in <a href="#figure.13">Figure 13</a>.</p><div class="figure"><a id="figure.13"></a><div class="mediaobject"><img alt="The creation date is the same for most of the documents." src="/uploads/images/figures/2014/07/VBA-fig13.jpg" /></div><p class="title"><b>Figure&nbsp;13.&nbsp;The creation date is the same for most of the documents.</b></p></div><p>This suggests that the development of this VBA trojan family started on 3 January, and the author didn&rsquo;t bother to create a new document each time a new variant was created, but simply kept modifying the previous version by adding new social engineering content and occasionally changing the macro code &ndash; the increasing revision number also supports this assumption. Despite the fact that the last-saved-by name differs within the group, the creator is always &lsquo;tps&rsquo; &ndash; this is another indication that this group of malware is derived from the same root document. The development of this strain appears to be an ongoing project, with the most recent version at revision number 91.</p><p>The rest of the 74 documents are likely to have been developed independently from the previous group. They use a different method, reminiscent of the VBScript downloaders from a decade ago. The remote file from the hard-coded URL is downloaded using the MSXML2.XMLHTTP object, and then the downloaded content is saved to the %APPDATA% folder or %USERPROFILE% folder, and finally executed using the Shell function.</p><p>In this strain of VBA downloaders, in each case, the author and the last-saved-by name are the same, and the creation and last-saved dates are roughly the same. This suggests a different mode of operation: rather than the same template document being modified over and over again, new ones were created most of the time.</p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id4230804"></a>Final payload</h2></div></div></div><p>The downloaded payloads demonstrated a wide range of ordinary crimeware. We observed:</p><div class="itemizedlist"><ul type="disc"><li><p>Zeus-related AutoIt executables:</p><div class="itemizedlist"><ul type="circle"><li><p>https://www.virustotal.com/en/file/ace7db9b08d65b2c4 f0c011a54571039e45ca4010aaf482c73ee7ef860019d8c/analysis/</p></li><li><p>https://www.virustotal.com/en/file/8b6757271611fe6ff0f 758bffee20e488d19b583be0352584f191d21d241bcfd/analysis/</p></li><li><p>https://www.virustotal.com/en/file/c85fe4874ddfa96845 69819db42fb321641088cbe15e6e54d28de49de26f155c/analysis/</p></li></ul></div></li><li><p>A DotNET injector:</p><div class="itemizedlist"><ul type="circle"><li><p>https://www.virustotal.com/en/file/f1b0432594bf9651ad 50d755fe1967fd2a16f112e5c0df6ebc5311166857d30c/analysis/</p></li></ul></div></li><li><p>Old-fashioned RATs like Simda:</p><div class="itemizedlist"><ul type="circle"><li><p>https://www.virustotal.com/en/file/f456df5aa1af278ccd9 958bf7f0b18ab36ed05ccb73aed8d7faec8a5898d8bcb/analysis/.</p></li></ul></div></li></ul></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title"><a class="chapter" id="id3736983"></a>Conclusion</h2></div></div></div><p>Our earlier report pointed out [<span class="citation"><a href="#citation.1">1</a></span>] that ordinary cybercriminals turned to <span class="emphasis"><em>Office</em></span> exploits as an alternative delivery method for their creations. Current trends show that they have moved one step further into the <span class="emphasis"><em>Office</em></span> realm: they have discovered the long-forgotten VBA macros and added them to their repertoire. This emphasizes the fact (I can&rsquo;t even count how many times it has been proven in the past) that there is no need for fancy exploitation. When the aim is to infect a large number of users, good old social engineering never fails to deliver the results.</p><p>Finally, a piece of advice: there is no justification as to why the content of a document can only be displayed properly if the execution of macros is enabled. If you receive a document with this advice, be aware: you are probably being attacked.</p><div class="bibliography"><div class="titlepage"><div><div><h3 class="title"><a class="chapter" id="id2970272"></a>Bibliography</h3></div></div></div><div class="bibliomixed"><a id="citation.1"></a><p class="bibliomixed">[1] <span class="bibliosource"><a href="https://nakedsecurity.sophos.com/advanced-persistent-threats-the-new-normal" target="_blank">http://nakedsecurity.sophos.com/advanced-persistent-threats-the-new-normal</a></span>.</p></div><div class="bibliomixed"><a id="citation.2"></a><p class="bibliomixed">[2] <span class="bibliosource"><a href="/virusbulletin/2014/04/back-vba
" target="_top">http://www.virusbtn.com/virusbulletin/archive/2014/04/vb201404-VBA</a></span>.</p></div></div></div> </div>
<div class="col-md-3 col-sm-3 col-lg-3">
<p><a href="/uploads/pdf/magazine/2014/vb201407-VBA.pdf" target="_blank"><img class="ccm-image-block responsive" alt="" src="/uploads/images/buttons/pdf-download-button.jpg" onmouseover="this.src = '/uploads/images/buttons/pdf-download-button-hover.jpg'" onmouseout="this.src = '/uploads/images/buttons/pdf-download-button.jpg'" border="0" height="45" width="262"></a></p>
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=VBA is not dead!&url=https://www.virusbulletin.com/virusbulletin/2014/07/vba-not-dead"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2014/07/vba-not-dead'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2014/07/vba-not-dead&title=VBA is not dead!"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2014/07/vba-not-dead&t=VBA is not dead!"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2014/07/vba-not-dead"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p> </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
</h3>
<div class="ccm-page-list-description">
TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
</h3>
<div class="ccm-page-list-description">
Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
</h3>
<div class="ccm-page-list-description">
In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/run-your-malicious-vba-macros-anywhere/" target="_self">Run your malicious VBA macros anywhere!</a>
</h3>
<div class="ccm-page-list-description">
Kurt Natvig wanted to understand whether it&rsquo;s possible to recompile VBA macros to another language, which could then easily be &lsquo;run&rsquo; on any gateway, thus revealing a sample&rsquo;s true nature in a safe manner. In this article he explains how he recompiled&hellip; </div>
<h3 class="ccm-page-list-title">
<a href="/virusbulletin/2021/04/dissecting-design-and-vulnerabilities-azorultccpanels/" target="_self">Dissecting the design and vulnerabilities in AZORult&nbsp;C&amp;C&nbsp;panels</a>
</h3>
<div class="ccm-page-list-description">
Aditya K Sood looks at the command-and-control (C&amp;C) design of the AZORult malware, discussing his team's findings related to the C&amp;C design and some security issues they identified during the research. </div>
</div>
<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p> </div>
</div>
</div>

<footer class="bs-footer" role="contentinfo">
<div class="container">
<div class="bs-social">
<div class="row ">
<div class="col-md-3">
<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Security Events Calendar" href="/resources/calendar/">Security events calendar</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p> </div>
<div class="col-md-3">
<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb1001/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="VBWeb" href="/testing/vbweb/">VBWeb</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p> </div>
<div class="col-md-3">
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="VB2019" href="/conference/vb2019/">VB2019 (London)</a></p>
<p><a title="VB2018" href="/conference/vb2018">VB2018 (Montreal)</a></p>
<p><a title="VB2017" href="/conference/vb2017">VB2017 (Madrid)</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p> </div>
<div class="col-md-3">
<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div> </div>
</div>
<div class="row ">
<div class="col-md-12">
</div>
</div>
</div>
</div>
</footer>

<footer class="bs-footer2" role="contentinfo">
<div class="container">
<div class="bs-social2">
<div class="row ">
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
<div class="col-md-3">
</div>
</div>
<div class="row ">
<div class="col-md-12">
<p style="text-align: left;">©1989-2022 Virus Bulletin.        <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>        <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>        <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p> </div>
</div>
</div>
</div>
</footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-21876594-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-21876594-2', { 'anonymize_ip': true });
</script><script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
<div class="disclosure-container">
<div class="disclosure-content">
<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
</div>
<div class="disclosure-form">
<form action="/index.php/cookies_disclosure/" method="POST">
<input type="hidden" name="allowCookies" value="1" />
<div class="button">
<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
</div>
</form>
</div>
<div class="ccm-spacer">&nbsp;</div>
</div>
</div>
</body>
</html>