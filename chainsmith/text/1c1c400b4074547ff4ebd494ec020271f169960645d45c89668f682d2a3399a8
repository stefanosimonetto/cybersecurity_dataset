Nessus 3.0.3 on FreeBSD

Get link

Facebook

Twitter

Pinterest

Email

Other Apps

June 04, 2006

Several times last year I talked about using Nessus on FreeBSD.  Last night I finally got a chance to install and try Nessus 3.0.3 on FreeBSD.  Here's how I did it.First I downloaded Nessus 3.0.3 as a package for FreeBSD 6.x (called Nessus-3.0.3-fbsd6.tbz).  I added the package:orr:/root# pkg_add -v Nessus-3.0.3-fbsd6.tbzRequested space: 16570324 bytes, free space: 4394956800 bytes in /var/tmp/instmp.YdVsPFRunning pre-install for Nessus-3.0.3..extract: Package name is Nessus-3.0.3extract: CWD to /usr/localextract: /usr/local/nessus/lib/nessus/plugins/synscan.nesextract: /usr/local/nessus/lib/nessus/plugins/12planet_chat_server_path_disclosure.nasl...edited...extract: /usr/local/nessus/bin/naslextract: /usr/local/nessus/bin/nessusextract: /usr/local/nessus/bin/nessus-fetchextract: /usr/local/nessus/bin/nessus-bug-report-generatorextract: /usr/local/nessus/bin/nessus-mkcert-clientextract: /usr/local/nessus/bin/nessus-mkrandextract: /usr/local/nessus/sbin/nessus-add-first-userextract: /usr/local/nessus/sbin/nessus-check-signatureextract: /usr/local/nessus/sbin/nessus-adduserextract: /usr/local/nessus/sbin/nessus-chpasswdextract: /usr/local/nessus/sbin/nessus-rmuserextract: /usr/local/nessus/sbin/nessus-mkcertextract: /usr/local/nessus/sbin/nessus-update-pluginsextract: /usr/local/nessus/sbin/nessusdextract: /usr/local/nessus/var/nessus/nessus-servicesextract: /usr/local/nessus/var/nessus/nessus_org.pemextract: /usr/local/etc/rc.d/nessusd.shextract: CWD to .Running mtree for Nessus-3.0.3..mtree -U -f +MTREE_DIRS -d -e -p /usr/local >/dev/nullRunning post-install for Nessus-3.0.3..Running post-install for Nessus-3.0.3..nessusd (Nessus) 3.0.3. for FreeBSD(C) 1998 - 2006 Tenable Network Security, Inc.Processing the Nessus plugins...[##################################################]All plugins loaded - Please run /usr/local/nessus/sbin/nessus-add-first-user to add an admin user - Register your Nessus scanner at http://www.nessus.org/register/ to obtain   all the newest plugins - You can start nessusd by typing /usr/local/etc/rc.d/nessusd.sh startAttempting to record package into /var/db/pkg/Nessus-3.0.3..Package Nessus-3.0.3 registered in /var/db/pkg/Nessus-3.0.3Next I added a user:orr:/root# /usr/local/nessus/sbin/nessus-add-first-userUsing /var/tmp as a temporary file holderAdd a new nessusd user----------------------Login : bejnessusAuthentication (pass/cert) [pass] : Login password : Login password (again) : User rules----------nessusd has a rules system which allows you to restrict the hoststhat bejnessus has the right to test. For instance, you may wanthim to be able to scan his own host only.Please see the nessus-adduser(8) man page for the rules syntaxEnter the rules for this user, and hit ctrl-D once you are done : (the user can have an empty rules set)Login             : bejnessusPassword          : ***********DN                : Rules             : Is that ok ? (y/n) [y] yuser added.Thank you. You can now start Nessus by typing : /usr/local/nessus/sbin/nessusd -DNext I registered using the code emailed to me:orr:/root# /usr/local/nessus/bin/nessus-fetch --register codegoeshereYour activation code has been registered properly - thank you.Now fetching the newest plugin set from plugins.nessus.org...Your Nessus installation is now up-to-date.If auto_update is set to 'yes' in nessusd.conf, Nessus willupdate the plugins by itself.Finally I started the Nessus daemon.orr:/root# /usr/local/etc/rc.d/nessusd.sh start Nessusorr:/root# sockstat -4USER     COMMAND    PID   FD PROTO  LOCAL ADDRESS         FOREIGN ADDRESS      root     nessusd    13116 4  tcp4   *:1241                *:*root     sendmail   434   4  tcp4   127.0.0.1:25          *:*root     sshd       428   4  tcp4   *:22                  *:*root     syslogd    312   6  udp4   *:514                 *:*When I finished I removed the executable bit from the nessusd.sh script so it would not execute on boot.  This is because I don't need it on boot, especially since it takes over a minute to load all the plugins.orr:/root# chmod -x /usr/local/etc/rc.d/nessusd.shTo start nessusd when the execute bit is not set, I do the following:orr:/root# sh /usr/local/etc/rc.d/nessusd.sh start NessusNote the default /usr/local/nessus/etc/nessus/nessusd.conf contains the following:# Automatic plugins updates - if enabled and Nessus is registered, then# fetch the newest plugins from plugins.nessus.org automaticallyauto_update = yes# Number of hours to wait between two updatesauto_update_delay = 24I changed this to sayauto_update = nobecause I prefer to update the plugins manually.orr:/root# /usr/local/nessus/sbin/nessus-update-pluginsNessus now provides a separate GUI client called NessusClient.  I tried to install it this way:orr:/usr/local/src# tar -xzvf NessusClient-1.0.0.RC5.tar.gzx NessusClient-1.0.0.RC5/x NessusClient-1.0.0.RC5/.root-dir...edited...x NessusClient-1.0.0.RC5/TODOx NessusClient-1.0.0.RC5/VERSIONorr:/usr/local/src# cd NessusClient-1.0.0.RC5orr:/usr/local/src/NessusClient-1.0.0.RC5# ./configurecreating cache ./config.cachechecking host system type... i386-unknown-freebsd6.0...edited...creating doc/NessusClient.1creating include/config.horr:/root/NessusClient-1.0.0.RC5# make...edited...prefs_scope_tree.o(.text+0x434): In function `scopetree_rename':prefs_dialog/prefs_scope_tree.c:179: undefined reference to `prefs_context_update'prefs_scope_tree.o(.text+0x9c6): In function `scopetree_delete':prefs_dialog/prefs_scope_tree.c:376: undefined reference to `prefs_context_update'prefs_scope_tree.o(.text+0xab6):prefs_dialog/prefs_scope_tree.c:415: undefined reference to  `prefs_context_update'prefs_scope_tree.o(.text+0xc65):prefs_dialog/prefs_scope_tree.c:500: more undefined references to `prefs_context_update' follow*** Error code 1Stop in /usr/local/src/NessusClient-1.0.0.RC5/nessus.*** Error code 1Stop in /usr/local/src/NessusClient-1.0.0.RC5.Rats.  Luckily I found this post which suggested a fix using Gmake.  After starting with a fresh extraction of NessusClient-1.0.0.RC5, I ran ./configure, gmake, and gmake install.  Everything worked./usr/bin/install -c -m 755 /root/NessusClient-1.0.0.RC5/bin/NessusClient /usr/local/bintest -d /usr/local/bin || /usr/bin/install -c -d -m 755 /usr/local/bin/usr/bin/install -c -m 755 nessusclient-mkcert /usr/local/bin/usr/bin/install -c -m 755 ssl/nessus-mkrand /usr/local/bininstalling man pages .../usr/bin/install -c -c -m 0444 doc/NessusClient.1 /usr/local/man/man1/NessusClient.1/usr/bin/install -c -c -m 0444 doc/nessusclient-mkcert.1  /usr/local/man/man1/nessusclient-mkcert.1/usr/bin/install -c -c -m 0444 doc/nessus-mkrand.1 /usr/local/man/man1/nessus-mkrand.1I could now start the client:orr:/home/richard$ NessusClient I selected File -> Scan Assistant to create a "demo" Task, with "demo" scope, and "localhost" as target.I then was prompted for my username and password to connect to the nessusd server.Once connected, Nessus began scanning localhost.When done I had a report.These are the basics of running Nessus 3.0.3 with NessusClient on FreeBSD.  I used the defaults for everything to get my results.  An alternative would be to use Nessus 2.2.8, which is in the ports tree.For more information, consider attending Nessus Training by Tenable Network Security.
